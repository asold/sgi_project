{
  "title": "Smart-LLaMA-DPO: Reinforced Large Language Model for Explainable Smart Contract Vulnerability Detection",
  "url": "https://openalex.org/W4411523077",
  "year": 2025,
  "authors": [
    {
      "id": "https://openalex.org/A2005271394",
      "name": "Lei Yu",
      "affiliations": [
        "Chinese Academy of Sciences",
        "University of Chinese Academy of Sciences",
        "Institute of Software"
      ]
    },
    {
      "id": "https://openalex.org/A2106432473",
      "name": "Zhirong Huang",
      "affiliations": [
        "University of Chinese Academy of Sciences",
        "Chinese Academy of Sciences",
        "Institute of Software"
      ]
    },
    {
      "id": "https://openalex.org/A2120450140",
      "name": "Hang Yuan",
      "affiliations": [
        "Institute of Software",
        "University of Chinese Academy of Sciences",
        "Chinese Academy of Sciences"
      ]
    },
    {
      "id": "https://openalex.org/A2222621021",
      "name": "Shiqi Cheng",
      "affiliations": [
        "Chinese Academy of Sciences",
        "Institute of Software"
      ]
    },
    {
      "id": "https://openalex.org/A1993907199",
      "name": "Li Yang",
      "affiliations": [
        "Chinese Academy of Sciences",
        "Institute of Software"
      ]
    },
    {
      "id": "https://openalex.org/A2100336258",
      "name": "Fengjun Zhang",
      "affiliations": [
        "Chinese Academy of Sciences",
        "Institute of Software"
      ]
    },
    {
      "id": "https://openalex.org/A2168751005",
      "name": "Chen-Jie Shen",
      "affiliations": [
        "Institute of Software",
        "Chinese Academy of Sciences",
        "University of Chinese Academy of Sciences"
      ]
    },
    {
      "id": "https://openalex.org/A2105587357",
      "name": "Jiajia Ma",
      "affiliations": [
        "Institute of Software",
        "Chinese Academy of Sciences"
      ]
    },
    {
      "id": "https://openalex.org/A2103824701",
      "name": "Jingyuan Zhang",
      "affiliations": [
        "Chinese Academy of Sciences",
        "Institute of Software",
        "University of Chinese Academy of Sciences"
      ]
    },
    {
      "id": "https://openalex.org/A2086588853",
      "name": "Junyi Lu",
      "affiliations": [
        "Chinese Academy of Sciences",
        "University of Chinese Academy of Sciences",
        "Institute of Software"
      ]
    },
    {
      "id": "https://openalex.org/A2120444749",
      "name": "Chun Zuo",
      "affiliations": []
    }
  ],
  "references": [
    "https://openalex.org/W6893292224",
    "https://openalex.org/W4386579875",
    "https://openalex.org/W2752925090",
    "https://openalex.org/W2979792666",
    "https://openalex.org/W4288057718",
    "https://openalex.org/W4376163513",
    "https://openalex.org/W2968269657",
    "https://openalex.org/W4205689130",
    "https://openalex.org/W4403536511",
    "https://openalex.org/W2769293050",
    "https://openalex.org/W2970809537",
    "https://openalex.org/W3125989628",
    "https://openalex.org/W2885936017",
    "https://openalex.org/W3096316084",
    "https://openalex.org/W4316661173",
    "https://openalex.org/W2539190473",
    "https://openalex.org/W4411552805",
    "https://openalex.org/W3121385022",
    "https://openalex.org/W4400647264",
    "https://openalex.org/W3091620507",
    "https://openalex.org/W3005065812",
    "https://openalex.org/W4378771755",
    "https://openalex.org/W3081168214",
    "https://openalex.org/W3090526726",
    "https://openalex.org/W3120672518",
    "https://openalex.org/W2805827286",
    "https://openalex.org/W3214421193",
    "https://openalex.org/W2908007588",
    "https://openalex.org/W2805052744",
    "https://openalex.org/W3198685994",
    "https://openalex.org/W4411523077",
    "https://openalex.org/W3035733952",
    "https://openalex.org/W2975871742",
    "https://openalex.org/W4385486090",
    "https://openalex.org/W1543330234",
    "https://openalex.org/W4402040489",
    "https://openalex.org/W3105187050",
    "https://openalex.org/W4211035893",
    "https://openalex.org/W4404952834",
    "https://openalex.org/W4384347367",
    "https://openalex.org/W4388505012",
    "https://openalex.org/W3102542096",
    "https://openalex.org/W4396758529",
    "https://openalex.org/W4255309623",
    "https://openalex.org/W3034459010",
    "https://openalex.org/W4246788636"
  ],
  "abstract": "Smart contract vulnerability detection is a critical challenge in the rapidly evolving blockchain landscape. Existing vulnerability detection methods face two main issues: (1) Existing datasets lack comprehensiveness and sufficient quality, with limited vulnerability type coverage and insufficient distinction between high-quality and low-quality explanations for preference learning. (2) Large language models (LLMs) often struggle with accurately interpreting specific concepts in smart contract security. Through our empirical analysis, we found that even after continual pre-training and supervised fine-tuning, LLMs still exhibit limitations in precisely understanding the execution order of state changes in smart contracts, which can lead to incorrect vulnerability explanations despite making correct detection decisions. These limitations result in poor detection performance, leading to potentially severe financial losses. To address these challenges, we propose Smart-LLaMA-DPO, an advanced detection method based on the LLaMA-3.1-8B. First, we construct a comprehensive dataset covering four vulnerability types and machine-unauditable vulnerabilities, containing labels, detailed explanations, and precise vulnerability locations for Supervised Fine-Tuning (SFT), as well as paired high-quality and low-quality outputs for Direct Preference Optimization (DPO). Second, we perform continual pre-training using large-scale smart contract code to enhance the LLM's understanding of specific security practices in smart contracts. Futhermore, we conduct supervised fine-tuning with our comprehensive dataset. Finally, we apply DPO, which leverages human feedback to improve the quality of generated explanations. Smart-LLaMA-DPO utilizes a specially designed loss function that encourages the LLM to increase the probability of preferred outputs while decreasing the probability of non-preferred outputs, thereby enhancing the LLM's ability to generate high-quality explanations. We evaluate Smart-LLaMA-DPO on four major vulnerability types: reentrancy, timestamp dependence, integer overflow/underflow, and delegatecall, as well as machine-unauditable vulnerabilities. Our method significantly outperforms state-of-the-art baselines, with average improvements of 10.43% in F1 score and 7.87% in accuracy. Moreover, both LLM evaluation and human evaluation demonstrate the superior quality of explanations generated by Smart-LLaMA-DPO in terms of correctness, thoroughness, and clarity.",
  "full_text": null,
  "topic": "Vulnerability (computing)",
  "concepts": [
    {
      "name": "Vulnerability (computing)",
      "score": 0.8163820505142212
    },
    {
      "name": "Computer science",
      "score": 0.65614914894104
    },
    {
      "name": "Quality (philosophy)",
      "score": 0.6090998649597168
    },
    {
      "name": "Risk analysis (engineering)",
      "score": 0.47123250365257263
    },
    {
      "name": "Vulnerability assessment",
      "score": 0.4620944559574127
    },
    {
      "name": "Construct (python library)",
      "score": 0.4571102261543274
    },
    {
      "name": "Scale (ratio)",
      "score": 0.45108067989349365
    },
    {
      "name": "Preference",
      "score": 0.42669761180877686
    },
    {
      "name": "Artificial intelligence",
      "score": 0.3925969898700714
    },
    {
      "name": "Machine learning",
      "score": 0.3728885054588318
    },
    {
      "name": "Computer security",
      "score": 0.36340683698654175
    },
    {
      "name": "Business",
      "score": 0.16805821657180786
    },
    {
      "name": "Economics",
      "score": 0.0832224190235138
    },
    {
      "name": "Physics",
      "score": 0.0
    },
    {
      "name": "Psychological resilience",
      "score": 0.0
    },
    {
      "name": "Programming language",
      "score": 0.0
    },
    {
      "name": "Philosophy",
      "score": 0.0
    },
    {
      "name": "Epistemology",
      "score": 0.0
    },
    {
      "name": "Quantum mechanics",
      "score": 0.0
    },
    {
      "name": "Microeconomics",
      "score": 0.0
    },
    {
      "name": "Psychotherapist",
      "score": 0.0
    },
    {
      "name": "Psychology",
      "score": 0.0
    }
  ],
  "institutions": [
    {
      "id": "https://openalex.org/I19820366",
      "name": "Chinese Academy of Sciences",
      "country": "CN"
    },
    {
      "id": "https://openalex.org/I4210128818",
      "name": "Institute of Software",
      "country": "CN"
    },
    {
      "id": "https://openalex.org/I4210165038",
      "name": "University of Chinese Academy of Sciences",
      "country": "CN"
    }
  ],
  "cited_by": 3
}