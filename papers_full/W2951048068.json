{
  "title": "Barack’s Wife Hillary: Using Knowledge Graphs for Fact-Aware Language Modeling",
  "url": "https://openalex.org/W2951048068",
  "year": 2019,
  "authors": [
    {
      "id": "https://openalex.org/A2066150054",
      "name": "Robert Logan",
      "affiliations": [
        "University of California, Irvine"
      ]
    },
    {
      "id": "https://openalex.org/A2736864276",
      "name": "Nelson F. Liu",
      "affiliations": [
        "University of Washington",
        "Allen Institute for Artificial Intelligence"
      ]
    },
    {
      "id": "https://openalex.org/A2123728692",
      "name": "Matthew E. Peters",
      "affiliations": [
        "Allen Institute for Artificial Intelligence"
      ]
    },
    {
      "id": "https://openalex.org/A2133268498",
      "name": "Matt Gardner",
      "affiliations": [
        "Allen Institute for Artificial Intelligence"
      ]
    },
    {
      "id": "https://openalex.org/A2143533944",
      "name": "Sameer Singh",
      "affiliations": [
        "University of California, Irvine"
      ]
    }
  ],
  "references": [
    "https://openalex.org/W2757369719",
    "https://openalex.org/W2964121744",
    "https://openalex.org/W2963494889",
    "https://openalex.org/W2890560993",
    "https://openalex.org/W2963938518",
    "https://openalex.org/W2476140796",
    "https://openalex.org/W2963925965",
    "https://openalex.org/W2962883855",
    "https://openalex.org/W4299838440",
    "https://openalex.org/W2962832505",
    "https://openalex.org/W2963537482",
    "https://openalex.org/W1985610876",
    "https://openalex.org/W1522301498",
    "https://openalex.org/W2963073938",
    "https://openalex.org/W2757047188",
    "https://openalex.org/W4298422451",
    "https://openalex.org/W2127795553",
    "https://openalex.org/W4919037",
    "https://openalex.org/W2962883166",
    "https://openalex.org/W179875071",
    "https://openalex.org/W2964165364",
    "https://openalex.org/W2962817854",
    "https://openalex.org/W2786660442",
    "https://openalex.org/W2963091658",
    "https://openalex.org/W2902318879",
    "https://openalex.org/W2963290255",
    "https://openalex.org/W2908460844",
    "https://openalex.org/W2084531783",
    "https://openalex.org/W2739046565",
    "https://openalex.org/W2064675550",
    "https://openalex.org/W2080133951",
    "https://openalex.org/W1591706642",
    "https://openalex.org/W2095705004"
  ],
  "abstract": "Modeling human language requires the ability to not only generate fluent text but also encode factual knowledge. However, traditional language models are only capable of remembering facts seen at training time, and often have difficulty recalling them. To address this, we introduce the knowledge graph language model (KGLM), a neural language model with mechanisms for selecting and copying facts from a knowledge graph that are relevant to the context. These mechanisms enable the model to render information it has never seen before, as well as generate out-of-vocabulary tokens. We also introduce the Linked WikiText-2 dataset, a corpus of annotated text aligned to the Wikidata knowledge graph whose contents (roughly) match the popular WikiText-2 benchmark. In experiments, we demonstrate that the KGLM achieves significantly better performance than a strong baseline language model. We additionally compare different language model’s ability to complete sentences requiring factual knowledge, showing that the KGLM outperforms even very large language models in generating facts.",
  "full_text": "Proceedings of the 57th Annual Meeting of the Association for Computational Linguistics, pages 5962–5971\nFlorence, Italy, July 28 - August 2, 2019.c⃝2019 Association for Computational Linguistics\n5962\nBarack’s Wife Hillary:\nUsing Knowledge Graphs for Fact-A ware Language Modeling\nRobert L. Logan IV∗ Nelson F . Liu†§ Matthew E. Peters§\nMatt Gardner§ Sameer Singh∗\n∗ University of California, Irvine, CA, USA\n† University of W ashington, Seattle, W A, USA\n§ Allen Institute for Artiﬁcial Intelligence, Seattle, W A, USA\n{rlogan, sameer}@uci.edu , {mattg, matthewp}@allenai.org , nﬂiu@cs.washington.edu\nAbstract\nModeling human language requires the ability\nto not only generate ﬂuent text but also en-\ncode factual knowledge. However, traditional\nlanguage models are only capable of remem-\nbering facts seen at training time, and often\nhave difﬁculty recalling them. T o address this,\nwe introduce the knowledge graph language\nmodel (KGLM), a neural language model with\nmechanisms for selecting and copying facts\nfrom a knowledge graph that are relevant to\nthe context. These mechanisms enable the\nmodel to render information it has never seen\nbefore, as well as generate out-of-vocabulary\ntokens. W e also introduce the Linked WikiT ext-\n2 dataset,\n1 a corpus of annotated text aligned to\nthe Wikidata knowledge graph whose contents\n(roughly) match the popular WikiT ext-2bench-\nmark ( Merity et al. , 2017). In experiments, we\ndemonstrate that the KGLM achieves signiﬁ-\ncantly better performance than a strong base-\nline language model. W e additionally com-\npare different language models’ ability to com-\nplete sentences requiring factual knowledge,\nand show that the KGLM outperforms even\nvery large language models in generating facts.\n1 Introduction\nFor language models to generate plausible sen-\ntences, they must be both syntactically coherent as\nwell as consistent with the world they describe. Al-\nthough language models are quite skilled at generat-\ning grammatical sentences, and previous work has\nshown that language models also possess some de-\ngree of common-sense reasoning and basic knowl-\nedge ( Vinyals and Le , 2015; Serban et al. , 2016;\nTrinh and Le , 2019), their ability to generate fac-\ntually correct text is quite limited. The clearest\nlimitation of existing language models is that they ,\nat best, can only memorize facts observed during\n1 https://rloganiv.github.io/linked-wikitext-2\n[Super Mario Land] is a [1989] [side-scrolling]\n[platform video game] developed and published\nby [Nintendo] as a [launch title] for their [Game\nBoy] [handheld game console].\nDate\n21 April 1989\nQ828322\nplatform game\nQ8093\nNintendo\nQ647249\nSuper Mario Land\nQ186437\nGame Boy\nQ941818\nhandheld game console\nQ2281714\nside-scrolling video game\nQ1425505\nlaunch game\nPublication\nDate genre\npublisher\nplatform manufacturer\ninstance of\nFigure 1: Linked WikiT ext-2Example. A localized\nknowledge graph containing facts that are (possibly)\nconveyed in the sentence above. The graph is built by it-\neratively linking each detected entity to Wikidata, then\nadding any relations to previously mentioned entities.\nNote that not all entities are connected, potentially due\nto missing relations in Wikidata.\ntraining. For instance, when conditioned on the text\nat the top of Figure 1, an A WD-LSTM language\nmodel ( Merity et al. , 2018) trained on Wikitext-2\nassigns higher probability to the word “ PlaySta-\ntion” than “ Game Boy”, even though this sentence\nappears verbatim in the training data. This is not\nsurprising—existing models represent the distribu-\ntion over the entire vocabulary directly , whether\nthey are common words, references to real world\nentities, or factual information like dates and num-\nbers. As a result, language models are unable to\ngenerate factually correct sentences, do not gen-\neralize to rare/unseen entities, and often omit rare\ntokens from the vocabulary (instead generating UN-\nKNOWN tokens).\nW e introduce the knowledge graph language\nmodel (KGLM), a neural language model with\nmechanisms for selecting and copying information\nfrom an external knowledge graph. The KGLM\nmaintains a dynamically growing local knowledge\n5963\ngraph, a subset of the knowledge graph that con-\ntains entities that have already been mentioned in\nthe text, and their related entities. When generating\nentity tokens, the model either decides to render\na new entity that is absent from the local graph,\nthereby growing the local knowledge graph, or to\nrender a fact from the local graph. When render-\ning, the model combines the standard vocabulary\nwith tokens available in the knowledge graph, thus\nsupporting numbers, dates, and other rare tokens.\nFigure 1 illustrates how the KGLM works. Ini-\ntially , the graph is empty and the model uses the\nentity\nSuper Mario Land to render the ﬁrst three\ntokens, thus adding it and its relations to the local\nknowledge graph. After generating the next two to-\nkens (“ is”, “ a”) using the standard language model,\nthe model selects Super Mario Land as the parent\nentity , Publication Date as the relation to render,\nand copies one of the tokens of the date entity as\nthe token (“ 1989” in this case).\nT o facilitate research on knowledge graph-based\nlanguage modeling, we collect the distantly su-\npervised Linked WikiT ext-2dataset. The underly-\ning text closely matches WikiT ext-2(Merity et al. ,\n2017), a popular benchmark for language model-\ning, allowing comparisons against existing mod-\nels. The tokens in the text are linked to entities in\nWikidata ( Vrandeˇci´c and Krötzsch , 2014) using a\ncombination of human-provided links and off-the-\nshelf linking and coreference models. W e also use\nrelations between these entities in Wikidata to con-\nstruct plausible reasons for why an entity may have\nbeen mentioned: it could either be related to an\nentity that is already mentioned (including itself)\nor a brand new , unrelated entity for the document.\nW e train and evaluate the KGLM on Linked\nWikiT ext-2. When compared against A WD-LSTM,\na recent and performant language model, KGLM\nobtains not only a lower overall perplexity , but also\na substantially lower unknown-penalized perplex-\nity ( Ueberla, 1994; Ahn et al. , 2016), a metric that\nallows fair comparisons between models that accu-\nrately model rare tokens and ones that predict them\nto be unknown. W e also compare factual com-\npletion capabilities of these models, where they\npredict the next word after a factual sentence (e.g.,\n“ Barack is married to ”) and show that KGLM\nis signiﬁcantly more accurate. Lastly , we show that\nthe model is able to generate accurate facts for rare\nentities, and can be controlled via modiﬁcations\nthe knowledge graph.\n2 Knowledge Graph Language Model\nIn this section we introduce a language model that\nis conditioned on an external, structured knowledge\nsource, which it uses to generate factual text.\n2.1 Problem Setup and Notation\nA language model deﬁnes a probability distribution\nover each token within a sequence, conditioned on\nthe sequence of tokens observed so far. W e denote\nthe random variable representing the next token as\nxt and the sequence of the tokens before t as x<t,\ni.e. language models compute p(xt|x<t). RNN lan-\nguage models ( Mikolov et al. , 2010) parameterize\nthis distribution using a recurrent structure:\np(xt|x<t) = softmax(Whht + b),\nht = RNN(ht−1, xt−1). (1)\nW e use LSTMs ( Hochreiter and Schmidhuber ,\n1997) as the recurrent module in this paper.\nA knowledge graph (KG) is a directed, labeled\ngraph consisting of entities Eas nodes, with edges\ndeﬁned over a set of relations R, i.e. KG =\n{(p, r, e) |p ∈E, r ∈R, e ∈E}, where p is a par-\nent entity with relation r to another entity e. Prac-\ntical KGs have other aspects that make this for-\nmulation somewhat inexact: some relations are to\nliteral values , such as numbers and dates, facts\nmay be expressed as properties on relations, and\nentities have aliases as the set of strings that can\nrefer to the entity . W e also deﬁne a local knowl-\nedge graph for a subset of entities E<t as KG<t =\n{(p, r, e) |p ∈E<t, r ∈R, e ∈E}, i.e. contains\nentities E<t and all facts they participate in.\n2.2 Generative KG Language Model\nThe primary goal of the knowledge graph lan-\nguage model (KGLM) is to enable a neural lan-\nguage model to generate entities and facts from\na knowledge graph. T o encourage the model to\ngenerate facts that have appeared in the context\nalready , KGLM will maintain a local knowledge\ngraph containing all facts involving entities that\nhave appeared in the context. As the model decides\nto refer to entities that have not been referred to\nyet, it will grow the local knowledge graph with\nadditional entities and facts to reﬂect the new entity .\nFormally , we will compute p(xt, Et|x<t, E<t)\nwhere x<t is the sequence of observed tokens, E<t\nis the set of entities mentioned in x<t, and KG<t is\nthe local knowledge graph determined by E<t, as\ndescribed above. The generative process is:\n5964\nSuper Mario Land is a 1989 side-scrolling platform video game developed and published by      \nAAA I nc.\nSony I nc.\n. . .\n. . .\nZzyzx,  CA\npl at f or m  gam e\nSuper  M ar i o Land\n. . .\nsi de- scr ol l i ng gam e\nSuper  \nM ar i o Land Ni nt endo\nG am e Boy\npl at f or m  \ngam e\n1989\nPUBLI SHER\nG ENRE\nPLATFO RMPUB. DATE\na\nthe\ndog\n...\ncompany\nKabushiki\nKoppai\nNintendo\n...\nRelation to\nExisting Entity\nMention of a \nNew Entity\nNot an \nEntity Mention\nDistribution over standard \nvocabulary and aliases of et\nDistribution over \nstandard vocabulary\nstandard vocabulary\naliases of et\nSELF\nNintendo\npick from all entities\nparent from local entities\nFigure 2: KGLM Illustration. When trying to generate the token following “ published by”, the model ﬁrst decides\nthe type of the mention ( tt) to be a related entity (darker indicates higher probability), followed by identifying the\nparent ( pt), relation ( rt), and entity to render ( et) from the local knowledge graph as ( Super Mario Land, Publisher,\nNintendo). The ﬁnal distribution over the words includes the standard vocabulary along with aliases of Nintendo,\nand the model selects “ Nintendo” as the token xt. Facts related to Nintendo will be added to the local graph.\n•Decide the type of xt, which we denote by\ntt: whether it is a reference to an entity in\nKG<t (related), a reference to an entity not in\nKG<t (new), or not an entity mention ( ∅).\n•If tt = new then choose the upcoming entity et\nfrom the set of all entities E.\n•If tt = related then:\n– Choose a parent entity pt from E<t.\n– Choose a factual relation rt to render,\nrt ∈{(p, r, e) ∈KG<t|p = pt}.\n– Choose et as one of the tail entities,\net ∈{e|(pt, rt, e) ∈KG<t}.\n•If tt = ∅then et = ∅.\n•Generate xt conditioned on et, potentially copy-\ning one of et’s aliases.\n•If et /∈E<t, then E<(t+1) ←E<t ∪{et},\nelse E<(t+1) ←E<t.\nFor the model to refer to an entity it has already\nmentioned, we introduce a\nReﬂexive relation that\nself-relates, i.e. p = e for (p, Reﬂexive , e).\nAn illustration of this process and the variables\nis provided in Figure 2, for generating a token in\nthe middle of the same sentence as in Figure 1.\nAmongst the three mention types ( tt), the model\nchooses a reference to existing entity , which re-\nquires picking a fact to render. As the parent entity\nof this fact ( pt), the model picks Super Mario Land,\nand then follows the Publisher relation ( rt) to se-\nlect Nintendo as the entity to render ( et). When\nrendering Nintendo as a token xt, the model has an\nexpanded vocabulary available to it, containing the\nstandard vocabulary along with all word types in\nany of the aliases of et.\nMarginalizing out the KG There is a mismatch\nbetween our initial task requirement, p(xt|x<t),\nand the model we describe so far, which computes\np(xt, Et|x<t, E<t). W e will essentially marginal-\nize out the local knowledge graph to compute the\nprobability of the tokens, i.e. p(x) = ∑\nE p(x, E).\nW e will clarify this, along with describing the train-\ning and the inference/decoding algorithms for this\nmodel and other details of the setup, in Section 4.\n2.3 Parameterizing the Distributions\nThe parametric distributions used in the generative\nprocess above are deﬁned as follows. W e begin\nby computing the hidden state\nht using the for-\nmula in Eqn (1). W e then split the vector into\nthree components: ht = [ ht,x; ht,p; ht,r], which\nare respectively used to predict words, parents, and\nrelations. The type of the token, tt, is computed\nusing a single-layer softmax over ht,x to predict\none of {new, related, ∅}.\nPicking an Entity W e also introduce pretrained\nembeddings for all entities and relations in the\n5965\nknowledge graph, denoted by ve for entity e and\nvr for relation r. T o select et from all entities in\ncase tt = new, we use:\np(et) = softmax(ve ·(ht,p + ht,r))\nover all e ∈E. The reason we add ht,p and ht,r is\nto mimic the structure of TransE, which we use to\nobtain entity and relation embeddings. Details on\nTransE will be provided in Section 4. For mention\nof a related entity , tt = related, we pick a parent\nentity pt using\np(pt) = softmax(vp ·ht,p)\nover all p ∈Et, then pick the relation rt using\np(rt) = softmax(vr ·ht,r)\nover all r ∈{r|(pt, r, e) ∈KGt}. The combina-\ntion of pt and rt determine the entity et (which\nmust satisfy (pt, rt, et) ∈KGt; if there are multi-\nple options one is chosen at random).\nRendering the Entity\nIf et = ∅, i.e. there is\nno entity to render, we use the same distribution\nover the vocabulary as in Eqn (1) - a softmax using\nht,x. If there is an entity to render, we construct\nthe distribution over the original vocabulary and\na vocabulary containing all the tokens that appear\nin aliases of et. This distribution is conditioned\non et in addition to xt. T o compute the scores\nover the original vocabulary , ht,x is replaced by\nh′\nt,x = Wproj[ht,x; vet ]\nwhere Wproj is a learned\nweight matrix that projects the concatenated vector\ninto the same vector space as ht,x.\nT o obtain probabilities for words in the alias\nvocabulary , we use a copy mechanism Gu et al.\n(2016). The token sequences comprising each alias\n{aj}are embedded then encoded using an LSTM\nto form vectors aj. Copy scores are computed as:\np(xt = aj) ∝exp\n[\nσ\n( (\nh′\nt,x\n) T Wcopy\n)\naj\n]\n3 Linked WikiT ext-2\nModeling aside, one of the primary barriers to in-\ncorporating factual knowledge into language mod-\nels is that training data is hard to obtain. Standard\nlanguage modeling corpora consist only of text,\nand thus are unable to describe which entities or\nfacts each token is referring to. In contrast, while\nrelation extraction datasets link text to a knowledge\ngraph, the text is made up of disjoint sentences that\ndo not provide sufﬁcient context to train a pow-\nerful language model. Our goals are much more\naligned to the data-to-text task (\nAhn et al. , 2016;\nLebret et al. , 2016; Wiseman et al. , 2017; Y ang\net al. , 2017; Gardent et al. , 2017; Ferreira et al. ,\n2018), where a small table-sized KB is provided to\ngenerate a short piece of text; we are interested in\nlanguage models that dynamically decide the facts\nto incorporate from the knowledge graph, guided\nby the discourse.\nFor these reasons we introduce the Linked\nWikiT ext-2dataset, consisting of (approximately)\nthe same articles appearing in the WikiT ext-2lan-\nguage modeling corpus, but linked to the Wiki-\ndata (\nVrandeˇci´c and Krötzsch , 2014) knowledge\ngraph. Because the text closely matches, mod-\nels trained on Linked WikiT ext-2can be compared\nto models trained on WikiT ext-2. Furthermore,\nbecause many of the facts in Wikidata are de-\nrived from Wikipedia articles, the knowledge graph\nhas a good coverage of facts expressed in the\ntext. The dataset is available for download at:\nhttps://rloganiv.github.io/linked-wikitext-2. Our\nsystem annotates one document at a time, and con-\nsists of entity linking, relation annotations, and\npost-processing. The following paragraphs de-\nscribe each step in detail.\nInitial entity annotations\nW e begin by identify-\ning an initial set of entity mentions within the text.\nThe primary source of these mentions is the human-\nprovided links between Wikipedia articles. When-\never a span of text is linked to another Wikipedia\narticle, we associate its corresponding Wikidata\nentity with the span. While article links provide a\nlarge number of gold entity annotations, they are in-\nsufﬁcient for capturing all of the mentions in the ar-\nticle since entities are only linked the ﬁrst time they\noccur. Accordingly , we use the neural-el ( Gupta\net al. , 2017) entity linker to identify additional links\nto Wikidata, and identify coreferences using Stan-\nford CoreNLP 2 to cover pronouns, nominals, and\nother tokens missed by the linker.\nLocal knowledge graph\nThe next step iteratively\ncreates a generative story for the entities using rela-\ntions in the knowledge graph as well as identiﬁes\nnew entities. T o do this, we process the text token\nby token. Each time an entity is encountered, we\nadd all of the related entities in Wikidata as candi-\n2 https://stanfordnlp.github.io/CoreNLP/\n5966\nT okens xt Super Mario Land is a 1989 side - scrolling platform video game developed\nMention type tt new ∅ ∅ related new related ∅\nEntity Mentioned et SML ∅ ∅ 04-21-1989 SIDE_SCROLL PVG ∅\nRelation rt ∅ ∅ ∅ pub date ∅ genre ∅\nParent Entity pt ∅ ∅ ∅ SML ∅ SML ∅\nxt and published by Nintendo as a launch title for their Game Boy handheld game console .\ntt ∅ ∅ ∅ related ∅ ∅ new ∅ ∅ related related ∅\net ∅ ∅ ∅ NIN ∅ ∅ L T ∅ ∅ GAME_BOY HGC ∅\nrt ∅ ∅ ∅ pub ∅ ∅ ∅ ∅ ∅ R:manu / platform instance of ∅\npt ∅ ∅ ∅ SML ∅ ∅ ∅ ∅ ∅ NIN / SML GAME_BOY ∅\nT able 1: Example Annotation of the sentence from Figure 1, including corresponding variables from Figure 2.\nNote that Game Boy has multiple parent and relation annotations, as the platform for Super Mario Land and as\nmanufactured by Nintendo. Wikidata identiﬁers are made human-readable (e.g., SML is Q647249) for clarity .\ndates for matching. If one of these related entities\nis seen later in the document, we identify the entity\nas a parent for the later entity . Since multiple re-\nlations may appear as explanations for each token,\nwe allow a token to have multiple facts.\nExpanding the annotations Since there may be\nentities that were missed in the initial set, as well\nas non-entity tokens of interest such as dates and\nquantities we further expand the entity annotations\nusing string matching. For entities, we match the\nset of aliases provided in Wikidata. For dates, we\ncreate an exhaustive list of all of the possible ways\nof expressing the date (e.g. \" December 7, 1941\",\n\"7-12-1941\", \" 1941\", ...). W e perform a similar\napproach for quantities, using the pint library in\nPython to handle the different ways of expressing\nunits (e.g. \" g\", \" gram\", ...). Since there are many\nways to express a numerical quantity , we only ren-\nder the quantity at the level of precision supplied\nby Wikidata, and do not perform unit conversions.\nExample Annotation\nAn example annotation is\nprovided in T able 1 corresponding to the instance in\nFigure 1, along with the variables that correspond\nto the generative process of the knowledge graph\nlanguage model (KGLM). The entity mentioned for\nmost tokens here are human-provided links, apart\nfrom “ 1989” that is linked to 04-21-1989 by the\nstring matching process. The annotations indicate\nwhich of the entities are new and related based on\nwhether they are reachable by entities linked so far,\nclearly making a mistake for side-scrolling game\nand platform video game due to missing links in\nWikidata. Finally , multiple plausible reasons for\nGame Boy are included: it’s the platform for Super\nMario Land and it is manufactured by Nintendo,\neven though only the former is more relevant here.\nT rain Dev T est\nDocuments 600 60 60\nT okens 2,019,195 207,982 236,062\nV ocab. Size 33,558 - -\nMention T okens 207,803 21,226 24,441\nMention Spans 122,983 12,214 15,007\nUnique Entities 41,058 5,415 5,625\nUnique Relations 1,291 484 504\nT able 2: Linked WikiT ext-2Corpus Statistics.\nEven with these omissions and mistakes, it is clear\nthat the annotations are rich and detailed, with a\nhigh coverage, and thus should prove beneﬁcial for\ntraining knowledge graph language models.\nDataset Statistics\nStatistics for Linked WikiT ext-2\nare provided in T able 2. In this corpus, more than\n10% of the tokens are considered entity tokens, i.e.\nthey are generated as factual references to informa-\ntion in the knowledge graph. Each entity is only\nmentioned a few times (less than 5 on average, with\na long tail), and with more than thousand different\nrelations. Thus it is clear that regular language\nmodels would not be able to generate factual text,\nand there is a need for language models to be able\nto refer to external sources of information.\nDifferences from WikiT ext-2\nAlthough our\ndataset is designed to closely replicate WikiT ext-2,\nthere are some differences that prevent direct com-\nparison. Firstly , there are minor variations in text\nacross articles due to edits between download dates.\nSecondly , according to correspondence with\nMerity\net al. (2017), WikiT ext-2was collected by querying\nthe Wikipedia T ext API. Because this API discards\nuseful annotation information (e.g. article links),\nLinked WikiT ext-2instead was created by directly\nfrom the article HTML.\n5967\n4 T raining and Inference for KGLM\nIn this section, we describe the training and infer-\nence algorithm for KGLM.\nPretrained KG Embeddings\nDuring evaluation,\nwe may need to make predictions on entities and\nrelations that have not been seen during training.\nAccordingly , we use ﬁxed entity and relations em-\nbeddings pre-trained using TransE ( Bordes et al. ,\n2013) on Wikidata. Given (p, r, e), we learn em-\nbeddings vp, vr and ve to minimize the distance:\nδ(vp, vr, ve) = ∥vp + vr −ve∥2 .\nW e use a max-margin loss to learn the embeddings:\nL= max\n(\n0, γ + δ (vp, vr, ve) −δ\n(\nv′\np, vr, v′\ne\n))\nwhere γ is the margin, and either p′ or e′ is a ran-\ndomly chosen entity embedding.\nT raining with Linked WikiT ext-2 Although the\ngenerative process in KGLM involves many steps,\ntraining the model on Linked WikiT ext-2is straight-\nforward. Our loss objective is the negative log-\nlikelihood of the training data:\nℓ(Θ) =\n∑\nt\nlog p(xt, Et|x<t, E<t; Θ) ,\nwhere Θ is the set of model parameters. Note that\nif an annotation has multiple viable parents such as\nGame Boy in 1, then we marginalize over all of the\nparents. Since all random variables are observed,\ntraining can performed using off-the-shelf gradient-\nbased optimizers.\nInference\nWhile observing annotations makes the\nmodel easy to train, we do not assume that the\nmodel has access to annotations during evaluation.\nFurthermore, as discussed in Section 2.2, the goal\nin language modelling is to measure the marginal\nprobability p(x) = ∑\nE p(x, E) not the joint proba-\nbility . However, this sum is intractable to compute\ndue to the large combinatorial space of possible\nannotations. W e address this problem by approxi-\nmating the marginal distribution using importance\nsampling. Given samples from a proposal distribu-\ntion q(E|x) the marginal distribution is:\np(x) =\n∑\nE\np (x, E) =\n∑\nE\np (x, E)\nq (E|x) q (E|x)\n≈ 1\nN\n∑\nE∼q\np (x, E)\nq (E|x)\nThis approach is used to evaluate models in Ji et al.\n(2017) and Dyer et al. (2016). Following Ji et al.\n(2017), we compute q (E|x) using a discriminative\nversion of our model that predicts annotations for\nthe current token instead of for the next token.\n5 Experiments\nT o evaluate the proposed language model, we\nﬁrst introduce the baselines, followed by an evalua-\ntion using perplexity of held-out corpus, accuracy\non fact completion, and an illustration of how the\nmodel uses the knowledge graph.\n5.1 Evaluation Setup\nBaseline Models\nW e compare KGLM to the fol-\nlowing baseline models:\n•A WD-LSTM (Merity et al. , 2018): strong\nLSTM-based model used as the foundation of\nmost state-of-the-art models on WikiT ext-2.\n•EN T I T YNLM (Ji et al. , 2017): an LSTM-based\nlanguage model with the ability to track entity\nmentions. Embeddings for entities are created dy-\nnamically , and are not informed by any external\nsources of information.\n•EntityCopyNet: a variant of the KGLM where\ntt = new for all mentions, i.e. entities are\nselected from Eand entity aliases are copied, but\nrelations in the knowledge graph are unused.\nHyperparameters W e pre-train 256 dimensional\nentity and relation embeddings for all entities\nwithin two hops of the set of entities that occur in\nLinked WikiT ext-2using TransE with margin γ = 1 .\nW eights are tied between all date embeddings and\nbetween all quantity embeddings to save memory .\nFollowing Merity et al. (2018) we use 400 dimen-\nsional word embeddings and a 3 layer LSTM with\nhidden dimension 1150 to encode tokens. W e also\nemploy the same regularization strategy (DropCon-\nnect ( W an et al. , 2013) + Dropout( Srivastava et al. ,\n2014)) and weight tying approach. However, we\nperform optimization using Adam ( Kingma and Ba ,\n2015) with learning rate 1e-3 instead of NT -ASGD,\nhaving found that it is more stable.\n5.2 Results\nPerplexity\nW e evaluate our model using the stan-\ndard perplexity metric: exp\n(\n1\nT\n∑ T\nt=1 log p(xt)\n)\n.\nHowever, perplexity suffers from the issue that it\n5968\nPPL UPP\nEN T I T YNLM * (Ji et al. , 2017) 85.4 189.2\nEntityCopyNet* 76.1 144.0\nA WD-LSTM (Merity et al. , 2018) 74.8 165.8\nKGLM* 44.1 88.5\nT able 3: Perplexity Results on Linked WikiT ext-2. Re-\nsults for models marked with * are obtained using im-\nportance sampling.\noverestimates the probability of out-of-vocabulary\ntokens when they are mapped to a single UNK\ntoken. This is problematic for comparing the per-\nformance of the KGLM to traditional language\nmodels on Linked WikiT ext-2since there are a large\nnumber of rare entities whose alias tokens are out-\nof-vocabulary . That is, even if the KGLM identiﬁes\nthe correct entity and copies the correct alias token\nwith high probability , other models can attain bet-\nter perplexity by assigning a higher probability to\nUNK. Accordingly , we also measure unknown pe-\nnalized perplexity (UPP) (a.k.a adjusted perplexity)\nintroduced by Ueberla (1994), and used recently\nby Ahn et al. (2016) and Spithourakis and Riedel\n(2018). This metric penalizes the probability of\nUNK tokens by evenly dividing their probability\nmass over\nU, the set of tokens that get mapped\nto UNK . W e can be compute UPP by replacing\np(UNK) in the perplexity above by 1\n|U| p(UNK),\nwhere |U|is estimated from the data.\nW e present the model perplexities in T able 3. T o\nmarginalize over annotations, perplexities for the\nEN T I T YNLM, EntityCopyNet, and KGLM are es-\ntimated using the importance sampling approach\ndescribed in Section 4. W e observe that the KGLM\nattains substantially lower perplexity than the other\nentity-based language models (44.1 vs. 76.1/85.4),\nproviding strong evidence that leveraging knowl-\nedge graphs is crucial for accurate language mod-\neling. Furthermore, KGLM signiﬁcantly outper-\nforms all models in unknown penalized perplexity ,\ndemonstrating its ability to generate rare tokens.\nFact Completion\nSince factual text generation\nis our primary objective, we evaluate the ability\nof language models to complete sentences with\nfactual information. W e additionally compare with\nthe small GPT -2 (Radford et al. , 2019), a language\nmodel trained on a much larger corpus of text. W e\nselect 6 popular relations from Freebase, and write\na simple completion template for each, such as “ X\nwas born in ” for the birthplace relation. W e\nA WD-\nLSTM GPT -2 KGLM\nOracle NEL\nnation-capital 0 / 0 6 / 7 0 / 0 0 / 4\nbirthloc 0 / 9 14 / 14 94 / 95 85 / 92\nbirthdate 0 / 25 8 / 9 65 / 68 61 / 67\nspouse 0 / 0 2 / 3 2 / 2 1 / 19\ncity-state 0 / 13 62 / 62 9 / 59 4 / 59\nbook-author 0 / 2 0 / 0 61 / 62 25 / 28\nA verage 0.0/8.2 15.3/15.8 38.5/47.7 29.3/44.8\nT able 4: Fact Completion . T op- k accuracy\n(@1/@5,%) for predicting the next token for an incom-\nplete factual sentence. See examples in T able 5.\ngenerate sentences for these templates for a number\nof (X, Y ) pairs for which the relation holds, and\nmanually examine the ﬁrst token generated by each\nlanguage model to determine whether it is correct.\nT able 4 presents performance of each language\nmodel on the relations. The oracle KGLM is given\nthe correct entity annotation for X, while the NEL\nKGLM uses the discriminative model used for im-\nportance sampling combined with the NEL entity\nlinker to produce an entity annotation for X.\nAmongst models trained on the same data, both\nKGLM variants signiﬁcantly outperform A WD-\nLSTM; they produce accurate facts, while A WD-\nLSTM produced generic, common words. KGLMs\nare also competitive with models trained on orders\nof magnitude more data, producing factual com-\npletions that require speciﬁc knowledge, such as\nbirthplaces, dates, and authors. However, they do\nnot capture facts or relations that frequently appear\nin large corpora, like the cities within states. 3 It is\nencouraging to see that the KGLM with automatic\nlinking performs comparably to oracle linking.\nW e provide examples in T able 5 to highlight\nqualitative differences between KGLM, trained on\n600 documents, and the recent state-of-the-art lan-\nguage model, GPT -2, trained on the W ebT ext cor-\npus with over 8 million documents ( Radford et al. ,\n2019). For examples that both models get factu-\nally correct or incorrect, the generated tokens by\nKGLM are often much more speciﬁc, as opposed\nto selection of more popular/generic tokens (GPT -2\noften predicts “New Y ork” as the birthplace, even\nfor popular entities). KGLM, in particular, gets\nfactual statements correct when the head or tail en-\ntities are rare, while GPT -2 can only complete facts\nfor more-popular entities while using more-generic\ntokens (such as “ January” instead of “ 20”).\n3 This is not a failure of the KG, but of the model’s ability\nto pick the correct relation from the KG given the prompt.\n5969\nInput Sentence Gold GPT -2 KGLM\nBoth correct Paris Hilton was born in New Y ork City New 1981\nArnold Schwarzenegger was born on 1947-07-30 July 30\nKGLM correct\nBob Dylan was born in Duluth New Duluth\nBarack Obama was born on 1961-08-04 January August\nUlysses is a book that was written by James Joyce a James\nGPTv2 correct\nSt. Louis is a city in the state of Missouri Missouri Oldham\nRichard Nixon was born on 1913-01-09 January 20\nKanye W est is married to Kim Kardashian Kim the\nBoth incorrect The capital of India is New Delhi the a\nMadonna is married to Carlos Leon a Alex\nT able 5: Completion Examples. Examples of fact completion by KGLM and GPT -2, which has been trained on\na much larger corpus. GPT -2 tends to produce very common and general tokens, such as one of a few popular\ncities to follow “ born in”. KGLM sometimes makes mistakes in linking to the appropriate fact in the KG, however,\nthe generated facts are more speciﬁc and contain rare tokens. W e omit A WD-LSTM from this ﬁgure as it rarely\nproduced tokens apart from the generic “ the” or “ a”, or “ ⟨UNK⟩”.\nEffect of changing the KG\nFor most language\nmodels, it is difﬁcult to control their generation\nsince factual knowledge is entangled with gener-\nation capabilities of the model. For KGLM, an\nadditional beneﬁt of its use of an external source\nof knowledge is that KGLM is directly control-\nlable via modiﬁcations to the KG. T o illustrate this\ncapability with a simple example, we create com-\npletion of “ Barack Obama was born on\n” with\nthe original fact ( Barack Obama, birthDate, 1961-\n08-04), resulting in the top three decoded tokens\nas “ August”, “ 4”, “ 1961”. After changing the birth\ndate to 2013-03-21, the top three decoded tokens\nbecome “ March”, “ 21”, “ 2013”. Thus, changing\nthe fact in the knowledge graph directly leads to a\ncorresponding change in the model’s prediction.\n6 Related W ork\nKnowledge-based language models\nOur work\ndraws inspiration from two existing knowledge-\nbased language models:\n(i) E N T I T YNLM ( Ji et al. , 2017) which im-\nproves a language model’s ability to track entities\nby jointly modeling named entity recognition and\ncoreference. Our model similarly tracks entities\nthrough a document, improving its ability to gener-\nate factual information by modeling entity linking\nand relation extraction.\n(ii) The neural knowledge language model\n(NKLM) ( Ahn et al. , 2016) which established the\nidea of leveraging knowledge graphs in neural lan-\nguage models. The main differentiating factor be-\ntween the KGLM and NKLM is that the KGLM\noperates on an entire knowledge graph and can be\nevaluated on text without additional conditioning\ninformation, whereas the NKLM operates on a rel-\natively smaller set of predeﬁned edges emanating\nfrom a single entity , and requires that entity be pro-\nvided as conditioning information ahead of time.\nThis requirement precludes direct comparison be-\ntween NKLM and the baselines in Section 5.\nData-to-text generation Our work is also related\nto the task of neural data-to-text generation. For\na survey of early non-neural text generation meth-\nods we refer the reader to Reiter and Dale (1997).\nRecent neural methods have been applied to gener-\nating text from tables of sports statistics (\nWiseman\net al. , 2017), lists and tables ( Y ang et al. , 2017), and\nWikipedia info-boxes ( Lebret et al. , 2016). The pri-\nmary difference between these works and ours is\nour motivation. These works focus on generating\ncoherent text within a narrow domain (e.g. sports,\nrecipes, introductory sentences), and optimize met-\nrics such as BLEU and METEOR score. Our focus\ninstead is to use a large source of structured knowl-\nedge to improve language model’s ability to handle\nrare tokens and facts on a broad domain of topics,\nand our emphasis is on improving perplexity .\nGeneral language modeling\nAlso related are the\nrecent papers proposing modiﬁcations to the A WD-\nLSTM that improve performance on Wikitext-\n2 (Gong et al. , 2018; Y ang et al. , 2018; Krause\net al. , 2018). W e chose to benchmark against A WD-\nLSTM since these contributions are orthogonal,\nand many of the techniques are compatible with\nthe KGLM. KGLM improves upon A WD-LSTM,\nand we expect using KGLM in conjunction with\nthese methods will yield further improvement.\n5970\n7 Conclusions and Future W ork\nBy relying on memorization, existing language\nmodels are unable to generate factually correct text\nabout real-world entities. In particular, they are\nunable to capture the long tail of rare entities and\nword types like numbers and dates. In this work,\nwe proposed the knowledge graph language model\n(KGLM), a neural language model that can access\nan external source of facts, encoded as a knowledge\ngraph, in order to generate text. Our implementa-\ntion is available at: https://github.com/rloganiv/\nkglm-model. W e also introduced Linked WikiT ext-\n2 containing text that has been aligned to facts in\nthe knowledge graph, allowing efﬁcient training\nof the model. Linked WikiT ext-2is freely avail-\nable for download at:\nhttps://rloganiv.github.io/\nlinked-wikitext-2. In our evaluation, we showed\nthat by utilizing this graph, the proposed KGLM\nis able to generate higher-quality , factually correct\ntext that includes mentions of rare entities and spe-\nciﬁc tokens like numbers and dates.\nThis work lays the groundwork for future re-\nsearch into knowledge-aware language modeling.\nThe limitations of the KGLM model, such as the\nneed for marginalization during inference and re-\nliance on annotated tokens, raise new research prob-\nlems for advancing neural NLP models. Our dis-\ntantly supervised approach to dataset creation can\nbe used with other knowledge graphs and other\nkinds of text as well, providing opportunities for\naccurate language modeling in new domains.\nAcknowledgements\nFirst and foremost, we would like to thank Stephen\nMerity for sharing the materials used to collect the\nWikiT ext-2dataset, and Nitish Gupta for modify-\ning his entity linker to assist our work. W e would\nalso like to thank Dheeru Dua and Anthony Chen\nfor their thoughtful feedback. This work was sup-\nported in part by Allen Institute of Artiﬁcial In-\ntelligence (AI2), and in part by NSF award #IIS-\n1817183. The views expressed are those of the\nauthors and do not reﬂect the ofﬁcial policy or po-\nsition of the funding agencies.\nReferences\nSungjin Ahn, Heeyoul Choi, T anel Pärnamaa, and\nY oshua Bengio. 2016. A neural knowledge language\nmodel. ArXiv:1608.00318.\nAntoine Bordes, Nicolas Usunier, Alberto Garcia-\nDuran, Jason W eston, and Oksana Y akhnenko.\n2013. Translating embeddings for modeling multi-\nrelational data. In Proc. of NeurIPS.\nChris Dyer, Adhiguna Kuncoro, Miguel Ballesteros,\nand Noah A. Smith. 2016. Recurrent neural network\ngrammars. In Proc. of NAACL.\nThiago Castro Ferreira, Diego Moussallem, Emiel\nKrahmer, and Sander Wubben. 2018. Enriching the\nW ebNLG corpus. In Proc. of INLG.\nClaire Gardent, Anastasia Shimorina, Shashi Narayan,\nand Laura Perez-Beltrachini. 2017. The W ebNLG\nchallenge: Generating text from RDF data. In Proc.\nof INLG.\nChengyue Gong, Di He, Xu T an, T ao Qin, Liwei W ang,\nand Tie-Y an Liu. 2018. Frage: frequency-agnostic\nword representation. In Proc. of NeurIPS.\nJiatao Gu, Zhengdong Lu, Hang Li, and V ictor O.K.\nLi. 2016. Incorporating copying mechanism in\nsequence-to-sequence learning. In Proc. of ACL.\nNitish Gupta, Sameer Singh, and Dan Roth. 2017.\nEn-\ntity linking via joint encoding of types, descriptions,\nand context\n. In Proc. of EMNLP.\nSepp Hochreiter and Jürgen Schmidhuber. 1997.\nLong short-term memory . Neural computation ,\n9(8):1735–1780.\nY angfeng Ji, Chenhao T an, Sebastian Martschat, Y ejin\nChoi, and Noah A. Smith. 2017. Dynamic entity\nrepresentations in neural language models. In Proc.\nof EMNLP.\nDiederik P . Kingma and Jimmy Ba. 2015. Adam:\nA method for stochastic optimization. In Proc. of\nICLR.\nBen Krause, Emmanuel Kahembwe, Iain Murray , and\nSteve Renals. 2018. Dynamic evaluation of neural\nsequence models. In Proc. of ICML.\nRémi Lebret, David Grangier, and Michael Auli. 2016.\nNeural text generation from structured data with\napplication to the biography domain. In Proc. of\nEMNLP.\nStephen Merity , Nitish Shirish Keskar, and Richard\nSocher. 2018. Regularizing and optimizing LSTM\nlanguage models. In Proc. of ICLR.\nStephen Merity , Caiming Xiong, James Bradbury , and\nRichard Socher. 2017. Pointer sentinel mixture mod-\nels. In Proc. of ICLR.\n5971\nT omáš Mikolov , Martin Karaﬁát, Lukáš Burget, Jan\nˇCernock `y, and Sanjeev Khudanpur. 2010. Recurrent\nneural network based language model. In Proc. of\nINTERSPEECH.\nAlec Radford, Jeff Wu, Rewon Child, David Luan,\nDario Amodei, and Ilya Sutskever. 2019. Language\nmodels are unsupervised multitask learners. T echni-\ncal report, OpenAI.\nEhud Reiter and Robert Dale. 1997. Building applied\nnatural language generation systems. Natural Lan-\nguage Engineering, 3(1):57–87.\nIulian V . Serban, Alessandro Sordoni, Y oshua Bengio,\nAaron Courville, and Joelle Pineau. 2016. Building\nend-to-end dialogue systems using generative hierar-\nchical neural network models. In Proc. of AAAI.\nGeorgios P . Spithourakis and Sebastian Riedel. 2018.\nNumeracy for language models: Evaluating and im-\nproving their ability to predict numbers. In Proc. of\nACL.\nNitish Srivastava, Geoffrey Hinton, Alex Krizhevsky ,\nIlya Sutskever, and Ruslan Salakhutdinov . 2014.\nDropout: a simple way to prevent neural networks\nfrom overﬁtting. The Journal of Machine Learning\nResearch, 15(1):1929–1958.\nTrieu H. Trinh and Quoc V . Le. 2019. Do language\nmodels have common sense? In Proc. of ICLR.\nJoerg Ueberla. 1994.\nAnalysing a simple language\nmodelÂ·some general conclusions for language\nmodels for speech recognition . Computer Speech &\nLanguage, 8(2):153 – 176.\nOriol V inyals and Quoc V . Le. 2015. A neural con-\nversational model. Proc. of ICML Deep Learning\nW orkshop.\nDenny Vrande ˇci´c and Markus Krötzsch. 2014. Wiki-\ndata: A free collaborative knowledgebase . Commu-\nnications of the ACM, 57(10):78–85.\nLi W an, Matthew Zeiler, Sixin Zhang, Y ann LeCun,\nand Rob Fergus. 2013. Regularization of neural net-\nworks using dropconnect. In Proc. of ICML.\nSam Wiseman, Stuart M. Shieber, and Alexander M.\nRush. 2017. Challenges in data-to-document gener-\nation. In Proc. of EMNLP.\nZhilin Y ang, Zihang Dai, Ruslan Salakhutdinov , and\nWilliam W Cohen. 2018. Breaking the softmax bot-\ntleneck: A high-rank RNN language model. In Proc.\nof ICLR.\nZichao Y ang, Phil Blunsom, Chris Dyer, and W ang\nLing. 2017. Reference-aware language models. In\nProc. of EMNLP.",
  "topic": "Computer science",
  "concepts": [
    {
      "name": "Computer science",
      "score": 0.8619558811187744
    },
    {
      "name": "Language model",
      "score": 0.6929482221603394
    },
    {
      "name": "Knowledge graph",
      "score": 0.6524274349212646
    },
    {
      "name": "Natural language processing",
      "score": 0.6359527111053467
    },
    {
      "name": "Vocabulary",
      "score": 0.6314422488212585
    },
    {
      "name": "ENCODE",
      "score": 0.6261985301971436
    },
    {
      "name": "Artificial intelligence",
      "score": 0.5976170301437378
    },
    {
      "name": "Copying",
      "score": 0.5441367626190186
    },
    {
      "name": "Graph",
      "score": 0.49211567640304565
    },
    {
      "name": "Theoretical computer science",
      "score": 0.20402541756629944
    },
    {
      "name": "Linguistics",
      "score": 0.14232394099235535
    },
    {
      "name": "Political science",
      "score": 0.0
    },
    {
      "name": "Philosophy",
      "score": 0.0
    },
    {
      "name": "Gene",
      "score": 0.0
    },
    {
      "name": "Chemistry",
      "score": 0.0
    },
    {
      "name": "Biochemistry",
      "score": 0.0
    },
    {
      "name": "Law",
      "score": 0.0
    }
  ],
  "institutions": [
    {
      "id": "https://openalex.org/I204250578",
      "name": "University of California, Irvine",
      "country": "US"
    },
    {
      "id": "https://openalex.org/I4210156221",
      "name": "Allen Institute for Artificial Intelligence",
      "country": "US"
    },
    {
      "id": "https://openalex.org/I201448701",
      "name": "University of Washington",
      "country": "US"
    }
  ]
}