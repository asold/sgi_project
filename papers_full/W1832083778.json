{
    "title": "PHACCS, an online tool for estimating the structure and diversity of uncultured viral communities using metagenomic information",
    "url": "https://openalex.org/W1832083778",
    "year": 2005,
    "authors": [
        {
            "id": "https://openalex.org/A5007154867",
            "name": "Florent Angly",
            "affiliations": [
                "École Supérieure de Biotechnologie de Strasbourg"
            ]
        },
        {
            "id": "https://openalex.org/A5038105924",
            "name": "Beltrán Rodriguez-Brito",
            "affiliations": [
                "San Diego State University"
            ]
        },
        {
            "id": "https://openalex.org/A5008171660",
            "name": "David Bangor",
            "affiliations": [
                "San Diego State University"
            ]
        },
        {
            "id": "https://openalex.org/A5026074221",
            "name": "Pat McNairnie",
            "affiliations": [
                "San Diego State University"
            ]
        },
        {
            "id": "https://openalex.org/A5029764074",
            "name": "Mya Breitbart",
            "affiliations": [
                "San Diego State University"
            ]
        },
        {
            "id": "https://openalex.org/A5084207421",
            "name": "Peter Salamon",
            "affiliations": [
                "San Diego State University"
            ]
        },
        {
            "id": "https://openalex.org/A5024053146",
            "name": "Ben Felts",
            "affiliations": [
                "San Diego State University"
            ]
        },
        {
            "id": "https://openalex.org/A5111754050",
            "name": "James Nulton",
            "affiliations": [
                "San Diego State University"
            ]
        },
        {
            "id": "https://openalex.org/A5111600675",
            "name": "Joseph M. Mahaffy",
            "affiliations": [
                "San Diego State University"
            ]
        },
        {
            "id": "https://openalex.org/A5026525836",
            "name": "Forest Rohwer",
            "affiliations": [
                "San Diego State University"
            ]
        }
    ],
    "references": [
        "https://openalex.org/W2098132478",
        "https://openalex.org/W2118001436",
        "https://openalex.org/W1964316434",
        "https://openalex.org/W2121009717",
        "https://openalex.org/W2176371198",
        "https://openalex.org/W2084149476",
        "https://openalex.org/W2022825068",
        "https://openalex.org/W2079706758",
        "https://openalex.org/W2127730569",
        "https://openalex.org/W2124937554",
        "https://openalex.org/W2124637227",
        "https://openalex.org/W2113601822",
        "https://openalex.org/W1966711026",
        "https://openalex.org/W2056947791",
        "https://openalex.org/W1967580594",
        "https://openalex.org/W1992264689",
        "https://openalex.org/W2152767964",
        "https://openalex.org/W1986966792",
        "https://openalex.org/W2099566093",
        "https://openalex.org/W2043196502",
        "https://openalex.org/W2222445509",
        "https://openalex.org/W2041905826",
        "https://openalex.org/W2051387058",
        "https://openalex.org/W1645047754",
        "https://openalex.org/W2041404167",
        "https://openalex.org/W2978725006",
        "https://openalex.org/W1995875735"
    ],
    "abstract": null,
    "full_text": "BioMed Central\nPage 1 of 9\n(page number not for citation purposes)\nBMC Bioinformatics\nOpen AccessSoftware\nPHACCS, an online tool for estimating the structure and diversity \nof uncultured viral communities using metagenomic information\nFlorent Angly1,2, Beltran Rodriguez-Brito2,4, David Bangor2,3, Pat McNairnie2, \nMya Breitbart2, Peter Salamon3, Ben Felts3, James Nulton3, Joseph Mahaffy3 \nand Forest Rohwer*2,5\nAddress: 1Ecole Supérieure de Biotechnologie de Strasbourg, Boulevard Sébastien Brandt, 67413 Illkirch, France, 2Department of Biology, San \nDiego State University, 5500 Campanile Drive, San Diego, California 92182, USA, 3Department of Mathematics and Statistics, San Diego State \nUniversity, 5500 Campanile Drive, San Diego, California 92182, USA, 4Computational Science Research Center, San Diego State University, 5500 \nCampanile Drive, San Diego, California 92182, USA and 5Center For Microbial Sciences, San Diego State University, 5500 Campanile Drive, San \nDiego, California 92182, USA\nEmail: Florent Angly - fangly@projects.sdsu.edu; Beltran Rodriguez-Brito - brodrigu@rohan.sdsu.edu; David Bangor - heimdalle@yahoo.com; \nPat McNairnie - arcum@cox.net; Mya Breitbart - mya@sunstroke.sdsu.edu; Peter Salamon - salamon@math.sdsu.edu; \nBen Felts - ben.felts@conexant.com; James Nulton - jnulton@mail.sdsu.edu; Joseph Mahaffy - mahaffy@math.sdsu.edu; \nForest Rohwer* - forest@sunstroke.sdsu.edu\n* Corresponding author    \nAbstract\nBackground: Phages, viruses that infect prokaryotes, are the most abundant microbes in the\nworld. A major limitation to studying these viruse s is the difficulty of cultivating the appropriate\nprokaryotic hosts. One way aro und this limitation is to di rectly clone and sequence shotgun\nlibraries of uncultured viral communities (i .e., metagenomic analys es). PHACCS http://\nphage.sdsu.edu/phaccs, Phage Communities from Contig Spectrum, is an online bioinformatic tool\nto assess the biodiversity of uncultured viral communities. PHACCS uses the contig spectrum from\nshotgun DNA sequence assemblies to mathematically model the structure of viral communities and\nmake predictions about diversity.\nResults: PHACCS builds models of possible comm unity structure using a modified Lander-\nWaterman algorithm to predi ct the underlying contig spectrum. PHACCS finds the most\nappropriate structure model by optimizing th e model parameters until  the predicted contig\nspectrum is as close as possible to the experi mental one. This model is the basis for making\nestimates of uncultured viral community richness, evenness, diversity index and abundance of the\nmost abundant genotype.\nConclusion: PHACCS analysis of four different envi ronmental phage communities suggests that\nthe power law is an important rank-abundance form to describe uncultured viral community\nstructure. The estimates support the fact that the four phage communities were extremely diverse\nand that phage community biodiversity and structure may be correlated with that of their hosts.\nPublished: 02 March 2005\nBMC Bioinformatics 2005, 6:41 doi:10.1186/1471-2105-6-41\nReceived: 18 December 2004\nAccepted: 02 March 2005\nThis article is available from: http://www.biomedcentral.com/1471-2105/6/41\n© 2005 Angly et al; licensee BioMed Central Ltd. \nThis is an Open Access article distributed under the terms of the Creative Commons Attribution License (http://creativecommons.org/licenses/by/2.0), \nwhich permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.\nBMC Bioinformatics 2005, 6:41 http://www.biomedcentral.com/1471-2105/6/41\nPage 2 of 9\n(page number not for citation purposes)\nBackground\nMost environmental viruses are phages (a.k.a., bacteri-\nophages) that infect prokaryotic cells, both Bacteria and\nArchaea. On average there are about ten phage particles\nper host cell [1]. Extrapolations from the number of\nprokaryotes [2] make phages the most abundant biologi-\ncal entities in the biosphere with an estimated 10 31 viral\nparticles. By killing prokaryotes, phages can strongly\nimpact microbial community biomass [3] and structure\n[4]. Despite their importance, very little is known about\nphage biodiversity.\nTraditionally, the study of environmental phage diversity,\ndynamics, and ecology requires growing prokaryotes on\nmicrobiology plates and infecting them with phages.\nHowever this standard technique is limited by the fact that\nonly a small fraction of environmental microbes are read-\nily cultured [5] and that each phage species generally only\nhas a very narrow number of possible microbial hosts [6].\nIn addition, even if it is possible to observe phages with an\nelectron microscope, pictures are not sufficient to identify\nspecies because of the low taxonomic resolution of viral\nmorphology. Cultivating and observing phages do not\npermit to assess environmental phage diversity.\nBiodiversity is composed of richness, or total number of\ndifferent species [7], and evenness, expressing the relative\nabundance of each species [8]. The Shannon-Wiener\nindex quantifies diversity as a single term combining rich-\nness and evenness [9]. A high richness and high evenness\ntogether represent a high level of diversity.\nA new approach to accessing natural microbial diversity is\nthrough the creation of shotgun sequence libraries from\nenvironmental metagenomes (sum of all genomes) [10-\n14], so that the genetic information of each genotype of\nthe community is recorded, qualitatively (sequence) and\nquantitatively (abundance of each sequence). The com-\nmunity is analyzed by sequencing a part of the library. The\nmetagenomic data used here is the contig spectrum, deter-\nmined by assembly of environmental random shotgun\nDNA fragments. The contig spectrum is a vector contain-\ning the number of contigs (groups of overlapping\nsequences) of size q (number of sequences in the group)\n[10]. The stringency of the assembly parameters can be\nvaried so that only sequences belonging to the same gen-\notype overlap. Thus, for one genotype, the bigger the con-\ntigs in the contig spectrum, the higher the number of\ncopies and the more abundant this genotype. Based on\nthis, the contig spectrum provides important information\nabout the abundance and diversity of genotypes within a\ncommunity.\nIn this work, we present PHACCS (PHAge Communities\nfrom Contig Spectrum), an online computational tool to\nassess the diversity and structure of environmental viral\ncommunities from the contig spectrum of shotgun\nsequence data. The PHACCS program and its predictions\nare first described and then used to analyze four environ-\nmental viral communities.\nImplementation\nPlatform and software\nThe standalone core mathematics for PHACCS consists of\nMatlab (MathWorks Inc., Natick, MA.) scripts that are\npartly based on the previous works [10-12]. A CGI (Com-\nmon Gateway Interface) script written in PERL (Practical\nExtraction and Report Language) is used to input and out-\nput data from and to an HTML (Hyper Text Markup Lan-\nguage) interface. PHACCS was developed and tested on a\nLinux-based (2.6.6 kernel) personal computer running\nPERL 5.8.3 (with CGI module), Matlab 6.5.0, and Apache\n2.0.50 web server.\nObtaining a contig spectrum\nThe input for PHACCS is the contig spectrum, a vector\ncontaining the number of q-contigs (groups of q overlap-\nping sequences) from the in silico assembly of random\nshotgun DNA fragments. Detailed information about the\nway to get viral metagenomes and their contig spectrum\ncan be found in [10-12]. Briefly, viral communities were\nisolated via tangential flow filtration and cesium chloride\ncentrifugation, and their DNA was extracted. The DNA\nwas randomly fragmented, used to create a linker ampli-\nfied shotgun library [15] and clones were sequenced\n(between 500 and 1200 for studies [10-12]). The\nsequence assembly program Sequencher (Gene Codes\nCorp., Ann Arbor, MI.) was used to assemble phage\nsequences having at least 98% identity on at least 20 bp\n[10]. The stringency of the assembly parameters was\nexperimentally determined so that only fragments\nbelonging to the same genotype assemble together.\nClosely related phage genomes (e.g., coliphages T3 and\nT7) can be discriminated using these parameters [10]. The\nnumber of contigs of each size was then recorded to gen-\nerate the contig spectrum. The number of sequences in the\nlargest contig defines the contig spectrum degree.\nModified Lander-Waterman algorithm\nPHACCS uses a modified version of the Lander-Waterman\nalgorithm [16] to predict a contig spectrum from assumed\npopulation parameters. The original Lander-Waterman\nalgorithm is a way of predicting the contig spectrum of a\nrandomly fragmented genome (e.g., a single viral species)\ngiven: i) the length L of the genome, ii) the number N of\nDNA fragments studied, iii) the average size s of these frag-\nments, and iv) the minimum overlap length o for the\nsequence assembly [16]. Given this data, the predicted\nvalues of the following quantities are calculated:\nBMC Bioinformatics 2005, 6:41 http://www.biomedcentral.com/1471-2105/6/41\nPage 3 of 9\n(page number not for citation purposes)\n Probability p of an overlap: p = 1 - e-Nx/L with x = s - o\n Probability wq for a fragment to be part of a q-contig\n(overlap of q fragments):\nwq = qpq - 1 (1 - p)2\n Expected number of fragments cq that are part of a q-con-\ntig: cq = Nwq\n Contig spectrum: \nThe modified Lander-Waterman algorithm is a generaliza-\ntion of the original algorithm to a group of M different\ngenotypes (e.g., a whole viral community) [10]. The pre-\ndicted contig spectrum can be calculated as the sum of the\ncontig spectra for each individual genotype i.\n Expected number of fragments cq part of a q-contig:\nwqi is the probability for a fragment to be part of a q-contig\nfor the genotype i and ni is the expected number of frag-\nments for the genotype i.\nIn this modified algorithm, since there are several geno-\ntypes, an assumption about their underlying distribution\nwithin the community in terms of abundance has to be\nmade.\nRelative rank-abundance forms\nPHACCS offers six basic functional forms of relative rank-\nabundance for biological populations: the power law, log-\narithmic, exponential, broken stick, niche preemption,\nand lognormal distributions.\nThe first three functional forms are empirical models that\nwere designed to describe an asymptotic drop-off in the\nabundance [17]:\n Power: ni = ai-b for 1 ≤ i ≤ M\n Logarithmic: ni = a(log(i + 1))-b for 1 ≤ i ≤ M\n Exponential: ni = ae-ib for 1 ≤ i ≤ M\nThe parameter a represents the abundance of the most\nabundant genotype, b is a parameter related to the even-\nness, and M is the number of different genotypes in the\ncommunity.\nTwo ecological models are based on a partitioning of\nresources between species [18,19]:\n Broken stick:  for 1 ≤ i ≤ M\n Niche preemption: ni = Nk(1 - k)i - 1 and nM = N(1 - k)M -\n1 for 1 ≤ i ≤ M - 1\nThe broken stick function has only one parameter, M, and\nassumes a random distribution of resources, whereas in\nthe niche preemption function, each species takes only a\nfraction k of the remaining resources in the environment.\nThe sixth functional form is the lognormal distribution. It\nis the most commonly used species distribution, with\nnumerous theoretical justifications in the literature\n[20,21]. The relationship is specified as species density\nversus abundance and needs to be transformed to give a\nrank-abundance relationship. Our rank-abundance form\nwas obtained by dividing the area under the normal dis-\ntribution with standard deviation σ into M equal area\nslices and associating an abundance ni with the i-th slice\nby calculating an average value for the abundance within\nthe slice. The result is:\nwhere erf is the error function and erf1 its inverse.\nModeling the viral community structure\nThe PHACCS algorithm is represented in Figure 1. The\nexperimentally determined contig spectrum of a sample\nand the other parameters needed for the modified Lander-\nWaterman algorithm are the input. For a given rank-abun-\ndance function, assumed values of the function parame-\nters (number of different genotypes, as well as b for the\npower law, logarithmic, exponential and lognormal distri-\nbutions and k for niche preemption) are used to predict a\ncontig spectrum using the modified Lander-Waterman\nalgorithm. To determine the model fitness, the error\nbetween the actual and the predicted contig spectrum is\ncalculated as the variance-weighted sum of squared devia-\ntions, L being the contig spectrum vector length and cq' the\nexperimental number of fragments that belong to a q-con-\ntig:\n[ ...]c c c\n1\n2 3\n22\ncn w n N i Mqi q i\ni\nM\ni\ni\nM\n== ≤ ≤\n==\n∑∑\n11\n1with for\nn N\nMxi\nxi\nM\n=\n=\n∑\n1\ni Lognormal: e\ne\nwith e enm M\nt\ni\nm\nm\nj\nM i\ntti\nj\nii== −\n=\n−−\n∑\n+\nσ\nσ π\n1\n22\n2\n2\n1\n2\n() , //\n111\n1\n12 2\n2=− ∞ = + \n\n\n =+ ∞ ≤ ≤+\n−\n+,( )te r f M erf t ti Mi\ni\nMand for   1\ni Error: withF\ncc\nV Vn w wqq\nqq\nL\nqi q i q i\ni\nM\n=\n′ −\n=−\n==\n∑∑\n()\n()\n2\n11\n1\nBMC Bioinformatics 2005, 6:41 http://www.biomedcentral.com/1471-2105/6/41\nPage 4 of 9\n(page number not for citation purposes)\nThe best descriptive model for a community structure is\ndefined as the one with the smallest error. For each rank-\nabundance function tested, the global minimum for the\nerror is found by optimizing the value of the function\nparameters.\nThe values of the error can be roughly interpreted as loga-\nrithms of odds ratios of the observed contigs being seen\nfrom community distributions of the specified forms.\nThus a value of 0.1 for the difference in errors between\ntwo models corresponds to an odds ratio of e 0.1 which is\nabout 11:10 between the two models. This means that the\nmodel with the smallest error is about 10% more likely to\ngive rise to the observed data.\nPredicting the viral community diversity\nFor each rank-abundance form, the best model is used by\nPHACCS to assess diversity. The richness S is estimated as\nequal to the number of different genotypes M found in the\ncommunity structure model. The abundance of the most\nabundant genotype is also directly determined from the\nmodel as the highest rank-abundance value. The\nFlowchart of PHACCSFigure 1\nFlowchart of PHACCS. *The rank-abundance functions and the range of genotypes to use can be defined by the user. **This \nparameter represents b for the power law, logarithmic, lognormal and exponential distributions and k for the niche preemp-\ntion. This parameter is not applicable to the broken stick.\nAssume a model\nparameter value **\nPredict the contig\nspectrum\nCompute error between\nactual and predicted\ncontig spectrum\nModified Lander-\nWaterman algorithm\nCha\nnge\n the\n m\node\nl pa\nrameter va\nlue\nAssume a total number\nof genotypes *\nChange the total number  of genotypes\nAssume a rank-\nabundance function *\nCha\nnge\n the\nrank-\nabunda\nnc\ne func\ntion\n/g1/g2/g3/g4/g5/g6\n/g1/g2/g3/g4/g5/g6/g7/g8/g9/g10/g11/g4/g12/g13/g14/g7/g15/g3/g16\n/g17/g15/g12/g5/g2/g13/g8/g7/g9/g15/g12/g15/g14/g10/g4/g10/g12/g8\n/g7/g4/g5/g3/g4/g5/g8/g9/g10/g11/g8/g12/g13/g14/g15/g8/g9/g4/g2/g14/g5/g16/g10/g2/g6\n/g18/g7/g19/g15/g3/g20/g18/g15/g21/g13/g3/g16/g15/g3/g11/g10/g7/g14/g2/g16/g10/g22\n/g18/g7/g23/g5/g17/g10/g12/g8/g5/g4/g24/g7/g10/g8/g4/g5/g14/g15/g4/g2/g12/g8\nNO\nYES\nMinimum error for this\nnumber of genotypes?\nYES\nNO Minimum error for this\nrank-abundance function?\nBMC Bioinformatics 2005, 6:41 http://www.biomedcentral.com/1471-2105/6/41\nPage 5 of 9\n(page number not for citation purposes)\nShannon-Wiener index, which is a measure for diversity,\nis calculated using the relative rank-abundance values ri =\nni/N of all individual genotypes i [9]:\n Shannon-Wiener index H' (in nats): \nThe evenness is derived from H' [18]:\n Evenness E: E = H'/Hmax = H'/ln S\nComparison of four phage communities\nAs a case study, four viral metagenomes obtained from\nprevious studies and belonging to different ecosystems\nwere tested. Two of these were phage community samples\nof near-shore surface seawater from Scripps Pier (SP) and\nMission Bay (MB), San Diego, California, USA [10]. The\ntwo other samples are sediments from Mission Bay\n(MBSED) [11] and human feces (FEC) [12]. A compila-\ntion of the data for these samples is presented in Table 1.\nThese four datasets were analyzed with PHACCS using all\nsix rank-abundance models.\nResults\nBest abundance forms\nThe errors obtained from the contig spectrum analysis of\nthe different samples are presented in Table 2. For each\nsample the best descriptive model of the community\nstructure is the one with the smallest error. The SP com-\nmunity was best described by using the power law (error\nof 1.84), closely followed by the lognormal (error of 1.93)\nand logarithmic (error of 2.57) distributions. The expo-\nnential and niche preemption distributions had poor fits,\nwith errors of 12.0. The MB community modeling gave\nqualitatively the same results. Power law was the best fit\nwith an error of 2.15 and exponential and niche preemp-\ntion were last with an error of 16.2. The FEC community\nalso had the same sequence of best fitting rank-abundance\nforms. The best model was given by using the power law\nform (error 9.79). Exponential and niche preemption did\na poor job of explaining the data, coming in last with an\nerror of 60.0. For the MBSED community, the power law,\nlognormal, logarithmic and exponential distributions all\ntied for the best fit (with an error of 0.0104), whereas bro-\nken stick gave the worst fit (error of 0.0157).\nPhage community diversity and structure\nThe different diversity indicators and the rank-abundance\ncurves obtained by using the best descriptive model for\neach sample are summarized in Figure 2. The MBSED\ncommunity was the richest with an estimated 7340 differ-\nent phage genotypes. MB had ~7180 different genotypes,\nSP ~3350, and FEC was the least rich sample with ~2390\ndifferent genotypes. MBSED was the most even commu-\nnity with the maximum possible evenness of 1.00 (flat\nrank-abundance curve), followed by SP (evenness of\n0.932), MB (evenness of 0.900), and FEC (evenness of\n0.873). The most abundant genotype represented 4.80%\nof the total community for FEC, 2.63% for MB, 2.03% for\nSP and around 0.01% for MBSED. Based on the Shannon-\nWiener diversity index, MBSED was overall the most\ndiverse community with 8.90 nats, then MB (7.99 nats),\nSP (7.57 nats), and finally FEC (6.80 nats), the least\ndiverse community.\nDiscussion\nUsing PHACCS\nPHACCS is publicly accessible at http://phage.sdsu.edu/\nphaccs and the source code is freely available [see Addi-\ntional file 1]. The biological information PHACCS needs\nas an input is the viral community's contig spectrum, aver-\nage genome size, average shotgun DNA sequence length,\nand the minimum overlap length used for the assembly.\nPHACCS has two HTML interfaces. The basic interface\nassumes default values for marine phage communities\n(average genome size of 50 kb, average fragment length of\n650 bp and minimum overlap of 20 bp). All rank-abun-\ndance forms (power law, expoential, logarithmic, lognor-\nmal, broken stick and niche preemption distributions) are\ntested for up to 100,000 genotypes. In the advances inter-\nTable 1: Test data used for the study of the phage communities with PHACCS [10-12]. The average fragment sequence length was \ndetermined using Sequencher after sequence trimming (maximum one ambiguity on 99 bp at each extremity). A 98% identity for a \nminimal overlap length of 20 bp was used for sequence assembly with Sequencher to obtain the contig spectra. The average genome \nlength was determined by pulse field gel electrophoresis [12, 22].\nCommunity SP (Scripps Pier) MB (M ission Bay) MBSED (Mission Bay \nSediments)\nFEC (Fecal)\nContig spectrum * 1021 17 2 0 ... 841 13 2 0 ... 1152 2 0 ... 482 18 2 2 0 ...\nAvg. community genome size 50 kb 50 kb 50 kb 30 kb\nAvg. shotgun fragment length 663 bp 663 bp 570 bp 699 bp\n* The number of trailing zeros was set to 10 for each contig spectrum.\n′ =−\n=\n∑Hr r ii\ni\nS\nln\n1\nBMC Bioinformatics 2005, 6:41 http://www.biomedcentral.com/1471-2105/6/41\nPage 6 of 9\n(page number not for citation purposes)\nTable 2: Best descriptive rank-abundance form for the viral communities as determined by PHACCS. The error represents the \nvariance weighted sum squared deviation between the experimental and the predicted contig spectra. For each community, the best \ndescriptive function is the one that minimizes the error. The best fit obtained for each rank-abundance form was ranked according to \nthe error in ascending order.\nSP MB MBSED FEC\nRank Model Error Rank Model Error R ank Model Error Rank Model Error\n1 Power law 1.84 1 Power law 2.15 1 Power law 0.0104 1 Power law 9.79\n2 Lognormal 1.93 2 Lognormal 2.36 1 Lognormal 0.0104 2 Lognormal 10.2\n3 Logarithmic 2.57 3 Logarithmic 2.88 1 Logarithmic 0.0104 3 Logarithmic 10.3\n4 Broken stick 10.7 4 Broken stick 14.6 1 Exponential 0.0104 4 Broken stick 52.2\n5 Exponential 12.0 5 Exponential 16.2 5 Niche preemption 0.0139 5 Exponential 60.0\n5 Niche preemption 12.0 5 Niche preemption 16.2 6 Broken stick 0.0157 5 Niche preemption 60.0\nComparison of the structure and diversity of the different viral communities using PHACCSFigure 2\nComparison of the structure and diversity of the different viral communities using PHACCS. The graphics represent rank-\nabundance curves, where the abundance of each genotype is plotted versus its abundance rank, the genotype of rank one being \nthe most abundant. The curves were obtained by plotting the PHACCS rank-abundance values of the different communities on \nthe same axis. *The predicted community structure for MBSED was the same for the lognormal, logarithmic, power and expo-\nnential rank-abundance forms. As a consequence, the diversity predictions were also the same.\n/g1 /g2/g1/g1/g1/g3/g1/g1/g1/g4/g1/g1/g1/g5/g1/g1/g1/g6/g1/g1/g1/g7/g1/g1/g1/g8/g1/g1/g1/g9/g1/g1/g1\n/g1\n/g1/g10/g1/g2\n/g1/g10/g2\n/g2\n/g2/g1\n/g11/g12/g13/g14/g15/g16/g17/g18/g15/g13/g19/g20/g21/g22/g15/g23\n/g24/g15/g13/g19/g20/g21/g22/g15/g17/g12/g25/g26/g13/g16/g12/g13/g27/g15/g17/g28/g29/g30FEC SP MBSED\nMB\n/g31/g19/g32/g32/g26/g13/g33/g20/g21 /g34/g35 /g36/g37 /g36/g37/g34/g38/g39 /g40/g38/g31\n/g35/g19/g41/g15/g42/g17/g43/g12/g41 /g35/g19/g41/g15/g42/g17/g43/g12/g41 /g35/g19/g41/g15/g42/g17/g43/g12/g41\n/g36/g19/g16/g15/g43/g17/g15/g44/g26/g12/g20/g33/g19/g13\n/g11/g33/g27/g45/g13/g15/g23/g23 /g4/g4/g6/g1/g17/g18/g15/g13/g19/g20/g21/g22/g15/g23 /g8/g2/g9/g1/g17/g18/g15/g13/g19/g20/g21/g22/g15/g23 /g8/g4/g5/g1/g17/g18/g15/g13/g19/g20/g21/g22/g15/g23 /g3/g4/g46/g1/g17/g18/g15/g13/g19/g20/g21/g22/g15/g23\n/g38/g47/g15/g13/g13/g15/g23/g23 /g1/g10/g46/g4/g3 /g1/g10/g46/g1/g1 /g2/g10/g1/g1 /g1/g10/g9/g8/g4\n/g3/g10/g1/g4/g17/g29 /g3/g10/g7/g4/g17/g29 /g1/g10/g1/g2/g4/g7/g17/g29 /g5/g10/g9/g1/g17/g29\n/g8/g10/g6/g8/g17/g13/g12/g20/g23 /g8/g10/g46/g46/g17/g13/g12/g20/g23 /g9/g10/g46/g1/g17/g13/g12/g20/g23 /g7/g10/g9/g1/g17/g13/g12/g20/g23\n/g37/g15/g23/g20/g17/g42/g12/g13/g14/g48\n/g12/g25/g26/g13/g16/g12/g13/g27/g15/g17/g49/g19/g42/g32\n/g50/g19/g18/g13/g19/g42/g32/g12/g43/g51/g17/g43/g19/g18/g12/g42/g33/g20/g45/g32/g33/g27/g51/g17\n/g22/g19/g41/g15/g42/g17/g43/g12/g41/g17/g52/g17/g15/g53/g22/g19/g13/g15/g13/g20/g33/g12/g43/g17/g54\n/g13/g33/g17/g55/g17/g1/g10/g1/g3/g1/g4/g17/g53/g17/g33/g17/g48/g1/g10/g7/g5/g2/g13/g33/g17/g55/g17/g1/g10/g1/g3/g7/g4/g17/g53/g17/g33/g17/g48/g1/g10/g8/g3/g9/g13/g33/g17/g55/g17/g2/g10/g4/g7/g17/g53/g17/g2/g1/g17/g48/g5/g13/g33/g17/g55/g17/g1/g10/g1/g5/g9/g1/g17/g53/g17/g33/g17/g48/g1/g10/g8/g9/g4\n/g36/g19/g23/g20/g17/g12/g25/g26/g13/g16/g12/g13/g20/g17\n/g18/g15/g13/g19/g20/g21/g22/g15\n/g34/g45/g12/g13/g13/g19/g13/g48/g56/g33/g15/g13/g15/g42/g17\n/g33/g13/g16/g15/g53\nBMC Bioinformatics 2005, 6:41 http://www.biomedcentral.com/1471-2105/6/41\nPage 7 of 9\n(page number not for citation purposes)\nface (Figure 3) the user can change all biological and com-\nputational parameters.\nPHACCS analyses are computer intensive. On a dual-\nOpteron™ server, the computation for the SP sample takes\n~5 minutes. The broken stick and lognormal rank-abun-\ndance forms account for most of the computation time\n(data not shown). Increasing the range of genotypes to\nsearch dramatically increases the time needed to complete\nthe analysis (data not shown).\nPHACCS estimations about the virus community are: i)\nstructure – best descriptive rank-abundance form, model\nequation and error, and ii) diversity – richness, evenness,\nScreenshot of PHACCS' advanced web interfaceFigure 3\nScreenshot of PHACCS' advanced web interface.\n\nBMC Bioinformatics 2005, 6:41 http://www.biomedcentral.com/1471-2105/6/41\nPage 8 of 9\n(page number not for citation purposes)\nabundance of the most abundant genotype, and Shan-\nnon-Wiener index. Graphic representations of the com-\nmunity structure and of the error minimization can also\nbe displayed. The error provides information about which\nmodel has the best fit relative to the others for a given con-\ntig spectrum. For each type of distribution, the user is\ninformed if the best model (i.e., the error's global mini-\nmum) has not been found using the given computation\nparameters.\nImportance of the contig spectrum quality\nPredictions by PHACCS are dependent on the quality of\nthe contig spectrum input. The difference in error between\ntwo models can be small (Table 2) and using an inappro-\npriate model can change the estimated diversity. For\nexample, the predicted richness for the SP sample is about\nfour times higher for the lognormal distribution than for\nthe power law (data not shown). A useful contig spectrum\nrequires that: i) the same clone be sequenced only once\n(remove all redundant clones), ii) the sequences be\ntrimmed to remove ambiguities (\"N\"'s) and, iii) the\nassembly parameters be sufficiently stringent so that only\nsequences from the same genotype are part of the same\ncontig (experimental determination by assembly of\nknown sequences). All these experimental problems bias\nthe observed occurrence of the DNA fragments, and thus\nthe contig spectrum. Additionally, accurate community\nestimations are not to be expected if the contig spectrum\nonly has a small degree (only small contigs) (e.g., MBSED,\n[1152 2 0 ...]). As a general rule, the higher the contig\ndegree, the better the estimations, because the model fit-\nting is done over a larger number of points. For the same\nreason, the number of trailing zeros in the contig spec-\ntrum is important. Adding zeros at the end of the contig\nspectrum will improve PHACCS predictions (e.g., 10 trail-\ning zeros were used in the present analyses) but will also\nincrease the computation time.\nLimitations\nThe way the contig spectrum is obtained leads to approx-\nimations of the viral diversity. In the samples analyzed\nhere, only the DNA from viruses smaller than 0.22 µm is\ncollected. Larger viruses and RNA viruses are not repre-\nsented in the shotgun library and in the resulting contig\nspectrum. The contig spectrum assembly parameters\n(98% identity on at least 20 bp for phages) are stringent\nenough to limit the number of false-contigs (contigs\nbetween DNA fragments from different genotypes), but\nmay on the other side omit some true-contigs (DNA\nfragments that are designated as non-overlapping when\nthey actually belong to the same genotype). Additionally,\nthe present implementation of the Lander-Waterman\nalgorithm assumes that all DNA fragments and all the\ngenotypes have the same size. For these reasons, PHACCS\nestimates should be considered approximations.\nPhage community structure and diversity\nThe comparative analysis of the four phage communities\nshowed that the power law seems overall to be a powerful\nrank-abundance distribution to model phage community\nstructure (Figure 2). A recent simple predator-prey model\nbased on the observed marine phage-host dynamics\nexplains how a power law distributed phage rank-abun-\ndance can be obtained from a modified Lokta-Volterra\nmodel [23]. Before analyzing the viral samples with the\ncontig spectrum approach, the number of viral genotypes\nin an environment was totally unknown. The viral com-\nmunities turned out to be extremely diverse with esti-\nmated Shannon-Wiener diversity indices between 6.8 nats\n(fecal sample) and 8.9 nats (sediment sample) (Figure 2),\nrepresenting diversity levels higher than for most bacterial\ncommunities [11]. Because phages are specific predators,\nthe structure and diversity of phage communities could be\ndirectly correlated to the structure and diversity of the\ncoexisting microbial communities [2]. Some facts seem to\nsupport this hypothesis.\nFirst, the extreme diversity of the sediment viral commu-\nnity may reflect the higher diversity of the microbial\ncommunities found in sediments using automated rRNA\nintergenic spacer analysis (ARISA) [24] in comparison\nwith seawater. Also, only a few hundred different bacterial\nspecies were reported in the human colon intestinal flora\n[25] using the 16s ribosomal DNA methodology, which\ncould account for the relatively low phage richness in the\nfecal sample.\nConclusion\nPHACCS is a web-based service that predicts community\nstructure and diversity using the contig spectrum from\nmetagenomic random shotgun sequence data. This meth-\nodology allows PHACCS to determine the mathematical\nmodel that most accurately reflects the underlying geno-\ntype abundance distribution (i.e., power law, logarithmic,\nexponential, broken stick, niche preemption, or lognor-\nmal distributions) and use it to makes estimates about the\ndiversity of the communities, (i.e., richness, evenness,\nShannon-Wiener index and abundance of most abundant\ngenotype). Using uncultured environmental viral sam-\nples, PHACCS has been used to confirm that phage biodi-\nversity is higher than in any previously observed\ncommunity and that the structure of viral communities\nmay closely follow that of their hosts. PHACCS is\ndesigned for biologists to mathematically analyze their\nviral shotgun libraries and gain insights about viral ecol-\nogy and population dynamics.\nAvailability and requirements\n Project name: PHACCS – PHAge Communities from\nContig Spectrum\nPublish with BioMed Central   and  every \nscientist can read your work free of charge\n\"BioMed Central will be the most significant development for \ndisseminating the results of biomedical research in our lifetime.\"\nSir Paul Nurse, Cancer Research UK\nYour research papers will be:\navailable free of charge to the entire biomedical community\npeer reviewed and published immediately upon acceptance\ncited in PubMed and archived on PubMed Central \nyours — you keep the copyright\nSubmit your manuscript here:\nhttp://www.biomedcentral.com/info/publishing_adv.asp\nBioMedcentral\nBMC Bioinformatics 2005, 6:41 http://www.biomedcentral.com/1471-2105/6/41\nPage 9 of 9\n(page number not for citation purposes)\n Project home page: http://phage.sdsu.edu/phaccs\n Operating system(s): Unix based system for PHACCS\nand its web interface. Platform independent for PHACCS\ncore.\n Programming language: Matlab (for the core scripts)\nand Perl\n Other requirements: For the interface: CGI.pm Perl\nmodule, ppmtogif, webserver program (to use PHACCS as\na web service)\n License: GNU GPL\nAuthors' contributions\nFA developed the PHACCS main program and its inter-\nface. BRB helped with the programming. BRB, DB, PMN,\nPS, BF, JN and JM developed the modified Lander-Water-\nman algorithm and implemented it with Matlab. FR and\nMB helped write the manuscript and provided the test\ndatasets. All authors read and approved the final\nmanuscript.\nAdditional material\nAcknowledgements\nThis work was supported by NSF 0316518 (FR) and an EPA STAR fellow-\nship (MB). We thank Ines Thiele, Steve Rayhawk and Cynthia Steiner for \nuseful suggestions and comments.\nReferences\n1. Wommack KE, Colwell RR: Virioplankton: Viru ses in aquatic\necosystems. Microbiol Mol Biol Rev 2000, 64:69-114.\n2. Whitman WB, Coleman DC, Wiebe WJ: Prokaryotes: The\nunseen majority. Proc Natl Acad Sci USA 1998, 95:6578-6583.\n3. Wilcox RM, Fuhrman JA: Bacterial viruses in coastal seawater:\nlytic rather than lysogenic production.  Mar Ecol Prog Ser  1994,\n114:35-45.\n4. Thingstad TF: Elements of a theory for the mechanisms con-\ntrolling abundance, diversity, and biogeochemical role of\nlytic bacterial viruses in aquatic systems. Limnol Oceanogr 2000,\n45:1320-1328.\n5. Staley JT, Konopka A: Measurement of in situ activities of non-\nphotosynthetic microorganisms in aquatic and terrestrial\nhabitats. Annu Rev Microbiol 1985, 39:346.\n6. Ackermann H-W, DuBow MS: Viruses of prokaryotes; Volume I:\nGeneral properties of bacteriophages.  CRC Press, Inc;\n1987:202. \n7. McIntosh RI: An index of diversity and the relation of certain\nconcepts to diversity. Ecology 1967, 48:392-404.\n8. Hill MO: Diversity and evenness: a unifying notation and its\nconsequences. Ecology 1973, 54:427-431.\n9. Shannon CE, Weaver W: The mathematical theory of\ncommunication. Univ of Illinois Press, Urbana; 1963. \n10. Breitbart M, Salamon P, Andresen  P, Mahaffy JM, Segall AM, Mead D,\nAzam F, Rohwer F: Genomic analysis of uncultured marine\nviral communities. Proc Natl Acad Sci USA 2002, 99:14250-5.\n11. Breitbart M, Felts B, Kelley S,  Mahaffy JM, Nulton J, Salamon P,\nRohwer F: Diversity and population structure of a near-shore\nmarine sediment community.  Proc R Soc Lond  2004,\n271:565-574.\n12. Breitbart M, Hewson I, Felts B, Mahaffy JM, Nulton J, Salamon P,\nRohwer F: Metagenomic analysis of an uncultured viral com-\nmunity from human feces. J Bacteriol 2003, 185:6620-6223.\n13. Tyson GW, Chapman J, Hugenholtz  P, Allen EE, Bram RJ, Richardson\nPM, Solovyev VV, Rubin EM, Rokhsar DS, Banfield JF: Community\nstructure and metabolism through reconstruction of micro-\nbial genomes from the environment. Nature 2004, 428:37-43.\n14. Venter JC, Remington K, Heidelbe rg JF, Halpern AL, Rusch D, Eisen\nJA, Wu D, Paulsen I, Nelson KE, Nelson W, Fouts DE, Levy S, Knap\nAH, Lomas MW, Nealson K, White O, Peterson J, Hoffman J, Parsons\nR, Baden-Tillson H, Pfannkoch C, Rogers YH, Smith HO: Environ-\nmental genome shotgun sequencing of the Sargasso Sea. Sci-\nence 2004, 304:66-74.\n15. Rohwer F: Construction and Analyses of Linker-Amplified\nShotgun Libraries (LASLs).   [http://www.sci.sdsu.edu/PHAGE/\nLASL/index.htm].\n16. Lander ES, Waterman MS: Genomic mapping by fingerprinting\nrandom clones: a mathematical analysis.  Genomics 1988,\n2:231-239.\n17. Ulrich W: Models of relative abundance distributions I: Model\nfitting by stochastic models. Pol J Ecol 2001, 49:145-157.\n18. Pielou EC: Ecological Diversity New York: John Wiley & Sons, Inc; 1975. \n19. McArthur RH: On the relative abundance of bird species.  Proc\nNat Acad Sci USA 1957, 43:293-295.\n20. Sugihara G: Minimal community struct ure: an explanation of\nspecies abundance patterns. Am Nat 1980, 116:770-187.\n21. McGill BJ: A test of the unified neutra l theory of biodiversity.\nNature 2003, 422:881-885.\n22. Steward GF, Montiel JL, Azam F: Genome size distributions indi-\ncate variability and similariti es among marine viral assem-\nblages from diverse environments.  Limnol Oceanogr  2000,\n45:1697-1706.\n23. Hoffmann KH, Rodriguez-Brito B, Breitbart M, Bangor D, Angly F,\nFelts B, Nulton J, Rohwer F, Salamon P: Power law rank-abun-\ndance relationships in marine phage populations.  in press.\n24. Hewson I, Vargo GA, Fuhrman JA: Bacterial diversity in shallow\noligotrophic marine benthos and overlying waters: effects of\nvirus infection, containmen t, and nutrient enrichment.\nMicrob Ecol 2003, 46:322-36.\n25. Mai V, Morris JG Jr: Colonic Bacterial flora: changing under-\nstandings in the molecular age. J Nutr 2004, 134:459-464.\nAdditional File 1\nThis file contains the script files part of PHACCS. These files are either \nstandard text or picture files.\nClick here for file\n[http://www.biomedcentral.com/content/supplementary/1471-\n2105-6-41-S1.zip]"
}