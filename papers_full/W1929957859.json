{
    "title": "Random walks on discourse spaces: a new generative language model with applications to semantic word embeddings",
    "url": "https://openalex.org/W1929957859",
    "year": 2015,
    "authors": [
        {
            "id": "https://openalex.org/A2096355753",
            "name": "Sanjeev Arora",
            "affiliations": []
        },
        {
            "id": "https://openalex.org/A2106461804",
            "name": "Yuanzhi Li",
            "affiliations": []
        },
        {
            "id": "https://openalex.org/A2124668569",
            "name": "Yingyu Liang",
            "affiliations": []
        },
        {
            "id": "https://openalex.org/A2171800532",
            "name": "Tengyu Ma",
            "affiliations": []
        },
        {
            "id": "https://openalex.org/A2003099879",
            "name": "Andrej Risteski",
            "affiliations": []
        }
    ],
    "references": [
        "https://openalex.org/W2510403706",
        "https://openalex.org/W2096814070",
        "https://openalex.org/W2117130368",
        "https://openalex.org/W2912225506",
        "https://openalex.org/W2257859587",
        "https://openalex.org/W2091812280",
        "https://openalex.org/W2147152072",
        "https://openalex.org/W2950133940",
        "https://openalex.org/W2295508206",
        "https://openalex.org/W2077791698",
        "https://openalex.org/W2250539671",
        "https://openalex.org/W2174706414",
        "https://openalex.org/W2146502635",
        "https://openalex.org/W2126341068",
        "https://openalex.org/W2113459411",
        "https://openalex.org/W1826694107",
        "https://openalex.org/W2949165393",
        "https://openalex.org/W2125031621",
        "https://openalex.org/W2072644219",
        "https://openalex.org/W2141599568",
        "https://openalex.org/W1612003148",
        "https://openalex.org/W2295800168",
        "https://openalex.org/W100623710",
        "https://openalex.org/W2147880316",
        "https://openalex.org/W2950577311",
        "https://openalex.org/W2131571251",
        "https://openalex.org/W1662133657",
        "https://openalex.org/W2250189634"
    ],
    "abstract": "Semantic word embeddings use vector representations to represent the meaning of a word. Methods to create them include Vector Space Methods (VSMs) such as Latent Semantic Analysis (LSA), matrix factorization, generative text models such as Topic Models, and neural nets. A flurry of work has resulted from the papers of Mikolov et al.~\\cite{mikolov2013efficient}. These showed how to solve word analogy tasks very well by leveraging linear structure in word embeddings even though the embeddings were created using highly nonlinear energy based models. No clear explanation is known why such linear structure emerges in low-dimensional embeddings. \r\nThis paper presents a loglinear generative model---related to~\\citet{mnih2007three}---that models the generation of a text corpus as a random walk in a latent discourse space. A novel methodological twist is that the model is solved in closed form by integrating out the random walk. This yields a simple method for constructing word embeddings. Experiments are presented to support the modeling assumptions as well as the efficacy of the word embeddings for solving analogies. This simple model links and provides theoretical support for several prior methods for finding embeddings, as well as provides interpretations for various linear algebraic structures in word embeddings obtained from nonlinear techniques.",
    "full_text": "RAND-WALK: A latent variable model approach to word\nembeddings\nSanjeev Arora Yuanzhi Li Yingyu Liang Tengyu Ma Andrej Risteski ∗\nAbstract\nSemantic word embeddings represent the meaning of a word via a vector, and are created by diverse\nmethods. Many use nonlinear operations on co-occurrence statistics, and have hand-tuned hyperparam-\neters and reweighting methods.\nThis paper proposes a new generative model, a dynamic version of the log-linear topic model of Mnih\nand Hinton (2007). The methodological novelty is to use the prior to compute closed form expressions\nfor word statistics. This provides a theoretical justiﬁcation for nonlinear models like PMI, word2vec,\nand GloVe, as well as some hyperparameter choices. It also helps explain why low-dimensional semantic\nembeddings contain linear algebraic structure that allows solution of word analogies, as shown by Mikolov\net al. (2013a) and many subsequent papers.\nExperimental support is provided for the generative model assumptions, the most important of which\nis that latent word vectors are fairly uniformly dispersed in space.\n1 Introduction\nVector representations of words (word embeddings) try to capture relationships between words as distance or\nangle, and have many applications in computational linguistics and machine learning. They are constructed\nby various models whose unifying philosophy is that the meaning of a word is deﬁned by “the company it\nkeeps” (Firth, 1957), namely, co-occurrence statistics. The simplest methods use word vectors that explicitly\nrepresent co-occurrence statistics. Reweighting heuristics are known to improve these methods, as is dimen-\nsion reduction (Deerwester et al., 1990). Some reweighting methods are nonlinear, which include taking the\nsquare root of co-occurrence counts (Rohde et al., 2006), or the logarithm, or the related Pointwise Mutual\nInformation (PMI) (Church and Hanks, 1990). These are collectively referred to as Vector Space Models,\nsurveyed in (Turney and Pantel, 2010).\nNeural network language models (Rumelhart et al., 1986; 1988; Bengio et al., 2006; Collobert and Weston,\n2008a) propose another way to construct embeddings: the word vector is simply the neural network’s internal\nrepresentation for the word. This method is nonlinear and nonconvex. It was popularized via word2vec, a\nfamily of energy-based models in (Mikolov et al., 2013b;c), followed by a matrix factorization approach called\nGloVe (Pennington et al., 2014). The ﬁrst paper also showed how to solve analogies using linear algebra on\nword embeddings. Experiments and theory were used to suggest that these newer methods are related to\nthe older PMI-based models, but with new hyperparameters and/or term reweighting methods (Levy and\nGoldberg, 2014b).\nBut note that even the old PMI method is a bit mysterious. The simplest version considers a symmetric\nmatrix with each row/column indexed by a word. The entry for ( w,w′) is PMI(w,w′) = log p(w,w′)\np(w)p(w′) , where\np(w,w′) is the empirical probability of words w,w′appearing within a window of certain size in the corpus,\nand p(w) is the marginal probability of w. (More complicated models could use asymmetric matrices with\n∗Princeton University, Computer Science Department. {arora,yuanzhil,yingyul,tengyu,risteski}@cs.princeton.edu.\nThis work was supported in part by NSF grants CCF-0832797, CCF-1117309, CCF-1302518, DMS-1317308, Simons Investigator\nAward, and Simons Collaboration Grant. Tengyu Ma was also supported by Simons Award for Graduate Students in Theoretical\nComputer Science and IBM PhD Fellowship.\n1\narXiv:1502.03520v8  [cs.LG]  19 Jun 2019\ncolumns corresponding to context words or phrases, and also involve tensorization.) Then word vectors are\nobtained by low-rank SVD on this matrix, or a related matrix with term reweightings. In particular, the\nPMI matrix is found to be closely approximated by a low rank matrix: there exist word vectors in say 300\ndimensions, which is much smaller than the number of words in the dictionary, such that\n⟨vw,vw′ ⟩≈ PMI(w,w′) (1.1)\nwhere ≈should be interpreted loosely.\nThere appears to be no theoretical explanation for this empirical ﬁnding about the approximate low\nrank of the PMI matrix. The current paper addresses this. Speciﬁcally, we propose a probabilistic model\nof text generation that augments the log-linear topic model of Mnih and Hinton (2007) with dynamics, in\nthe form of a random walk over a latent discourse space. The chief methodological contribution is using the\nmodel priors to analytically derive a closed-form expression that directly explains (1.1); see Theorem 2.2\nin Section 2. Section 3 builds on this insight to give a rigorous justiﬁcation for models such as word2vec\nand GloVe, including the hyperparameter choices for the latter. The insight also leads to a mathematical\nexplanation for why these word embeddings allow analogies to be solved using linear algebra; see Section 4.\nSection 5 shows good empirical ﬁt to this model’s assumtions and predictions, including the surprising one\nthat word vectors are pretty uniformly distributed (isotropic) in space. 1\n1.1 Related work\nLatent variable probabilistic models of language have been used for word embeddings before, including\nLatent Dirichlet Allocation (LDA) and its more complicated variants (see the survey (Blei, 2012)), and some\nneurally inspired nonlinear models (Mnih and Hinton, 2007; Maas et al., 2011). In fact, LDA evolved out of\neﬀorts in the 1990s to provide a generative model that “explains” the success of older vector space methods\nlike Latent Semantic Indexing (Papadimitriou et al., 1998; Hofmann, 1999). However, none of these earlier\ngenerative models has been linked to PMI models.\nLevy and Goldberg (2014b) tried to relate word2vec to PMI models. They showed that if there were no\ndimension constraint in word2vec, speciﬁcally, the “skip-gram with negative sampling (SGNS)” version of the\nmodel, then its solutions would satisfy (1.1), provided the right hand side were replaced by PMI( w,w′) −β\nfor some scalar β. However, skip-gram is a discriminative model (due to the use of negative sampling), not\ngenerative. Furthermore, their argument only applies to very high-dimensional word embeddings, and thus\ndoes not address low-dimensional embeddings, which have superior quality in applications.\nHashimoto et al. (2016) focuses on issues similar to our paper. They model text generation as a random\nwalk on words, which are assumed to be embedded as vectors in a geometric space. Given that the last word\nproduced was w, the probability that the next word is w′ is assumed to be given by h(|vw −vw′ |2) for a\nsuitable function h, and this model leads to an explanation of (1.1). By contrast our random walk involves\na latent discourse vector, which has a clearer semantic interpretation and has proven useful in subsequent\nwork, e.g. understanding structure of word embeddings for polysemous words Arora et al. (2016). Also our\nwork clariﬁes some weighting and bias terms in the training objectives of previous methods (Section 3) and\nalso the phenomenon discussed in the next paragraph.\nResearchers have tried to understand why vectors obtained from the highly nonlinear word2vec models\nexhibit linear structures (Levy and Goldberg, 2014a; Pennington et al., 2014). Speciﬁcally, for analogies like\n“man:woman::king:??,” queen happens to be the word whose vector vqueen is the most similar to the vector\nvking −vman + vwoman. This suggests that simple semantic relationships, such as masculine vs feminine\ntested in the above example, correspond approximately to a single direction in space, a phenomenon we will\nhenceforth refer to as relations=lines.\nSection 4 surveys earlier attempts to explain this phenomenon and their shortcoming, namely, that they\nignore the large approximation error in relationships like (1.1). This error appears larger than the diﬀerence\nbetween the best solution and the second best (incorrect) solution in analogy solving, so that this error could\nin principle lead to a complete failure in analogy solving. In our explanation, the low dimensionality of the\n1The code is available at https://github.com/PrincetonML/SemanticVector\n2\nword vectors plays a key role. This can also be seen as a theoretical explanation of the old observation that\ndimension reduction improves the quality of word embeddings for various tasks. The intuitive explanation\noften given —that smaller models generalize better—turns out to be fallacious, since the training method\nfor creating embeddings makes no reference to analogy solving. Thus there is no a priori reason why low-\ndimensional model parameters (i.e., lower model capacity) should lead to better performance in analogy\nsolving, just as there is no reason they are better at some other unrelated task like predicting the weather.\n1.2 Beneﬁts of generative approaches\nIn addition to giving some form of “uniﬁcation” of existing methods, our generative model also brings\nmore intepretability to word embeddings beyond traditional cosine similarity and even analogy solving. For\nexample, it led to an understanding of how the diﬀerent senses of a polysemous word (e.g., bank) reside in\nlinear superposition within the word embedding (Arora et al., 2016). Such insight into embeddings may\nprove useful in the numerous settings in NLP and neuroscience where they are used.\nAnother new explanatory feature of our model is that low dimensionality of word embeddings plays a key\ntheoretical role —unlike in previous papers where the model is agnostic about the dimension of the embed-\ndings, and the superiority of low-dimensional embeddings is an empirical ﬁnding (starting with Deerwester\net al. (1990)). Speciﬁcally, our theoretical analysis makes the key assumption that the set of all word vectors\n(which are latent variables of the generative model) are spatially isotropic, which means that they have no\npreferred direction in space. Having n vectors be isotropic in d dimensions requires d≪n. This isotropy is\nneeded in the calculations (i.e., multidimensional integral) that yield (1.1). It also holds empirically for our\nword vectors, as shown in Section 5.\nThe isotropy of low-dimensional word vectors also plays a key role in our explanation of the rela-\ntions=lines phenomenon (Section 4). The isotropy has a “puriﬁcation” eﬀect that mitigates the eﬀect of\nthe (rather large) approximation error in the PMI models.\n2 Generative model and its properties\nThe model treats corpus generation as a dynamic process, where the t-th word is produced at step t. The\nprocess is driven by the random walk of a discourse vector ct ∈ℜd. Its coordinates represent what is being\ntalked about.2 Each word has a (time-invariant) latent vector vw ∈ℜd that captures its correlations with\nthe discourse vector. We model this bias with a log-linear word production model:\nPr[w emitted at time t |ct] ∝exp(⟨ct,vw⟩). (2.1)\nThe discourse vector ct does a slow random walk (meaning that ct+1 is obtained from ct by adding a small\nrandom displacement vector), so that nearby words are generated under similar discourses. We are interested\nin the probabilities that word pairs co-occur near each other, so occasional big jumps in the random walk\nare allowed because they have negligible eﬀect on these probabilities.\nA similar log-linear model appears in Mnih and Hinton (2007) but without the random walk. The linear\nchain CRF of Collobert and Weston (2008b) is more general. The dynamic topic model of Blei and Laﬀerty\n(2006) utilizes topic dynamics, but with a linear word production model. Belanger and Kakade (2015) have\nproposed a dynamic model for text using Kalman Filters, where the sequence of words is generated from\nGaussian linear dynamical systems, rather than the log-linear model in our case.\nThe novelty here over such past works is a theoretical analysis in the method-of-moments tradition (Hsu\net al., 2012; Cohen et al., 2012). Assuming a prior on the random walk we analytically integrate out the\nhidden random variables and compute a simple closed form expression that approximately connects the\nmodel parameters to the observable joint probabilities (see Theorem 2.2). This is reminiscent of analysis of\nsimilar random walk models in ﬁnance (Black and Scholes, 1973).\n2This is a diﬀerent interpretation of the term “discourse” compared to some other settings in computational linguistics.\n3\nModel details. Let n denote the number of words and d denote the dimension of the discourse space,\nwhere 1 ≤d ≤n. Inspecting (2.1) suggests word vectors need to have varying lengths, to ﬁt the empirical\nﬁnding that word probabilities satisfy a power law. Furthermore, we will assume that in the bulk, the word\nvectors are distributed uniformly in space, earlier referred to as isotropy. This can be quantiﬁed as a prior\nin the Bayesian tradition. More precisely, the ensemble of word vectors consists of i.i.d draws generated by\nv= s·ˆv, where ˆv is from the spherical Gaussian distribution, and sis a scalar random variable. We assume\ns is a random scalar with expectation τ = Θ(1) and s is always upper bounded by κ, which is another\nconstant. Here τ governs the expected magnitude of ⟨v,ct⟩, and it is particularly important to choose it to\nbe Θ(1) so that the distribution Pr[ w|ct] ∝exp(⟨vw,ct⟩) is interesting. 3 Moreover, the dynamic range of\nword probabilities will roughly equal exp(κ2), so one should think of κas an absolute constant like 5. These\ndetails about s are important for realistic modeling but not too important in our analysis. (Furthermore,\nreaders uncomfortable with this simplistic Bayesian prior should look at Section 2.2 below.)\nFinally, we clarify the nature of the random walk. We assume that the stationary distribution of the\nrandom walk is uniform over the unit sphere, denoted by C. The transition kernel of the random walk can\nbe in any form so long as at each step the movement of the discourse vector is at most ϵ2/\n√\nd in ℓ2 norm.4\nThis is still fast enough to let the walk mix quickly in the space.\nThe following lemma (whose proof appears in the appendix) is central to the analysis. It says that\nunder the Bayesian prior, the partition function Zc = ∑\nwexp(⟨vw,c⟩), which is the implied normalization\nin equation (2.1), is close to some constant Z for most of the discourses c. This can be seen as a plausible\ntheoretical explanation of a phenomenon calledself-normalization in log-linear models: ignoring the partition\nfunction or treating it as a constant (which greatly simpliﬁes training) is known to often give good results.\nThis has also been studied in (Andreas and Klein, 2014).\nLemma 2.1(Concentration of partition functions). If the word vectors satisfy the Bayesian prior described\nin the model details, then\nPr\nc∼C\n[(1 −ϵz)Z ≤Zc ≤(1 + ϵz)Z] ≥1 −δ, (2.2)\nfor ϵz = ˜O(1/√n), and δ= exp(−Ω(log2 n)).\nThe concentration of the partition functions then leads to our main theorem (the proof is in the appendix).\nThe theorem gives simple closed form approximations for p(w), the probability of word w in the corpus, and\np(w,w′), the probability that two words w,w′ occur next to each other. The theorem states the result for\nthe window size q= 2, but the same analysis works for pairs that appear in a small window, say of size 10,\nas stated in Corollary 2.3. Recall that PMI( w,w′) = log[p(w,w′)/(p(w)p(w′))].\nTheorem 2.2. Suppose the word vectors satisfy the inequality (2.2), and window size q= 2. Then,\nlog p(w,w′) = ∥vw + vw′ ∥2\n2\n2d −2 logZ±ϵ, (2.3)\nlog p(w) = ∥vw∥2\n2\n2d −log Z±ϵ. (2.4)\nfor ϵ= O(ϵz) + ˜O(1/d) + O(ϵ2). Jointly these imply:\nPMI (w,w′) = ⟨vw,vw′ ⟩\nd ±O(ϵ). (2.5)\nRemarks 1. Since the word vectors have ℓ2 norm of the order of\n√\nd, for two typical word vectors vw,vw′ ,\n∥vw + vw′ ∥2\n2 is of the order of Θ( d). Therefore the noise level ϵ is very small compared to the leading\n3A larger τ will make Pr[w|ct] too peaked and a smaller one will make it too uniform.\n4 More precisely, the proof extends to any symmetric product stationary distribution C with sub-Gaussian coordinate\nsatisfying Ec\n[\n∥c∥2]\n= 1, and the steps are such that for all ct, Ep(ct+1|ct)[exp(κ\n√\nd∥ct+1 −ct∥)] ≤1 + ϵ2 for some small ϵ2.\n4\nterm 1\n2d∥vw + vw′ ∥2\n2. For PMI however, the noise level O(ϵ) could be comparable to the leading term, and\nempirically we also ﬁnd higher error here.\nRemarks 2. Variants of the expression for joint probability in (2.3) had been hypothesized based upon\nempirical evidence in Mikolov et al. (2013b) and also Globerson et al. (2007), and Maron et al. (2010) .\nRemarks 3. Theorem 2.2 directly leads to the extension to a general window size q as follows:\nCorollary 2.3. Let pq(w,w′) be the co-occurrence probability in windows of size q, and PMI q(w,w′) be the\ncorresponding PMI value. Then\nlog pq(w,w′) = ∥vw + vw′ ∥2\n2\n2d −2 logZ+ γ±ϵ,\nPMIq (w,w′) = ⟨vw,vw′ ⟩\nd + γ±O(ϵ).\nwhere γ = log\n(\nq(q−1)\n2\n)\n.\nIt is quite easy to see that Theorem 2.2 implies the Corollary 2.3, as when the window size is q the\npair w,w′ could appear in any of\n(q\n2\n)\npositions within the window, and the joint probability of w,w′ is\nroughly the same for any positions because the discourse vector changes slowly. (Of course, the error\nterm gets worse as we consider larger window sizes, although for any constant size, the statement of the\ntheorem is correct.) This is also consistent with the shift β for ﬁtting PMI in (Levy and Goldberg, 2014b),\nwhich showed that without dimension constraints, the solution to skip-gram with negative sampling satisﬁes\nPMI (w,w′) −β = ⟨vw,vw′ ⟩for a constant β that is related to the negative sampling in the optimization.\nOur result justiﬁes via a generative model why this should be satisﬁed even for low dimensional word vectors.\n2.1 Proof sketches\nHere we provide the proof sketches, while the complete proof can be found in the appendix.\nProof sketch of Theorem 2.2Let wand w′be two arbitrary words. Let cand c′denote two consecutive\ncontext vectors, where c∼C and c′|c is deﬁned by the Markov kernel p(c′|c).\nWe start by using the law of total expectation, integrating out the hidden variables c and c′:\np(w,w′) = E\nc,c′\n[Pr[w,w′|c,c′]]\n= E\nc,c′\n[p(w|c)p(w′|c′)]\n= E\nc,c′\n[exp(⟨vw,c⟩)\nZc\nexp(⟨vw′ ,c′⟩)\nZc′\n]\n(2.6)\nAn expectation like (2.6) would normally be diﬃcult to analyze because of the partition functions.\nHowever, we can assume the inequality (2.2), that is, the partition function typically does not vary much for\nmost of context vectors c. Let F be the event that both cand c′are within (1 ±ϵz)Z. Then by (2.2) and the\nunion bound, event F happens with probability at least 1 −2 exp(−Ω(log2 n)). We will split the right-hand\nside (RHS) of (2.6) into the parts according to whether F happens or not.\nRHS of (2.6) = E\nc,c′\n[exp(⟨vw,c⟩)\nZc\nexp(⟨vw′ ,c′⟩)\nZc′\n1F\n]\n  \nT1\n+ E\nc,c′\n[exp(⟨vw,c⟩)\nZc\nexp(⟨vw′ ,c′⟩)\nZc′\n1 ¯F\n]\n  \nT2\n(2.7)\n5\nwhere ¯F denotes the complement of event F and 1F and 1 ¯F denote indicator functions for F and ¯F,\nrespectively. When F happens, we can replace Zc by Z with a 1 ±ϵz factor loss: The ﬁrst term of the RHS\nof (2.7) equals to\nT1 = 1 ±O(ϵz)\nZ2 E\nc,c′\n[exp(⟨vw,c⟩) exp(⟨vw′ ,c′⟩)1F] (2.8)\nOn the other hand, we can use E[1 ¯F] = Pr[ ¯F] ≤exp(−Ω(log2 n)) to show that the second term of RHS\nof (2.7) is negligible,\n|T2|= exp(−Ω(log1.8 n)) . (2.9)\nThis claim must be handled somewhat carefully since the RHS does not depend on d at all. Brieﬂy, the\nreason this holds is as follows: in the regime when d is small (\n√\nd = o(log2 n)), any word vector vw and\ndiscourse c satisﬁes that exp( ⟨vw,c⟩) ≤exp(∥vw∥) = exp(O(\n√\nd)), and since E[1 ¯F] = exp(−Ω(log2 n)), the\nclaim follows directly; In the regime when dis large (\n√\nd= Ω(log2 n)), we can use concentration inequalities\nto show that except with a small probability exp( −Ω(d)) = exp( −Ω(log2 n)), a uniform sample from the\nsphere behaves equivalently to sampling all of the coordinates from a standard Gaussian distribution with\nmean 0 and variance 1\nd, in which case the claim is not too diﬃcult to show using Gaussian tail bounds.\nTherefore it suﬃces to only consider (2.8). Our model assumptions state that c and c′ cannot be too\ndiﬀerent. We leverage that by rewriting (2.8) a little, and get that it equals\nT1 = 1 ±O(ϵz)\nZ2 E\nc\n[\nexp(⟨vw,c⟩) E\nc′|c\n[exp(⟨vw′ ,c′⟩)]\n]\n= 1 ±O(ϵz)\nZ2 E\nc\n[exp(⟨vw,c⟩)A(c)] (2.10)\nwhere A(c) := E\nc′|c\n[exp(⟨vw′ ,c′⟩)]. We claim that A(c) = (1 ±O(ϵ2)) exp(⟨vw′ ,c⟩). Doing some algebraic\nmanipulations,\nA(c) = exp(⟨vw′ ,c⟩) E\nc′|c\n[exp(⟨vw′ ,c′−c⟩)] .\nFurthermore, by our model assumptions, ∥c−c′∥≤ ϵ2/\n√\nd. So\n⟨vw,c −c′⟩≤∥ vw∥∥c−c′∥= O(ϵ2)\nand thus A(c) = (1 ±O(ϵ2)) exp(⟨vw′ ,c⟩). Plugging the simpliﬁcation of A(c) to (2.10),\nT1 = 1 ±O(ϵz)\nZ2 E[exp(⟨vw + vw′ ,c⟩)]. (2.11)\nSince c has uniform distribution over the sphere, the random variable ⟨vw + vw′ ,c⟩has distribution pretty\nsimilar to Gaussian distribution N(0,∥vw + vw′ ∥2/d), especially when d is relatively large. Observe that\nE[exp(X)] has a closed form for Gaussian random variable X ∼N(0,σ2),\nE[exp(X)] =\n∫\nx\n1\nσ\n√\n2πexp(−x2\n2σ2 ) exp(x)dx\n= exp(σ2/2) . (2.12)\nBounding the diﬀerence between ⟨vw + vw′ ,c⟩from Gaussian random variable, we can show that for\nϵ= ˜O(1/d),\nE[exp(⟨vw + vw′ ,c⟩)] = (1 ±ϵ) exp\n(∥vw + vw′ ∥2\n2d\n)\n. (2.13)\nTherefore, the series of simpliﬁcation/approximation above (concretely, combining equations (2.6), (2.7), (2.9), (2.11),\nand (2.13)) lead to the desired bound on log p(w,w′) for the case when the window size q = 2. The bound\non log p(w) can be shown similarly.\n6\nProof sketch of Lemma 2.1Note that for ﬁxed c, when word vectors have Gaussian priors assumed as\nin our model, Zc = ∑\nwexp(⟨vw,c⟩) is a sum of independent random variables.\nWe ﬁrst claim that using proper concentration of measure tools, it can be shown that the variance of\nZc are relatively small compared to its mean Evw[Zc], and thus Zc concentrates around its mean. Note this\nis quite non-trivial: the random variable exp( ⟨vw,c⟩) is neither bounded nor subgaussian/sub-exponential,\nsince the tail is approximately inverse poly-logarithmic instead of inverse exponential. In fact, the same\nconcentration phenomenon does not happen for w. The occurrence probability of word w is not necessarily\nconcentrated because the ℓ2 norm of vw can vary a lot in our model, which allows the frequency of the words\nto have a large dynamic range.\nSo now it suﬃces to show that Evw[Zc] for diﬀerent c are close to each other. Using the fact that the\nword vector directions have a Gaussian distribution, Evw[Zc] turns out to only depend on the norm of c\n(which is equal to 1). More precisely,\nE\nvw\n[Zc] = f(∥c∥2\n2) = f(1) (2.14)\nwhere f is deﬁned as f(α) = nEs[exp(s2α/2)] and s has the same distribution as the norms of the word\nvectors. We sketch the proof of this. In our model, vw = sw·ˆvw, where ˆvw is a Gaussian vector with identity\ncovariance I. Then\nE\nvw\n[Zc] = nE\nvw\n[exp(⟨vw,c⟩)]\n= nE\nsw\n[\nE\nvw|sw\n[exp(⟨vw,c⟩) |sw]\n]\nwhere the second line is just an application of the law of total expectation, if we pick the norm of the\n(random) vector vw ﬁrst, followed by its direction. Conditioned on sw, ⟨vw,c⟩is a Gaussian random variable\nwith variance ∥c∥2\n2s2\nw, and therefore using similar calculation as in (2.12), we have\nE\nvw|sw\n[exp(⟨vw,c⟩) |sw] = exp(s2∥c∥2\n2/2) .\nHence, Evw[Zc] = nEs[exp(s2∥c∥2\n2/2)] as needed.\nProof of Theorem 4.1 The proof uses the standard analysis of linear regression. Let V = PΣQT be the\nSVD of V and let σ1,...,σ d be the left singular values of V (the diagonal entries of Σ). For notational ease\nwe omit the subscripts in ¯ζ and ζ′since they are not relevant for this proof. Since V†= QΣ−1PT and thus\n¯ζ = V†ζ′= QΣ−1PTζ′, we have\n∥¯ζ∥2 ≤σ−1\nd ∥PTζ′∥2. (2.15)\nWe claim\nσ−1\nd ≤\n√\n1\nc1n. (2.16)\nIndeed, ∑d\ni=1 σ2\ni = O(nd), since the average squared norm of a word vector is d. The claim then follows\nfrom the ﬁrst assumption. Furthermore, by the second assumption, ∥PTζ′∥∞≤ c2√n∥ζ′∥2, so\n∥PTζ′∥2\n2 ≤c2\n2d\nn ∥ζ′∥2\n2. (2.17)\nPlugging (2.16) and (2.17) into (2.15), we get\n∥¯ζ∥2 ≤\n√\n1\nc1n\n√\nc2\n2d\nn ∥ζ′∥2\n2 = c2\n√\nd√c1n∥ζ′∥2\nas desired. The last statement follows because the norm of the signal, which is dlog(νR) originally and is\nV†dlog(νR) = va −vb after dimension reduction, also gets reduced by a factor of √n.\n7\n2.2 Weakening the model assumptions\nFor readers uncomfortable with Bayesian priors, we can replace our assumptions with concrete properties of\nword vectors that are empirically veriﬁable (Section 5.1) for our ﬁnal word vectors, and in fact also for word\nvectors computed using other recent methods.\nThe word meanings are assumed to be represented by some “ground truth” vectors, which the experi-\nmenter is trying to recover. These ground truth vectors are assumed to be spatially isotropic in the bulk,\nin the following two speciﬁc ways: (i) For almost all unit vectors c the sum ∑\nwexp(⟨vw,c⟩) is close to a\nconstant Z; (ii) Singular values of the matrix of word vectors satisfy properties similar to those of random\nmatrices, as formalized in the paragraph before Theorem 4.1. Our Bayesian prior on the word vectors hap-\npens to imply that these two conditions hold with high probability. But the conditions may hold even if the\nprior doesn’t hold. Furthermore, they are compatible with all sorts of local structure among word vectors\nsuch as existence of clusterings, which would be absent in truly random vectors drawn from our prior.\n3 Training objective and relationship to other models\nTo get a training objective out of Theorem 2.2, we reason as follows. Let Xw,w′ be the number of times words\nw and w′co-occur within the same window in the corpus. The probability p(w,w′) of such a co-occurrence\nat any particular time is given by (2.3). Successive samples from a random walk are not independent.\nBut if the random walk mixes fairly quickly (the mixing time is related to the logarithm of the vocabulary\nsize), then the distribution of Xw,w′ ’s is very close to a multinomial distribution Mul(˜L,{p(w,w′)}), where\n˜L= ∑\nw,w′ Xw,w′ is the total number of word pairs.\nAssuming this approximation, we show below that the maximum likelihood values for the word vectors\ncorrespond to the following optimization,\nmin\n{vw},C\n∑\nw,w′\nXw,w′\n(\nlog(Xw,w′ ) −∥vw+vw′ ∥2\n2 −C\n)2\nAs is usual, empirical performance is improved by weighting down very frequent word pairs, possibly\nbecause very frequent words such as “ the” do not ﬁt our model. This is done by replacing the weighting\nXw,w′ by its truncation min{Xw,w′ ,Xmax}where Xmax is a constant such as 100. We call this objective with\nthe truncated weights SN (Squared Norm).\nWe now give its derivation. Maximizing the likelihood of {Xw,w′ }is equivalent to maximizing\nℓ= log\n\n ∏\n(w,w′)\np(w,w′)Xw,w′\n\n.\nDenote the logarithm of the ratio between the expected count and the empirical count as\n∆w,w′ = log\n(˜Lp(w,w′)\nXw,w′\n)\n. (3.1)\nThen with some calculation, we obtain the following where c is independent of the empirical observations\nXw,w′ ’s.\nℓ= c+\n∑\n(w,w′)\nXw,w′ ∆w,w′ (3.2)\n8\nOn the other hand, using ex ≈1 + x+ x2/2 when x is small,5 we have\n˜L=\n∑\n(w,w′)\n˜Lpw,w′ =\n∑\n(w,w′)\nXw,w′ e∆w,w′\n≈\n∑\n(w,w′)\nXw,w′\n(\n1 + ∆w,w′ +\n∆2\nw,w′\n2\n)\n.\nNote that ˜L= ∑\n(w,w′) Xw,w′ , so\n∑\n(w,w′)\nXw,w′ ∆w,w′ ≈−1\n2\n∑\n(w,w′)\nXw,w′ ∆2\nw,w′ .\nPlugging this into (3.2) leads to\n2(c−ℓ) ≈\n∑\n(w,w′)\nXw,w′ ∆2\nw,w′ . (3.3)\nSo maximizing the likelihood is approximately equivalent to minimizing the right hand side, which (by\nexamining (3.1)) leads to our objective.\nObjective for training with PMI.A similar objective PMI can be obtained from (2.5), by computing\nan approximate MLE, using the fact that the error between the empirical and true value of PMI( w,w′) is\ndriven by the smaller term p(w,w′), and not the larger terms p(w),p(w′).\nmin\n{vw},C\n∑\nw,w′\nXw,w′ (PMI(w,w′) −⟨vw,vw′ ⟩)2\nThis is of course very analogous to classical VSM methods, with a novel reweighting method.\nFitting to either of the objectives involves solving a version of Weighted SVD which is NP-hard, but\nempirically seems solvable in our setting via AdaGrad (Duchi et al., 2011).\nConnection to GloVe. Compare SN with the objective used by GloVe (Pennington et al., 2014):\n∑\nw,w′\nf(Xw,w′ )(log(Xw,w′ ) −⟨vw,vw′ ⟩−sw −sw′ −C)2\nwith f(Xw,w′ ) = min {X3/4\nw,w′ ,100}. Their weighting methods and the need for bias terms sw,sw′ ,C were\nderived by trial and error; here they are all predicted and given meanings due to Theorem 2.2, speciﬁcally\nsw = ∥vw∥2.\nConnection to word2vec(CBOW). The CBOW model in word2vec posits that the probability of a\nword wk+1 as a function of the previous k words w1,w2,...,w k:\np\n(\nwk+1\n⏐⏐{wi}k\ni=1\n)\n∝exp(⟨vwk+1 ,1\nk\nk∑\ni=1\nvwi⟩).\n5This Taylor series approximation has an error of the order of x3, but ignoring it can be theoretically justiﬁed as follows.\nFor a large Xw,w′ , its value approaches its expectation and thus the corresponding ∆ w,w′ is close to 0 and thus ignoring\n∆3\nw,w′ is well justiﬁed. The terms where ∆ w,w′ is signiﬁcant correspond to Xw,w′ ’s that are small. But empirically, Xw,w′ ’s\nobey a power law distribution (see, e.g. Pennington et al. (2014)) using which it can be shown that these terms contribute a\nsmall fraction of the ﬁnal objective (3.3). So we can safely ignore the errors. Full details appear in the ArXiv version of this\npaper (Arora et al., 2015).\n9\nThis expression seems mysterious since it depends upon the average word vector for the previous kwords.\nWe show it can be theoretically justiﬁed. Assume a simpliﬁed version of our model, where a small window\nof k words is generated as follows: sample c ∼C, where Cis a uniformly random unit vector, then sample\n(w1,w2,...,w k) ∼exp(⟨∑k\ni=1 vwi,c⟩)/Zc. Furthermore, assume Zc = Z for any c.\nLemma 3.1. In the simpliﬁed version of our model, the Maximum-a-Posteriori (MAP) estimate of c given\n(w1,w2,...,w k) is\n∑k\ni=1 vwi\n∥∑k\ni=1 vwi∥2\n.\nProof. The c maximizing p(c|w1,w2,...,w k) is the maximizer of p(c)p(w1,w2,...,w k|c). Since p(c) =\np(c′) for any c,c′, and we have p(w1,w2,...,w k|c) = exp( ⟨∑\nivwi,c⟩)/Z, the maximizer is clearly c =∑k\ni=1 vwi\n∥∑k\ni=1 vwi∥2\n.\nThus using the MAP estimate of ct gives essentially the same expression as CBOW apart from the\nrescaling, which is often omitted due to computational eﬃciency in empirical works.\n4 Explaining relations=lines\nAs mentioned, word analogies like “ a:b::c:??” can be solved via a linear algebraic expression:\nargmin\nd\n∥va −vb −vc + vd∥2\n2 , (4.1)\nwhere vectors have been normalized such that ∥vd∥2 = 1. This suggests that the semantic relationships\nbeing tested in the analogy are characterized by a straight line, 6 referred to earlier as relations=lines.\nUsing our model we will show the following for low-dimensional embeddings: for each such relation R\nthere is a direction µR in space such that for any word pair a,b satisfying the relation, va −vb is like µR\nplus some noise vector. This happens for relations satisfying a certain condition described below. Empirical\nresults supporting this theory appear in Section 5, where this linear structure is further leveraged to slightly\nimprove analogy solving.\nA side product of our argument will be a mathematical explanation of the empirically well-established su-\nperiority of low-dimensional word embeddings over high-dimensional ones in this setting (Levy and Goldberg,\n2014a). As mentioned earlier, the usual explanation that smaller models generalize better is fallacious.\nWe ﬁrst sketch what was missing in prior attempts to prove versions of relations=lines from ﬁrst\nprinciples. The basic issue is approximation error: the diﬀerence between the best solution and the 2nd best\nsolution to (4.1) is typically small, whereas the approximation error in the objective in the low-dimensional\nsolutions is larger. For instance, if one uses our PMI objective, then the weighted average of the termwise\nerror in (2.5) is 17%, and the expression in (4.1) above contains six inner products. Thus in principle the\napproximation error could lead to a failure of the method and the emergence of linear relationship, but it\ndoes not.\nPrior explanations. Pennington et al. (2014) try to propose a model where such linear relationships\nshould occur by design. They posit that queen is a solution to the analogy “ man:woman::king:??” because\np(χ|king)\np(χ|queen) ≈ p(χ|man)\np(χ|woman), (4.2)\nwhere p(χ |king) denotes the conditional probability of seeing word χ in a small window of text around\nking. Relationship (4.2) is intuitive since both sides will be ≈1 for gender-neutral χlike “walks” or “food”,\n6Note that this interpretation has been disputed; e.g., it is argued in Levy and Goldberg (2014a) that (4.1) can be understood\nusing only the classical connection between inner product and word similarity, using which the objective (4.1) is slightly\nimproved to a diﬀerent objective called 3COSMUL. However, this “explanation” is still dogged by the issue of large termwise\nerror pinpointed here, since inner product is only a rough approximation to word similarity. Furthermore, the experiments in\nSection 5 clearly support the relations=lines interpretation.\n10\nwill be > 1 when χ is like “ he, Henry ” and will be < 1 when χ is like “ dress, she, Elizabeth .” This was\nalso observed by Levy and Goldberg (2014a). Given (4.2), they then posit that the correct model describing\nword embeddings in terms of word occurrences must be a homomorphism from (ℜd,+) to (ℜ+,×), so vector\ndiﬀerences map to ratios of probabilities. This leads to the expression\npw,w′ = ⟨vw,vw′ ⟩+ bw + bw′ ,\nand their method is a (weighted) least squares ﬁt for this expression. One shortcoming of this argument\nis that the homomorphism assumption assumes the linear relationships instead of explaining them from a\nmore basic principle. More importantly, the empirical ﬁt to the homomorphism has nontrivial approximation\nerror, high enough that it does not imply the desired strong linear relationships.\nLevy and Goldberg (2014b) show that empirically, skip-gram vectors satisfy\n⟨vw,vw′ ⟩≈ PMI(w,w′) (4.3)\nup to some shift. They also give an argument suggesting this relationship must be present if the solution\nis allowed to be very high-dimensional. Unfortunately, that argument does not extend to low-dimensional\nembeddings. Even if it did, the issue of termwise approximation error remains.\nOur explanation. The current paper has introduced a generative model to theoretically explain the\nemergence of relationship (4.3). However, as noted after Theorem 2.2, the issue of high approximation error\ndoes not go away either in theory or in the empirical ﬁt. We now show that the isotropy of word vectors\n(assumed in the theoretical model and veriﬁed empirically) implies that even a weak version of (4.3) is enough\nto imply the emergence of the observed linear relationships in low-dimensional embeddings.\nThis argument will assume the analogy in question involves a relation that obeys Pennington et al.’s\nsuggestion in (4.2). Namely, for such a relation R there exists function νR(·) depending only upon R such\nthat for any a,b satisfying R there is a noise function ξa,b,R(·) for which:\np(χ|a)\np(χ|b) = νR(χ) ·ξa,b,R(χ) (4.4)\nFor diﬀerent words χ there is huge variation in (4.4), so the multiplicative noise may be large.\nOur goal is to show that the low-dimensional word embeddings have the property that there is a vector\nµR such that for every pair of words a,b in that relation, va−vb = µR+ noise vector, where the noise vector\nis small.\nTaking logarithms of (4.4) results in:\nlog\n(p(χ|a)\np(χ|b)\n)\n= log(νR(χ)) + ζa,b,R(χ) (4.5)\nTheorem 2.2 implies that the left-hand side simpliﬁes to log\n(\np(χ|a)\np(χ|b)\n)\n= 1\nd ⟨vχ,va −vb⟩+ ϵa,b(χ) where\nϵ captures the small approximation errors induced by the inexactness of Theorem 2.2. This adds yet more\nnoise! Denoting by V the n×d matrix whose rows are the vχ vectors, we rewrite (4.5) as:\nV(va −vb) = dlog(νR) + ζ′\na,b,R (4.6)\nwhere log(νR) in the element-wise log of vector νR and ζ′\na,b,R = d(ζa,b,R −ϵa,b,R) is the noise.\nIn essence, (4.6) shows that va −vb is a solution to a linear regression in d variables and m constraints,\nwith ζ′\na,b,R being the “noise.” The design matrix in the regression is V, the matrix of all word vectors, which\nin our model (as well as empirically) satisﬁes an isotropy condition. This makes it random-like, and thus\nsolving the regression by left-multiplying by V†, the pseudo-inverse of V, ought to “denoise” eﬀectively. We\nnow show that it does.\nOur model assumed the set of all word vectors satisﬁes bulk properties similar to a set of Gaussian vectors.\nThe next theorem will only need the following weaker properties. (1) The smallest non-zero singular value\n11\n0.5 1 1.5 2\n0\n20\n40\nPartition function value\nPercentage\n(a) SN\n0.5 1 1.5 2\n0\n20\n40\n60\n80\n100\nPartition function value (b) GloVe\n0.5 1 1.5 2\n0\n20\n40\n60\n80\nPartition function value (c) CBOW\n0.5 1 1.5 2\n0\n20\n40\nPartition function value (d) skip-gram\nFigure 1: The partition function Zc. The ﬁgure shows the histogram of Zc for 1000 random vectors c of\nappropriate norm, as deﬁned in the text. The x-axis is normalized by the mean of the values. The values Zc\nfor diﬀerent cconcentrate around the mean, mostly in [0.9,1.1]. This concentration phenomenon is predicted\nby our analysis.\nof V is larger than some constant c1 times the quadratic mean of the singular values, namely, ∥V∥F/\n√\nd.\nEmpirically we ﬁnd c1 ≈1/3 holds; see Section 5. (2) The left singular vectors behave like random vectors\nwith respect to ζ′\na,b,R, namely, have inner product at most c2∥ζ′\na,b,R∥/√n with ζ′\na,b,R, for some constant c2.\n(3) The max norm of a row in V is O(\n√\nd). The proof is included in the appendix.\nTheorem 4.1(Noise reduction). Under the conditions of the previous paragraph, the noise in the dimension-\nreduced semantic vector space satisﬁes\n∥¯ζa,b,R∥2 ≲ ∥ζ′\na,b,R∥2\n√\nd\nn .\nAs a corollary, the relative error in the dimension-reduced space is a factor of\n√\nd/n smaller.\n5 Experimental veriﬁcation\nIn this section, we provide experiments empirically supporting our generative model.\nCorpus. All word embedding vectors are trained on the English Wikipedia (March 2015 dump). It is\npre-processed by standard approach (removing non-textual elements, sentence splitting, and tokenization),\nleaving about 3 billion tokens. Words that appeared less than 1000 times in the corpus are ignored, resulting\nin a vocabulary of 68 ,430. The co-occurrence is then computed using windows of 10 tokens to each side of\nthe focus word.\nTraining method. Our embedding vectors are trained by optimizing theSN objective using AdaGrad (Duchi\net al., 2011) with initial learning rate of 0 .05 and 100 iterations. The PMI objective derived from (2.5) was\nalso used. SN has average (weighted) term-wise error of 5%, and PMI has 17%. We observed that SN\nvectors typically ﬁt the model better and have better performance, which can be explained by larger errors\nin PMI, as implied by Theorem 2.2. So, we only report the results for SN.\nFor comparison, GloVe and two variants of word2vec (skip-gram and CBOW) vectors are trained. GloVe’s\nvectors are trained on the same co-occurrence as SN with the default parameter values. 7 word2vec vectors\nare trained using a window size of 10, with other parameters set to default values. 8\n7http://nlp.stanford.edu/projects/glove/\n8https://code.google.com/p/word2vec/\n12\n6 8 10 12 14 16 18\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\nNatural logarithm of frequency\nSquared norm\nFigure 2: The linear relationship between the squared norms of our word vectors and the logarithms of\nthe word frequencies. Each dot in the plot corresponds to a word, where x-axis is the natural logarithm of\nthe word frequency, and y-axis is the squared norm of the word vector. The Pearson correlation coeﬃcient\nbetween the two is 0.75, indicating a signiﬁcant linear relationship, which strongly supports our mathematical\nprediction, that is, equation (2.4) of Theorem 2.2.\n5.1 Model veriﬁcation\nExperiments were run to test our modeling assumptions. First, we tested two counter-intuitive properties:\nthe concentration of the partition function Zc for diﬀerent discourse vectors c (see Theorem 2.1), and the\nrandom-like behavior of the matrix of word embeddings in terms of its singular values (see Theorem 4.1).\nFor comparison we also tested these properties for word2vec and GloVe vectors, though they are trained by\ndiﬀerent objectives. Finally, we tested the linear relation between the squared norms of our word vectors\nand the logarithm of the word frequencies, as implied by Theorem 2.2.\nPartition function. Our theory predicts the counter-intuitive concentration of the partition function\nZc = ∑\nw′ exp(c⊤vw′ ) for a random discourse vector c (see Lemma 2.1). This is veriﬁed empirically by\npicking a uniformly random direction, of norm ∥c∥= 4 /µw, where µw is the average norm of the word\nvectors.9 Figure 1(a) shows the histogram of Zc for 1000 such randomly chosen c’s for our vectors. The\nvalues are concentrated, mostly in the range [0 .9,1.1] times the mean. Concentration is also observed for\nother types of vectors, especially for GloVe and CBOW.\nIsotropy with respect to singular values.Our theoretical explanation of relations=lines assumes\nthat the matrix of word vectors behaves like a random matrix with respect to the properties of singular\nvalues. In our embeddings, the quadratic mean of the singular values is 34.3, while the minimum non-zero\nsingular value of our word vectors is 11. Therefore, the ratio between them is a small constant, consistent\nwith our model. The ratios for GloVe, CBOW, and skip-gram are 1.4, 10.1, and 3.1, respectively, which are\nalso small constants.\nSquared norms v.s. word frequencies. Figure 2 shows a scatter plot for the squared norms of our\nvectors and the logarithms of the word frequencies. A linear relationship is observed (Pearson correlation\n0.75), thus supporting Theorem 2.2. The correlation is stronger for high frequency words, possibly because\nthe corresponding terms have higher weights in the training objective.\n9Note that our model uses the inner products between the discourse vectors and word vectors, so it is invariant if the\ndiscourse vectors are scaled by s while the word vectors are scaled by 1 /s for any s >0. Therefore, one needs to choose the\nnorm of c properly. We assume ∥c∥µw =\n√\nd/κ ≈4 for a constant κ = 5 so that it gives a reasonable ﬁt to the predicted\ndynamic range of word frequencies according to our theory; see model details in Section 2.\n13\nRelations SN GloVe CBOW skip-gram\nG\nsemantic 0.84 0.85 0.79 0.73\nsyntactic 0.61 0.65 0.71 0.68\ntotal 0.71 0.73 0.74 0.70\nM\nadjective 0.50 0.56 0.58 0.58\nnoun 0.69 0.70 0.56 0.58\nverb 0.48 0.53 0.64 0.56\ntotal 0.53 0.57 0.62 0.57\nTable 1: The accuracy on two word analogy task testbeds: G (the GOOGLE testbed); M (the MSR testbed).\nPerformance is close to the state of the art despite using a generative model with provable properties.\nThis correlation is much weaker for other types of word embeddings. This is possibly because they have\nmore free parameters (“knobs to turn”), which imbue the embeddings with other properties. This can also\ncause the diﬀerence in the concentration of the partition function for the two methods.\n5.2 Performance on analogy tasks\nWe compare the performance of our word vectors on analogy tasks, speciﬁcally the two testbeds GOOGLE\nand MSR (Mikolov et al., 2013a;c). The former contains 7874 semantic questions such as “man:woman::king:??”,\nand 10167 syntactic ones such as “run:runs::walk:??.” The latter has 8000 syntactic questions for adjectives,\nnouns, and verbs.\nTo solve these tasks, we use linear algebraic queries. 10 That is, ﬁrst normalize the vectors to unit norm\nand then solve “a:b::c:??” by\nargmin\nd\n∥va −vb −vc + vd∥2\n2 . (5.1)\nThe algorithm succeeds if the best d happens to be correct.\nThe performance of diﬀerent methods is presented in Table 1. Our vectors achieve performance compara-\nble to the state of art on semantic analogies (similar accuracy as GloVe, better than word2vec). On syntactic\ntasks, they achieve accuracy 0 .04 lower than GloVe and skip-gram, while CBOW typically outperforms the\nothers.11 The reason is probably that our model ignores local word order, whereas the other models capture\nit to some extent. For example, a word “ she” can aﬀect the context by a lot and determine if the next word\nis “thinks” rather than “ think”. Incorporating such linguistic features in the model is left for future work.\n5.3 Verifying relations=lines\nThe theory in Section 4 predicts the existence of a direction for a relation, whereas earlier Levy and Goldberg\n(2014a) had questioned if this phenomenon is real. The experiment uses the analogy testbed, where each\nrelation is tested using 20 or more analogies. For each relation, we take the set of vectors vab = va −vb\nwhere the word pair (a,b) satisﬁes the relation. Then calculate the top singular vectors of the matrix formed\nby these vab’s, and compute the cosine similarity (i.e., normalized inner product) of individual vab to the\nsingular vectors. We observed that most ( va −vb)’s are correlated with the ﬁrst singular vector, but have\ninner products around 0 with the second singular vector. Over all relations, the average projection on the\nﬁrst singular vector is 0.51 (semantic: 0.58; syntactic: 0.46), and the average on the second singular vector\nis 0.035. For example, Table 2 shows the mean similarities and standard deviations on the ﬁrst and second\nsingular vectors for 4 relations. Similar results are also obtained for word embedings by GloVe and word2vec.\nTherefore, the ﬁrst singular vector can be taken as the direction associated with this relation, while the other\ncomponents are like random noise, in line with our model.\n10One can instead use the 3COSMUL in (Levy and Goldberg, 2014a), which increases the accuracy by about 3%. But it is\nnot linear while our focus here is the linear algebraic structure.\n11It was earlier reported that skip-gram outperforms CBOW (Mikolov et al., 2013a; Pennington et al., 2014). This may be\ndue to the diﬀerent training data sets and hyperparameters used.\n14\nrelation 1 2 3 4 5 6 7\n1st 0.65 ±0.07 0.61 ±0.09 0.52 ±0.08 0.54 ±0.18 0.60 ±0.21 0.35 ±0.17 0.42 ±0.16\n2nd 0.02 ±0.28 0.00 ±0.23 0.05 ±0.30 0.06 ±0.27 0.01 ±0.24 0.07 ±0.24 0.01 ±0.25\nrelation 8 9 10 11 12 13 14\n1st 0.56 ±0.09 0.53 ±0.08 0.37 ±0.11 0.72 ±0.10 0.37 ±0.14 0.40 ±0.19 0.43 ±0.14\n2nd 0.00 ±0.22 0.01 ±0.26 0.02 ±0.20 0.01 ±0.24 0.07 ±0.26 0.07 ±0.23 0.09 ±0.23\nTable 2: The veriﬁcation of relation directions on 2 semantic and 2 syntactic relations in the GOOGLE\ntestbed. Relations include cap-com: capital-common-countries; cap-wor: capital-world; adj-adv: gram1-\nadjective-to-adverb; opp: gram2-opposite. For each relation, take vab = va −vb for pairs ( a,b) in the\nrelation, and then calculate the top singular vectors of the matrix formed by these vab’s. The row with label\n“1st”/“2nd” shows the cosine similarities of individual vab to the 1st/2nd singular vector (the mean and\nstandard deviation).\nSN GloVe CBOW skip-gram\nw/o RD 0.71 0.73 0.74 0.70\nRD(k = 20) 0.74 0.77 0.79 0.75\nRD(k = 30) 0.79 0.80 0.82 0.80\nRD(k = 40) 0.76 0.80 0.80 0.77\nTable 3: The accuracy of the RD algorithm (i.e., the cheater method) on the GOOGLE testbed. The RD\nalgorithm is described in the text. For comparison, the row “w/o RD” shows the accuracy of the old method\nwithout using RD.\nCheating solver for analogy testbeds.The above linear structure suggests a better (but cheating) way\nto solve the analogy task. This uses the fact that the same semantic relationship (e.g., masculine-feminine,\nsingular-plural) is tested many times in the testbed. If a relation Ris represented by a direction µR then the\ncheating algorithm can learn this direction (via rank 1 SVD) after seeing a few examples of the relationship.\nThen use the following method of solving “ a:b::c:??”: look for a word d such that vc −vd has the largest\nprojection on µR, the relation direction for ( a,b). This can boost success rates by about 10%.\nThe testbed can try to combat such cheating by giving analogy questions in a random order. But the\ncheating algorithm can just cluster the presented analogies to learn which of them are in the same relation.\nThus the ﬁnal algorithm, named analogy solver with relation direction ( RD), is: take all vectors va−vb for\nall the word pairs (a,b) presented among the analogy questions and do k-means clustering on them; for each\n(a,b), estimate the relation direction by taking the ﬁrst singular vector of its cluster, and substitute that\nfor va −vb in (5.1) when solving the analogy. Table 3 shows the performance on GOOGLE with diﬀerent\nvalues of k; e.g. using our SN vectors and k = 30 leads to 0 .79 accuracy. Thus future designers of analogy\ntestbeds should remember not to test the same relationship too many times! This still leaves other ways to\ncheat, such as learning the directions for interesting semantic relations from other collections of analogies.\nNon-cheating solver for analogy testbeds. Now we show that even if a relationship is tested only\nonce in the testbed, there is a way to use the above structure. Given “ a:b::c:??,” the solver ﬁrst ﬁnds the\ntop 300 nearest neighbors of a and those of b, and then ﬁnds among these neighbors the top k pairs (a′,b′)\nso that the cosine similarities between va′ −vb′ and va −vb are largest. Finally, the solver uses these pairs\nto estimate the relation direction (via rank 1 SVD), and substitute this (corrected) estimate for va −vb in\n(5.1) when solving the analogy. This algorithm is named analogy solver with relation direction by nearest\nneighbors (RD-nn). Table 4 shows its performance, which consistently improves over the old method by\nabout 3%.\n15\nSN GloVe CBOW skip-gram\nw/o RD-nn 0.71 0.73 0.74 0.70\nRD-nn (k = 10) 0.71 0.74 0.77 0.73\nRD-nn (k = 20) 0.72 0.75 0.77 0.74\nRD-nn (k = 30) 0.73 0.76 0.78 0.74\nTable 4: The accuracy of the RD-nn algorithm on the GOOGLE testbed. The algorithm is described in the\ntext. For comparison, the row “w/o RD-nn” shows the accuracy of the old method without using RD-nn.\n6 Conclusions\nA simple generative model has been introduced to explain the classical PMI based word embedding models,\nas well as recent variants involving energy-based models and matrix factorization. The model yields an\noptimization objective with essentially “no knobs to turn”, yet the embeddings lead to good performance\non analogy tasks, and ﬁt other predictions of our generative model. A model with fewer knobs to turn\nshould be seen as a better scientiﬁc explanation ( Occam’s razor), and certainly makes the embeddings more\ninterpretable.\nThe spatial isotropy of word vectors is both an assumption in our model, and also a new empirical\nﬁnding of our paper. We feel it may help with further development of language models. It is important for\nexplaining the success of solving analogies via low dimensional vectors ( relations=lines). It also implies\nthat semantic relationships among words manifest themselves as special directions among word embeddings\n(Section 4), which lead to a cheater algorithm for solving analogy testbeds.\nOur model is tailored to capturing semantic similarity, more akin to a log-linear dynamic topic model.\nIn particular, local word order is unimportant. Designing similar generative models (with provable and\ninterpretable properties) with linguistic features is left for future work.\nAcknowledgements\nWe thank the editors of TACL for granting a special relaxation of the page limit for our paper. We thank\nYann LeCun, Christopher D. Manning, and Sham Kakade for helpful discussions at various stages of this\nwork.\nThis work was supported in part by NSF grants CCF-1527371, DMS-1317308, Simons Investigator Award,\nSimons Collaboration Grant, and ONR-N00014-16-1-2329. Tengyu Ma was supported in addition by Simons\nAward in Theoretical Computer Science and IBM PhD Fellowship.\nReferences\nJacob Andreas and Dan Klein. When and why are log-linear models self-normalizing? In Proceedings of the\nAnnual Meeting of the North American Chapter of the Association for Computational Linguistics , 2014.\nSanjeev Arora, Yuanzhi Li, Yingyu Liang, Tengyu Ma, and Andrej Risteski. A latent variable model approach\nto PMI-based word embeddings. Technical report, ArXiV, 2015. http://arxiv.org/abs/1502.03520.\nSanjeev Arora, Yuanzhi Li, Yingyu Liang, Tengyu Ma, and Andrej Risteski. Linear alge-\nbraic structure of word senses, with applications to polysemy. Technical report, ArXiV, 2016.\nhttp://arxiv.org/abs/1502.03520.\nDavid Belanger and Sham M. Kakade. A linear dynamical system model for text. In Proceedings of the 32nd\nInternational Conference on Machine Learning , 2015.\nYoshua Bengio, Holger Schwenk, Jean-S´ ebastien Sen´ ecal, Fr´ ederic Morin, and Jean-Luc Gauvain. Neural\nprobabilistic language models. In Innovations in Machine Learning . 2006.\n16\nFischer Black and Myron Scholes. The pricing of options and corporate liabilities. Journal of Political\nEconomy, 1973.\nDavid M. Blei. Probabilistic topic models. Communication of the Association for Computing Machinery ,\n2012.\nDavid M. Blei and John D. Laﬀerty. Dynamic topic models. In Proceedings of the 23rd International\nConference on Machine Learning, 2006.\nKenneth Ward Church and Patrick Hanks. Word association norms, mutual information, and lexicography.\nComputational linguistics, 1990.\nShay B. Cohen, Karl Stratos, Michael Collins, Dean P. Foster, and Lyle Ungar. Spectral learning of latent-\nvariable PCFGs. In Proceedings of the 50th Annual Meeting of the Association for Computational Lin-\nguistics: Long Papers-Volume 1 , 2012.\nRonan Collobert and Jason Weston. A uniﬁed architecture for natural language processing: Deep neural net-\nworks with multitask learning. In Proceedings of the 25th International Conference on Machine Learning ,\n2008a.\nRonan Collobert and Jason Weston. A uniﬁed architecture for natural language processing: Deep neural net-\nworks with multitask learning. In Proceedings of the 25th International Conference on Machine Learning ,\n2008b.\nScott C. Deerwester, Susan T Dumais, Thomas K. Landauer, George W. Furnas, and Richard A. Harshman.\nIndexing by latent semantic analysis. Journal of the American Society for Information Science , 1990.\nJohn Duchi, Elad Hazan, and Yoram Singer. Adaptive subgradient methods for online learning and stochastic\noptimization. The Journal of Machine Learning Research , 2011.\nJohn Rupert Firth. A synopsis of linguistic theory . 1957.\nAmir Globerson, Gal Chechik, Fernando Pereira, and Naftali Tishby. Euclidean embedding of co-occurrence\ndata. Journal of Machine Learning Research , 2007.\nTatsunori B. Hashimoto, David Alvarez-Melis, and Tommi S. Jaakkola. Word embeddings as metric recovery\nin semantic spaces. Transactions of the Association for Computational Linguistics , 2016.\nThomas Hofmann. Probabilistic latent semantic analysis. In Proceedings of the Fifteenth Conference on\nUncertainty in Artiﬁcial Intelligence , 1999.\nDaniel Hsu, Sham M. Kakade, and Tong Zhang. A spectral algorithm for learning hidden markov models.\nJournal of Computer and System Sciences , 2012.\nOmer Levy and Yoav Goldberg. Linguistic regularities in sparse and explicit word representations. In\nProceedings of the Eighteenth Conference on Computational Natural Language Learning , 2014a.\nOmer Levy and Yoav Goldberg. Neural word embedding as implicit matrix factorization. In Advances in\nNeural Information Processing Systems, 2014b.\nAndrew L. Maas, Raymond E. Daly, Peter T. Pham, Dan Huang, Andrew Y. Ng, and Christopher Potts.\nLearning word vectors for sentiment analysis. In The 49th Annual Meeting of the Association for Compu-\ntational Linguistics, 2011.\nYariv Maron, Michael Lamar, and Elie Bienenstock. Sphere embedding: An application to part-of-speech\ninduction. In Advances in Neural Information Processing Systems , 2010.\n17\nTomas Mikolov, Kai Chen, Greg Corrado, and Jeﬀrey Dean. Eﬃcient estimation of word representations in\nvector space. Proceedings of the International Conference on Learning Representations , 2013a.\nTomas Mikolov, Ilya Sutskever, Kai Chen, Greg S. Corrado, and Jeﬀ Dean. Distributed representations of\nwords and phrases and their compositionality. In Advances in Neural Information Processing Systems ,\n2013b.\nTomas Mikolov, Wen-tau Yih, and Geoﬀrey Zweig. Linguistic regularities in continuous space word rep-\nresentations. In Proceedings of the Conference of the North American Chapter of the Association for\nComputational Linguistics: Human Language Technologies , 2013c.\nAndriy Mnih and Geoﬀrey Hinton. Three new graphical models for statistical language modelling. In\nProceedings of the 24th International Conference on Machine Learning , 2007.\nChristos H. Papadimitriou, Hisao Tamaki, Prabhakar Raghavan, and Santosh Vempala. Latent semantic\nindexing: A probabilistic analysis. In Proceedings of the 7th ACM SIGACT-SIGMOD-SIGART Symposium\non Principles of Database Systems , 1998.\nJeﬀrey Pennington, Richard Socher, and Christopher D. Manning. Glove: Global vectors for word represen-\ntation. Proceedings of the Empiricial Methods in Natural Language Processing , 2014.\nDouglas L. T. Rohde, Laura M. Gonnerman, and David C. Plaut. An improved model of semantic similarity\nbased on lexical co-occurence. Communication of the Association for Computing Machinery , 2006.\nDavid E. Rumelhart, Geoﬀrey E. Hinton, and James L. McClelland, editors. Parallel Distributed Processing:\nExplorations in the Microstructure of Cognition . 1986.\nDavid E. Rumelhart, Geoﬀrey E. Hinton, and Ronald J. Williams. Learning representations by back-\npropagating errors. Cognitive modeling, 1988.\nPeter D. Turney and Patrick Pantel. From frequency to meaning: Vector space models of semantics. Journal\nof Artiﬁcial Intelligence Research, 2010.\n18\nA Proofs of Theorem 1\nIn this section we prove Theorem 2.2 and Lemma 2.1 (restated below).\nTheorem 2.2. Suppose the word vectors satisfy equation (2.2), and window size q= 2. Then,\nlog p(w,w′) = ∥vw + vw′ ∥2\n2\n2d −2 logZ±ϵ, (A.1)\nlog p(w) = ∥vw∥2\n2\n2d −log Z±ϵ. (A.2)\nfor ϵ= O(ϵz) + ˜O(1/d) + O(ϵ2). Jointly these imply:\nPMI (w,w′) = ⟨vw,vw′ ⟩\nd ±O(ϵ). (A.3)\nLemma 2.1. If the word vectors satisfy the bayesian prior v= s·ˆv, where ˆv is from the spherical Gaussian\ndistribution, and sis a scalar random variable, then with high probability the entire ensemble of word vectors\nsatisﬁes that\nPr\nc∼C\n[(1 −ϵz)Z ≤Zc ≤(1 + ϵz)Z] ≥1 −δ, (A.4)\nfor ϵz = ˜O(1/√n), and δ= exp(−Ω(log2 n)).\nWe ﬁrst prove Theorem 2.2 using Lemma 2.1, and Lemma 2.1 will be proved in Section A.1. Please see\nSection 2 of the main paper for the intuition of the proof and a cleaner sketch without too many technicalities.\nProof of Theorem 2.2. Let c be the hidden discourse that determines the probability of word w, and c′ be\nthe next one that determines w′. We use p(c′|c) to denote the Markov kernel (transition matrix) of the\nMarkov chain. Let Cbe the stationary distribution of discourse vector c, and Dbe the joint distribution of\n(c,c′). We marginalize over the contexts c,c′and then use the independence of w,w′conditioned on c,c′,\np(w,w′) = E\n(c,c′)∼D\n[exp(⟨vw,c⟩)\nZc\nexp(⟨vw′ ,c′⟩)\nZc′\n]\n(A.5)\nWe ﬁrst get rid of the partition function Zc using Lemma 2.1. As sketched in the main paper, essentially\nwe will replace Zc by Z in equation (A.5), though a very careful control of the approximation error is\nrequired. Formally, Let F1 be the event that c satisﬁes\n(1 −ϵz)Z ≤Zc ≤(1 + ϵz)Z. (A.6)\nSimilarly, let F2 be the even that c′satisﬁes (1 −ϵz)Z ≤Zc′ ≤(1 +ϵz)Z, and let F= F1 ∩F2, and Fbe its\nnegation. Moreover, let 1F be the indicator function for the event F. Therefore by Lemma 2.1 and union\nbound, we have E[1F] = Pr[F] ≥1 −exp(−Ω(log2 n)).\nWe ﬁrst decompose the integral (A.5) into the two parts according to whether event Fhappens,\np(w,w′) = E\n(c,c′)∼D\n[ 1\nZcZc′\nexp(⟨vw,c⟩) exp(⟨vw′ ,c′⟩)1F\n]\n+ E\n(c,c′)∼D\n[ 1\nZcZc′\nexp(⟨vw,c⟩) exp(⟨vw′ ,c′⟩)1F\n]\n(A.7)\nWe bound the ﬁrst quantity on the right hand side using (2.2) and the deﬁnition of F.\nE\n(c,c′)∼D\n[ 1\nZcZc′\nexp(⟨vw,c⟩) exp(⟨vw′ ,c′⟩)1F\n]\n≤(1 + ϵz)2 1\nZ2 E\n(c,c′)∼D\n[exp(⟨vw,c⟩) exp(⟨vw′ ,c′⟩)1F] (A.8)\n19\nFor the second quantity of the right hand side of (A.7), we have by Cauchy-Schwartz,\n(\nE\n(c,c′)∼D\n[ 1\nZcZc′\nexp(⟨vw,c⟩) exp(⟨vw′ ,c′⟩)1F\n])2\n≤\n(\nE\n(c,c′)∼D\n[ 1\nZ2c\nexp(⟨vw,c⟩)21F\n])(\nE\n(c,c′)∼D\n[∫\nc,c′\n1\nZ2\nc′\nexp(⟨vw′ ,c′⟩)21F\n])\n≤\n(\nE\nc\n[ 1\nZ2c\nexp(⟨vw,c⟩)2 E\nc′|c\n[1F]\n])(\nE\nc′\n[ 1\nZ2\nc′\nexp(⟨vw′ ,c′⟩)2 E\nc|c′\n[1F]\n])\n. (A.9)\nUsing the fact that Zc ≥1, then we have that\nE\nc\n[ 1\nZ2c\nexp(⟨vw,c⟩)2 E\nc′|c\n[1F]\n]\n≤E\nc\n[\nexp(⟨vw,c⟩)2 E\nc′|c\n[1F]\n]\nWe can split that expectation as\nE\nc\n[\nexp(⟨vw,c⟩)21⟨vw,c⟩>0 E\nc′|c\n[1F]\n]\n+ E\nc\n[\nexp(⟨vw,c⟩)21⟨vw,c⟩<0 E\nc′|c\n[1F]\n]\n. (A.10)\nThe second term of (A.10) is upper bounded by\nE\nc,c′\n[1F] ≤exp(−Ω(log2 n))\nWe proceed to the ﬁrst term of (A.10) and observe the following property of it:\nE\nc\n[\nexp(⟨vw,c⟩)21⟨vw,c⟩>0 E\nc′|c\n[1F]\n]\n≤E\nc\n[\nexp(⟨αvw,c⟩)21⟨vw,c⟩>0 E\nc′|c\n[1F]\n]\n≤E\nc\n[\nexp(⟨αvw,c⟩)2 E\nc′|c\n[1F]\n]\nwhere α> 1. Therefore, it’s suﬃcient to bound\nE\nc\n[\nexp(⟨vw,c⟩)2 E\nc′|c\n[1F]\n]\nwhen ∥vw∥= Ω(\n√\nd).\nLet’s denote by z the random variable 2 ⟨vw,c⟩.\nLet’s denote r(z) = Ec′|z[1F] which is a function ofzbetween [0,1]. We wish to upper boundEc[exp(z)r(z)].\nThe worst-case r(z) can be quantiﬁed using a continuous version of Abel’s inequality as proven in Lemma A.4,\nwhich gives\nE\nc\n[exp(z)r(z)] ≤E\n[\nexp(z)1[t,+∞](z)\n]\n(A.11)\nwhere t satisﬁes that Ec[1[t,+∞]] = Pr[ z ≥t] = Ec[r(z)] ≤exp(−Ω(log2 n)). Then, we claim Pr[ z ≥t] ≤\nexp(−Ω(log2 n)) implies that t≥Ω(log.9 n).\nIf cwere distributed as N(0,1\ndI), this would be a simple tail bound. However, ascis distributed uniformly\non the sphere, this requires special care, and the claim follows by applying Lemma A.1 instead. Finally,\napplying Corollary A.3, we have:\nE[exp(z)r(z)] ≤E\n[\nexp(z)1[t,+∞](z)\n]\n= exp(−Ω(log1.8 n)) (A.12)\nWe have the same bound for c′ as well. Hence, for the second quantity of the right hand side of (A.7),\nwe have\nE\n(c,c′)∼D\n[ 1\nZcZc′\nexp(⟨vw,c⟩) exp(⟨vw′ ,c′⟩)1F\n]\n≤\n(\nE\nc\n[ 1\nZ2c\nexp(⟨vw,c⟩)2 E\nc′|c\n[1F]\n])1/2 (\nE\nc′\n[ 1\nZ2\nc′\nexp(⟨vw′ ,c′⟩)2 E\nc|c′\n[1F]\n])1/2\n≤exp(−Ω(log1.8 n)) (A.13)\n20\nwhere the ﬁrst inequality follows from Cauchy-Schwartz, and the second from the calculation above. Com-\nbining (A.7), (A.8) and (A.13), we obtain\np(w,w′) ≤(1 + ϵz)2 1\nZ2 E\n(c,c′)∼D\n[exp(⟨vw,c⟩) exp(⟨vw′ ,c′⟩)1F] + 1\nn2 exp(−Ω(log1.8 n))\n≤(1 + ϵz)2 1\nZ2 E\n(c,c′)∼D\n[exp(⟨vw,c⟩) exp(⟨vw′ ,c′⟩)] + δ0\nwhere δ0 = exp(−Ω(log1.8 n))Z2 ≤exp(−Ω(log1.8 n)) by the fact that Z ≤exp(2κ)n= O(n). Note that\nκis treated as an absolute constant throughout the paper. On the other hand, we can lowerbound similarly\np(w,w′) ≥(1 −ϵz)2 1\nZ2 E\n(c,c′)∼D\n[exp(⟨vw,c⟩) exp(⟨vw′ ,c′⟩)1F]\n≥(1 −ϵz)2 1\nZ2 E\n(c,c′)∼D\n[exp(⟨vw,c⟩) exp(⟨vw′ ,c′⟩)] − 1\nn2 exp(−Ω(log1.8 n))\n≥(1 −ϵz)2 1\nZ2 E\n(c,c′)∼D\n[exp(⟨vw,c⟩) exp(⟨vw′ ,c′⟩)] −δ0\nTaking logarithm, the multiplicative error translates to a additive error\nlog p(w,w′) = log\n(\nE\n(c,c′)∼D\n[exp(⟨vw,c⟩) exp(⟨vw′ ,c′⟩)] ±δ0\n)\n−2 logZ+ 2 log(1±ϵz)\nFor the purpose of exploiting the fact that c,c′should be close to each other, we further rewrite log p(w,w′)\nby re-organizing the expectations above,\nlog p(w,w′) = log\n(\nE\nc\n[\nexp(⟨vw,c⟩) E\nc′|c\n[exp(⟨vw′ ,c′⟩)]\n]\n±δ0\n)\n−2 logZ+ 2 log(1±ϵz)\n= log\n(\nE\nc\n[exp(⟨vw,c⟩)A(c)] ±δ0\n)\n−2 logZ+ 2 log(1±ϵz) (A.14)\nwhere the inner integral which is denoted by A(c),\nA(c) := E\nc′|c\n[exp(⟨vw′ ,c′⟩)]\nSince ∥vw∥≤ κ\n√\nd. Therefore we have that ⟨vw,c −c′⟩≤∥ vw∥∥c−c′∥≤ κ\n√\nd∥c−c′∥.\nThen we can bound A(c) by\nA(c) = E\nc′|c\n[exp(⟨vw′ ,c′⟩)]\n= exp(⟨vw′ ,c⟩) E\nc′|c\n[exp(⟨vw′ ,c′−c⟩)]\n≤exp(⟨vw′ ,c⟩) E\nc′|c\n[exp(κ\n√\nd∥c−c′∥)]\n≤(1 + ϵ2) exp(⟨vw′ ,c⟩)\nwhere the last inequality follows from our model assumptions. To derive a lower bound of A(c), observe that\n21\nE\nc′|c\n[exp(κ\n√\nd∥c−c′∥)] + E\nc′|c\n[exp(−κ\n√\nd∥c−c′∥)] ≥2\nTherefore, our model assumptions imply that\nE\nc′|c\n[exp(−κ\n√\nd∥c−c′∥)] ≥1 −ϵ2\nHence,\nA(c) = exp(⟨vw′ ,c⟩) E\nc′|c\nexp(⟨vw′ ,c′−c⟩)\n≥exp(⟨vw′ ,c⟩) E\nc′|c\nexp(−κ\n√\nd∥c−c′∥)\n≥(1 −ϵ2) exp(⟨vw′ ,c⟩)\nTherefore, we obtain that A(c) = (1 ±ϵ2) exp(⟨vw′ ,c⟩). Plugging the just obtained estimate of A(c) into\nthe equation (A.14), we get that\nlog p(w,w′) = log\n(\nE\nc\n[exp(⟨vw,c⟩)A(c)] ±δ0\n)\n−2 logZ+ 2 log(1±ϵz)\n= log\n(\nE\nc\n[(1 ±ϵ2) exp(⟨vw,c⟩) exp(⟨vw′ ,c⟩)] ±δ0\n)\n−2 logZ+ 2 log(1±ϵz)\n= log\n(\nE\nc\n[exp(⟨vw + vw′ ,c⟩)] ±δ0\n)\n−2 logZ+ 2 log(1±ϵz) + log(1±ϵ2) (A.15)\nNow it suﬃces to compute Ec[exp(⟨vw + vw′ ,c⟩)]. Note that if c had the distribution N(0,1\ndI), which\nis very similar to uniform distribution over the sphere, then we could get straightforwardly Ec[exp(⟨vw +\nvw′ ,c⟩)] = exp(∥vw + vw′ ∥2/(2d)). For c having a uniform distribution over the sphere, by Lemma A.5, the\nsame equality holds approximately,\nE\nc\n[exp(⟨vw + vw′ ,c⟩)] = (1 ±ϵ3) exp(∥vw + vw′ ∥2/(2d)) (A.16)\nwhere ϵ3 = ˜O(1/d).\nPlugging in equation (A.16) into equation (A.15), we have that\nlog p(w,w′) = log\n(\n(1 ±ϵ3) exp(∥vw + vw′ ∥2/(2d)) ±δ0\n)\n−2 logZ+ 2 log(1±ϵz) + log(1±ϵ2)\n= ∥vw + vw′ ∥2/(2d) + O(ϵ3) + O(δ′\n0) −2 logZ±2ϵz ±ϵ2\nwhere δ′\n0 = δ0 ·(Ec∼C[exp(⟨vw + vw′ ,c⟩)])−1 = exp(−Ω(log1.8 n)). Note that ϵ3 = ˜O(1/d), ϵz = ˜O(1/√n),\nand ϵ2 by assumption, therefore we obtain that\nlog p(w,w′) = 1\n2d∥vw + vw′ ∥2 −2 logZ±O(ϵz) + O(ϵ2) + ˜O(1/d).\nThe following lemmas are helper lemmas that were used in the proof above. We use Cd to denote the\nuniform distribution over the unit sphere in Rd.\nLemma A.1 (Tail bound for spherical distribution) . If c∼Cd, v ∈Rd is a vector with ∥v∥= Ω(\n√\nd) and\nt= ω(1), the random variable z= ⟨v,c⟩satisﬁes Pr[z≥t] = e−O(t2).\n22\nProof. If c = ( c1,c2,...,c d) ∼Cd, c is in distribution equal to\n(\n˜c1\n∥˜c∥, ˜c2\n∥˜c∥,..., ˜cd\n∥˜c∥\n)\nwhere the ˜ci are i.i.d.\nsamples from a univariate Gaussian with mean 0 and variance 1\nd. By spherical symmetry, we may assume\nthat v= (∥v∥,0,..., 0). Let’s introduce the random variable r= ∑d\ni=2 ˜c2\ni. Since\nPr [⟨v,c⟩≥ t] = Pr\n[\n∥v|˜c1\n∥˜c∥≥t\n]\n≤Pr\n[∥v∥˜c1\n∥˜c∥ ≥t|r≥1\n2\n]\nPr\n[\nr≥1\n2\n]\n+ Pr\n[∥v∥˜c1\n∥˜c∥ ≥t|r≥1\n2\n]\nPr\n[\nr≥1\n2\n]\nit’s suﬃcient to lower bound Pr [r≤100] and Pr\n[\n∥v∥˜c1\n∥c∥≥t|r≤100\n]\n. The former probability is easily\nseen to be lower bounded by a constant by a Chernoﬀ bound. Consider the latter one next. It holds that\nPr\n[\n∥v∥˜c1\n∥˜c∥≥t|r≤100\n]\n= Pr\n[\n˜c1 ≥\n√\nt2 ·r\n∥v∥2 −t2 |r≤100\n]\n≥Pr\n[\n˜c1 ≥\n√\n100t2\n∥v∥2 −t2\n]\nDenoting ˜t=\n√\n100t2\n∥v∥2−t2 , by a well-known Gaussian tail bound it follows that\nPr\n[\n˜c1 ≥˜t\n]\n= e−O(d˜t2)\n(\n1√\nd˜t\n−\n( 1√\nd˜t\n)3)\n= e−O(t2)\nwhere the last equality holds since ∥v∥= Ω(\n√\nd) and t= ω(1).\nLemma A.2. If c∼Cd, v∈Rd is a vector with ∥v∥= Θ(\n√\nd) and t= ω(1), the random variable z= ⟨v,c⟩\nsatisﬁes\nE\n[\nexp(z)1[t,+∞](z)\n]\n= exp(−Ω(t2)) + exp(−Ω(d))\nProof. Similarly as in Lemma A.1, if c= (c1,c2,...,c d) ∼Cd, cis in distribution equal to\n(\n˜c1\n∥˜c∥, ˜c2\n∥˜c∥,..., ˜cd\n∥˜c∥\n)\nwhere the ˜ci are i.i.d. samples from a univariate Gaussian with mean 0 and variance 1\nd. Again, by spherical\nsymmetry, we may assume v = (∥v∥,0,..., 0). Let’s introduce the random variable r = ∑d\ni=2 ˜c2\ni. Then, for\nan arbitrary u> 1, some algebraic manipulation shows\nPr\n[\nexp (⟨v,c⟩) 1[t,+∞](⟨v,c⟩) ≥u\n]\n= Pr [exp (⟨v,c⟩) ≥u∧⟨v,c⟩≥ t] =\nPr\n[\nexp\n(\n∥v∥˜c1\n∥˜c∥\n)\n≥u∧∥v∥˜c1\n∥˜c∥≥u\n]\n= Pr\n[\n˜c1 = max\n(√\n˜u2r\n∥v∥2 −˜u2 ,\n√\nt2r\n∥v∥2 −t2\n)]\n(A.17)\nwhere we denote ˜u= log u. Since ˜c1 is a mean 0 univariate Gaussian with variance 1\nd, and ∥v∥= Ω(\n√\nd) we\nhave ∀x∈R\nPr\n[\n˜c1 ≥\n√\nx2r\n∥v∥2 −u2\n]\n= O\n(\ne−Ω(x2r)\n)\nNext, we show that r is lower bounded by a constant with probability 1 −exp(−Ω(d)). Indeed, r is in\ndistribution equal to 1\ndχ2\nd−1, where χ2\nk is a Chi-squared distribution with k degrees of freedom. Standard\nconcentration bounds (?) imply that ∀ξ≥0,Pr[r−1 ≤−2\n√\nξ\nd] ≤exp(−ξ). Taking ξ= αdfor αa constant\nimplies that with probability 1 −exp(−Ω(d)), r≥M for some constant M. We can now rewrite\nPr\n[\n˜c1 ≥\n√\nx2r\n∥v∥2 −x2\n]\n=\n23\nPr\n[\n˜c1 ≥\n√\nx2r\n∥v∥2 −x2 |r≥M\n]\nPr[r≥M] + Pr\n[\n˜c1 ≥\n√\nx2r\n∥v∥2 −x2 |r≤M\n]\nPr[r≤M]\nThe ﬁrst term is clearly bounded by e−Ω(x2) and the second by exp( −Ω(d)). Therefore,\nPr\n[\n˜c1 ≥\n√\nx2r\n∥v∥2 −x2\n]\n= O\n(\nmax\n(\nexp\n(\n−Ω\n(\nx2))\n,exp (−Ω (d))\n))\n(A.18)\nPutting A.17 and A.18 together, we get that\nPr\n[\nexp (⟨v,c⟩) 1[t,+∞](⟨v,c⟩) ≥u\n]\n= O\n(\nmax\n(\nexp\n(\n−Ω\n(\nmin\n(\nd,(max (˜u,t))2\n)))))\n(A.19)\n(where again, we denote ˜u= log u)\nFor any random variable X which has non-negative support, it’s easy to check that\nE[X] =\n∫ ∞\n0\nPr[X ≥x]dx\nHence,\nE\n[\nexp(z)1[t,+∞](z)\n]\n=\n∫ ∞\n0\nPr\n[\nexp(z)1[t,+∞](z) ≥u\n]\ndu=\n∫ exp(∥v∥)\n0\nPr\n[\nexp(z)1[t,+∞](z) ≥u\n]\ndu\nTo bound this integral, we split into the following two cases:\n• Case t2 ≥d: max (˜u,t) ≥t, so min\n(\nd,(max (˜u,t))2\n)\n= d. Hence, A.19 implies\nE\n[\nexp(z)1[t,+∞](z)\n]\n= exp(∥v∥) exp(−Ω(d)) = exp(−Ω(d))\nwhere the last inequality follows since ∥v∥= O(\n√\nd).\n• Case t2 < d: In the second case, we will split the integral into two portions: u ∈[0,exp(t)] and\nu∈[exp(t),exp(∥v∥)].\nWhen u∈[0,exp(t)], max (˜u,t) = t, so min(d,(max (˜u,t))2) = t2. Hence,\n∫ exp(t)\n0\nPr\n[\nexp(z)1[t,+∞](z) ≥u\n]\ndu≤exp(t) exp(−Ω(t2)) = −exp(Ω(t2))\nWhen u∈[exp(t),exp(∥v∥)], max (˜u,t) = ˜u. But ˜u≤log(exp(∥v∥)) = O(\n√\nd), so min(d,(max (˜u,t))2) =\n˜u. Hence, ∫ exp(∥v∥)\nexp(t)\nPr\n[\nexp(z)1[t,+∞](z) ≥u\n]\ndu≤\n∫ exp(∥v∥)\nexp(t)\nexp(−(log(u))2)du\nMaking the change of variable ˜u= log(u), the we can rewrite the last integral as\n∫ ∥v∥\nt\nexp(−˜u2) exp(˜u)d˜u= O(exp(−t2))\nwhere the last inequality is the usual Gaussian tail bound.\nIn either case, we get that\n∫ exp(∥v∥)\n0\nPr\n[\nexp(z)1[t,+∞](z) ≥u\n]\ndu= exp(−Ω(t2)) + exp(−Ω(d)))\nwhich is what we want.\n24\nAs a corollary to the above lemma, we get the following:\nCorollary A.3. If c∼Cd, v∈Rd is a vector with ∥v∥= Θ(\n√\nd) and t= Ω(log.9 n) then\nE\n[\nexp(z)1[t,+∞](z)\n]\n= exp(−Ω(log1.8 n))\nProof. We claim the proof is trivial if d = o(log4 n). Indeed, in this case, exp( ⟨v,c⟩) ≤ exp(∥v∥) =\nexp(O(\n√\nd)). Hence,\nE\n[\nexp(z)1[t,+∞](z)\n]\n= exp(O(\n√\nd)) E[1[t,+∞](z)] = exp(O(\n√\nd)) Pr[z≥t]\nSince by Lemma A.1, Pr[ z≥t] ≤exp(−Ω(log2 n), we get\nE\n[\nexp(z)1[t,+∞](z)\n]\n= exp(O(\n√\nd) −Ω(log2 n)) = exp(−Ω(log1.8 n))\nas we wanted.\nSo, we may, without loss of generality assume that d= Ω(log4 n). In this case, Lemma A.2 implies\nE\n[\nexp(z)1[t,+∞](z)\n]\n= exp(−log1.8 n) + exp(−Ω(d))) = exp(−log1.8 n)\nwhere the last inequality holds because d= Ω(log4 n) and t2 = Ω(log.9 n), so we get the claim we wanted.\nLemma A.4(Continuous Abel’s Inequality). Let 0 ≤r(x) ≤1 be a function such that such that E[r(x)] = ρ.\nMoreover, suppose increasing function u(x) satisﬁes that E[|u(x)|] <∞. Let t be the real number such that\nE[1[t,+∞]] = ρ. Then we have\nE[u(x)r(x)] ≤E[u(x)1[t,+∞]] (A.20)\nProof. Let G(z) =\n∫∞\nz f(x)r(x)dx, and H(z) =\n∫∞\nz f(x)1[t,+∞](x)dx. Then we have that G(z) ≤H(z) for\nall z. Indeed, for z ≥t, this is trivial since r(z) ≤1. For z ≤t, we have H(z) = E[1[t,+∞]] = ρ= E[r(x)] ≥∫∞\nz f(x)r(x)dx. Then by integration by parts we have,\n∫ ∞\n−∞\nu(x)f(x)r(x)dx= −\n∫ ∞\n−∞\nu(x)dG\n= −u(x)G(x) |∞\n−∞+\n∫ +∞\n−∞\nG(x)u′(x)dx\n≤\n∫ +∞\n−∞\nH(x)u′(x)dx\n=\n∫ ∞\n−∞\nu(x)f(x)1[t,+∞](x)dx,\nwhere at the third line we use the fact that u(x)G(x) →0 as x→∞ and that u′(x) ≥0, and at the last line\nwe integrate by parts again.\nLemma A.5. Let v∈Rd be a ﬁxed vector with norm ∥v∥≤ κ\n√\nd for absolute constant κ. Then for random\nvariable c with uniform distribution over the sphere, we have that\nlog E[exp(⟨v,d⟩)] = ∥v∥2/2d±ϵ (A.21)\nwhere ϵ= ˜O(1\nd).\n25\nProof. Let g ∈N (0,I), then g/∥g∥has the same distribution as c. Let r = ∥v∥. Since c is spherically\nsymmetric, we could, we can assume without loss of generality that v = ( r,0,..., 0). Let x = g1 and\ny=\n√\ng2\n2 + ··· + g2\nd. Therefore x∈N(0,1) and y2 has χ2 distribution with mean d−1 and variance O(d).\nLet Fbe the event thatx≤20 logdand 1.5\n√\nd≥y≥0.5\n√\nd. Note that the Pr[F] ≥1−exp(−Ω(log1.8(d)).\nBy Proposition 2, we have that E[exp(⟨v,c⟩)] = E[exp(⟨v,c⟩) |F] ·(1 ±Ω(−log1.8 d)).\nConditioned on event F, we have\nE[exp(⟨v,c⟩) |F] = E\n[\nexp( rx√\nx2 + y2 ) |F\n]\n= E\n[\nexp(rx\ny − rx3\ny\n√\nx2 + y2(y+\n√\nx2 + y2)\n) |F\n]\n= E\n[\nexp(rx\ny ) ·exp( rx3\ny\n√\nx2 + y2(y+\n√\nx2 + y2)\n) |F\n]\n= E\n[\nexp(rx\ny ) |F\n]\n·(1 ±O(log3 d\nd )) (A.22)\nwhere we used the fact that r≤κ\n√\nd. Let Ebe the event that 1 .5\n√\nd≥y≥0.5\n√\nd. By using Proposition 1,\nwe have that\nE[exp(rx/y) |F] = E[exp(rx/y) |E] ±exp(−Ω(log2(d)) (A.23)\nThen let z= y2/(d−1) and w= z−1. Therefore z has χ2 distribution with mean 1 and variance 1/(d−1),\nand w has mean 0 and variance 1 /(d−1).\nE\n[\nexp(rx\ny ) |E\n]\n= E[E[exp(rx/y) |y] |E] = E[exp(r2/y2) |E]\n= E[exp(r2/(d−1) ·1/z2) |E]\n= E[exp(r2/(d−1) ·(1 + 2w+ w2\n(1 + w)2 )) |E]\n= exp(r2/(d−1)) E[exp(1 + 2w+ w2\n(1 + w)2 )) |E]\n= exp(r2/(d−1)) E[1 + 2w±O(w2) |E]\n= exp(r2/(d−1)2)(1 ±1/d)\nwhere the second-to-last line uses the fact that conditioned on 1/2 ≥E, w≥−1/2 and therefore the Taylor\nexpansion approximates the exponential accurately, and the last line uses the fact that |E[w|E]|= O(1/d)\nand E[w2 |E] ≤O(1/d). Combining the series of approximations above completes the proof.\nWe ﬁnally provide the proofs for a few helper propositions on conditional probabilities for high probability\nevents used in the lemma above.\nProposition 1.Suppose x∼N(0,σ2) with σ= O(1). Then for any event Ewith Pr[E] = 1−O(−Ω(log2 d)),\nwe have that E[exp(x)] = E[exp(x) |E] ±exp(−Ω(log2(d)).\nProof. Let’s denote by ¯E the complement of the event E. We will consider the upper and lower bound\nseparately. Since\nE[exp(x)] = E[exp(x) |E] Pr[E] + E[exp(x) |¯E] Pr[¯E]\nwe have that\nE[exp(x)] ≤E[exp(x) |E] + E[exp(x) |¯E] Pr[¯E] (A.24)\n26\nand\nE[exp(x)] ≥E[exp(x) |E](1 −exp(−Ω(log2 d))) ≥E[exp(x) |E] −E[exp(x) |E] exp(−Ω(log2 d))) (A.25)\nConsider the upper bound (A.24) ﬁrst. To show the statement of the lemma, it suﬃces to bound\nE[exp(x) |¯E] Pr[¯E].\nWorking towards that, notice that\nE[exp(x) |¯E] Pr[¯E] = E[exp(x)1¯E] = E[exp(x) E[1¯E|x]] = E[exp(x)r(x)]\nif we denote r(x) = E[1¯E|x]. We wish to upper bound E[exp(x)r(x)]. By Lemma A.4, we have\nE[exp(x)r(x)] ≤E[exp(x)1[t,∞]]\nwhere t is such that E[1[t,∞]] = E[r(x)]. However, since E[r(x)] = Pr[ ¯E] = exp(−Ω(log2 d)), it must be the\ncase that t = Ω(log d) by the standard Gaussian tail bound, and the assumption that σ = O(1). In turn,\nthis means\nE[exp(x)1[t,∞]] ≤ 1\nσ\n√\n2π\n∫ ∞\nt\nexe−x2\nσ2 dx= 1\nσ\n√\n2π\n∫ ∞\nt\ne−( x\nσ−σ\n2 )2+ σ2\n4 dx= e\nσ2\n4\n1√\n2π\n∫ +∞\nt/σ\ne−(x′−σ\n2 )2\ndx′\nwhere the last equality follows from the change of variables x= σx′. However,\n1√\n2π\n∫ +∞\nt/σ\ne−(x′−σ\n2 )2\ndx′\nis nothing more than Pr[x′> t\nσ], where x′is distributed like a univariate gaussian with mean σ\n2 and variance\n1. Bearing in mind that σ= O(1)\ne\nσ2\n4\n1√\n2π\n∫ +∞\nt/σ\ne−(x′−σ\n2 )2\ndx′= exp(−Ω(t2)) = exp(−Ω(log2 d))\nby the usual Gaussian tail bounds, which proves the lower bound we need.\nWe proceed to consider the lower bound A.25. To show the statement of the lemma, we will bound\nE[exp(x) |E]. Notice trivially that since exp( x) ≥0,\nE[exp(x) |E] ≤E[exp(x)]\nPr[E]\nSince Pr[E] ≥1 −exp(Ω(log2 d)), 1\nPr[E] ≤1 + exp(O(log2)). So, it suﬃces to bound E[exp(x)]. However,\nE[exp(x)] = 1\nσ\n√\n2π\n∫ +∞\nt=−∞\nexe−x2\nσ2 dx= 1\nσ\n√\n2π\n∫ +∞\nt=−∞\ne−( x\nσ−σ\n2 )2+ σ2\n4 dx= 1√\n2π\n∫ +∞\nt=−∞\ne−(x′−σ\n2 )2+ σ2\n4 dx′\nwhere the last equality follows from the same change of variablesx= σx′as before. Since\n∫+∞\nt=−∞e−(x′−σ\n2 )2\ndx′=√\n2π, we get\n1√\n2π\n∫ +∞\nt=−∞\ne−(x′−σ\n2 )2+ σ2\n4 dx′= e\nσ2\n4 = O(1)\nPutting together with the estimate of 1\nPr[E] , we get that E[exp(x) |E] = O(1). Plugging this back in A.25,\nwe get the desired upper bound.\nProposition 2. Suppose c∼C and v is an arbitrary vector with ∥v∥= O(\n√\nd). Then for any event Ewith\nPr[E] ≥1 −exp(−Ω(log2 d)), we have that E[exp(⟨v,c⟩)] = E[exp(⟨v,c⟩) |E] ±exp(−log1.8 d).\n27\nProof of Proposition 2. Let z= ⟨v,c⟩. We proceed similarly as in the proof of Proposition 1. We have\nE[exp(z)] = E[exp(z) |E] Pr[E] + E[exp(z) |¯E] Pr[¯E]\nand\nE[exp(z)] ≤E[exp(z) |E] + E[exp(z) |¯E] Pr[¯E] (A.26)\nand\nE[exp(z)] ≥E[exp(z) |E] Pr[E] = E[exp(z) |E] −E[exp(z) |E] exp(−Ω(log2 d)) (A.27)\nWe again proceed by separating the upper and lower bound.\nWe ﬁrst consider the upper bound A.26.\nNotice that that\nE[exp(z) |¯E] Pr[¯E] = E[exp(z)1¯E]\nWe can split the last expression as\nE\n[\nexp(⟨vw,c⟩)1⟨vw,c⟩>01E\n]\n+ E\n[\nexp(⟨vw,c⟩)1⟨vw,c⟩<01E\n]\n.\nThe second term is upper bounded by\nE[1E] ≤exp(−Ω(log2 n))\nWe proceed to the ﬁrst term of (A.10) and observe the following property of it:\nE\n[\nexp(⟨vw,c⟩)1⟨vw,c⟩>01E\n]\n≤E\n[\nexp(⟨αvw,c⟩)1⟨vw,c⟩>0 1E\n]\n≤E[exp(⟨αvw,c⟩)1E]\nwhere α> 1. Therefore, it’s suﬃcient to bound\nE[exp(z)1E]\nwhen ∥vw∥= Θ(\n√\nd). Let’s denote r(z) = E[1¯E|z].\nUsing Lemma A.4, we have that\nE\nc\n[exp(z)r(z)] ≤E\n[\nexp(z)1[t,+∞](z)\n]\n(A.28)\nwhere t satisﬁes that Ec[1[t,+∞]] = Pr[ z ≥t] = Ec[r(z)] ≤exp(−Ω(log2 d)). Then, we claim Pr[ z ≥t] ≤\nexp(−Ω(log2 d)) implies that t≥Ω(log.9 d).\nIndeed, this follows by directly applying Lemma A.1. Afterward, applying Lemma A.2, we have:\nE[exp(z)r(z)] ≤E\n[\nexp(z)1[t,+∞](z)\n]\n= exp(−Ω(log1.8 d)) (A.29)\nwhich proves the upper bound we want.\nWe now proceed to the lower bound A.27, which is again similar to the lower bound in the proof of\nProposition 1: we just need to bound E[exp(z) |E]. Same as in Proposition 1, since exp( x) ≥0,\nE[exp(z) |E] ≤E[exp(z)]\nPr[E]\nConsider the event E′: z≤t, for t= Θ(log.9 d), which by Lemma A.1 satisﬁes Pr[E′] ≥1 −exp(−Ω(log2 d)).\nBy the upper bound we just showed,\nE[exp(z)] ≤E[exp(z) |E′] + exp(−Ω(log2 n)) = O(exp(log.9 d))\nwhere the last equality follows since conditioned on E′, z= O(log.9 d). Finally, this implies\nE[exp(z) |E] ≤ 1\nPr[E]O(exp(log.9 d)) = O(exp(log.9 d))\nwhere the last equality follows since Pr[ E] ≥1 −exp(−Ω(log2 n)). Putting this together with A.27, we get\nE[exp(z)] ≥E[exp(z) |E] Pr[E] = E[exp(z) |E] −E[exp(z) |E] exp(−Ω(log2 d)) ≥\nE[exp(z) |E] −O(exp(log.9 d)) exp(−Ω(log2 d)) ≥E[exp(z) |E] −exp(−Ω(log2 d))\nwhich is what we needed.\n28\nA.1 Analyzing partition function Zc\nIn this section, we prove Lemma 2.1. We basically ﬁrst prove that for the means of Zc are all (1 +o(1))-close\nto each other, and then prove that Zc is concentrated around its mean. It turns out the concentration part\nis non trivial because the random variable of concern, exp( ⟨vw,c⟩) is not well-behaved in terms of the tail.\nNote that exp( ⟨vw,c⟩) is NOT sub-gaussian for any variance proxy. This essentially disallows us to use an\nexisting concentration inequality directly. We get around this issue by considering the truncated version of\nexp(⟨vw,c⟩), which is bounded, and have similar tail properties as the original one, in the regime that we\nare concerning.\nWe bound the mean and variance of Zc ﬁrst in the Lemma below.\nLemma A.6. For any ﬁxed unit vector c∈Rd, we have that E[Zc] ≥n and V[Zc] ≤O(n).\nProof of Lemma A.6. Recall that by deﬁnition\nZc =\n∑\nw\nexp(⟨vw,c⟩).\nWe ﬁx context c and view vw’s as random variables throughout this proof. Recall that vw is composed of\nvw = sw ·ˆvw, where sw is the scaling and ˆvw is from spherical Gaussian with identity covariance Id×d. Let\ns be a random variable that has the same distribution as sw.\nWe lowerbound the mean of Zc as follows:\nE[Zc] = nE[exp(⟨vw,c⟩)] ≥nE[1 + ⟨vw,c⟩] = n\nwhere the last equality holds because of the symmetry of the spherical Gaussian distibution. On the other\nhand, to upperbound the mean of Zc, we condition on the scaling sw,\nE[Zc] = nE[exp(⟨vw,c⟩)]\n= nE[E[exp(⟨vw,c⟩) |sw]]\nNote that conditioned on sw, we have that ⟨vw,c⟩is a Gaussian random variable with variance σ2 = s2\nw.\nTherefore,\nE[exp(⟨vw,c⟩) |sw] =\n∫\nx\n1\nσ\n√\n2πexp(−x2\n2σ2 ) exp(x)dx\n=\n∫\nx\n1\nσ\n√\n2πexp(−(x−σ2)2\n2σ2 + σ2/2)dx\n= exp(σ2/2)\nIt follows that\nE[Zc] = nE[exp(σ2/2)] = nE[exp(s2\nw/2)] = nE[exp(s2/2)].\nWe calculate the variance of Zc as follows:\nV[Zc] =\n∑\nw\nV[exp(⟨vw,c⟩)] ≤nE[exp(2⟨vw,c⟩)]\n= nE[E[exp(2⟨vw,c⟩) |sw]]\nBy a very similar calculation as above, using the fact that 2 ⟨vw,c⟩is a Gaussian random variable with\nvariance 4σ2 = 4s2\nw,\nE[exp(2⟨vw,c⟩) |sw] = exp(2σ2)\n29\nTherefore, we have that\nV[Zc] ≤nE[E[exp(2⟨vw,c⟩) |sw]]\n= nE\n[\nexp(2σ2)\n]\n= nE\n[\nexp(2s2)\n]\n≤Λn\nfor Λ = exp(8κ2) a constant, and at the last step we used the facts that s≤κ a.s.\nNow we are ready to prove Lemma 2.1.\nProof of Lemma 2.1. We ﬁx the choice of c, and the proving the concentration using the randomness of vw’s\nﬁrst. Note that that exp( ⟨vw,c⟩) is neither sub-Gaussian nor sub-exponential (actually the Orlicz norm of\nrandom variable exp( ⟨vw,c⟩) is never bounded). This prevents us from applying the usual concentration\ninequalities. The proof deals with this issue in a slightly more specialized manner.\nLet’s deﬁne Fw be the event that |⟨vw,c⟩|≤ 1\n2 log n. We claim that Pr[Fw] ≥1−exp(−Ω(log2 n)). Indeed\nnote that ⟨vw,c⟩| sw has a Gaussian distribution with standard deviation sw∥c∥= sw ≤2κ a.s. Therefore\nby the Gaussianity of ⟨vw,c⟩we have that\nPr[|⟨vw,c⟩|≥ ηlog n|sw] ≤2 exp(−Ω(1\n4 log2 n/κ2)) = exp(−Ω(log2 n)),\nwhere Ω(·) hides the dependency on κ which is treated as absolute constants. Taking expectations over sw,\nwe obtain that\nPr[Fw] = Pr[|⟨vw,c⟩|≤ 1\n2 log n] ≥1 −exp(−Ω(log2 n)).\nNote that by deﬁnition, we in particular have that conditioned on Fw, it holds that exp( ⟨vw,c⟩) ≤√n.\nLet the random variable Xw have the same distribution as exp( ⟨vw,c⟩)|Fw. We prove that the random\nvariable Z′\nc = ∑\nwXw concentrates well. By convexity of the exponential function, we have that the mean\nof Z′\nc is lowerbounded\nE[Z′\nc] = nE[exp(⟨vw,c⟩)|Fw] ≥nexp(E[⟨vw,c⟩|Fw]) = n\nand the variance is upperbounded by\nV[Z′\nc] ≤nE\n[\nexp(⟨vw,c⟩)2|Fw\n]\n≤ 1\nPr[Fw] E\n[\nexp(⟨vw,c⟩)2]\n≤ 1\nPr[Fw]Λn≤1.1Λn\nwhere the second line uses the fact that\nE\n[\nexp(⟨vw,c⟩)2]\n= Pr[Fw] E\n[\nexp(⟨vw,c⟩)2|Fw\n]\n+ Pr[Fw] E\n[\nexp(⟨vw,c⟩)2|Fw\n]\n≥Pr[Fw] E\n[\nexp(⟨vw,c⟩)2|Fw\n]\n.\nMoreover, by deﬁnition, for any w, |Xw|≤ √n. Therefore by Bernstein’s inequality, we have that\nPr [|Z′\nc −E[Z′\nc]|>ϵn] ≤exp(−\n1\n2 ϵ2n2\n1.1Λn+ 1\n3\n√n·ϵn)\n30\nNote that E[Z′\nc] ≥n, therefore for ϵ≫log2 n√n , we have,\nPr [|Z′\nc −E[Z′\nc]|>ϵ E[Z′\nc]] ≤Pr [|Z′\nc −E[Z′\nc]|>ϵn] ≤exp(−\n1\n2 ϵ2n2\nΛn+ 1\n3\n√n·ϵn)\n≤exp(−Ω(min{ϵ2n/Λ,ϵ√n}))\n≤exp(−Ω(log2 n))\nLet F = ∪wFw be the union of all Fw. Then by union bound, it holds that Pr[ ¯F] ≤∑\nwPr[ ¯Fw] ≤\nn·exp(−Ω(log2 n)) = exp(−Ω(log2 n)). We have that by deﬁnition, Z′\nc has the same distribution as Zc|F.\nTherefore, we have that\nPr[|Zc −E[Z′\nc]|>ϵ E[Z′\nc] |F] ≤exp(−Ω(log2 n)) (A.30)\nand therefore\nPr[|Zc −E[Z′\nc]|>ϵ E[Z′\nc]] = Pr[F] ·Pr[|Zc −E[Z′\nc]|>ϵ E[Z′\nc] |F] + Pr[ ¯F] Pr[|Zc −E[Z′\nc]|>ϵ E[Z′\nc] | ¯F]\n≤Pr[|Zc −E[Z′\nc]|>ϵ E[Z′\nc] |F] + Pr[ ¯F]\n≤exp(−Ω(log2 n)) (A.31)\nwhere at the last line we used the fact that Pr[ ¯F] ≤exp(−Ω(log2 n)) and equation (A.30).\nLet Z = E[Z′\nc] = E[exp(⟨vw,c⟩) ||⟨ vw,c⟩| < 1\n2 log n] (note that E[Z′\nc] only depends on the norm of ∥c∥\nwhich is equal to 1). Therefore we obtain that with high probability over the randomness of vw’s,\n(1 −ϵz)Z ≤Zc ≤(1 + ϵz)Z (A.32)\nTaking expectation over the randomness of c, we have that\nPr\nc,vw\n[ (A.32) holds] ≥1 −exp(−Ω(log2 n))\nTherefore by a standard averaging argument (using Markov inequality), we have\nPr\nvw\n[\nPr\nc\n[ (A.32) holds] ≥1 −exp(−Ω(log2 n))\n]\n≥1 −exp(−Ω(log2 n))\nFor now on we ﬁx a choice of vw’s so that Prc[ (A.32) holds] ≥1 −exp(−Ω(log2 n)) is true. Therefore in the\nrest of the proof, only c is random variable, and with probability 1 −exp(−Ω(log2 n)) over the randomness\nof c, it holds that,\n(1 −ϵz)Z ≤Zc ≤(1 + ϵz)Z. (A.33)\nB Maximum likelihood estimator for co-occurrence\nLet L be the corpus size, and Xw,w′ the number of times words w,w′ co-occur within a context of size 10\nin the corpus. According to the model, the probability of this event at any particular time is log p(w,w′) ∝\n∥vw + vw′ ∥2\n2 .Successive samples from a random walk are not independent of course, but if the random walk\nmixes fairly quickly (and the mixing time of our random walk is related to the logarithm of the number\nof words) then the set of Xw,w′ ’s over all word pairs is distributed up to a very close approximation as a\nmultinomial distribution Mul(˜L,{p(w,w′)}) where ˜L = ∑\nw,w′ Xw,w′ is the total number of word pairs in\nconsideration (roughly 10L).\n31\nAssuming this approximation, we show below that the maximum likelihood values for the word vectors\ncorrespond to the following optimization,\nmin\n{vw},C\n∑\nw,w′\nXw,w′\n(\nlog(Xw,w′ ) −∥vw+vw′ ∥2\n2 −C\n)2\n(Objective SN)\nNow we give the derivation of the objective. According to the multinomial distribution, maximizing the\nlikelihood of {Xw,w′ }is equivalent to maximizing\nℓ= log\n\n ∏\n(w,w′)\np(w,w′)Xw,w′\n\n=\n∑\n(w,w′)\nXw,w′ log p(w,w′).\nTo reason about the likelihood, denote the logarithm of the ratio between the expected count and the\nempirical count as\n∆w,w′ = log\n(˜Lp(w,w′)\nXw,w′\n)\n.\nNote that\nℓ=\n∑\n(w,w′)\nXw,w′ log p(w,w′)\n=\n∑\n(w,w′)\nXw,w′\n[\nlog Xw,w′\n˜L\n+ log\n(˜Lp(w,w′)\nXw,w′\n)]\n=\n∑\n(w,w′)\nXw,w′ log Xw,w′\n˜L\n+\n∑\n(w,w′)\nXw,w′ log\n(˜Lp(w,w′)\nXw,w′\n)\n= c+\n∑\n(w,w′)\nXw,w′ ∆w,w′ (B.1)\nwhere we let c denote the constant ∑\n(w,w′) Xw,w′ log\nXw,w′\n˜L . Furthermore, we have\n˜L=\n∑\n(w,w′)\n˜Lpw,w′\n=\n∑\n(w,w′)\nXw,w′ e∆w,w′\n=\n∑\n(w,w′)\nXw,w′ (1 + ∆w,w′ + ∆2\nw,w′ /2 + O(|∆w,w′ |3))\nand also ˜L= ∑\n(w,w′) Xw,w′ . So\n∑\n(w,w′)\nXw,w′ ∆w,w′ = −\n\n ∑\n(w,w′)\nXw,w′ ∆2\nw,w′ /2 +\n∑\n(w,w′)\nXw,w′ O(|∆w,w′ |3)\n\n.\nPlugging this into (3.2) leads to\nc−ℓ=\n∑\n(w,w′)\nXw,w′ ∆2\nw,w′ /2 +\n∑\n(w,w′)\nXw,w′ O(|∆w,w′ |3). (B.2)\n32\nWhen the last term is much smaller than the ﬁrst term on the right hand side, maximizing the likelihood\nis approximately equivalent to minimizing the ﬁrst term on the right hand side, which is our objective:\n∑\n(w,w′)\nXw,w′ ∆2\nw,w′ ≈\n∑\n(w,w′)\nXw,w′\n(\n∥vw + vw′ ∥2\n2/(2d) −log Xw,w′ + log ˜L−2 logZ\n)2\nwhere Z is the partition function.\nWe now argue that the last term is much smaller than the ﬁrst term on the right hand side in (B.2). For\na large Xw,w′ , the ∆w,w′ is close to 0 and thus the induced approximation error is small. Small Xw,w′ ’s only\ncontribute a small fraction of the ﬁnal objective (3.3), so we can safely ignore the errors. To see this, note\nthat the objective ∑\n(w,w′) Xw,w′ ∆2\nw,w′ and the error term ∑\n(w,w′) Xw,w′ O(|∆w,w′ |3) diﬀer by a factor of\n|∆w,w′ |for each Xw,w′ . For large Xw,w′ ’s, |∆w,w′ |≪ 1, and thus their corresponding errors are much smaller\nthan the objective. So we only need to consider the Xw,w′ ’s that are small constants. The co-occurrence\ncounts obey a power law distribution (see, e.g. (Pennington et al., 2014)). That is, if one sorts {Xw,w′ }in\ndecreasing order, then the r-th value in the list is roughly\nx[r] = k\nr5/4\nwhere k is some constant. Some calculation shows that\n˜L≈4k,\n∑\nXw,w′ ≤x\nXw,w′ ≈4k4/5x1/5,\nand thus when x is a small constant\n∑\nXw,w′ ≤xXw,w′\n˜L\n≈\n(4x\n˜L\n)1/5\n= O\n( 1\n˜L1/5\n)\n.\nSo there are only a negligible mass of Xw,w′ ’s that are small constants, which vanishes when ˜L increases.\nFurthermore, we empirically observe that the relative error of our objective is 5%, which means that the\nerrors induced by Xw,w′ ’s that are small constants is only a small fraction of the objective. Therefore,∑\nw,w′ Xw,w′ O(|∆w,w′ |3) is small compared to the objective and can be safely ignored.\n33"
}