{
    "title": "Advanced modeling of solid state transformer",
    "url": "https://openalex.org/W4385362723",
    "year": 2018,
    "authors": [
        {
            "id": "https://openalex.org/A5092564387",
            "name": "Mohammad Ebrahim Adabi Firouzjaee",
            "affiliations": [
                null
            ]
        }
    ],
    "references": [
        "https://openalex.org/W2127499524",
        "https://openalex.org/W6644771974",
        "https://openalex.org/W6684918929",
        "https://openalex.org/W2068334467",
        "https://openalex.org/W2000794749",
        "https://openalex.org/W1999302015",
        "https://openalex.org/W2001231229",
        "https://openalex.org/W2101976318",
        "https://openalex.org/W2524328699",
        "https://openalex.org/W2057175642",
        "https://openalex.org/W2060472803",
        "https://openalex.org/W2153950497",
        "https://openalex.org/W2139772385",
        "https://openalex.org/W2030973541",
        "https://openalex.org/W2000613084",
        "https://openalex.org/W2096150075",
        "https://openalex.org/W1617685966",
        "https://openalex.org/W6676094333",
        "https://openalex.org/W2176835823",
        "https://openalex.org/W2173928183",
        "https://openalex.org/W2071851764",
        "https://openalex.org/W2164703709",
        "https://openalex.org/W6609741587",
        "https://openalex.org/W2010216058",
        "https://openalex.org/W1569829504",
        "https://openalex.org/W2139885352",
        "https://openalex.org/W2513364474",
        "https://openalex.org/W1993830253",
        "https://openalex.org/W2039945465",
        "https://openalex.org/W2320858657",
        "https://openalex.org/W2008258562",
        "https://openalex.org/W2316904322",
        "https://openalex.org/W2024143286",
        "https://openalex.org/W2170998309",
        "https://openalex.org/W2035415124",
        "https://openalex.org/W2095712469",
        "https://openalex.org/W2165542296",
        "https://openalex.org/W2038916322",
        "https://openalex.org/W2154551857",
        "https://openalex.org/W2600865027",
        "https://openalex.org/W1970489421",
        "https://openalex.org/W2020770246",
        "https://openalex.org/W50412567",
        "https://openalex.org/W2403200567",
        "https://openalex.org/W2548244418",
        "https://openalex.org/W2067416457",
        "https://openalex.org/W2135511585",
        "https://openalex.org/W2331579335",
        "https://openalex.org/W2162828521",
        "https://openalex.org/W2131434453",
        "https://openalex.org/W2097544419",
        "https://openalex.org/W2136782464",
        "https://openalex.org/W2147333548",
        "https://openalex.org/W1975502997",
        "https://openalex.org/W2135902097",
        "https://openalex.org/W2124049499",
        "https://openalex.org/W276851436",
        "https://openalex.org/W1978312324",
        "https://openalex.org/W2131133185",
        "https://openalex.org/W2278158307",
        "https://openalex.org/W2113748537",
        "https://openalex.org/W2050014184",
        "https://openalex.org/W2109084495",
        "https://openalex.org/W2055301271",
        "https://openalex.org/W2106278471",
        "https://openalex.org/W2143182093",
        "https://openalex.org/W1570765840",
        "https://openalex.org/W1974730395",
        "https://openalex.org/W1982493364",
        "https://openalex.org/W125206866",
        "https://openalex.org/W72680921",
        "https://openalex.org/W2131891757",
        "https://openalex.org/W1967053392",
        "https://openalex.org/W2317838635",
        "https://openalex.org/W2163501722",
        "https://openalex.org/W1981829062",
        "https://openalex.org/W2330294603",
        "https://openalex.org/W1997718884",
        "https://openalex.org/W1488095954",
        "https://openalex.org/W2099524704",
        "https://openalex.org/W2570851764",
        "https://openalex.org/W2429366981",
        "https://openalex.org/W2524275263",
        "https://openalex.org/W2104240775",
        "https://openalex.org/W1970706794",
        "https://openalex.org/W2576720126",
        "https://openalex.org/W2146992283",
        "https://openalex.org/W2126455698",
        "https://openalex.org/W1789796494",
        "https://openalex.org/W2145222975",
        "https://openalex.org/W2075174772",
        "https://openalex.org/W2059136450",
        "https://openalex.org/W3150853312",
        "https://openalex.org/W1976871987",
        "https://openalex.org/W2002995627",
        "https://openalex.org/W6684073231",
        "https://openalex.org/W2090843387",
        "https://openalex.org/W1991562391",
        "https://openalex.org/W2042924667",
        "https://openalex.org/W2028741539",
        "https://openalex.org/W1884783084",
        "https://openalex.org/W1558937624",
        "https://openalex.org/W2162070102",
        "https://openalex.org/W1965884662",
        "https://openalex.org/W1979836772",
        "https://openalex.org/W1964394431",
        "https://openalex.org/W2083769882",
        "https://openalex.org/W2012191632",
        "https://openalex.org/W2334652519",
        "https://openalex.org/W1591178672",
        "https://openalex.org/W2020917972",
        "https://openalex.org/W1529693510",
        "https://openalex.org/W2332939148",
        "https://openalex.org/W1582830142",
        "https://openalex.org/W2343198019",
        "https://openalex.org/W2323038461",
        "https://openalex.org/W1543903926",
        "https://openalex.org/W1598311916",
        "https://openalex.org/W2072107584",
        "https://openalex.org/W2052825255",
        "https://openalex.org/W2588256299",
        "https://openalex.org/W2569160405",
        "https://openalex.org/W2588045287",
        "https://openalex.org/W2587961471",
        "https://openalex.org/W2519904480",
        "https://openalex.org/W2594319271",
        "https://openalex.org/W2594168647",
        "https://openalex.org/W2412857568",
        "https://openalex.org/W2542081733",
        "https://openalex.org/W2019122970",
        "https://openalex.org/W2146110079",
        "https://openalex.org/W2128504802",
        "https://openalex.org/W2159538890",
        "https://openalex.org/W2138735143",
        "https://openalex.org/W2050474729",
        "https://openalex.org/W2090838126",
        "https://openalex.org/W2136700375",
        "https://openalex.org/W2401373582",
        "https://openalex.org/W2533002392",
        "https://openalex.org/W2105857851",
        "https://openalex.org/W2054878724",
        "https://openalex.org/W2242254902",
        "https://openalex.org/W1973592917",
        "https://openalex.org/W2285257927",
        "https://openalex.org/W2473645942",
        "https://openalex.org/W2526304005",
        "https://openalex.org/W1977252147",
        "https://openalex.org/W2076564965",
        "https://openalex.org/W2045729301",
        "https://openalex.org/W2536560487",
        "https://openalex.org/W1043896296",
        "https://openalex.org/W2116105029",
        "https://openalex.org/W2312876051",
        "https://openalex.org/W2076269635",
        "https://openalex.org/W1923146918",
        "https://openalex.org/W2341049154",
        "https://openalex.org/W1481246412",
        "https://openalex.org/W2335059590",
        "https://openalex.org/W2064782201",
        "https://openalex.org/W2118462656",
        "https://openalex.org/W6639925746",
        "https://openalex.org/W2044238472",
        "https://openalex.org/W7018391422",
        "https://openalex.org/W2040557281",
        "https://openalex.org/W2550468575",
        "https://openalex.org/W2750612902",
        "https://openalex.org/W2094111656",
        "https://openalex.org/W2312514477",
        "https://openalex.org/W2460438550",
        "https://openalex.org/W2589111614",
        "https://openalex.org/W2090184537",
        "https://openalex.org/W2611668900",
        "https://openalex.org/W1999464631",
        "https://openalex.org/W2163474410",
        "https://openalex.org/W1926387150",
        "https://openalex.org/W1518070187",
        "https://openalex.org/W1970816228",
        "https://openalex.org/W2603459639",
        "https://openalex.org/W2592410994",
        "https://openalex.org/W2588893806",
        "https://openalex.org/W2753034082",
        "https://openalex.org/W2182017884",
        "https://openalex.org/W2107683369",
        "https://openalex.org/W2066157622",
        "https://openalex.org/W2184363983",
        "https://openalex.org/W2049182673",
        "https://openalex.org/W2588295462",
        "https://openalex.org/W2587502008",
        "https://openalex.org/W2090412769",
        "https://openalex.org/W2018761818",
        "https://openalex.org/W2166046300",
        "https://openalex.org/W1561300168",
        "https://openalex.org/W2529064259",
        "https://openalex.org/W2114513832",
        "https://openalex.org/W2000495960",
        "https://openalex.org/W2281957954",
        "https://openalex.org/W2161788244",
        "https://openalex.org/W2321980960",
        "https://openalex.org/W1999769327",
        "https://openalex.org/W2095800190",
        "https://openalex.org/W2066503235",
        "https://openalex.org/W2276000938",
        "https://openalex.org/W2564983610",
        "https://openalex.org/W2565379881",
        "https://openalex.org/W2612483059",
        "https://openalex.org/W2130329951",
        "https://openalex.org/W2122056850",
        "https://openalex.org/W1990706270",
        "https://openalex.org/W2033781911",
        "https://openalex.org/W2547219501",
        "https://openalex.org/W2293766937",
        "https://openalex.org/W2293792012",
        "https://openalex.org/W2056767746",
        "https://openalex.org/W2547490451",
        "https://openalex.org/W2588155891",
        "https://openalex.org/W2343445963",
        "https://openalex.org/W1973522232",
        "https://openalex.org/W2138557305",
        "https://openalex.org/W2155309674",
        "https://openalex.org/W2279525458",
        "https://openalex.org/W2571408170",
        "https://openalex.org/W2570950467",
        "https://openalex.org/W2495044310",
        "https://openalex.org/W2106876178",
        "https://openalex.org/W2605682711",
        "https://openalex.org/W2156087476",
        "https://openalex.org/W2165598478",
        "https://openalex.org/W1995029496",
        "https://openalex.org/W2588851056",
        "https://openalex.org/W1606670833",
        "https://openalex.org/W2479952842",
        "https://openalex.org/W2561425052",
        "https://openalex.org/W2153597540",
        "https://openalex.org/W2121271034",
        "https://openalex.org/W3013826674",
        "https://openalex.org/W4256662114",
        "https://openalex.org/W1571604593",
        "https://openalex.org/W2172096386",
        "https://openalex.org/W2619336812",
        "https://openalex.org/W4238948457",
        "https://openalex.org/W2104376205",
        "https://openalex.org/W2169967772",
        "https://openalex.org/W2141563891",
        "https://openalex.org/W2163512131",
        "https://openalex.org/W2328119608",
        "https://openalex.org/W2099414695",
        "https://openalex.org/W4379196476",
        "https://openalex.org/W4297828321",
        "https://openalex.org/W4251838377",
        "https://openalex.org/W2123787751",
        "https://openalex.org/W1922121547"
    ],
    "abstract": "The solid state transformer (SST) is seen as a proper replacement of the conventional iron-and-copper transformer in the future smart grid . The SST offers several benefits (e.g. enhanced power quality performance or reactive power control at both primary and secondary sides) that can be of paramount importance for the development of the smart grid . This research focuses on the development and implementation of an advanced model of a three stage bidirectional SST in Matlab/Simulink. The goal is to obtain an realistic SST model (i.e. as close to the real SST as possible) that could duplicate the performance of a real MV/LV SST. This considered design consists of three main stages: medium voltage (MV) stage, isolation stage, and low voltage (LV) stage. When the power flows from the MV side to the LV side, the input power-frequency ac voltage is converted into a MV dc voltage by the three-phase ac/dc converter, which in such case works as rectifier. The isolation stage, which includes a high-frequency transformer (HFT) and the two corresponding MV- and LV-side converters, first converts the MV-side dc voltage into a high-frequency square-wave voltage applied to the primary of the HFT; the secondary side square-wave signal is then converted to a LV dc waveform by the LV-side converter, which also works as rectifier. Finally, the output LV-side three-phase dc/ac converter, which works as inverter, provides the output power-frequency ac waveform from the LV-side dc link. Si-based semiconductor technologies can be used for MV applications using a multilelvel configuration. Recently, modular multilevel converter (MMC) topologies have attracted attention for high or medium voltage applications. These converters can provide an effective topology for the MV side of the SST; their main advantages are modularity and scalability: the desired voltage level can be easily achieved by a series connection of MMC sub-modules (SMs). In addition,a MMC topology can provide high power quality and efficiency with reduced size of passive filters. These features made the MMC option an attractive topology for the MV stage of the SST. This thesis proposes a three-stage SST configuration based on MMC technology for MV converters. * The input stage of the SST is connected to the distribution system via RL filters and its three-phase configuration uses a MMC technology. A half-bridge configuration is proposed for each SM. * The isolation stage consists of three parts: a MV single-phase MMC, the high-frequency transformer (HFT), and a single-phase LV PWM converter. * The LV side of the SST uses a three-phase four-leg PWM converter, with an RL impedance for filtering currents and a capacitor bank for filtering voltages. The converters and their controller have been implemented adn tested considering models without and with semiconductor losses, while the SST model has been tested as a stand-alone device and a compnent of a distribution system. The model has been tested under severe dynamic and unbalanced conditions. The simulation results support the choices made for any SST stage and proves that the proposed design could be a feasible choice for the future SST. El Transformador de Estado Sólido (\"Solid State Transformer\" por sus siglas en inglés) es visto como un reemplazo adecuado del transformador convencional en las futuras redes inteligentes (smart grids ). Este nuevo dispositivo presenta una amplia gama de prestaciones (p.e. mejora de la cualidad de suministro) que pueden ser de crucial importancia para el desarrollo de las redes inteligentes. El principal objetivo de esta tesis es que desarrollar e implantar el en Matlab/Simulink un modelo realista de estado sólido trifásico y bidireccional, que pueda duplicar el comportamiento de un transformador de estado sólido de Media-Baja tensión. El diseño considerado consiste en tres etapas: etapa en media tensión (MT), etapa intermedia, etapa en baja tensión (BT). Cuando la potencia fluye del terminal en media al terminal en baja tensión, la tensión alterna en el terminal de entrada a media tensión y frecuencia de operación 50 Hz se convierte en continua a media tensión mediante un convertidor trifásico rectificador. La etapa intermedia es un puente activo dual, que incluye un transformador de alta frecuencia y los correspondientes convertidores en media y baja tensión: primero, la media tensión continua es convertida en media tensión alterna a alta frecuencia; esta tensión es reducida a baja tensión preservando la alta frecuencia mediante el transformador, finalmente, la tensión en el terminal de salida del transformador es rectificada y convertida en baja tensión continua). La entrada en la etapa de salida en BT es, por tanto, una tensión continua que es convertida en tensión alterna a frecuencia de operación 50 Hz mediante un convertidor que funciona como inversor. Puesto que el diseño del dispositivo estudiado en esta tesis es bidireccional, en caso de que la potencia tenga que fluir desde el lado de BT al lado de MT, la función de los convertidores se invierte (es decir, los rectificadores pasan a operar como inversores, los inversores pasan a operar como rectificadores) en cualquiera de las etapas. Los actuales semiconductores solo pueden ser utilizados en aplicaciones de media y alta tensión empleando convertidores multi-nivel. Durante los últimos años ha ganado popularidad la tecnología MMC (modular multilevel converter), que permite diseñar configuraciones adecuadas para el lado de MT de un transformador de estado sólido; sus principales ventajas están en modularidad y escalabilidad: el nivel de tensión adecuado se puede conseguir mediante la conexión en serie de tantos sub-módulos como sea necesario. Además con la tecnología MMC se puede obtener una alta calidad en las ondas de tensión y corriente, así como un elevado rendimiento con tamaño reducido en los filtros de entrada. Esta tesis propone un diseño trifásico bidireccional con las siguientes características: - La etapa de entrada está conectada a una red de distribución en MT mediante filtros RL y su configuración trifásica usa convertidores de tecnología MMC. - La etapa intermedia contiene tres secciones: un convertidor monofásico en configuración MMC, un transformador de MT/BT y alta frecuencia, y un convertidor monofásico en BT. - La etapa de salida en BT usa un convertidor trifásico PWM (pulse wide modulation), con un filtro RL para las corrientes y un banco de condensadores para filtrar tensiones. Los convertidores han sido implantados en Matlab/Simulink y simulados considerando modelos con y sin pérdidas en los semiconductores, mientras que el modelo completo de transformador de estado sólido ha sido analizado considerando dos configuraciones distintas del sistema a estudiar: el transformador aislado y formando parte de una red de distribución en MT. Los modelos de transformador con y sin pérdidas han sido simulados bajo ciertas condiciones de operación. Los resultados confirman que la configuración seleccionada para cada etapa del nuevo dispositivo permite obtener un diseño fiable que puede mejorar el funcionamiento de las futuras redes inteligentes.",
    "full_text": " \n  \n \n \n  \n \n \n \n \nAdvanced modeling of solid  \nstate transformer \n \nMohammad Ebrahim Adabi Firouzjaee \n \n \nADVERTIMENT La consulta d’aquesta tesi queda condicionada a l’acceptació de les següents \ncondicions d'ús: La difusió d’aquesta tesi per mitjà del r e p o s i t o r i  i n s t i t u c i o n a l   \nUPCommons (http://upcommons.upc.edu/tesis) i el r epositori co operatiu TDX   \n( h t t p : / / w w w . t d x . c a t /) ha estat autoritzada pels titulars dels drets de propietat intel·lectual \núnicament per a usos privats emmarcats en activitats d’investigació i docència. No s’autoritza \nla seva reproducció amb finalitats de lucre ni la seva difusió i posada a disposició des d’un lloc \naliè al servei UPCommons o TDX. No s’autoritza la presentació del seu contingut en una finestra \no marc aliè a UPCommons (framing). Aquesta reserva de drets afecta tant al resum de presentació \nde la tesi com als seus continguts. En la utilització o cita de parts de la tesi és obligat indicar el nom \nde la persona autora. \n \n \nADVERTENCIA La consulta de esta tesis queda condicionada a la aceptación de las siguientes \ncondiciones de uso: La difusión de esta tesis por medio del repositorio institucional UPCommons  \n(http://upcommons.upc.edu/tesis) y el repositorio cooperativo TDR ( http://www.tdx.cat/?locale-\nattribute=es) ha sido autorizada por los titulares de los derechos de propiedad intelectual \núnicamente para usos privados enmarcados en actividades de investigación y docencia.  No \nse autoriza su reproducción con finalidades de lucro ni su difusión y puesta a disposición desde \nun sitio ajeno al servicio UPCommons  No se autoriza la presentación de su contenido en una \nventana o marco ajeno a UPCommons (framing). Esta reserva de derechos afecta tanto al \nresumen de presentación de la tesis como a sus contenidos. En la utilización o cita de partes \nde la tesis es obligado indicar el nombre de la persona autora. \n \n \nWARNING On having consulted this thesis you’re accepting the following use conditions: \nSpreading this thesis by the i n s t i t u t i o n a l  r e p o s i t o r y UPCommons   \n(http://upcommons.upc.edu/tesis) and the cooperative repository TDX ( http://www.tdx.cat/?locale-\nattribute=en)  has been authorized by the titular of the intellectual property rights only for private \nuses placed in investigation and teaching activities. Reproduction with lucrative aims is not \nauthorized neither its spreading nor availability from a site foreign to the UPCommons service. \nIntroducing its content in a window or frame foreign to the UPCommons service is not authorized \n(framing). These rights affect to the presentation summary of the thesis as well as to its contents. \nIn the using or citation of parts of the thesis it’s obliged to indicate the name of the author. \n\n  \n \n \n \n    \n                                                                                           \n                                                                                  \n \nPhD Thesis \n \n \n \n \n \nAdvanced Modeling of Solid State \nTransformer \nMohammad Ebrahim Adabi Firouzjaee \n \n \n \n \n \n \nBarcelona, January 2018 \n \n \n \n \n\n  \n \n \n \n \nAdvanced Modeling of Solid State \nTransformer \n \nMohammad Ebrahim Adabi Firouzjaee \n \n \n \n \n \n \n \nDissertation submitted to the Doctorate Office \nof the Universitat Politècnica de Catalunya in \npartial fulfillment of the requirements for the \ndegree of Doctor of Philosophy by the \n \nUNIVERSIDAD DE MALAGA \nUNIVERSIDAD DE SEVILLA \nUNIVERSIDAD DEL PAÍS VASCO/EUSKAL ERRIKO UNIBERTSITATEA \nUNIVERSITAT POLITÈCNICA DE CATALUNYA \n \nJoint Doctoral Programme in  \nElectric Energy Systems \n \n \n    \n \n \nBarcelona, January 2018 \n \n \n \n \n\n \n \n \n \n \n \n \n \n \n \n \nAdvanced Modeling of Solid State Transformer \n \nCopyright © Mohammad Ebrahim Adabi Firouzjaee, 2018 \nPrinted by the UPC  \nBarcelona, January 2018 \n \nISBN: -- \nResearch Project: -- \n \nUNIVERSITAT POLITÈCNICA DE CATALUNYA \nEscola de Doctorat \nEdifici Vertex. Pl. Eusebi Güell, 6 \n08034 Barcelona \nWeb: http://www.upc.edu \n \nUNIVERSIDAD DE MALAGA \nEscuela de Doctorado \nPabellón de Gobierno - Plaza el Ejido s/n  \n(29013) Málaga.  \nWeb: http://www.uma.es \n \nUNIVERSIDAD DE SEVILLA \nEscuela Internacional de Doctorado \nPabellón de México - Paseo de las Delicias, s/n \n41013 Sevilla \nWeb: http://www.us.es \n \nUNIVERSIDAD DEL PAÍS VASCO/EUSKAL ERRIKO UNIBERTSITATEA  \nEscuela de Master y Doctorado  \nEdificio Aulario II - Barrio Sarriena, s/n \n 48940- Leioa (Bizkaia) Spain. \nWeb: http://www.ehu.eus/es \n \n \n \n  \n   \nActa de calificación de tesis doctoral Curso académico: \nNombre y apellidos \nPrograma de doctorado  \nUnidad estructural responsable del programa  \n \n \nResolución del Tribunal \n \nReunido el Tribunal designado a tal efecto, el doctorando / la doctoranda expone el tema de su tesis \ndoctoral titulada \n____________________________________________________________________________________ \n____________________________________________________________________________________\n______. \nAcabada la lectura y después de dar respuesta a las cuestiones formuladas por los miembros titulares del \ntribunal, éste otorga la calificación: \n NO APTO  APROBADO  NOTABLE \n SOBRESALIENTE \n \n(Nombre, apellidos y firma) \n \n \n \n \nPresidente/a \n(Nombre, apellidos y firma) \n \n \n \n \nSecretario/a \n(Nombre, apellidos y firma) \n \n \n \n \nVocal \n(Nombre, apellidos y firma) \n \n \n \n \nVocal \n(Nombre, apellidos y firma) \n \n \n \n \nVocal \n \n \n______________________, _______ de __________________ de _______________ \n \n \n \nEl resultado del escrutinio de los votos emitidos por los miembros titulares del tribunal, efectuado por la \nComisión Permanente de la Escuela de Doctorado, otorga la MENCIÓN CUM LAUDE: \n SÍ  NO \n \n(Nombre, apellidos y firma) \n \n \n \n \n \nPresidente/a de la Comisión Permanente de la Escuela de \nDoctorado \n(Nombre, apellidos y firma) \n \n \n \n \n \nSecretario/a de la Comisión Permanente de la Escuela de \nDoctorado \n \nBarcelona,  _______ de ____________________ de __________ \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n  \nAcknowledgments \n \nI would like to thank many people and organizations for their help and support during \nthe period of this study. First of all, I would like to express my deepest sense of \ngratitude to my supervisor, Juan Antonio Martinez Velasco, who truly made a \ndifference in my academic perspective. With his support, encouragement and brilliant \nadvice throughout the PhD program, I developed my interest in the area of power \nelectronics application in power system. It has been a real pleasure and honor to work \nwith someone so dedicated and committed to his work. \nBesides my supervisor, I also would like  to acknowledge the support of his research \nteam who helped me a lot in developing my PhD work: Dr. Salvador Alepuz, Dr. \nJacinto Martin -Arnedo, Dr. Francisco González -Molina, Dr. Javier A. Corea -Araujo, \nand Dr. Luis Gerardo Guerra Sanchez. Their support is  one of the reasons for the \nsuccess of this thesis. I am thankful to them for providing a warm research environment, \nsharing the knowledge and encouragements. I will never forget the pleasant time that I \nhad with them during my PhD. \nI also would like to convey thanks to Universitat Politècnica de Catalunya (UPC) to \nprovide me a pleasant research area. I also want to acknowledge Researchers Welcome \nOffice of UPC, especially Mrs. Anna Maria Fabregas Punti who helped me a lot \nregarding my stay in Barcelona at the beginning of my research and also the paper work \nduring the PhD period. \nI would also like to thank my family for the support they provided me through my entire \nlife. I must acknowledge my wife and best friend, Nafiseh, without her love, \nencouragement and assistance; I would not have finished this research. My brothers \nalways encouraged me during the hard times and always be on my side. \nLast but not least, I am going to thank my parents. I owe a lot to them. They were \nalways available whenever I need th em and provided me a good life by supporting me \nboth emotionally and financially. During my stay in Spain, I have never forgotten the \ntears of my mother at the departure moment and heartwarming advice of my father. \nThey are supervisors of my life and I wish all the best from god for them. \nThank you all! \n  \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n“Nothing worth achieving is ever easy. It always takes smart, guts, hard work and \nperseverance” \n \n \n  \n  \n \n \n \nList of Publications \n \nJournal Publications: \n \nM. Ebrahim Adabi , Juan. A. Martinez -Velasco, and S. Alepuz , “ Modeling and \nsimulation of a MMC -based solid- state transformer ”, Electrical Engineering , \ndoi:10.1007/s00202-017-0510-x, February 2017. \n \nJ. Martin -Arnedo, F. González -Molina, Juan. A. Martinez -Velasco, and M. Ebrahim \nAdabi, “EMTP model of a bidirectional cascaded multilevel solid state transformer for \ndistribution system studies”, Energies, vol. 10, no. 4, pp. 521-539, April 2017. \n \nM. Ebrahim Adabi , and Juan. A. Martinez -Velasco, “MMC -based solid state \ntransformer model including semiconductor losses”, Electrical Engineering, doi:  \n10.1007/s00202-017-0640-1, 2017.  \n \nM. Ebrahim Adabi , and Juan. A. Martinez -Velasco, “A Survey of Solid State \nTransformers: Topologies, applications, and control strategies”, under preparation for \nRenewable & Sustainable Energy Reviews. \n \nConference Publications: \n \nJ. Martin -Arnedo, F. González -Molina, Juan. A. Martínez -Velasco, and E. Adabi,  \n“Implementation of a custom -made model for a multilevel solid state transformer,” \nEEUG Conf., Birmingham (UK), September 2016. \n \nJ. A. Corea -Araujo, Juan. A. Martinez -Velasco, and E. Adabi , “Optimum selection of \nparameters for a detailed model of a hybrid HVDC circuit breaker using a parallel \ngenetic algorithm”, EEUG Conf., Kiel, Germany, September 2017. \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n  \n \n \n \nTable of Contents \n \nChapter 1 The Solid State Transformer ..................................................................................... 1 \n1.1. Introduction ........................................................................................................... 1 \n1.2. The SST Definition and Organization ................................................................... 3 \n1.3. Summary of Technologies for the Three-stage Solid State Transformer .............. 5 \n1.4. Accomplishments .................................................................................................. 7 \n1.5. Document Structure ............................................................................................... 9 \n1.6. References ........................................................................................................... 10 \nChapter 2 Modeling of a Three-stage MMC-based Solid State Transformer ......................... 13 \n2.1. Introduction ......................................................................................................... 13 \n2.2. Input Stage: Configuration and Control .............................................................. 14 \n2.2.1. Introduction .................................................................................................. 14 \n2.2.2. Mathematical model ..................................................................................... 16 \n2.2.3. Medium-voltage side control ....................................................................... 18 \n2.3. Isolation Stage: Configuration and Control ......................................................... 20 \n2.3.1. Introduction .................................................................................................. 20 \n2.3.2. Single-phase MMC ...................................................................................... 21 \n2.3.3. High-frequency transformer ......................................................................... 21 \n2.3.4. Single-phase two-level full-bridge converter ............................................... 21 \n2.4. Output Stage: Configuration and Control ........................................................... 22 \n2.4.1. Introduction .................................................................................................. 22 \n2.4.2. Mathematical model ..................................................................................... 23 \n2.4.3. VOC design for a four-leg converter ........................................................... 24 \n2.4.4. Modulation technique .................................................................................. 27 \n2.5. Modeling of Semiconductor Losses .................................................................... 31 \n2.5.1. Introduction .................................................................................................. 31 \n2.5.2. Loss calculation ............................................................................................ 31 \n2.5.3. Loss implementation in semiconductor models ........................................... 33 \n2.5.4. Thermal model ............................................................................................. 36 \n2.5.5. Characterestics of selected semiconductors ................................................. 36 \n2.6. Conclusion ........................................................................................................... 40 \n2.7. References ........................................................................................................... 40 \nChapter 3 Matlab/Simulink Implementation of a Three-stage Solid State Transformer \nModel ....................................................................................................................................... 45 \n \n \n3.1. Introduction ......................................................................................................... 45 \n3.2. Implementation of the MV Input Stage ............................................................... 46 \n3.2.1. Configuration of the power circuit ............................................................... 46 \n3.2.2. Control blocks .............................................................................................. 46 \n3.3. Implementation of the MV-LV Isolation Stage ................................................... 49 \n3.4. Implementation of the LV Output Stage ............................................................. 52 \n3.4.1. Configuration of the Output Stage ............................................................... 52 \n3.4.2. Voltage control blocks ................................................................................. 54 \n3.4.3. Current controllers block .............................................................................. 59 \n3.4.4. Modulation block ......................................................................................... 62 \n3.5. Implementation of Semiconductor Losses .......................................................... 63 \n3.5.1. Introduction .................................................................................................. 63 \n3.5.2. Semiconductor loss calculation .................................................................... 63 \n3.5.3. Thermal models ............................................................................................ 65 \n3.5.4. Incorporation of losses into semiconductor models ..................................... 66 \n3.6. Conclusion ........................................................................................................... 71 \n3.7. References ........................................................................................................... 72 \nChapter4 Simulation Results ................................................................................................... 73 \n4.1. Introduction ......................................................................................................... 73 \n4.2. Simulation Results with a Lossless Stand-alone SST Model .............................. 73 \n4.2.1. Test system and test cases ............................................................................ 73 \n4.2.2. Discussion .................................................................................................... 88 \n4.3. Simulation Results with Semiconductor Losses .................................................. 94 \n4.3.1. SST model .................................................................................................... 94 \n4.3.2. SST Efficiency ............................................................................................. 94 \n4.3.3. Analysis of the thermal behavior ................................................................. 95 \n4.3.4. Test system and test cases ............................................................................ 95 \n4.4. Conclusion ......................................................................................................... 115 \n4.5. References ......................................................................................................... 116 \nChapter 5 General Conclusions ............................................................................................. 119 \nAppendix ............................................................................................................................... 123 \n \n \n \n  \n \n \n \nList of Tables \n \nTable 1.1. Comparison between topologies and control strategies ........................................... 8 \nTable 2.1. Switching levels for each MMC leg ....................................................................... 19 \nTable 2.2. Switching table of the four-leg converter ............................................................... 28 \nTable 2.3. Region pointer for 24 tetrahedrons and their corresponded non-zero \nswitching vectors ..................................................................................................................... 29 \nTable 2.4. Calculation of duty cycles ...................................................................................... 30 \nTable 2.5.  Characteristics of MV-level semiconductors ........................................................ 39 \nTable 2.6. Characteristics of LV-level semiconductors .......................................................... 40 \nTable 4.1. Fist case study - SST parameters ............................................................................ 74 \nTable 4.2. Second case study - SST parameters ...................................................................... 94 \nTable A1 – SST Prototypes ................................................................................................... 125 \nTable A2 – SST simulation tools .......................................................................................... 127 \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n  \n \n \n \nList of figures \n \nFigure 1.1. Classification of SST topologies [1.15], [1.16]. ..................................................... 4 \nFigure 1.2. Schematic configuration of a three-stage SST. ....................................................... 5 \nFigure 2.1. Schematic configuration of the three-stage SST design. ...................................... 13 \nFigure 2.2. Configuration of the three-phase input stage. ....................................................... 15 \nFigure 2.3. Different states of operation for half bridge SM. .................................................. 15 \nFigure 2.4. One leg configuration of the input stage MMC. ................................................... 16 \nFigure 2.5. Equivalent circuit of a MMC [2.13]. .................................................................... 17 \nFigure 2.6. Control diagram of three-phase input stage MMC controller. .............................. 18 \nFigure 2.7. Control block diagram and sorting algorithm for MMC converter. ..................... 19 \nFigure 2.8. Isolation stage configuration. ................................................................................ 20 \nFigure 2.9. Diagram of the single-phase isolation stage MMC controller. ............................. 22 \nFigure 2.10. Low-voltage side converter configuration. ......................................................... 22 \nFigure 2.11. Control block diagram for harmonic compensation. .......................................... 25 \nFigure 2.12. Positive sequence control diagram. ..................................................................... 26 \nFigure 2.13. Total VOC control diagram for output stage of SST. ......................................... 27 \nFigure 2.14. duty cycle of output voltages [2.43]. .................................................................. 31 \nFigure 2.15. Calculation of semiconductor conduction losses. ............................................... 32 \nFigure 2.16. Calculation of IGBT switching losses. ............................................................... 32 \nFigure 2.17. Calculation of diode switching losses. ................................................................ 33 \nFigure 2.18. Loss model for a combination of LV IGBT and antiparallel diode – \nApproach 1. ............................................................................................................................. 34 \nFigure 2.19. MV semiconductor loss models – Approach 2. .................................................. 35 \nFigure 2.20. Thermal model of a single LV semiconductor. .................................................. 37 \nFigure 2.21. Complete thermal model implementation. .......................................................... 38 \nFigure 2.22. Datasheet curves for MV-level semiconductors ................................................. 39 \nFigure 2.23. Datasheet curves for LV-level semiconductors .................................................. 39 \nFigure 3.1. Matlab/Simulink implementation of the three stage SST model. ......................... 46 \nFigure 3.2. Input stage - Three-phase MMC configuration. ................................................... 47 \nFigure 3.3. Input stage – Configuration of half-bridge submodules (SMs). ........................... 47 \nFigure 3.4. MV input stage - VOC blocks. ............................................................................. 48 \nFigure 3.5. Input stage - Block of the level shifted PWM technique for upper arm of \nphase A. ................................................................................................................................... 48 \nFigure 3.6. Input stage - Capacitor balancing and selection strategy. ..................................... 49 \nFigure 3.7. Isolation stage – Implementation of the MV single-phase MMC. ........................ 50 \nFigure 3.8. Isolation stage – Implementation of the LV single-phase two-level rectifier. ...... 51 \nFigure 3.9. Three phase four leg converter topology. ............................................................. 52 \nFigure 3.10. Overview of the control diagram for four leg converter. .................................... 52 \nFigure 3.11. Output stage – PLL blocks for 1st, 5th and 7th harmonics. ................................ 53 \nFigure 3.12.  Decomposition blocks for four leg inverter. ...................................................... 54 \nFigure 3.13. Diagram of the positive-sequence voltage controller for fundamental \nfrequency. ................................................................................................................................ 55 \n \n \nFigure 3.14. Diagram of the negative-sequence voltage controller for fundamental \nfrequency. ................................................................................................................................ 56 \nFigure 3.15. Diagram of the zero-sequence voltage controller for fundamental \nfrequency. ................................................................................................................................ 58 \nFigure 3.16. Diagram of the voltage control compensation of 5th harmonic. ......................... 58 \nFigure 3.17. Diagram of the voltage control compensation of 7th harmonic. ......................... 58 \nFigure 3.18. Reference signal in αβ frame for positive sequence current control block. ........ 59 \nFigure 3.19. Overall view of current control blocks................................................................ 60 \nFigure 3.20. Positive sequence current controller diagram. .................................................... 61 \nFigure 3.21. Negative sequence current controller diagram. ................................................... 62 \nFigure 3.22. Zero sequence current controller diagram........................................................... 62 \nFigure 3.23. 3D-SVMmodulation block. ................................................................................. 63 \nFigure 3.24. 3D-SVM modulator diagram. ............................................................................. 63 \nFigure 3.25. Calculation of conduction losses for IGBTs and Diodes. ................................... 64 \nFigure 3.26. Calculation of IGBT switching losses................................................................. 64 \nFigure 3.27. Calculation of diode switching losses. ................................................................ 65 \nFigure 3.28. Thermal model for the LV otput stage converter. ............................................... 65 \nFigure 3.29. Thermal model for one leg of the LV output stage converter. ............................ 66 \nFigure 3.30. The heat sink model. ........................................................................................... 68 \nFigure 3.31. Loss calculation block for IGBTs and diodes – Approach 1. ............................. 69 \nFigure 3.32. Incorporation of losses into the combined model of an IGBT and an \nantiparallel diode – Approach 1. ............................................................................................. 70 \nFigure 3.33. Loss calculation block for IGBT and diode. ....................................................... 70 \nFigure 3.34. Incorporation of losses into the combined model of an IGBT and an \nantiparallel diode – Approach 2. ............................................................................................. 71 \nFigure 4.1.  Test System 1 - Simulation results: Voltage sag at the MV side. ........................ 75 \nFigure 4.2.  Test System 1 - Simulation results: LV-side load variation. ............................... 77 \nFigure 4.3.  Test System 1 - Simulation results: Unbalanced LV-side load............................ 80 \nFigure 4.4.  Test System 1 - Simulation results: Nonlinear LV-side load. .............................. 82 \nFigure 4.5.  Test System 1 - Simulation results: Short-circuit at the LV terminals. ............... 84 \nFigure 4.6.  Test System 1 - Simulation results: Power flow reversal. ................................... 86 \nFigure 4.7.  Simulation results: Voltage sag at the MV side. .................................................. 89 \nFigure 4.8.  Simulation results: LV-side load variation. ......................................................... 90 \nFigure 4.9.  Simulation results: Short-circuit at the LV side. .................................................. 91 \nFigure 4.10.  Simulation results: Power flow reversal. ........................................................... 92 \nFigure 4.11.  Simulation results: short circuit at the secondary side. ...................................... 93 \nFigure 4.12. SST efficiency curves. ........................................................................................ 95 \nFigure 4.13. Junction temperature of IGBTs and diodes - LV side converter – Phase a ........ 96 \nFigure 4.14. Junction temperature of IGBT and diode of full bridge rectifier in isolation \nstage. ........................................................................................................................................ 96 \nFigure 4.15. Test System 2 - Configuration of the distribution network. ............................... 97 \nFigure 4.16.  Test System 2 - Simulation results: Voltage sag at the MV side. ...................... 98 \nFigure 4.17.  Test System 2 - Simulation results: LV-side load variation. ........................... 100 \nFigure 4.18.  Test System 2 - Simulation results: Unbalanced LV-side load........................ 102 \n  \n \n \n \nFigure 4.19.  Test System 2 - Simulation results: Nonlinear LV-side load. ......................... 104 \nFigure 4.20.  Test System 2 - Simulation results: Short-circuit at the LV terminals. ........... 106 \nFigure 4.21.  Test System 2 - Simulation results: Power flow reversal. ............................... 108 \nFigure 4.22.  Simulation results: Voltage sag at the MV side. .............................................. 111 \nFigure 4.23.  Simulation results: LV-side load variation. ..................................................... 112 \nFigure 4.24.  Simulation results: Short-circuit at the LV side. .............................................. 113 \nFigure 4.25.  Simulation results: Power flow reversal. ......................................................... 114 \nFigure 4.26.  Simulation results: Nonlinear load without and with HVC. ............................ 115 \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n  \n \n  \n \n \n \n \n \n \nChapter 1 \nThe Solid State Transformer \n \n \n1.1. Introduction \nThe future smart grid is being designed to mitigate or avoid consequences derived from \npower quality events (e.g., voltage dips), improve reliability indices (e.g., by reducing \nthe number of interruptions and their duration), and increase the efficiency (e.g., by \nreducing losses) [1.1]–[1.2].  \nA key component for future smart grids is the solid- state transformer (SST). The SST \nprovides new ways for controlling the electricity routing and also adds new \nfunctionalities to the distribution grid such as reactive power compensation, limited \nshort-circuit currents or voltage sag compensation . However, it should be taken in to \naccount that all of these functionalities will be achieved at the price of a more complex \nand expensive system\n [1.3]–[1.5]. \nThe SST is foreseen to play a key role in repl acement of conventional low frequency \ntransformers [1.6]-[1.10]. \nThe main  drawbacks of conventional iron- and-copper transformers are summarized \nbelow [1.11]-[1.12]: \n• the design presents bulky size and weight, \n• environmental concerns happens when leaks of mineral oil occurs, \n• voltage drop under load, \n• inability to mitigate flicker, \n• sensitivity to harmonics, \n• limited performance under DC-offset load unbalances, \n• inability to convert single -phase service to three- phase for powering certain \ntypes of equipment, \n• no energy-storage capacity, \nAdvanced Modeling of Solid State Transformer \n \n2 \n \n• unwanted voltage characteristics (e.g. voltage sags, fault occurrence) at one side \nare propagated to the other side, \n• conventional transformers losses are relatively high at the average load level: \ntransformers exhibit their maximum efficiency at their nominal load, while \ndistribution transformer average load level is about 30%. \nThe main benefits of SSTs in comparison with conventional transformers are: \n• smaller size and weight, \n• fast control of bidirectional active power flow, \n• enhanced power quality performance, \n• easy integration of distributed resources, \n• power factor correction, \n• reactive power control at both SST sides, \n• auto-balancing and variable-frequency, \n• instantaneous voltage regulation, \n• voltage sag compensation, \n• harmonic compensation, \n• fault isolation between the primary and the secondary sides. \nHowever, the SST has also some disadvantages in front of the conventional transformer, \nthey may include, among others, the following:  \n• The SST cost exceeds that of its conventional transformer counterpart. A need \nof cheap and reliable high-voltage high-power semiconductors to be competitive \nwith the conventional transformer is therefore evident.  \n• The SST has a lower efficiency than the conventional transformer due to \nsemiconductor losses.  \n• The SST has a more sophisticated design (e.g., needs more device and \ncomponents for design) than the conventional transformer, and this adds some  \nrisks in terms of reliability. \n• The SST exhibits higher EMI than the conventional transformer, which can \nrequire a better understanding of the SST impact and a better design to mitigate \nthis impact. \nIn recent years, high- frequency, high- power, low -loss power electronic devices are \navailable at a cheaper price. The advantages of the SST combined with cheaper power \nelectronic devices supports economic feasibility of SST for replacing conventional \ntransformer [1.11]. \nThe combination of all these aspects with the capabilities and advantages offered by this \ndevice has also promoted a significant research into the development and application of \nthe SST [1.12]. \n \n \n \n \n \nChapter1: The Solid State Transformer \n \n3 \n \n1.2. The SST Definition and Organization \nThe idea of a “solid state transformer” has been discussed since 1970. The initial \npurpose was to convert AC to AC for step- up or step down in a similar manner to that \nof a conventional transformer [1.6]. \nIn 1970, W. McMurray f orm General E lectric first introduced a high frequency link \nAC/AC converter, which became the basis for the solid state transformer based on \ndirect AC/AC converter [1.13]. \nA significant literature has been published since then to study the design, operation and \ncontrol of the solid state transformer [1.14]. \nAlthough the idea of the solid state transformer can be used for devices working at any \nvoltage at both the primary and the secondary side, by default it is assumed in this thesis \nthat this device is designed as an interface between systems working at medium and low \nvoltages, respectively. \nSeveral structures can realize the functionality of isolated AC -AC conversion to \npotentially suit the SST role in distribution systems. The classification presented here is \nthat proposed in references [1.12], [1.15]-[1.16]. \nFour basic configuration can be considered for SST regarding to specific application: \n1- Single stage SST (without DC link capacitances): It directly converts medium -\nvoltage AC  (MVAC) to low-voltage AC (LVAV) with a high frequency \ntransformer as isolation. \n2- Two stage SST (with DC link in the LV side): The MVAC is converted to \nLVDC at first stage and then the LVDC is converted to LVAC by an inverter. \n3- Two stage SST (with DC link in the MV side): at first stage MVAC is converted \nto MVDC   through AC/DC rectifier, then at second stage the MVDC is \nconverted to LVAC without using low voltage DC link capacitance. \n4- Three stage SST: The MVAC is converted to MVDC  in the first stage , the \nMVDC is converted to LVDC through dual active bridge (DAB)  in the second \nstage, and finally the LVDC is converted to LVAC in the third stage. \nFigure 1 .1 shows four basic topology configurations, namely types A, B, C, and D , \nwhich can suit SST functions [1-15], [1-16]. \nMost of the SST configurations designed for field application have adopted the type D \nsince many suitable topologies can be chosen for each stage providing room to optimize \nits performance.  Up to six representative SST topologies have been identified in \nreference [1.11], [1.12]: \n1. A single-stage SST comprising AC-AC full-bridge converter modules.  \n2. A single-stage SST comprising AC-AC flyback converter modules.  \n3. A two -stage SST comprising AC -DC isolated boost converter modules and a \npulse with modulated (PWM) dual-phase inverter.  \n4. A two -stage SST comprising AC -DC dual active bridge (DAB) converter \nmodules and a PWM dual-phase inverter.  \n5. A three -stage SST comprising a cascaded -full-bridge multilevel rectifier, DC -\nDC DAB modules and a PWM dual-phase inverter.  \n6. A three -stage SST comprising a diode -clamped multilevel rectifier, DC -DC \nFull-bridge converters and a PWM dual-phase inverter. \nAdvanced Modeling of Solid State Transformer \n \n4 \n \n  \na) Single-stage SST – Type A \n \nb) Two-stage SST with LVDC – Type B \n \nc) Two-stage SST with MVDC – Type C \n \nd) Three-stage SST – Type D \nFigure 1.1. Classification of SST topologies [1.15], [1.16]. \nThe design of the three -stage SST may be schematized as in Figure 1.2. It utilizes two \nsemiconductor converter bridges and one transformer in between.  \nThe first converter is connected to the MV side and it changes the three -phase AC \nvoltages, with a frequency of 50 or 60 HZ, to a DC voltage in the MV DC link. The DC \nvoltage is then converted back to AC, but with a higher frequency, by the second part of \nthe MV-converter bridge. Thanks to the higher AC frequency, the magnetic properties \nof the transformer core are better utilized and t he transformer can thus be made \nconsiderable smaller while maintaining the same power capability. On the LV side, a \nsecond converter bridge transforms the high frequency AC voltage first to DC and then \nback to the specific power frequency, 50 or 60 Hz. \nAs it can be seen from Figures 1. 2, SSTs use power electronic converters along with \nhigh frequency transformer in order to convert  medium or high voltage at the p rimary \nside to the low voltage at the secondary side. The result is a product that gives utilitie s \nan improved controllability in the grid, combined with a greatly reduced size and \nweight.  \nNote that the same or very similar design can be used to obtain a DC secondary -side \nwaveform or a high frequency AC waveform. Although neither the configuration nor \nthe design shown in Figure 1.2 should be significantly changed to cope with these \nalternatives, they are not studied in this thesis. By default the work presented in this \nthesis is focused on a three-stage SST for interfacing MV and LV systems. \ngbVAC\nAC\ngbVAC\nACMVAC LVAC\nHFT\ngbVAC\nAC\ngbVAC\nDCMVAC\nLVDC\nDC\nAC LVAC\nHFT\ngbVAC\nACMVAC DC\nAC\nAC\nAC\nMVDC\nLVAC\nHFT\ngbVAC\nACMVAC DC\nAC\nAC\nDC\nMVDC LVDC\nDC\nAC LVAC\nHFT\nChapter1: The Solid State Transformer \n \n5 \n \nGrid \nVoltages\nLine \nFilters\nHigh Voltage \nAC/DC \nConverter\nHigh Voltage \nDC/AC \nConverter\nSingle phase \nAC/DC \nRectifier\nFour Leg \nDC/AC\nInverter\nLoad Filter\nor\nLoad\nor\nGeneration\nVag\nHigh Voltage Stage Isolation Stage Low Voltage Stage\nVbg\nVcg\nRg Lg\nHFT\nLf Rf\nCf\n \nFigure 1.2. Schematic configuration of a three-stage SST. \n1.3. Summary of Technologies for the Three- stage Solid \nState Transformer \nSince standardized voltages used for MV distribution grids are usually equal or higher \nthan 10 kV [1.17], multilevel topologies must be considered for the MV side of the SST \nif conventional Si -based semiconductors are used [1.18] -[1.20]; that is, a realistic SST \nmodel has to consider a multilevel converter representation at the MV side. Different \ntopologies of multilevel converters have been proposed for SST applications. In \naddition, given the required number of levels, even for the lowest voltages, the selected \ntopology has to face some important aspects such as capacitor voltage balancing and \ncomplex control strategies.  \nSome of the different multilevel topologies and control strategies presented  to date are \nsummarized below. \nReference [1.21] proposes a model for a bidirectional SST to study its behavior under \nvariable operating conditions and/or in presence of disturbances, located at both sides of \nthe transformer.  \nReference [1.22] presents a dynamic average model (DAM) of SST for a bidirectional \nSST and its implementation in a real- time simulation platform. In this paper a four -leg \ninverter is proposed for  low voltage side to provide high performance behavior of the \nSST model under different operating conditions.  \nReference [1.23] presents a three -level neutral point clamped  (NPC) converter \nconfiguration for the MV side of the SST.  \nA modular SST design is proposed in [1.24] . The main characteristic of the topology is \nan independent operation of each sub module (SM). The  modules are connected to a \ncommon dc link that facilitates energy transfer between modules and ports. In such  \nmultiport system the ports can operate independently. This is an important feature for \napplications where input and output voltages are different in many parameters.  \nA cascaded H -Bridge Multilevel Inverter (CHMI -SST) topology is pr esented for \ndifferent applications in [1.25]-[1-29]. \nReference [1.25] presents the design of a master-slave control strategy for a  dual active \nbridge (DAB) . The goal is to reduce the controller task and simplify  the modulation \nAdvanced Modeling of Solid State Transformer \n \n6 \n \nalgorithm. The master controller executes control and modulation calculations, while \nthe slave controllers take care of switching and protection  tasks. Due to the inherent \nunbalances in cascaded H -bridges, a compensation strategy based on three- phase d -q \ndecoupled current controller  is proposed: a n optimum zero- sequence component is \ninjected so that the three -phase grid currents are balanced. Additionally , a dynamic \nreference voltage is implemented to tightly regulate the output voltage of DAB \nmodules. At t he end, grid currents and dc -link voltage in each module can be \nsimultaneously balanced. \nReference [1.26] presents the design and test of a CHMI -SST lab prototype that works \nas an active interface in smart grid s. Specifically, the design  of both power stage s and \ncontrollers is presented, and an advanced control system is developed to achi eve high-\nperformance operation. \nReference [1.27] proposes a novel current sensorless controller for balancing the power \nin the DC/DC stage of a SST based on a cascaded multilevel converter. It is shown that \nthe equalization of the active power component of duty cycles in the cascaded \nmultilevel rectifier can be a good indicator of power balance in the DC/DC stage. \nAdditionally, the power balance of the DC/DC stage can gu arantee voltage balance in \nthe rectifier stage if the differences among the power devices are negligible. \nReference [1.28] presents a 20 kVA SST based on 6.5 kV IGBT for interface with 7.2  \nkV distribution system voltage. The three- stage SST consists of a c ascaded multilevel \nAC/DC rectifier input stage, a DAB  converter isolation stage with high frequency \ntransformers, and a DC/AC inverter output stage. A novel control strategy based on the \nsingle-phase d -q vector control  is proposed to balance the rectifier capacitor voltages \nand the real power through the DAB parallel modules. \nReference [1.29] proposes a novel modular cascaded multilevel converter with \nmultilinking high -frequency (MWHF) transformer for medium or high vol tage \napplications. A cascaded H-bridge rectifier (CHBR) is connected directly with the input \nac source while the traditional step -down transformer is no longer necessary. A n \nisolated dc –dc converter composed by a group of H -bridge converters and a MWHF \ntransformer with high power density is used to isolate the dc buses. The equivalent \ncircuit and mathematical model of the MWHF transformer and the high frequency (HF) \nconverter are detailed . The paper analyzes the performance of the SST under \nunbalanced loads and verifies the naturally balance ability. \nReferences [1.30]-[1-32] present modular multilevel converter (MMC) configurations \nin which the high-voltage grid- side power converter generates  high-frequency \nsinusoidal voltages. \nA detail ed analysis of topologies and control strategies proposed for three -stage SST \ndesigns are summarized in Table 1 .1 [1.12]. According to the t able, MMC converters \ncan provide an effective topology for the MV side of the SST; their main advantages are \nmodularity and scalability: the desired voltage level can be easily achieved by a series \nconnection of MMC sub- modules (SMs). In addition, a MMC topology can provide \nhigh power quality and efficiency with reduced size of passive filters. These features  \nmakes MMC option an attractive topology for the MV stage of the SST. In addition, \nfrom the information presented in the table, it is evident that the level shifted PWM \n(LS-PWM) is a well suited modulation method for the MMC due to its simple algorithm \nand minimal hardware requirements. \nChapter1: The Solid State Transformer \n \n7 \n \nAs it can be deduced from the table, the single -phase Dual Active Bridge (DAB) \ntopology provides a good efficiency while keeping the number of passive components \nlow, which allows for a simple and compact design. The table also shows that the \nphase-shift modulation is simple to implement and its lower RMS currents result in \nlower component ratings. These advantages outweigh the higher turn- off losses faced \nwith this method. \nThe t hree-phase four -leg (3P -4L) converter is capable of  handling unbalanced loads \nwhile keeping the number of switches to a minimum. This makes the 3P -4L converter a \nsuited topology for this stage. The 3D -SVPWM (3D-Space Vector PWM) and DPWM \n(discontinuous PWM) are difficult to implement because of their high computational \nrequirements, while the CPWM (Continuous PWM) has very low hardware \nrequirements and an easy algorithm, which makes it very suitable to use for the 3P -4L \nconverter. \n \n1.4. Accomplishments \nThe main goal of this thesis is to implement and test an adv anced three-stage \nbidirectional MMC-based SST model in Matlab/Simulink: the implemented model must \nbe realistic and as close as possible to the real SST design . The proposed model should \nduplicate the performance of a real MV/LV SST with a rated power below 1 MVA. \nIn order to achieve these objectives, the tasks listed below have been carried out.  \nHigh voltage stage: \nTask 1: An advanced three-phase modular multilevel converter (MMC) model has been \ndeveloped and implemented. \nTask 2: A vector pulse width modulation control strategy has  been implemented to \nobtain high quality MV voltage and current waveforms, and a balanced DC voltage at \neach MMC submodule. \nIsolation stage: \nTask 3: A model for the converters operating at each side of the DC -DC isolation stage \nhas been implemented: a  single-phase modular multilevel converter model at the MV \nside and a single-phase bridge model at the LV side. \nTask 4: A proper control strategy has  been implemented in order to provide high \nfrequency multilevel voltage at the higher voltage side of the high frequency  \ntransformer. \nLow voltage stage: \nTask 5: A three- phase four -leg converter with enhanced control strategy has been \ndeveloped and implemented to obtain an enhanced performance in both balanced and \nunbalanced conditions of loads  and with the capability of harmonic compensation for \nnonlinear loads. \nTask 6: Adequate values have been selected for filters in order to obtain high quality \nvoltage and current waveforms at both sides of the SST. \n \n \nAdvanced Modeling of Solid State Transformer \n \n8 \n \nTable 1.1. Comparison between topologies and control strategies \nTopology/Control Advantages Disadvantages \nAC-DC MV Input Stage \nConverter Topology \nFlying Capacitor \n(FC) \nModularity Higher output levels require a large amount \nof capacitors \nComplex control \nComplex voltage balance control \nCascade H-Bridge \n(CHB) \nSimple control \nSimple voltage balance control \nModularity \nHigh voltage DC-link not achievable \nH-bridge NPC \n(HNPC) \n Complex control \nComplex voltage balance control \nLimited modularity \nMultilevel Active NPC \n(ML-ANPC) \nModularity  Complex control and voltage balance \ncontrol \nNumber of clamping diodes increase with \nsquare of output levels \nTransistor Clamped \n(TTC) \nSimple control \nModularity \nLarge number of transistors required \nComplex voltage balance control \nModular Multilevel \nConverter (MMC) \nModularity and flexibility Complex control \nComplex voltage balance control \nControl Strategy \nPhase Shifted PWM \n(PS-PWM) \nSimple control algorithm \nMinimal hardware requirements \nEach cell is assigned with a pair of \ncarriers, allowing for easy control \n \nLevel Shifted PWM \n(LS-PWM) \nSimple control algorithm \nMinimal hardware requirements \nSlightly better harmonic cancelation \n \nDC-DC MV/LV Isolation Stage \nConverter Topology \nSingle-phase Dual Active \nBridge converter \nFewest passive components \nGood efficiency \nLarge RMS DC capacitor currents may \noccur \nThree-phase Dual Active \nBridge converter \nSmaller RMS current than Dual Active \nBridge \nLower component ratings \nNo need for extra inductors \nHigh number of switches and inductors \nHigher losses \nBidirectional Isolated \nFull Bridge converter \nHigh switching frequency and power \ndensity \nRequires extra inductor \nRequires snubber circuit \nBidirectional Isolated \nCurrent Doubler \ntopology \nHigh current handling \nLower conduction losses \nFewer switches \nRequires two extra inductors \nLimited operating voltage \nBidirectional Isolated \nPush-Pull topology \nHigh current handling  \nReduced inductor requirements \nFewer switches required \nIneffective use of complex transformer \nControl Strategy \nPhase Shift Modulation Simple control and algorithm Higher losses at low power levels \nTrapezoidal Modulation High voltage range Unable to operate under no-load \nTriangular Modulation Low switching losses High RMS currents \nDC-AC LV Output Stage \nConverter Topology \n1P-3W converter Can handle unbalanced loads High number of switches \n3P converter Simple circuit and control DC-link unbalance \n3P-4L converter Can handle unbalanced loads Complex control \nControl Strategy \n3D Space Vector PWM \n(3D-SVPWM) \nComplex implementation Modest switching losses \nContinuous PWM \n(CPWM) \nModest switching losses \nEasy implementation \n \nDiscontinuous PWM \n(DPWM) \nComplex implementation Low switching losses \n \nChapter1: The Solid State Transformer \n \n9 \n \nModeling of semiconductor losses \nTask 7: In order to obtain a realistic SST model and estimate the actual SST efficiency, \nsome work has been focused on the representation of semiconductor losses.  Several \napproaches for representing semiconductor losses in the various topologies selected for \nthe different SST stages have been followed.  \nCase studies \nTask 8:  Complete test s of the two implemented SST models (without and with \nsemiconductor losses) have been carried out in order to check the performance of a \nbidirectional device, running in a stand- alone manner or as a component of a MV \ndistribution system.  \nAs a result of the  research work carried out for this Thesis, several technical papers \nhave been submitted to different conferences and journals. The complete list of \naccepted and submitted papers is as follows: \n \n1. M. Ebrahim Adabi, Juan A. Martinez-Velasco, and Salvador Alepuz, “Modeling \nand simulation of a MMC -based solid- state transformer ”, Electrical \nEngineering, doi:10.1007/s00202-017-0510-x, 2017. \n2. Jacinto Martin-Arnedo, Francisco González -Molina, Juan A. Martinez -Velasco, \nand M. Ebrahim Adabi , “ EMTP model of a bidire ctional cascaded multilevel \nsolid state transformer for distribution system studies”, Energies , vol. 10, no. 4, \npp. 521-539, April 2017. \n3. M. Ebrahim Adabi, and J uan A. Martinez -Velasco, “MMC -based solid state \ntransformer model including semiconductor losses”, Electrical Engineering, doi:\n \n10.1007/s00202-017-0640-1, 2017.  \n4. Jacinto Martin-Arnedo, Francisco González -Molina, Juan A. Martínez -Velasco, \nand Ebrahim Adabi, “Implementation of a custom -made model for a multilevel \nsolid state transformer,” EEUG Conf., Birmingham (UK), September 2016. \n5. Javier A. Corea -Araujo, Juan A. Martinez -Velasco, and Ebrahim Adabi, \n“Optimum selection of parameters for a detailed model of a  hybrid HVDC \ncircuit breaker using a parallel genetic algorithm,” EEUG Conf. , Kiel \n(Germany), September 2017. \n6. M. Ebrahim Adabi, and Juan A. Martinez - Velasco, “A Survey of Solid State \nTransformers: Topologies, applications , and control strategies”, under \npreparation. \n \n1.5. Document Structure \nThe remainder of this t hesis is divided into four subsequent chapters plus an Appendix. \nThe chapters will present th e procedures developed for the t hesis as well as detail case \nstudies used to prove the usefulness of the proposed methods. The topics covered by \neach chapter are summarized below. \n \nSecond chapter \n \nThe second chapter details and analyzes the  configuration selected for each stage of  a \nbidirectional three-stage MMC-based SST. It also details the approach implemented to \nrepresent semiconductor losses and obtain a more realistic lossy model of a SST as a \ndevice connected to the distribution system.  \nAdvanced Modeling of Solid State Transformer \n \n10 \n \nThird chapter \n \nThe third chapter provides a detailed description  of the Matlab/S imulink \nimplementation of the MMC-based SST. \n \nFourth chapter \n \nChapter 4 presents simulation results for several case studies considering two different \nSST models and test systems. The first test system is simply a stand -alone SST without \nlosses, the second test system is a medium size MV distribution system to which a lossy \nSST model is  connected (i.e. the SST serves as interface between a MV distribution \nsystem and LV load/generation).  \n \nFifth chapter \n \nThe last chapter summarizes the main conclusions derived from the work developed for \nthis Thesis. \n \nAppendix \n \nThe Appendix provides a detailed summary of SST prototypes presented to date and an \nup-to-date experience on SST modeling and simulation. \n \n1.6. References \n[1.1] N. Hadjsaïd and J. C. Sabonnadière (Eds.), Smart Grids, John Wiley-ISTE, London \n(UK) – Hoboken (NJ, USA), 2012.  \n[1.2] J. Momoh, Smart Grid. Fundamentals of Design and Analysis , John Wiley-IEEE \nPress, Hoboken, NJ, USA, 2012.  \n[1.3] S. Bifaretti, P. Zanchett a, A. Watson, L. Tarisciotti, and J. C. Clare, “Advanced \npower electronic conversion and control system for universal and flexible power \nmanagement,” IEEE Trans. on Smart Grid, vol. 2, no. 2, pp. 231-243, June 2011. \n[1.4] J. Wang, A.  Q. Huang, W. Sung, Y. Liu, and B. J. Baliga, “Smart grid \ntechnologies,” IEEE. Ind. Electron. Mag., vol. 3, no.2, pp. 16–23, June 2009. \n[1.5] J-S. Lai, “Power conditioning circuit topologies,” IEEE. Ind. Electron. Mag., vol. 3, \nno.2, pp. 24–34, June 2009. \n[1.6] A. Sundaram, “Solid state transfo rmer (SST): Concepts, modeling, applications, \nadvantages & challenges,” Course on Power Electronics for Grid Connected \nRenewable Energy Systems (PEGRES), Calicut (Kerala, India), 2015. \n[1.7] X. She, R. Burgos, G. Wang, F. Wang, and A. Q. Huang, “Review of solid state \ntransformer in the distribution system: From components to field application,” IEEE \nEnergy Conversion Congress and Exposition (ECCE), September 2012. \n[1.8] X. She, A. Huang, F. W ang, and R. Burgos, “Wind energy system with integrated \nfunctions of active power transfer, reactive power compensation, and voltage \nconversion,” IEEE Trans. on Ind. Electron., vol. 60, no. 10, pp. 4512–4524, \nOctober 2013. \n[1.9] T. Zhao, G. Wang, S. Bhattacharya, and A. Q. Huang, “Voltage and power balance \ncontrol for a cascaded h- bridge converter -based solid -state transformer,” IEEE \nTrans. on Power Electron., vol. 28, no. 4, pp. 1523–1532, April 2013. \n[1.10] A. Maitra, A. Sundar am, M. Gandhi, S. Bird, and S. Doss , “Intelligent universal \ntransformer design and applications,” 20th Int . Conf. and Exh. on Electricity \nDistribution (CIRED), June 2009. \n[1.11] L. Heinemann and G. Mauthe, “The universal power electronics based distributi on \nChapter1: The Solid State Transformer \n \n11 \n \ntransformer, a unified approach,” 32nd IEEE Annual Power Electron. Spec. Conf. , \npp. 504–509, 2001. \n[1.12] A. Shiri, “A solid state transformer for interconnection between the medium and the \nlow voltage grid design,” Master Thesis, Delft University of Technology, \nNetherlands, October 2013. \n[1.13] W. McMurray, “Power converter circuits having a high frequency link,” U.S. Patent \n3 517 300, June 1970. \n[1.14] J.E. Huber and J.W. Kolar, “Solid -state transformers: on the origins and evolution \nof key concepts,” IEEE Ind. Electronics Mag., vol. 10, no. 3, pp. 19- 28, September \n2016. \n[1.15] S.D. Falcones Zambrano, “A DC -DC multiport converter based solid state \ntransformer integrating distributed generation and storage ”, PhD Thesis , Arizona \nState University, August 2011.  \n[1.16] X. She, A.Q. Huang, and R. Burgos, “Review of solid -state transformer \ntechnologies and their application in power distribution systems ”, IEEE Journal of \nEmerging and Selected Topics in Power Electronics , vol.1, no.3, pp. 186- 198, \nSeptember 2013.  \n[1.17] IEC Std 60038, IEC standard voltages, Edition 7.0, 2009. \n[1.18] H. Abu-Rub, J. Holtz, J. Rodriguez, and G. Baoming, “Medium -voltage multilevel \nconverters-State of the art, challenges, and requirements in in dustrial applications,” \nIEEE Trans. on Ind. Electron., vol. 57, no. 8, pp. 2581-2596, August 2010. \n[1.19] S. Kouro, M. Malinowski, K. Gopakumar, J. Pou, L.  G. Franquelo, B. Wu, J. \nRodriguez, M. A. Pérez, and J. I. Leon, “Recent advances and industrial \napplications of multilevel converters,” IEEE Trans. on Ind. Electron., vol. 57, no. 8, \npp. 2553-2580, August 2010. \n[1.20] J. Rodríguez, S. Bernet, B. Wu, J.  O. Pontt, and S. Kouro , “Multilevel voltage -\nsource-converter topologies for industrial medium -voltage drives,” IEEE Trans. on \nInd. Electron., vol. 54, no. 6, pp. 2930-2945, December 2007. \n[1.21] S. Alepuz, F. González -Molina, J. Martin -Arnedo, and J. A. Martinez -Velasco, \n“Development and testing of a bidirectional distribution electronic power \ntransformer model,” Electric Power Systems Research, vol. 107, pp. 230-239, 2014. \n[1.22] J. A. Martinez -Velasco, S. Alepuz, F. González -Molina, and J. Martin-Arnedo, \n“Dynamic average modeling of a bidirectional solid state transformer for feasibility \nstudies and real-time implementation,” Electric Power Systems Research , vol. 117, \npp.143–153, 2014. \n[1.23] F. González, J. Martin -Arnedo, S. Alepuz, and J.  A. Martinez -Velasco, “EMTP \nmodel of a bidirectional multilevel solid state transformer for distribution system \nstudies,” IEEE Power & Energy Society General Meeting, 2015.  \n[1.24] M. Sabahi, A. Yazdanpanah Goharrizi, S. H. Hosseini, M. B . Bana Sharifian, and \nG. B. Gharehpetian, “Flexible power electronic transformer,” IEEE Trans. on \nPower Electron., vol. 25, no. 8, pp.2159-2169, August 2010. \n[1.25] L. Wang, D. Zhang, Y. Wang, B. Wu, and H. S. Athab, “Power and voltage balance \ncontrol of a novel three -phase solid state transformer using multilevel cascaded H -\nbridge inverters for microgrid applications,” IEEE Trans. on Power Electron., \nvol.31, no.4, pp.3289-3301, April 2016. \n[1.26] X. She, X. Yu, F. Wang, and A. Q. Huang, “Design and demonstration of a 3.6-kV–\n120-V/10-kVA solid-state transformer for smart grid application,” IEEE Trans. on \nPower Electron., vol. 29, no. 8, pp. 3982-3996, August 2014. \n[1.27] X. She, A. Q. Huang, and X. Ni, “Current sensorless power balance strategy for \nDC/DC converters in a cascaded multilevel converter based solid state transformer,” \nIEEE Trans. on Power Electron., vol. 29, no. 1, pp.17-22, January 2014. \n[1.28] T. Zhao, G. Wang, J. Zeng, S.  Dutta, S. Bhattacharya, and A.  Q. Huang, “Voltage \nand power balance control for a cascaded multilevel solid state transformer,” \nApplied Power Electronics Conf. and Exp. (APEC), 2010. \n[1.29]  Z. Zheng, Z. Gao, C. Gu , L. Xu, K. Wang, and Y. Li, “Stability and voltage \nAdvanced Modeling of Solid State Transformer \n \n12 \n \nbalance control of a modular converter with multi -winding high -frequency \ntransformer,” IEEE Trans. on Power Electron. , vol. 29, no. 8, pp.4183-4194, \nAugust 2014. \n[1.30] A. Kumar Sahoo and N. Mohan, “High  frequency link multi -winding power \nelectronic transformer using modular multilevel converter for renewable energy \nintegration,” 40th Annual Conf . of the IEEE Industrial El ectronics Society \n(IECON), 2014.  \n[1.31] A. Kumar Sahoo and N. Mohan, “A power electronic transformer with sinusoidal \nvoltages and currents using modular multilevel converter,” Int . Power Electronics \nConf. (IPEC-ECCE-Asia), Hiroshima (Japan), 2014. \n[1.32] A. Shojaei and G. Joos, “A topology for three -stage solid state transformer,” IEEE \nPower and Energy Society General Meeting, 2013. \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n  \n \n \n \n \n \n \nChapter 2 \nModeling of a Three-stage MMC-based \nSolid State Transformer \n \n \n2.1. Introduction \nRecently, modular multilevel converter (MMC) topologies have attracted attention for \nhigh or medium voltage applications  [2.1]-[2.5]. These converters can provide an \neffective topology for the MV side of the SST; their main advantages are modularity \nand scalability: the desired voltage level can be easily achieved by a series connection \nof MMC sub -modules (SMs ). In addition, a MMC topol ogy can provide high power \nquality and efficiency with reduced size of passive filters. These features made the \nMMC option an attractive topology for the M V stage of the SST [2.6] -[2.7]. The main \ngoal of this thesis is to develop and implement in Matlab/Si mulink the model of a \nbidirectional three-stage MMC-based SST which can provide an efficient performance \nunder various operating conditions. Figure 2.1 shows the schematic configuration of the  \nbidirectional three stage SST design , which consists of three m ain stages: medium \nvoltage stage, isolation stage, and low voltage stage. \n \nFigure 2.1. Schematic configuration of the three-stage SST design. \nLow Voltage\nSingle-phase \nAC/DC Rectifier\nFour Leg \nDC/AC Inverter Load Filter\nHFT\ngaV\ngbV\ngcV\n1R 1L\n2R 2L\n2C\nGrid \nVoltages Line Filter Three Phase\nAC/DC Converter\nHigh Voltage\nSingle Phase \nDC/AC Converter\nMedium Voltage Stage Isolation Stage Low Voltage Stage\nLoad\nand/or\nGeneration\n2nR 2nL\nAdvanced Modeling of Solid State Transformer \n \n14 \n \nWhen the power flows from the MV side to the LV side, the input power -frequency ac \nvoltage is converted into a MV  dc voltage by the three- phase ac/dc converter, which in \nsuch case works as rectifier. The isolation stage, which includes a high- frequency \ntransformer (HFT) and the two corresponding MV - and LV -side converters, first \nconverts the MV -side dc voltage into a  high-frequency square-wave voltage applied to \nthe primary of the HFT; the secondary side square -wave signal is then converted to a \nLV dc waveform by the LV -side converter, which also works as rectifier. Finally, the \noutput LV -side three -phase dc/ac conver ter, which works as inverter, provides the \noutput power -frequency ac wav eform from the LV -side dc link. The MV side \n(hereinafter known as input stage) is connected to a MV distribution grid, while the LV \nside (hereinafter known as output stage ) is assumed to be connected to a LV grid to \nwhich both load and generation might be connected. When the power flows from the \nLV side to the MV side (i.e. the LV generation is predominant), the SST behavior is \nsimilar to that described above; basically, input and output stages swap functions. The \nrest of this section provides a summary of the configuration selected for each stage and \nthe corresponding controllers. \nIn this work, a three -phase MMC with half -bridge SMs is used for input stage. A \nvoltage oriented control (V OC) strategy has been used to generate proper reference \nsignals; a level -shifted PWM method is used as modulation technique. In addition, a \nsorting algorithm technique is used for balancing the SM capacitance voltages. \nThe isolation stage is divided into three parts: a single-phase MMC, a HFT and a single-\nphase bidirectional PWM converter. An open- loop level -shifted PWM and a sorting \nalgorithm have been used to control the MV single -phase MMC, while a proportional -\nresonant (PR) based control is applied to t he LV single -phase bidirectional PWM \nconverter. \nA three-phase four-leg converter is used for the output stage. A VOC strategy with a \nthree-dimensional SVM (3- D SVM) modulation technique has been implemented to \ngenerate proper reference signals. \n2.2. Input Stage: Configuration and Control \n2.2.1. Introduction \nThe MV stage of the SST is connected to a three -phase AC distribution system via RL \nfilters. Figure 2.2 shows the configuration of the three -phase MMC selected for this \nwork. If it is assumed the power flows fr om the MV side to the LV side of the SST, the \nMV-side MMC acts as a rectifier that converts the ac voltage of the grid to a dc voltage. \nIn case of power flow reversal, the MMC passes to act as inverter that passes the DC  \nvoltage of the input stage DC  link to AC voltage at power frequency. As it can be seen \nfrom Figure 2.2, each leg of three -phase MMC consists of two upper and lower arms \nwith n similar series connected sub module (SM), an arm resistance (Rarm) and an arm \ninductance ( Larm). Different types of  SMs such as half bridge converter, full bridge \nconverter, three level neutral point clamp (NPC) converter, three level flying capacitor \n(FC) converter and different topologies of cross connected converters can be used in \nMMC [2.8]-[2.10]. In this work, ha lf bridge converter is used as SM for MMC. Figure \n2.3 shows the different states for operation of half bridge SM regarding to current \ndirection. As it can be seen from this figure, half - bridge SM comprises of two IGBT \nswitches s\n1 and s2, and a capacitor as a DC source with voltage of V c, s1, and s 2 are \nswitched in complementary manner. \nChapter2: Modeling of a Three-stage MMC-based Solid State Transformer \n \n15 \n \n \nFigure 2.2. Configuration of the three-phase input stage. \n \nFigure 2.3. Different states of operation for half bridge SM. \nvdc1/2\n+\n−\nvdc1/2\n+\n−\ncirci\n+\n−\n+\n−\n+\n−\n+\n−\n+\n−\n+\n−\nlav\nucvubvuav\nlbv lcv\n1aSM\n2aSM\n1bSM\n2bSM\nnaSM nbSM\n1bSM1aSM\n2aSM 2bSM\nnaSM nbSM\n1R 1L\n1aS 1aD\n2aS 2aD\ncv\n+\n−\n1dci\nvSM\n+\n−\nVgc\nVgb\nVga\narmR\narmL\narmR\narmL\narmR\narmL\narmR\narmL\narmR\narmL\narmR\narmL\n1cSM\n2cSM\nncSM\n1cSM\n2cSM\nncSM\nuai ubi uci\nlaI lbI lcI\nbi\nbv ci\ncv\nai\nav\nS1 D1\nD2S2\nS1 D1\nD2S2\nS1 D1\nD2S2\nS1 D1\nD2S2\nS1 :on  ,  S2:offS1 :off  ,  S2:on\ni<0\ni>0\ni<0\ni>0\ni\nii\ni\n+\nVc\n-\n+\nVc\n-\nAdvanced Modeling of Solid State Transformer \n \n16 \n \nWhen the switch  s1 is on the voltage of SM is equal to Vc, and it is said that SM is \ninserted. When the switch s2 is on the voltage of SM is equal to zero and it is said that \nSM is bypassed. Also, when the current inserts from positive polarity of capacitor, the \ncapacitor is charged and when the current inserts from negative polarity of capacitor, \nthe capacitor is dis charged. Since in MMC topology each arm should have the \ncapability to work with total dc link voltage, the value of each SM capacitance voltage \nmust be: \n dc\ncSM\nvv n=  (2.1) \n2.2.2. Mathematical model \nTo better analyze the model of the MV -side MMC, Figure 2. 4 shows the interaction of \none MMC leg and the MV DC link [2.11]-[2.12].  \n \nFigure 2.4. One leg configuration of the input stage MMC. \n \nThe current of the upper and lower arms of the phase k , (k = a, b, c), iuk and ilk, can be \nexpressed as: \n \n2\nk\nuk circ\niii = −  (2.2) \n \n2\nk\nlk circ\niii = +  (2.3) \n+\n−\n+\n−\nukv\nlkv\n1dci\nvdc1/2\n+\n−\nvdc1/2\n+\n−\narmR\narmL\narmR\narmL\ncirci\nuki\nlki\nki\nkv\n1kSM\n2kSM\nnkSM\n1kSM\n2kSM\nnkSM\nChapter2: Modeling of a Three-stage MMC-based Solid State Transformer \n \n17 \n \nwhere ik is the input current of phase k, and icirc is the circulating current which can be \nachieved through adding (2.2) and (2.3): \n \n2\nuk lk\ncirc\niii +=  (2.4) \nUpper and lower voltages of the phase k, vuk and vlk can be expressed as: \n 1\n2\ndc uk\nuk k arm uk arm\nv div v Ri L dt= −− −  (2.5) \n 1\n2\ndc lk\nlk k arm lk arm\nv div v Ri L dt= +− −  (2.6) \nwhere vk is the voltage of phase k at the ac side of the MMC, R arm and Larm are \nrespectively the resistance and inductance of each MMC arm.  \nBy subtracting (2.6) from (2.5) and substituting iuk and ilk from (2.2)-(2.3), the following \nform for vk is obtained: \n \n2 22\nlk uk arm k arm k\nk\nv v R i L div dt\n−= ++  (2.7) \nAs it can be seen from Figure 2.2: \n 11\nk\ngk k k\ndiv v Ri L dt= ++  (2.8) \nwhere R1 and L1 are the resistance and inductance of the input filters. Upon substituting \n(2.7) in (2.8) the following equation is obtained: \n 11\n2 22\nlk uk arm k arm k k\ngk k\nv v R i L di div Ri Ldt dt\n−= + + ++  (2.9) \nAn equivalent circuit of the MMC can be derived from these results (see figure 2.5). By \nusing the following forms [2.13]: \n \n2\nlk uk\neq\nvvv −=  (2.10) \n 1\n2\narm\neq\nRRR = +  (2.11) \n 1\n2\narm\neq\nLLL = +  (2.12) \nequation (2.9) becomes: \n k\ngk eq eq k eq\ndiv v Ri L dt= ++  (2.13) \n \nFigure 2.5. Equivalent circuit of a MMC [2.13]. \n \neqR eqLgkV eqV\nAdvanced Modeling of Solid State Transformer \n \n18 \n \n2.2.3. Medium-voltage side control \nA VOC strategy has been selected to generate proper reference signals for the \nmodulation technique implemented in this work. The positive -sequence grid voltage is \nused to obtain t he grid angle for synchronization purposes by means of a phase -locked \nloop (PLL).  \nThe block diagram is shown in Figure 2.6; the VOC scheme provides the reference \nvoltage of phase k, *\nkv  [2.14]-[2.15]. From equations (2.5) and (2.6) and upon neglecting \nvoltage drop across the arm impedance, the reference voltages for upper and lower arms \nof phase k,\n*\nukv and *\nlkv , are obtained as follows: \n ** 1\n2\ndc\nuk k\nvvv = −  (2.14) \n ** 1\n2\ndc\nlk k\nvvv = +  (2.15) \nLevel shifted modulation: Different modulation techniques, such as level-shifted PWM, \nphase shifted PWM, phase disposition PWM, selective harmonic elimination, space \nvector modulation (SVM), or nearest level modulation (NLM) have be en developed to \ncontrol MMCs [2.16]-[2.19].  \n \nFigure 2.6. Control diagram of three-phase input stage MMC controller. \n \nA level-shifted PWM strategy is used in this work [2.20]; see Figure 2. 6. The reference \nvoltages of phase arms are compared to n triangle carriers to generate the desired ( n+1) \noutput voltage levels. In this modulation technique the number of inserted SMs in upper \nand lower arms (n\nu and nl) are always controlled so that n SMS are inserted in each leg \nat any instant; therefore: \n ulnnn+=  (2.16) \nIf the MMC converter has n SMs in each arm (see Fig 2.2), then n in-phase carrier \nwaveforms are compared with the reference waveform of each phase as depicted in \nFigure 2.6. \nTable 2.1 shows the different generated level for output phase voltage of one leg [2.20] \nwhen the number of  SMs per arm is 6. Remember that to generate a 7 -level phase \nvoltage, the number of inserted SMs in upper and lower arms is always 6. \n \n \n \n-+\n- -\n+-\n+\n+\n*\n1dcv\n1dcv di\nqi\n*\ndv\ndv\nqv\n*\nqi\nqi\ndi\narmi cSMv\n*\nqv\ndq\nabc\n1 /2dcv\n*\nkv +− +\n+-\n+-\nMMC \nConverter\nCapacitor \nVoltage \nBalancing \nBlock\nLevel Shifted \nPWMPI PI\nPI\nωL\nωL\nChapter2: Modeling of a Three-stage MMC-based Solid State Transformer \n \n19 \n \n \nTable 2.1. Switching levels for each MMC leg \nLevel un  ln  kov  \n1 6 0 2\ndcV−  \n2 5 1 3\ndcV−  \n3 4 2 6\ndcV−  \n4 3 3 0 \n5 2 4 6\ndcV+  \n6 1 5 3\ndcV+  \n7 0 6 2\ndcV+  \n \nCapacitance balancing: Under practical conditions, the voltage of a SM capacitance \nchanges due to charging/discharging states, variation of current values and different \nconduction times of switches. This may lead to undesired consequences such as \nunbalanced voltages and higher harmonic distortion. Therefore, an algorithm for proper \ncapacitance voltage balancing must be used to keep the voltage of each arm at the \ndesired level.  \nThe sorting algorithm used in this work for SM capacitance voltage balancing is that \nproposed in [2.21]. Figure 2.7 shows the flowchart for the voltage balancing algorithm, \nbased on that proposed in [2.20] and [2.21]. \n \nFigure 2.7. Control block diagram and sorting algorithm for MMC converter. \n \nFiring signal generator\nFiring signals\nSwitching functions\nDetermine the number of required SMs in \nthe upper and lower arms (nu + nl = 6)\nModulating reference generator  \nnu nlSort\nvcu6 iukvcu2vcu1\nSort\nvcl6vcl2vcl1ilk\nCapacitance balancing block\nStandby state\nDischarging state : Find \nthe highest -voltage off \ncapacitor and connect it\nCharging state: Find the \nlowest-voltage off capa -\ncitor and connect it\nDischarging state : Find \nthe lowest-voltage on \ncapacitor and bypass it\nCharging state: Find the \nhighest-voltage on capa-\ncitor and bypass it\nMeasure arm \ncurrent\nMeasure arm \ncurrent\nAdd \nmodule\nRemove \nmodule\nAdvanced Modeling of Solid State Transformer \n \n20 \n \nAs shown in Figure 2.7, the algorithm block has three inputs : SM capacitor voltages of \neach MMC arm (which are monitored and sorted in descending order), the current \ndirection of each MMC arm (if the arm current is positive, it is then charging SMs, \nwhich are therefore increasing their voltages; if the arm current is negative, it is then \ndischarging SMs, which are therefore decreasing their voltages), and the level number \ndetermined by the level-shifted PWM technique (see Table 2.1).  \nBased on a sorting algorithm when the modulator decides to insert a SM, then SMs with \nminimum/maximum capacitor voltage will be inserted when the current \ncharges/discharges the corresponding capacitor. Every time the modulator decides to \nbypass a SM, it is the SM with maximum/minimum capacitor voltage that is bypassed \nwhen the current charges/discharges the capacitor. \n2.3. Isolation Stage: Configuration and Control \n2.3.1. Introduction \nThe model implemented for representing the isolation stage consists of three major parts \n(see Figure 2. 8): (1) a one -leg single -phase MMC that acts as inverter and generates \nn+1 level high -frequency input waveform to the HFT (in this work a 7- level, 1 kHz \nwaveform); (2) the HFT, modeled as an ideal transformer in series with its short- circuit \nimpedance; (3) a LV single -phase two-level full-bridge PWM converter that acts as a \nrectifier and provides the required dc link voltage for the output stage of the SST [2.22].  \nA short description of the control strategy implemented for the converters at each HFT \nside is given bellow. \n \nFigure 2.8. Isolation stage configuration. \n \n-\n+\nHigh Frequency \nTransformer (HFT)\npi si\nSa2 Da2\nSa1 Da1 Sa1 Da1\nSa1 Da1\nuii\nlii\n1iSM\n2iSM\nniSM\n1iSM\n2iSM\nniSM\niR\niL\niR\niL\nuiv\nliv\nvdc2\n+\n−\nvdc1/2\n+\n−\nvdc1/2\n+\n−\nLow Voltage Converter\nMedium Voltage MMC Converter\n+\n-\ntpv tsv\n+\n-\n+\n-\nChapter2: Modeling of a Three-stage MMC-based Solid State Transformer \n \n21 \n \n2.3.2. Single-phase MMC \nThe control strategy implemented for this single -phase converter is similar to that \ndiscussed in the previous subsection. An open -loop level -shifted PWM and a sorting \nalgorithm h ave been used for controlling the single -phase MMC. The ac reference \nvoltage,\n*\ntpv , can be expressed as follows: \n ( )\n* 1 sin 22\ndc\ntp a h\nvv m ft= p  (2.17) \nwhere ma is the modulation index of inverter, vdc1 is the dc link voltage at the MV side \nof the SST, and fh is the operating frequency of the HFT.  \nThe upper and lower arm reference voltages, *\nuiv  and *\nliv , are obtained as follows: \n ( )( )\n* 1 1 sin 22\ndc\nui a h\nvv m ft= −p  (2.18) \n ( )( )\n* 1 1 sin 22\ndc\nli a h\nvv m ft= + p  (2.19) \nThe level shifted PWM strategy is used to determine the number of SMs to be inserted \nor bypassed in each arm (nu and nl in Table 2.1); after that, the sorting algorithm is used \nto balance capacitance voltages of SMs and generate gate signals (as shown in Figure \n2.7).  \n2.3.3. High-frequency transformer \nThe high frequency transformer (HFT) is required to achieve electric isolation. It also \nhas to allow large voltage and current ratios between input and output. The usage of a \nHFT in the SST is the main reason for size reduction in comparison with the \nconventional transformers operating at power frequency (i.e. 50 -60 Hz). Therefore, a n \noptimized design of HFT in DAB is necessary to utilize the advantages of SST [2.23].  \nMany design considerations and challenges should be taken in to account in order to \nsatisfy high -voltage, high- power and high- frequency operation of isolation- stage \ntransformer. The first challenge is the selection of the magnetic material which should \nbe adequate for providing high power density and low loss. The second challenge is the \nconfiguration of core and windings since they will have a considerable effect on the  \nefficiency at high frequency. The third challenge is the thermal design which should \navoid the breakdown of the device in high- voltage and high-power application. Finally, \ninsulation requirement is very important in high- voltage application and compact \ndesign, mainly when the oil is eliminated [2.24]. Papers [2.25]-[2.29] present the design \nand optimization of transformers for SST applications.  \n2.3.4. Single-phase two-level full-bridge converter \nThe LV single -phase two-level bridge rectifies the output current of the HFT ( is) and \ncontrols the LV -side dc link voltage ( vdc2) at the desired value. The diagram of the \ncontroller is shown in Figure 2.9 [2.30] -[2.31]. The dc link voltage v dc2 is compared to \nAdvanced Modeling of Solid State Transformer \n \n22 \n \nits reference value and the resulting error is applied to a PI  controller. The output signal \nof PI controller is used to generate the reference current ( *\nsi ). \n \nFigure 2.9. Diagram of the single-phase isolation stage MMC controller. \n \nThe error ( *\nssii − ) is applied to a PR controller to generate the reference value for PWM \nblock. The PR technique can successfully replace the typical PI -dq control scheme for \nthree-phase systems exhibiting some advantages (e.g., improved harmonic rejection \ncapability). In addition, a PR controller can provide a fast control with a structure \nsimpler than other controllers such as PI control, hysteresis current control and \npredictive current control. A bidirectional PWM technique is applied to generate \nswitching pulses [2.30]-[2.31]. \n2.4. Output Stage: Configuration and Control \n2.4.1. Introduction \nFour-leg converter topology is an efficient choice for applications that require accurate \ncontrol for neutral current, controlled rectifier. Adding an extra leg provides a degree of \nfreedom and better control capability i n comparison with conventional three- leg \nconverter [2.32]-[2.33]. \nIn this thesis a three-phase four-leg PWM converter is proposed for the LV side of the \nSST, with an RL  impedance for filtering currents and a capacitor bank f or filtering \nvoltages, see Figure 2.10. \n \nFigure 2.10. Low-voltage side converter configuration. \n \nThe main task of LV -side converter controllers is to achieve positive -sequence \ncapacitor voltages (i.e., to obtain balanced voltages at capacitor terminals) w ith stable \nfrequency and voltage, independently of the load/generation level and the unbalance of \nLV-side currents. Each positive -, negative - and zero -sequence has its corresponding \ncontroller; negative- and zero-sequence capacitor voltage references are permanently set \n++-\n-\n*\n2dcv\n2dcv sv\n*\nsi\nsi\n,12SSab\n21,abSS\nPRPI PWM\nvdc2 Cdc2\nLoad / Generation\nidc2\na2\nb2\nc2\np2\nn2\nip2\niC2\nf\nL2ia2\nib2\nic2\nR2\nC2\nN2\nv2agrid\nv2bgrid\nv2cgrid\nia2I\nib2I\nic2I\nin2 Ln2Rn2\nInverter\nChapter2: Modeling of a Three-stage MMC-based Solid State Transformer \n \n23 \n \nto zero to cancel these components at the filter capacitor terminals, even in presence of \nunbalanced load/generation currents. The positive -sequence voltage controller regulates \nthe filter capacitor voltages. \nDifferent types of load/generation including nonlinear load which generate harmonics, \ntwo phase load/generation which is unbalanced load can be connected to this converter. \nMoreover, short circuit fault may occur at the terminal of load. Thus, a universal PWM \ncontrol strategy using VOC has been implemented for this converter in order to provide \nefficient voltage and current at the secondary side of SST in different types of transient \nstates, load connection or fault conditions.  \nThe converter model and its control strategy developed for this work are discussed in \ndetail, bellow. \n2.4.2. Mathematical model \nThe implemented VC method is aimed at  generating proper references for three \ndimensional SVM (3- D SVM) modulation technique. The control model considers \npositive-, negative-, and zero-sequences [2.34]: \n \n2 2\n22 2 2 2\n22\n2 2\n22 2 2 2\n22\n1 (v v )\n1 (v v )\ndp\nq p d p d pconv d pgrid\nqp\nd p q p q pconv q pgrid\ndi Riidt L L\ndi Riidt L L\nω\nω\n= −+ −\n= −− + −\n (2.20a) \n \n22\n22 2 2 2\n22\n2 2\n22 2 2 2\n22\n1 (v v )\n1 (v v )\ndn\nq n d n d nconv d ngrid\nqn\nd n q n q nconv q ngrid\ndi Riidt L L\ndi Riidt L L\nω\nω\n= −− + −\n=−+ −\n (2.20b) \n 0 22\n2 00\n22 22\n31 (v v )33\nn\nd n conv grid\nnn\ndi R R id t LL LL\n+=−+ −++  (2.20c) \n \n2\n22 2 2\n2\n2\n22 2 2\n2\n1 ()\n1 ()\nd pgrid\nq p d p d lp\nq pgrid\nd p q p q lp\ndv v iidt C\ndv v iidt C\nω\nω\n= +−\n= −+ −\n (2.20d) \n \n2\n2 2 2 2ln\n2\n2\n2 2 2 2ln\n2\n1 ()\n1 ()\nd ngrid\nqp dn d\nq ngrid\nd p qn q\ndv v iidt C\ndv v iidt C\nω\nω\n= −+ −\n= ++ −\n (2.20e) \n 0\n00\n2\n1 ()\ngrid\nl\ndv iidt C = −  (2.20f) \nwhere id2p, iq2p are the positive -sequence LV-side converter currents in the rotating  dq \nframe; id2n, iq2n are the negative-sequence LV-side converter currents in the rotatin g dq \nframe; i0 is the zero -sequence LV -side converter current; i d2lp, iq2lp are the positive -\nAdvanced Modeling of Solid State Transformer \n \n24 \n \nsequence LV -side load/generation currents in the rotating dq frame; id2ln, iq2ln are the \nnegative-sequence LV-side load/generation currents in the rotating  dq frame; i0l is the \nzero-sequence LV -side load/generation current;  vd2pconv, vq2pconv are the positive -\nsequence converter voltages in the rotating dq frame; vd2nconv, vq2nconv are the negative-\nsequence converter vo ltages in the rotating  dq frame; v0conv is the zero -sequence \nconverter voltages; vd2pgrid, vq2pgrid are the positive -sequence capacitor filter voltages in \nthe rotating dq frame; vd2ngrid, vq2ngrid are the negative-sequence capacitor filter voltages \nin the rotating dq  frame; v0grid is the zero -sequence capacitor filter voltage;  ω2 is the \nLV-side grid angular frequency; R 2 is the LV -side filter resistance; L 2 is the LV -side \nfilter inductance; R n2 is the LV -side neutral connection resistance; L n2 is the LV -side \nneutral connection inductance. \n2.4.3. VOC design for a four-leg converter \nIn this section the aim is to design a comprehensive  control strategy for four leg \nconverter in order to have efficient performance in case of load increment, short circuit \nfault, unbalanced and nonlinear load connection at the output stage of SST. To achieve \nthis control strategy, the procedure of control design will be studied separately for two \ncase studies: unbalanced and nonlinear load connection. Finally, the comprehensive  \ncontrol strategy will be presented by combining these two control strategies. \nSelective harmonic voltage compensation : In this work, an harmonic voltage \ncompensation capability has been added to achieve an efficient performance of SST \nwhile connected to nonlinear load that draw currents whose frequencies differ from the \nfrequency of the source. \nIt must be assumed by default that any h armonic distortion in the output currents is due \nto nonlinear loads supplied from the LV terminal of the SST; that is, nonlinear loads \nwill draw currents whose frequencies differ from the system frequency. Because the \nharmonic currents are a result of the nature of the loads, it is appropriate to consider the \nload to be a source of harmonic current. As this harmonic components are injected back \ninto the SST, they cause voltage drops (at the corresponding frequencies), creating \nvoltage distortion in the output voltages. This voltage distortion is a direct function of \nthe current harmonic component magnitudes and the equivalent impedance of the SST \noutput stage. Since the SST load can include linear and nonlinear loads, the harmonic \nvoltage distortion caused b y nonlinear loads can affect the behavior of linear loads; \ntherefore, the goal is to obtain undistorted SST output voltages. Problems caused by \nharmonic currents and voltages can be solved using different solutions, depending on \nthe source of the problem a nd the affected equipment. The solutions can be classified \ninto the following groups: solutions to avoid harmonic generation (e.g., by means of \nsome control strategies), solutions to tolerate harmonics (e.g., larger conductors, power \nequipment de -rating), and solutions to reduce harmonics (e.g., passive and active \nfilters). In this work, the harmonic compensation control strategy has been selected.  \nAssume the three-phase nonlinear load (in this work three phase diode rectifier) creates \nharmonics at frequen cies (6n\n ± 1)ω, where n is any positive, real integer and ω is the \nfundamental system frequency. It should be noted that that all (6 n+1)ω harmonics are \npositive sequence, and all (6n−1)ω harmonics are negative sequence [2.35].  \nA selective harmonic elimination control strategy can be implemented to compensate \nvoltage harmonics. Since 5th and 7th harmonics are dominant harmonics and, in \ngeneral, other harmonics can be neglected, the implemented control strategy is \nChapter2: Modeling of a Three-stage MMC-based Solid State Transformer \n \n25 \n \ncomposed of a ne gative sequence 5th harmonic controller  and a positive s equence 7th \nharmonic controller. \nFigure 2.11 displays this control strategy for the 5th and 7th harmonics: the three phase \ndiode rectifier which is selected as nonlinear load in our work, draws nonlinear currents \nwhich can lead to harmonics distortion in load voltage with (6n  ± 1)ω, most dominantly \n5th and 7th  harmonics order. In order to compensate the harmonics of load voltage, \nspecific voltage control loop should be selected for each harmonic order. For selective \nharmonic compensation (see F igure 2.19): voltage at the terminal of the load measured \nin abc plane is transformed to αβ  plane, then the transformed signal is compared with \nreference value (pure sinusoidal signal with fundamental frequency) and harmonics \nvalues are extracted in αβ plane. Regarding to order of harmonic compensation, the \nextracted error signal will be transfo rmed to dc signals in dq plane with transformation \nangle of –(6n−1)θ and +(6n+1)θ for negative and positive sequence harmonic order, \nrespectively. θ is the angular fundamental frequency. The resulted dc signals are passed \nthrough PI controllers to generate  reference signals for input current controllers of four \nleg converter. \nControl loop for harmonic compensation of voltage should be created in parallel with \npositive fundamental frequency control loop of voltage. The output signals of the \nvoltage control block for 1st, 5th and 7th harmonics are added to form the reference \nsignal for current controllers as it can be seen from Figure 2.11 [2.36]-[2.37]. \nFor output current control the generated reference signals from voltage controllers \nwould be compared by re al value of current in αβ  plane and passed through PR \ncontrollers both for fundamental and harmonic components. Figure 2.12 shows the \npositive sequence control diagram with the capability of harmonic voltage \ncompensation for output stage of SST. \n \nFigure 2.11. Control block diagram for harmonic compensation. \n \nControl design  for unbalanced load connection : As it can be observed from  Figure \n2.10, in four leg converter topology, fourth wire connects midpoint of fourth leg to the \nneutral point of load. The load unbalance such as two phase load connection leads to \n*\n7iα\n*\n7iβ\ndq\nαβPI\nPIαβ\ndq\n7+q7+q\n-+\n*\nVβ\nvβ\n-+\n*\nVα\nvα\n*\n5iα\n*\n5iβ\ndq\nαβPI\nPIαβ\ndq\n5−q5−q\n-+\n*\nVβ\nvβ\n-+\n*\nVα\nvα\n2abcgridv\nabc\nαβ\nAdvanced Modeling of Solid State Transformer \n \n26 \n \nfollowing of current in fourth wire and voltage drop which makes the load voltage \nasymmetrical. An improved control strategy should be applied in order to provide \nbalanced voltages during the load unbalance. \n+-\n2 piα\n1\n22\ni\np\nKsK s ω+ +\n*\npiα\n22 ()\nin\np\nKsK sn ω+ +\n+-\n2 piβ\n1\n22\ni\np\nKsK s ω+ +\n*\npiβ\n22 ()\nin\np\nKsK sn ω+ +\n++\n++ ++\n+\n2 pgridVβ\n+-\n+\n2 pgridVα\nVSI pv α\nVSI pv β\n+-*\n2d pgridV\n2d pgridV\n+-\n*\n2q pgridV PI\nPI +-\n+\n2d lpi\n2q pgridCVω\n+-\n+\n2q lpi2q pgridV\ndq\nαβ\n++\n+\n*\n5iα\n*\n7iα\n++\n+\n*\n5iβ\n*\n7iβ\n2d pgridCVω\n2 pLiβω\n2 pLiαω\n*\n2 piα\n*\n2 piβ\n*\n2dpi\n*\n2qpi\n \nFigure 2.12. Positive sequence control diagram. \n \nIt should be noted that, in three- phase VSI control, the  d and q channels are used to \ncompensate for the rotating components (positive sequence) of the output variables \n(voltage and current).  \nIn the control strategy implemented for our work, the variables (output currents and \nvoltages) are decomposed to positi ve, negative and zero sequence. Then, the negative \nand zero sequence controllers will be added to positive sequence controllers in control \nblock, to eliminate the negative and zero sequence distortions [2.38]. \nIn conventional control strategy of the four -leg inverter, dq0-component of voltage and \ncurrent in reference frame rotating at fundamental frequency are used. If the load is \nbalanced, the d-and q-components are dc quantities and the 0-component is zero.  \nIf the load is unbalanced, both d-  and q-components contain an additional ac quantity, \nwhich oscillates with the double frequency of the output voltage. The 0- component is \nnot zero and oscillates with the same frequency as the output voltage [2.39]. \nIn order to control the negative and zero sequence component of current and voltage \nwhich are created due to unbalanced condition, the current and voltage should be \ntransformed into three symmetrical components: positive sequence, negative sequence, \nand zero sequence. Then, the corresponding controllers are applied to each positive -, \nnegative- and zero-sequence; negative- and zero-sequence capacitor voltage references \nare permanently set to zero to cancel these components at the filter capacitor terminals \nin presence of unbalanced load/generation currents.  \nThe positive-sequence voltage controller regulates the filter capacitor voltages. Figure \n2.13 shows the control ler that includes control blocks for positive, negative and zero \nsequence, respectively. \nAs it can b e observed from this figure , the voltage and current signals which are \nachieved after decomposition into symmetrical components and projection into rotating \nreference frame are regulated in an inner current loop and an outer voltage loop.  \nBoth outer volta ge loops and inner current loops  are disposed in a three -channel \narrangement. The first channel allows controlling the positive sequence of the current \nand voltage (see Figure 2.12) , the second is for the negative sequence, and the third is \nfor the homopolar sequence [2.34]. \nChapter2: Modeling of a Three-stage MMC-based Solid State Transformer \n \n27 \n \n \nFigure 2.13. Total VOC control diagram for output stage of SST. \n \n2.4.4. Modulation technique \nTwo-dimensional space vector modulation (SVM) strategy has been used in many \nstudies for three -leg voltage source inverter [2.40] -[2.42]. This modulation uses eight \nswitching vectors (two zero and six nonzero switching vectors) in 2- D hexagon in αβ  \ncoordinates. First, the region where voltage vector exist s is determined and then the \ndesired voltage is generated by switching active and zero v ectors in each specified \nregion.  \nAdding a fourth leg to a conventional three-leg converter changes the space vector from \ntwo dimensions to three dimensions, so the modulation technique becomes more \ncomplex. In this work, a 3- D SVM modulation strategy has been implemented in abc  \ncoordinates. This modulation technique is presented in [2.43] -[2.44].  The advantage of \nusing abc coordinates are a much simpler algorithm and a reduced computational time, \nsince there is no need for transformation.  \nFour leg converter has sixteen switching vectors combinations which are given in Table \n2.2. For more simplicity the nominal output voltage vectors (Vaf, Vbf, Vcf) are normalized \nwith Vdc2. Sa, Sb, Sc and Sf are the gate signals of upper switch which are equal to 0 when \nupper switches are off and 1 when upper switches are on. It should be noted that dead \ntimes are not included in this strategy. \nSixteen switching vectors that form control region for four leg c onverter are all in the \nvertices of two cubes. Vectors  V\n1 through V8 are placed in the positive region, while  \nvectors V9 trough V16 are placed in the negative region forming a dodecahedron in abc \ncoordinates. \n \n2 piβ 1\n22\ni\np\nKsK s+ +ω*\npiβ\n22 ()\nin\np\nKsK sn+ +ω\n2 pgridVβ\nVSI pv β\n*\n5iβ\n*\n7iβ 2 pLiαω\n*\n2 piβ\n+\n+\n-\n++-++\n++\n2 piα 1\n22\ni\np\nKsK s+ +ω*\npiα\n22 ()\nin\np\nKsK sn+ +ω\n2 pgridVα\nVSI pv α\n*\n5iα\n*\n7iα\n2 pLiβω\n*\n2 piα\n+\n+\n-\n++-++\n++\n*\n2d pgridV\n2d pgridV\nPI\n2d lpi\n2q pgridCVω\n*\n2dpi\n-\n++-+\n*\n2q pgridV\n2q pgridV\nPI\n2q lpi\n2d pgridCVω\n*\n2qpi\n-\n++-+\n*\n2 0d ngridV =\n2d ngridV\nPI\n2lndi\n2q ngridCVω\n*\n2dni\n-\n++-+\n*\n2 0q ngridV =\n2q ngridV\nPI\n2lnqi\n2d ngridCVω\n-\n++-+\n+ PI\n2d ngridv\n-\n++\n2dni 2qnLiω\n-\n*\n2qni\n+ PI\nVSIqnv\n2q ngridv\n+\n++\n2qni 2dnLiω\n-\n++ αβγ\nabc\n*\n02 0d pgridV =\n02d pgridV\nPI\n02d lpi\n02q pgridCVω\n*\n02dpi\n-\n++-+\n*\n02 0q pgridV =\n02q pgridV\nPI\n02q lpi\n02d pgridCVω\n+\n++-+\n+ PI\n02d pgridv\n-\n++\n02dpi 02qpLiω\n-\n*\n02qpi\n+ PI\n02q pgridv\n+\n++\n02qpi 02dpLiω\n-\nVSIdnv\nndq −\nαβ\ndq p−\nγ\ndq\nαβ\nαβ\nabcV\n2\n1\ndcV SVM\nAdvanced Modeling of Solid State Transformer \n \n28 \n \n \nTable 2.2. Switching table of the four-leg converter \nSwitching \nstate fS  aS  bS  cS  afV  bfV  cfV  Switching \nvector \n1 0 0 0 0 0 0 0 1V  \n2 0 0 0 1 0 0 1 2V  \n3 0 0 1 0 0 1 0 3V  \n4 0 0 1 1 0 1 1 4V  \n5 0 1 0 0 1 0 0 5V  \n6 0 1 0 1 1 0 1 6V  \n7 0 1 1 0 1 1 0 7V  \n8 0 1 1 1 1 1 1 8V  \n9 1 0 0 0 -1 -1 -1 9V  \n10 1 0 0 1 -1 -1 0 10V  \n11 1 0 1 0 -1 0 -1 11V  \n12 1 0 1 1 -1 0 0 12V  \n13 1 1 0 0 0 -1 -1 13V  \n14 1 1 0 1 0 -1 0 14V  \n15 1 1 1 0 0 0 -1 15V  \n16 1 1 1 1 0 0 0 16V  \n \nTwo switching vectors, V 1 and V16, are zero switching vectors (ZSV) while the \nremaining vectors ( V2 – V15) are nonzero switching vectors (NZSV). All these vectors \ndivide the control region into 24 tetrahedrons, with three non -zero switching vectors \nalong with the zero switching vector. \nThe tetrahedron in which the reference vector is included can be selected using: \n \n6\n( 1)\n1\n12 i\ni\ni\nRP c −\n=\n= + ∑  (2.21) \nwhere ci (i = 1- 6) can be achieved as: \n \n1\n2\n3\n4\n5\n6\n(INT(V 1))\n(INT(V 1))\n(INT(V 1))\n(INT(V V 1))\n(INT(V V 1))\n(INT(V V 1))\naref\nbref\ncref\naref breff\nbref creff\naref creff\nc sign\nc sign\nc sign\nc sign\nc sign\nc sign\n= +\n= +\n= +\n= −+\n= −+\n= −+\n (2.22) \nVaref, Vbref, and Vcref are normalized reference voltages. \nAll the 24 tetrahedrons, with their RP indexes, and the three nonzero switching vectors \nare given in Table 2.3. \nChapter2: Modeling of a Three-stage MMC-based Solid State Transformer \n \n29 \n \nTable 2.3. Region pointer for 24 tetrahedrons and their corresponded non-zero switching vectors \n \nRP  1dV  2dV  3dV  RP  1dV  2dV  3dV  \n1 9V  10V  12V  41 9V  13V  14V  \n5 2V  10V  12V  42 5V  13V  14V  \n7 2V  4V  12V  46 5V  6V  14V  \n8 2V  4V  8V  48 5V  6V  8V  \n9 9V  10V  14V  49 9V  11V  15V  \n13 2V  10V  14V  51 3V  11V  15V  \n14 2V  6V  14V  52 3V  7V  15V  \n16 2V  6V  8V  56 3V  7V  8V  \n17 9V  11V  12V  57 9V  13V  15V  \n19 3V  11V  12V  58 5V  13V  15V  \n23 3V  4V  12V  60 5V  7V  15V  \n24 3V  4V  8V  64 5V  7V  8V  \n \nAfter selecting the NZSV, the next step is to perform the proper switching pattern \nwhich is based on minimum commutation that leads to lower switching loss. According \nto this switching strategy, the ZSV is selected Always as the vector V\n1 (Vd0 = V1) and \napplied at the beginning and the end of switching period. Then, the three NZSV are \ndistributed symmetrically along the middle of the switching period, in th e order \nspecified in Table 2.3. \nThe duty cycles for output desired voltages can be achieved as shown below: \n \n123\n123\n123\n1\n2\n3\n0 123., 1\naref\nref bref\ncref\nd ad ad a\nd d bd bd b\nd cd cd c\nref d\nV\nVV\nV\nVVV\nM VVV\nVVV\nd\ndd\nd\nV M dd d d d\n\n=\n\n\n\n=\n\n\n=\n\n= = −−−\n (2.23) \nwhere d1, d2, and d 3 are the duty ratios of the switching vectors , Vd1, Vd2, Vd3, \nrespectively, and d0 is duty ratio of the zero switching vector.  \nThere are 24 different matrices [ M3×3] corresponding to the 24 tetrahedrons which are \nsaved as a look-up table along with three corresponding vectors.  \nAll elements of matrix  Md, in abc coordinates, are 0, 1, or − 1. Therefore, all the \nelements in 1\ndM − are 0, 1, or −1 as well.  \nAdvanced Modeling of Solid State Transformer \n \n30 \n \nTable 2.4 gives the calculated duty cycles for all 24 tetrahedrons. Once the duty cycles \nare obtained, the switching intervals can be calculated as T  times di, where T  is the \ncommutation period. The table summarizes all the information required for duty cy cles \nfor different 24 tetrahedrons by considering to their region pointer and their values. \nThree NZSV along with one ZSV are applied in one fundamental period. \nTable 2.4. Calculation of duty cycles \n \nRP  1dV  2dV  3dV  1d  2d  3d  \n1 9V  10V  12V  crefV−  bref crefVV−+  aref brefVV−+  \n5 2V  10V  12V  crefV  brefV−  aref brefVV−+  \n7 2V  4V  12V  bref crefVV−+  brefV  arefV−  \n8 2V  4V  8V  bref crefVV−+  aref brefVV−+  arefV  \n9 9V  10V  14V  crefV−  aref crefVV−+  aref brefVV −  \n13 2V  10V  14V  crefV  arefV−  aref brefVV −  \n14 2V  6V  14V  aref crefVV−+  arefV  brefV−  \n16 2V  6V  8V  aref crefVV−+  aref brefVV −  brefV  \n17 9V  11V  12V  brefV−  bref crefVV −  aref crefVV−+  \n19 3V  11V  12V  brefV  crefV−  aref crefVV−+  \n23 3V  4V  12V  bref crefVV −  crefV  arefV−  \n24 3V  4V  8V  bref crefVV −  aref crefVV−+  arefV  \n41 9V  13V  14V  arefV−  aref crefVV −  bref crefVV−+  \n42 5V  13V  14V  arefV  crefV−  bref crefVV−+  \n46 5V  6V  14V  aref crefVV −  crefV  brefV−  \n48 5V  6V  8V  aref crefVV −  bref crefVV−+  brefV  \n49 9V  11V  15V  brefV−  aref brefVV−+  aref crefVV −  \n51 3V  11V  15V  brefV  arefV−  aref crefVV −  \n52 3V  7V  15V  aref brefVV−+  arefV  crefV−  \n56 3V  7V  8V  aref brefVV−+  aref crefVV −  crefV  \n57 9V  13V  15V  arefV−  aref brefVV −  bref crefVV −  \n58 5V  13V  15V  arefV  brefV−  bref crefVV −  \n60 5V  7V  15V  aref brefVV −  brefV  crefV−  \n64 5V  7V  8V  aref brefVV −  bref crefVV −  crefV  \n \nFigure 2.14 shows the switching pattern in region number 13. As it can be observed \nfrom figure, ZSV is applied at the be ginning and the end of the period and three NZSV \nare applied symmetrically in the middle. d\n1, d2 and d3 are referred to NZSV duty cycles \nand d0 is referred to ZSV duty cycle. \nChapter2: Modeling of a Three-stage MMC-based Solid State Transformer \n \n31 \n \n \nFigure 2.14. duty cycle of output voltages [2.43]. \n \n2.5. Modeling of Semiconductor Losses \n2.5.1. Introduction \nThis section presents the approaches  followed for implementing losses in \nsemiconductor models. The first part of the section details the calculation of the various \ntypes of losses t hat can occur in semiconductors;  the second part illustrates the way in \nwhich these losses are included in IGBT and diode models ; the last part presents some \nsimulation results . The loss calculation of any semiconductor involves the usage of a \nthermal model to estimate the semiconductor junction temperature; therefore, the \nsection also includes a part aimed at detailing the implementation of semiconductor \nthermal models as part of loss calculations. \n2.5.2. Loss calculation \nThere are three types of power losses in semiconductor devices: conduction losses, \nswitching losses, and blocking losses. In general, blocking losses can be neglected, so \ntotal semiconductor losses may consist of conduction and switching losses [2.45] -\n[2.46]. \nConduction losses: Conduction losses for IGBT and diodes (DP\nconS/D) can be estimated \nas follows: \n ( )/ // ()conS D con S D S DP v ti tD= ×  (2.24) \nwhere vconS/D is the forward semiconductor voltage in conduction mode , and iS/D is the \ncurrent through the semiconductor.  \nIn this work, vconS/D is obtained from manufacturer’s datasheet by using 2 -D look up \ntable with 2 inputs: i S/D and TjS/D, the semiconductor junc tion temperature derived from \nits thermal model. Figure 2.15 shows the model for calculation of conduction losses. \n0\n1\ndV\nV\n1\n3\ndV\nV\n2\n4\ndV\nV\n3\n12\ndV\nV\n2\n4\ndV\nV\n0\n1\ndV\nV\n1\n3\ndV\nV\n0\n2\nd 1\n2\nd 2\n2\nd 2\n2\nd 1\n2\nd 0\n2\nd\n3d\nT\nAdvanced Modeling of Solid State Transformer \n \n32 \n \n \nFigure 2.15. Calculation of semiconductor conduction losses. \n \nSwitching losses: These losses can be classified into two groups: turn- on and turn- off \nlosses. In general, turn- on losses are neglected for diodes. On the other hand, diode \nturn-off losses are known as reverse recovery los s. The procedure for implementing  \neach type of loss is detailed below [2-47]-[2-50].  \nIGBT switching losses : Switching losses  occur in IGBTs during turn-on and turn- off \ncommutations. The values of these energy losses can be obtained as follows: \n ( ) ( )\nontt\nonsw CE St\nE v t i t dt\n+\n= ×∫  (2.25) \n ( ) ( )\nofftt\noffsw CE St\nE v t i t dt\n+\n= ×∫  (2.26) \nwhere Eonsw and Eoffsw are respectively turn -on and turn- off energy losses, v CE is the \nvoltage across the IGBT, while t on and toff are respectively the tu rn-on and turn-off \ncommutation time periods.  \n \nFigure 2.16. Calculation of IGBT switching losses. \n \nFigure 2.16 shows the procedure to obtain total IGBT switching losses, ∆ P\nsw, from \nmanufacturer datasheet. As shown in the figure, the 3D look up table provides the E onsw \nand Eoffsw using pre - and post -switching values of current and voltage obtained by \ninterpolating the Eon/offsw - iS curves available in manufacturers’ datasheets. \n• To obtain Eonsw, three input values must be specified: the pre-switching value of the \nvoltage between IGBT collector and emitter, vCE, the post -switching value of the \nIGBT current, iS, and the junction temperature of IGBT, TjS. \n• To obtain Eoffsw, three input values must be specified: the pre-switching value of the \nIGBT current, i S, the post -switching value of the voltage between IGBT collector \nand emitter, vCE, and the junction temperature of IGBT, TjS. \n/conS Dv /conS DPD2D lookup \ntable from \nmanufacturer \ndatasheet\nIGBT/Diode current iS/D\nJunction temperature TjS/D\nPre-switching value of vCE\n3D lookup \ntable from \nmanufacturer \ndatasheet\nPost-switching value of iS\nJunction temperature TjS\nPost-switching value of vCE\n3D lookup \ntable from \nmanufacturer \ndatasheet\nPre-switching value of iS\nJunction temperature TjS\nonswPD\nonswE\n×\n÷\nswPD\ntD\noffswE\n×\n÷tD\n++\noffswPD\nChapter2: Modeling of a Three-stage MMC-based Solid State Transformer \n \n33 \n \nTurn-on and turn -off commutation periods of actual IGBTs will be in general different \nto the time step used in simulations. Switching power losses are averaged at the \nbeginning and the end of a switching period: t urn-on switching losses, ∆Ponsw, and turn-\noff switching losses, ∆ Poffsw, are obtained after dividing turn- on and turn- off energy \nlosses by the simulation time step, Dt (see Figure 2.16 and reference [2.47]): \n onsw\nonsw\nEP tD = D\n (2.27) \n \noffsw\noffsw\nEP tD= D  (2.28) \nWith this approach, energy loses are correctly calculated, but instantaneous switching \npower losses are not. In this paper the simulation time step is 1μs. \nDiode switching losses : As for IGBTs, d iode reverse recovery losses, ∆ PrecD, are \nderived from the reverse recovery energy losses, ErecD. The value of these losses during \nthe reverse recovery time, trec, can be obtained as follows: \n ( ) ( )\nrectt\nrecD D Dt\nE v t i t dt\n+\n= ×∫  (2.29) \nwhere vD is the post-switching voltage across the diode. \nFigure 2.17 shows the procedure for calculation of diode reverse recovery losses. First, \nthe reverse recovery energy of diode, E recD, is obtained from a 3- D lookup table from \nmanufacturer datasheet; then, the reverse recovery losses, ∆ PrecD, are averaged after \ndividing ErecD by the simulation time step: \n recD\nrecD\nEP tD= D\n (2.30) \nNote that to obtain E recD it is necessary to specify the pre- switching value of the diode \ncurrent, iD, the post -switching value of the diode voltage, v D, and the diode junction \ntemperature, TjD. \n \nFigure 2.17. Calculation of diode switching losses. \n \n2.5.3. Loss implementation in semiconductor models \nConduction losses: According to equations (2.24) and Figure 2.15, conduction losses of \nIGBTs and diodes can be obtained from vconS/D and iS/D. Therefore, conduction losses, \nDPconS/D, can be in corporated into the semiconductor models  by means of a controlled \nvoltage source (with a value equal to v conS/D) in series with the ideal semiconductor, \neither IGBT or diode; see Figures 2.18 and 2.19. \nPre-switching value of vD\n3D lookup \ntable from \nmanufacturer \ndatasheet\nPost-switching value of iD\nJunction temperature TjD\nrecDE\n×\n÷tD\nrecDPD\nAdvanced Modeling of Solid State Transformer \n \n34 \n \nSwitching losses: Two different approaches have been used to inject switching losses: \n(i) the “instantaneous injection” approach used for LV -side semiconductors; (ii) the \n“average injection” approach used for MV-side semiconductors. \nApproach 1:  Switching losses in LV semiconductors are implemented by means of \ncontrolled sources as follows [2.51]: \n• Instantaneous IGBT turn-on switching losses, ∆Ponsw, are incorporated by means of \na series-connected controlled voltage source, whose value v sw1 is obtained from the \nfollowing equation: \n 1\nonsw\nsw\nS\nPv i\nD=  (2.31) \n• Instantaneous IGBT turn-off switching losses, ∆Poffsw, are incorporated by means of \na parallel-connected controlled current source, whose value  isw is obtained from the \nfollowing equation: \n \noffsw\nsw\nCE\nPi v\nD=  (2.32) \n• Reverse recovery diode losses, ∆ PrecD, are incorporated by means of a parallel -\nconnected controlled current source, whose value i recD is obtained from the \nfollowing equation: \n recD\nrecD\nD\nPi v\nD=  (2.33) \nFigure 2.18 shows the combined model of an IGBT and an antiparallel diode that results \nfrom the implementation of this approach. \n \nFigure 2.18. Loss model for a combination of LV IGBT and antiparallel diode – Approach 1. \n \nApproach 2: The representation of MV semiconductor switching losses in a single \nsimulation time step, as described above, will usually give high (or very high) values for \nthe controlled voltage source. Since the capacitance of MMC SMs is in series with this \nvoltage source during turn- on time, SM capacitance voltages can get distorted, create \nunwanted transient conditions , and lead to unstable MMC performance [ 2.52]-[2.55]. \nTo overcome this problem, the switching losses are represented as a form of conduction \nlosses in several time steps, as proposed in [2.55].  \n+\n−\n+\n+\n−Ideal Switch\nIdeal Diode\nconSv\nSi\nDi\n1swv +\nconDv\nswi recDi\n+\n−\nChapter2: Modeling of a Three-stage MMC-based Solid State Transformer \n \n35 \n \nWith this approach, smaller values will result for controlled voltage sources ; this will \nsolve the capacitance balancing problem issue in MMC converters and also have the \ncapability to properly inject calculated losses in an average manner. The \nimplementation of controlled voltage sources for injection of losses in IGBT and diode \nare shown in Figure 2.19.a and 2.19.b, respectively.  \n \na) IGBT \n \nb) Diode \n \nc) Average loss model for a combination of MV IGBT and antiparallel diode \nFigure 2.19. MV semiconductor loss models – Approach 2. \n \nThe values of the instantaneous total losses of IGBTs and diodes, DPtotS and DPtotD, are \nderived as shown below: \n totS conS onsw offswPPP PD =D +D +D  (2.34) \n totD conD recDPP PD =D +D  (2.35) \nThese values are injected by means of a constant controlled voltage source in series \nwith either an IGBT or a diode, and whose value is selected as a percentage, k S/D, of the \nSM capacitance voltage, see Figure 2.19. This means that t he controlled voltage source \nCEv\nSi\n× +\n+\n+\n+\ntotSPD\n≤\n×\ngate\nswSv×\nS cSMkv ×Memory\nMemory\n0Di >\nDv\nDi\n× +\n+\n+\n+\ntotDPD\n≤\n×\nrecDv×\nD cSMkv ×Memory\nMemory\n+\n−\n+\n−\nIdeal Switch\nIdeal Diode\nSI DI\nconDV\n+\n+\nrecDV\n+\n+\nswsV\nconsV\nAdvanced Modeling of Solid State Transformer \n \n36 \n \nremains in conduction during a period whose number of time steps is determined by the \nvalue of the selected percentage, k . As mentioned above, the goal is to obtain a low \nvoltage value for the controlled source and prevent a ne gative impact on capacitance \nvoltage balancing.  \n2.5.4. Thermal model \nSemiconductors losses acts as a source of heat that affects the junction temperature, \nwhose value will affect semiconductor losses. Therefore, semiconductor thermal models \nare required for estimating the temperatures that can be reached in IGBTs and diodes, as \nwell as to asses the losses that can be produced [ 2.56]-[2.58]. For safety reasons, the \njunction temperature should be always under a maximum value, usually especified by \nthe manufacturer.  \nFigure 2.20 shows the thermal models implemented respectively for a single \nsemiconductor and for several semiconductors sharing a common heat sink. As it can be \nseen from this figure, RC  circuits have been considered to model the thermal behavior \nof semiconductors.  In these figures, R\nth and Cth are the thermal resistance and \ncapacitance between semiconductor junction and semiconductor case, R c is the thermal \nresistance between semiconductor case and heat sink, and R s and Cs are the thermal \nresistance and capacitance between heat sink and ambient.  Tj, Tc, Ts and Ta are \nrespectively the semiconductor junction temperature, semiconductor case temperature, \nheat sink temperature, and ambient temperature. \nThe controlled current source that represents each semiconductor losses in Figure 2.20 \nis calculated using the procedure de tailed above; see F igures 2.15 through 2.17, while \nthe junction temperature in any semiconductor, Tj, is obtained from the models depicted \nin Figure 2.20 using the procedures shown in Figure 2.21. Note the closed loops that are \ncreated when implementing the semiconductor loss calculations from junction \ntemperatures: loss calculations from manufacturer data sheets are derived from the \njunction temperatures whose values are estimated by means of thermal models in which \nsemiconductor losses are to be specified. \n2.5.5. Characterestics of selected semiconductors \nFigures 2.22 and 2.23 show the main characteristics of semiconductors selected \nrespectively for for MV - and LV-level converters. Note that the first two plots of each \nfigure are needed to obtain conduction losses and the corresponding curves are specified \nas a function of the temperature, while the third plot is needed to obtain switching \nlosses. \nAdditional information required for calculating losses and implementing thermal \nmodels is provided in Tables 2.5 and 2.6 for MV and LV -level semiconductors, \nrespectively. In general, thermal resistance values are directly provided in \nmanufacturers’ datasheets, and thermal capacitance values have to be derived from \nthermal time constants  also provided in manufacturers’ datasheets ; see for instance \n[2.51]. \nNote that thermal p arameters are only specified for LV semiconductors; as justified \nbelow the junction temperature for MV-side semiconductors/converters was not derived \nfrom thermal models, so these parameters are not required. \n \n \nChapter2: Modeling of a Three-stage MMC-based Solid State Transformer \n \n37 \n \n \n \na) Single semiconductor \n \nb) Various semiconductors sharing a common heat sink \nFigure 2.20. Thermal model of a single LV semiconductor. \n \n \nSemiconductor \ncase Heat sink\njT cT sT aT\nSemiconductor\nPD\nthR\nthC\ncR sR\nsC\nIGBT case 1\nCommon heat sink\n1jST 1cST sT\naT\nIGBT 1\n1SPD\nthSR\nthSC\ncSR\nsR\nsC\n•\n•\n•\n•\nDiode case 1\n1jDT 1cDT sT\nDiode 1\n1DPD\nthDR\nthDC\ncDR\nIGBT case n\njSnT cSnT sT\nIGBT n\nSnPD\nthSR\nthSC\ncSR\nDiode case n\njDnT cDnT sT\nDiode n\nDnPD\nthDR\nthDC\ncDR\nAdvanced Modeling of Solid State Transformer \n \n38 \n \n \n \na) Single semiconductor \n \nb) Several semiconductors sharing a common heat sink \nFigure 2.21. Complete thermal model implementation. \n \n \nv Semiconductor  \nLoss Calculation \nBlock\ntotPD\nCT\njT\ni\nSemiconductor \nJunction \nThermal Model\nSemiconductor \nCase Thermal \nModel\noutPD\naT\nSemiconductor \nHeat Sink \nThermal Model\n1CEv IGBT 1  Loss \nCalculation \nBlock\n1SPD\n1CST\n1jST\n1Si\n Common Heat Sink \nThermal Model aT\nIGBT 1 Junction \nThermal Model\nIGBT 1 Case \nThermal Model\n1outSPD\n1Dv Diode 1  Loss \nCalculation \nBlock\n1DPD\n1CDT\n1jDT\n1Di\nDiode 1 \nJunction \nThermal Model\nDiode 1 Case \nThermal Model\n1outDPD\n•\n•\n•\n•\nCEnv IGBT n  Loss \nCalculation \nBlock\nSnPD\nCSnT\njSnT\nSni\nIGBT n  \nJunction \nThermal Model\nIGBT n  Case \nThermal Model\noutSnPD\nDnv Diode n  Loss \nCalculation \nBlock\nDnPD\nCDnT\njDnT\nDni\nDiode n \nJunction \nThermal Model\nDiode n Case \nThermal Model\noutDnPD\nChapter2: Modeling of a Three-stage MMC-based Solid State Transformer \n \n39 \n \n  \na) iS versus vCE a) iS versus vCE \n  \nb) iD versus vD b) iD versus vD \n  \nc) Eonsw, Eoffsw, ErecD versus i c) Eonsw, Eoffsw, ErecD versus i \nFigure 2.22. Datasheet curves for MV-level \nsemiconductors \nFigure 2.23. Datasheet curves for LV-level \nsemiconductors \n \nTable 2.5.  Characteristics of MV-level semiconductors \nMain characteristics \nParameter Value \nTurn-on delay time (tdon) 0.63 μs \nRise time (tr) 0.22 μs \nTurn-off delay time (tdoff) 1.70 μs \nFall time (tf) 0.98 μs \nReverse recovery time (trec) 0.70 μs \n \niS (A)\n \nTjS = 25 ℃\nTjS = 125 ℃\n0\n25\n50\n75\n100\n125\n0 2 4 6\nvCE (V)\nTjS = 25 ℃\nTjS = 125 ℃\n0\n400\n800\n1200\n1600\n2000\n0 1 2 3\niS (A)\nvCE (V)\nTjD = 25 ℃\nTjD = 125 ℃\n0\n25\n50\n75\n100\n125\n0 1 4 5\niD (A)\nvD (V)\n32\nTjD = 25 ℃\nTjD = 125 ℃\n0\n400\n800\n1200\n1600\n2000\n0 0.5 1 1.5 2\niD (A)\nvD (V)\n0\n200\n400\n600\n800\n0 20 60 80 120\nE (mJ)\ni (A)\n40\nEonsw\nEoffsw\nErecD\n100\nEonsw\nEoffsw\nErecD\n0\n200\n400\n600\n800\n0 0.5 1 1.5 2\nE (mJ)\ni (kA)\nAdvanced Modeling of Solid State Transformer \n \n40 \n \nTable 2.6. Characteristics of LV-level semiconductors \nMain characteristics \nParameter Value \nTurn-on delay time (tdon) 0.30 μs \nRise time (tr) 0.19 μs \nTurn-off delay time (tdoff) 1.14 μs \nFall time (tf) 0.17 μs \nReverse recovery time (trec) 0.83 μs \nThermal parameters \nParameter Value \nJunction to case IGBT thermal resistance (RthS) 0.010 ℃/W \nJunction to case IGBT thermal capacitance (CthS) 0.270 J/℃ \nJunction to case diode thermal resistance (RthD) 0.017 ℃/W \nJunction to case diode thermal capacitance (CthD) 0.130 ℃ \n \n2.6. Conclusion \nThis chapter has provided a detailed description of a bidirectional three- stage MMC -\nbased SST model considering both ideal (lossless) semiconductors and non-ideal (lossy) \nsemiconductors.  \nA three-phase MMC with half -bridge SMs is used for the MV input stage. A voltage \noriented control (VOC) strategy has been used to generate proper reference signals; a \nlevel-shifted PWM method is used as modulation technique. In addition, a sorting \nalgorithm technique is used for balancing the SM capacitance voltages.  The MV/LV \nisolation stage is divided into three parts: a single -phase MMC, a HFT and a single-\nphase bidirectional PWM converter. An open- loop level -shifted PWM and a sorting \nalgorithm have been used to control the MV single -phase MMC, while a p roportional-\nresonant (PR) based control is applied to the LV single -phase bidirectional PWM \nconverter. A three -phase four -leg converter is used for the LV output stage. A VOC \nstrategy with a three -dimensional SVM modulation technique has been implemented t o \ngenerate proper reference signals. The control diagram and topology of all three stages \nare explained in detail in order to implement a SST to have good performanc e under \ndifferent case studies. \nThe chapter has proposed some procedures to obtain energy a nd power losses from \nmanufacturer’s datasheets, and, depending on semiconductor ratings, two approaches \nhave been followed to incorporate losses into semiconductor models. \n \n2.7. References \n[2.1] Z. Zheng, Z. Gao, C. Gu, L. Xu, K. Wang, and Y. Li, “Stability and  voltage balance \ncontrol of a modular converter with multi -winding high-frequency transformer,” IEEE \nTrans. on Power Electron., vol. 29, no. 8, August 2014. \n[2.2] A. Kumar Sahoo and N. Mohan, “High frequency link multi -winding power electronic \ntransformer using modular multilevel converter for renewable energy integration,” 40th \nAnnual Conf. of the IEEE Industrial Electronics Society (IECON), Dallas, USA, 2014. \n[2.3] H. Akagi, “Classification, terminology, and application of the modular multilevel \ncascade converter (MMCC), IEEE Trans. on Power Electron ., vol. 26, no. 11, pp. \n3119-3130, November 2011. \n[2.4] S. Rohner, S. Bernet, M. Hiller, and R. Sommer, “Modulation, loss es, and \nsemiconductor requirements of modular multilevel converters,” IEEE Trans. on Ind . \nChapter2: Modeling of a Three-stage MMC-based Solid State Transformer \n \n41 \n \nElectron., vol. 57, no. 8, pp. 2633-2642, August 2010. \n[2.5] M. Mehrasa, E. Pouresmaeil, S. Zabihi, and J. P. S. Catalao, “Dynamic Model, Control \nand Stability Analysis of MMC-HVDC Transmission Systems,” IEEE Trans. on Power \nDel., vol. 32, no. 3, pp. 1471-1482, June 2017. \n[2.6] E. Solas, G. Abad, J.  A. Barrena, S. Aurtenetxea, A. Cárcar, and L. Zajac, “Modular \nmultilevel converter with different submodule concepts - Part I: Capacitor voltage \nbalancing method,” IEEE Trans. on Ind. Electron., vol. 60, no. 10, pp. 4525- 4535, \nOctober 2013. \n[2.7] A. Kumar Sahoo  and N. Mohan, “A power electronic transformer with sinusoidal \nvoltages and currents using modular multilevel converter,” Int. Power Electronics Conf. \n(IPEC-ECCE-Asia), Hiroshima, Japan, 2014. \n[2.8] M.A. Perez, S.  Bernet, J.  Rodriguez, S.  Kouro, R.  Lizana, “Circuit topologies, \nmodelling, control schemes and applications of modular multilevel converters,” IEEE \nTrans. on Power Electron., vol. 30, no.1, pp.4-17, 2015. \n[2.9] A. Nami, J. Liang, F. Dijkhuizen, and G. D. Demetriades, “Modular multilevel \nconverters for HVDC applications: review on converter cells and functionalities,” IEEE \nTrans. on Power Electron., vol. 30, no.1, pp.18-36, January 2015. \n[2.10] A. Shojaei and G. Joos, “A topology for three -stage solid state transformer,” IEEE \nPower & Energy Society General Meeting, Vancouver, BC, Canada, July 2013. \n[2.11] S. Debnath, J. Qin, B. Bahrani, M. Saeedifard, and P. Barbosa, “Operation, control, and \napplications of the  modular multilevel converter: A  review,” IEEE Trans. on Power \nElectron., vol. 30, no.1, pp. 37-53, January 2015. \n[2.12] M. Guan, H. Chen, and Z. Xu, “Control and modulation strategies for modular \nmultilevel converter based HVDC system,” 37th Annual Conf. of the IEEE Industrial \nElectronics Society (IECON), Melbourne, Australia, November 2011.  \n[2.13] A. Hassanpoor, L. Ängquist, S. Norrga, K. Ilves, and H.  P. Nee, “Tolerance band \nmodulation methods for modular multilevel converters,”  IEEE Trans. on Power \nElectron., vol. 30, no.1, pp.311-326, January 2015. \n[2.14] A. Yazdani and R. Iravani , “A unified dynamic model and control for the voltage -\nsourced converter under unbalanced grid conditions,” IEEE Trans. on Power Del., vol. \n21, no.3, pp. 1620–1629, July 2006. \n[2.15] L. Xu, B. Andersen, and P. Cartwright, “VSC transmission operating under unbalanced \nAC conditions-Analysis and control design,” IEEE Trans. on Power Del., vol. 20, pp. \n427–434, Jan. 2005. \n[2.16] M. Hagiwara and H. Akagi, “Control and experiment of pulse width modulated \nmodular multilevel converters,” IEEE Trans. on Power Electron. , vol. 24, no. 7, pp. \n1737-1746, July 2009. \n[2.17] G. S. Konstantinou, M. Ciobotaru, and V. G. Agelidis. “Operation of a modular \nmultilevel converter with selective harmonic elimination PWM,” 8th Int . Conf. on \nPower Electronics and ECCEA Asia (ICPE&ECCEA), Jeju, South Korea, 2011. \n[2.18] L. Ängquist, A. Antonopoulos, D. Siemaszko, M. Vasiladiotis, and H.  P. Nee, “Open -\nLoop control of modular multilevel converters using estimation of stored energy,” IEEE \nTrans. on Industry App lications, vol. 47, no. 6, pp.2516- 2524, November/December \n2011. \n[2.19] M. Mehrasa, E. Pouresmaeil, M. F. Akorede, S. Zabihi, and J. P. S. Catalao , “Function-\nBased Modulation Control for Modular Multilevel Converter Under Varying Loading \nand Parameters Conditions ,” IET Generation, Transmission & Distribution, (DOI:  \n10.1049/iet-gtd.2016.1028) \n[2.20] M. Saeedifard, and R. Iravani, “Dynamic performance of a modular multilevel back -to-\nback HVDC System,” IEEE Trans. on Power Electron., vol. 25, no.4, pp.2903 -2912, \nOctober 2010. \n[2.21] A. K. Sahoo, R. Leon , and N. Mohan, “Review of modular multilevel converters for \nteaching a graduate- level course of power electronics in power systems”, North \nAmerican Power Symposium (NAPS), Manhattan, USA, November 2013. \n[2.22] A. Shojaei and G. Joos. “A modular solid s tate transformer with a single -phase \nAdvanced Modeling of Solid State Transformer \n \n42 \n \nmedium-frequency transformer” IEEE Electrical Power & Energy Conf. (EPEC), 2013. \n[2.23] A. Shri, “A solid-state transformer for interconnection between the medium and the low \nvoltage grid,” Master Thesis, Delft Univ., 2013. \n[2.24] X. She, A. Q. Huang, and R. Burgos, “Review of solid -state transformer technologies and their \napplication in power distribution systems,” IEEE J. Emerg. Sel. Top. Power Electron. , vol. 1, no. \n3, pp. 186–198, 2013. \n[2.25] M. A. Bahmani, T. Thiringer , and M. Kharezy, “Optimization and experimental \nvalidation of medium -frequency high power transformers in solid- state transformer \napplications,” IEEE Applied Power Electronics Conference and Exposition (APEC) , \n2016. \n[2.26] M. Leibl, G. Ortiz, and J. W. K olar, “Design and experimental analysis of a medium -\nfrequency transformer for solid -state transformer applications,” IEEE J. Emerg. Sel. \nTop. Power Electron., vol. 5, no. 1, pp. 110–123, 2017. \n[2.27] G. Ortiz, M. Leibl, J. W. Kolar, and O. Apeldoorn, “Med ium frequency transformers \nfor solid- state-transformer applications -  Design and experimental verification,” 10th \nIEEE International Conference on Power Electronics and Drive Systems (PEDS), 2013. \n[2.28] S. B. Yu Du, G. Wang, and S. Bhattacharya, “Design considerations of high voltage \nand high frequency three phase transformer for Solid State Transformer application,” \n36th Annual Conference on IEEE Industrial Electronics Society (IECON), 2010. \n[2.29] S. Baek, “Design consideations of high voltage and high  frequency transformer for \nsolid state transformer application,” PhD Thesis North Carolina State Univ., 2009. \n[2.30] P. Lezana, C. A. Silva, J. Rodríguez, and M. A. Pérez, “Zero -steady-state-error input-\ncurrent controller for regenerative multilevel converters based on single -phase cells,” \nIEEE Trans. on Industrial Electron., vol. 54, no. 2, pp.733-740, April 2007. \n[2.31] W. Helin, C. Qiming, L. Ming, C. Gen, and D. Liang, “The study of single-phase PWM \nrectifier based on PR control strategy,” 26 th Chinese Control and Decision Conf. \n(CCDC), Changsha, China, 2014. \n[2.32] A. Furuya, K. Oka, and K. Matsuse, “A characteristic analysis of four -leg inverter in \ntwo AC motor drives with independent vector control,” International Conference on \nElectrical Machines and Systems (ICEMS), Seoul, South Korea , October 2007. \n[2.33] S. El -Barbari and W. Hofmann, “Digital control of four -leg inverter for standalone \nphotovoltaic systems with unbalanced load,” 26th Annual Conf. of Industrial Electronics \nSociety (IECON), Nagoya, Japan, October 2000. \n[2.34] J. A. Martinez -Velasco, S. Alepuz, F. González -Molina, and J. Martin -Arnedo, \n“Dynamic average modeling of a bidirectional solid state transformer for feasibility \nstudies and real -time implementation,” Electric Pow er Systems Research , vol. 117, \npp.143–153, 2014. \n[2.35] R. A. Gannett,  “Control strategies for high power four -leg voltage source inverters,”  \nMaster Thesis, Virginia Polytechnic Institute and State University, USA, July 2001. \n[2.36] P. Mattavelli and S. Fasolo, “Implementation of synchronous frame harmonic control \nfor high-performance AC power supplies,” IEEE Industry Applications Conf ., Rome, \nItaly, October 2000. \n[2.37] S. M. Dehghan, A. Ale Ahmad, R. Lourakzadegan, M. Fazeli, M .Mohamadian, and A. \nAbrishamifar, “A high performance controller for parallel operation of three -Phase \nUPSs powering unbalanced and nonlinear loads,” 2nd Power Electron ics, Drive \nSystems and Technologies Conf., Tehran, Iran, February 2011. \n[2.38] I. Vechiu, H. Camblong , G. Tapia, B. Dakyo, and O. Curea, “Control of a four -leg \ninverter for hybrid power system applications with unbalanced load,” Energy \nConversion and Management, vol. 48, no. 7, pp. 2119–2128, July 2007. \n[2.39] I. Vechiu, O. Curea, and H. Camblong, “Trans ient operation of a four -leg inverter for \nautonomous applications with unbalanced load,” IEEE Trans. on Power Electron., vol. \n25, no. 2, pp. 399-407, February 2010. \n[2.40] S. Jian and H. Grotstollen , “Optimized space vector modulation and regular -sampled \nPWM: a re- examination,” 31st IAS Annual Meeting Conf . (IAS), San Diego, USA, \nOctober 1996. \nChapter2: Modeling of a Three-stage MMC-based Solid State Transformer \n \n43 \n \n[2.41] M. P. Kazmierkowski, R. Krishnan, and F. Blaabjerg , “Control in power electronics \nselected problems,” Elsevier Academic Press Series in Engineering , New York, USA, \n2002. \n[2.42] F. A. B. Batista  and I. Barbi, “Space vector modulation applied to three phase three -\nswitch two-level unidirectional PWM rectifi er,” IEEE Trans. on Power Electron., vol. \n22, no. 6, pp. 2245–2252, November 2007. \n[2.43] M. A. Perales, M.  M. Prats, R. Portillo, J.  L. Mora, J.  I. Leon, and L.G. Franquelo, \n“Three-dimensional space vector modulation in abc  coordinates for four -leg voltage \nsource converters,” IEEE Trans. on Power Electron., vol.1 , no.4, pp. 104- 109, \nDecember 2003. \n[2.44] E. Ebrahimzadeh, S. Farhangi, H.  Iman-Eini, and F. Blaabjerg, “Modulation technique \nfor four-leg voltage source inverter  without a look -up table,” IET Power Electronics , \nvol.9, no.4, pp. 648-656, 2016.  \n[2.45] D. Graovac and M. Pürschel, “IGBT power losses calculation using the data -sheet \nparameters” Infineon Technologies Application Note, vo1. 1, January 2009. \n[2.46] F. Blaabjerg, U. Jaeger, S. Munk -Nielsen, and J. K. Pedersen, “Power losses in PWM -\nVSI inverter using NPT or PT IGBT devices,” IEEE Trans. on Power Electron., vol. \n10, no. 3, pp.358-367, May 1995. \n[2.47] Available at: http://es.mathworks.com/matlabcentral/fileexchange/35980-loss-\ncalculation-in-a-buck converter-using-simpowersystems-and-simscape \n[2.48] A. S. Bahman and F. Blaabjerg, “Comparison between 9-level Hybrid Asymmetric and \nConventional Multi -Level Inverters for Medium Voltage Application,” IEEE In t. \nSymposium on Industrial Electronics, Taipei, Taiwan, May 2013. \n[2.49] C. Liu, B. Wu, N. R. Zargari, D. Xu, and J. Wang, “A novel three -phase three -leg \nAC/AC converter using nine IGBTs,” IEEE Trans. on Power Electron.,  vol. 24, no. 5, \npp.1151-1160, May 2009. \n[2.50] A. Fatemi, M. Azizi, M. Mohamadian, A. Yazdian Varjani, and M. Shahparasti, \n“Single-phase dual -output inverters with three -switch legs,” IEEE Trans. on Ind. \nElectron., vol. 60, no. 5, pp.1769-1779, May 2013. \n[2.51] A. D. Rajapakse, A. M. Gole, and P. L. Wilson, “Electromagnetic transients simulation \nmodels for accurate representation of switching losses and thermal performance in \npower electronic systems,” IEEE Trans. on Power Del. , vol. 20, no. 1, pp.319- 327, \nJanuary 2005. \n[2.52] Q. Tu a nd Z. Xu, “Power losses evaluation for modular multilevel converter with \njunction temperature feedback,” IEEE Power and Energy Society General Meeting, \nJuly 2011. \n[2.53] A. Hassanpoor, S. Norrga, and A. Nami, “Loss evaluation for modular multilevel \nconverters with different switching strategies,” 9th Int. Conf. on Power Electronics and \nECCE Asia (ICPE-ECCE Asia), Seoul, Korea, June 2015. \n[2.54] J. Li, X. Zhao, Q. Song, H. Rao, S. Xu, and M. Chen, “Loss calculation method and \nloss characteristic analysis of MMC based VSC -HVDC system,” IEEE Int . Symp. on \nIndustrial Electronics (ISIE), Taipei, Taiwan, May 2013. \n[2.55] A. D. Rajapakse, A. M. Gole, and R. P. Jayasinghe, “An improved representation of \nfacts controller semiconductor losses in EMTP -type programs using accurate loss-\npower injection into network solution,”  IEEE Trans. on Power Del. , vol. 24, no. 1, \npp.381-389, January 2009. \n[2.56] Z. Luo, “A thermal model for IGBT modules and its implementation in real time \nsimulator,” PhD Thesis, University of Pittsburgh, USA, 2002. \n[2.57] M. C. Oberdorf , “Power losses and thermal modeling of a voltage source inverter,” \nMaster Thesis, Naval Postgraduate School, Monterey, California, USA, 2006. \n[2.58] K. Ma, A. S. Bahman, S. Beczkowski, and F. Blaabjerg, “Complete loss and thermal \nmodel of power  semiconductors including device rating information,” IEEE Trans. on \nPower Electron., vol.30, no.5, pp.2556-2569, May 2015. \n \n \nAdvanced Modeling of Solid State Transformer \n \n44 \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n  \n \n \n \n \n \n \nChapter 3 \nMatlab/Simulink Implementation of a \nThree-stage Solid State Transformer \nModel \n \n \n3.1. Introduction \nThe implementation of the SST model detailed in Chapter 2 is a very complex and \ndifficult task. The goal of this chapter is twofold: on one hand, it will illustrate the \narchitecture of the SST model implemented in Matlab/Simulink; on the other hand, it \nwill help to better understand the design and operation of the configuration selected for \nthis thesis. The chapter provides a summary of the developed model by showing the \nmain blocks of each SST stage and the approaches followed to incorporate losses into \nthe semiconductor models. Figure 3.1 shows the upper -level Matlab/Simulink \nimplementation of the three -stage SST model . The main characteristics of each stage \nhave already analyzed in previous chapters; a short summary is provided below: \n• MV Input Stage : A three- phase MMC with associated VOC strategy , level \nshifted PWM modulation technique and sorting algorithm for SM capacitance \nbalancing has been implemented at input stage of SST. \n• Isolation Stage: A DC/DC DAB that contains a single-phase MMC, a HFT and a \nsingle-phase full bridge rectifier bridge along with associated control strategy. \n• LV Output Stage: A three-phase four-leg PWM converter with VOC strategy. \nFor a comparison between the implemented model and the diagram of the full \nbidirectional three-stage SST, see also Figure 1.1. The implementation of each stage is \ndetailed in the three following sections, while the last section presents the approaches \nfollowed for implementing semiconductor losses in each converter. Each section shows \nthe diagram of the power converters plus those of the main controller parts, without \ngoing to the last details. \nAdvanced Modeling of Solid State Transformer \n \n46 \n \n \nFigure 3.1. Matlab/Simulink implementation of the three stage SST model. \n3.2. Implementation of the MV Input Stage \n3.2.1. Configuration of the power circuit \nThe MV input stage three -phase MMC model with six half -bridge converter SMs per \narm as implemented in Matlab/Simulink is shown in Figure 3.2. The scheme of each \nsubmodule (SM) is depicted in Figure 3.3, respectively. \n3.2.2. Control blocks \nFigure 3.4 shows differe nt parts of VOC (Vector Oriented Control) strategy in input \nstage as implemented in Simulink. The positive -sequence grid voltage is used to obtain \nthe grid angle for synchronization purposes by means of a three phase -locked loop \n(PLL); see Figure 3.4.a. The d and q axes of VOC are given in Figure 3.4.b and 3.4.c, \nrespectively. As it can be observed from Figure 3.4.b, in d axis the real value of MV dc \nlink is compared with reference value and the error is passed through voltage PI \ncontrollers which form the reference values for the current in  d axis. The reference \ncurrent for q axis is set to zero. These current reference values are compared with the \nactual values of line currents and the errors are passed through PI controllers to obtain \nreference values for modulation technique in dq frame. Finally, Figure 3.4.d shows the \noutput references generated for modulation block in abc frame. \nModulation technique : As shown in Figure 3.2, each leg of the three-phase MMC \nconsists of two upper and lower arms with six  similar series connected half bridge SM , \nan arm resistance and an arm inductance. Since all of the arms are similar in terms of \ncontrol and structure, only the control implementation for an upper arm of phase A is \npresented in Figure 3.5, which also shows the level-shifted PWM block.  \nSM control and c apacitance voltage balance: Sorting algorithm technique is \nimplemented to balance and keep the voltage of capacitors at the desired value. The \ncapacitance balancing block has three inputs: the number of SMs that should be inserted \nwhich is determined through level shifted PWM technique (see Figure 3.5); arm current \nis measured consistently to determine the charging or discharging states. \nThe voltage of each capacitor is also measured in order to select the MMC SM that has \nto be inserted/bypassed (see Figure 3.6). \n\nChapter 3: Matlab/Simulink Implementation of a Three-stage Solid State Transformer Model \n \n47 \n \n \nFigure 3.2. Input stage - Three-phase MMC configuration. \n \nFigure 3.3. Input stage – Configuration of half-bridge submodules (SMs). \n\nAdvanced Modeling of Solid State Transformer \n \n48 \n \n \n \na) Input stage PLL block \n \nb) VOC d-axis \n \nc) VOC q-axis \n \nd) Output of VOC reference signals \nFigure 3.4. MV input stage - VOC blocks. \n \n \nFigure 3.5. Input stage - Block of the level shifted PWM technique for upper arm of phase A. \n \n\nChapter 3: Matlab/Simulink Implementation of a Three-stage Solid State Transformer Model \n \n49 \n \n \na) Voltages of SM capacitance \n \nb) Capacitance balancer and switching selection block \nFigure 3.6. Input stage - Capacitor balancing and selection strategy. \n \n3.3. Implementation of the MV-LV Isolation Stage \nAs already mentioned, the SST i solation stage consists of three different parts: single-\nphase MMC, the HFT, and a single-phase full PWM rectifier bridge.  \nFigure 3.7 shows the configuration of the single -phase MMC: it is composed of two \narms with six half bridge submodules and arm impedance acting as an inverter \nconverting the MV dc link to multile vel high frequency waveform at the primary of \nhigh frequency transformer. The control procedure for this single -phase MMC is the \n\nAdvanced Modeling of Solid State Transformer \n \n50 \n \nsame that was presented in Section 3.2.2. The reference for level shifted modulation \nstrategy is a sinusoidal waveform which its amplitude is based on the value of \nmodulation index. \nFigure 3.8 shows the configuration of the single -phase rectifier, its filter and control \nblocks. As it can be observed from Figure 3.8.c, the  real value of LV dc link is \ncompared to its reference value and the error is passed through voltage PI controller. \nThe output of PI controller is multiplied by filtered value of HFT secondary voltage \nwhich forms the reference for current. The real value of HFT secondary current is \ncompared with obtained reference value and the error is passed through PR controller \nwhich generates the reference value for bipolar PWM technique (see Figure 3.8.a). The \nbipolar PWM technique generates the switching signals for single -phase two-level full-\nbridge rectifier.  \nFigure 3.7. Isolation stage – Implementation of the MV single-phase MMC. \n \n\nChapter 3: Matlab/Simulink Implementation of a Three-stage Solid State Transformer Model \n \n51 \n \n \na) Isolation stage – Configuration of the LV single phase rectifier \n \nb) Filter block \n \nc) Control block \nFigure 3.8. Isolation stage – Implementation of the LV single-phase two-level rectifier. \n \n\nAdvanced Modeling of Solid State Transformer \n \n52 \n \n3.4. Implementation of the LV Output Stage \n3.4.1. Configuration of the Output Stage \nFigure 3.9 shows the configuration of the LV  stage as implemented in this thesis : i t \nconsists of a three-phase four-leg converter plus current and voltage filters. \n \nFigure 3.9. Three phase four leg converter topology. \n \nA comprehensive VOC strategy has been implemented in order to guarantee the \nefficient performance of the converter under different operating conditions (e.g. \nunbalanced load currents, nonlinear load currents, short circuit). Figure 3.10 provides a \nfull ove rview of control blocks. The control diagram constitute of voltage control \nblocks for decomposed positive negative and zero sequences and harmonic voltage \ncompensation blocks for 5th and 7th harmonics. The outer voltage control blocks \nprovide reference for  inner current controllers. The inner current control block is also \ncomposed of controllers in three positive, negative and zero sequence which provide \nreference signals for three- dimensional space vector modulation (3D -SVM) technique \nthat is implemented v ia Matlab function. The output of Matlab function is the duty \ncycles of switching vectors in one switching period. These duty cycles are then applied \nto hysteresis modulator to prepare eight switching signals for output stage converter. \n \nFigure 3.10. Overview of the control diagram for four leg converter. \n\nChapter 3: Matlab/Simulink Implementation of a Three-stage Solid State Transformer Model \n \n53 \n \nAs detailed in Chapter 2, a control strategy for selective harmonic voltage compensation \n(namely for 1 st, 5th  and 7 th harmonics) has been implemented:  the output signal of \nvoltage control block will be added and forms reference signal for current controllers.  \nFigure 3.11 shows PLL for mentioned harmonics. \n \na) 1st harmonic PLL \n \nb) 5th harmonic PLL \n \nc) 7th harmonic PLL \nFigure 3.11. Output stage – PLL blocks for 1st, 5th and 7th harmonics. \n \nThe d and q channels are used to prepare reference signals for modulation technique. In \nthe control strategy implemented for our work, the variables are decomposed to \npositive, negative and zero sequences with transformation blocks.  \nFigure 3.12 shows the decomposition block for output currents and volta ges. In these \nblocks, VyN is the three phase load voltage , iabc2 and iabc_l are the currents before and \nafter the capacitance filters, respectively. \nThe blocks to transform variables from abc to αβ, αβ to dq, dq to αβ, and αβ to abc are \nbased on equations (3.1) through (3.4). In equations (3.2) and (3.3), θ is equal to angle1 \n= +ωt, angle5 = -5ωt, angle7 = +7ωt for 1st, 5th and 7th harmonics, respectively. \n\nAdvanced Modeling of Solid State Transformer \n \n54 \n \n \n111 22\n2 33*03 22\n11 1\n22 2\na\nb\nc\nvv\nvv\nvv\nα\nβ\nγ\n −−    = −     \n\n (3.1) \n cos sin\nsin cos\nd\nq\nv v\nv v\nα\nβ\n + q+ q= − q+ q \n  (3.2) \n cos sin\nsin cos\nd\nq\nvv\nvv\nα\nβ\n + q− q=  + q+ q \n (3.3) \n \n1 01\n13 122\n13 122\na\nb\nc\nvv\nvv\nv v\nα\nβ\nγ\n\n    = −     −−\n   (3.4) \n \na) Output voltage decomposition \n \nb) Load current decomposition \n \nc) Inverter current decomposition \nFigure 3.12.  Decomposition blocks for four leg inverter. \n \n3.4.2. Voltage control blocks \nOutput voltage controllers prepare the reference signals  of current for inner current \ncontrol blocks. Figure 3.13 through Figure 3.15 show the respectively positive, negative \nand zero sequences of voltage control blocks for fundamental frequency. \n\nChapter 3: Matlab/Simulink Implementation of a Three-stage Solid State Transformer Model \n \n55 \n \nVoltage controller for positive sequence : T he masked and detailed view of voltage \ncontrollers for positive sequence channel at fundamental frequuency are given in Fig ure \n3.13. as it can be seen from figure 3.13.b, t he real values of capacitance voltages in \npositive sequence which are achieved after decomposition in abc frame  are transformed \nto dq frame through using equations 3.1 to 3.4. These real values  are then  compared  \nwith reference value of positive voltage sequence in d and q channels and the errors are \npased through voltage PI controllers to determine the reference for outer current \ncontrollers in positive chanel. The PI coeficients are tuned properly in a way that real \nvalues of load voltage could track the dc reference values in dq frame and therefore \nproviding three phase sinosuidal voltage in abc  fram as well. It should be noted that the \ncapacitance value also has impact in determining the reference values for inner current \ncontrollers. \n \na) Masked block \n \nb) Control diagram \nFigure 3.13. Diagram of the positive-sequence voltage controller for fundamental frequency. \n \nVoltage controller for negative sequence: T he masked and detailed view of voltage \ncontrollers for negative  sequence channel are  given in Fig ure 3.14. As it can be seen  \nfrom figure 3.14.b, t he real values of capacitance voltages in negative sequence which \nare generated due to unbalanced load condititions  and are achieved after decomposition \nin abc frame  are transformed to dq frame through using equations 3.1 to 3.4. these \nvaluse  are compared  with reference value of negative voltage sequence (which are set \nto zero in order to cancel negative components of voltage ) in d and q channels and the \nerrors are pased through voltage PI controllers to determine the reference for outer \ncurrent controllers in negative chanel.  The PI coeficients are tuned properly in a way \n\nAdvanced Modeling of Solid State Transformer \n \n56 \n \nthat real values of load voltage in negative sequence  are reaching the value close to \nzero in dq frame and therefore providing three phase sinosuidal voltage in abc fram as \nwell. \nVoltage controller for zero sequence : the masked and detailed view of voltage \ncontrollers for zero sequence channel are  given in Figure 3.15. as it can be seen  from \nfigure 3.15.b, the real va lues of capacitance voltages in zero sequence which are \ngenerated due to unbalanced load condititions  and are achieved after decomposition in \nabc frame  are transformed to dq frame through using equations 3.1 to 3.4. these valuse  \nare compared  with reference value of zero  voltage sequence (which are set to zero in \norder to cancel zero component of voltage ) in d and q channels and the errors are pased \nthrough voltage PI controllers to determine the reference for outer current controllers in \nzero chanel.  The PI coeficients are tuned properly in a way that real values of load \nvoltage in zero sequence  are reaching the value close to zero in dq frame and therefore \nproviding three phase sinosuidal voltage in abc fram as well. \n \na) Masked block \n \nb) Control diagram \nFigure 3.14. Diagram of the negative-sequence voltage controller for fundamental frequency. \n \nControl diagram for 5th harmonic: The masked block and detailed view of the control \nblock for 5th  harmonic vol tage compensation are given in F igure 3.1 6. In order to \ncompensate 5th harmonics of voltage, first it is required to extract the 5th harmonic \ncomponent and then create voltage controllers in parallel with positive sequence control \nblock at fundamental frequency. As it can be observed from Figure 3.16.b, the reference \nvalue of load voltage in αβ frame which is pure sinusoidal waveform with fundamental \n\nChapter 3: Matlab/Simulink Implementation of a Three-stage Solid State Transformer Model \n \n57 \n \nfrequency is compared with real value of load voltage which contains all harmonic \ncomponents including fundamental component and harmonic components wit h the \nfrequency of (6n±1)ω. With this comparison the harmonics will be extracted. The main \naim is to cancel most noticeable harmonic components which are 5th and 7th \nharmonics. The extracted harmonics in αβ  frame will be transformed to dq  component \nwith tr ansformation angle of - 5θ which gives the 5th harmonic component of load \nvoltage. These values are passed through PI controllers in order to compensate 5th \nharmonics of voltage and also providing reference values for output current controllers. \nControl diagram for 7th harmonic: The masked and detailed views of the control block \nfor 7th harmonic voltage compensation are given in Figure 3.17. In order to compensate \n7th harmonics of voltage, first it is required to extract the 7th harmonic component and \nthen create voltage controllers in parallel with positive sequence control block at \nfundamental frequency. As it can be observed from Figure 3.17.b, the reference value of \nload voltage in αβ  frame which is pure sinusoidal waveform with fundamental \nfrequency i s compared with real value of load voltage which contains all harmonic \ncomponents including fundamental component and harmonic components with the \nfrequency of (6 n±1)ω. With this comparison the harmonics will be extracted. To \ncompensate the 7th harmonics, the extracted harmonics in αβ plane will be transformed \nto dq component with transformation angle of +7 θ the 7th harmonic component of load \nvoltage will be obtained. T hese values are passed through PI controllers in order to \ncompensate 7th harmonics of voltage and also providing reference values for output \ncurrent controllers. \n \na) Masked block \n \nb) Control diagram \n\nAdvanced Modeling of Solid State Transformer \n \n58 \n \nFigure 3.15. Diagram of the zero-sequence voltage controller for fundamental frequency. \n \na) Masked block \n \n \nb) Control block \nFigure 3.16. Diagram of the voltage control compensation of 5th harmonic. \n \na) Masked block \n \nb) Control block \nFigure 3.17. Diagram of the voltage control compensation of 7th harmonic. \n \n \n \n\nChapter 3: Matlab/Simulink Implementation of a Three-stage Solid State Transformer Model \n \n59 \n \nReference signals for output current controllers: In comprehensive VOC strategy with \nthe capability of harmonic compensation, the reference signal for positive sequence of \ncurrent controller is achieved through adding reference current from positive sequence \nvoltage controllers of fundamental frequency with output signals from 5th and 7th \nharmonic compensation control blocks (see Figure 3.18.d). Figure 3.18 shows the \nreferences that are needed for current control in positive sequence in \nαβ space. \n \na) Current reference at the fundamental frequency in αβ frame for positive sequence \n \nb) Inverter current in αβ frame for positive sequence \n \nc) Load reference voltage in αβ frame for positive sequence \n \nd) Current reference in αβ frame for positive sequence \nFigure 3.18. Reference signal in αβ frame for positive sequence current control block. \n \n3.4.3. Current controllers block \nFigure 3.19 shows the masked view of inner current control blocks. The current control \nblock provide the reference signals for 3D -SVM modulation technique. Figures 3.20 to \nfigure 3.22 show the positive, negative and zero sequences of current control blocks.  \nThe refence values for positive sequence current controllers in \nαβ frame are achievd \nfrom the voltage controllers as described in above section. the current refrence for \npositive sequence  will be achieved by adding reference current at the fundamental \nfrequency and reference currents related to 5 th and 7th  harmonics. For negative \nsequence and zero sequence, the current reference values will be achieved from voltage \ncontrollers in dq channel. \n \n \n\nAdvanced Modeling of Solid State Transformer \n \n60 \n \n \nFigure 3.19. Overall view of current control blocks. \n \nCurrent controller for positive sequence: The masked and detailed views of the current \ncontrol block for positive sequence are given in Figure 3.20. The reference value of \ncurrent are compared with their real values in αβ  frame and the error is passed through \nPR controllers related to fundamental, 5th and 7th harmonics frequencies that generates \nthe reference value for modulation strategy. The PR controllers in αβ  frame provide \nefficient control when nonlinear load is connected. \nCurrent controller for negative sequence: Figure 3.21 shows the current control block \nfor negative sequence. The current reference value for negative sequence in dq channel \nwhich is achieved through the voltage controllers in negative sequence is compared \nwith real values of inverter current in dq channel and the error is passed though PI \ncontrollers which generates the reference value for Modulation strategy. \nCurrent controller for zero sequence: Figure 3.22 shows the current control block for \nzero sequence. The current reference value for zero sequence in dq channel which is \nachieved through the voltage controllers in zero sequence is compared with real values \nof inverter current in dq channel and the error is passed though PI controllers which \ngenerates the reference value for Modulation strategy. \nFinally, all the output signals of current controllers in positive and negative and zero \nsequence are added together in αβ frame and then transformed to abc  signal to be used \nfor three-dimensional space vector modulation strategy (3-D SVM) in abc frame. \n \n\nChapter 3: Matlab/Simulink Implementation of a Three-stage Solid State Transformer Model \n \n61 \n \n \n \na) Masked control blocks \n \nb) PR controllers \nFigure 3.20. Positive sequence current controller diagram. \n \n \n \n \n\nAdvanced Modeling of Solid State Transformer \n \n62 \n \n \nFigure 3.21. Negative sequence current controller diagram. \n \nFigure 3.22. Zero sequence current controller diagram. \n \n3.4.4. Modulation block \nAs it can be seen from figure 3.23, the output control signal will be applied to 3D -SVM \nmodulation block in order to generate gate signals for four leg converter. The 3- D SVM \nfunction determines the duty cycles related to NZSV and ZSV. As it is discussed i n \nSection 2.4.4, there are sixteen switching vectors for 3-D SVM which divide the control \nregion to 24 tetrahedrons.  \nIn each tetrahedron, there are three NZVS and one ZVS that their duty cycle is \ndetermined by switching look up table which is given in the  form of Matlab code in \nMatlab function. These duty cycles are applied to the modulator which generate eight \nswitching signals for four -leg converter. It should be noted that the modulator use \nhysteresis relays with upper and lower bands for generation of switching signals (see \nFigure 3.24). \n \n \n\nChapter 3: Matlab/Simulink Implementation of a Three-stage Solid State Transformer Model \n \n63 \n \n \nFigure 3.23. 3D-SVMmodulation block. \n \nFigure 3.24. 3D-SVM modulator diagram. \n3.5. Implementation of Semiconductor Losses \n3.5.1. Introduction \nThere are three types of power losses in IGBTs and diodes: c onduction, switching and \nblocking losses . In general, b locking losses are neglected;  therefore, total \nsemiconductor losses consist of conduction and switching losses.  This section provides \na summary of the approaches followed for implementing losses in Matlab/Simulink \nsemiconductor models for IGBTs and diodes. Since the approaches implemented in this \nthesis account for semiconductor losses, thermal semiconductor and converters have \nalso been implemented as part of the procedure for calculating and incorporating losses \ninto semiconductor models. \n3.5.2. Semiconductor loss calculation \nConduction loss of IGBTs and diodes : Figure 3.25 shows the calculation procedure of \nconduction losses for IGBT and diode ( PconS/D). The value of v conS/D, the forward  \n\nAdvanced Modeling of Solid State Transformer \n \n64 \n \nsemiconductor voltage in conduction mode, is obtained by means of a 2 -D lookup table \n(available in manufacturer’s datasheet ) from two inputs : iS/D, the current  through the \nsemiconductor, and T jS/D, the semiconductor junc tion temperature derived from its \nthermal model. \n \nFigure 3.25. Calculation of conduction losses for IGBTs and Diodes. \nSwitching losses of IGBTs: Figure 3.26 shows the procedure to obtain total IGBT \nswitching losses, ∆Psw, using manufacturer datasheet (see Chapter 2). As it can be seen \nfrom this figure, ∆ Ponsw and ∆Poffsw are calculated from the values of Eonsw and Eoffsw. \nBoth energy values are obtained from 3D lookup tables supplied in manufacturers’ \ndatasheets. As shown in Figure 3.26: \n• Three inputs are required for the calculation of Eonsw: the pre-switching value of \nvCE, the post-switching value of the iS, and TjS. \n• Three inputs are required for the calculation of E offsw: the post-switching value of \nvCE, the pre-switching value of iS, and TjS. \n∆Ponsw and ∆Poffsw are obtained after dividing E onsw and Eoffsw by the simulation time \nstep. \nFor the meaning of all these symbols, see Chapter 2. \nSwitching losses of diode s: Figure 3.27 shows the calculation of  ∆PrecD. ErecD is \nobtained by means of a 3-D lookup table (also available from manufacturer’s datasheet) \nfrom three inputs: the pre-switching value of the  diode current, i D, the post-switching \nvalue of the diode voltage, vD, and the junction temperature in the diode, T jD. The value \nof ∆PrecD is obtained after dividing ErecD by the simulation time step. \n \nFigure 3.26. Calculation of IGBT switching losses. \n\nChapter 3: Matlab/Simulink Implementation of a Three-stage Solid State Transformer Model \n \n65 \n \n \nFigure 3.27. Calculation of diode switching losses. \n3.5.3. Thermal models \nSince semiconductor junction temperatures have some impact on semiconductor losses, \nthe implementation of thermal models is necessary to estimate junction temperature as \nlook up table input (see Figures 3.25 to 3.27). This implementation of thermal models in \nMatlab/Simulink is detailed for one leg a of the LV three -phase four-leg converter. A \nsimilar approach has been followed for the LV full bridge rectifier of the isolation stage. \nThe thermal model developed in this work is according to that presented in [3.1] -[3.2]. \nAs described in Chapter 2 (see Section 2.5.4), the thermal model of a semiconductor \ncan be represented by means of a RC  circuit, see Figure 2.20, in which R\nth and Cth are \nrespectively the thermal resistance and capacitance between semiconductor junction and \nsemiconductor case,  Rc and Cc are the thermal resistance and capacitance between \nsemiconductor case and heat sink, and R s and Cs are the thermal resistance and \ncapacitance between heat sink and ambient. \nFigure 3.28 shows the masked implementation block of thermal model for 16 \nsemiconductors (8 IGBTs and 8 antiparallel diodes) which share a common heat sink \nfor output stage converter.  \n \nFigure 3.28. Thermal model for the LV otput stage converter. \n\nAdvanced Modeling of Solid State Transformer \n \n66 \n \nSemiconductor case provides an interface between the semiconductor junction and heat \nsink. In the thermal model the total loss of each semiconductor ( DPtotS/D) and \nsemiconductor case temperature serve as input for estimating the semiconductor \njunction temperature. These inputs are consi dered as state variables and thermal \nresistances and capacitances are the coefficients  in state space equations. Since all the \nlegs are the same in terms of thermal modeling, only the detailed implementation of leg \na in output stage converter are given in this section.  \nFigure 3.29 shows the state -space junction to case thermal model for one leg of the LV \noutput stage converter. As it can be observed, the total loss of each semiconductor and \nsemiconductor case temperature are used as inputs of the state -space thermal model. \nThe estimated output is the semiconductor junction temperature, which is required for \nloss calculation, and the loss itself, which is injected to semiconductor case model. \nFigure 3.29.b shows the parameters of the semiconductor t hermal impedance, required \nfor estimation of semiconductor junction temperature; Figure 3.29.c shows a detailed \nview of the model including state -space equations; Figure 3.29.d shows a detailed view \nof the semiconductor case model. \nFigure 3.30 shows the ma sked model of heat sink and detailed view of heat sink block \nin Matlab/Simulink. The parameters considered in the heat sink model are the thermal \nresistance and capacitance from semiconductor case to heat sink and semiconductor \nheat sink to ambient. \n3.5.4. Incorporation of losses into semiconductor models \nThe main aim of this section  is to replace ideal semiconductor models available in  \nMatlab/Simulink with semiconductor  models that incorporate losses and take into \naccount the joint temperature effect. \nConduction losses: Conduction losses, DPconS/D, can be in corporated into the \nsemiconductor models by means of a controlled voltage source (with a value equal to \nvconS/D) in series with the ideal semiconductor, either an IGBT or a diode; see Figures \n3.32 and 3.34. \n \na) Masked junction-to-case thermal model \nFigure 3.29. Thermal model for one leg of the LV output stage converter. \n\nChapter 3: Matlab/Simulink Implementation of a Three-stage Solid State Transformer Model \n \n67 \n \n \n \nb) Junction-to-case thermal model \n \nc) Junction-to-case thermal model \n \nd) Detailed view inside semiconductor case \nFigure 3.29. Thermal model for one leg of the LV output stage converter (cont.). \n\nAdvanced Modeling of Solid State Transformer \n \n68 \n \n \na) Masked heat sink block \n \nb) Detailed view of the heat sink model \nFigure 3.30. The heat sink model. \n \n\nChapter 3: Matlab/Simulink Implementation of a Three-stage Solid State Transformer Model \n \n69 \n \nSwitching losses: Two different approaches have been used to inject switching loss to \nswitch and diode model. Instantaneous injection approach that has been used for LV \nside converters of SST and average injection approach that has been used for injection \nof switching loss to the MV side converters of SST.  \nApproach 1: In this approach the instantaneous value of calculated loss will be injected \nto semiconductor model by means of controlled voltage sources and controlled current \nsource in one simulation time step. Instantaneous IGBT turn -on switching losses, \n∆P\nonsw, are incorporated by means of a series -connected controlled voltage source, with \nthe value of vsw1. Instantaneous IGBT turn-off switching losses, ∆Poffsw, are incorporated \nby means of a parallel-connected controlled current source, with the value i sw. Reverse \nrecovery diode losses, ∆PrecD, are incorporated by means of a parallel -connected \ncontrolled current source, whose value irecD. Figure 3.31 shows the calculation trend for \nthe values of controlled voltage and current sources for IGBT and diode to represent \nswitching losses using approach 1. Figure 3.32 shows the model of IGBT and \nantiparallel diode with the capability of representing semiconductor losses in SST using \nApproach 1. \nApproach 2: The representation of semiconductor losses by means of the previous \napproach incorporates semiconductor energy losses in a single simulation time step; this \ncan lead to high values of the controlled voltage sourc e and cause unstable performance \nof the MMC model. To solve this problem, a new approach for incorporating switching \nlosses is proposed: conduction losses are incorporated into semiconductor models in \nseveral time steps . The values of the instantaneous total losses of IGBTs and diodes, \nDP\ntotS and DPtotD, are obtained from calculation block; then t hese values are \nincorporated in semiconductor models by means of constant controlled voltage source s \n(in series with either an IGBT or a diode ), whose values, vswS and vrecD, are selected as a \npercentage, kS/D, of the SM capacitance voltage. This means that t he controlled voltage \nsource remains in conduction period for several time steps  to model the total \nsemiconductor losses. Figure 3.33 shows the calculation of the controlled voltage \nsource values for IGBT and diode. Figure 3.34 shows the combined model of IGBT and \nantiparallel diode with the capability of representing semiconductor losses using this \napproach. \n \na) IGBT controlled voltage source and controlled current source \n \nb) Diode controlled current source \nFigure 3.31. Loss calculation block for IGBTs and diodes – Approach 1. \n\nAdvanced Modeling of Solid State Transformer \n \n70 \n \n \nFigure 3.32. Incorporation of losses into the combined model of an IGBT and an antiparallel \ndiode – Approach 1. \n \na) IGBT controlled voltage source \n \nb) Diode controlled current source \nFigure 3.33. Loss calculation block for IGBT and diode. \n\nChapter 3: Matlab/Simulink Implementation of a Three-stage Solid State Transformer Model \n \n71 \n \n \nFigure 3.34. Incorporation of losses into the combined model of an IGBT and an antiparallel \ndiode – Approach 2. \n \n3.6. Conclusion \nThis chapter has summarized the MATLAB/Simulink implementation of the three-stage \nMMC-based SST model. A detailed description of configuration used for each stage \nalong with control strategies are given using the figures extracted from \nMatlab/Simulink. \nThe first aim is that the three -stage SST could present an efficient performance in \nsteady state and also under severe transient state both at the MV side and LV side:  such \nas voltage sag occurrence at MV side and load variation, load unbalance, nonlinear load \nconnection and short circuit occurrence at LV side. To fulfill these requirements, it is \nnecessary to present the proper topology and proper control technique for input stage, \nisolation stage and output stage. The procedure of implementing topologies and control \nstrategies for every stage are described in detail in this chapter. \nThe second aim is to provide realistic representation of SST with considering \nsemiconductor losses including conduction and switching losses. To implement \nsemiconductor losses: first, semiconductor losses are calculated from manufacturer \ndatasheets, but since losses depend on temperature, the semiconductor thermal models \nare included in converter models; second, the losses are incorporated as part of the \nsemiconductor model by means of controlled sources whose instantaneous values are \nobtained from the external calculation carried out in the first step. It is therefore a \nclosed-loop approach that uses information available in manufacturer data sheets. The \nimplementation of semiconductor losses for IGBT and diode through using controlled \nvoltage source and controlled current source is described in this chapter in detail. \n\nAdvanced Modeling of Solid State Transformer \n \n72 \n \nFinally, the three stage MMC -based SST has been implemented in Matlab/Simulink \nwith and without including semiconductor losses, and have been tested under different \ncases studies which proves the proper performance of implemented SST. \n3.7. References \n[3.1] Available at: https://es.mathworks.com/matlabcentral/fileexchange/35980-loss-\ncalculation-in-a-buck-converter-using-simpowersystems-and-simscape. \n[3.2] Available at: https://es.mathworks.com/help/physmod/sps/examples/loss-calculation-in-\na-three-phase-3-level-inverter.html. \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n  \n \n \n \n \n \n \nChapter4 \nSimulation Results \n \n \n4.1. Introduction \nIn this chapter, simulation results derived from two test system are presented . The first \ntest system is a stand-alone SST whose model does not consider semiconductor losses.  \nThe second test system is a MV distribution system to which a SST is connected. For \nthis second study the SST model includes semiconductor losses . Up to six different test \ncases have been analyzed with the two test systems to evaluate the performance of SST . \nThe test cases are listed below: \n1. Unbalanced voltage sag and swell at the point of common coupling (PCC) at the \ninput stage of SST. \n2. Secondary side load variation. \n3. Secondary side load unbalance. \n4. Nonlinear load at the secondary side. \n5. Short-circuit at the secondary side. \n6. Power flow reversal. \nSections 4.2 and 4.3 present the test systems, the test cases simulated with each system \nand a discussion about the results and the performance of each SST model.  \n \n4.2. Simulation Results with a Lossless Stand- alone SST  \nModel \n4.2.1. Test system and test cases \nThe model of the SST has been implemented in Matlab/Simulink assuming the \nparameters listed in Table 4.1. The test system is that o btained when joining the three \nstages depicted in Figures 2.2, 2.8 and 2.10. This configuration will be used to evaluate \nthe behavior of the SST model under dynamic and unbalanced conditions (voltage sags, \nload increment, load unbalance, nonlinear load, short circuit), and operation conditions \nAdvanced Modeling of Solid State Transformer \n \n74 \n \nthat could cause power flow reversal (i.e., active power flowing from the LV to the MV \nside). \nTable 4.1. Fist case study - SST parameters \nParameters Values \nLine-to-line grid voltage (rms) 12 kV \nGrid-side filter resistance (R1) 0.1 Ω \nGrid-side filter inductance (L1) 10 mH \nNumber of SMs per MMC arm  6 \nSM capacitance in MMC1&MMC2 0.4 mF \nArm resistance of MMC1 0.2 Ω \nArm inductance of MMC1 5 mH \nMMC1 switching frequency 10 kHz \nMV-side dc link capacitance  1 mF \nArm resistance of MMC2 0.001 \nArm inductance of MMC2 0.1 mH \nMV MMC2 and LV full bridge converter switching frequency 10 kHz \nTransformer operating frequency 1 kHz \nTransformer short-circuit resistance 0.005 Ω \nTransformer leakage inductance 0.03 mH \nLV-side dc link capacitance  3 mF \nLV-side converter switching frequency 10 kHz \nLoad-side filter resistance (R2) 0.01 Ω \nLoad-side filter inductance (L2) 0.9 mH \nLoad-side filter capacitance (C2) 200 µF \nNeutral resistance (Rn2) 0.01 Ω \nNeutral inductance (Ln2) 0.3 mH \n \nAll test cases have been simulated assuming the rated power of the SST is below 250 \nkVA. Remember that semiconductor losses are neglected, so semiconductor ratings are \nirrelevant for this study. The reactive power to be measured at the MV t erminals of the \nSST will be always close to zero; that is, the SST will compensate at the MV terminals \nthe reactive power measured at the LV terminals, irrespective of its value and direction. \nThe simulation results derived from several test cases carried out to evaluate the \nperformance of the proposed SST model are presented below. The operating conditions \nfor each test case are based on those considered in [4.1]-[4.3]. \n1. Unbalanced voltage sag at the primary side  (see Figure 4.1): A voltage sag occurs \nat the source that feds the MV side of the SST. Between 1200 and 1600 ms \nvoltages of phases A and B experiments a reduction. As observed from Figure 4.1, \nthe distorted voltages and currents at MV side do not affect voltages the LV side; \nthat is, the voltage sag is not propagated to the LV stage of the SST, and the load \ncurrents will remain balanced as they were prior to the sag occurrence (see Figure \n4.1). \n2. Secondary load variation (Figure 4.2): A load variation that causes an increment of \nthe LV -side currents occurs between 1200 and 1600 ms. The increment of the \nbalanced secondary currents do not cause any variation of the voltage supplied \nfrom the output stage of the SST. One can also observe from Figure 4.2 how the \nMV-side currents vary following a pattern very similar to that exhibited by LV-side \nload currents. \nChapter 4: Simulation Results \n \n75 \n \n \na) Primary side voltages \n \nb) Primary side currents \n \nc) Primary side active and reactive powers \nFigure 4.1.  Test System 1 - Simulation results: Voltage sag at the MV side. \nVoltage  (kV)\n-15\n-10\n-5\n0\n5\n10\n15\nTime (s)\n1.1 1.2 1.3 1.4 1.5 1.6 1.7 1.8 1.9\nTime (s)\n1.1 1.2 1.3 1.4 1.5 1.6 1.7 1.8\nCurrent  (A)\n-40\n0\n20\n40\n-20\n1.9\nPower  (kW/kVar)\n-200\n400\nTime (s)\n1.1 1.2 1.3 1.4 1.5 1.6 1.7 1.8 1.9\n200\n0\nP\nQ\nAdvanced Modeling of Solid State Transformer \n \n76 \n \n \nd) Secondary side voltages \n \ne) Secondary side currents \n \nf) Secondary side active and reactive powers \nFigure 4.1.  Test System 1 - Simulation results: Voltage sag at the MV side (cont.). \nVoltage  (V)\n-400\n-200\n0\n200\n400\nTime (s)\n1.1 1.2 1.3 1.4 1.5 1.6 1.7 1.8 1.9\nCurrent  (A)\n-500\n-250\n0\n250\n500\nTime (s)\n1.1 1.2 1.3 1.4 1.5 1.6 1.7 1.8 1.9\nPower  (kW/kVar)\n-200\n400\nTime (s)\n1.1 1.2 1.3 1.4 1.5 1.6 1.7 1.8 1.9\n200\n0\nP\nQ\nChapter 4: Simulation Results \n \n77 \n \n \na) Primary side voltages \n \nb) Primary side currents \n \nc) Primary side active and reactive powers \nFigure 4.2.  Test System 1 - Simulation results: LV-side load variation. \nVoltage  (kV)\n-15\n-10\n-5\n0\n5\n10\n15\nTime (s)\n1.1 1.2 1.3 1.4 1.5 1.6 1.7 1.8 1.9\nTime (s)\n1.1 1.2 1.3 1.4 1.5 1.6 1.7 1.8\nCurrent  (A)\n-40\n0\n20\n40\n-20\n1.9\nPower  (kW/kVar)\n-200\n400\nTime (s)\n1.1 1.2 1.3 1.4 1.5 1.6 1.7 1.8 1.9\n200\n0\nP\nQ\nAdvanced Modeling of Solid State Transformer \n \n78 \n \n \nd) Secondary side voltages \n \ne) Secondary side currents \n \nf) Secondary side active and reactive powers \nFigure 4.2.  Test System 1 - Simulation results: LV-side load variation (cont.). \n \n \nVoltage  (V)\n-400\n-200\n0\n200\n400\nTime (s)\n1.1 1.2 1.3 1.4 1.5 1.6 1.7 1.8 1.9\nCurrent  (A)\n-800\n-400\n0\n400\n800\nTime (s)\n1.1 1.2 1.3 1.4 1.5 1.6 1.7 1.8 1.9\nPower  (kW/kVar)\n-200\n400\nTime (s)\n1.1 1.2 1.3 1.4 1.5 1.6 1.7 1.8 1.9\n200\n0\nP\nQ\nChapter 4: Simulation Results \n \n79 \n \n3. Secondary load unbalance  (Figure 4.3): A current unbalance is caused to initially \nbalanced load currents. The unbalance is due to an increase of the current in two \nload phases. Results present in Figure 4.3 proves that the secondary phase voltages \nremain constant during the load variation and the current unbalance is not \npropagated to the input stage where the three phase currents increase \nsimultaneously without exhibiting any unbalance. \n4. Nonlinear and unbalance secondary load (Figure 4.4): three- phase diode rectifier \nwhich serves as nonlinear load is connected to the LV stage of SST. One can also \nobserve from Figure 4.4 that the LV-side voltages are not affected by the secondary \nnonlinear load/current due to the capability of HVC control strategy implemented \nat LV stage; however, t he MV -side currents remain always balanced and they \nfollow a similar pattern to that exhibited by the secondary LV-side currents. \n5. Short-circuit at the secondary side  (Figure 4.5): A three -phase short circuit with \nfault resistance of 0.1 occurs at the LV terminals of the SST. Theoretically, this \nshould cause a large increase of the phase currents at the LV SST terminals. \nHowever, the voltage drop experienced at the secondary side of the SST \nsignificantly reduces the short -circuit currents, although the phase  currents are \nlarger than before the short -circuit occurrence. The combination of lower voltages \nand larger currents causes a reduction of both the active and reactive powers \nmeasured at the LV terminals. This means that the active power measured at the \nMV terminals will also be lower than before the short- circuit occurrence \n(remember that the reactive power is close to zero at the MV side). As a \nconsequence the currents flowing into the SST at the MV terminals will be lower \nduring the fault condition than before; that is, the SST prevents from propagating \nthe short-circuit overcurrents to the MV grid. \n6. Power flow reversal  (Figure 4.6): The SST is initially operating in generation \nmode; that is, generation is initially predominant in the secondary side and the \nactive power flows from the output stage (LV side) to the input stage (MV side) of \nthe SST. Reactive power measured at the LV -side terminals is initially zero. A \nvariation of the secondary load causes a reversal of the active power flow and an \nincrement of the reactive power. Results presented in Figure 4.6 show the response \nof the SST: as soon as the secondary -side power flow reversal is noticed, the SST \ncontrollers act and they allow active power to flow from the MV side to the LV \nside, while the reactive power measured at the MV terminals remain close to zero, \nirrespective of the reactive power measured at the LV terminals. Other results not \nshown in Figure 4.6 support the feasibility of the SST since the secondary -side \nvoltages are not affected by th e transient due to the power flow reversal, and both \nMV- and LV-side currents remain balanced. \n \nIn summary, the study of these case studies proves the robustness of the SST in front \nof some severe operating conditions (i.e. voltage sag occurrence at the pr imary \nterminals, fault condition at the secondary terminals), the possibility of providing unity \npower factor at the MV side of SST, stable behavior of MV and LV DC links, \nbalanced capacitance voltages in MMC arms under both steady state and transient \nconditions, capability to cancel negative and zero sequence voltage (thus providing \nthree-phase balanced voltage when connected to unbalanced load), harmonic voltage \ncompensation with nonlinear load, current limiting in case of short circuit at the low \nvoltage stage, and bidirectional power flow capability. \n \nAdvanced Modeling of Solid State Transformer \n \n80 \n \n \na) Primary side voltages \n \nb) Primary side currents \n \nc) Primary side active and reactive powers \nFigure 4.3.  Test System 1 - Simulation results: Unbalanced LV-side load. \nVoltage  (kV)\n-15\n-10\n-5\n0\n5\n10\n15\nTime (s)\n1.1 1.2 1.3 1.4 1.5 1.6 1.7 1.8 1.9\nTime (s)\n1.1 1.2 1.3 1.4 1.5 1.6 1.7 1.8\nCurrent  (A)\n-30\n0\n10\n30\n-20\n1.9\n-10\n20\nPower  (kW/kVar)\n-200\n400\nTime (s)\n1.1 1.2 1.3 1.4 1.5 1.6 1.7 1.8 1.9\n200\n0\nP\nQ\nChapter 4: Simulation Results \n \n81 \n \n \nd) Secondary side voltages \n \ne) Secondary side currents \n \nf) Secondary side active and reactive power \nFigure 4.3.  Test System 1 - Simulation results: Unbalanced LV-side load (cont.). \nVoltage  (V)\n-400\n-200\n0\n200\n400\nTime (s)\n1.1 1.2 1.3 1.4 1.5 1.6 1.7 1.8 1.9\nCurrent  (A)\n-600\n-300\n0\n300\n600\nTime (s)\n1.1 1.2 1.3 1.4 1.5 1.6 1.7 1.8 1.9\nPower  (kW/kVar)\n-200\n400\nTime (s)\n1.1 1.2 1.3 1.4 1.5 1.6 1.7 1.8 1.9\n200\n0\nP\nQ\nAdvanced Modeling of Solid State Transformer \n \n82 \n \n \na) Primary side voltages \n \nb) Primary side currents \n \nc) Primary side active and reactive powers \nFigure 4.4.  Test System 1 - Simulation results: Nonlinear LV-side load. \nVoltage  (kV)\n-15\n-10\n-5\n0\n5\n10\n15\nTime (s)\n1.1 1.2 1.3 1.4 1.5 1.6 1.7 1.8 1.9\nTime (s)\n1.1 1.2 1.3 1.4 1.5 1.6 1.7 1.8\nCurrent  (A)\n-30\n0\n10\n30\n-20\n1.9\n-10\n20\nPower  (kW/kVar)\n-200\n400\nTime (s)\n1.1 1.2 1.3 1.4 1.5 1.6 1.7 1.8 1.9\n200\n0\nP\nQ\nChapter 4: Simulation Results \n \n83 \n \n \nd) Secondary side voltages \n \ne) Secondary side currents \n \nf) Secondary side active and reactive powers \nFigure 4.4.  Test System 1 - Simulation results: Nonlinear LV-side load (cont.). \nVoltage  (V)\n-400\n-200\n0\n200\n400\nTime (s)\n1.1 1.2 1.3 1.4 1.5 1.6 1.7 1.8 1.9\nCurrent  (A)\n-600\n-200\n0\n400\n600\nTime (s)\n1.1 1.2 1.3 1.4 1.5 1.6 1.7 1.8 1.9\n200\n-400Power  (kW/kVar)\n-200\n400\nTime (s)\n1.1 1.2 1.3 1.4 1.5 1.6 1.7 1.8 1.9\n200\n0\nP\nQ\nAdvanced Modeling of Solid State Transformer \n \n84 \n \n \na) Primary side voltages \n \nb) Primary side currents \n \nc) Primary side active and reactive powers \nFigure 4.5.  Test System 1 - Simulation results: Short-circuit at the LV terminals. \nVoltage  (kV)\n-15\n-10\n-5\n0\n5\n10\n15\nTime (s)\n1.1 1.2 1.3 1.4 1.5 1.6 1.7 1.8 1.9\nTime (s)\n1.1 1.2 1.3 1.4 1.5 1.6 1.7 1.8\nCurrent  (A)\n-30\n0\n10\n30\n-20\n1.9\n-10\n20\nPower  (kW/kVar)\n-200\n400\nTime (s)\n1.1 1.2 1.3 1.4 1.5 1.6 1.7 1.8 1.9\n200\n0\nP\nQ\nChapter 4: Simulation Results \n \n85 \n \n \nd) Secondary side voltages \n \ne) Secondary side currents \n \nf) Secondary side active and reactive powers \nFigure 4.5.  Test System 1 - Simulation results: Short-circuit at the LV terminals (cont.). \nVoltage  (V)\n-400\n-200\n0\n200\n400\nTime (s)\n1.1 1.2 1.3 1.4 1.5 1.6 1.7 1.8 1.9\nCurrent  (A)\n-800\n-400\n0\n400\n800\nTime (s)\n1.1 1.2 1.3 1.4 1.5 1.6 1.7 1.8 1.9\nPower  (kW/kVar)\n-200\n400\nTime (s)\n1.1 1.2 1.3 1.4 1.5 1.6 1.7 1.8 1.9\n200\n0\nP\nQ\nAdvanced Modeling of Solid State Transformer \n \n86 \n \n \na) Primary side voltage and current - Phase A \n \nb) Primary side voltage and current - Phase B \n \nc) Primary side active and reactive powers \nFigure 4.6.  Test System 1 - Simulation results: Power flow reversal. \nV&I of phase  a\n-20\n0\n10\n20\n-10\nTime (sec)\n1.4 1.6 1.8 2 2.4 2.61.2 2.2\nvoltage (kV)\nCurrent (A)\nV&I of phase  b\n-20\n0\n10\n20\n-10\nTime (sec)\n1.4 1.6 1.8 2 2.4 2.61.2 2.2\nvoltage (kV)\nCurrent (A)\nTime (sec)\n1.4 1.6 1.8 2 2.4 2.6\nPower  (kW/kVar)\n-300\n-200\n0\n200\n300\n1.2 2.2\nP\nQ\n-100\n100\nChapter 4: Simulation Results \n \n87 \n \n \nd) Secondary side voltage and current - Phase a \n \ne) Secondary side voltage and current - Phase b \n \nf) Secondary side active and reactive powers \nFigure 4.6.  Test System 1 - Simulation results: Power flow reversal (cont.). \n \n \nV&I of phase  a\n-600\nTime (sec)\n1.4 1.6 1.8 2 2.4 2.61.2 2.2\n-400\n-200\n0\n400\n600\n200\nvoltage (V)\nCurrent (A)\nV&I of phase  b\n-600\nTime (sec)\n1.4 1.6 1.8 2 2.4 2.61.2 2.2\nvoltage (V)\nCurrent (A)\n-400\n-200\n0\n400\n600\n200\nPower  (kW/kVar)\n-300\n-200\n0\n100\n300\nTime (sec)\n1.4 1.6 1.8 2 2.4 2.61.2 2.2\nP\nQ\n-100\n200\nAdvanced Modeling of Solid State Transformer \n \n88 \n \n4.2.2. Discussion \n1. The behavior of the MMC -based SST can be quickly deduced from the results \npresented above: SST allows power flow reversal while maintaining voltages at each \nside to their values; unbalanced and/or non- sinusoidal currents at any SST side are \nnot propagated to the other side; a close -to-unity power factor is maintained at the \ninput terminals, while both active and reactive powers are measured at the LV \nterminals depending of the secondary side load. \n2. The simulation results presented above show the SST behavior seen from both MV - \nand LV-side terminals. However, it is also important to analyze the response of the \nconverter models, mainly those selected for representing the MV input stage. Figures \n4.7 through 4.10 show the transient response of the voltages in MV - and LV-side dc \nlinks, as well as the transient voltage of an upper arm SM capacitance, corresponding \nto some of the test cases analyzed in the previous subsection. A common patte rn can \nbe deduced from all these responses:  \n• DC link voltages at both the MV - and the LV -sides exhibit a quick variation at \nthe beginning and the end of the transient, but in both moments the voltages \nquickly recover their initial values. \n• The voltage variation peaks depend on the event being analyzed but also on the \nparameters selected for representing dc links and controllers at both SST sides. \nObviously larger dc link capacitors will suffer lower voltage variations. In most \ncases presented in Figures 4.7 through 4.10, the voltage variations are within the \n1% of the selected voltage for the MV -side dc link; however, the variations of \nthe secondary side dc link voltage can reach about 20% of the reference voltage \nin case of short circuit at the LV terminals or power flow reversal (see Figures \n4.9.c and 4.10.c). \n• The variations of the SM capacitance voltages are within a 5% margin in all \ncases. On the other hand, the differences between voltages of different SM \ncapacitances or even different MMC legs are also v ery smalls (i.e. within a 2% \nmargin). \n3. An important aspect to be considered is the ride -through capabilities of the SST. Just \nconsider the case presented in Figure 4.1, which presents the SST response in front \nof voltage sags at the primary side. The behavi or of the SST in this case is optimum; \nthe sag is not propagated to the secondary side whose load will not notice the event. \nHowever, it is important to take into account that there is a limit to the sag severity \nthe SST can cope with and that limit depends on the parameters selected for the \npower converters and their controllers.  \nIn other words, the SST would not be able to survive if the residual voltages at the \nthree MV-side phase voltages were too low. A similar reasoning should be followed \nin case of short -circuit. If the short -circuit currents were not limited under certain \nvalue and the parameters of the secondary side converter were not adequately \nselected, the LV -side dc link would not be capable of recovering its voltage after a \nquick and deep discharge caused by a bold three-phase short circuit. \n \n \n \n \n \n \nChapter 4: Simulation Results \n \n89 \n \n \na) MV-side dc link voltage \n \nb) Capacitance voltage of upper arm of phase a \n \nc) LV-side dc link voltage \nFigure 4.7.  Simulation results: Voltage sag at the MV side. \nVoltage  (kV)\n20.6\n21\n21.4\nTime (s)\n1.1 1.2 1.3 1.4 1.5 1.6 1.7 1.8 1.9\nVoltage  (kV)\n3.4\n3.45\n3.5\n3.55\n3.6\nTime (s)\n1.1 1.2 1.3 1.4 1.5 1.6 1.7 1.8 1.9\nVoltage  (V)\n600\n1000\n1400\nTime (s)\n1.1 1.2 1.3 1.4 1.5 1.6 1.7 1.8 1.9\nAdvanced Modeling of Solid State Transformer \n \n90 \n \n \na) MV-side dc link voltage \n \nb) Capacitance voltage of upper arm of phase a \n \nc) LV-side dc link voltage \nFigure 4.8.  Simulation results: LV-side load variation. \nVoltage  (kV)\n20.6\n21\n21.4\nTime (s)\n1.1 1.2 1.3 1.4 1.5 1.6 1.7 1.8 1.9\nVoltage  (kV)\n3.4\n3.45\n3.5\n3.55\n3.6\nTime (s)\n1.1 1.2 1.3 1.4 1.5 1.6 1.7 1.8 1.9\nVoltage  (V)\n600\n1000\n1400\nTime (s)\n1.1 1.2 1.3 1.4 1.5 1.6 1.7 1.8 1.9\nChapter 4: Simulation Results \n \n91 \n \n \na) MV-side dc link voltage \n \nb) Capacitance voltage of positive arm of phase a \n \nc) LV-side dc link voltage \nFigure 4.9.  Simulation results: Short-circuit at the LV side. \nVoltage  (kV)\n20.6\n21\n21.4\nTime (s)\n1.1 1.2 1.3 1.4 1.5 1.6 1.7 1.8 1.9\nVoltage  (kV)\n3.4\n3.45\n3.5\n3.55\n3.6\nTime (s)\n1.1 1.2 1.3 1.4 1.5 1.6 1.7 1.8 1.9\nVoltage  (V)\n600\n1000\n1400\nTime (s)\n1.1 1.2 1.3 1.4 1.5 1.6 1.7 1.8 1.9\nAdvanced Modeling of Solid State Transformer \n \n92 \n \n \na) MV-side dc link voltage \n \nb) Capacitance voltage of positive arm of phase a \n \nc) LV-side dc link voltage \nFigure 4.10.  Simulation results: Power flow reversal. \n \n \nVoltage  (kV)\n20.6\n21\n21.4\nTime (sec)\n1.4 1.6 1.8 2 2.4 2.61.2 2.2\nVoltage  (kV)\n3.4\n3.45\n3.5\n3.55\n3.6\nTime (sec)\n1.4 1.6 1.8 2 2.4 2.61.2 2.2\nVoltage  (V)\n600\n1000\n1400\nTime (sec)\n1.4 1.6 1.8 2 2.4 2.61.2 2.2\nChapter 4: Simulation Results \n \n93 \n \n4. Sensitivity analysis for short circuit:  In this section the aim is to study the different \nfactors that can have an impact on performance of SST when short circuit occurs at \nlow voltage terminal of SST. Three important factors regarding to this issue are: fault \nresistance (R\nsc), the upper and lower limit of short circuit current limiter, and the \ncontrol parameters. The control coefficients in outer voltage controllers and inner \ncurrent controllers are tuned in order to provide desired reference signals for \nmodulation technique (3D-SVM). The effects of R\nsc and upper/lower limit value are \ngoing to be discussed below. It should be noted that the test system is a 500 kW SST. \nThe load voltage (rms value) and fault current (rms value) are shown in F igure 4.11. \nThe diagram is achieved through selecting nine different values from 0 to 3 (0, 0.1, \n0.2, 0.5, 1, 1.5, 2, 2.5, 3) for fault resistance ( Rsc) and two different values for upper \nand lower limit of short circuit current limiter. Limit 1 has smaller value than limit 2 \n(limit 1=1500 A, limit 2=1800 A). As it can be observed from F igure 4.11, the load \nvoltage and fault current are increased and decreased respectively, by increasing Rsc. \n \na) Load voltage \n \nb) Fault current \nFigure 4.11.  Simulation results: short circuit at the secondary side. \n \n \n \n0 0.5 1 1.5 2 2.5 30\n50\n100\n150\n200\n250\nVoltage  (V)\n()SCR Ω\nlimit1\nlimit2\n0 0.5 1 1.5 2 2.5 30\n200\n400\n600\n800\n1000\n1200Current  (A) limit1\nlimit2\n()SCR Ω\nAdvanced Modeling of Solid State Transformer \n \n94 \n \n4.3. Simulation Results with Semiconductor Losses \n4.3.1. SST model \nThe performance of the lossy SST model has been evaluated as a part of a MV \ndistribution system. The model of the SST with semiconductor losses has been \nimplemented in Matlab/Simulink assuming the parameters listed in Table 4.2. \nTable 4.2. Second case study - SST parameters \nParameters Values \nSST rated power 500 kVA \nLine-to-line grid voltage (rms) 12 kV \nSST input stage filter resistance (R1) 0.1 Ω \nSST input stage filter inductance (L1) 10 mH \nNumber of SMs per MMC arm  6 \nSM capacitance in MMC1&MMC2 0.4 mF \nArm resistance of MMC1 0.2 Ω \nArm inductance of MMC1 5 mH \nMMC1 switching frequency 2 kHz \nMV-side dc link capacitance  1 mF \nArm resistance of MMC2 0.01 \nArm inductance of MMC2 0.3 mH \nMV MMC2 and LV full bridge converter switching frequency 10 kHz \nTransformer operating frequency 1 kHz \nTransformer short-circuit resistance 0.001 Ω \nTransformer leakage inductance 0.03 mH \nLV-side dc link capacitance  8 mF \nLV-side converter switching frequency 3 kHz \nLoad-side filter resistance (R2) 0.001 Ω \nLoad-side filter inductance (L2) 0.3 mH \nLoad-side filter capacitance (C2) 800 µF \nNeutral resistance (Rn2) 0.001 Ω \nNeutral inductance (Ln2) 0.1 mH \n \nIn additional to the test of the performance of the SST model as part of the distribution \nsystem, this section includes some additional studies aimed at estimating the \nperformance of the lossy model. The goal of the first study is to estimate the efficienc y \nof a SST model in which semiconductor losses are accounted for. The second study \nanalyzes the thermal behavior of the SST model. \n \n4.3.2. SST Efficiency \nA 500 kVA SST model with semiconductor loss es has been studied to estimate its \nefficiency. The study has been carried by selecting five different values (i.e. 100, 200, \n300, 400, and 500 kVA ) for the apparent power of load and eight different values (i.e. \n0.1, 0.2, 0.4, 0.6, 0.7, 0.8, 0.9 and 1)  for the load power factor. Figure 4.12 shows  the \nefficiency curves for SST. \n \nChapter 4: Simulation Results \n \n95 \n \nS (kVA)\n0 100 200 300 400 500\nefficiency (%)\n0\n10\n20\n30\n40\n50\n60\n70\n80\n90\n100\nPF=1\nPF=0.9\nPF=0.8\nPF=0.7\nPF=0.6\nPF=0.4\nPF=0.2\nPF=0.1\n \nFigure 4.12. SST efficiency curves. \n4.3.3. Analysis of the thermal behavior \nFigure 4.13 shows the junction temperature values for the IGBT and diode of one phase \n(S1 and D1 in Figure 2.10) of the LV stage using the thermal model detailed in previous \nchapters. Figure 4.14 shows the junction temperature for the IGBT and diode (S 1r and \nD1r in Figure 2.8) for the full-bridge rectifier of the isolation stage. \nIt should be noted that the results were obtained by assuming a common heat sink for \neach converter (see Figure 2.20); that is, up to 16 semiconductors (8 IGBTs and 8 \nantiparallel diodes) are mounted on one heat sink for the LV stage converter, and 8 \nsemiconductors (4 IGBTs and 4 antiparallel diode s) are mounted on another common \nheat sink; see Figures 2.8 and 2.10. The thermal parameters that are needed for \nmodeling the thermal behavior of SST in LV are given in table 2.6. \nThe values of resistances and capacitances selected for common heat sink thermal \nmodels are: \n• Case to heat sink thermal resistance (R\nc) 0.010 ℃/W \n• Heat sink to ambient thermal resistance (Rs) 0.010 ℃/W \n• Heat sink to ambient thermal capacitance (Cs) 0.250 J/℃. \n \n4.3.4. Test system and test cases \nFigure 4.15 shows the configuration and parameters of the distribution test system \nanalyzed in this section. S imulation results corresponding to operating conditions \nsimilar to those analyzed in the previous section with the lossless SST model are \npresented here. It should be noted that for thes es case studies semiconductor losses has \nbeen included in semiconductor model.  \nFive test cases (cases 2 through 6) are basically those analyzed in the previous section, \nso no additional details are needed about them . The only case for which some \nintroduction is required is the first one, in which the response of the SST in form of \nvoltage sags and swells at the MV terminals is studied . Since the variations that MV \ninput voltages can exhibit may lead to converter instability when connected to a weak \ngrid, the MV -side PLL has been modified to account for large deviations  of MV \ndistribution system voltages [4.4]. \nAdvanced Modeling of Solid State Transformer \n \n96 \n \n \na) Junction temperature of IGBTs \n \nb) Junction temperature of diodes \nFigure 4.13. Junction temperature of IGBTs and diodes - LV side converter – Phase a \n \na) Junction temperature of IGBTs \n \nb) Junction temperature of diodes \nFigure 4.14. Junction temperature of IGBT and diode of full bridge rectifier in isolation stage. \nTime (s)\n0.5 0.6 0.7 0.8 0.9 1\nTjS1\n20\n40\n60\n80\n100\n120\n0\nTime (s)\n0.5 0.6 0.7 0.8 0.9 1\nTjD1\n20\n40\n60\n80\n100\n120\n0\nTime (s)\n0.9 0.92 1\nTjS1\n20\n40\n60\n80\n100\n120\nr\n0.94 0.96 0.98\n0\nTime (s)\n0.9 0.92 1\nTjD1\n20\n40\n60\n80\n100\n120\nr\n0.94 0.96 0.98\nChapter 4: Simulation Results \n \n97 \n \nThe PLL is used as a synchronization block that generates the reference angle used in \ncontrollers. PLL is going to have negative impact through increasing the real part of \nconverter impedance and also increasing unwanted coupling to impedance of \ndistribution grid [4.5] -[4.6]. The mentioned negative impacts of PLL are not paid \nattention too much when the converter is connected to stiff AC distribution grid (it \nmeans that grid with low impedance value), but in case that voltage source converters \nare connected to weak AC distribution grids (it means that the grids with high \nimpedance values) it is becoming very important to avoid a distorted AC voltage at the \npoint of common coupling (PCC).  \nPLL negative effect can be decreased through reduction of PI gains of PLL but it should \nbe taken in to consideration that great reduction of gains i s restricted by converter \nlimitation performance [4.7]. In our work positive-sequence voltage at the input stage of \nSST is used to obtain the angle for synchronization purposes by means of a phase -\nlocked loop (PLL). The undesirable problem of PLL negative effect has been modified \nthrough reduction of PI gains of PLL and tuning the dc voltage controller parameters as \nproposed in [4.8]. \nAssume that a two -phase-to-ground short circuit fault occurs b etween 1200 and 1600 \nms in the distribution system (see fault location in Figure 4.15); t his causes a voltage \nsag in two MV terminals and a voltage swell in one MV terminal of the SST . \nSimulation results depicted in Figure 4.16 confirm that under these conditions the \ncurrents at the primary side are balanced and the SST prevents the propagation of the \nvoltage unbalance from the MV side to the LV side.  \nAs it can be seen from the plots of Figures 4.16.d and 4.16.e, the voltage and current  at \nthe output stage of SST are completely balanced without being affected by the severe \ntransient event that occur s at the MV terminals  of the SST. This case illustrates the \npositive impact of the new PLL, which can avoid instabilities within the MV-side MMC \nand also the capability of three -stage SST in isolating input side from output  stage \nthrough using isolation stage. \nFigures 4.17 through 4.25 show the simulation results obtained with the other test cases. \n \n \nFigure 4.15. Test System 2 - Configuration of the distribution network. \nEquivalent \nimpedance\n110 kV\nAll line sections\nR0 = 1.0924 Ω/km , L0 = 3.9203 mH/km , C0 = 5.0083 nF/km\nR1 = 0.6962 Ω/km , L1 = 1.3777 mH/km , C1 = 10.0753 nF/km\n4.77\nkm\n5.71\nkm\n1.55\nkm\n0.96\nkm\n0.58\nkm\n3.55\nkm\n0.88\nkm\n1.31\nkm\n0.93\nkm\n0.60\nkm\n0.78\nkm\n5.61\nkm\n0.59\nkm\n1.62\nkm\n1.84\nkm\n0.57\nkm\n1.30\nkm\n0.69\nkm\n110/12 kV\n1000 kVA\nRw = 1%, Xw = 8%\n0.89\nkm\n3.11\nkm\n800 808\n816\n824\n826\n810\n830 854\n856\n858\n864\n834\n860\n838\n840\n836\n844\n846\n848\n822\n820\nSST1\nFault\nAdvanced Modeling of Solid State Transformer \n \n98 \n \n \na) Primary side voltages \n \nb) Primary side currents \n \nc) Primary side active and reactive powers \nFigure 4.16.  Test System 2 - Simulation results: Voltage sag at the MV side. \nVoltage  (kV)\n-15\n-10\n-5\n0\n5\n10\n15\nTime (s)\n1.1 1.2 1.3 1.4 1.5 1.6 1.7 1.8 1.9\nTime (s)\n1.1 1.2 1.3 1.4 1.5 1.6 1.7 1.8\nCurrent  (A)\n-60\n-40\n0\n20\n40\n60\n-20\n1.9\nPower  (kW/kVar)\n-300\n600\nTime (s)\n1.1 1.2 1.3 1.4 1.5 1.6 1.7 1.8 1.9\n300\n0\nP\nQ\nChapter 4: Simulation Results \n \n99 \n \n \nd) Secondary side voltages \n \ne) Secondary side currents \n \nf) Secondary side active and reactive powers \nFigure 4.16.  Test System 2 - Simulation results: Voltage sag at the MV side (cont.). \nVoltage  (V)\n-400\n-200\n0\n200\n400\nTime (s)\n1.1 1.2 1.3 1.4 1.5 1.6 1.7 1.8 1.9\nCurrent  (A)\n-800\n-400\n0\n400\n800\nTime (s)\n1.1 1.2 1.3 1.4 1.5 1.6 1.7 1.8 1.9\nPower  (kW/kVar)\n-300\n600\nTime (s)\n1.1 1.2 1.3 1.4 1.5 1.6 1.7 1.8 1.9\n300\n0\nP\nQ\nAdvanced Modeling of Solid State Transformer \n \n100 \n \n \na) Primary side voltages \n \nb) Primary side currents \n \nc) Primary side active and reactive powers \nFigure 4.17.  Test System 2 - Simulation results: LV-side load variation. \nVoltage  (kV)\n-15\n-10\n-5\n0\n5\n10\n15\nTime (s)\n1.1 1.2 1.3 1.4 1.5 1.6 1.7 1.8 1.9\nCurrent  (A)\n-60\n-40\n0\n20\n40\n60\n-20\nTime (s)\n1.1 1.2 1.3 1.4 1.5 1.6 1.7 1.8 1.9\nPower  (kW/kVar)\n-200\n0\n600\n800\nTime (s)\n1.1 1.2 1.3 1.4 1.5 1.6 1.7 1.8 1.9\n400\n200\nP\nQ\nChapter 4: Simulation Results \n \n101 \n \n \nd) Secondary side voltages \n \ne) Secondary side currents \n \nf) Secondary side active and reactive powers \nFigure 4.17.  Test System 2 - Simulation results: LV-side load variation (cont.). \nVoltage  (V)\n-400\n-200\n0\n200\n400\nTime (s)\n1.1 1.2 1.3 1.4 1.5 1.6 1.7 1.8 1.9\nCurrent  (A)\n-1200\n-800\n-400\n0\n400\n800\n1200\nTime (s)\n1.1 1.2 1.3 1.4 1.5 1.6 1.7 1.8 1.9\nPower  (kW/kVar)\n-200\n0\n600\n800\nTime (s)\n1.1 1.2 1.3 1.4 1.5 1.6 1.7 1.8 1.9\n400\n200\nP\nQ\nAdvanced Modeling of Solid State Transformer \n \n102 \n \n \na) Primary side voltages \n \nb) Primary side currents \n \nc) Primary side active and reactive powers \nFigure 4.18.  Test System 2 - Simulation results: Unbalanced LV-side load. \nVoltage  (kV)\n-15\n-10\n-5\n0\n5\n10\n15\nTime (s)\n1.1 1.2 1.3 1.4 1.5 1.6 1.7 1.8 1.9\nCurrent  (A)\n-60\n-40\n0\n20\n40\n60\n-20\nTime (s)\n1.1 1.2 1.3 1.4 1.5 1.6 1.7 1.8 1.9\nPower  (kW/kVar)\n-200\n0\n600\nTime (s)\n1.1 1.2 1.3 1.4 1.5 1.6 1.7 1.8 1.9\n400\n200\nP\nQ\nChapter 4: Simulation Results \n \n103 \n \n \nd) Secondary side voltages \n \ne) Secondary side currents \n \nf) Secondary side active and reactive powers \nFigure 4.18.  Test System 2 - Simulation results: Unbalanced LV-side load (cont.). \nVoltage  (V)\n-400\n-200\n0\n200\n400\nTime (s)\n1.1 1.2 1.3 1.4 1.5 1.6 1.7 1.8 1.9\nCurrent  (A)\n-1000\n-500\n0\n500\n1000\nTime (s)\n1.1 1.2 1.3 1.4 1.5 1.6 1.7 1.8 1.9\nPower  (kW/kVar)\n-200\n0\n600\nTime (s)\n1.1 1.2 1.3 1.4 1.5 1.6 1.7 1.8 1.9\n400\n200\nP\nQ\nAdvanced Modeling of Solid State Transformer \n \n104 \n \n \na) Primary side voltages \n \nb) Primary side currents \n \nc) Primary side active and reactive powers \nFigure 4.19.  Test System 2 - Simulation results: Nonlinear LV-side load. \nVoltage  (kV)\n-15\n-10\n-5\n0\n5\n10\n15\nTime (s)\n1.1 1.2 1.3 1.4 1.5 1.6 1.7 1.8 1.9\nCurrent  (A)\n-60\n-40\n0\n20\n40\n60\n-20\nTime (s)\n1.1 1.2 1.3 1.4 1.5 1.6 1.7 1.8 1.9\nPower  (kW/kVar)\n-200\n0\n600\nTime (s)\n1.1 1.2 1.3 1.4 1.5 1.6 1.7 1.8 1.9\n400\n200\nP\nQ\nChapter 4: Simulation Results \n \n105 \n \n \nd) Secondary side voltages \n \ne) Secondary side currents \n \nf) Secondary side active and reactive powers \nFigure 4.19.  Test System 2 - Simulation results: Nonlinear LV-side load (cont.). \nVoltage  (V)\n-400\n-200\n0\n200\n400\nTime (s)\n1.1 1.2 1.3 1.4 1.5 1.6 1.7 1.8 1.9\nCurrent  (A)\n-800\n-400\n0\n400\n800\nTime (s)\n1.1 1.2 1.3 1.4 1.5 1.6 1.7 1.8 1.9\nPower  (kW/kVar)\n-200\n0\n600\nTime (s)\n1.1 1.2 1.3 1.4 1.5 1.6 1.7 1.8 1.9\n400\n200\nP\nQ\nAdvanced Modeling of Solid State Transformer \n \n106 \n \n \na) Primary side voltages \n \nb) Primary side currents \n \nc) Primary side active and reactive powers \nFigure 4.20.  Test System 2 - Simulation results: Short-circuit at the LV terminals. \nVoltage  (kV)\n-15\n-10\n-5\n0\n5\n10\n15\nTime (s)\n1.1 1.2 1.3 1.4 1.5 1.6 1.7 1.8 1.9\nCurrent  (A)\n-60\n-40\n0\n40\n60\n80\n-20\n20\n-80\nTime (s)\n1.1 1.2 1.3 1.4 1.5 1.6 1.7 1.8 1.9\nPower  (kW/kVar)\n-300\n0\n900\nTime (s)\n1.1 1.2 1.3 1.4 1.5 1.6 1.7 1.8 1.9\n600\n300\nP\nQ\nChapter 4: Simulation Results \n \n107 \n \n \nd) Secondary side voltages \n \ne) Secondary side currents \n \nf) Secondary side active and reactive powers \nFigure 4.20.  Test System 2 - Simulation results: Short-circuit at the LV terminals (cont.). \nVoltage  (V)\n-400\n-200\n0\n200\n400\nTime (s)\n1.1 1.2 1.3 1.4 1.5 1.6 1.7 1.8 1.9\nCurrent  (A)\n-1500\n-1000\n-500\n0\n500\n1000\n1500\nTime (s)\n1.1 1.2 1.3 1.4 1.5 1.6 1.7 1.8 1.9\nPower  (kW/kVar)\n-300\n0\n900\nTime (s)\n1.1 1.2 1.3 1.4 1.5 1.6 1.7 1.8 1.9\n600\n300\nP\nQ\nAdvanced Modeling of Solid State Transformer \n \n108 \n \n \na) Primary side current and voltage - Phase A \n \nb) Primary side current and voltage - Phase B \n \nc) Primary side active and reactive powers \nFigure 4.21.  Test System 2 - Simulation results: Power flow reversal. \nV&I of phase  a\n-40\n0\n20\n40\n-20\nTime (sec)\n1.4 1.6 1.8 2 2.4 2.61.2 2.2\nvoltage (kV)\nCurrent (A)\nV&I of phase  b\n-40\n0\n20\n40\n-20\nTime (sec)\n1.4 1.6 1.8 2 2.4 2.61.2 2.2\nvoltage (kV)\nCurrent (A)\nTime (sec)\n1.4 1.6 1.8 2 2.4 2.6\nPower  (kW/kVar)\n-400\n-200\n0\n200\n400\n1.2 2.2\nP\nQ\nChapter 4: Simulation Results \n \n109 \n \n \nd) Secondary side current and voltage - Phase A \n \ne) Secondary side current and voltage - Phase B \n \nf) Secondary side active and reactive powers \nFigure 4.21.  Test System 2 - Simulation results: Power flow reversal (cont.). \n \n \nV&I of phase  a\n-600\nTime (sec)\n1.4 1.6 1.8 2 2.4 2.61.2 2.2\nvoltage (V)\nCurrent (A)\n-400\n-200\n0\n400\n600\n200\nV&I of phase  b\n-600\nTime (sec)\n1.4 1.6 1.8 2 2.4 2.61.2 2.2\nvoltage (V)\nCurrent (A)\n-400\n-200\n0\n400\n600\n200\nPower  (kW/kVar)\n-400\n-200\n0\n200\n400\nTime (sec)\n1.4 1.6 1.8 2 2.4 2.61.2 2.2\nP\nQ\nAdvanced Modeling of Solid State Transformer \n \n110 \n \n4.3.5. Discussion \n1. A simplified SST thermal model has been implemented since MV -side \nsemiconductor losses were derived by assuming a junction temperature of all MV -\nside semiconductors within a given margin of values and rather small semiconductor \nlosses. With this simplification the required CPU time could be  significantly \nreduced, while the model performance was acceptable because MV -side currents \nwere rather small. Obviously, for larger ratings and higher MV -side currents, a more \ndetailed thermal model should also be implemented at the SST MV side. \n2. Given that the SST model is based on that presented in section 4.2, its performance is \nas expected, and similar to the model without semiconductor losses; therefore, the \ndiscussion presented in section 4.2 is valid for the new SST model. Actually, only \nthe first case study, in which the voltage sag and swell appears at the MV side to the \nshort circuit fault occurrence in the distribution system, presents some novelty with \nrespect to case studies analyzed in section 4.2. In any case, it is worth remembering \nthat the SST performs as an efficient device that can provide some power quality \nimprovements: the isolation between stages provided by the intermediate stage \nprevents the propagation of disturbances between input and output stages; in \naddition, the implemented des ign assures a quick SST reaction in front of \ndisturbances. As with the discussion in previous section, SST ride -through \ncapabilities have been analyzed (see S ection 4.2.1). The new results confirm again \nthat the SST performance is excellent: although the v ariation of the DC link voltages \nat the beginning and the end of transients depend on the type of transient and the \nvariation is in percent much larger at the LV -side stage in case of power flow \nreversal, SST variables quickly recovers their initial values. \n3. The capability for harmonic voltage compensation incorporated to the LV -side \noutput converter prevents that distorted LV currents could affect the output voltage \nat the LV SST terminals: the proposed control (see Fig ure 2.13) can provide \nbalanced secondary voltages with small THD, as one can observe from plots of \nFigure 4.19. Figure 4.26 presents the simulation result for nonlinear load connection \nwith and without implementing control strategy with and without the capabi lity of \nharmonic voltage compensation (HVC). As it can be observed from F igure 4.26.a, \nwithout harmonic voltage compensation capability the secondary side voltage is \ndistorted including harmonic components. \n4. It is important to keep in mind that, according to the conclusions presented in [4.9], \nthe size, weight, and cost of the present or similar SST designs might exceed size, \nweight and cost of an equivalent conventional iron- and-copper transformer design. \nThe most promising option for future SST designs is the use of SiC semiconductors: \nit is assumed that SST designs based on this technology will reduce size, weight, and \nlosses with respect to a design based on conventional semiconductor technology, \nsince a lower number of semiconductors working at very high switching frequencies \n(i.e. 50 kHz) will be required at the MV side; see, for instance, references [4.10] -\n[4.14]. \n5. The most challenging issue is the low SST efficiency. Although the results obtained \nin this work are in line with those previously presented, see [4.15] -[4.17], it is \nevident that the high number of semiconductors, the amount of semiconductor losses \nand the modulation techniques are three important factors that have some impact on \nefficiency. Future work will be addressed to optimize filter des igns and design \nmodulation techniques that combined with new multilevel topologies  could improve \nSST efficiency. \nChapter 4: Simulation Results \n \n111 \n \n \na) MV-side dc link voltage \n \nb) Capacitance voltage of upper arm of phase a \n \nc) LV-side dc link voltage \nFigure 4.22.  Simulation results: Voltage sag at the MV side. \nVoltage  (kV)\n20.5\n21\n21.5\nTime (s)\n1.1 1.2 1.3 1.4 1.5 1.6 1.7 1.8 1.9\nVoltage  (kV)\n3.1\n3.3\n3.5\n3.7\n3.9\nTime (s)\n1.1 1.2 1.3 1.4 1.5 1.6 1.7 1.8 1.9\nVoltage  (V)\n500\n1000\n1500\nTime (s)\n1.1 1.2 1.3 1.4 1.5 1.6 1.7 1.8 1.9\nAdvanced Modeling of Solid State Transformer \n \n112 \n \n \na) MV-side dc link voltage \n \nb) Capacitance voltage of upper arm of phase a \n \nc) LV-side dc link voltage \nFigure 4.23.  Simulation results: LV-side load variation. \nVoltage  (kV)\n20.5\n21\n21.5\nTime (s)\n1.1 1.2 1.3 1.4 1.5 1.6 1.7 1.8 1.9\nVoltage  (kV)\n3.1\n3.3\n3.5\n3.7\n3.9\nTime (s)\n1.1 1.2 1.3 1.4 1.5 1.6 1.7 1.8 1.9\nVoltage  (V)\n500\n1000\n1500\nTime (s)\n1.1 1.2 1.3 1.4 1.5 1.6 1.7 1.8 1.9\nChapter 4: Simulation Results \n \n113 \n \n \na) MV-side dc link voltage \n \nb) Capacitance voltage of positive arm of phase a \n \nc) LV-side dc link voltage \nFigure 4.24.  Simulation results: Short-circuit at the LV side. \nVoltage  (kV)\n20.5\n21\n21.5\nTime (s)\n1.1 1.2 1.3 1.4 1.5 1.6 1.7 1.8 1.9\nVoltage  (kV)\n3.1\n3.3\n3.5\n3.7\n3.9\nTime (s)\n1.1 1.2 1.3 1.4 1.5 1.6 1.7 1.8 1.9\n500\n1000\n1500Voltage  (V)\nTime (s)\n1.1 1.2 1.3 1.4 1.5 1.6 1.7 1.8 1.9\nAdvanced Modeling of Solid State Transformer \n \n114 \n \n \na) MV-side dc link voltage \n \nb) Capacitance voltage of positive arm of phase a \n \nc) LV-side dc link voltage \nFigure 4.25.  Simulation results: Power flow reversal. \nVoltage  (kV)\n20.5\n21\n21.5\nTime (sec)\n1.4 1.6 1.8 2 2.4 2.61.2 2.2\nVoltage  (kV)\n3.1\n3.3\n3.5\n3.7\n3.9\nTime (sec)\n1.4 1.6 1.8 2 2.4 2.61.2 2.2\nVoltage  (V)\n500\n1000\n1500\nTime (sec)\n1.4 1.6 1.8 2 2.4 2.61.2 2.2\nChapter 4: Simulation Results \n \n115 \n \n \na) Without HVC \n \nb) With HVC \nFigure 4.26.  Simulation results: Nonlinear load without and with HVC. \n \n4.4. Conclusion \nThis chapter has presented some simulation results from two case studies considering \ndifferent test system configurations and SST models for each study:  \n1. A stand -alone three-stage MMC -based bidirectional SST without semiconductor \nlosses. \n2. A three- stage MMC -based bidirectional SST connected to a distribution network \nand with semiconductor losses. \nThe SST model has been simulate d and tested under different operating conditions. As \nexpected, simulation results prove the feasibility of the SST and its impact on power \nquality: the proposed bidirectional SST model is flexible enough to recover from \nvoltage sag and swell at input stag e and prevent its propagation to the output stage, \ncompensate reactive power, compensate output stage voltage harmonics when \nsupplying nonlinear loads, and prevent the propagation of short-circuit currents from the \nsecondary to the primary side. \nThe most challenging issue is the low SST efficiency. Although the results obtained in \nthis work are in line with those previously presented, see [4.15] and [4.17], it is evident  \nTime (s)\n1.1 1.2 1.3 1.4 1.5 1.6 1.7 1.8\nVoltage  (V)\n-400\n-200\n0\n200\n400\nTime (s)\n1.1 1.2 1.3 1.4 1.5 1.6 1.7 1.8\nVoltage  (V)\n-400\n-200\n0\n200\n400\nAdvanced Modeling of Solid State Transformer \n \n116 \n \nthat the high number of semiconductors, the amount of semiconductor losses and the \nmodulation techniques are three important factors that have some impact on efficiency. \n \n4.5. References \n[4.1] S. Alepuz, F. González, J. Martin -Arnedo, and J.A. Martinez, “Solid state transformer \nwith low-voltage ride-through and current unbalance management capabilities,” 39th \nAnn. Conf. IEEE Ind. Electron. Soc. (IECON), Vienna, Austria, Nov. 2013. \n[4.2] J.A. Martinez -Velasco, S. Alepuz, F. González -Molina, and J. Martin -Arnedo, \n“Dynamic average modeling of a bidirectional solid state transformer for feasibility \nstudies and real -time implementation,” Electric Power Systems Research , vol. 117, \npp.143–153, 2014. \n[4.3] S. Alepuz, F. González -Molina, J. Martin-Arnedo, and J.A. Martinez -Velasco, \n“Development and testing of a bidirectional distribution electronic power transformer \nmodel,” Electric Power Systems Research, vol. 107, pp. 230-239, 2014. \n[4.4] M. Davari, Y. Abdel -Rady, and I. Mohamed, “Robust v ector control of a very weak \ngrid-connected voltage-source converter considering the phase locked loop dynamics,” \nIEEE Trans. on Power Electron., vol. 32, no. 2, pp. 977-994, Feb. 2014. \n[4.5] L. Harnefors, M. Bongiorno, and S. Lundberg, “Input -Admittance Calculation and \nShaping for Controlled Voltage -Source Converters,” IEEE Trans. on Ind. Electron., \nvol.54, no.6, pp. 3323-3334, Dec. 2007.  \n[4.6] D. Dong, B. Wen, D. Boroyevich, P. Mattavelli, and Y. Xue , “Analysis of phase -\nlocked loop low -frequency stability in three- phase grid- connected power converters \nconsidering impedance interactions,” IEEE Trans. on Ind. Electron., vol. 62, no. 1, pp. \n310-321, Jan. 2015.  \n[4.7] J. Zhou, D. Hui, S. Fan, Y. Zhang, a nd A. M. Gole, “Impact of short -circuit ratio and \nphase-locked-loop parameters on the small -signal behavior of a VSC -HVDC \nconverter,” IEEE Trans. on Power Del., vol.29, no.5, pp.2287-2296, Oct. 2014.  \n[4.8] Y. Huang, X. Yuan, J. Hu, and P. Zhou, “Modeling of VSC connected to weak grid for \nstability analysis of DC -link voltage control,” IEEE J. Emerg. Sel. Topics Power \nElectron. , vol. 3, no. 4, pp. 1193-204, Dec. 2015. \n[4.9] J.E. Huber and J.W. Kolar, “Volum e/weight/cost comparison of a 1 MVA 10 kV/400 \nV solid -state against a conventional low -frequency distribution transformer,” IEEE \nEnergy Conversion Congress Exposition (ECCE), Sep. 2014. \n[4.10] D. Rothmund, G. Ortiz, T. Guillod, and J.W. Kolar, “10kV SiC -based isolated DC-DC \nconverter for medium voltage -connected solid- state transformers,” IEEE Applied \nPower Electronics Conf. and Expo. (APEC), Mar. 2015. \n[4.11] S. Madhusoodhanan, A. Tripathi, D. Patel, K. Mainali, A. Kadavelugu, S. Hazra, S. \nBhattacharya, and K. Hatua, “Solid- state transformer and MV grid tie applications \nenabled by 15 kV SiC IGBTs and 10 kV SiC MOSFETs based multilevel converters,” \nIEEE Trans. on Ind Appl, vol.51, no.4, pp.3343–3360, Aug. 2015. \n[4.12] A.Q. Huang, L. Wang, Q. Tian, Q. Zh u, D. Chen, and W. Yu, “Medium voltage solid \nstate transformers based on 15 kV SiC MOSFET and JBS diode,” 42nd Annual Conf. \nof the IEEE Industrial Electronics Society (IECON), Oct. 2016. \n[4.13] N.M. Evans, T. Lagier, and A. Pereira, “A preliminary loss co mparison of solid -state \ntransformers in a rail application employing silicon carbide (SiC) MOSFET switches,” \n8th IET Int. Conf. on Power Electronics, Machines and Drives (PEMD), Apr. 2016. \n[4.14] A.Q. Huang, “Medium -voltage solid-state transformer: Technology for a smarter and \nresilient grid,” IEEE Ind. Electron Mag., vol.10, no.3, pp. 29–42, Sep. 2016. \n[4.15] H. Qin and J.W. Kimball, “A comparative efficiency study of silicon -based solid state \ntransformers,” IEEE Energy Convers. Congr. and Expo. (ECCE), Sep. 2010. \n \n[4.16] R. Peña-Alzola, G. Gohil, L. Mathe, M. Liserre, and F. Blaabjerg, “Review of modular \npower converters solutions for smart transformer in distribution system,” IEEE Energy \nChapter 4: Simulation Results \n \n117 \n \nConvers. Congr. and Expo. (ECCE), Sep. 2013. \n[4.17] G. Guerra and J.A. Martinez-Velasco, “A solid state transformer model for power flow \ncalculations,” Int. Journal of Electrical Power and Energy Systems , vol.89, pp.40-51, \nJul. 2017. \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \nAdvanced Modeling of Solid State Transformer \n \n118 \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n  \n \n \n \n \n \n \nChapter 5 \nGeneral Conclusions \n \n \nThe solid state transformer (SST) is seen as a proper replacement of the conventional \niron-and-copper transformer in the future smart grid. The SST offers several benefits \n(e.g. enhanced power quality performance or reactive power control at both primary and \nsecondary sides) that can be of paramount importance for the development of the smart \ngrid. In addition, the SST can provide some operational benefits, namely reduce \nenvironmental concerns by introducing a design that doe s not use mineral oil or other \nliquid dielectrics, and efficient management of distribution resources by incorporating \non-line monitoring and other distribution automation functionalities. \nThis doctoral thesis focuses on advanced modeling of a three stage bidirectional \nMV/LV solid state transformer (SST) for distribution system studies. A modular \nmultilevel converter (MMC) configuration is used in the MV side of the STT. The LV \nside uses a three- phase four-wire configuration that can be connected to both load and \ngeneration. The model developed for this work has been implemented in \nMatlab/Simulink, and its behavior has been tested by carrying out several case studies \nunder different operating conditions. The simulation results support the feasibility of the \nSST and its advantages in comparison to the conventional transformer. \nThis thesis is aimed at: \n• proposing a MMC -based SST model that can work when connected to any MV \ndistribution network;  \n• implementing a more accurate representation of semiconductors by incorporating \nlosses into their models; \n• presenting more flexible and advanced SST controllers in order to provide a more \nefficient performance under demanding operating conditions. \nChapter 2 of this thesis gives a detailed description of a bidirectional three -stage MMC-\nbased SST model considering both ideal (lossless) semiconductors and lossy \nsemiconductors. The proposed configuration uses MMC technology at the MV side due \nto its sca lability and flexibility: the design of devices with higher rated voltages at the \nAdvanced Modeling of Solid State Transformer \n \n120 \n \nMV side can be derived from the design proposed by simply increasing the number of \nsubmodules and/or selecting higher-voltage submodules.  \nAt the input stage, a three-phase MMC with half-bridge SMs is used. A voltage oriented \ncontrol (VOC) strategy has been used to generate proper reference signals; a level -\nshifted PWM method is used as modulation technique. In addition, a sorting algorithm \ntechnique is used for balancing the SM capacitance voltages. The controllers provide \nthe capability of voltage sag compensation.  \nThe MV/LV isolation stage is divided into three parts: a single -phase MMC, a HFT and \na single -phase bidirectional PWM converter. An open- loop level -shifted PWM an d a \nsorting algorithm have been used to control the MV single -phase MMC, while a \nproportional-resonant (PR) based control is applied to the LV single -phase bidirectional \nPWM converter. \nA three -phase four -leg converter is used for the LV output stage. A com prehensive \nVOC strategy with a three -dimensional SVM modulation technique has been \nimplemented to generate proper reference signals. The proposed control can provide \ngood performance of SST both under unbalanced load conditions and also nonlinear \nload connection by having the capability of harmonic voltage compensation. The \ncontrol diagram and topology of all three stages are explained in detail in order to \nimplement a SST to have good performance under different case studies. \nA realistic representation of a power electronic device must incorporate semiconductor \nlosses. This aspect is fundamental to decide about the viability of a given device design \nor to assess its impact as part of a large network . Although the SST is seen as a \ncomponent with a crucial role in the future smart grid, the fact is that the efficiency of \ncurrent SST designs is lower than that of the conventional transformer. Therefore, it is \nimportant to develop a SST model in which semiconductor losses are reliably \nrepresented. Some important  aspects are required in such a model: its configuration \nmust be as close to the real device as possible, and its model must be flexible enough to \nrepresent the performance of any semiconductor and its losses. It is evident that such a \nmodel may imply a ve ry complex and sophisticated representation, which will be even \nmore computer demanding in case of simulating the SST model as a part of a larger \nsystem (e.g. a large distribution system). \nA simple approach is proposed for calculating and implementing semi conductor losses \nby using experimental values extracted from manufacturer datasheets: first, \nsemiconductor losses are calculated from manufacturer datasheets, but since losses \ndepend on temperature, the semiconductor thermal models are included in converte r \nmodels; second, the losses are incorporated as part of the semiconductor model by \nmeans of controlled sources whose instantaneous values are obtained from the external \ncalculation carried out in the first step. It is therefore a closed -loop approach that  uses \ninformation available in manufacturer data sheets. \nThe implementation of the three- stage MMC-based SST in Matlab/Simulink with and \nwithout including semiconductor losses  has been detailed in C hapter 3, which provides \na detailed description of both power stages and control strategies. \nChapter 4 present s the simulation results for several case studies  considering two \ndifferent SST models and two test systems. The first test system is an ideal (lossless) \nstand-alone SST; the second test system is a MV di stribution system to which a lossy \nSST is connected. The simulation results derived from both test systems have shown \nChapter 5: General Conclusions \n \n121 \n \nthat the bidirectional SST incorporates some advanced capabilities (e.g., fast voltage \nand power flow control, reactive power compensation, voltage sag compensation) that \nsupport its feasibility as a fundamental component of the future smart grid. Intermediate \nSST dc links provide stage decoupling, and prevent disturbances at one side from \npropagating to the other side (e.g., LV -side seconda ry load immunity is achieved in \nfront of an unbalanced situation caused by a voltage sag at the MV -side input stage; \nunbalanced currents at the LV side are not noticed at the MV side). \nThe envisaged applications of the SST are many. Utilities are looking f or reliable and \neffective components that could offer potential for remote supervision and control; new \ngrid codes and higher penetration of distributed generation will increase the utilities \ninterest in voltage regulation and controllability. Solar and wi nd power developers are \nother potential customers as they are aiming at using the existing and future grid as \nefficiently as possible. Industries are also concerned about reliability and availability of \nthe apparatus but also about preventing the impact of disturbances in their production. \nThe work and results presented in this thesis have also evidenced some SST limitations: \nthe efficiency of this device is lower that its iron -and-copper counterpart; its modular \nconfiguration requires a not -so-low volume and weight. Future work should be focused \non improving those aspects that could present a wide SST application. In addition, there \nare some design and modelling aspects that could of paramount importance for the \nanalysis and implementation of future SST de signs. A short list of future tasks is \npresented below: \n• Design of new SST configurations with lower number of semiconductors and a \nhigher efficiency (SiC technologies are certainly the best candidates for achieving \nsuch a goal). \n• New control strategies that could take advantage of a smaller configuration in order \nto obtain a better efficiency under any operating condition. \n• The SST model proposed in this thesis has a very complex configuration. The \nsimulation time required to test such model is in some case s tudies too long. The \ndevelopment of dynamic averaged models would be a solution for this drawback, \nand at the same time would allow their simulation in real- time platforms, an \napproach that could facilitate the design of new and better controllers by using  HIL \n(hardware-in-the-loop). \n• The design and performance of the filters to be installed at both the input and \noutput stages is a crucial aspect for which some optimization is desired. \n \n \n \n \n \n \n \n \n \n \n \n \nAdvanced Modeling of Solid State Transformer \n \n122 \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n  \n \n \n \n \n \n \nAppendix \nPrototypes and Simulation Tools \n \n \nAlthough the field experience with the solid state transformer is not too significant to \ndate, a very high number of prototypes have been built. A high percentage of those \nworks joined laboratory tests with actual prototypes with the implementation of a \ncomputer model that could be used to validate the model. On the other hand, it is \nimportant to keep in mind that a computer model is by itself an important contribution \nsince not many laboratories can test a SST prototype in a real environment (e.g. as a \ncomponent of an actual distribution system).  \nBoth aspects, building and testing prototypes and computer models, are important in \norder to prove the feasibility of the SST and obtain experience about the best ratings, \ntopologies, control strategies, and capabilities.  \nThis appendix provides a summary of the prototypes and simulation models built and \ntested to date. \nTable A1 presents a list of some SST prototypes. The list is by no means complete. At \nthe time of deciding the works that should be included in the  table those for which \ncomplete information, as presented in the table, was available were selected. Note that \nthe required information includes rating, configuration, control strategies, capabilities \nand laboratory tests.  \nMost prototypes listed in Table A1 were tested under both steady -state and transient \nconditions. SST capabilities and laboratory tests that were accounted for preparing the \ntable are listed below: \n• Robustness of SST against voltage sags and swells at the primary terminals. \n• Power factor correction (in general, unit power factor at the primary terminals). \n• Harmonic voltage compensation in case of nonlinear load connected to the \nsecondary side. \n• Stable behavior of the dc-links and terminal voltages. \nAdvanced Modeling of Solid State Transformer \n \n124 \n \n• Current limiting capabilities to provide protection in case of short circuit at the \nsecondary side terminals. \n• Bidirectional power flow to cope with reversal power flow conditions. \n• Short-term ride-through capabilities in the case of voltage excursions. \nGiven that a multilevel configuration is presently needed for MV -side converters, an \nimportant aspect analyzed in Table A1 is the configuration of these converters. \nAccording to the table, the most common topologies are the cascaded H -bridge (CHB) \ntopology and the modular multilevel converter (MMC) topology. \nThe most popular control strategies are based on pulse width modulation (PWM) for \nboth input and output stages, and phase shift modulation strategy for the isolation stage.  \nLikewise, Table A2 summarizes the work carried out on SST simulation. Again, only \nworks for which complete information was available were selected. That information \ncovered the following items: simulation tool, modeling approach (i.e. steady -state vs. \ntransient model, switched vs. average mode), configuration, control strat egies, and a \nminimum of case studies that could support the feasibility of the SST as a component of \nthe distribution system. \nSST models have been implemented using the simulation tools listed below: \n• Matlab/Simulink, \n• Matlab/Simulink with PLECS, \n• PSCAD, \n• PLECS, \n• SPICE, \n• SPICE with PLECS, \n• SABER, \n• SABER with SPICE, \n• PSIM, \n• EMTP/ATP, \n• OpenDSS, \n• Digsilent Power Factory, \n• Real Time Digital Simulator (RTDS), \n• Opal-RT. \nThe greatest percentage of simulation works used Matlab/Simulink. Note also that some \nworks were aimed at implementing SST models for real- time simulation. Take into \naccount that RTDS and Opal-RT are real-time simulation platforms. \nNote: The following acronyms have been used in Table 1. \nDAB = Dual Active Bridge \nMMC = Modular Multilevel Converter \nNPC = Neutral point Clamped \nPWM = Pulse Width Modulation \nSVM = Space Vector Modulation \nSVPWM = Space Vector Pulse Width Modulation \nZVS = Zero Voltage Switching \nAppendix: Prototypes and Simulation Tools \n \n125 \n \nTable A1 – SST Prototypes \nRatings Configuration Control-\nstrategies Capabilities Laboratory \ntests Refs. \n10 kVA, \n7.2 kV/240V \nThree stage, cascaded \nH-bridge \nPWM Unidirectional \npower flow, \npower-factor \ncorrection \nSteady state, \nunbalanced \nload \n[A.1], \n[A.2] \n5 kVA,  \n220 V/380 V \nTwo stage, direct \nAC/AC high-\nfrequency link, dual \nbridge matrix \nconverter topology \n3D SVPWM bidirectional \npower flow, low \nharmonic \ndistortion \nUnbalanced \nlinear load, \nunbalanced \ninput voltage \n[A.3]   \n50 kVA, \n2.4 kV/ 240V/ \n120V \nThree stage, Three \nlevel NPC in MV \nside \nPWM Voltage sag \ncompensation, \nfault isolation \nvoltage sag, \nload variation, \nunbalanced \nload \n[A.4] \n1.5 kW, \n230 V/39V \nThree stage, cascaded \nH-bridge \nPWM Bidirectional \npower flow, \nharmonic voltage \ncompensation, \nreactive power \ncompensation \nVoltage sag, \nnonlinear load \n[A.5] \n2 kW, \n110V/20V \nSingle-stage, AC/AC, \ntwo level \nPWM Bidirectional \npower flow, \nmaximum power-\npoint tracking \nSteady state [A.6] \n20 kVA, \n7.2 kV/240 V \nThree stage, cascaded \nH-bridge \nPWM Bidirectional \npower flow \nSteady-state [A.7]- \n[A.17] \n54 kW, \n1.5 \nkVac/360Vdc \nTwo stage, cascaded \nH-bridge \nPWM Bidirectional \npower flow \nSteady state, \nload variation, \nreverse power \nflow \n[A.18], \n[A.19] \n1.2 MVA, \n15kV/16.7Hz  \nTwo stage, cascaded \nH-bridge \nPWM Bidirectional \npower flow \nSteady state, \nload change, \nreverse power \nflow,  \n[A.20], \n[A.21], \n[A.22] \n1 kW, \n208V/120V \nThree-stage, two \nlevel \nPWM Bidirectional \npower flow \nStart-up \ntransients \n[A.23]  \n100 kW, \n10kVac/750V\ndc \nTwo stage, \nAC/DC/DC, MMC \nPWM Bidirectional \npower flow \nSteady state [A.24] \n2 kVA, \n1.9 kV/127 V \nThree stage, \nMultilevel converter  \nPWM, ZVS \noperation \nBidirectional \npower flow, \nvoltage sag \ncompensation \nSteady state, \nvoltage sag, \nreverse power \nflow \n[A.25], \n[A.26] \n10 kW, \n3.6 kV/120 V \nThree stage, two level PWM Bidirectional \npower flow, \nharmonic voltage \ncompensation \nSteady state, \nnonlinear load, \nload variation \n[A.27], \n[A.28], \n[A.29], \n[A.30], \n[A.31], \n[A.32] \n1 kW, \n353.55/220 \nTwo stage AC/AC, \nMMC \nPWM Unidirectional \npower flow \nSteady state [A.33] \n50 kVA, \n480V/480V  \nSingle stage, Dyna-C \nAC/AC topology \nPWM Bidirectional \npower flow  \nSteady state [A.34], \n[A.35]   \n600 kVA,  \n3.3 kV dc / \n3.3 kV dc \nThree stage, cascaded \nH-bridge in MV side  \nPWM Bidirectional \npower flow \nSteady state [A.36] \n \nAdvanced Modeling of Solid State Transformer \n \n126 \n \nTable A1 – SST Prototypes (cont.) \nRatings Configuration Control-\nstrategies Capabilities Laboratory \ntests Refs. \n5 kW, \n3300Vac/380\nVdc \nTwo stage, cascaded \nH-bridge  \nPhase shift \nmodulation \nBidirectional \npower flow \nSteady state [A.37] \n2 kW, 300 V/ \n60 V \nThree stage, two level PWM Bidirectional \npower flow \nSteady state, \nload variation \n[A.38] \n2 kVA, \n380V/120V \nThree stage, cascaded  PWM Bidirectional \npower flow \nSteady state, \npower flow \nreversal, \nstartup  \n[A.39] \n5.8 kVA, \n5kVdc/800Vd\nc \nThree stage, NPC \nwith SiC \nPWM Bidirectional \npower flow \nSteady state [A.40] \n150 kVA, \nport1:750Vdc,\nport2:375Vdc, \nport3: 750Vdc \nTriple active-bridge \nwith energy storage \nPhase shift \nmodulation \nBidirectional \npower flow \nSteady state [A.41], \n[A.42] \n3-kVA, \n2.4kV/127V \nThree stage, two level PWM Unidirectional Steady state, \nnonlinear load \n[A.43] \n10 kVA, 208 \nV \nSingle stage AC/AC, \ntwo level, soft-\nswitching solid state \ntransformer \nSoft-\nswitching, \nZVS \nBidirectional \npower flow \nSteady state [A.44] \n2 kW, \n600Vdc/200V\ndc \nThree phase modular \nmultilevel dc/dc \nconverter \nPWM, ZVS, \ndual-phase-\nshift method \nBidirectional \npower flow \nSteady state [A.45] \n10 kVA,  \n3.8 \nkVdc/200Vdc  \nThree stage,  single \nphase single \nconverter cell based \nSST for wind energy \nconversion system \nPWM Bidirectional \npower flow \nSteady state, \nload variation \n[A.46] \n2 kW, \n400V/208V \nSingle stage, AC/AC, \nmatrix based \nPredictive \nControl \nBidirectional \npower flow \nSteady state, \nload variation, \nunbalanced \nvoltage and \ncurrent  \n[A.47], \n[A.48] \n100 kVA, \n13.8 kV/120V \nor 240 V \nThree phase, three \nstage, cascaded \nblocks  \nPWM Unidirectional \npower flow \nSteady state, \nunbalanced \nload, voltage \nsag, non-\nlinear loads, \ncapacitor \nswitching \ntransient, load \nstep transient \n[A.49] \n20 kVA, \n2.4kV/120Va\nc or 240Vac \nor 48V dc \nSingle phase, three \nstage, NPC \nmultilevel, multiport-\noutput DC/AC \ninverter \nPWM Unidirectional \npower flow \nSteady state, \nload change, \nload \nunbalance, \nnonlinear \nload, voltage \nsag \n[A.50], \n[A.51], \n[A.52] \n \n \n \nAppendix: Prototypes and Simulation Tools \n \n127 \n \nTable A2 – SST simulation tools \nSimulation tool Modeling \napproach Configuration Refs. \nMatlab/Simulink Switching model Three phase input matrix converter, three-phase \nfour-wire output matrix converter \n[A.53] \nMatlab/Simulink Average model Three phase, three stage, two level [A.54] \nMatlab/Simulink Switching model Single phase, three stage, cascaded H-bridge [A.55], [A.5] \nMatlab/Simulink Switching model Three phase, single stage AC/AC, matrix \nconverter topology \n[A.56], [A.57], \n[A.58] \nMatlab/Simulink Average model Three phase, three stage, two level [A.59] \nMatlab/Simulink Average model Three phase, three stage, multi transformer in \nisolation stage, two level \n[A.60] \nMatlab/Simulink Average model Single phase, three stage, cascaded H-bridge  [A.61], [A.62] \nMatlab/Simulink Switching model Direct dc/ac matrix based converter topology [A.63] \nMatlab/Simulink Switching model Single power conversion stage ac/ac m atrix \nbased power converter topology  \n[A.64] \nMatlab/Simulink Average model Single-phase, three stage, cascaded H-bridge [A.65], [A.66], \n[A.67] \nMatlab/Simulink switching model Three phase, three stage, two level [A.68], [A.69], \n[A.70], [A.71] \nMatlab/Simulink Switching model Single phase, cascaded H-bridge [A.72] \nMatlab/Simulink Switching model Three phase, single stage AC/AC SST, with \ntwo matrix converter at the primary and \nsecondary \n[A.73], [A.74], \n[A.75] \nMatlab/Simulink Average model Three phase, three stage, two level [A.76], [A.77] \nMatlab/Simulink Switchin model Three phase, three stage, matrix converter at \nLV side \n[A.78], [A.79], \n[A.80], [A.81] \nMatlab/Simulink Switching model Three stage, NPC at MV side [A.82], [A.83], \n[A.84], [A.85] \nMatlab/Simulink Average model Single phase, three stage, cascaded H-bridge [A.86]  \nMatlab/Simulink Average model Three stage, two level  [A.87], [A.88], \n[A.89], [A.90], \n[A.91] \nMatlab/Simulink Switching model Single phase, three stage, MMC topology in \nMV side  \n[A.92], [A.93], \n[A.94], [A.95] \nMatlab/Simulink Switching model Three phase, three stage, cascaded H-bridge [A.96] \nMatlab/Simulink Average model Single phase, three stage, two level [A.97]  \nMatlab/Simulink Switching model Single phase, three stage, cascaded H-bridge [A.16] \nMatlab/Simulink Switching model Three phase, three stage, two level in input and \nisolation stage, nine-switches in its output stage \n[A.98] \nMatlab/Simulink Average model A modular design of the sub -module of the \nmodular multilevel converter, two stage \n[A.99]  \nMatlab/Simulink Average model Single phase, both two stage and three stage, \ncascaded H-bridge in MV side \n[A.100] \nMatlab/Simulink Switching model Single phase, three stage, CHB in MV side [A.101], \n[A.102] \nMatlab/Simulink Average model multiport dc-dc converter based SST, two stage \nand three stage, QAB -based SST with PV and \nstorage integrated through HFT \n[A.103]  \nMatlab/Simulink Switching model Three stage, QAB -based SST with PV and \nstorage integrated through HFT \n[A.104] \nMatlab/Simulink Switching model Three phase, three stage, MMC converter in \nMV side ,three phase matrix converter in \noutput stage \n[A.105]  \nMatlab/Simulink Switching model Multifed three stage, two level, [A.106] \nMatlab/Simulink Average model Single phase, three stage, two level [A.107]  \nMatlab/Simulink Switching model Three Phase Modular Multi level DC/DC \nConverter \n[A.108] \nAdvanced Modeling of Solid State Transformer \n \n128 \n \nTable A2 – SST simulation tools (cont.) \nSimulation tool Modeling \napproach Configuration Refs. \nMatlab/Simulink Average model Three phase, three stage, cascaded multilevel in \ninput and output stage \n[A.36]  \nMatlab/Simulink Switching model Three phase, three stage,  cascaded multilevel \nin input and output stage \n[A.109] \nMatlab/Simulink Switching model Single phase, three stage with bidirectional \nLLC resonant DC -DC converters as isolation \nunit, CHB in input stage, multi/output port  \n[A.110] \nMatlab/Simulink Average model Two stage, two level, DAB and output stage [A.111] \nMatlab/Simulink Switching model Two stage, two level, DAB and output stage [A.112] \nMatlab/Simulink Switching model Three phase, single stage, modular multilevel \ndc/dc converter \n[A.45] \nMatlab/Simulink Switching model Three phase, three stage, MMC based [A.113], \n[A.114]  \nMatlab/Simulink Switching model Three phase, three stage, NPC in MV side, \nmatrix converter in LV side \n[A.115] \nMatlab/Plecs Switching model Cascaded Ac-Ac dual active bridge converter [A.116]  \nMatlab/Plecs Average model Two stage, Cascaded H-bridge [A.11] \nMatlab/Plecs Switching model Three phase, three stage, flying capacitor \ntopology in MV side \n[A.117] \nMatlab/Plecs Average model three stage and two stage, multi -port dc/dc \nconverter, quad-active-bridge (QAB) converter, \nintegrate PV and storage \n[A.118], \n[A.119], \n[A.120] \nMatlab/Plecs Switching and \naverage models \nSingle phase, three stage, two level [A.121] \nMatlab/Plecs Switching model Single phase, three stage ,AC/DC,DC/DC and \nDC/DC \n[A.122]  \nMatlab/Plecs Switching model series resonant three port, two stage, \nAC/DC/DC \n[A.123] \nMatlab/Plecs, \nRTDS \nAverage model  Single phase, three stage, two level [A.124] \nPLECS Switching model Matrix Converter based Power Electronic \nTransformer \n[A.125]  \nPLECS Average model Single phase, three stage, cascaded H-bridge [A.15] \nPLECS Average model Single phase, three stage, two level [A.126] \nPLECS Average model Single phase, three stage, cascaded H-bridge [A.127] \nSPICE/PLECS Dynamic phasor - \nbased model \nThree phase, three stage, modular and a \ncascade model of SST \n[A.128] \nSPICE Switching model Two stage, AC/DC/DC, special topology [A.129], \n[A.130] \nPSPICE Switching model Single phase, three stage, two level with \nbidirectional LLC resonant DC/DC converter \n[A.30] \nSaber Switching model Dual active bridge [A.131]  \nSABER/SPICE Switching model Five-level flying capacitor DC/DC Converter [A.132]  \nPSCAD Average model Single phase, three stage, cascaded H-bridge [A.133]  \nPSCAD Average model Three stage, two level [A.134], \n[A.135], \n[A.136], \n[A.137] \nPSCAD Switching model Three phase, three stage, two level [A.138]  \nPSCAD Average model Three phase, three stage, cascaded H bridge \ntopology \n[A.139] \nPSCAD Switching model Three phase, three stage, MMC in input stage, \nmulti-transformer in DAB \n[A.140] \nPSCAD/EMTDC Switching model Tri-directional power electronic transformer, \nsingle stage dc/ac \n[A.141]  \nAppendix: Prototypes and Simulation Tools \n \n129 \n \nTable A2 – SST simulation tools (cont.) \nSimulation tool Modeling \napproach Configuration References \nPSCAD/EMTDC Switching model Single phase, single stage, dc/ac [A.142] \nPSCAD/EMTDC Switching model Three phase, three stage, NPC in MV side [A.143] \nPSCAD/EMTDC Switching model Three phase, three stage, push-pull \nConverter in DAB stage \n[A.144] \nPSCAD/EMTDC Switching model Single phase, three stage, multilevel  [A.25] \nPSCAD/EMTDC Switching model Three phase, three stage, cascaded H -bridge in \ninput and output stages \n[A.145] \nPSCAD/EMTDC Switching model Single phase, three stage, cascaded H-bridge [A.146], \n[A.147]  \nPSCAD/EMTDC Switching model Three phase, three stage, two level [A.148] \nPSCAD/EMTDC Switching model Multi-source fed power electronic transformer, \nthree stage, NPC in MV side  \n[A.149] \nPSCAD/EMTDC Switching model Triple port active bridge converter based multi -\nfed PET, three stage, two level \n[A.150]  \nPSCAD/EMTDC Switching model MMC, DC/DC stage for DC microgrid [A.151] \nPSIM Switching model DC/DC isolation stage, two level [A.152], \n[A.153] \nPSIM Switching model DC/DC isolation stage, NPC based [A.154], \n[A.155] \nPSIM Switching model Single phase, two stage, cascaded topology, \nAC/DC/DC \n[A.37], \n[A.156] \nPSIM Switching model Three phase, three stage, cascaded H-bridge [A.157], \n[A.158] \nPSIM Average model AC-AC hybrid dual active bridge [A.159] \nEMTP Switching model Three stage, two level [A.160] \nEMTP Switching model Three phase, three stage, NPC based [A.161]  \nEMTP Switching model Three phase, three stage, cascaded modular \nstructure in MV side \n[A.162] \nOPENDSS Steady-state \nmodel \nThree phase, three stage, two level [A.163] \nSimplorer Switching model Three phase, three stage, NPC based [A.164]  \nRTDS Average model Single phase, three stage, cascaded H-bridge [A.165]  \nRTDS Average model Single phase, three stage, two level [A.166] \nOPAL-RT Switching model Multiple Resonances Mitigation of Paralleled \nInverters in a Solid -State Transformer enabled \nac microgrid, three stage \n[A.167] \nMultisim/Labview Switching model Single phase, two stage, matrix based converter [A.168], \n[A.169] \nDigsilent Power \nFactory \nAverage model Three phase, three stage, two level [A.170] \n \nReferences \n[A.1] J. Edward R. Ronan, S. D. Sudhoff, S. F. Glover, and D. L. Galloway, “Application \nof power electronics to the distribution transformer,” 15th Annual IEEE Applied \nPower Electronics Conf. and Exp. (APEC), 2000. \n[A.2] E. R. Ronan, S. D. Sudhoff, S. F. Glover, and D. L. Galloway, “A power electronic -\nbased distribution transformer,” IEEE Trans. on Power Deliv. , vol. 17, no. 2, pp. \n537–543, 2002. \n[A.3] J. Ai-Juan, L. Hang-Tian, and L. Shao- Long, “A new matrix type three- phase four-\nwire po wer electronic transformer,” IEEE Annual Power Electronics Specialists \nConf. (PESC), 2006. \nAdvanced Modeling of Solid State Transformer \n \n130 \n \n[A.4] J. S. Lai, A. Maitra, and F. Goodman, “Performance of a distribution intelligent \nuniversal transformer under source  and load disturbances,”  Industry Applications \nConf., 2006. \n[A.5] H. Iman -Eini, S. Farhangi, J. L. Schanen, and M. Khakbazan- Fard, “A modular \npower electronic transformer based on a cascaded H -bridge multilevel converter,” \nElectr. Power Syst. Res., vol. 79, no. 12, pp. 1625–1637, 2009. \n[A.6] M. Sabahi, S. H. Hosseini, M. B. Sharifian, A. Y. Goharrizi, and G. B. \nGharehpetian, “Bi-directional power electronic transformer with maximum power -\npoint tracking capability for induction heating applications,” IET Power Electron., \nvol. 3, no. 5, pp. 724–731, 2010. \n[A.7] S. B. Yu Du, G. Wang, and S. Bhattacharya, “Design considerations of high voltage \nand high frequency three phase transformer for Solid State Transformer application,” \nin 36th Annual Conf. of IEEE Industrial Electronics Society (IECON), 2010. \n[A.8] A. Huang, X. She, X. Yu, F. Wang, and G. Wang, “Next generation power \ndistribution system architecture: the future renewable electric energy delivery and \nmanagement (freedm) system,” The Third Int. Conf. on Sma rt Grids, Green \nCommunications and IT Energy-aware Technologies, 2013. \n[A.9] X. Yu, X. She, X. Ni, G. Wang, and A. Huang, “Power management strategy for DC \nmicrogrid interfaced to distribution system based on solid state transformer,” IEEE \nEnergy Conversion Cong. and Exp. (ECCE), 2013. \n[A.10] F. Wang, X. Lu, W. Wang, and A. Huang, “Development of distributed grid \nintelligence platform for solid state transformer,” 3rd IEEE Int. Conf. on Smart Grid \nCommunications (SmartGridComm), 2012. \n[A.11] F. Wang, A. Huang, G. Wang, X. She, and R. Burgos, “Feed- forward control of \nsolid state transformer,” 27th Annual IEEE Applied Power Electronics Conf. and \nExp. (APEC), 2012. \n[A.12] X. She, A. Q. Huang, and X. Ni, “A cost effective power sharing strategy for a \ncascaded multilevel converter based Solid state transformer,” IEEE Energy \nConversion Cong. and Exp. (ECCE), 2013. \n[A.13] X. Yu, X. She, X. Ni, and A. Q. Huang, “System integration and hierarchical power \nmanagement strategy for a solid -state transformer  interfaced microgrid system,” \nIEEE Trans. on Power Electron., vol. 29, no. 8, pp. 4414–4425, 2014. \n[A.14] X. Yu, X. She, and A. Huang, “Hierarchical power management for DC microgrid in \nislanding mode and Solid State transformer enabled mode,” 39th Annual Conf. of the \nIEEE Industrial Electronics Society (IECON), 2013. \n [A.15] X. She, A. Q. Huang, F. Wang, and R. Burgos, “Wind energy system with integrated \nfunctions of active power transfer , reactive power compensation , and voltage \nconversion,” IEEE Trans. on Ind. Electron., vol. 60, no. 10, pp. 4512–4524, 2013. \n[A.16] T. Zhao, G. Wang, S. Bhattacharya, and A. Q. Huang, “Voltage and power balance \ncontrol for a cascaded h- bridge converter -based solid -state Transformer,” IEEE \nTrans. on Power Electron., vol. 28, no. 4, pp. 1523–1532, 2013. \n[A.17] X. She, X. Yu, F. Wang, and A. Q. Huang, “Design and demonstration of a 3.6- kV-\n120-V/10-kVA solid-state transformer for smart grid application,” IEEE Trans. on \nPower Electron., vol. 29, no. 8, pp. 3982–3996, 2014. \n[A.18] T. Besselmann, A. Mester, and D. Dujic, “Power electronic traction transformer: \nEfficiency improvements under light -load conditions,” IEEE Trans. on Power \nElectron., vol. 29, no. 8, pp. 3971–3981, 2014. \n[A.19] D. Dujic, A. Mester, T. Chaudhuri, A. Coccia, F. Canales, and J. K. Steinke, \nAppendix: Prototypes and Simulation Tools \n \n131 \n \n“Laboratory scale prototype of a power electronic transformer for traction \napplications,” 14th European Conf. on Power Electronics and Applications (EPE) , \n2011. \n[A.20] C. Zhao, S. Lewdeni-Schmid, J. K. Steinke, M. We iss, T. Chaudhuri, M. Pellerin, J. \nDuron, and P. Stefanutti , “Design, implementation and performance of a modular \npower electronic transformer (P ET) for railway application,”  14th European Conf. \non Power Electronics and Applications (EPE), 2011. \n[A.21] C. Zhao, M. Weiss, A. Mester, S. Lewdeni -Schmid, D. Dujic, J. K. Steinke, and T. \nChaudhuri, “Power electronic transformer (PET) converter: Design of a 1.2MW \ndemonstrator for traction applications,”  21st Int. Symp. on Power Electronics, \nElectrical Drives, Automation and Motion (SPEEDAM), 2012. \n[A.22] D. Dujic  C. Zhao, A. Mester, J.K. Steinke, M. Weiss, S. Lewdeni -Schmid, T. \nChaudhuri, and P. Stefanutti , “Power electronic traction transformer -low voltage \nprototype,” IEEE Trans. on Power Electron., vol. 28, no. 12, pp. 5522–5534, 2013. \n[A.23] X. Liu, H. Li, and Z. Wang, “A start -up scheme for a three- stage solid -state \ntransformer with minimized transformer current response,” IEEE Trans. on Power \nElectron., vol. 27, no. 12, pp. 4832–4836, 2012. \n[A.24] Z. Li, P. Wa ng, Z. Chu, H. Zhu, Z. Sun, and Y. Li, “A three -phase 10 kVAC -750 \nVDC power electronic transformer for smart distribution grid,” 15th European Conf. \non Power Electronics and Applications (EPE), 2013. \n [A.25] B. M. Han, N. S. Choi, and J. Y. Lee, “New bidir ectional intelligent semiconductor \ntransformer for smart grid application,” IEEE Trans. on Power Electron., vol. 29, \nno. 8, pp. 4058–4066, 2014. \n[A.26] J. Y. Lee, Y. D. Yoon, and B. M. Han, “New intelligent semiconductor transformer \nwith bidirectional power-flow capability,” IEEE Trans. on Power Deliv., vol. 29, no. \n1, pp. 299–301, 2014. \n[A.27] F. Wang, G. Wang, A. Huang, W. Yu, and X. Ni, “Design and operation of a 3.6kV \nhigh performance solid state transformer based on 13kV SiC MOSFET and JBS \ndiode,” IEEE Energy Conversion Cong. and Exp. (ECCE), 2014. \n[A.28] F. Wang, G. Wang, A. Huang, X. Ni, and W. Yu, “Standalone operation of a single \nphase medium voltage solid state transf ormer in distribution grid,” 40th Annual \nConf. of the IEEE Industrial Electronics Society (IECON), 2014. \n[A.29] F. Wang, G. Wang, A. Huang, W. Yu, and X. Ni, “A 3.6kV high performance solid \nstate transform er based on 13kV SiC MOSFET,”  5th IEEE Int.  Symp. on Power \nElectronics for Distributed Generation Systems (PEDG), 2014. \n[A.30] K. Tan, R. Yu, S. Guo, and A. Q. Huang, “Optimal design methodology of \nbidirectional LLC resonant DC/DC converter for solid st ate transformer \napplication,” 40th Annual Conf. of the IEEE Industrial Electronics Society (IECON), \n2014. \n[A.31] F. Wang, G. Wang, A. Huang, W. Yu, and X. Ni, “Rectifier stage operation and \ncontroller design for a medium voltage solid state transformer with LCL filter,”  \nIEEE Energy Conversion Cong. and Exp. (ECCE), 2014. \n[A.32] A. Q. Huang, L. Wang, Q. Tian, Q. Zhu, D. Chen, and W. Yu, “Medium voltage \nsolid state transformers based on 15 kV SiC MOSFET and JBS diode,” 42nd Annual \nConf. of the IEEEIndustrial Electronics Society (IECON), 2016. \n [A.33] S. V. Garcia Oliveira, D. G.  Castellani, Y. R. de Novaes, N. P. Cardoso, M. B. da \nRosa, E. G. Brandt, and Y. Pires , “AC-AC modular multilevel converter applied t o \nsolid-state transformers,” 40th Annual Conf.  of the IEEE Industrial Electronics \nAdvanced Modeling of Solid State Transformer \n \n132 \n \nSociety (IECON), 2014. \n[A.34] H. Chen, A. Prasai, R. Moghe, K. Chintakrinda, and D. Divan, “A 50- kVA three-\nphase solid-state transformer based on the minimal topology: Dyna -C,” IEEE Trans. \non Power Electron., vol. 31, no. 12, pp. 8126–8137, 2016. \n[A.35] H. Chen, A. Prasai, and D. Divan, “Dyna -C: A minimal topology for bidirectional \nsolid-state transformers,” IEEE Trans. on Power Electron., vol. 32, no. 2, pp. 995–\n1005, 2017  \n[A.36] M. Morawiec, A. Lewicki, and Z. Krzemiński, “Power electronic transformer  for \nsmart grid application,” First Workshop on Smart Grid and Renewable Energy \n(SGRE), 2015.  \n[A.37] H. J. Yun, H. S. Kim, M. H. Ryu, J. W. Baek, and H. J. Kim, “A simple and \npractical voltage balance method for a solid -state transformer using cascaded H -\nbridge converters,” 9th Int. Conf. on Power Electronics (ICPE), 2015. \n[A.38] J. Ge, Z. Zhao, L. Yuan, and T. Lu, “Energy feed- forward and direct feed- forward \ncontrol for solid-state transformer,” IEEE Trans. on Power Electron., vol. 30, no. 8, \npp. 4042–4047, 2015. \n[A.39] B. Zhao, Q. Song, and W. Liu, “A practical solution of high- frequency-link \nbidirectional solid -state transformer based on advanced components in hybrid \nmicrogrid,” IEEE Trans. on Ind. Electron., vol. 62, no. 7, pp. 4587–4597, 2015. \n [A.40] S. Madhusoodhanan, A. Tripathi, D. Patel, K. Mainali, A. Kadavelugu, S. Hazra, S. \nBhattacharya, and K. Hatua, “Solid -State transformer and MV grid Tie applications \nenabled by 15 kV SiC IGBTs and 10 kV SiC MOSFETs based multilevel \nconverters,” IEEE Trans. on Ind. Appl., vol. 51, no. 4, pp. 3343–3360, 2015. \n[A.41] P. Garcia, S. Saeed, A. Navarro- Rodriguez, J. Garcia, and H. Schneider, “Switching \nfrequency optimization for a solid state transformer with energy storage \ncapabilities,” IEEE Energy Conversion Cong. and Exp. (ECCE), 2016. \n[A.42] Z. Wang and A. Castellazzi, “Impact of SiC technology in a three -port active bridge \nconverter for energy storage integrated solid sta te transformer applications,”  4th \nIEEE Workshop on Wide Bandgap Power Devices and Applications (WiPDA), 2016. \n[A.43] N. Nila -Olmedo, F. Mendoza -Mondragon, A. Espinosa -Calderon, and Moreno, \n“ARM + FPGA platform to manage solid -state-smart transformer in smart grid \napplication,” Int. Conf. on ReConFigurable Computing and FPGAs (ReConFig) , \n2016. \n[A.44] H. Chen and D. Divan, “Soft-switching solid state transformer (S4T),” IEEE Energy \nConversion Cong. and Exp. (ECCE), 2016. \n[A.45] J. Zhang, Z. Wang, and S. Shao, “A three -phase modular multilevel DC –  DC \nconverter for power electronic transformer applications,” IEEE J . Emerg. Sel. Top. \nPower Electron., vol. 5, no. 1, pp. 140–150, 2017. \n[A.46] R. Gao, X. She, I. Husain, and A. Huang, “Solid -state transformer interfaced \npermanent magnet wind turbine distributed generation system with power \nmanagement functions,” IEEE Trans. on Ind. Appl., vol. pp, no. 99, pp. 1–1, 2017. \n[A.47] Y. Liu, Y. Liu, B. Ge, and H. Abu -Rub, “Interactive grid interfacing system by \nmatrix-converter based solid state transformer with model predictive control,” IEEE \nTrans. on Ind. Informatics, no. 99, pp. 1–1, 2017. \n[A.48] Y. Liu, Y. Liu, H. Abu- Rub, B. Ge, R. S. Balog, and Y. Xue, “Model predictive \ncontrol of matrix converter ba sed solid state transformer,” IEEE Int. Conf. on \nIndustrial Technology (ICIT), 2016. \nAppendix: Prototypes and Simulation Tools \n \n133 \n \n[A.49] EPRI, “100-kVA intelligent universal transformer development,” 2008. \n[A.50] EPRI, “Bench model development of a new multilevel converter -based intelligent \nuniversal transformer,” 2005. \n[A.51] EPRI, “Development of a new multilevel converter -based intelligent universal \ntransformer : design analysis,” 2004. \n[A.52] EPRI, “Feasibility study for the development of high -voltage, low -current power \nsemiconductor devices,” 2004. \n[A.53] H. Mirmousa and M. R. Zolghadri, “A novel circuit topology for three -phase four-\nwire Distribution E lectronic Po wer Transformer,”  7th Int. Conf. on Power \nElectronics and Drive Systems (PEDS), 2007. \n[A.54] D. Wang, C. Mao, and J. Lu, “Modelling of electronic power transformer and its \napplication to power system,” IET Gener. Transm. Distrib. , vol. 1, no. 6, pp. 887–\n895, 2007. \n[A.55] H. Iman-Eini, J. L. Schanen, S. Farhangi, J. Barbaroux, and J. P. Keradec, “A power \nelectronic based transformer f or feeding sensitive loads,” IEEE Power Electronics \nSpecialists Conf. (PESC), 2008. \n[A.56] K. K. Mohapatra and N. Mohan, “Matrix converter fed open-ended power electronic \ntransformer for power system application,” IEEE Power and Energy Society General \nMeeting, 2008. \n[A.57] S. Nath, K. K. Mohapatra, and N. Mohan, “Output voltage regulation in matrix \nconverter fed power electronic transformer for power systems ap plication in electric \nship,” IEEE Electric Ship Technologies Symp. (ESTS), 2009. \n[A.58] S. Nath, K. K. Mohapatra, K. Basu, and N. Mohan, “Source based commutation in \nmatrix converter fed power electronic transformer for  power systems application,” \nInt. Symp. on Power Electronics, Electrical Drives, Automation and Motion \n(SPEEDAM), 2010. \n[A.59] H. Liu, C. Mao, J. Lu, and D. Wang, “Optimal regulator -based control of electronic \npower transformer for distribution systems,” Electr. Power Syst. Res., vol. 79, no. 6, \npp. 863–870, 2009. \n[A.60] H. Liu, C. Mao, J. Lu, and D. Wang, “Electronic power transformer with \nsupercapacitors storage energy system,” Electr. Power Syst. Res. , vol. 79, no. 8, pp. \n1200–1208, 2009. \n[A.61] T. Zhao, J. Zeng, S. Bhattacharya, M. E. Baran, and A. Q. Huang, “An average \nmodel of solid state transformer for dynamic system simulation,” IEEE Power and \nEnergy Society General Meeting, 2009. \n[A.62] W. Qingshan and D. Liang, “Research on loss reduction of dual active bridge \nconverter over wide load range for solid st ate transformer application,”  11th Int. \nConf. on Ecological Vehicles and Renewable Energies (EVER), 2016. \n[A.63] K. Basu and N. Mohan, “A power electronic transformer for PWM AC drive with \nlossless commutation and comm on-mode voltage suppression,”  Joint Int. Conf. on \nPower Electronics, Drives and Energy Systems (PEDES) & Power India, 2010. \n[A.64] K. Basu, A. Shahani, A. K. Sahoo, and N. Mohan, “A single -stage solid -state \ntransformer for PWM AC drive with source- based commutation of leakage energy,” \nIEEE Trans. on Power Electron., vol. 30, no. 3, pp. 1734–1746, 2015. \n[A.65] X. Mao, S. Falcones, and R. Ayyanar, “Energy-based control design for a solid state \ntransformer,” IEEE Power and Energy Society General Meeting, 2010. \n[A.66] S. Falcones, X. Mao, and R. Ayyanar, “Simulation of the FREEDM green hub with \nAdvanced Modeling of Solid State Transformer \n \n134 \n \nsolid state transformers and distributed cont rol,” Future Renewable Electric Energy \nDistribution, 2010. \n[A.67] K. Xu, C. Fu, Y. Wang, and H. Wang, “Voltage and current balance control for the \nISOP converter -based power ele ctronic transformer,” 18th Int. Conf. onElectrical \nMachines and Systems (ICEMS), 2015. \n[A.68] R. C. Mala, S. Tripathy, S. Tadepalli, and D. R. Reddy, “Performance analysis of \nthree phas e solid state transformers,” Int.  Conf. on Devices, Circuits and Systems \n(ICDCS), 2012. \n[A.69] G. Zhabelova, A. Yavarian, V. Vyatkin, and A. Q. Huang, “Data center energy \nefficiency and power quality : an alternative approach with solid state transformer,” \n41st Annu. Conf. IEEE Industrial Electronics Society (IECON), 2015. \n[A.70] X. Wang and G. Zhang, “Research on Power Electronic Transformer wi th \nBidirectional Power Flow,”  8th IEEE Int.  Power Electronics and Motion Control \nConf. (IPEMC-ECCE Asia), 2016. \n[A.71] I. Syed and V. Khadkikar, “Replacing the grid interface transformer in wind energy \nconversion system with solid -state transformer,” IEEE Trans. on Power Syst., vol. \n32, no. 3, pp. 2152–2160, 2017. \n[A.72] D. Wang, C. Mao, J. Lu, J. He, and H. Liu, “Auto- balancing transformer based on \npower electronics,” Electr. Power Syst. Res., vol. 80, no. 1, pp. 28–36, 2010. \n[A.73] S. Nath and N. Mohan, “A solid state power converter with sinusoidal currents in \nhigh frequency transformer for power system applications,” IEEE Int. Conf. on \nIndustrial Technology, 2011. \n[A.74] A. Shahani, K. Basu, and N. Mohan, “A power electronic transformer based on \nindirect matrix converter for PWM AC drive with lossless commutation of leakage \nenergy,” 6th IET Int. Conf. on Power Electronics, Machines and Drives (PEMD) , \n2012. \n[A.75] G. Kunov, “Matlab- Simulink model of solid- state transformer realized with matrix \nconverters,” in 18th Int. Symp. on Electrical Apparatus and Technologies (SIELA) , \n2014. \n[A.76] H. Liu, J. Yang, C. Mao, J. Lu, D. Wang, Y. Zhu, H. Lou, and S. Wang , “Nonlinear \ncontrol of electronic power transformer for distribution system using feedback \nlinearization,” IEEE Power Engineering and Automation Conf. (PEAM), 2011. \n[A.77] H. Açıkgöz, Ö. F. Keçecioğlu, A. Gani, C. Yıldız, and M. Şekkeli, “Optimal control \nand analysis of three phase electronic power transformers,” Procedia Soc. Behav. \nSci., vol. 195, pp. 2412–2420, 2015. \n[A.78] M. R. Banaei and E. Salary, “Power quality improvement based on novel power \nelectronic transformer,”  2nd Power Electronics, Drive Systems and Technologies \nConf. (PEDSTC), 2011. \n[A.79] B .T. Kalyan and P. R. Prasad, “Analysis and design of power electronic transformer \nbased power quality improvement,” IOSR J. Electr. Electron. Eng., vol. 5, no. 1, pp. \n61–69, 2013. \n[A.80] M. R. Banaei and E. Salary, “Mitigation of voltage sag, swell and power factor \ncorrection using solid- state transformer based m atrix converter in output stage,” \nAlexandria Eng. J., vol. 53, no. 3, pp. 563–572, 2014. \n[A.81] R. Baran Roy, M. Rokonuzzaman, and M. Hossam -e-haider, “Design and Analysis \nof the Power Electronic Transformer for Power Quality Improvement,” Int. Conf. on \nElectrical Engineering and Information Communication Technology (ICEEICT) , \n2015. \nAppendix: Prototypes and Simulation Tools \n \n135 \n \n[A.82] M. Sadeghi and M. Gholami, “A novel distribution automation involving intelligent \nelectronic devices as IUT,” Int. J. Circuits, Syst. Signal Process. , vol. 5, no. 5, pp. \n443–450, 2011. \n[A.83] M. Sadeghi and M. Gholami, “Genetic algorithm optimization methodology for \nPWM Inverters of Intelligent universal transformer for the advanced distribution \nautomation of future,” Indian J. Sci. Technol., vol. 5, no. 2, pp. 2035–2040, 2012. \n[A.84] M. Sadeghi, “Modern methodology introducing for three layers intelligent universal \ntransformers in advanced distribution automation equipping pi voltage and current \nsource controllers,” Int. J. Inf. Electron. Eng., vol. 3, no. 3, pp. 258–261, 2013. \n[A.85] C. Ling, B. Ge, D. Bi, and Q. Ma, “An effective power electronic transformer \napplied to distribution system,” Int. Conf. on Electrical Machines and Systems \n(ICEMS), 2011. \n[A.86] G. Wang, X. She, F. Wang, A. Kadavelugu, T. Zhao, A. Huang, and W. Yao , \n“Comparisons of different control strategies for 20kVA solid state  transformer,” \nIEEE Energy Conversion Cong. and Exp. (ECCE), 2011. \n [A.87] S. Alepuz, F. González -Molina, J. Martin-Arnedo, and J. A. Martinez -Velasco, “Time-\ndomain model of a bidirectional distribution electronic power transformer,” Int.  \nPower System Transients Conf., 2013. \n[A.88] S. Alepuz, F. Gonzalez, J. Martin- Arnedo, and J. A. Martinez, “Solid state \ntransformer with low -voltage ride -through and current unbalance management \ncapabilities,” 39th Annual Conf. of the IEEE Industrial Electronics Society (IECON), \n2013. \n[A.89] J. A. Martinez -Velasco, S. Alepuz, F. Gonzalez -Molina, and J. Martin- Arnedo, \n“Dynamic average modeling of a bidirectional solid state transformer for feasibility \nstudies and real -time implementation,” Electr. Power Syst. Res. , vol. 117, pp. 143–\n153, 2014. \n[A.90] S. Alepuz, F. Gonzalez -Molina, J. Martin -Arnedo, and J. A. Martinez -Velasco, \n“Development and testing of a bidirectional distribution electronic power \ntransformer model,” Electr. Power Syst. Res., vol. 107, pp. 230–239, 2014. \n[A.91] Z. Yu, R. Ayyana r, and I. Husain, “A detailed analytical model o f a solid state \ntransformer,” IEEE Energy Conversion Cong. and Exp. (ECCE), 2015. \n[A.92] A. Shojaei and G. Joos, “A topology for three -stage Solid State Transformer,” IEEE \nPower and Energy Society General Meeting, 2013. \n[A.93] A. Shojaei and G. Joos, “A modular solid state transformer with a single -phase \nmedium-frequency transformer,” IEEE Electrical Power & Energy Conf. (EPEC), \n2013. \n[A.94] A. Shojaei and G. Joos, “A modular multilevel converter -based power electronic \ntransformer,” IEEE Energy Conversion Cong. and Exp., (ECCE), 2013. \n[A.95] A. Shojaei, “Design of modular multilevel converter-based solid state transformers,” \nMaster Thesis, McGillUniversity, 2014. \n[A.96] J. Yang, C. Mao, D. Wang, J. Lu, X. Fu, and X. Chen, “Fast and continuous on- load \nvoltage regulator based on electronic power transformer,” IET Electr. Power Appl. , \nvol. 7, no. 6, pp. 499–508, 2013. \n[A.97] I. Roasto, E. Romero- cadaval, and J. Martins, “Active power electronic transformer \nbased on modular building blocks,”  39th Annual Conf. of the IEEE Industrial \nElectronics Society (IECON), 2013. \n[A.98] F. N. Najaty Mazgar, M. Tarafdar Hagh, and S. E. Baghbani, “Dual Output Power \nAdvanced Modeling of Solid State Transformer \n \n136 \n \nElectronic Transformer,” 21st Iranian Conf.  on Electrical Engineering (ICEE) , \n2013. \n[A.99] Y. Liu, A. Escobar -Mejia, C. Farnell, Y. Zhang, J. C. Balda, and H. A. Mantooth, \n“Modular multilevel converter with high -frequency transformers for interfacing \nhybrid DC and AC microgrid systems,” 5th IEEE Int. Symp. on Power Electronics \nfor Distributed Generation Systems (PEDG), 2014. \n[A.100] X. Yu, X. Ni, and A. Huang, “Multiple objectives tertiary control strategy for solid \nstate transformer interfaced DC microgrid,” IEEE Energy Conversion Cong. and \nExp. (ECCE), 2014. \n[A.101] Y. Sun, J. Liu, Y. Li, C. Fu, and H. Wang, “Research on voltage and switching \nbalance control for cascaded power electronic transformer under hybrid PWM \nmodulation,” 8th IEEE Int. Power Electronics and Motion Control Conf. (IPEMC -\nECCE Asia), 2016. \n[A.102] M. M. Rana, R. Rahman, and M. Rahman, “Solid state transformer based on cascade \nmultilevel converter for distribution network,” 9th Int. Conf. on Electrical and \nComputer Engineering (ICECE ), 2016. \n[A.103] D. Shanmugam and K. Indiradevi , “Implementation of multiport dc -dc converter - \nbased solid state transformer in smart grid system,” Int. Conf. on Computer \nCommunication and Informatics (ICCCI), 2014. \n[A.104] T. Ponraj, “A Solid State Transformer Integrating Distributed Generation and \nStorage,” Int. J. Innov. Res. Comput. Commun. Eng., vol. 2, no. 1, pp. 4029–4035, \n2014. \n[A.105] A. K. Sahoo and N. Mohan, “A power electronic transformer with sinusoidal \nvoltages and currents using modular multilevel converter,” Int. Power Electronics \nConf. (IPEC), 2014. \n[A.106] J. P. Contreras and J. M. Ramirez, “Multi -fed power electronic transformer for use \nin modern distribution systems,” IEEE Trans. on Smart Grid , vol. 5, no. 3, pp. \n1532–1541, 2014. \n[A.107] X. Yu, X. She, X. Zhou, and A. Q. Huang, “Power management for DC microgrid \nenabled by solid- state transformer,” IEEE Trans. on Smart Grid, vol. 5, no. 2, pp. \n954–965, 2014. \n[A.108] Z. Wang, T. Wang, and J. Zhang, “Three phase modular multilevel DC/DC \nconverter for power electron ic transformer application,” IEEE Energy Conversion \nCong. and Exp. (ECCE), 2015. \n[A.109] L. Tarisciotti, P. Zanchetta, A. Watson, P. Wheeler, J. C. Clare, and S. Bifaretti, \n“Multiobjective modulated model predictive control for a multilevel solid -state \ntransformer,” IEEE Trans. on Ind. Appl., vol. 51, no. 5, pp. 4051–4060, 2015. \n[A.110] C. Gu, Z. Zheng, L. Xu, K. Wang, and Y. Li, “Modeling and control of a multiport \npower electronic transformer ( PET ) for electric traction applicati ons,” IEEE Trans. \non Power Electron., vol. 31, no. 2, pp. 915–927, 2016. \n[A.111] B. Liu, Y. Zha, T. Zhang, and S. Chen, “Solid state transformer application to grid \nconnected photovoltaic inverters,” Int. Conf. on Smart Grid and Clean Energy \nTechnologies (ICSGCE ), 2016. \n[A.112] V. Ankita and A. Vijayakumari, “A reduced converter count solid state transformer \nfor grid connected photovoltaic applications,” Int. Conf. on Emerging Technological \nTrends (ICETT), 2016. \n[A.113] M. E. Adabi, J. A. Martinez -Velasco, and S. Alepuz, “Modeling and simulation of a \nMMC-based solid-state transformer,” Accepted for publiction in Electr. Eng., 2017. \nAppendix: Prototypes and Simulation Tools \n \n137 \n \n[A.114] M. E. Adabi and J. A. Martinez-velasco, “MMC-based solid-state transformer model \nincluding semiconductor losses,” Accepted for publiction in Electr. Eng., 2017. \n[A.115] K. Y. Ahmed, N. Z. Yahaya, and V. S. Asirvadam, “Optimal analysis and design of \npower electronic distribution transformer,” Res. J. Appl. Sci. Eng. Technol., vol. 7, \nno. 9, pp. 1734–1743, 2014. \n[A.116] H. Qin and J. W. Kimball, “Ac -Ac dual active bridge converter f or solid state \ntransformer,” IEEE Energy Conversion Cong. and Exp. (ECCE), 2009. \n[A.117] A. M. Y.  M. Ghias, M. Ciobotaru, V. G. Agelidis, and J. Pou, “Solid state \ntransformer based on the flying capacitor multilevel converter for intelligent power \nmanagement,” IEEE Power Engineering Society Conf. and Exp. in Africa \n(PowerAfrica), 2012. \n[A.118] D. Shanmugam, D. Balakrishnan, and K. Indiradevi, “Solid state transformer \nintegration in smart grid system,” Int. J. Sci. Technol., vol. 3, no. 2, pp. 8–14, 2012. \n[A.119] D. Shanmugam, D. Balakrishnan, and K. Indiradevi, “A multiport dc -dc converter-\nbased solid state transformer in smart grid system,” Int. J. Recent Trends Electr. \nElectron. Engg, vol. 3, no. 1, pp. 1–9, 2013. \n[A.120] S. Falcones, R. Ayyanar, and X. Mao, “A DC -DC Multiport-converter-based solid-\nstate transformer integrating distributed generation and storage,” IEEE Trans. on \nPower Electron., vol. 28, no. 5, pp. 2192–2203, 2013. \n[A.121] Y. Jiang, L. Breazeale, R. Ayyanar, and X. Mao, “Simplified Solid State \nTransformer modeling for Real Tim e Digital Simulator (RTDS),” IEEE Energy \nConversion Cong. and Exp. (ECCE), 2012. \n[A.122] Y. Cho, Y. Han, R. B. Beddingfield, J. I. Ha, and S. Bhattacharya, “Seamless black \nstart and reconnection of LCL -filtered solid state transformer based on droop \ncontrol,” IEEE Energy Conversion Cong. and Exp. (ECCE ), 2016. \n[A.123] W. L. Malan, D. M. Vilat hgamuwa, G. R. Walker, and M. Hiller, “A three port \nresonant solid state transformer with minimized circulating reactive currents in the \nhigh frequency link,” IEEE Annual Southern Power Electronics Conf. (SPEC ) , \n2016. \n[A.124] R. Mo, C. Mao, J. Lu, H. Li, and X. Liu, “Three -stage solid state transformer \nmodeling through real time digital simulation with controller hardware -in-the-loop,” \nin 7th Int. Power Electronics and Motion Control Conf. (IPEMC), 2012, pp. 1116–\n1119. \n[A.125] G. Castelino and N. Mohan, “M odulation and commutation of Matrix Converter \nbased Power Electronic Transformer using a single FPGA,” 39th Annual Conf. of the \nIEEE Industrial Electronics Society (IECON), 2013. \n[A.126] H. Qin and J. W. Kimball, “Closed- loop control of DC -DC dual -active-bridge \nconverters driving single-phase inverters,” IEEE Trans. on Power Electron., vol. 29, \nno. 2, pp. 1006–1017, 2014. \n[A.127] S. Ouyang, J. Liu, X. Wang, S. Song, X. Hou, and T. Wu, “A single phase power \nelectronic transformer considering harmonic compensation in scott traction system,” \n9th Int. Conf. on Power Electronics and ECCE Asia (ICPE-ECCE Asia), 2015. \n[A.128] M. Parimi, M. Monika, M. Rane, S. Wagh, and A. Stankovic, “Dynamic phasor -\nbased small-signal stability analysis and control of solid state transformer,” 6th IEEE \nInt. Conf. on Power Systems (ICPS), 2016. \n[A.129] M. Saghaleini and S. Farhangi, “Distributed power supply with power factor \ncorrection: A solution to feed all modules in pow er electronic transformers,” 7th Int. \nConf. on Power Electronics (ICPE), 2007. \nAdvanced Modeling of Solid State Transformer \n \n138 \n \n[A.130] M. Saghaleini, A. Hekmati, and S. Farhangi, “An advanced distributed power supply \nfor power  electronic transformers,” 33rd Annual Conf. of the IEEE Industrial \nElectronics Society (IECON), 2007. \n[A.131] J. Xue, “S ingle-phase vs. three- phase high power high frequency transformers,” \nMaster Thesis,Virginia Polytech. Inst. State Univ., 2010. \n[A.132] L. Yang, T. Zhao, J. Wang, and A. Q. Huang, “Design and analysis of a 270kW five-\nlevel DC/DC converter for solid state tr ansformer using 10kV SiC power devices,” \nIEEE Power Electronics Specialists Conf. (PESC), 2007. \n[A.133] S. Dutta, V. Ramachandar, and S. Bhattacharya, “Black start operation for the solid \nstate transformer created micro -grid under islanding with storage,” IEEE Energy \nConversion Cong. and Exp. (ECCE), 2014. \n[A.134] V. Ramachandran, A. Kuvar, U. Singh, and S. Bhattacharya, “A system level study \nemploying improved solid state transformer average models with r enewable energy \nintegration,” IEEE Power and Energy Society General Meeting, 2014. \n[A.135] M. Khazraei, V. A. K. Prabhala, R. Ahmadi, and M. Ferdowsi, “Solid- state \ntransformer stability and control considerations,” 29th Annual IEEE Applied Power \nElectronics Conf. and Exp. (APEC), 2014. \n[A.136] D. G. Shah and M. L. Crow, “Stability design criteria for distribution systems with \nsolid-state transformers,” IEEE Trans. on Power Deliv., vol. 29, no. 6, pp. 2588–\n2595, 2014. \n[A.137] D. Shah and M. L. Crow, “Online Volt -Var Control for Distribution Systems With \nSolid State Transformers,” IEEE Trans. on Power Deliv., vol. 31, no. 1, pp. 343 –\n350, 2016. \n[A.138] H. Wen and R. Yang, “Power management of solid state transformer in microgrids,” \nIEEE PES Asia-Pacific Power and Energy Engineering Conf. (APPEEC), 2016. \n[A.139] C. Liu, Y. Zhi, Y. Zhang, and G. Cai, “New breed of solid- state transformer \ndistribution tail system for flexible power conversion between medium -voltage \ndistribution and low-voltage custo mer side,” IEEE PES Asia -Pacific Power and \nEnergy Conf. (APPEEC), 2016. \n[A.140] T. Zhou and Y. Xu, “Fault characteristic analysis and simulation of power electronic \ntransformer based on MMC in distribution network,”  First IEEE Int. Conf. on \nEnergy Internet, 2017. \n[A.141] S. H. Hosseini, M. B. B. Sharifian, M. Sabahi, Z. Hooshi, and G. B. Gharehpetian, \n“A tri -directional power electronic transformer for photo voltaic based distribu ted \ngeneration application,” IEEE Power and Energy Society General Meeting, 2009. \n[A.142] S. H. Hosseini, M. B. B. Sharifian, M. Sabahi,  a. Y. Goharrizi, and G. B. \nGharehpetian, “Bi-directional power electronic transformer based compa ct dynamic \nvoltage restorer,” IEEE Power & Energy Society General Meeting, 2009. \n[A.143] W. Hu, J. Cheng, M. Chen, J. Lu, and Y. Cai, “Research on distribution IUT based \non three voltage level topology,” China Int. Conf. on Electricity Distribution \n(CICED), 2012. \n[A.144] F. N. Mazgar, M. T. Hagh, and E. Babaei, “Distribution electronic power \ntransformer with reduced number of power switches,” 3rd Power Electronics and \nDrive Systems Technology (PEDSTC), 2012. \n[A.145] J. Venkat, A. Shukla, and S. V. Kulkarni, “Operation of a three phase solid state -\nTransformer under unbalanced load conditions,” IEEE Int. Conf. on Power \nElectronics, Drives and Energy Systems (PEDES), 2014. \nAppendix: Prototypes and Simulation Tools \n \n139 \n \n[A.146] K. Zhou, Q. Jin, Z. Lan, C. Tu, M. Guo, and G. Liu, “The study of power electronic \ntransformer on power flow control and voltage regulation in D C micro- grid,” 5th \nInt. Conf. on E lectric Utility Deregulation and Restructuring and Power \nTechnologies (DRPT), 2015. \n[A.147] K. Zhou and H. Chu, “Study on the optimal DC voltage control for power electronic \ntransformer,” 5th Int. Conf. on Electric Utility Deregulation and Restructuring an d \nPower Technologies (DRPT), 2015. \n[A.148] S. Paladhi and S. Ashok, “Solid state transformer application in wind based DG \nsystem,” IEEE Int. Conf. on Signal Processing, Informatics, Communication and \nEnergy Systems (SPICES), 2015. \n[A.149] V. N. Rao Jakka a nd A. Shukla, “Integration of AC and DC sources using multi -\nsource fed power electronic transformer (MSF -PET) for modern power distribution \nsystem applications,” 18th European Conf.  on Power Electronics and Applications \n(EPE-ECCE Europe), 2016. \n[A.150] V. N. RaoJakka and A. Shukla, “A triple port active bridge converter based multi - \nfed power electronic transformer,” IEEE Energy Conversion Cong. and Exp. \n(ECCE), 2016. \n[A.151] B. Fan, Y. Li, K. Wang, Z. Zheng, and L. Xu, “Hierarchical system design and \ncontrol of an MMC -based power -electronic transformer,” IEEE Trans. on  Ind. \nInformatics, vol. 13, no. 1, pp. 238–247, 2017. \n[A.152] V. Beldjajev and I. Roasto, “Analysis of New Bidirectional DC-DC Converter Based \non Current Doubler Rectifier,”  10th Int. Symp. onTopical Problems in the Field of \nElectrical and Power Engineering, 2011. \n[A.153] M. A. Moonem and H. Krishnaswami, “Analysis of dual active bridge based power \nelectronic transformer  as a three- phase inverter,” 38th Annual Conf.  on IEEE \nIndustrial Electronics Society (IECON), 2012. \n[A.154] M. A. Moonem and H. Krishnaswami, “Analysis and control of multi -level dual \nactive bridge DC-DC converter,” IEEE Energy Conversion Cong. and Exp. (ECCE), \n2012. \n[A.155] M. A. Moonem and H. Krishnaswami, “Control and conf iguration of three -level \ndual-active bridge DC -DC converter as a front -end interfa ce for photovoltaic \nsystem,” 29th IEEE Applied Power Electronics Conf. and Exp. (APEC), 2014. \n[A.156] S. Zengin and M. Boztepe, “Trapezoid current modulated DCM AC/DC DAB \nconverter for two -stage solid state transformer,” 9th Int. Conf. on Electrical and \nElectronics Engineering (ELECO), 2015. \n[A.157] H. Li, Y. Wang, and C. Yu, “Research on voltage balance and power balance control \nfor three-phase cascaded multilevel converter based power electronic transformer,” \n42nd Annual Conf. of the IEEE Industrial Electronics Society (IECON), 2016. \n[A.158] H. Li, Y. Wang, and C. Yu, “Control of three -phase cascaded multilevel converter \nbased power electronic transformer under  unbalanced input voltages,” 42nd Annual \nConf. of the IEEE Industrial Electronics Society (IECON), 2016. \n[A.159] G. G. Facchinello, H. Mamede, L. L. Brighenti, S. L. Brockveld, W. Dos Santos, and \nD. C. Martins, “AC -AC hybrid dual active bridge converter for solid stat e \ntransformer,” 7th IEEE Int. Symp. on Power Electronics for Distributed Generation \nSystems (PEDG), 2016. \n[A.160] J. Martin -Arnedo, F. Gonzalez -Molina, J. A. Martinez -Velasco, and S. Alepuz, \n“Development and testing of a distribution electronic power trans former model,” \nIEEE Power and Energy Society General Meeting, 2012. \nAdvanced Modeling of Solid State Transformer \n \n140 \n \n[A.161] F. González -Molina, J. Martin- Arnedo, S. Alepuz, and J. A. Martinez, “EMTP \nmodel of a bidirectional multilevel solid state transformer for distribution system \nstudies,” Power & Energy Society General Meeting, 2015. \n[A.162] J. Martin -Arnedo, F. González -Molina, J. A. Martinez -Velasco, and M. E. Adabi, \n“EMTP model of a bidirectional cascaded multilevel solid state transformer for \ndistribution system studies,” Energies, vol. 10, no. 4, pp. 521–539, 2017. \n[A.163] G. Guerra and J. A. Martinez -Velasco, “A solid state transformer model for power \nflow calculations,” Int. J. Electr. Power Energy Syst., vol. 89, pp. 40–51, 2017. \n[A.164] J. S. Lai, A. Maitra, A. Mansoor, and F. Goodman, “Multil evel intelligent universal \ntransformer for medium voltage applications,” Industry Applications Conf., 2005. \n[A.165] P. Tatcho, Y. Jiang, and H. Li, “A novel line section protection for the FREEDM \nsystem based on t he solid state transformer,” IEEE Power and  Energy Society \nGeneral Meeting, 2011. \n[A.166] P. Tatcho, H. Li, Y. Jiang, and L. Qi, “A novel hierarchical section protection based \non the solid state transformer for the future renewable electric energy delivery and \nmanagement (FREEDM) system,” IEEE Trans. on Smart Grid , vol. 4, no. 2, pp. \n1096–1104, 2013. \n[A.167] Q. Ye, R. Mo, and H. Li, “Multiple resonances mitigation of paralleled inverters in a \nsolid-state transformer (SST) enabled ac microgrid,” accepted for publication in \nIEEE Trans. on Smart Grid. \n[A.168] M. Maheswari and N. S. Kumar, “Design and control of power electronic \ntransformer with power facto r correction,” Int. Conf. on Circuit, Power and \nComputing Technologies (ICCPCT), 2015. \n[A.169] S. V. Devi and N. S. Kumar, “Design of power electronic transformer based variable \nspeed wind energy conversion system,” Int. Conf. on Circuit, Power and Computing \nTechnologies (ICCPCT), 2016. \n[A.170] N. S. C. Hunziker, “Solid-state transformer modeling for analyzing its application in \ndistribution grids,” Int. Exhibition and Conf. for Power Electronics, Intelligent \nMotion, Renewable Energy and Energy Management (PCIM Europe), 2016. \n \n "
}