{
    "title": "Predicting Risk of Alzheimer’s Diseases and Related Dementias with AI Foundation Model on Electronic Health Records",
    "url": "https://openalex.org/W4395688431",
    "year": 2024,
    "authors": [
        {
            "id": "https://openalex.org/A5064366960",
            "name": "Weicheng Zhu",
            "affiliations": [
                "New York University"
            ]
        },
        {
            "id": "https://openalex.org/A5102625090",
            "name": "Huanze Tang",
            "affiliations": [
                "New York University"
            ]
        },
        {
            "id": "https://openalex.org/A5100396983",
            "name": "Hao Zhang",
            "affiliations": [
                "New York University"
            ]
        },
        {
            "id": "https://openalex.org/A5067129067",
            "name": "Haresh Rengaraj Rajamohan",
            "affiliations": [
                "New York University"
            ]
        },
        {
            "id": "https://openalex.org/A5025534919",
            "name": "Shih‐Lun Huang",
            "affiliations": [
                "New York University"
            ]
        },
        {
            "id": "https://openalex.org/A5100732415",
            "name": "Xinyue Ma",
            "affiliations": [
                "New York University"
            ]
        },
        {
            "id": "https://openalex.org/A5104288991",
            "name": "Ankush Chaudhari",
            "affiliations": [
                "New York University"
            ]
        },
        {
            "id": "https://openalex.org/A5039876507",
            "name": "Divyam Madaan",
            "affiliations": [
                "New York University"
            ]
        },
        {
            "id": "https://openalex.org/A5095913261",
            "name": "Elaf Almahmoud",
            "affiliations": [
                "New York University"
            ]
        },
        {
            "id": "https://openalex.org/A5078511139",
            "name": "Sumit Chopra",
            "affiliations": [
                "New York University"
            ]
        },
        {
            "id": "https://openalex.org/A5011533153",
            "name": "John A. Dodson",
            "affiliations": [
                "New York University"
            ]
        },
        {
            "id": "https://openalex.org/A5072528262",
            "name": "Abraham A. Brody",
            "affiliations": [
                "New York University"
            ]
        },
        {
            "id": "https://openalex.org/A5000421658",
            "name": "Arjun V. Masurkar",
            "affiliations": [
                "New York University"
            ]
        },
        {
            "id": "https://openalex.org/A5079997593",
            "name": "Narges Razavian",
            "affiliations": [
                "NYU Langone Health"
            ]
        }
    ],
    "references": [
        "https://openalex.org/W4324309277",
        "https://openalex.org/W3046275966",
        "https://openalex.org/W2767297946",
        "https://openalex.org/W2912533302",
        "https://openalex.org/W2900724835",
        "https://openalex.org/W2966774490",
        "https://openalex.org/W4310461604",
        "https://openalex.org/W2950283932",
        "https://openalex.org/W4306404621",
        "https://openalex.org/W4377029875",
        "https://openalex.org/W2981048659",
        "https://openalex.org/W4387708841",
        "https://openalex.org/W4288700352",
        "https://openalex.org/W2514071032",
        "https://openalex.org/W3112116031",
        "https://openalex.org/W3129421081",
        "https://openalex.org/W6739901393",
        "https://openalex.org/W3017637887",
        "https://openalex.org/W3160137267",
        "https://openalex.org/W4375858857",
        "https://openalex.org/W3001279689",
        "https://openalex.org/W2963341956",
        "https://openalex.org/W2965373594",
        "https://openalex.org/W6796581206",
        "https://openalex.org/W6804060338",
        "https://openalex.org/W2949709152",
        "https://openalex.org/W4384024395",
        "https://openalex.org/W3085380432",
        "https://openalex.org/W1963973361",
        "https://openalex.org/W3153694929",
        "https://openalex.org/W2078500956",
        "https://openalex.org/W4386050046",
        "https://openalex.org/W4383481856",
        "https://openalex.org/W2994889552",
        "https://openalex.org/W3094443046",
        "https://openalex.org/W4389940547",
        "https://openalex.org/W3194419114",
        "https://openalex.org/W4211238543",
        "https://openalex.org/W3112296242",
        "https://openalex.org/W4291327355",
        "https://openalex.org/W3146388672",
        "https://openalex.org/W3133810340",
        "https://openalex.org/W3167009549",
        "https://openalex.org/W4385501660",
        "https://openalex.org/W2151119363",
        "https://openalex.org/W2625625371",
        "https://openalex.org/W3104523752",
        "https://openalex.org/W3137942329",
        "https://openalex.org/W2964010366"
    ],
    "abstract": "ABSTRACT Early identification of Alzheimer’s disease (AD) and AD-related dementias (ADRD) has high clinical significance, both because of the potential to slow decline through initiating FDA-approved therapies and managing modifiable risk factors, and to help persons living with dementia and their families to plan before cognitive loss makes doing so challenging. However, substantial racial and ethnic disparities in early diagnosis currently lead to additional inequities in care, urging accurate and inclusive risk assessment programs. In this study, we trained an artificial intelligence foundation model to represent the electronic health records (EHR) data with a vast cohort of 1.2 million patients within a large health system. Building upon this foundation EHR model, we developed a predictive Transformer model, named TRADE , capable of identifying risks for AD/ADRD and mild cognitive impairment (MCI), by analyzing the past sequential visit records. Amongst individuals 65 and older, our model was able to generate risk predictions for various future timeframes. On the held-out validation set, our model achieved an area under the receiver operating characteristic (AUROC) of 0.772 (95% CI: 0.770, 0.773) for identifying the AD/ADRD/MCI risks in 1 year, and AUROC of 0.735 (95% CI: 0.734, 0.736) in 5 years. The positive predictive values (PPV) in 5 years among individuals with top 1% and 5% highest estimated risks were 39.2% and 27.8%, respectively. These results demonstrate significant improvements upon the current EHR-based AD/ADRD/MCI risk assessment models, paving the way for better prognosis and management of AD/ADRD/MCI at scale.",
    "full_text": "Predicting Risk of Alzheimer’s Diseases and Related\nDementias with AI Foundation Model on Electronic\nHealth Records\nWeicheng Zhu1, Huanze Tang1, Hao Zhang2, Haresh Rengaraj Rajamohan1, Shih-Lun\nHuang1, Xinyue Ma1, Ankush Chaudhari1, Divyam Madaan3, Elaf Almahmoud3, Sumit\nChopra3,4, John A. Dodson2,5, Abraham A. Brody5,6, Arjun V. Masurkar7,8,9, and Narges\nRazavian2,4,*\n1NYU, Center for Data Science, New Y ork, NY , 10001, USA\n2NYU Grossman School of Medicine, Department of Population Health, New Y ork, NY , 10016, USA\n3NYU, Courant Institute of Mathematical Sciences, New Y ork, NY , 10001, USA\n4NYU Grossman School of Medicine, Department of Radiology, New Y ork, NY , 10016, USA\n5NYU Grossman School of Medicine, Department of Medicine, New Y ork, NY , 10016, USA\n6NYU Grossman School of Medicine, Rory Meyers College of Nursing, Hartford Institute for Geriatric Nursing, New\nY ork, NY , 10016, USA\n7NYU Grossman School of Medicine, Department of Neurology, New Y ork, NY , 10016, USA\n8NYU Grossman School of Medicine, Department of Neuroscience and Physiology, New Y ork, NY , 10016, USA\n9NYU Grossman School of Medicine, Neuroscience Institute, New Y ork, NY , 10016, USA\n*Corresponding author:Narges.Razavian@nyulangone.org\nABSTRACT\nEarly identification of Alzheimer’s disease (AD) and AD-related dementias (ADRD) has high clinical significance, both because\nof the potential to slow decline through initiating FDA-approved therapies and managing modifiable risk factors, and to help\npersons living with dementia and their families to plan before cognitive loss makes doing so challenging. However, substantial\nracial and ethnic disparities in early diagnosis currently lead to additional inequities in care, urging accurate and inclusive risk\nassessment programs. In this study, we trained an artificial intelligence foundation model to represent the electronic health\nrecords (EHR) data with a vast cohort of 1.2 million patients within a large health system. Building upon this foundation EHR\nmodel, we developed a predictive Transformer model, named TRADE, capable of identifying risks for AD/ADRD and mild\ncognitive impairment (MCI), by analyzing the past sequential visit records. Amongst individuals 65 and older, our model was\nable to generate risk predictions for various future timeframes. On the held-out validation set, our model achieved an area\nunder the receiver operating characteristic (AUROC) of 0.772 (95% CI: 0.770, 0.773) for identifying the AD/ADRD/MCI risks\nin 1 year, and AUROC of 0.735 (95% CI: 0.734, 0.736) in 5 years. The positive predictive values (PPV) in 5 years among\nindividuals with top 1% and 5% highest estimated risks were 39.2% and 27.8%, respectively. These results demonstrate\nsignificant improvements upon the current EHR-based AD/ADRD/MCI risk assessment models, paving the way for better\nprognosis and management of AD/ADRD/MCI at scale.\nIntroduction\nAlzheimer’s disease (AD) and AD-related dementias (ADRD) are irreversible conditions affecting over 6 million people in\nthe United States1, 2. While the pathogenesis of AD/ADRD is complex, several modifiable cardiovascular risk factors, such\nas hypertension, smoking, obesity, and diabetes, are recognized to contribute to its pathogenesis and progression 3–6. Early\ndiagnosis of AD/ADRD or mild cognitive impairment (MCI) are important for a number of reasons. First, the diagnosis may\nserve as a motivating factor for addressing modifiable risk factors amongst both clinicians and persons living with dementia\n(PLWD) or mild cognitive impairment (MCI) as it is one of the only currently known ways to slow cognitive decline. Second,\nwhen diagnosed earlier, it is easier for advance care planning to occur with input from the PLWD or MCI, and allows for greater\nplanning for the eventual decline, including caregiving situation, housing or moving closer to family, financial planning. While\ncontroversial in nature, early diagnosis is also important as the sole disease-modifying FDA-approved therapy currently on the\nmarket for AD/ADRD/MCI is only available and shown some efficacy in PLWD or MCI at the early stage of impairment7.\nAccordingly, early identification of AD/ADRD at the prodromal stage is a critical component in optimal care delivery. However,\nat the same time, there are significant inequities in care, including lower rates of early diagnosis in racial and ethnic minoritized\n . CC-BY-NC-ND 4.0 International licenseIt is made available under a \n is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity. (which was not certified by peer review)\nThe copyright holder for this preprint this version posted April 27, 2024. ; https://doi.org/10.1101/2024.04.26.24306180doi: medRxiv preprint \nNOTE: This preprint reports new research that has not been certified by peer review and should not be used to guide clinical practice.\ngroups and worse management of modifiable cardiovascular disease factors. These inequities are multifactorial, and new\nmethods are needed for systematically improving the healthcare system.\nAlgorithms and risk models for detecting probable undiagnosed MCI or AD/ADRD are one way to facilitate such early\ndiagnosis and intervention. Approaches with wearable signals 8, neuroimaging9 and blood biomarkers10 are promising but\ncannot be readily applied to the general population due to the cost and effort, and limited use, especially in underserved and\nhistorically marginalized communities. Assessing risks with Electronic Health Records (EHR)-based models has the potential\nfor direct integration into EHR systems and clinical workflow at the point of care for every patient. A few retrospectively\nvalidated EHR-based models exist to date. eRADAR, a statistical model11, which was developed and validated using participants\nof Adult Changes in Thought study, is the most robust model tested to date in scientific studies, and is undergoing prospective\nvalidation and randomized trials12, 13. One limitation of the eRADAR model however is its focus on using known risk factors\nincluding aging, vascular diseases and diabetes, while other potential factors that can improve precision, such as specific\nmedications, lab values, and additional diagnoses are not included. This is particularly important as many of the eRADAR risk\nfactors have correlations with socioeconomic status and racial and ethnic minoritized groups which can reduce sensitivity in\nthese populations. To address these concerns, we developed and validated an EHR-based risk assessment model utilizing the\nadditional information available in the EHR, exhibiting improved performances on both overall population and subgroups with\ndifferent characteristics.\nRecent advancements in deep learning offered neural networks with a stronger capacity to understand the EHR 14–17. A\ngraph neural network, taking the connections among various EHR features into account, outperformed traditional statistical\nmodels and multiple layer perceptron networks in predicting potential AD18. However, this study only used cross-sectional\nEHR without temporal information. Transformer19, a powerful network architecture used to represent high-dimensional data\nlike images and languages, is now widely used as the state-of-the-art method to represent sequential relationship across visits\nand interconnection of information within a single visit 20–22. The increment in the scale of the Transformer model usually\nleads to better performance, while it also requires larger training data to achieve generalizable performance23. To address the\ninsufficiency of labeled data, a self-supervised learning approach, masked token modeling, can be used to pretrain these large\nmodels on a broader domain with unlabeled data 24, 25. Then the large pretrained model, termed Foundation Modelcan be\npartially or fully finetuned for some downstream prediction tasks with smaller labeled datasets26, 27. In this study, we employed\nthis framework to develop a Tranformer model for predicting Risks of AD/ADRD/MCI based on EHR (TRADE), where\nwe pretrained a foundation model with a large-scale inclusive EHR dataset, and finetuned the model with a selective cohort\nfor predicting AD/ADRD/MCI. TRADE outperformed the vanilla Transformer model trained from scratch. Compared to\nTransformers for EHR in previous literature (e.g. BEHRT20 and MED-BERT21), TRADE and its base foundation model further\nincorporated the medications and discretized lab values, in addition to diagnosis codes, to enrich the EHR representation. Also,\nit was trained with a curated cohort with more medical concepts, visits and longer span of presence in the healthcare system.\nOur approach achieved an area under the receiver operating characteristic (AUROC) at 0.772 (95% CI: 0.770, 0.773) in\nidentifying AD/ADRD/MCI patients in 1 year, and 0.735 (95% CI: 0.734, 0.736) in 5 years, specifically among patients aged\n65 and above. The positive predictive values (PPV) in 5 years among patients with the top 1% and 5% highest estimated risks\nwere 39.2% and 27.8%. We built a comparison model on the same cohort with eRADAR that has been deployed in clinical\npractices11. We demonstrated that our proposed deep-learning model was more accurate on the overall heldout validation set\nand subcohorts separated by different characteristics. These results suggest that incorporating our AI foundation model in the\nEHR system is promising to advance the current identification and screening of patients at high risk for AD/ADRD/MCI.\nResults\nStudy participants\nWe used Electronic Health Record (EHR) data from a large health system, covering 1,288,333 patients with 587 million medical\nconcept tokens from Jan 2013 to Jan 2023 with at least 5 visits. The EHR of each patient includes a sequence of encounters\nconsisting of International Classification of Diseases (ICD-10) diagnostic codes (all diagnoses types, including encounter,\nproblem list, billing and medical history), lab values coded under Logical Observation Identifiers Names and Codes (LOINC)\nand medications at the therapeutic level (Figure 1a). The onset of AD/ADRD and MCI was defined as the visit with the first\noccurrences of AD/ADRD/MCI-related diagnosis codes or medication (Table S1).\nAs shown in Figure 1a, the patients in the study were randomly partitioned into the training, validation, and a held-out\nvalidation set, with a ratio of 80% (n=1,030,438), 10% (n=129,127), and 10% (n=128,768). We constructed two cohorts to train\nthe model: (1) a pretraining cohort for self-supervised learning for our foundation Transformer model; (2) an AD/ADRD/MCI\nfinetuning cohort for training and evaluating the predictive model for AD/ADRD/MCI. The pretraining cohort includes all the\npatients in the training set (n=1,030,340). The AD/ADRD/MCI finetuning cohort only contains patients over the age 65 (by\nthe end of records)(n=142,702). To simulate the predictive performance of the screening model in a retrospective manner, we\nused a sliding window for each patient to generate pairs of features and labels (see Figure 1e), where, given an index visit, the\n2/19\n . CC-BY-NC-ND 4.0 International licenseIt is made available under a \n is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity. (which was not certified by peer review)\nThe copyright holder for this preprint this version posted April 27, 2024. ; https://doi.org/10.1101/2024.04.26.24306180doi: medRxiv preprint \nAD/ADRD\n/MCI\nFinetuning\ncohort\nPatient\nDates 2020/01/20 2020/05/10 2021/02/28 2022/10/02\nAge: 66\nI10, Z96.641\nIbandronate\nAge: 66\nN28.1\nIopamidol\nCreatinine\nAge: 67\nM25.512, \nM79.89, \nM85.612\nAge: 68\nK21.9, G30.9\nCholesterol,\nAlbumin\nDemographic Diagnosis Medication Lab valuesVisit\nTraining set\nValidation set\nHeld-out\nValidation set\nPretraining\ncohort\nFoundation\nTransformer ModelElectronic Health Records\na. b.\nFiltering\nPretrain\nFinetune\nEvaluate\nPosNeg\nPredictive model\nAll patients\nCLS I10 MASK Iband. SEP N28.1 Iopam.MASK SEP ...\nCLS I10 Z96.641Iband. SEP N28.1 Iopam.CreatineSEP ...\nTransformer Encoder\nVisit 1 + Day 1 + Age 66 Visit 2 + Day 52 + Age 66+\nPretrain the Foundation EHR Model\nCLS I10 Z96.641Iband. SEP N28.1 Iopam.CreatineSEP ...\n1 Year\nTransformer Encoder\nVisit 1 + Day 1 + Age 66 Visit 2 + Day 52 + Age 66 +\nTrain Predictive Model on AD/ADRD/MCI\n2 Year ... 5 YearRisk in\nc. d.\ne.\nTT-1\nG30.9\nT+G\nFeature window Gap window Outcome windows\nT+1 Year\nT+5 Year\nT+2 Year\nNeg Pos PosIndex visit\nPatient sample timelines Generated samples\nPast EHR Outcomes\n...\n...\nP1\nP2\nP3\nP4\n0 0 1\n0 1 1\n0 0 0\n0 0 0\n1 1 1\nFigure 1.The design of ML architecture of our study. (a) The patient’s EHR data of multiple visits, including demographics,\ndiagnoses, lab values, and medication. (b) The patients in the study were partitioned into a training, validation, and held-out\nvalidation set. The pretraining cohort, formed by patients in the training set, was used to pretrain the foundation Transformer\nmodel; the AD/ADRD/MCI finetuning cohort, filtered by age, was used to train and validate the AD/ADRD/MCI predictive\nmodel. (c) The Transformer model processes variables in EHR as tokens, and encodes indices of visits, days, and ages for 3\ndistinct positional encodings, which are added to the token embeddings. The foundation model was pretrained by masked token\nmodeling, which taught the model to reconstruct the randomly masked information in the input EHR sequence. (d) The\nAD/ADRD/MCI predictive model was constructed by stacking a linear network upon the output representation of<CLS> token,\nestimating the risks based on previous EHR. (e) The samples for the AD/ADRD/MCI predictive model were generated by\nsliding windows on various index visits over patient’s longitudinal EHR. We used records in the 1-year feature window prior to\nthe index visit as inputs and the dementia status in various outcome windows following the index visit as labels. Samples with\nno follow-ups by the end of the outcome window were considered censored and excluded. In some experiments, we specified a\nminimum gap period between the end of the feature window, and the beginning of the outcome window, and excluded samples\nwith AD/ADRD/MCI onset in the gap window to avoid data leakage due to lengthy AD/ADRD/MCI diagnosis processes.\n3/19\n . CC-BY-NC-ND 4.0 International licenseIt is made available under a \n is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity. (which was not certified by peer review)\nThe copyright holder for this preprint this version posted April 27, 2024. ; https://doi.org/10.1101/2024.04.26.24306180doi: medRxiv preprint \nTable 1.Characteristics of the large-scale pretraining cohort and AD/ADRD/MCI finetuning cohort. The proportion or\nstandard deviation is marked in parentheses.\nCharacteristics Pretraining Cohort AD/ADRD/MCI\nFinetuning Cohort\nCounts 1,030,438 unique patients 445,142 samples from\n142,702 unique patients\nAge (± SD) 49.36 (± 24.48) 73.44 (± 7.67)\nFemale 607,513 (58.96) 261,427 (58.72)\nWhite 568,954 (55.21) 338,502 (76.04)\nBlack 97,714 (9.48) 32,371 (7.27)\nAsian 50,858 (4.94) 15,103 (3.39)\nOther Race 106,029 (10.29) 33,627 (7.55)\nUnknown 206,883 (20.07) 25,539 (5.73)\nHypertension 312,018 (30.28) 232,519 (52.23)\nDiabetes 151,695 (14.72) 93,649 (21.03)\nDiabetes, complex 12,482 (1.21) 4,782 (1.07)\nHyperlipidemia 335,805 (32.58) 221,065 (49.66)\nAny Vascular Risk 490,224 (47.57) 313,251 (70.37)\nStatins 241,655 (23.45) 144,193 (32.39)\nAspirin 184,348 (17.89) 72,567 (16.30)\nBP Meds 299,616 (29.08) 188,486 (42.34)\nAny Vascular Meds 408,258 (39.62) 250,108 (56.18)\nfeatures were extracted from the EHR data prior to that index visit (feature window), and the labels were based on the EHR\ndata following the index window (outcome window). Samples with no follow-ups by the end of the outcome window were\nconsidered censored and excluded. Patients who already had AD/ADRD/MCI by the end of the feature window were also\nexcluded. In the analysis of AD/ADRD/MCI risk predictions in 5 years, we used a 1-year feature window and 5-year outcome\nwindow, which resulted in 445,142 records among 142,702 unique patients with 7.20% of those developing AD/ADRD/MCI\nin 5 years. These samples belonging to the training, validation, and held-out validation set of the full dataset formed the\ncorresponding sets of AD/ADRD/MCI finetuning sets. Table 1 reports the demographic characteristics of both patient cohorts.\nThe distributions of each patient’s length of presence, number of encounters, and medical codes are illustrated in Figure S1.\nIdentifying risk of AD/ADRD/MCI with EHR\nWe built a classification model on top of a Transformer network19, namely TRADE, to identify the risk of AD/ADRD/MCI\nbased on the previous EHR (Figure 1d, see the Method section for more details). We assessed the predictive performance of\nour predictive models using two key metrics: the area under the receiver operating characteristic curve (AUC) and positive\npredictive values (PPV) at varying sensitivities (see Figure2,4). For predicting the onset of AD/ADRD/MCI within 5 years\nfrom the reference index visit, the fine-tuned transformer achieved an AUROC of 0.735 (95% CI: 0.734-0.736) and average PPV\n(AP) of 0.199 (95% CI: 0.198-0.200). Since this predictive model aims to suggest cognitive screening for high-risk patients to\nproviders, we also present PPVs of the high-risk patient groups predicted by the model (Figure 2). These high-risk groups\nare delineated by thresholds of the predicted risks from the top k% of patients with the highest predicted risks. For the 5-year\nprediction horizon, the PPVs are 39.2% and 27.8% and 22.4% for thresholds corresponding to the top 1, 5, and 10 percentiles,\nrespectively. These values demonstrate the precision of the model at different screening operation points.\nPrior studies have also developed and validated EHR-based methods for early ADRD detection and prediction, yielding\npromising results. eRADAR11 is a statistical model estimating ADRD risks based on EHR variables, widely employed and\nvalidated in practice13. Comparing TRADE with eRADAR for predicting AD/ADRD/MCI over five years (see Figure 2), we\nobserve that our foundation model significantly outperformed the statistical model which achieved AUROC of 0.688 (95% CI:\n0.687-0.689) and AP of 0.143 (95% CI: 0.142, 0.143). Even without pre-training, our model achieves better performance, and\nlinear probing (i.e only fine-tuning a linear classifier over the foundation model’s pre-learned features) bypasses the performance\nof the eRADAR model.\nSubcohort analysis\nWe compared the model performance of TRADE and eRADAR across various sub-cohorts according to gender, age, race, and\nother health conditions, like vascular risk (see Figure3). Age and vascular risks are two major dementia risk factors significantly\n4/19\n . CC-BY-NC-ND 4.0 International licenseIt is made available under a \n is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity. (which was not certified by peer review)\nThe copyright holder for this preprint this version posted April 27, 2024. ; https://doi.org/10.1101/2024.04.26.24306180doi: medRxiv preprint \n0.0 0.2 0.4 0.6 0.8 1.0\nFalse Positive Rate\n0.0\n0.2\n0.4\n0.6\n0.8\n1.0True Positive Rate\nROC Curves\neRADAR \n AUC: 0.688 (0.687 0.689)\nLinear \n AUC: 0.702 (0.702 0.703)\nScratch \n AUC: 0.718 (0.717 0.719)\nFinetuning \n AUC: 0.735 (0.734 0.736)\n0.0 0.2 0.4 0.6 0.8 1.0\nRecall (Sensitivity)\n0.0\n0.1\n0.2\n0.3\n0.4\n0.5\n0.6Precision (PPV)\nPrecision Recall Curves\neRADAR \n AP: 0.143 (0.142 0.143)\nLinear \n AP: 0.157 (0.156 0.158)\nScratch \n AP: 0.179 (0.178 0.181)\nFinetuning \n AP: 0.199 (0.198 0.200)\n1% 5% 10%\nFigure 2.Performance on predicting AD/ADRD/MCI in 5 years with different methods: “Scratch” is training the Transformer\nfrom random initial weights; “Linear” is training a linear classifier on top of the foundation model representations; “Finetuning”\nis training the classifier layer together with the foundation model layers (see the Predictive modeling section for more detail).\nThe performance is evaluated with ROC curves (left) and precision-recall curves (right). The PPVs and sensitivities of the\npatients with top 1, 5 and 10% risks are highlighted by ⋆, ▲ and ■, respectively.\nimpacting prediction performance. Both models obtained higher PPVs among older patients and patients with vascular risks\nsince AD/ADRD/MCIs were more prevalent among these subcohorts. However, the AUROCs were lower in the higher-risk\nsubcohorts since it was harder to identify the negative patients among them. Notably, the AUROCs of eRADAR in age and\nvascular risk subgroups dropped more than those of TRADE. This phenomenon indicates that the predictions of eRADAR were\nmostly attributed to age and vascular diseases, while the Transformer model leveraged diverse medical information to further\ndistinguish risks of patients of similar ages or health conditions.\nAmong subcohorts separated by demographic characteristics, TRADE exhibited superior performance among females\ncompared to males. Regarding the different races, while TRADE demonstrated lower performance among the underrepresented\nBlack population when compared to the White population, it still consistently enhanced performance across all racial groups\ncompared to eRADAR, with the most notable improvement observed among the Asian population. This finding suggests that\nTRADE has the potential to benefit all gender and race groups with a more accurate assessment of AD/ADRD/MCI risks.\nImproving performance with a pretrained foundation EHR model\nA large-scale EHR dataset contains rich information on patients. To enable the model to understand EHR best, we designed\na prediction framework with two stages (Figure 1a): (1) pretraining, where we pretrained a foundation model for EHR with\nTransformer architecture with the pretraining cohort. The model was trained without labels and merely by reconstructing\nrandomly masked information from the EHR; (2) fine-tuning, where we fine-tuned the model with the medical history and\nAD/ADRD/MCI outcomes in the fine-tuning cohort to identify the high-risk patients (see the Method section for more details).\nWe conducted pretraining only on the pretraining cohort. We fine-tuned the model with the training set in the AD/ADRD/MCI\nfinetuning cohort and used the validation set to examine the performance for different hyperparameter settings, which guided\nmodel selection. The performance of the selected models was evaluated on the fully held-out validation set of patients and\nreported as an estimate of performance in new patient cohorts.\nWe compare the performance of the fine-tuned AD/ADRD/MCI predictive model with and without self-supervised pre-\ntraining. Figure 2 shows that under the same Transformer architecture, finetuning from pretrained foundation model obtained\nboth higher AUROC and PPVs compared to training from scratch. In addition, a simplified linear classifier, trained over the\nrepresentations extracted from the pre-trained foundation model, and comparable in complexity to eRADAR, still achieved\nsuperior performance to eRADAR. This demonstrates the value of a self-supervised pre-trained foundation AI model in building\nEHR-based predictive models.\nPrediction for different time intervals\nThe purpose of identifying patients at risk of dementia at different timelines varies. By predicting dementia across different\ntime intervals, healthcare providers can intervene effectively at each stage. In this study, we developed models for predicting\nAD/ADRD/MCI onset within 1, 2, and 5 years from the visit being assessed. We constructed the samples of feature and label\n5/19\n . CC-BY-NC-ND 4.0 International licenseIt is made available under a \n is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity. (which was not certified by peer review)\nThe copyright holder for this preprint this version posted April 27, 2024. ; https://doi.org/10.1101/2024.04.26.24306180doi: medRxiv preprint \nMale Female0.0\n0.1\n0.2\n0.3Average Precision\nGender\n65-70 70-80 80-90 > 900.0\n0.1\n0.2\n0.3\nAge\nWhite Black Asian Others0.0\n0.1\n0.2\n0.3\nRaces\nNeg Pos0.0\n0.1\n0.2\n0.3\nVascular\neRADRA\nTRADE\nMale Female\n0.5\n0.6\n0.7\n0.8AUROC\n65-70 70-80 80-90 > 90\n0.5\n0.6\n0.7\n0.8\nWhite Black Asian Others\n0.5\n0.6\n0.7\n0.8\nNeg Pos\n0.5\n0.6\n0.7\n0.8\nFigure 3.Performance across different subcohorts. Performance of the eRADAR (in orange) and of TRADE (in purple) for\ndifferent subcohorts, partitioned by gender, age, race and vascular risk status. TRADE consistently outperformed eRADAR in\nevery subcohort.\npair with different lengths of intervals for the outcome window (see Figure 1c). The corresponding characteristics of samples\nfor various timelines are reported in Table S2. Figure 2 reports the prediction performance of the fine-tuned Transformer for\ndifferent time intervals. Comparing the AUCs among them, prediction for the outcome window with 1 year tops with AUC at\n0.772 (95% CI: 0.770, 0.773). This suggests the predictive model was more discriminative on the outcomes in the near future,\nwhile longer time intervals introduced more inherent uncertainty of the potential outcomes.\nThe precision-recall curves provide additional insights into the differences among outcome windows. Figure2 demonstrates\nthat the prediction on the longer outcome window had a high PPV compared to shorter ones at the same operation points. For\npatients at the top 1% risk level, the PPV of AD/ADRD/MCI onset in 5 years reached 39.2%, and decreased to 20.7% in the\n1-year window. The false positive patients from the prediction in 1 year might develop dementia in the future and thus became\nthe true positive in the 5-year window. On the other hand, the longer outcome window led to lower sensitivity as the early-stage\nAD/ADRD/MCI patients might not exhibit any risk factors at the current or past visits.\nPrediction with gap windows\nSince the development and diagnosis of AD/ADRD/MCI is a prolonged process that can take several months, the recorded\ndiagnosis on the EHR might be delayed. Considering the situation where the patient had onset of AD/ADRD/MCI, but has\nnot yet been diagnosed, we conducted another analysis by excluding recently diagnosed patients within a gap window of 1\nyear after the end of the feature window, as shown in Figure1e. Figure 5 shows the performance after the exclusion of these\npatients. As expected, the AUROC within 2 years dropped from 0.760 (95% CI: 0.760, 0.761) to 0.731 (95% CI: 0.730, 0.733),\nand the AUROC within 5 years dropped from 0.735 (95% CI: 0.734, 0.736) to 0.721 (95% CI: 0.720, 0.722). Less impact on\nthe prediction in the 5-year time frame shows the ability of our model to identify the long-term AD/ADRD/MCI risks after\neliminating the potential leakage due to the prolonged diagnosis process.\nModel predictions correlate with cognitive impairment levels\nWe hypothesized that patients with higher predicted risk according to the model, if undergone cognitive screening, would also\nshow a higher degree of impairment. From the technical standpoint, the correlation between the model score and cognitive test\nindicates the calibration of the model predictions and is a desired model behavior28. Figure 6 demonstrates the relationship\n6/19\n . CC-BY-NC-ND 4.0 International licenseIt is made available under a \n is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity. (which was not certified by peer review)\nThe copyright holder for this preprint this version posted April 27, 2024. ; https://doi.org/10.1101/2024.04.26.24306180doi: medRxiv preprint \n0.0 0.2 0.4 0.6 0.8 1.0\nFalse Positive Rate\n0.0\n0.2\n0.4\n0.6\n0.8\n1.0True Positive Rate\nROC Curves\n1 year \n AUC: 0.772 (0.770 0.773)\n2 year \n AUC: 0.760 (0.760 0.761)\n5 year \n AUC: 0.735 (0.734 0.736)\n0.0 0.2 0.4 0.6 0.8 1.0\nRecall (Sensitivity)\n0.0\n0.1\n0.2\n0.3\n0.4\n0.5\n0.6Precision (PPV)\nPrecision Recall Curves\n1 year \n AP: 0.087 (0.086 0.088)\n2 year \n AP: 0.139 (0.138 0.140)\n5 year \n AP: 0.199 (0.198 0.200)\n1% 5% 10%\nFigure 4.The comparison of TRADE performance on predicting AD/ADRD/MCI onset in different outcome windows.\nPrediction in the 1-year timeframe obtained the highest AUROC due to the least uncertainty. Prediction in the 5-year timeframe\ntopped the PPVs as the corresponding prevalence was the highest. See Figure S2 for the comparison with baseline methods.\n0.0 0.2 0.4 0.6 0.8 1.0\nFalse Positive Rate\n0.0\n0.2\n0.4\n0.6\n0.8\n1.0True Positive Rate\nROC Curves\n2 year, with no gap \n AUC: 0.760 (0.760 0.761)\n2 year, with a 1-year gap \n AUC: 0.731 (0.730 0.733)\n5 year, with no gap \n AUC: 0.735 (0.734 0.736)\n5 year, with a 1-year gap \n AUC: 0.721 (0.720 0.722)\n0.0 0.2 0.4 0.6 0.8 1.0\nRecall (Sensitivity)\n0.0\n0.1\n0.2\n0.3\n0.4\n0.5\n0.6Precision (PPV)\nPrecision Recall Curves\n2 year, with no gap \n AP: 0.139 (0.138 0.140)\n2 year, with a 1-year gap \n AP: 0.050 (0.050 0.051)\n5 year, with no gap \n AP: 0.199 (0.198 0.200)\n5 year, with a 1-year gap \n AP: 0.146 (0.145 0.147)\n1% 5% 10%\nFigure 5.AD/ADRD/MCI prediction performance of TRADE, with and without excluding new-onset patients diagnosed with\nAD/ADRD/MCI within 1 year of the end of feature window. “1-year gap” indicates these samples were excluded, while “no\ngap” indicates no exclusion. The performance of the 5-year model dropped less than that of the 2-year model after the\nexclusion of onsets in the gap window.\nbetween the risk estimated by the model and the Mini-Mental Status Exam (MMSE) cognitive scores29. For patients in the\nheld-out validation set who had undergone MMSE examination in the 1-year time interval after the feature window, we extracted\nthe MMSE scores mentioned in their clinical notes via ChatGPT with high accuracy\n30. We then compared these scores with the\npredicted risk from the 1-year AD/ADRD/MCI prediction Transformer model. As seen in Figure 6, the higher the risk model\nestimates, the more likely the patient would have severe cognitive impairment (i.e. MMSE < 20).\nModel Interpretation\nTo understand the relationship between the model’s predictions and patients’ EHR tokens contributing to each predicted score,\nwe computed the Integrated Gradients31, 32 of the prediction, with respect to the embedding layers of the EHR tokens. This\nprovides a personalized explanation per patient. A higher magnitude of the integrated gradient for a variable indicates greater\ninfluence from that variable in the model output. These gradients for each patient can be aggregated to explain overall variables\nassociated with a higher AD/ADRD/MCI risk. We note that this explanation method does not draw direct causal relationships.\nTo aggregate the gradients, we use the mean of gradient norms across all positively labeled AD/ADRD/MCI patients in the\nheldout validation set as our metric. Tables 2 and S3 list the variables with the greatest magnitudes of gradients among the\npositively labeled AD/ADRD/MCI patients in the held-out validation set, unveiling the features most associated with high\n7/19\n . CC-BY-NC-ND 4.0 International licenseIt is made available under a \n is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity. (which was not certified by peer review)\nThe copyright holder for this preprint this version posted April 27, 2024. ; https://doi.org/10.1101/2024.04.26.24306180doi: medRxiv preprint \n<20 20-24 25-27\nMMSE scores\n0.0\n0.2\n0.4\n0.6Predicted risk\nFigure 6.The analysis of Mini Mental State Exam (MMSE) cognitive scores in the heldout validation set, for patients\nundergone screening within 1 year from the index date. The box plot of predicted risk, according to the 1-year AD/ADRD/MCI\nprediction model, verse MMSE score ranges on patients with AD/ADRD/MCI outcomes, elucidates an association between\nhigher predicted risks and lower MMSE scores.\nAD/ADRD/MCI risks. Only tokens with more than 10 occurrences were included to avoid outliers.\nSeveral established and previously postulated risk factors of AD/ADRD/MCI emerge from these explanations, including\nvascular risk factors (such as heart disease, vascular disease, type 2 diabetes, hyperlipidemia, overweight)33, weight loss34,\nchronic kidney disease35, gait abnormality36, cataracts37, sleep apnea38, convulsions/seizures39, and mood disorder (including\nanxiety and depression)40, 41. In addition to them, our model was able to recognize symptoms or diseases known to be precursors\nto AD/ADRD syndromes, including urinary incontinence, falls, and parkinsonism / Parkinson’s disease. Furthermore, certain\nmedications were also highlighted, which may represent diagnoses that are AD/ADRD/MCI risk factors in the absence of\nformal diagnosis codes (e.g. escitalopram oxalate for depression or anxiety, atorvastatin for hyperlipidemia, metoprolol for\nhypertension), or may be linked via alternative relationships. This underscores the importance of utilizing interconnections\namong all EHR data to reveal a holistic picture of an individual’s health status.\nDiscussion\nRecent studies have consistently highlighted the delayed diagnosis of AD/ADRD in primary care 42, often attributed to\ninadequate training and resource constraints. Notably, later diagnosis of AD/ADRD varies by socioeconomic, geolocation,\nracial and ethnic groups due to the disparities in access to timely diagnosis and specialists43–45. Previous research has revealed\nlower documentation rates of cognitive assessments 1-5 years prior to AD/ADRD diagnosis among Black/African American\npatients, older individuals, those with non-commercial health insurance, or residing in neighborhoods with lower mean income\nlevels46. In this context, our study showcases the potential of TRADE, an EHR-based predictive model, to address this care\ngap by serving as a valuable tool for identifying high-risk patients who may benefit from targeted screening. Notably, our\nmodel exhibits improved performance compared to the best currently available tools, particularly among minority and high-risk\ngroups, as illustrated in Figures 2 and 3.\nWhile improvements were consistently observed across various demographic groups, disparities in accuracy persisted\nnotably among racial subgroups, particularly between White and Black populations. While the difference in prevalence might\npartially explain the lower performance within the Black population, the higher precision among the less common Asian\ngroup contradicts such a hypothesis. This highlights the critical need not only for refining model development but also for\nrecognizing the influence of social determinants of health47, 48 in deploying these models effectively. Our analysis delved into\nsubcohort disparities in Mini-Mental Status Exam (MMSE) scores of patients who underwent screening and were diagnosed\nwith AD/ADRD/MCI within the first year following the index date. In Figure 6a, we compared MMSE score distributions\nbetween White and Black subgroups, revealing a higher density in the Black group within the 20-24 MMSE range. While\nMMSE scores can be influenced by factors such as education level and education quality49, this finding may also suggest that a\n8/19\n . CC-BY-NC-ND 4.0 International licenseIt is made available under a \n is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity. (which was not certified by peer review)\nThe copyright holder for this preprint this version posted April 27, 2024. ; https://doi.org/10.1101/2024.04.26.24306180doi: medRxiv preprint \nTable 2.The top 20 variables associated with future AD/ADRD/MCI diagnosis from 2- and 5-year models, with (gap=1), and\nwithout (gap=0) excluding patients whose AD/ADRD/MCI diagnosis occurred within 1 year of the end of the feature window.\nThese ranked variables were extracted based on the magnitude of their gradients, and indicate an association rather than\ncausation relationship between the variable and AD/ADRD/MCI risk. The ranking of variables is determined by the mean of\ngradient norms across all patients in the heldout validation set with a positive AD/ADRD/MCI label. The color of the cells\nindicates the category of variables based on either high-level ICD-10 categories or medication.\nAD/ADRD/MCI within 2 years AD/ADRD/MCI within 2 years,\nwith a 1-year gap AD/ADRD/MCI within 5 years AD/ADRD/MCI within 5 years,\nwith a 1-year gap\n1 Other symptoms and signs involv-\ning cognitive functions and aware-\nness R41.89\nMajor depressive disorder, single\nepisode, unspecified F32.9\nParkinson’s disease G20 Major depressive disorder, single\nepisode, unspecified F32.9\n2 Major depressive disorder, single\nepisode, unspecified F32.9\nPersonal history of malignant neo-\nplasm of breast Z85.3\nRepeated falls R29.6 Parkinson’s disease G20\n3 Parkinson’s disease G20 Parkinson’s disease G20 Major depressive disorder F32.9 Pure hypercholesterolemia E78.0\n4 Precordial pain R07.2 Thrombocytopenia, unspecified\nD69.6\nVascular parkinsonism G21.4 Headache R51\n5 SERTRALINE Pure hyperglyceridemia E78.1 Urinary incontinence R32 Vascular parkinsonism G21.4\n6 Abnormal weight loss R63.4 Pure hypercholesterolemia E78.0 ESCITALOPRAM OXALATE Generalized anxiety disorder F41.1\n7 Dizziness and giddiness R42 Estrogen receptor positive status\n[ER+] Z17.0\nLEVOTHYROXINE Dizziness and giddiness R42\n8 Sick sinus syndrome I49.5 Unspecified convulsions R56.9 ATORV ASTATIN LEVOTHYROXINE\n9 Unspecified urinary incontinence\nR32\nMETOPROLOL SUCCINATE LOSARTAN Impaired glucose tolerance (oral)\nR73.02\n10 Urge incontinence N39.41 Vascular parkinsonism G21.4 Malignant neoplasm of prostate C61 Mixed hyperlipidemia E78.2\n11 Syncope and collapse R55 Overweight E66.3 Personal history of malignant neo-\nplasm of breast Z85.3\nType 2 diabetes mellitus with unspec-\nified complications E11.8\n12 Malignant neoplasm of prostate C61 Dizziness and giddiness R42 Dizziness and giddiness R42 Precordial pain R07.2\n13 Peripheral vascular disease, unspeci-\nfied I73.9\nMixed hyperlipidemia E78.2 Presence of automatic (implantable)\ncardiac defibrillator Z95.810\nDepression, unspecified F32.A\n14 Mixed incontinence N39.46 Type 2 diabetes mellitus with unspec-\nified complications E11.8\nCataract H26.9 Acute posthemorrhagic anemia D62\n15 Transient cerebral ischemic attack,\nunspecified G45.9\nMELOXICAM Nocturia R35.1 Monoclonal gammopathy D47.2\n16 Hereditary and idiopathic neuropathy,\nunspecified G60.9\nOther general symptoms and signs\nR68.89\nImpaired glucose tolerance R73.02 Vascular headache, not elsewhere\nclassified G44.1\n17 Chronic kidney disease N18.4 ATORV ASTATIN Symptoms involving the muscu-\nloskeletal system R29.898\nAnxiety disorder, unspecified F41.9\n18 Difficulty in walking R26.2 Abnormal weight loss R63.4 Presence of other heart-valve replace-\nment Z95.4\nHypo-osmolality and hyponatremia\nE87.1\n19 Vascular parkinsonism G21.4 Impaired fasting glucose R73.01 Obstructive sleep apnea G47.33 Insomnia, unspecified G47.00\n20 Enlarged prostate with lower urinary\ntract symptoms N40.1\nGeneralized anxiety disorder F41.1 Type 2 diabetes mellitus with hyper-\nglycemia E11.65\nSyncope and collapse R55\nD: Diseases of the blood and blood-forming organs E: Endocrine, nutritional and metabolic diseases\nF: Mental, Behavioral and Neurodevelopmental disorders G: Diseases of the nervous system\nI: Diseases of the circulatory system N: Diseases of the genitourinary system\nR: Symptoms, signs and abnormal clinical and laboratory findings Medications\nsignificant portion of Black patients may receive diagnoses at later disease stages. Indeed, the lower Positive Predictive Value\n(PPV) in the Black population may stem from delayed or underdiagnosis, further emphasizing the value of deploying decision\nsupport tools such as TRADE in the EHR systems in achieving a more inclusive screening program for all demographics.\nIn addition to promising performance for identifying patients at risk for AD/ADRD/MCI, our study includes an interpretabil-\nity analysis, demonstrating that TRADE effectively extracts pertinent features from high-dimensional EHR data associated with\nan elevated AD/ADRD/MCI risk. The feature importance analysis underscores several established risk factors (e.g. vascular\nrisks), and precursors strongly associated with AD/ADRD/MCI (e.g. monoclonal gammopathy). It is crucial to approach these\nassociations with caution, recognizing them as correlations with potential AD/ADRD/MCI rather than direct causes. While\nfurther validation is needed to establish causality, these associations serve as valuable insights for driving future research into\nrisk factors.\nOur results demonstrate an improved performance of TRADE based on the self-supervised pre-trained foundation EHR\nmodel over the standard Transformer without pre-training. This suggests that our foundation EHR model has broader\napplicability in enhancing other EHR-based clinical tasks through fine-tuning with diverse datasets. Furthermore, while current\nEHR data predominantly includes generic diagnoses, lab values, and medications, integration of additional patient data such as\n9/19\n . CC-BY-NC-ND 4.0 International licenseIt is made available under a \n is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity. (which was not certified by peer review)\nThe copyright holder for this preprint this version posted April 27, 2024. ; https://doi.org/10.1101/2024.04.26.24306180doi: medRxiv preprint \nmedical images and clinical notes, if available, could offer richer contexts. The architecture of our foundation model allows\nseamless integration of multi-modal data. Building prediction frameworks capable of leveraging the extra information would be\nan important direction for future research.\nIn conclusion, we developed a risk assessment framework for AD/ADRD/MCI using structured EHR. Our findings\ndemonstrate the efficacy of this model on the vast EHR of a healthcare system and its ability to significantly enhance\nthe current clinical practices for the identification of AD/ADRD/MCI risks and screening programs. This improvement is\nparticularly impactful for underrepresented and high-risk populations, where our model consistently outperforms existing\nmethods. Meanwhile, we showed that the elevated predicted model scores are based on several recognizable risk factors or\nprecursors of AD/ADRD/MCI. Finally, despite never directly training our model against cognitive screening scores such as\nMMSE, our results revealed that the higher risks predicted by the model do correlate with the degree of impairment, adding\nvalidity to the role of such models in the identification of undiagnosed AD/ADRD/MCI and tackling late diagnosis. Our\napproach to building predictive models based on the pre-trained foundation model of the EHR can benefit other diseases and\nsimilar risk assessment tasks, particularly in scenarios involving small and imbalanced patient cohorts.\nMethods\nData\nWe used EHR data from NYU Langone Health including any visits (inpatient, outpatient and ED) between Jan 2013 and Jan\n2023. This study has been approved by NYU Langone Institutional Review Board (IRB), as protocol s20-01095 Understanding\nand predicting Alzheimer’s Disease. Data was acquired from NYU Langone DataCore in a de-identified manner. Only patients\nwith more than 5 visits were used in this study. This provided us the EHR of cohorts mentioned in the Study Participants\nsection.\nIn the records of each patient, each visit was represented as a combination of variables, which include, demographic\ninformation (age, gender, race, ethnicity, 30 variables), alongside observed lab results (represented as LOINC codes, 86,529\nvariables total), medication orders (represented at Pharmaceutical class, 162,761 variables total) and diagnosis codes (represented\nas ICD-10 codes and SNOMED, 196,983 variables total). To convert these variables into tokens for Transformer inputs. We\nbuilt the vocabulary list as follows: Each demographic category, diagnosis and medication code was treated as a unique token.\nThe continuous lab values were binned into ranges of -10, -3, -1, -0.5, 0.5, 1, 3, 10 standard deviations from the population\nmean and then tokenized. Among all the variables, we selected 57,735 variables (6,482 lab values, 42,815 ICD-10 diagnosis\ncodes, 8,387 medications, 50 demographics) with more than 100 occurrences. Any variables other than them were not included\nin the model. Moreover, we excluded ICD-10 codes related to amnesia, R41.1/2/3, to avoid potential leakage, which would not\nindicate AD/ADRD/MCI directly but could be used in preliminary diagnosis stages for these patients.\nModel development\nML architecture\nAs the state-of-the-art model for learning representations of the structured EHR data21, 22, we adopted a Transformer19 network\nto encode the EHR at the patient level. We organized the longitudinal EHR data for each patient sequentially based on visit dates,\nresulting in a token sequence structured as follows (as illustrated in Figure 1c): “<CLS>”, {variables in 1st visit}, “<SEP>”,\n{variables in 2nd visit} , ..., “<SEP>”. Here, “<CLS> and <SEP>” serve as the placeholder tokens representing the outputs\nused for classification and separating consecutive visits, respectively. Each medical observation within a visit was represented\nby a token, with each token encoded using a learnable embedding vector within the Transformer architecture. To capture\nthe sequential nature and continuous variables across visits effectively, we introduced three learnable positional embeddings\nfor each medical token, accounting for the patient’s age, the visit index, and the number of days since the beginning of the\npatient’s medical history. This refined approach offered a more nuanced representation of age and the temporal gap between\nencounters, compared to BERHT and Med-BERT 20, 21. Given that tokens within the same visit are permutation invariant,\nidentical positional embeddings were applied to all tokens within a given visit. Then these embeddings were encoded by a\nTransformer neural network with 12 self-attention layers with 12 heads, 3072 dimensions for the feed-forward layers, and 786\ndimensions for the encoder and pooling layers.\nModel pretraining\nAlthough the large-scale Transformer network has a strong capacity for encoding complicated high-dimensional data like EHR,\nit is also vulnerable to overfitting when trained on limited data for a single binary classification task, especially when the low\nprevalence in disease prediction tasks leads to limited positive samples22. To address this issue, we conducted self-supervised\nlearning to pretrain the model with a large amount of unlabeled data. We employed the masked token modeling as proposed\nin Bidirectional Encoder Representations from Transformers (BERT)24, 25 for pretraining (Figure 1c) where the network was\ntrained to predict randomly masked tokens (with a masking rate of 20%) from the model input. During pretraining, we used a\n10/19\n . CC-BY-NC-ND 4.0 International licenseIt is made available under a \n is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity. (which was not certified by peer review)\nThe copyright holder for this preprint this version posted April 27, 2024. ; https://doi.org/10.1101/2024.04.26.24306180doi: medRxiv preprint \nsliding window framework to process each patient’s data. The first visit of the sliding window was randomly sampled, and\nwe included the EHR data from that visit up to a future visit such that the number of tokens in the EHR segment would be\nfewer than 512. In each epoch, for each patient in the training set (n=1,030,438), one randomly sampled window was processed.\nThe foundation model pre-training converged in 500 epochs. We used AdamW optimizer at batch size 256 and a learning rate\n2 ×10−5 with a cosine learning rate decay. The computation was executed on 4 Nvidia A100 GPUs.\nPredictive modeling for AD/ADRD/MCI\nWe trained the AD/ADRD/MCI predictive model, TRADE, based on the pretrained foundation Transformer. To conduct\nthe retrospective analysis, we used a sliding window to create multiple samples from the medical trajectory of each patient\n(Figure 1e). We selected the index visits with at least 180 days stride and assumed them as the date for calculating the\nAD/ADRD/MCI prediction. The model took the EHR within 1 year before the index date as the model input. Multiple binary\nlabels were created based on whether the patient was diagnosed with AD/ADRD/MCI within 1, 2, and 5 years after the index\ndate. To avoid unrecorded diagnosis, we only kept samples that had follow-up encounters after the end of the outcome window.\nThe max length of the tokens was also limited to 512 latest tokens in the input. The Transformer model was trained with the\ncross-entropy loss between the label and output of a linear classification layer at the Transformer encoding of the “<CLS>”\ntoken (see Figure 1d).\nWe use multiple ways to train the Transformer: (1) scratch, trained the Transformer with randomly initialized weights;\n(2) linear probingonly updated the last linear layer of the Transformer while keeping the other layers frozen; (3) Finetuning\nused Low-Rank Adaptation (LoRA) method26 which injects and trains the rank decomposition matrices (with rank r = 128\nand scale α = 256) into each linear layer of the Transformer architecture while keeping the original pretrained weights frozen.\nLoRA prevented the immediate overfitting and outperformed the vanilla finetuning method that updated all the parameters. We\ntrain the model for the downstream task for 10 epochs with an AdamW optimizer at batch size 64 and a learning rate 10−5 with\na 10−6 weight decay. The computation was executed on 1 or 2 Nvidia V100 GPUs. These experiments were all early stopped\nby the optimal average PPVs on the validation set.\neRADAR baselines\nWe established the benchmark for eRADAR prediction by evaluating it in the heldout validation set within AD/ADRD/MCI\nfinetuning cohorts, using the same patients and index dates used for the Transformer model finetuning. We gathered the\nretrospective encounter data of variables used in the eRADAR model at the index dates for each individual, including age, sex,\ndiagnoses in the past 2 years (e.g. congestive heart failure, cerebrovascular disease, diabetes (complex or any), etc.) based on\nICD-10 codes, most recent vital signs for underweight (BMI <18.5), obese (BMI ≥30), high blood pressure (≥140 SBP or ≥90\nDBP), healthcare utilization in the past 2 years (e.g. ≥1 outpatient visit, ≥1 emergency department visit, ≥1 language and\nlearning visit, etc), and utilization of medications in the past 2 years for non-tricyclic antidepressant and sedative-hypnotic. The\neRADAR risks were computed with the scoring function and the published weights on each variable11.\nExtracting cognitive impairment level from clinical notes\nMini-Mental State Examination (MMSE)29 is an 11-question measure that tests the cognitive function of patients, where the\nscores range from 0-30 (28-30:Cognitively Normal, 25-27:MCI, 0-24:ADRD). We retrieved available MMSE scores of patients\nto study the association between estimated risks and cognitive impairment level. Among 44,222 samples from 14,131 patients\nidentified as having AD/ADRD/MCI in the held-out validation set, 873 patients underwent MMSE cognitive test and were\nrecorded by clinical notes at the institute of this study. From the clinical notes, we extracted the MMSE scores of the patients\nwith OpenAI GPT-450, 51. A HIPAA-compliant private instance of ChatGPT was utilized to ensure data privacy.\nPerformance metrics\nWe computed the area under the receiver operating characteristic (AUROC) and the positive predicted values (PPV) at different\nsensitivity levels, which are widely used for measuring the predictive accuracy of binary classification tasks. To report the\nstatistical significance of descriptive statistics we computed 95% confidence intervals, and the bootstrapping method with 100\nbootstrap iterations.\nData availability\nThe trained TRADE model, its base foundation model, and corresponding code, notebooks can be made available upon direct\nrequest to the corresponding author.\n11/19\n . CC-BY-NC-ND 4.0 International licenseIt is made available under a \n is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity. (which was not certified by peer review)\nThe copyright holder for this preprint this version posted April 27, 2024. ; https://doi.org/10.1101/2024.04.26.24306180doi: medRxiv preprint \nReferences\n1. 2023 alzheimer’s disease facts and figures. Alzheimers. Dement.19, 1598–1695 (2023).\n2. Livingston, G. et al. Dementia prevention, intervention, and care: 2020 report of the lancet commission. Lancet 396,\n413–446 (2020).\n3. McGrath, E. R. et al. Blood pressure from mid- to late life and risk of incident dementia. Neurology 89, 2447, DOI:\n10.1212/WNL.0000000000004741 (2017).\n4. The SPRINT MIND Investigators for the SPRINT Research Group. Effect of Intensive vs Standard Blood Pressure Control\non Probable Dementia: A Randomized Clinical Trial. JAMA 321, 553–561, DOI: 10.1001/jama.2018.21442 (2019).\n5. Jm, M., Bs, M., Db, H. & Aa, L. Impact of pharmacological treatment of diabetes mellitus on dementia risk: systematic\nreview and meta-analysis. BMJ open diabetes research & care6, DOI: 10.1136/bmjdrc-2018-000563 (2018).\n6. Sabia, S. et al. Association of ideal cardiovascular health at age 50 with incidence of dementia: 25 year follow-up of\nWhitehall II cohort study. BMJ 366, l4414, DOI: 10.1136/bmj.l4414 (2019).\n7. van Dyck, C. H. et al.Lecanemab in Early Alzheimer’s Disease. The New Engl. J. Medicine388, 9–21, DOI: 10.1056/\nNEJMoa2212948 (2023).\n8. Chen, R. et al. Developing Measures of Cognitive Impairment in the Real World from Consumer-Grade Multimodal\nSensor Streams. In Proceedings of the 25th ACM SIGKDD International Conference on Knowledge Discovery & Data\nMining, KDD ’19, 2145–2155, DOI: 10.1145/3292500.3330690 (Association for Computing Machinery, New York, NY ,\nUSA, 2019).\n9. Liu, S. et al.Generalizable deep learning model for early Alzheimer’s disease detection from structural MRIs. Sci. Reports\n12, 17106, DOI: 10.1038/s41598-022-20674-x (2022).\n10. Hansson, O., Blennow, K., Zetterberg, H. & Dage, J. Blood biomarkers for Alzheimer’s disease in clinical practice and\ntrials. Nat. Aging3, 506–519, DOI: 10.1038/s43587-023-00403-3 (2023).\n11. Barnes, D. E. et al.Development and validation of eradar: A tool using ehr data to detect unrecognized dementia. J. Am.\nGeriatr. Soc.68, 103–111, DOI: https://doi.org/10.1111/jgs.16182 (2020). https://agsjournals.onlinelibrary.wiley.com/doi/\npdf/10.1111/jgs.16182.\n12. Dublin, S. et al.The electronic health record risk of alzheimer’s and dementia assessment rule (eradar) brain health trial:\nProtocol for an embedded, pragmatic clinical trial of a low-cost dementia detection algorithm. Contemp. Clin. Trials135,\n107356 (2023).\n13. Coley, R. Y .et al.External Validation of the eRADAR Risk Score for Detecting Undiagnosed Dementia in Two Real-World\nHealthcare Systems. J. Gen. Intern. Medicine38, 351–360, DOI: 10.1007/s11606-022-07736-6 (2023).\n14. Che, Z., Purushotham, S., Cho, K., Sontag, D. A. & Liu, Y . Recurrent neural networks for multivariate time series with\nmissing values. CoRR abs/1606.01865 (2016). 1606.01865.\n15. Choi, Y ., Chiu, C. & Sontag, D. Learning low-dimensional representations of medical concepts. AMIA Jt. Summits on\nTransl. Sci. proceedings. AMIA Summit on Transl. Sci.2016, 41–50 (2016).\n16. Shickel, B., Tighe, P., Bihorac, A. & Rashidi, P. Deep EHR: A survey of recent advances on deep learning techniques for\nelectronic health record (EHR) analysis. CoRR abs/1706.03446 (2017). 1706.03446.\n17. Steinberg, E. et al.Language models are an effective representation learning technique for electronic health record data. J.\nBiomed. Informatics113, 103637, DOI: 10.1016/j.jbi.2020.103637 (2021).\n18. Zhu, W. & Razavian, N. Variationally regularized graph-based representation learning for electronic health records. In\nProceedings of the Conference on Health, Inference, and Learning, CHIL ’21, 1–13, DOI:10.1145/3450439.3451855\n(Association for Computing Machinery, New York, NY , USA, 2021).\n19. Vaswani, A. et al.Attention is all you need. Adv. Neural Inf. Process. Syst.30 (2017).\n20. Li, Y .et al.BEHRT: Transformer for Electronic Health Records.Sci. Reports10, 7155, DOI: 10.1038/s41598-020-62922-y\n(2020).\n21. Rasmy, L., Xiang, Y ., Xie, Z., Tao, C. & Zhi, D. Med-BERT: pretrained contextualized embeddings on large-scale\nstructured electronic health records for disease prediction. npj Digit. Medicine4, 1–13, DOI: 10.1038/s41746-021-00455-y\n(2021).\n22. Placido, D. et al.A deep learning algorithm to predict risk of pancreatic cancer from disease trajectories. Nat. Medicine29,\n1113–1122, DOI: 10.1038/s41591-023-02332-5 (2023).\n12/19\n . CC-BY-NC-ND 4.0 International licenseIt is made available under a \n is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity. (which was not certified by peer review)\nThe copyright holder for this preprint this version posted April 27, 2024. ; https://doi.org/10.1101/2024.04.26.24306180doi: medRxiv preprint \n23. Kaplan, J. et al.Scaling Laws for Neural Language Models, DOI: 10.48550/arXiv.2001.08361 (2020).\n24. Devlin, J., Chang, M.-W., Lee, K. & Toutanova, K. BERT: Pre-training of Deep Bidirectional Transformers for Language\nUnderstanding. In Burstein, J., Doran, C. & Solorio, T. (eds.) Proceedings of the 2019 Conference of the North American\nChapter of the Association for Computational Linguistics: Human Language Technologies, Volume 1 (Long and Short\nPapers), 4171–4186, DOI: 10.18653/v1/N19-1423 (Association for Computational Linguistics, Minneapolis, Minnesota,\n2019).\n25. Liu, Y .et al.RoBERTa: A Robustly Optimized BERT Pretraining Approach, DOI:10.48550/arXiv.1907.11692 (2019).\nArXiv:1907.11692 [cs].\n26. Hu, E. J. et al. LoRA: Low-rank adaptation of large language models. In International Conference on Learning\nRepresentations (2022).\n27. Wornow, M., Thapa, R., Steinberg, E., Fries, J. & Shah, N. EHRSHOT: An EHR Benchmark for Few-Shot Evaluation of\nFoundation Models. In Oh, A. et al.(eds.) Advances in Neural Information Processing Systems, vol. 36, 67125–67137\n(Curran Associates, Inc., 2023).\n28. Liu, S. et al.Deep probability estimation. In Chaudhuri, K. et al.(eds.) Proceedings of the 39th International Conference\non Machine Learning, vol. 162 ofProceedings of Machine Learning Research, 13746–13781 (PMLR, 2022).\n29. Folstein, M., Folstein, S. & McHugh, P. Mini-mental state examination (mms, mmse)[database record]. PsycTESTS\nDataset. doi10 (1975).\n30. Zhang, H. et al.Evaluating large language models in extracting cognitive exam dates and scores. medRxiv 2023–07 (2023).\n31. Sundararajan, M., Taly, A. & Yan, Q. Axiomatic Attribution for Deep Networks. In Proceedings of the 34th International\nConference on Machine Learning, 3319–3328 (PMLR, 2017). ISSN: 2640-3498.\n32. Kokhlikyan, N. et al. Captum: A unified and generic model interpretability library for PyTorch, DOI: 10.48550/arXiv.\n2009.07896 (2020). ArXiv:2009.07896 [cs, stat].\n33. Viswanathan, A., Rocca, W. A. & Tzourio, C. Vascular risk factors and dementia: how to move forward? Neurology 72,\n368–374, DOI: 10.1212/01.wnl.0000341271.90478.8e (2009).\n34. Wang, C. et al. Weight Loss and the Risk of Dementia: A Meta-analysis of Cohort Studies. Curr. Alzheimer Res.18,\n125–135, DOI: 10.2174/1567205018666210414112723 (2021).\n35. Cheng, K.-C. et al.Patients with chronic kidney disease are at an elevated risk of dementia: a population-based cohort\nstudy in Taiwan. BMC nephrology13, 129, DOI: 10.1186/1471-2369-13-129 (2012).\n36. Wisniewski, T. & Masurkar, A. V . Gait dysfunction in Alzheimer disease. Handb. Clin. Neurol.196, 267–274, DOI:\n10.1016/B978-0-323-98817-9.00013-2 (2023).\n37. Wang, L., Sang, B. & Zheng, Z. The risk of dementia or cognitive impairment in patients with cataracts: a systematic\nreview and meta-analysis. Aging & Mental Heal.28, 11–22, DOI: 10.1080/13607863.2023.2226616 (2024).\n38. Bubu, O. M. et al. Obstructive sleep apnea, cognition and Alzheimer’s disease: A systematic review integrating three\ndecades of multidisciplinary research. Sleep Medicine Rev.50, 101250, DOI: 10.1016/j.smrv.2019.101250 (2020).\n39. Stefanidou, M. et al.Bi-directional association between epilepsy and dementia: The Framingham Heart Study. Neurology\n95, e3241–e3247, DOI: 10.1212/WNL.0000000000011077 (2020).\n40. Fernández Fernández, R., Martín, J. I. & Antón, M. A. M. Depression as a Risk Factor for Dementia: A Meta-Analysis.\nThe J. Neuropsychiatry Clin. Neurosci.36, 101–109, DOI: 10.1176/appi.neuropsych.20230043 (2024).\n41. Patel, P. & Masurkar, A. V . The Relationship of Anxiety with Alzheimer’s Disease: A Narrative Review.Curr. Alzheimer\nRes. 18, 359–371, DOI: 10.2174/1567205018666210823095603 (2021).\n42. 2021 alzheimer’s disease facts and figures. Alzheimer’s & Dementia17, 327–406, DOI: https://doi.org/10.1002/alz.12328\n(2021). https://alz-journals.onlinelibrary.wiley.com/doi/pdf/10.1002/alz.12328.\n43. Lin, P.-J. et al. Dementia diagnosis disparities by race and ethnicity. Alzheimer’s & Dementia16, e043183, DOI:\n10.1002/alz.043183 (2020).\n44. Kim, N. Racial disparities in neurological care in the united states: An internal mechanism. HPHR 32, DOI: 10.54111/\n0001/FF11 (2021).\n45. Tsoy, E. et al.Assessment of Racial/Ethnic Disparities in Timeliness and Comprehensiveness of Dementia Diagnosis in\nCalifornia. JAMA Neurol.78, 657–665, DOI: 10.1001/jamaneurol.2021.0399 (2021).\n13/19\n . CC-BY-NC-ND 4.0 International licenseIt is made available under a \n is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity. (which was not certified by peer review)\nThe copyright holder for this preprint this version posted April 27, 2024. ; https://doi.org/10.1101/2024.04.26.24306180doi: medRxiv preprint \n46. Maserejian, N., Krzywy, H., Eaton, S. & Galvin, J. E. Cognitive measures lacking in EHR prior to dementia or Alzheimer’s\ndisease diagnosis. Alzheimer’s & Dementia17, 1231–1243, DOI: 10.1002/alz.12280 (2021).\n47. Majoka, M. A. & Schimming, C. Effect of Social Determinants of Health on Cognition and Risk of Alzheimer Disease and\nRelated Dementias. Clin. Ther.43, 922–929, DOI: 10.1016/j.clinthera.2021.05.005 (2021).\n48. Wu, W., Holkeboer, K. J., Kolawole, T. O., Carbone, L. & Mahmoudi, E. Natural language processing to identify social\ndeterminants of health in Alzheimer’s disease and related dementia from electronic health records. Heal. Serv. Res.58,\n1292–1302, DOI: 10.1111/1475-6773.14210 (2023).\n49. Sisco, S. et al.The role of early-life educational quality and literacy in explaining racial disparities in cognition in late life.\nThe Journals Gerontol. Ser. B, Psychol. Sci. Soc. Sci.70, 557–567, DOI: 10.1093/geronb/gbt133 (2015).\n50. OpenAI. GPT-4 (2023).\n51. Zhang, H. et al.Evaluating large language models in extracting cognitive exam dates and scores. medRxiv: preprint server\nfor health sciences2023–07 (2024).\nAcknowledgements\nW.Z., D.M., S.C., A.V .M. and N.R. were supported by the National Institute On Aging of the National Institutes of Health\nunder Award R01AG079175. W.Z. received partial support from NSF Award 1922658. N.R., J.A.D., A.A.B, H.Z, A.V .M.\nwas partially supported by the National Institute On Aging of the National Institutes of Health under Award R01AG085617.\nN.R. and A.V .M are also supported by the National Institute On Aging of the National Institutes of Health under Award\nP30AG066512.\nAuthor contributions statement\nN.R. led and supervised this study over all steps from design, development, and analysis. W.Z. and H.T. performed model\ndevelopment, training, validation, and analysis. A.V .M., J.A.D and A.A.B. provided clinical supervision throughout the study\nfrom design to analysis. S.C provided supervision on the deep learning model. H.Z. performed information retrieval from\nclinical notes. H.R.R, S.L.H, X.M, A.C., D.M., and E.A. performed analysis and preprocessing on EHR data. All authors\nparticipated in the writing of the manuscript.\nAdditional information\nThe authors have declared no competing interests.\n14/19\n . CC-BY-NC-ND 4.0 International licenseIt is made available under a \n is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity. (which was not certified by peer review)\nThe copyright holder for this preprint this version posted April 27, 2024. ; https://doi.org/10.1101/2024.04.26.24306180doi: medRxiv preprint \nTable S1.Definition criteria for AD/ADRD/MCI onset.\nCondition Criteria (ICD-10 codes and Medications)\nAD/ADRD\nF01.*: Any Vascular Dementia\nF02.*: Dementia in other diseases classified elsewhere with or without behavioral disturbance\nF03.*: Unspecified dementia with/without behavioral disturbance\nF04.*: Amnestic disorder due to known physiological condition\nG23.1: progressive supranuclear palsy\nG30.*: Any Alzheimer’s disease\nG31.01: Pick’s disease\nG31.09: Other frontotemporal dementia\nG31.83: Dementia with Lewy bodies\nG31.9: Degenerative disease of nervous system, unspecified\nMild cognitive Impairment\nG31.1: Senile degeneration of brain, not elsewhere classified\nG31.84: Mild cognitive impairment of uncertain or unknown etiology\nG31.85: Corticobasal degeneration\nDementia Medications\nDONEPEZIL\nGALANTAMINE\nMEMANTINE\nRIV ASTIGMINE\nTACRINE\nTable S2.The characteristics of AD/ADRD/MCI finetuning cohort for prediction in various timeframes.\nCharacteristics 1 year 2 years 5 years\nCounts 1,135,692 records from\n223,653 unique patients\n1,000,433 records from\n217,895 unique patients\n445,142 samples from\n142,702 unique patients\nAge (± SD) 74.36 (± 7.29) 74.13 (± 7.38) 73.44 (± 7.67)\nFemale 668,490 (58.86) 588,000 (58.77) 261,427 (58.72)\nWhite 845,843 (74.47) 748,223 (74.79) 338,502 (76.04)\nBlack 87,701 (7.72) 77,071 (7.70) 32,371 (7.27)\nAsian 35,493 (3.13) 31,667 (3.17) 15,103 (3.39)\nOther Race 81,561 (7.18) 72,289 (7.23) 33,627 (7.55)\nUnknown 85,094 (7.49) 71,183(7.11) 25,539 (5.73)\nHypertension 630,256 (55.50) 550,926 (55.07) 232,519 (52.23)\nDiabetes 248,321 (21.87) 217,892 (21.78) 93,649 (21.03)\nDiabetes, complex 17,210 (1.52) 14,657 (1.47) 4,782 (1.07)\nHyperlipidemia 605,379 (53.30) 526,281 (52.61) 221,065 (49.66)\nAny Vascular Risk 832,714 (73.32) 728,977 (72.87) 313,251 (70.37)\nStatins 398,058 (35.05) 350,195 (35.00) 144,193 (32.39)\nAspirin 166,253 (14.64) 152,474 (15.24) 72,567 (16.30)\nBP Meds 495,889 (43.67) 439,045 (43.89) 188,486 (42.34)\nAny Vascular Meds 656,821 (57.83) 580,701 (58.05) 250,108 (56.18)\n15/19\n . CC-BY-NC-ND 4.0 International licenseIt is made available under a \n is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity. (which was not certified by peer review)\nThe copyright holder for this preprint this version posted April 27, 2024. ; https://doi.org/10.1101/2024.04.26.24306180doi: medRxiv preprint \nTable S3.The top 20 variables associated with future AD/ADRD/MCI diagnosis within 5 years. Each column reports\nvariables across patients with varied time-to-dementia from the index date. The color of the cells indicates the category of\nvariables based on either high-level ICD-10 categories or medication.\nAD/ADRD/MCI within 0-1 year AD/ADRD/MCI within 1-2 years AD/ADRD/MCI within 2-3 years AD/ADRD/MCI within 3-5 years\n1 Altered mental status, unspecified\nR41.82\nPrecordial pain R07.2 Precordial pain R07.2 SERTRALINE\n2 Precordial pain R07.2 Parkinson’s disease G20 Parkinson’s disease G20 Abnormal weight loss R63.4\n3 Epilepsy, unspecified, not intractable,\nwithout status epilepticus G40.909\nAbnormal weight loss R63.4 Vascular parkinsonism G21.4 Unspecified urinary incontinence\nR32\n4 Major depressive disorder, single\nepisode, unspecified F32.9\nVascular parkinsonism G21.4 Unspecified convulsions R56.9 Parkinson’s disease G20\n5 Parkinson’s disease G20 LOSARTAN Presence of automatic (implantable)\ncardiac defibrillator Z95.810\nRepeated falls R29.6\n6 Vascular parkinsonism G21.4 Major depressive disorder, single\nepisode, unspecified F32.9\nAbnormal weight loss R63.4 Vascular parkinsonism G21.4\n7 Unspecified urinary incontinence\nR32\nNocturia R35.1 Major depressive disorder, single\nepisode, unspecified F32.9\nMajor depressive disorder, single\nepisode, unspecified F32.9\n8 INR in Platelet poor plasma by Coag-\nulation assay [+3-10 sd]\nDIGOXIN Unspecified urinary incontinence\nR32\nPresence of automatic cardiac defib-\nrillator Z95.810\n9 Nocturia R35.1 ATORV ASTATIN Syncope and collapse R55 Unspecified cataract H26.9\n10 Hereditary and idiopathic neuropathy,\nunspecified G60.9\nDizziness and giddiness R42 Hereditary and idiopathic neuropathy,\nunspecified G60.9\nOther secondary pulmonary hyperten-\nsion I27.2\n11 ESCITALOPRAM OXALATE Unspecified urinary incontinence\nR32\nLOSARTAN MECLIZINE\n12 Dizziness and giddiness R42 Malignant neoplasm of prostate C61 DIGOXIN Syncope and collapse R55\n13 Urge incontinence N39.41 Functional dyspepsia K30 Dizziness and giddiness R42 Dizziness and giddiness R42\n14 End stage renal disease N18.6 Hereditary and idiopathic neuropathy,\nunspecified G60.9\nDifficulty in walking, not elsewhere\nclassified R26.2\nHereditary and idiopathic neuropathy,\nunspecified G60.9\n15 Abnormal weight loss R63.4 ATORV ASTATIN Nocturia R35.1 Headache R51\n16 CARBIDOPA-LEVODOPA LEVOTHYROXINE Overactive bladder N32.81 Hematuria, unspecified R31.9\n17 Unspecified cataract H26.9 Headache R51 Unspecified cataract H26.9 DIGOXIN\n18 LOSARTAN CLONAZEPAM Unspecified atherosclerosis of native\narteries of extremities, other extrem-\nity I70.208\nNocturia R35.1\n19 Hematuria, unspecified R31.9 CARBIDOPA-LEVODOPA CARVEDILOL FUROSEMIDE\n20 Syncope and collapse R55 Hematuria, unspecified R31.9 Obstructive sleep apnea G47.33 Polymyalgia rheumatica M35.3\nD: Diseases of the blood and blood-forming organs E: Endocrine, nutritional and metabolic diseases\nF: Mental, Behavioral and Neurodevelopmental disorders G: Diseases of the nervous system\nI: Diseases of the circulatory system N: Diseases of the genitourinary system\nR: Symptoms, signs and abnormal clinical and laboratory findings Medications\n16/19\n . CC-BY-NC-ND 4.0 International licenseIt is made available under a \n is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity. (which was not certified by peer review)\nThe copyright holder for this preprint this version posted April 27, 2024. ; https://doi.org/10.1101/2024.04.26.24306180doi: medRxiv preprint \na.\n0 200 400 600 800 1000\nN\n0\n50000\n100000\n150000\n200000\n250000\n300000\n350000\n400000Number of Patients\nNumber of medical tokens\n0 50 100 150 200\nN\n0\n100000\n200000\n300000\n400000\nNumber of encounters\n0 500 1000 1500 2000 2500 3000\nDays\n0\n20000\n40000\n60000\n80000\n100000\n120000 Length of presence\nb.\n0 100 200 300 400 500\nN\n0\n20000\n40000\n60000\n80000\n100000\n120000\n140000\n160000Number of Patients\nNumber of medical tokens\n0 10 20 30 40 50\nN\n0\n25000\n50000\n75000\n100000\n125000\n150000\n175000\nNumber of encounters\n0 100 200 300\nDays\n0\n25000\n50000\n75000\n100000\n125000\n150000\n175000\n200000\nLength of presence\nFigure S1.The histograms (from left to right) show the distributions of the number of medical tokens, the number of\nencounters, and the length of presence, respectively, for: a. full EHR data of each patient in the pretraining cohort\n(N=1,030,438 patients) b. EHR data in the 1-year feature windowof the (N=445,142) samples from 142,702 unique patients\nused during the AD/ADRD/MCI finetuning.\n17/19\n . CC-BY-NC-ND 4.0 International licenseIt is made available under a \n is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity. (which was not certified by peer review)\nThe copyright holder for this preprint this version posted April 27, 2024. ; https://doi.org/10.1101/2024.04.26.24306180doi: medRxiv preprint \na. The performance of prediction in the 1-year timeframe\n0.0 0.2 0.4 0.6 0.8 1.0\nFalse Positive Rate\n0.0\n0.2\n0.4\n0.6\n0.8\n1.0True Positive Rate\nROC Curves\neRADAR \n AUC: 0.714 (0.713 0.715)\nLinear \n AUC: 0.724 (0.723 0.725)\nScratch \n AUC: 0.748 (0.747 0.749)\nFinetuning \n AUC: 0.772 (0.770 0.773)\n0.0 0.2 0.4 0.6 0.8 1.0\nRecall (Sensitivity)\n0.0\n0.1\n0.2\n0.3\n0.4\n0.5\n0.6Precision (PPV)\nPrecision Recall Curves\neRADAR \n AP: 0.048 (0.047 0.048)\nLinear \n AP: 0.054 (0.053 0.054)\nScratch \n AP: 0.077 (0.076 0.078)\nFinetuning \n AP: 0.087 (0.086 0.088)\n1% 5% 10%\nb. The performance of prediction in the 2-year timeframe\n0.0 0.2 0.4 0.6 0.8 1.0\nFalse Positive Rate\n0.0\n0.2\n0.4\n0.6\n0.8\n1.0True Positive Rate\nROC Curves\neRADAR \n AUC: 0.704 (0.703 0.705)\nLinear \n AUC: 0.719 (0.718 0.720)\nScratch \n AUC: 0.730 (0.729 0.731)\nFinetuning \n AUC: 0.760 (0.760 0.761)\n0.0 0.2 0.4 0.6 0.8 1.0\nRecall (Sensitivity)\n0.0\n0.1\n0.2\n0.3\n0.4\n0.5\n0.6Precision (PPV)\nPrecision Recall Curves\neRADAR \n AP: 0.081 (0.081 0.082)\nLinear \n AP: 0.092 (0.091 0.093)\nScratch \n AP: 0.120 (0.119 0.121)\nFinetuning \n AP: 0.139 (0.138 0.140)\n1% 5% 10%\nFigure S2.The comparison of performance on predicting AD/ADRD/MCI onset in a. 1-year and b. 2-year outcome windows\nwith different baselines. The finetuned foundation model consistently outperformed the other baselines.\n18/19\n . CC-BY-NC-ND 4.0 International licenseIt is made available under a \n is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity. (which was not certified by peer review)\nThe copyright holder for this preprint this version posted April 27, 2024. ; https://doi.org/10.1101/2024.04.26.24306180doi: medRxiv preprint \n10 14 18 22 26 30\nMMSE scores\n0\n10\n20\n30\n40Percentage\nWhite\nAfrican American\nFigure S3.The analysis of Mini Mental State Exam (MMSE) cognitive scores in the heldout validation set, for patients who\nunderwent screening and were diagnosed with AD/ADRD/MCI within 1 year from the index date. The distribution of scores\nfor AD/ADRD/MCI patients in White vs Black implies that Black patients had lower MMSE scores at diagnosis time\ncompared to white patients, potentially revealing delayed diagnosis in these populations.\n19/19\n . CC-BY-NC-ND 4.0 International licenseIt is made available under a \n is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity. (which was not certified by peer review)\nThe copyright holder for this preprint this version posted April 27, 2024. ; https://doi.org/10.1101/2024.04.26.24306180doi: medRxiv preprint "
}