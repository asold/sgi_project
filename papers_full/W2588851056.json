{
  "title": "Multiple Resonances Mitigation of Paralleled Inverters in a Solid-State Transformer (SST) Enabled AC Microgrid",
  "url": "https://openalex.org/W2588851056",
  "year": 2017,
  "authors": [
    {
      "id": "https://openalex.org/A1900909929",
      "name": "Qing Ye",
      "affiliations": [
        "Florida State University"
      ]
    },
    {
      "id": "https://openalex.org/A2117792945",
      "name": "Ran Mo",
      "affiliations": [
        "Florida State University"
      ]
    },
    {
      "id": "https://openalex.org/A1977052956",
      "name": "Hui Li",
      "affiliations": [
        "Florida State University"
      ]
    },
    {
      "id": "https://openalex.org/A1900909929",
      "name": "Qing Ye",
      "affiliations": []
    },
    {
      "id": "https://openalex.org/A2117792945",
      "name": "Ran Mo",
      "affiliations": []
    },
    {
      "id": "https://openalex.org/A1977052956",
      "name": "Hui Li",
      "affiliations": []
    }
  ],
  "references": [
    "https://openalex.org/W2326109824",
    "https://openalex.org/W2166911158",
    "https://openalex.org/W1912041593",
    "https://openalex.org/W2138673356",
    "https://openalex.org/W2400927163",
    "https://openalex.org/W2072107584",
    "https://openalex.org/W2066503235",
    "https://openalex.org/W2022424136",
    "https://openalex.org/W2095800190",
    "https://openalex.org/W2472925687",
    "https://openalex.org/W2038808792",
    "https://openalex.org/W2048524696",
    "https://openalex.org/W1966322913",
    "https://openalex.org/W1996503623",
    "https://openalex.org/W2344321511",
    "https://openalex.org/W2143875585",
    "https://openalex.org/W2527140121",
    "https://openalex.org/W2124332712",
    "https://openalex.org/W2465436411",
    "https://openalex.org/W2129669526",
    "https://openalex.org/W2173928183",
    "https://openalex.org/W2341309155",
    "https://openalex.org/W1966751624",
    "https://openalex.org/W2239808629",
    "https://openalex.org/W2323773310",
    "https://openalex.org/W2024559217",
    "https://openalex.org/W2124074876",
    "https://openalex.org/W2330039745",
    "https://openalex.org/W2348547458"
  ],
  "abstract": "Solid-state transformer (SST) becomes a promising technology in smart grid applications due to its multiple functionalities and control flexibility compared to line-frequency transformers. In a SST enabled ac microgrid, the grid impedance represented by the SST output impedance is frequency-dependent, which is different from the inductive grid impedance in a conventional ac microgrid. The frequency-dependent SST output impedance can interact with those of paralleled inverters and result in multiple resonances locating in a wide frequency range. In this paper, a combination of a lead-lag compensator and a negative impedance feedback control has been proposed to enhance the system stability. With proposed methods, the multiple resonances are decoupled and thus more feasible to be mitigated. The negative effect of digital control delay on the high frequency resonance damping is attenuated with proposed methods. In addition, the tradeoff design of virtual impedance is also analyzed with consideration of both system-level resonance mitigation function and single inverter stability. Consequently, the stability of paralleled inverters in the SST-enabled ac microgrid has been improved. Finally, an OPAL-RT-based hardware-in-the-loop verification has been provided to prove the validity of proposed methods.",
  "full_text": "4744 IEEE TRANSACTIONS ON SMART GRID, VOL. 9, NO. 5, SEPTEMBER 2018\nMultiple Resonances Mitigation of Paralleled\nInverters in a Solid-State Transformer (SST)\nEnabled AC Microgrid\nQing Ye, Student Member, IEEE, Ran Mo, Student Member, IEEE ,a n dH u iL i ,Senior Member, IEEE\nAbstract—Solid-state transformer (SST) becomes a promising\ntechnology in smart grid applications due to its multiple func-\ntionalities and control ﬂexibility compared to line-frequency\ntransformers. In a SST enabled ac microgrid, the grid impedance\nrepresented by the SST output impedance is frequency-\ndependent, which is different from the inductive grid impedance\nin a conventional ac microgrid. The frequency-dependent SST\noutput impedance can interact with those of paralleled invert-\ners and result in multiple resonances locating in a wide\nfrequency range. In this paper, a combination of a lead-lag\ncompensator and a negative impedance feedback control has\nbeen proposed to enhance the system stability. With proposed\nmethods, the multiple resonances are decoupled and thus\nmore feasible to be mitigated. The negative effect of digi-\ntal control delay on the high frequency resonance damping is\nattenuated with proposed methods. In addition, the tradeoff\ndesign of virtual impedance is also analyzed with consider-\nation of both system-level resonance mitigation function and\nsingle inverter stability. Consequently, the stability of par-\nalleled inverters in the SST-enabled ac microgrid has been\nimproved. Finally, an OPAL-RT-based hardware-in-the-loop ver-\niﬁcation has been provided to prove the validity of proposed\nmethods.\nIndex Terms —Solid-state transformer, paralleled inverters,\nmultiple resonances, active damping.\nI. I NTRODUCTION\nT\nHE FUTURE Renewable Electrical Energy Delivery\nand Management (FREEDM) system has been consid-\nered as a promising smart grid architecture which integrates\nhighly distributed and scalable renewables and energy stor-\nages into existing power systems. The conﬁguration of the\nFREEDM system is shown in Fig. 1 [1]. The solid-state trans-\nformer (SST) is the key component in the FREEDM system,\nwhich is denoted as the intelligent energy management (IEM)\nsubsystem in Fig. 1. It serves as a smart plug-and-play\ninterface for transforming and distributing electric energy from\nvarious distributed renewable energy resources (DRERs) and\nManuscript received September 28, 2016; revised November 9, 2016\nand January 1, 2017; accepted February 5, 2017. Date of publication\nFebruary 14, 2017; date of current version August 21, 2018. This work was\nsupported by the National Science Foundation under Award ECC-0812121.\nPaper no. TSG-01313-2016.\nThe authors are with the Center for Advanced Power Systems, Florida State\nUniversity, Tallahassee, FL 32310 USA (e-mail: qye@caps.fsu.edu;\nrmo@caps.fsu.edu; phli@caps.fsu.edu).\nColor versions of one or more of the ﬁgures in this paper are available\nonline at http://ieeexplore.ieee.org.\nDigital Object Identiﬁer 10.1109/TSG.2017.2669261\nFig. 1. Electric grid diagram conceptualizing the FREEDM system [ 1].\ndistributed energy storage devices (DESDs). Moreover, it can\nachieve power factor correction, voltage sag ride through and\nharmonic elimination which are not available with a traditional\nline-frequency transformer [ 1]. Therefore, the SST enabled ac\nmicrogrid exhibits superior performances over conventional ac\nmicrogrids [2].\nThe stability of paralleled inverters in conventional micro-\ngrids has been extensively researched in [ 3]–[11]. The power\nsharing stability of paralleled inverters in a decentralized\ncontrol form can be jeopardized by a sudden load demand\nchange, which leads to instability issues [ 3]–[5]. Since the\nslow power control loop is of interest, this power sharing\ninstability is usually in a low frequency range. Another type\nof instability issue of the paralleled inverters in conventional\nmicrogrids has been reported in [6]–[8], which is resulted from\ninteractions among inverters’ inner control loops and high\norder ﬁlters. In this case, the resonance frequency observed\nis in a higher frequency range due to faster dynamics. This\npaper is focused on the second type of instability issue.\nThe impedance-based stability analysis method is an effective\ntool to gain insight on instability issues due to the interac-\ntions among paralleled inverters in conventional grid [ 9]–[12].\nThe minor loop gain derived from inverters’ output admit-\ntance and grid impedance is required to meet the Nyquist\nStability Criterion to maintain system stability. The stability of\nparalleled inverters in a SST enabled microgrid faces differ-\nent challenges compared to that in conventional microgrids.\n1949-3053 c⃝ 2017 IEEE. Translations and content mining are permitted for academic research only. Personal use is also permitted, but republication/\nredistribution requires IEEE permission. See http://www.ieee.org/publications_standards/publications/rights/index.html for more information.\nYE et al.: MULTIPLE RESONANCES MITIGATION OF PARALLELED INVERTERS IN SST ENABLED AC MICROGRID 4745\nFig. 2. System conﬁguration and control diagram of paralleled inverters in the SST enabled ac microgrid.\nFirst, unlike the inductive grid impedance in the low volt-\nage ac microgrid, the output impedance characteristic of SST\nis frequency-dependent due to its output ﬁlter and controller.\nSecond, in order to achieve good power quality and transient\nperformance, extra harmonics compensation control and feed-\nforward controls have been applied to SST [ 13], which further\nshape the SST output impedance to be distinctive from the\ngrid impedance. Therefore, it is necessary to include an accu-\nrate SST impedance model while addressing the stability of\nparalleled inverters in a SST enabled microgrid.\nIn [ 14], the harmonics instability in a multiple SST based\nIEEE 34-bus distribution system was analyzed, and Shah\nand Crow proposed a design criterion for the SST input ﬁl-\nter to mitigate the instability. The same authors proposed\na stability assessment technique with consideration of system\nconﬁguration change due to a fault in [ 15]. However, the con-\ntroller based resonance mitigation method is not provided.\nThe SST-enabled dc microgrid stability has been investigated\nin [16] and [ 17], however, the SST low voltage ac terminal\nstability has not been addressed.\nVirtual impedance based control is usually implemented in\ninverter controllers to enhance the stability of paralleled invert-\ners based microgrid [ 7], [18]–[21]. In [ 7], a virtual resistor\nwas implemented in the inverter output ﬁlter to dampen out\nthe resonance propagation in the paralleled inverters based\nmicrogrid. Reference [ 18] proposed a dual virtual impedance\nloops to dampen out harmonic resonance in a paralleled\ninverter-based microgrid. In [ 19], both a virtual resistor and\na nonlinear virtual capacitor are implemented to damp res-\nonance and compensate harmonic voltage drop on inverter\nﬁlter. It is noticed that the virtual impedance control based\nactive damping method needs to be designed dedicatedly to\nmitigate the resonance at a speciﬁc frequency. However, since\nboth the output impedances of inverters and SST are frequency\ndependent, the interactions among them can results in multiple\nresonances in a wide frequency range. Moreover, active damp-\ning effect deteriorates due to the impact of digital control delay\nwhen the resonance frequency approaches the inverter control\nbandwidth [22]. Therefore, it is a challenge to design an effec-\ntive active damping method for paralleled inverters in a SST\nenabled microgrid.\nTo address aforementioned challenges, this paper starts\nwith impedance derivation of the SST and the inverters in\nSection II. The stability analysis of paralleled inverters in\na SST enabled ac microgrid is also conducted, which reveals\nthat there are multiple resonances locate in a wide frequency\nrange. A combination of lead-lag compensator and negative\nimpedance feed control are proposed in Section III to miti-\ngate resonance at different frequency range. As a result, the\nstability of the paralleled inverters in the SST enabled ac\nmicrogrid has been enhanced. An OPAL-RT based Hardware-\nin-the-loop (HIL) veriﬁcation has been provided in Section IV\nto prove the validity of proposed methods.\nII. S\nTABILITY ANALYSIS OF PARALLELED INVERTERS\nIN A SST E NABLED AC MICROGRID\nA. System Description and Impedance Derivation\nThe system conﬁguration and control diagram of n-\nparalleled inverters in a SST enabled ac microgrid is depicted\nin Fig. 2. The SST is a three-stage ac-ac converter including\na rectiﬁer stage, dc/dc stage, and an inverter stage. The SST\nsteps down the grid voltage to 120 V to enable a low voltage\nac microgrid [ 12]. An LC ﬁlter is used at SST low voltage\nac terminal to attenuate the switching harmonics. The inverter\nstage can be treated as decoupled from the front two stages\ndue to the low voltage dc link capacitor. The output voltage\nv\nsst is regulated to interface the paralleled inverters, as shown\n4746 IEEE TRANSACTIONS ON SMART GRID, VOL. 9, NO. 5, SEPTEMBER 2018\nin the control diagram of SST inverter stage. Meanwhile, the\nharmonics compensation controller (HCC) Gc,1(s) and volt-\nage reference feedforward control are applied to achieve good\npower quality and transient performance. The line impedance\nis not considered here, and can be treated as part of inverter\nﬁlters if required. Since this paper focuses on the small sig-\nnal instability owing to the fast dynamics of inner control\nloop, slow control such as energy management controls are\nneglected [22]. Therefore, the output impedance of SST at low\nvoltage terminal is expressed as\nZsst =\nsLsst + Rsst\nsC ·\n(\nsLsst + Rsst + Gc,1(s)KPWM,1Gd,1(s) + GvGc,1(s)KPWM,1Gd,1(s) + 1\n)\n(1)\nGv(s) = Kp,v + Kr,v\ns\ns2 + 2ωc + ω2o\n(2)\nGC,1(S) = Kp +\n∑\nj=1,3,5,...,15\nKr,j\ns\ns2 + 2ωc + (jωo)2 (3)\nGd,1(s) = e−1.5sTs,1 (4)\nwhere Lsst, Csst and Rsst are ﬁlter inductor, capacitor and equiv-\nalent series resistor (ESR); Gv(s) denotes the outer voltage\nPR controller; Gc1(s) is the inner harmonic current compensa-\ntion controller where additional resonant controls at odd-order\nharmonics are implemented; ω\n0 denotes the system funda-\nmental frequency, ωc is the cutoff frequency; Gd,1(s) is the\ninverter stage digital control delay, which is approximated to\nbe 1.5 sampling period T\ns1; KPWM,1 is the dc link voltage of\nthe inverter stage. All the parameters in ( 1)-(4)a r eg i v e ni n\nTable I in the Appendix.\nThe paralleled inverters are integrated to the SST enabled\nmicrogrid through LCL ﬁlters, and are in output current\ncontrol mode. The power control loop and grid synchroniza-\ntion loop of the paralleled inverters are neglected since their\nhigh frequency terminal behavior is of interest [ 23], [24]. The\noutput admittance of single inverter is derived as\nY\ninv(s)\n=\n(\ns2L1,iCi + 1\n)\ns3L1,iL2,iCi + s\n(\nL1,i+L2,i\n)\n+ Gc,2(s)KPWM,2Gd,2(s) (5)\nGC,2(S) = Kp,i + Kr,i\ns\ns2 + 2ωc + ω2o\n(6)\nGd,2(s) = e−1.5sTs,2 (7)\nwhere L1,i, Ci and L2,i are the converter side inductor, capaci-\ntor and grid side inductor of the ith inverter LCL ﬁlter; Gc2(s)\nis inverter output current controller; Gd,2(s) is inverter digital\ncontrol delay, which is approximated to be 1.5 sampling period\nT\ns2; ω0 denotes the system fundamental frequency, ωc is the\ncutoff frequency; KPWM,2 is the dc link voltage of inverter. It\nis assumed that all the inverters are identical. The parameters\nin (5)-(7) can be found in Table II in the Appendix.\nThe bode plots of SST output impedance Zsst and sin-\ngle inverter output admittance Yinv are shown in Fig. 3.T h e\nZsst exhibits an inductive feature at the frequency range from\n100 Hz to 1 kHz, and a capacitive one at the frequency higher\nthan 1 kHz. Furthermore, the HCC implemented in the SST\ninduces phase boost at odd-order line frequency and cause\nFig. 3. Bode plot of (a) SST output impedance, and (b) Single inverter output\nadmittance.\nphase peaks with values beyond 90 ◦. On the other hand, Yinv\nreveals capacitive characteristic at ﬁrst, but then its phase grad-\nually decreases to a negative value at frequency range from\n100 Hz to 1 kHz. At higher frequency range, Yinv shows\nan inductive feature due to its SST side ﬁlter inductance.\nThese frequency-dependent feature of both Zsst and Yinv lead\nto multiple resonances. For example, at frequency range from\n100 Hz to 1 kHz, the inductive characteristics of Z\nsst and\ncapacitive characteristics of Yinv may cause instability if the\nintegrated number of inverters n is large; a similar conclusion\ncan be drawn at frequency higher than 1 kHz.\nB. Impedance-based Stability Analysis\nThe uniﬁed impedance-based stability criterion (UIBSC)\nhas been proposed to analyze the stability of paralleled\ninverters in the conventional grid [ 10]. Compared to the tradi-\ntional impedance-based stability criterion (IBSC), the UIBSC\nrequires much less computation efforts and provides a system\nlevel insight of resonances. Therefore, it is also applied here.\nYE et al.: MULTIPLE RESONANCES MITIGATION OF PARALLELED INVERTERS IN SST ENABLED AC MICROGRID 4747\nFig. 4. Nyquist Plot of GMLG when n =3, system is unstable.\nSince all the inverters are identical, the global minor loop\ngain (GMLG) is derived as:\nGMLG = n · Zsst · Yinv (8)\nwhere n is the number of paralleled inverters in the SST\nenabled microgrid; Zsst and Yinv are derived in ( 1) and ( 5)\nrespectively. It is worth mentioning that although the same\nparameters of inverters are used here for analysis, the UIBSC\ncan also be applied to paralleled inverters with different\nparameters [10].\nThe Nyquist Plot of GMLG is shown in Fig. 4 when the\nnumber of integrated paralleled inverters n = 3. The system\nis unstable since the critical point (−1, j0) is encircled by\nthe Nyquist Plot trajectory. The resonance frequency in this\ncase is close to 310 Hz as in the denotation of crossover point\nA. Therefore, the maximum integrated number of paralleled\ninverters without any damping method implemented is two.\nMoreover, there are another two crossover points as denoted\nas B and C in Fig. 4. If the number of paralleled inverters keeps\nincreasing, resonances with frequencies at 206 Hz (crossover\npoint B) and 3.35 kHz (crossover point C) will be triggered.\nIn other word, multiple resonances can happen in this SST\nenabled microgrid. Although the harmonic compensation con-\ntroller (HCC) of SST can achieve good load harmonic current\nrejection capability, it has a negative impact on system sta-\nbility. As shown in Fig. 4, the phase boost induced by HCC\nmakes the phase summation of Z\nsst and Yinv equal to 180 ◦ at\n206 Hz and 310 Hz, which causes low frequency resonances.\nMeanwhile, the 3.35 kHz resonance is caused by the capacitive\ncharacteristics of Z\nsst and the inductive characteristics of Yinv\nat high frequency range. Therefore, the physical mechanism\nof low frequency resonance and the high frequency resonance\nare different from each other.\nIII. P\nROPOSED RESONANCE MITIGATION TECHNIQUES\nThe stability analysis of paralleled inverters in the SST\nenabled microgrid reveals that multiple resonances can hap-\npen in this system. Moreover, system integration capability\nis limited due to the stability issue and the maximum num-\nber of paralleled inverter is derived to be two. Therefore,\ndedicated resonance mitigation techniques are required to\nenhance system stability and ensure system reliable oper-\nation. However, those resonances are located in a wide\nfrequency range. In addition, the physical mechanism of low\nfrequency resonances and high frequency resonance are dif-\nferent as explained in Section II. Therefore, it is difﬁcult\nto damp all of the resonances with one particular damping\nmethod. The idea of this paper is to propose a combination\nof two decoupled damping techniques, and each technique\nwill mitigate the resonances caused by one speciﬁc physi-\ncal mechanism. Consequently, these two proposed damping\nmethods can be designed separately. Another advantage is\nthat the digital control delay effect can be neglected or com-\npensated depending on the ratio of to-be-mitigated resonance\nfrequency and sampling frequency (10 kHz). For example, the\ncontrol delay can be neglected when designing low frequency\nresonances (206 Hz and 310 Hz) since the ratio is triv-\nial. However, it needs to be considered while addressing\nthe high frequency resonance (3.35 kHz) since the ratio is\nno longer negligible. In this paper, the proposed damping\nmethod for high frequency resonance mitigation can compen-\nsate the effect of digital control delay, which achieves a more\neffective mitigation function. Since the inverter controller is\nmuch simpler than that of SST, the proposed damping con-\ntrollers are implemented in the paralleled inverters instead\nof the SST.\nA. Low Frequency Resonance Mitigation\nThe possible low frequency resonances at 310 Hz and\n206 Hz are caused by the phase boost introduced by the\nharmonics compensation controller of SST. Since they are\nwell below the bandwidth of inverters’ current control loops,\na lead-lag controller is integrated with the pre-designed cur-\nrent controller to realize the active damping function. More\nspeciﬁcally, a phase drop is desired so that the phase summa-\ntion of Z\nsst and Yinv can be smaller than 180 ◦ at 310 Hz and\n206 Hz. According to this requirement, the lead-lag controller\nis designed as\nG\nlead_lag(s) = f1\nf2\n· 1 + s/2πf1\n1 + s/2πf2\n(9)\nwhere f1 =100Hz, f2 =350Hz.\nThe inverter control diagram shown in Fig. 2 remains the\nsame, but the improved current controller G′\nc,2(s) with the\nproposed lead-lag compensator implemented is expressed as:\nG′\nc,2(s) = Gc,2(s) · Gleadlag (s)\n=\n(\nKp,i + Kr,i\ns\ns2 + 2ωc + ω2o\n)\n·\n( f1\nf2\n· 1 + s/2πf1\n1 + s/2πf2\n)\n(10)\nFig. 5 depicts the comparison of single inverter output\nadmittance with and without proposed lead-lag controller.\nA phase drop is achieved from 100 Hz to 400 Hz which can\nfully mitigate the negative effect of the phase boost caused by\nSST controller. The phase angle of GMLG is always smaller\n4748 IEEE TRANSACTIONS ON SMART GRID, VOL. 9, NO. 5, SEPTEMBER 2018\nFig. 5. Bode Plot of single inverter output admittance w/ and w/o proposed\nlead-lag compensator.\nFig. 6. Nyquist Plot of GMLG with proposed lead-lag compensator, system\nis stable when n = 8.\nthan 180◦ in this low frequency range. Therefore, the 310 Hz\nand 206 Hz resonances are well-damped. The parameter of\ninverter current resonant controller kr,i is increased to 100 so\nthat the magnitude of Yinv has little change at line frequency,\nand good reference tracking capability is maintained. With\nthe lead-lag compensator implemented, the Nyquist Plot of\nGMLG when n = 8 is shown in Fig. 6. Compared to Fig. 4,\nthe Nyquist Plot trajectory now only has one intersection with\nthe negative real axis at 3.32 kHz. The pre-crossover points A\nand B no longer exist on the negative real axis, which means\nthe low frequency resonances has been effectively suppressed.\nFurthermore, the high frequency resonance is still around\n3.3 kHz which has been successfully decoupled from those\nlow frequency resonances. System stability has been enhanced\nwith the proposed lead-lag compensator, and the maximum\nnumber of integrated paralleled inverters is increased from two\nto eight.\nFig. 7. Bode Plot comparison of single inverter output admittance before\nand after simpliﬁcation.\nB. High Frequency Resonance Mitigation\nThe controller redesign method of integrating a lead-lag\ncontroller with pre-designed current controller can only shape\nthe inverter output admittance within inverter control band-\nwidth effectively. However, it is difﬁcult to damp the high\nfrequency resonance at 3.3 kHz with the same method because\nthe desired impedance shaping function can be located close\nto or even beyond the current control bandwidth. Moreover,\nat such a high frequency range, the effect of digital control\ndelay cannot be neglected any more when designing the active\ndamping method. In this subsection, two negative impedance\nfeedback controls (NIFC) with consideration of digital control\ndelay are proposed to mitigate the high frequency resonance,\nand the negative resistor feedback control proves to be an\neffective active damping function. The value of the virtual\nnegative resistor is selected through a trade-off design between\nsystem-level resonance mitigation function and single inverter\nstability.\nThe inverter control bandwidth is usually designed to be\nlower than the natural resonant frequency of inverter LCL ﬁl-\nter, which is around 2 kHz as shown in Fig. 3. Here only\nthe inverter output admittance beyond the current control\nbandwidth is of interest while addressing the high frequency\nresonance at 3.3 kHz. Besides, this 3.3 kHz resonance has\nbeen successfully decupled from those in low frequency\nrange. Therefore, the single inverter output admittance can be\nsimpliﬁed as\nY\ninv(s) =\n(\ns2L1,iCi + 1\n)\ns3L1,iL2,iCi + s\n(\nL1,i+L2,i\n)\n+ G′\nc,2(s)KPWM,2Gd,2(s)\n≈\n(\ns2L1,iCi + 1\n)\ns3L1,iL2,iCi + s\n(\nL1,i+L2,i\n) (11)\nwhere the controller G′\nc,2(s) associated with its control delay\nGd,2(s) are neglected.\nThe comparison of single inverter output admittance before\nand after simpliﬁcation is shown in Fig. 7. The admittances\nbeyond 3 kHz, where the high frequency resonance happens,\nYE et al.: MULTIPLE RESONANCES MITIGATION OF PARALLELED INVERTERS IN SST ENABLED AC MICROGRID 4749\nFig. 8. (a) Conceptual diagram and (b) Realization diagram of negative inductor feedback control.\nmatch very well. Therefore, the simpliﬁed admittance is accu-\nrate enough to address the 3.3 kHz resonance. Moreover, it also\nvalidates that the controller redesign method cannot shape the\ninverter output admittance at the concerned high frequency\nrange. By neglecting the low order terms in both numera-\ntor and denominator of ( 5), the inverter output admittance\ncan be further simpliﬁed as 1 /sL\n2,i. Based on the analysis,\ntwo virtual impedance control methods are proposed here to\nenhance system stability. The ﬁrst method is to decrease the\nmagnitude of inverter output admittance. The greater the value\nof L\n2,i, the smaller the magnitude of Yinv, while the phase\nremains the same. Therefore, by adding a virtual inductor in\nseries with L2,i, the gain margin of GMLG can be increased,\nand system stability can thereby be improved. The second\nmethod is to boost the phase at the resonance frequency. This\ncan be achieved by implementing a virtual resistor in series\nwith L\n2,i. As a consequence, the new resonance frequency\nwill be pushed to higher frequency range. Since the magni-\ntude of single inverter output admittance is decreasing with\n-20dB/decades, the system stability can be enhanced.\nThe conceptual diagram of inverter control block with a vir-\ntual inductor L\nv is depicted in Fig. 8(a). The feedback node\nintroduced by the virtual inductor realization is in the plant,\nwhich has to be moved to the output of controller G′\nc,2(s) for\nimplementation. The realization diagram of this virtual induc-\ntor control is depicted in Fig. 8(b). The feedback term G\nx(s)\nderived as\nGx(s) = sLv\n(\ns2L1,iCi + 1\n)\nGd,2(s)KPWM,2\n. (12)\nIt is noticed that there is a prediction component in ( 8),\ngiven by\nGp(s) = 1\nGd,2(s) = e1.5sTs,2 (13)\nwhich cannot be realized physically, and it is usually\nneglected [22]. However, neglecting Gp(s) here can cause\nsigniﬁcant phase shaping error at the high frequency range.\nConsidering that the sampling period for each inverter is\n100 µs, the natural frequency of the prediction compo-\nnent is around 6.66 kHz, which is twice of the resonance\nfrequency. Thus, the prediction component is approximated\nto be -1 instead of being neglected in this paper in order to\nachieve a more accurate impedance shaping function. With\nthis approximation, the feedback term is further simpliﬁed as\nG\nx(s) = −sLv\n(\ns2L1,iCi + 1\n)\nKPWM,2\n(14)\nwhich can be treated as a negative inductor feedback term\nwithout the prediction component.\nAlthough a greater value of Lv is desired for the sake of\nsystem stability, the stability of single inverter should not be\nviolated after L\nv implemented. In order to investigate how\nthe value of Lv affects single inverter stability, the pole-zero\nmap of single inverter closed-loop transfer function (CLTF)\nis depicted in Fig. 9. It is found that when L\nv increases to\nL2,i/10 , the single inverter is unstable. In other word, the\nassurance of single inverter stability poses limitations on the\nchoice of L\nv. With the virtual inductor implementation, the\noutput admittance of single inverter is modiﬁed as\nYinv_NIFC(s)\n=\n(\ns2L1,iCi + 1\n)\ns3L1,iL2,iCi + s\n(\nL1,i+L2,i\n)\n+ G′\nc,2(s)KPWM,2Gd,2(s) − A\n(15)\nA =− sLv\n(\ns2L1,iCi + 1\n)\n· Gd,2(s) (16)\nWhen Lv = L2,i/20, the magnitude difference of single\ninverter output impedance is negligible. In this case, the\nNyquist plot of GMLG with NIFC is depicted in Fig. 10,\nand nmax is still 8. Therefore, the desired resonance mitiga-\ntion capability cannot be achieved with the negative virtual\ninductor implemented. Another method is negative resistor\nfeedback control (NRFC). With the same control system\nstructure in Fig. 8, the feedback term G\nx(s) in this case is\nmodiﬁed to be\nGx(s) = −Rv\n(\ns2L1,iCi + 1\n)\nKPWM,2\n(17)\nwhere Rv is the virtual resistor.\nThe value of Rv is derived to be 1.2 with consideration of\nsingle inverter stability. The design method is the same as the\n4750 IEEE TRANSACTIONS ON SMART GRID, VOL. 9, NO. 5, SEPTEMBER 2018\nFig. 9. Single inverter stability analysis with different value of virtual\ninductor.\nFig. 10. Nyquist plot of GMLG with NIFC, nmax = 8.\none used to ﬁnd the value of the virtual inductor. After the\nvirtual resistor implemented, the output admittance of single\ninverter is derived as\nYinv_NRFC(s)\n=\n(\ns2L1,iCi + 1\n)\ns3L1,iL2,iCi + s\n(\nL1,i+L2,i\n)\n+ G′\nc,2(s)KPWM,2Gd,2(s) − B\n(18)\nB =− Rv\n(\ns2L1,iCi + 1\n)\n· Gd,2(s) (19)\nThe comparison of single inverter output admittance with\nand without NRFC is shown in Fig. 11. By applying\nthe proposed method, Yinv_NRFC has a phase boost at the\npre-resonance frequency compared to original one, so the\nresonance frequency has been pushed to a higher value.\nMeanwhile, the magnitude of Y\ninv_NRFC is descending with\n-20 dB/decades. Therefore, with the same value of n, the mag-\nnitude of GMLG is decreased at the new resonance frequency,\nand system stability is improved. The Nyquist plot of GMLG\nFig. 11. Comparison of single inverter output admittance w/ and w/o NRFC.\nFig. 12. Nyquist plot of GMLG with NRFC, nmax = 14.\nFig. 13. Hardware-in-the-loop setup.\nwith proposed NRFC is depicted in Fig. 12, and the system\nis stable with nmax = 14. The new resonance frequency has\nbeen pushed to 4.21 kHz as denoted of crossover point A ∗.\nYE et al.: MULTIPLE RESONANCES MITIGATION OF PARALLELED INVERTERS IN SST ENABLED AC MICROGRID 4751\nFig. 14. HIL impedance measurement results: (a) SST output impedance, (b) single inverter output admittance w/o proposed control, (c) single invert er output\nadmittance w/ proposed lead-lag controller, (d) zoomed-in single inverter output admittance w/o NRFC, and (e) zoomed-in single inverter output adm ittance\nw/ NRFC.\nIV . HARDW ARE-IN -THE -LOOP VERIFICATION\nOPAL-RT based real time simulation has been proved to\nbe an effective veriﬁcation method for microgrid stability\nanalysis [25]–[28]. Recently, OPAL-RT based hardware-in-\nthe-loop (HIL) approach has been presented to verify\nthe proposed stability analysis and improvement techniques\n4752 IEEE TRANSACTIONS ON SMART GRID, VOL. 9, NO. 5, SEPTEMBER 2018\nin [29]–[31]. In this paper, a hardware-in-the-loop (HIL)\ntestbed consisting of an OPAL-RT real-time simulator (RTS)\nand an impedance measurement unit is used to assess the\nproposed methods. The HIL setup is illustrated in Fig. 13.T h e\nRTS executes the SST-enabled microgrid model, and transfers\nthe simulated data to OP5607 I/O expansion unit. An Agilent\nE5061B network analyzer is used as an online impedance\nmeasurement unit (IMU), which sends injection signals to\nRTS and receives perturbed signals through the I/O expan-\nsion unit. Thus, the impedance characteristics of both SST and\nsingle inverter can be measured on-line. In addition, real-time\nsimulation results are provided to demonstrate the stability\nissues. The SST and inverter controllers are discretized to be\nconsistent with digital controllers implemented in practice.\nThe HIL impedance measurement results are shown in\nFig. 14. Since the 3rd and 5th order of SST harmonics com-\npensation controller cause the 206 Hz and 310 Hz crossover\npoints shown in Fig. 4, they are included in the model while\nthe higher order resonant parts are not. The measured Z\nsst\nat frequency range from 10 Hz to 7 kHz is depicted in\nFig. 14(a). The phase angle of Zsst at 60 Hz has a 360 ◦ shift\ndue to impedance calculation function in IMU, which does not\naffect the stability analysis and can be neglected. It is noticed\nthat the measured Z\nsst is consistent with its theoretical value\nin Fig. 3(a). The same conclusion can be drawn for single\ninverter output admittance Yinv by comparing Fig. 14(b) with\nFig. 3(b). After the proposed lead-lag controller implemented,\nthe measured Yinv is shown in Fig. 14(c) which is also con-\nsistent with theoretical value shown in green shown in Fig. 5.\nMoreover, the phase angle of Yinv without any proposed con-\ntrol are 84.6 ◦, 77.7 ◦, 66.5 ◦, 44.5 ◦ at frequency points of\n100 Hz, 200 Hz, 300 Hz and 400 Hz respectively. These val-\nues of phase angle are decreased to 57.5 0, 46.4 ◦, 39.2 ◦, and\n28.8◦ with lead-lag compensator. Therefore, the phase drop\nas denoted in Fig. 5 has been achieved. To demonstrate the\nimpedance shaping function of proposed NRFC, the zoomed\nin original Y\ninv and modiﬁed Yinv from 2 kHz to 7 kHz are\nprovided in Fig. 14(d) and Fig. 14(e) respectively. Without\nproposed NRFC, the phase angle of Yinv are -81.1 ◦, -85.7 ◦,\n87.8◦, -89.1◦, -89.8◦ and -90.2◦ at frequency points of 2 kHz,\n3 kHz, 4 kHz, 5kHz and 6 kHz respectively. After NRFC\nimplemented, those value are boosted to -68.6◦, -79.3◦, -83.6◦,\n-85.9◦, -87.5 ◦ and -88.3 ◦ at corresponding frequency points.\nAlthough the on-line measured value has a small difference\ncompared to the theoretical value in Fig. 11, the trends are\nthe same and the desired phase boost with proposed NRFC\nhas been achieved. The HIL impedance results validate the\ntheoretical analysis.\nThe real-time simulation results are depicted in Fig. 15.\nThe simulation results with 3-paralleled inverters in the SST\nenabled ac microgrid without the proposed controllers are\nshown in Fig. 15 (a). A resonance at 310 Hz is observed\nat SST output voltage and inverter output current, which\nis consistent with theoretical analysis in Fig. 4.I nt h i s\ncase, the maximum number of integrated paralleled inverters\nn\nmax = 2. The proposed lead-lag controller is implemented\nto mitigate the low frequency resonances, and the simula-\ntion result of 9-paralleled inverters integrated is shown in\nFig. 15. OPAL-RT real-time simulation results when (a) n =3 w/o proposed\nmethod, (b) n=9 w/ proposed lead-lag compensator, and (c) n =14 w/ lead-lag\ncompensator and NRFC.\nFig. 15(b). As predicted, a high frequency resonance at\naround 3.3 kHz occurs, which is consistent with the the-\noretical analysis in Fig. 6. Thus, nmax = 8 with lead-lag\nYE et al.: MULTIPLE RESONANCES MITIGATION OF PARALLELED INVERTERS IN SST ENABLED AC MICROGRID 4753\nTABLE I\nPARAMETERS OF SST\ncompensator implemented. After the proposed NRFC imple-\nmented, nmax = 14 is realized as shown in Fig. 12. Therefore,\nthe system stability has been improved with proposed reso-\nnance mitigation techniques, and system integration capability\nhas also been enhanced.\nV. C\nONCLUSION\nIn this paper, the stability of paralleled inverters in a SST\nenabled ac microgrid has been analyzed and improved. Unlike\nthe conventional ac microgrid where the grid impedance is rep-\nresented by the inductive line parameters and line-frequency\ntransformers, the SST has a frequency-dependent impedance\ncharacteristic that can cause multiple resonances in a wide\nfrequency range. This unique feature poses a great challenge\non designing effective active damping techniques. To solve\nthis issue, the characteristics of SST output impedance has\nbeen analyzed ﬁrst to separate the resonance mechanisms\nin the system, so that the causes of resonances in different\nfrequency ranges can identiﬁed. It is found that instead of\nusing one speciﬁc damping method to enhance system stabil-\nity, a combination of several damping techniques is desired to\nmitigate resonances locate at low frequency range and high\nfrequency range separately. Therefore, a lead-lag compensator\nand negative impedance feedback controls are proposed to\nrealize damping function. With proposed method, the multiple\nresonances are decoupled and thus more feasible to be miti-\ngated. In addition, the control delay, which has great impact\nat high frequency terminal behavior, only needs to be con-\nsidered when dealing with the high frequency resonance.\nThe proposed negative resistor feedback control can effec-\ntively compensate the control delay, so effective impedance\nshaping at high frequency range has been achieved to sta-\nbilize the system. Moreover, the trade-off design of virtual\nimpedance implemented has also been analyzed to meet both\nsingle inverter level and system level stability requirements.\nAt last, a hardware-in-the-loop (HIL) testbed is constructed.\nThe terminal behaviors of SST and inverters are extracted\non-line and found to be consistent with theoretical analysis.\nReal time simulation results are also provided to demonstrate\nTABLE II\nPARAMETERS OF SINGLE INVERTER\nthe resonance phenomenon and prove the validity of proposed\nmethods. The system stability has been improved and the inte-\ngration capability of SST served as a microgrid enabler is also\nenhanced.\nVI. A\nPPENDIX\nSee Tables I and II.\nREFERENCES\n[1] A. Q. Huang, M. L. Crow, G. T. Heydt, J. P. Zheng, and S. J. Dale, “The\nfuture renewable electric energy delivery and management (FREEDM)\nsystem: The energy Internet,” Proc. IEEE, vol. 99, no. 1, pp. 133–148,\nJan. 2011.\n[2] X. She, X. Yu, F. Wang, and A. Q. Huang, “Design and demonstration\nof a 3.6-kV–120-V/10-kV A solid-state transformer for smart grid appli-\ncation,” IEEE Trans. Power Electron. , vol. 29, no. 8, pp. 3982–3996,\nAug. 2014.\n[3] J. Liu, Y . Miura, H. Bevrani, and T. Ise, “Enhanced virtual synchronous\ngenerator control for parallel inverters in microgrids,”IEEE Trans. Smart\nGrid., to be published, doi: 10.1109/TSG.2016.2521405.\n[4] J. M. Guerrero, J. Matas, L. G. de Vicuna, M. Castilla, and J. Miret,\n“Decentralized control for parallel operation of distributed generation\ninverters using resistive output impedance,” IEEE Trans. Ind. Electron.,\nvol. 54, no. 2, pp. 994–1004, Apr. 2007.\n[5] Y . A. -R. I. Mohamed and E. F. El-Saadany, “Adaptive decentralized\ndroop controller to preserve power sharing stability of paralleled invert-\ners in distributed generation microgrids,” IEEE Trans. Power Electron.,\nvol. 23, no. 6, pp. 2806–2816, Nov. 2008.\n[6] R. Turner, S. Walton, and R. Duke, “Stability and bandwidth impli-\ncations of digitally controlled grid-connected parallel inverters,” IEEE\nTrans. Ind. Electron., vol. 57, no. 11, pp. 3685–3694, Nov. 2010.\n[7] J. He, Y . W. Li, D. Bosnjak, and B. Harris, “Investigation and active\ndamping of multiple resonances in a parallel-inverter-based microgrid,”\nIEEE Trans. Power Electron., vol. 28, no. 1, pp. 234–246, Jan. 2013.\n[8] M. Lu, X. Wang, P. C. Loh, and F. Blaabjerg, “Resonance interaction\nof multiparallel grid-connected inverters with LCL ﬁlter,” IEEE Trans.\nPower Electron., vol. 32, no. 2, pp. 894–899, Feb. 2017.\n[9] C. Yoon et al. , “Harmonic stability assessment for multiparalleled,\ngrid-connected inverters,” IEEE Trans. Sustain. Energy , vol. 7, no. 4,\npp. 1388–1397, Oct. 2016.\n[10] Q. Ye, R. Mo, Y . Shi, and H. Li, “A uniﬁed impedance-based sta-\nbility criterion (UIBSC) for paralleled grid-tied inverters using global\nminor loop gain (GMLG),” inProc. IEEE ECCE, Montreal, QC, Canada,\nSep. 2015, pp. 5816–5821.\n[11] J. He, Y . W. Li, R. Wang, and C. Zhang, “Analysis and mitigation of res-\nonance propagation in grid-connected and islanding microgrids,” IEEE\nTrans. Energy Convers., vol. 30, no. 1, pp. 70–81, Mar. 2015.\n[12] Q. Ye and H. Li, “Stability analysis and improvement of solid state\ntransformer (SST)-paralleled inverters system using negative impedance\nfeedback control,”in Proc. IEEE Appl. Power Electron. Conf. Expo.\n(APEC), Long Beach, CA, USA, 2016, pp. 2237–2244.\n[13] J. Ge, Z. Zhao, L. Yuan, and T. Lu, “Energy feed-forward and direct\nfeed-forward control for solid-state transformer,” IEEE Trans. Power\nElectron., vol. 30, no. 8, pp. 4042–4047, Aug. 2015.\n4754 IEEE TRANSACTIONS ON SMART GRID, VOL. 9, NO. 5, SEPTEMBER 2018\n[14] D. G. Shah and M. L. Crow, “Stability design criteria for distribution\nsystems with solid-state transformers,” IEEE Trans. Power Del., vol. 29,\nno. 6, pp. 2588–2595, Dec. 2014.\n[15] D. G. Shah and M. L. Crow, “Stability assessment extensions for single-\nphase distribution solid-state transformers,” IEEE Trans. Power Del. ,\nvol. 30, no. 3, pp. 1636–1638, Jun. 2015.\n[16] M. Khazraei, V . A. K. Prabhala, R. Ahmadi, and M. Ferdowsi, “Solid-\nstate transformer stability and control considerations,” in Proc. IEEE\nAppl. Power Electron. Conf. Expo. (APEC), Fort Worth, TX, USA, 2014,\npp. 2237–2244.\n[17] Q. Ye, R. Mo, and H. Li, “Impedance modeling and veriﬁcation of\na dual active bridge (DAB) DC/DC converter enabled DC microgrid\nin FREEDM system,” in Proc. IEEE 8th Int. Power Electron. Motion\nControl Conf. (IPEMC ECCE Asia), Hefei, China, 2016, pp. 2875–2879.\n[18] A. A. A. Radwan and Y . A.-R. I. Mohamed, “Analysis and active-\nimpedance-based stabilization of voltage-source-rectiﬁer loads in grid-\nconnected and isolated microgrid applications,” IEEE Trans. Sustain.\nEnergy, vol. 4, no. 3, pp. 563–576, Jul. 2013.\n[19] J. He, Y . W. Li, R. Wang, and C. Zhang, “Analysis and mitigation of res-\nonance propagation in grid-connected and islanding microgrids,” IEEE\nTrans. Energy Convers., vol. 30, no. 1, pp. 70–81, Mar. 2015.\n[20] Y . Chen et al. , “Fast reactive power sharing, circulating current and\nresonance suppression for parallel inverters using resistive-capacitive\noutput impedance,” IEEE Trans. Power Electron. , vol. 31, no. 8,\npp. 5524–5537, Aug. 2016.\n[21] J. He and Y . W. Li, “Analysis, design, and implementation of virtual\nimpedance for power electronics interfaced distributed generation,”IEEE\nTrans. Ind. Appl. , vol. 47, no. 6, pp. 2525–2538, Nov./Dec. 2011.\n[22] D. Yang, X. Ruan, and H. Wu, “Impedance shaping of the grid-connected\ninverter with LCL ﬁlter to improve its adaptability to the weak grid\ncondition,” IEEE Trans. Power Electron., vol. 29, no. 11, pp. 5795–5805,\nNov. 2014.\n[23] X. Wang, F. Blaabjerg, and W. Wu, “Modeling and analysis of harmonic\nstability in an AC power-electronics-based power system,” IEEE Trans.\nPower Electron., vol. 29, no. 12, pp. 6421–6432, Dec. 2014.\n[24] R. Turner, S. Walton, and R. Duke, “Stability and bandwidth impli-\ncations of digitally controlled grid-connected parallel inverters,” IEEE\nTrans. Ind. Electron., vol. 57, no. 11, pp. 3685–3694, Nov. 2010.\n[25] Q.-C. Zhong, G. C. Konstantopoulos, B. Ren, and M. Krstic,\n“Improved synchronverters with bounded frequency and voltage for\nsmart grid integration,” IEEE Trans. Smart Grid , to be published,\ndoi: 10.1109/TSG.2016.2565663.\n[26] C. Dufour and J. Bélanger, “On the use of real-time simulation technol-\nogy in smart grid research and development,” IEEE Trans. Ind. Appl. ,\nvol. 50, no. 6, pp. 3963–3970, Nov./Dec. 2014.\n[27] S. Sanchez and M. Molinas, “Degree of inﬂuence of system states tran-\nsition on the stability of a DC microgrid,” IEEE Trans. Smart Grid ,\nvol. 5, no. 5, pp. 2535–2542, Sep. 2014.\n[28] L. Xu, L. Fan, and Z. Miao, “DC impedance-model-based resonance\nanalysis of a VSC–HVDC system,” IEEE Trans. Power Del. , vol. 30,\nno. 3, pp. 1221–1230, Jun. 2015.\n[29] M. A. Azzouz and E. F. El-Saadany, “Multivariable grid admit-\ntance identiﬁcation for impedance stabilization of active distri-\nbution networks,” IEEE Trans. Smart Grid , to be published,\ndoi: 10.1109/TSG.2015.2476758.\n[30] S. Sanchez and M. Molinas “Large signal stability analysis at the com-\nmon coupling point of a DC microgrid: A grid impedance estimation\napproach based on a recursive method”, IEEE Trans. Energy Convers. ,\nvol. 30, no. 1, pp. 122–131, Mar. 2015.\n[31] M. Hamzeh, M. Ghafouri, H. Karimi, K. Sheshyekani, and\nJ. M. Guerrero, “Power oscillations damping in DC microgrids,” IEEE\nTrans. Energy Convers., vol. 31, no. 3, pp. 970–980, Sep. 2016.\nQing Ye (S’14) received the B.S. and M.S.\ndegrees in electrical engineering from the Huazhong\nUniversity of Science and Technology, China,\nin 2010 and 2013, respectively. He is currently\npursuing the Ph.D. degree with the Center for\nAdvanced Power Systems, Florida State University,\nTallahassee, FL, USA.\nHis research interests include the instability,\npower quality, and power sharing issues in power\nelectronics-based power systems.\nRan Mo (S’14) received the B.S. degree from\nSoutheast University, Nanjing, China, in 2010, and\nthe M.S. degree from the Huazhong University of\nScience and Technology, Wuhan, China, in 2013,\nboth in electrical engineering. She is currently pur-\nsuing the Ph.D. degree with the Department of\nElectrical and Computer Engineering, Florida State\nUniversity, Tallahassee, FL, USA.\nHer research interests include modular multilevel\nconverters and hardware-in-the-loop simulation.\nHui Li (S’97–M’00–SM’01) received the B.S. and\nM.S. degrees in electrical engineering from the\nHuazhong University of Science and Technology,\nChina, in 1992 and 1995, respectively, and the\nPh.D. degree in electrical engineering from the\nUniversity of Tennessee, Knoxville, in 2000. She\nis currently a Professor with the Electrical and\nComputer Engineering Department, Florida A&M\nUniversity—Florida State University College of\nEngineering, Tallahassee, FL, USA.\nHer research interests include PV converters,\nenergy storage applications, and smart grid.",
  "topic": "Microgrid",
  "concepts": [
    {
      "name": "Microgrid",
      "score": 0.9054770469665527
    },
    {
      "name": "Inverter",
      "score": 0.6159499883651733
    },
    {
      "name": "Control theory (sociology)",
      "score": 0.6138988733291626
    },
    {
      "name": "Electrical impedance",
      "score": 0.6001604199409485
    },
    {
      "name": "Transformer",
      "score": 0.5870234966278076
    },
    {
      "name": "Automatic frequency control",
      "score": 0.5393286943435669
    },
    {
      "name": "Engineering",
      "score": 0.4009665250778198
    },
    {
      "name": "Electronic engineering",
      "score": 0.3951793313026428
    },
    {
      "name": "Computer science",
      "score": 0.38578248023986816
    },
    {
      "name": "Electrical engineering",
      "score": 0.18982261419296265
    },
    {
      "name": "Voltage",
      "score": 0.18954631686210632
    },
    {
      "name": "Control (management)",
      "score": 0.09513157606124878
    },
    {
      "name": "Artificial intelligence",
      "score": 0.0
    }
  ],
  "institutions": [
    {
      "id": "https://openalex.org/I103163165",
      "name": "Florida State University",
      "country": "US"
    }
  ],
  "cited_by": 39
}