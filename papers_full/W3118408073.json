{
  "title": "Estimation of Impedance Ratio Parameters for Consistent Modeling of Tap-Changing Transformers",
  "url": "https://openalex.org/W3118408073",
  "year": 2021,
  "authors": [
    {
      "id": "https://openalex.org/A2696006043",
      "name": "Md Rejwanur R. Mojumdar",
      "affiliations": [
        "ABB (Norway)"
      ]
    },
    {
      "id": "https://openalex.org/A2308060032",
      "name": "Jose M. Cano",
      "affiliations": [
        "Universidad de Oviedo"
      ]
    },
    {
      "id": "https://openalex.org/A4200936394",
      "name": "Gonzalo A. Orcajo",
      "affiliations": [
        "Universidad de Oviedo"
      ]
    },
    {
      "id": "https://openalex.org/A2696006043",
      "name": "Md Rejwanur R. Mojumdar",
      "affiliations": []
    },
    {
      "id": "https://openalex.org/A2308060032",
      "name": "Jose M. Cano",
      "affiliations": [
        "ABB (Norway)",
        "Universidad de Oviedo"
      ]
    },
    {
      "id": "https://openalex.org/A4200936394",
      "name": "Gonzalo A. Orcajo",
      "affiliations": [
        "Universidad de Oviedo"
      ]
    }
  ],
  "references": [
    "https://openalex.org/W2156275402",
    "https://openalex.org/W2520864676",
    "https://openalex.org/W2782755290",
    "https://openalex.org/W2129571213",
    "https://openalex.org/W2142877134",
    "https://openalex.org/W6662354583",
    "https://openalex.org/W2905752394",
    "https://openalex.org/W2973011262",
    "https://openalex.org/W3148176547",
    "https://openalex.org/W1598852905",
    "https://openalex.org/W6788166943",
    "https://openalex.org/W2112110498",
    "https://openalex.org/W2114060819",
    "https://openalex.org/W2024144152",
    "https://openalex.org/W3117510149",
    "https://openalex.org/W1607032092",
    "https://openalex.org/W2046839189",
    "https://openalex.org/W1495373176",
    "https://openalex.org/W3146624056"
  ],
  "abstract": "Recent contributions have shown that two widely used formulations of the tap-changing transformer model are controversial, as they generate dissimilar results depending on the selected tap and operating point. In recent works, the authors proposed a new model and demonstrated its consistency to reconcile this debate. It introduces a parameter which stands for the ratio between the impedances of the nominal and tapped winding of the transformer. However, this parameter is not provided with and cannot be obtained from standard datasheets, which compels the users to rely on rough approximations. To overcome this problem, an offline state-vector-augmented parameter estimation method capable of providing accurate estimates of transformer impedance ratios is proposed in this work. It is demonstrated that their use can effectively lead state estimators to better estimates of system states. This work also contributes with the derivatives of the different measurement functions in terms of the impedance ratios, which are essential for this or any other linearized state estimator. A multi-snapshot implementation is used to obtain a twofold advantage - increased measurement redundancy and improved accuracy of the estimated parameters. A detailed formulation of the implementation and several case studies are presented to demonstrate the validity of the proposal.",
  "full_text": "3282 IEEE TRANSACTIONS ON POWER SYSTEMS, VOL. 36, NO. 4, JULY 2021\nEstimation of Impedance Ratio Parameters for\nConsistent Modeling of Tap-Changing Transformers\nMd Rejwanur R. Mojumdar , Graduate Student Member, IEEE ,J o s éM .C a n o , Senior Member, IEEE ,\nand Gonzalo A. Orcajo , Member, IEEE\nAbstract—Recent contributions have shown that two widely used\nformulations of the tap-changing transformer model are controver-\nsial, as they generate dissimilar results depending on the selected\ntap and operating point. In recent works, the authors proposed\na new model and demonstrated its consistency to reconcile this\ndebate. It introduces a parameter which stands for the ratio be-\ntween the impedances of the nominal and tapped winding of the\ntransformer. However, this parameter is not provided with and\ncannot be obtained from standard datasheets, which compels the\nusers to rely on rough approximations. To overcome this problem,\nan ofﬂine state-vector-augmented parameter estimation method\ncapable of providing accurate estimates of transformer impedance\nratios is proposed in this work. It is demonstrated that their use can\neffectively lead state estimators to better estimates of system states.\nThis work also contributes with the derivatives of the different\nmeasurement functions in terms of the impedance ratios, which are\nessential for this or any other linearized state estimator. A multi-\nsnapshot implementation is used to obtain a twofold advantage —\nincreased measurement redundancy and improved accuracy of the\nestimated parameters. A detailed formulation of the implemen-\ntation and several case studies are presented to demonstrate the\nvalidity of the proposal.\nIndex Terms —Maximum likelihood estimation, parameter\nestimation, power transformers, tap changers, transformer models.\nI. I NTRODUCTION\nS\nEVERAL power system studies, such as power ﬂow (PF),\noptimal power ﬂow (OPF) or state estimation (SE), are\ncrucial today to ensure safety and optimality in the operation of\nmodern grids. In this context, tap-changing transformers serve\nat the vanguard for voltage regulation in power systems, and\nthus, accurate models of these devices are needed when they are\npresent in the network under study.\nThe two most widely spread tap-changing transformer models\nfound both in literature and software packages [1], [2] have\nManuscript received June 3, 2020; revised October 16, 2020 and December\n24, 2020; accepted January 2, 2021. Date of publication January 12, 2021; date of\ncurrent version June 18, 2021. This work was supported by the Spanish Govern-\nment Innovation Development, and Research Ofﬁce (MEC) under research Grant\nDPI2017-89186-R. Paper no. TPWRS-00922-2020. (Corresponding author:\nJosé M. Cano.)\nMd Rejwanur R. Mojumdar is with the Electrical Control Sys-\ntem Department, ABB AS, 4033 Stavanger, Norway (e-mail: rejwanur-\nrashid.mojumdar@no.abb.com).\nJosé M. Cano and Gonzalo A. Orcajo are with the Department of\nElectrical Engineering, University of Oviedo, 30013 Gijón, Spain (e-mail:\njmcano@uniovi.es; gonzalo@uniovi.es).\nColor versions of one or more ﬁgures in this article are available at https:\n//doi.org/10.1109/TPWRS.2021.3050958.\nDigital Object Identiﬁer 10.1109/TPWRS.2021.3050958\nbeen demonstrated to be inconsistent [3]–[5]. One of the models\nassumes that the transformer impedance, obtained through the\nwell-known short-circuit test, is totally provided by the nominal\nwinding, whereas the other model allocates it exclusively at the\noff-nominal side. This fact was ﬁrst reported in [3]; however,\nthe authors of this work selected one of the alternatives and\nproposed a method to shape the other so as to converge into the\nsame results. Later, in [4], [5], it was established that, while\nthe two models produce similar results near the central tap,\nthey lead to signiﬁcant differences at extreme tap positions.\nThe power factor of the power ﬂowing through the transformer\nprimarily determines whether this divergence appears in voltage\nmagnitude or phase angle. Analytical formulations and case\nstudies demonstrating this inconsistency are presented in the\naforementioned references.\nTo reconcile this dispute, the authors proposed a consistent\nmodel which reﬂects that the short-circuit impedance is in\nfact shared by both sides of the transformer [4], [5]. The new\nmodel introduces a parameter, k, which stands for the per-unit\n(p.u.) impedance ratio between the nominal winding and tapped\nwinding of the tap-changing transformer. However, admittedly,\nthe user cannot obtain the value of this parameter from stan-\ndard transformer data sheets or even through straight-forward\ncalculations. In response to that, the authors argued and demon-\nstrated that if this parameter is not available, assuming k = 1,\ni.e. considering an equal share of the p.u. impedance at both\nsides of the transformer, produces results which minimizes the\nmaximum expected error. Nonetheless, the authors pointed out\nthat, to achieve accurate results, the p.u. impedance ratio could be\nobtained in real scenarios from the application of SE techniques.\nIn fact, this is the main purpose of the present proposal.\nIn a broad classiﬁcation, SE methods are either recursive or\nstatic. However, static state estimators constitute a compara-\ntively mature technology widely used by utilities for power\nsystem monitoring. While there are other possibilities, most\nof the static estimators minimize the weighted least squares\n(WLS) of residuals from a single snapshot of measurements\nto provide estimates of the current states of the system [6],\n[7]. For static SE, several alternative formulations are available\nin literature in order to overcome some deﬁciencies of the\nseminal algorithms, increasing numerical capabilities or adding\nsome practical advantages. Many of these formulations are well\ndocumented in [6], [7]. In the present proposal, a widely used\nand suitable WLS-based formulation is extended further to cope\nwith the objectives of this work.\nThis work is licensed under a Creative Commons Attribution 4.0 License. For more information, see https://creativecommons.org/licenses/by/4.0/\nMOJUMDAR et al. : ESTIMATION OF IMPEDANCE RATIO PARAMETERS FOR CONSISTENT MODELING OF TAP-CHANGING TRANSFORMERS 3283\nIn addition to providing estimates of the state variables, other\nfunctions and associated routines are integral parts of power\nsystem state estimators, such as observability analysis, bad\ndata detection and identiﬁcation, topology error processing and\nparameter estimation. Among these, the latter can be pointed\nout as the key tool to address the problem of estimating the\np.u. impedance ratios of tap-changing transformers. Network\nparameter estimation methods are broadly classiﬁed in two\ngroups-residual sensitivity-based analysis and state vector aug-\nmentation [6]. Residual sensitivity-based analysis is efﬁcient\nfor parameter error identiﬁcation which is not required for\nthe purpose of this work, as transformer impedance ratios are\nobjectively included in the suspicious set. As the name suggests,\nin state vector augmentation methods, the suspected param-\neters are included in the state vector and estimated together\nwith the system state variables [8]–[13]. Importantly, for the\nsole purpose of parameter estimation, state vector augmentation\nmethods are considered to deliver superior performance due to\nthe fact that all the surrounding measurements get involved in\nthe estimation [14]. Therefore, the state vector augmentation\nmethod has been selected and implemented in this proposal to\nprovide accurate estimates of the parameters of interest.\nThe estimation of transformer tap positions has been a central\nissue for parameter estimation methods in power systems [10],\n[13]. In fact, estimation of unmeasured or erroneous transformer\ntaps is today a regular or online function of state estimators.\nOn the contrary, due to the non-varying nature of impedance\nratio parameters, which may change only in the event of a fault\nor a complete replacement of a transformer, their estimation is\nrequired in very long intervals. It is not worth including the\nestimation of these parameters in an online state estimator, as\nthis may deteriorate the performance of the algorithm in terms\nof speed without a practical improvement. Therefore, an ofﬂine\nparameter estimator, designed to be run periodically, with a low\ncadence, is proposed in this work. In this concept, the online\nestimator used in the operation of the grid is in charge of the\nestimation of transformer tap positions at each snapshot; then,\nthe ofﬂine parameter estimator, executed in long time periods,\nuses those tap positions together with the raw measurements at\ndifferent snapshots to provide accurate estimates of the trans-\nformer impedance ratios. Certainly, the updated estimates of\nthese parameters can now be fed into the online state estimator\nto increase its accuracy, as a consequence of the improvement\nof the model.\nFinally, it is important to discuss the potential hindrances of\nassessing the transformer p.u. impedance ratios through param-\neter estimation techniques. If a large number of tap-changing\ntransformers are embedded in the grid under study, the new\nvariables to be included in the augmented state vector could\nsigniﬁcantly deteriorate the redundancy of the measurements.\nMoreover, as in any other SE application, the noise of ﬁeld\nmeasurements has an impact on the quality of the estimation of\nthe parameters. However, even more important for this particular\nproblem is that the sensitivity of the measurement functions\nwith respect to p.u. impedance ratios are signiﬁcantly lower\nthan the sensitivities with respect to the other state variables.\nAs a consequence, measurement noise is likely to conceal the\nFig. 1. Model of the tap-changing transformer with short-circuit impedance\nat the off-nominal turns side.\nFig. 2. Two-port π-model of a tap-changing transformer or a network branch.\nbiases of erroneous estimation of impedance ratios throughout\nthe process. The above-mentioned difﬁculties turn the estimation\nof the desired transformer parameters into a challenging task.\nNonetheless, one expedient feature of transformer impedance\nratios can help to overcome these obstacles: they can be consid-\nered time-invariant, at least for a reasonable time span. Thus,\nthe method proposed in this work can be fed with multiple\nsnapshots of measurements, i.e. with historical data collected\nalong a reasonable time period. Multi-snapshots usage has clear\nadvantages in parameter estimation, as has been previously re-\nported by other authors [6], [9], [11]. Therefore, a multi-snapshot\nimplementation has been embraced in this proposal.\nIn Section II, the consistent tap-changing transformer model,\nand thereby, the emergence of the impedance ratio parameter,\nis presented for the beneﬁt of the reader. Then, an advanta-\ngeous equality-constrained SE method is brieﬂy described in\nSection III. Section IV articulates the derivation and integration\ndetails of the estimation of p.u. impedance ratios. A set of case\nstudies are included in Section V to validate and demonstrate\nthe advantages of the proposal. Finally, the conclusions of this\nstudy are gathered in Section VI.\nII. C ONSISTENT TAP-CHANGING TRANSFORMER MODEL\nLet us consider a tap-changing transformer with off-nominal\nturns ratio a :1 as depicted in Fig. 1. Like any network branch\nor in-phase transformer, a tap-changing transformer can be\nrepresented as a π-equivalent model, as shown in Fig. 2. The\nπ-equivalent model possesses two shunt branches which induce\nno effect while the transformer is operated at its nominal turns\nratio. However, tap-changing transformers are often operated\nat off-nominal turn ratios for voltage regulation purposes, and\nthus, the shunt branches of their π-equivalent model cannot be\nneglected.\nAs discussed in Section I, the consistent model of the tap-\nchanging transformer was introduced in [4], [5] to reconcile the\ninconsistency between two widespread models. The new consis-\ntent model states that the off-nominal short-circuit admittance\n3284 IEEE TRANSACTIONS ON POWER SYSTEMS, VOL. 36, NO. 4, JULY 2021\nat the off-nominal turns side can be calculated as\nyoff\nsc = 1\nz1 +a2z2\n= 1+ k\n1+ ka2 ysc, (1)\nwhere ysc represents the p.u. admittance of the transformer,\nobtained through the short-circuit test and always provided as\nnameplate data. Parameter k is introduced in [4] to denote the\np.u. impedance ratio between the nominal winding, z2, and\ntapped winding, z1. Classical transformer models assume ex-\ntreme values of this parameter ( k=0 and k=∞). The elements\nof the bus admittance matrix for the consistent tap-changing\ntransformer model are derived in [4], [5] as\nYii = 1+ k\n1+ ka2 ysc, (2)\nYij = Yji = −a(1+ k)\n1+ ka2 ysc, (3)\nYjj = a2(1+ k)\n1+ ka2 ysc. (4)\nThen, the parameters of the π-model can be straightforwardly\nobtained as\nyij = −Yij = a(1+ k)\n1+ ka2 ysc, (5)\nysi = Yii +Yij = (1−a)(1+ k)\n1+ ka2 ysc, (6)\nysj = Yjj +Yij = a(a−1)(1+ k)\n1+ ka2 ysc. (7)\nAn unresolved issue of the consistent model is that the\nparticular value of the p.u. impedance ratio, k, for a speciﬁc\ntap-changing transformer is a constructive parameter normally\nunknown for the user. Therefore, the accuracy and consistency of\nthe results of power system studies with embedded tap-changing\ntransformers can be obviously improved if the actual value of k\nis determined through a parameter estimation process utilizing\nhistorical sets of measurements. Thus, the estimation of k is\npursued in the present proposal.\nIII. E QUALITY-CONSTRAINED SE\nThe Normal Equations (NE) formulation of WLS SE in their\napplication to power system studies may lead to some well-\nknown problems, such as ill-conditioning or divergence. This\nis especially critical when using zero-injection buses as virtual\nmeasurements. Therefore, several proposals have been made to\novercome the shortcomings of the basic NE formulation [6].\nAmong these propositions, appear numerical techniques such\nas the Lower Upper (LU) factorization and orthogonal (QR)\nfactorization of the gain matrix. More advantageously, there are\nsome restructured formulations called equality-constrained SE\nwhich take advantage of the Lagrangian of equality-constrained\noptimization problems [6], [15]. In the present work, an equality-\nconstrained SE algorithm called augmented matrix method [6],\n[16] was extended to the particular parameter estimation prob-\nlem of interest. In this method, both the virtual and regular\nmeasurement equations are taken as equality constraints in order\nto improve the condition number of the Hachtel’s matrix. Ac-\ncording to this method, the following set of linearized equations\ndescribes the SE problem\n⎡\n⎢⎣\nRH 0\nHT 0 CT\n0 C 0\n⎤\n⎥⎦\n⎡\n⎢⎣\nμ\nΔx\nλ\n⎤\n⎥⎦ =\n⎡\n⎢⎣\nΔz\n0\n−c(x)\n⎤\n⎥⎦, (8)\nwhere,\nr R is the covariance matrix having variances of regular\nmeasurement errors at its diagonal elements,\nr H is the matrix for derivatives of regular measurements,\nr C is the matrix for derivatives of virtual measurements,\nr μ is the vector of Lagrange multipliers for regular mea-\nsurements,\nr λ is the vector of Lagrange multipliers for virtual measure-\nments,\nr Δx is the vector for deviations of state variables,\nr Δz is the vector for measurement residuals, i.e., the differ-\nence between regular ﬁeld measurements and their theoret-\nical values calculated from the current estimation of state\nvariables,\nr and c(x) is the vector for virtual measurement residuals.\nIV . E STIMATION OF TRANSFORMER IMPEDANCE RATIOS\nMost SE methods are linearized formulations which require\nthe derivatives of the measurement functions, h, in terms of the\nstate variables. As power system static SE is a well-developed\nand mature technique, the derivatives of general measurement\nfunctions in terms of commonly used state variables and param-\neters are widely used and readily available in the literature [6].\nHowever, the consistent tap-changing transformer model is a\nstate-of-the-art concept which has not been implemented be-\nfore in power system SE algorithms. Hence, no work has yet\nintroduced the derivatives of measurement functions in terms of\nthe impedance transformer ratio, k, which are required for the\nestimation of these parameters.\nIn a standard SE formulation, the state vector, x, includes\nbus voltage magnitudes, V, and phase angles, θ, except for\nthe phase angle reference, as state variables. In this proposal,\nthe state vector is augmented by including the k parameters\nof the tap-changing transformers embedded in the network\nunder study. Thus, as an important contribution of this work,\nthe derivatives of general ﬁeld measurement types such as bus\nvoltage magnitudes, active and reactive bus power injections\nand active and reactive branch power ﬂows, in terms of the\nimpedance ratio, are presented. These derivatives are crucial\nfor the construction of both the H and C matrices included in\n(8). Finally, for the problem-speciﬁc requirements, the authors\nhave integrated these new derivatives into a single snapshot and\na multi-snapshot augmented matrix SE algorithm.\nA. Derivatives of Measurement Functions in Terms of k\n1) Bus Voltage Magnitudes: The measurement function of\nvoltage magnitude at bus i reduce itself to its corresponding\nvoltage magnitude, Vi, which is a state variable on its own.\nMOJUMDAR et al. : ESTIMATION OF IMPEDANCE RATIO PARAMETERS FOR CONSISTENT MODELING OF TAP-CHANGING TRANSFORMERS 3285\nTherefore, these functions are independent of tap-changing\ntransformer impedance ratios, k. So, it can be stated that\n∂Vi\n∂k =0 . (9)\n2) Power Injections: The measurement functions for the ac-\ntive and reactive power injections, Pi and Qi, at a speciﬁc bus i,\nare well-known in power system analysis, being formulated as\nPi = Vi\nN∑\nn=1\nVn[Gin cosθin +Bin sinθin], (10)\nQi = Vi\nN∑\nn=1\nVn[Gin sinθin −Bin cosθin], (11)\nwhere n stands for each of the total number of buses in the\nnetwork, N. Likewise, Gin, Bin are the conductance and sus-\nceptance of the element Yin of the system bus admittance matrix.\nFinally, θin stands for the phase angle between buses i and n.\nAs it can be immediately concluded from (10) and (11), if\nbus i is not directly connected to a tap-changing transformer,\nnone of the terms of these equations depend on the impedance\nratio of that speciﬁc device. Thus, the derivatives of those active\nand reactive power injections in terms of the impedance ratio\nof that transformer equal zero. On the other hand, if there\nis a tap-changing transformer located between buses i and j,\nwith an impedance ratio k, the admittance of the transformer\nimpacts the calculation of power injections through the addends\ncorresponding to n = i and n = j. Thus, the parts of Pi and\nQi impacted by k, which are the only ones of interest for the\ncalculation of the derivatives, can be designated as Pk\ni and Qk\ni\nand may be evaluated as\nPk\ni = V2\ni Gk\nii +ViVj[Gij cosθij +Bij sinθij], (12)\nQk\ni = −V2\ni Bk\nii +ViVj[Gij sinθij −Bij cosθij], (13)\nwhere, Gk\nii and Bk\nii contain the addends of the diagonal elements\nof the bus admittance matrix which are a function of k, i.e. those\nprovided by the series and shunt branch of the tap-changing\ntransformer model connected at bus i.\nAt this point, two cases should be taken into consideration.\nOn the one hand, if the tapped winding of the transformer is\nconnected to bus i, as depicted in Fig. 1, (2) and (3) allow to\nexpress the elements of the bus admittance matrix in (12) and\n(13) as a function of kand the conductance, gsc, and susceptance,\nbsc, of the short-circuit admittance, ysc, of the transformer. Thus,\nGk\nii = 1+ k\n1+ ka2 gsc,B k\nii = 1+ k\n1+ ka2 bsc, (14)\nGij = −a(1+ k)\n1+ ka2 gsc,B ij = −a(1+ k)\n1+ ka2 bsc. (15)\nThe substitution of (14) and (15) in (12) and (13) leads to\nPk\ni = 1+ k\n1+ ka2\n[\nV2\ni gsc −aViVj (gsc cosθij +bsc sinθij)\n]\n,\n(16)\nQk\ni = 1+ k\n1+ ka2\n[\n−V2\ni bsc −aViVj (gsc sinθij −bsc cosθij)\n]\n.\n(17)\nBy applying the quotient rule to (16) and (17), the derivatives of\nPi and Qi in terms of k can be obtained as\n∂Pi\n∂k = 1+ ka2 −a2(1+ k)\n(1+ ka2)2\n×...\n[\nV2\ni gsc −aViVj (gsc cosθij +bsc sinθij)\n]\n,\n(18)\n∂Qi\n∂k = 1+ ka2 −a2(1+ k)\n(1+ ka2)2\n×...\n[\n−V2\ni bsc −aViVj (gsc sinθij −bsc cosθij)\n]\n.\n(19)\nOn the other hand, if bus i is connected to the untapped\nwinding of the transformer, (4) should be used instead of (2)\nto formulate the diagonal elements of the bus admittance matrix\nimpacted by k, Gk\nii and Bk\nii, in (12) and (13). Thus,\nGk\nii = a2(1+ k)\n1+ ka2 gsc,B k\nii = a2(1+ k)\n1+ ka2 bsc. (20)\nThe substitution of (15) and (20) in (12) and (13) leads to\nPk\ni = a(1+ k)\n1+ ka2\n[\naV2\ni gsc −ViVj (gsc cosθij +bsc sinθij)\n]\n,\n(21)\nQk\ni = a(1+ k)\n1+ ka2\n[\n−aV2\ni bsc −ViVj (gsc sinθij −bsc cosθij)\n]\n.\n(22)\nAnd the derivatives of Pi and Qi in terms of k in this second\ncase turn out to be\n∂Pi\n∂k = a(1+ ka2)−a3(1+ k)\n(1+ ka2)2\n×...\n[\naV2\ni gsc −ViVj (gsc cosθij +bsc sinθij)\n]\n,\n(23)\n∂Qi\n∂k = a(1+ ka2)−a3(1+ k)\n(1+ ka2)2\n×...\n[\n−aV2\ni bsc −ViVj (gsc sinθij −bsc cosθij)\n]\n.\n(24)\n3) Power Flows: Note that the π-equivalent model depicted\nin Fig. 2 is not only valid for a tap-changing transformer but also\nfor a line. Thus, the measurement functions of active and reactive\npower, Pij, Qij,ﬂ o w i n gf r o mb u sito bus j and measured at the\nsending end can be expressed for both types of elements as\nPij = V2\ni (gsi +gij)−ViVj(gij cosθij +bij sinθij), (25)\nQij = −V2\ni (bsi +bij)−ViVj(gij sinθij −bij cosθij),(26)\nwhere, gsi and bsi are the conductance and susceptance of the\nshunt leg at bus i, and gij and bij stand for the conductance and\nsusceptance of the series admittance.\n3286 IEEE TRANSACTIONS ON POWER SYSTEMS, VOL. 36, NO. 4, JULY 2021\nFrom (25) and (26), it can be immediately concluded that, if\na power ﬂow measurement between the adjacent buses i and j\ndoes not ﬂow through a tap-changing transformer, none of the\nelements of these equations are affected by the impedance ratio\nof the device. Thus, the derivatives of those active or reactive\npower ﬂows in terms of the k equal zero. However, when a tap-\nchanging transformer connects buses iand j, the admittances in\nthose equations are a function of the impedance ratio, k.A g a i n ,\ntwo different cases need to be addressed. On the one hand, if\nthe measuring location, i.e. bus i, is connected to the tapped\nwinding, as in Fig. 1, the conductances and susceptances can be\ndirectly taken from (5) and (6). Thus,\ngsi +gij = 1+ k\n1+ ka2 gsc,b si +bij = 1+ k\n1+ ka2 bsc, (27)\ngij = a(1+ k)\n1+ ka2 gsc,b ij = a(1+ k)\n1+ ka2 bsc. (28)\nThe substitution of (27) and (28) in (25) and (26) leads to\nPij = 1+ k\n1+ ka2\n[\nV2\ni gsc −aViVj (gsc cosθij +bsc sinθij)\n]\n,\n(29)\nQij = 1+ k\n1+ ka2\n[\n−V2\ni bsc −aViVj (gsc sinθij −bsc cosθij)\n]\n.\n(30)\nBy applying the quotient rule to (29) and (30), the derivatives of\nPij and Qij in terms of k can be obtained as\n∂Pij\n∂k = 1+ ka2 −a2(1+ k)\n(1+ ka2)2\n×...\n[\nV2\ni gsc −aViVj (gsc cosθij +bsc sinθij)\n]\n,\n(31)\n∂Qij\n∂k = 1+ ka2 −a2(1+ k)\n(1+ ka2)2\n×...\n[\n−V2\ni bsc −aViVj (gsc sinθij −bsc cosθij)\n]\n.\n(32)\nOn the other hand, if the measuring location, i.e. bus i,i s\nconnected to the untapped winding, (7) should be used instead\nof (6) to obtain the conductances and susceptances used in (29)\nand (30). Thus,\ngsi +gij = a2(1+ k)\n1+ ka2 gsc,b si +bij = a2(1+ k)\n1+ ka2 bsc. (33)\nThe substitution of (28) and (33) in (29) and (30) leads to\nPij = a(1+ k)\n1+ ka2\n[\naV2\ni gsc −ViVj (gsc cosθij +bsc sinθij)\n]\n,\n(34)\nQij = a(1+ k)\n1+ ka2\n[\n−aV2\ni bsc −ViVj (gsc sinθij −bsc cosθij)\n]\n.\n(35)\nFig. 3. Formation of the augmented Jacobian matrices for a single snapshot.\n(a) H matrix, and (b) C matrix.\nAnd the derivatives of Pij and Qij in terms of k in this second\ncase can be expressed as\n∂Pij\n∂k = a(1+ ka2)−a3(1+ k)\n(1+ ka2)2\n×...\n[\naV2\ni gsc −ViVj (gsc cosθij +bsc sinθij)\n]\n,\n(36)\n∂Qij\n∂k = a(1+ ka2)−a3(1+ k)\n(1+ ka2)2\n×...\n[\n−aV2\ni bsc −ViVj (gsc sinθij −bsc cosθij)\n]\n.\n(37)\nB. Formation of Jacobian Matrices for the SE Process\nIn the formulation of the augmented matrix approach for\nSE [6], [15], the derivatives of the hz–functions of a set of L\nregular measurements, zr,r e s i d ei nt h e H matrix, while the\nderivatives of the cz–functions of a set of M virtual measure-\nments, zv, reside in the C matrix shown in (8). Both matrices\nare augmented in this proposal with a new set of state variables,\nk, corresponding to the transformer impedance ratios of the T\ntapped-transformers embedded in the grid under study.\nIf the estimation of k is carried out considering just a single\nsnapshot of measurements, the extension of the Jacobian matri-\nces is rather straightforward. In this case, a new column has to be\nadded, both to the H and C matrices, to account for each of the\nT elements of k. Thus, the use of the new derivatives described\nin Section IV-A together with the classical set [6], allows to\nform the augmented H and C matrices as depicted in Fig. 3.\nNotice that in this ﬁgure and w.l.o.g, the phase angle at bus 1,\nθ1, has been taken as reference, and thus, excluded from the set of\nMOJUMDAR et al. : ESTIMATION OF IMPEDANCE RATIO PARAMETERS FOR CONSISTENT MODELING OF TAP-CHANGING TRANSFORMERS 3287\nstate variables. This is a similar approach to other augmentation\ntechniques such as those previously presented in [8]–[13].\nAccording to Fig. 3, two parts can be distinguished in the new\nH and C matrices: H1 and C1, that account for the derivatives\nof regular and virtual measurements with respect to the conven-\ntional state variables, and H1k and C1k, that hold the derivatives\nof regular and virtual measurements in terms of the transformer\nimpedance ratios, k. The ﬁnal H and C matrices are formed by\nhorizontal concatenation of H1, H1k and C1, C1k respectively.\nThe difﬁculties of estimating the p.u. impedance ratios of tap-\nchanging transformers from a single snapshot of measurements\nhave been previously discussed in Section I. As it was pointed\nout, an adaptation of a multi-snapshot of measurements is pro-\nposed in this work to overcome those obstacles. This is a suitable\napproach for the estimation of the parameters under study, which\ncan be considered time-invariant during long periods. Indeed,\nparameter estimation, conducted as an ofﬂine task, can sacriﬁce\ncomputation time in favor of the accuracy of the estimation.\nIn SE theory, measurement redundancy is deﬁned as the ratio\nbetween the number of measurements and the number of state\nvariables. Hence, as L is the number of regular measurements\nand M is the number of virtual measurements, the base case\nredundancy of the problem, ε0, i.e., the one in which p.u.\nimpedance ratios are not included as state variables, can be\ncalculated as\nε0 = L+M\n2N −1. (38)\nIn a single snapshot or multi-snapshot implementation of the\naugmented problem, in which Qsnapshots and T time-invariant\ntransformer impedance ratios are included as additional state\nvariables, the redundancy level is deteriorated according to\nεQ = Q(L+M)\nQ(2N −1)+ T = L+M\n2N −1+ T\nQ\n. (39)\nFrom (39), it can be concluded that, increasing the number\nof snapshots in the estimation process, allows to move the\nredundancy level of the augmented problem as close as desired\nto the redundancy of the base case. Thus, provided that a suf-\nﬁcient number of snapshots are included into the problem, the\napplication of the augmented approach cannot be blamed for\ndeteriorating the redundancy level.\nThe formation of the augmented matrices, H and C,f o r\nthe case of the multi-snapshot problem is depicted in Fig. 4.\nEach snapshot q involves a speciﬁc set of conventional state\nvariables, [Vθ ]q, together with a speciﬁc set of h–functions,\n[hzr]q, and c–functions, [czv]q, associated with regular and\nvirtual measurements, respectively. Notice that the conventional\nstate variables change at each snapshot but the augmented ones,\nk, remain always the same. Thus, the parts of the Jacobian\nmatrices linked to conventional state variables are augmented\ndiagonally by means of Hq and Cq, while the parts associated\nwith the transformer impedance ratios are augmented vertically\nby means of Hqk and Cqk.\nIt is worth noting that, in order to apply (8) in the multisnap-\nshot context, the covariance matrix, R, should be formed by\ndiagonal augmentation of the respective covariance matrices of\nFig. 4. Formation of the augmented Jacobian matrices in a multi-snapshot\nproblem. (a) H matrix, and (b) C matrix.\neach snapshot. Likewise, Δz and Δx vectors are respectively\nformed by vertical concatenation of measurement residuals and\nstate variable deviations from each snapshot.\nEquation (8) can now be iteratively solved to provide es-\ntimates of the full set of state variables. Among them, the\nﬁnal values of k constitute the estimated parameters of the p.u.\nimpedance ratios of the tap-changing transformers.\nC. Treatment of Bad Data\nThe treatment of bad data is a crucial concern for any state\nestimator. However, as it is pointed out in Section I, the parameter\nestimator proposed in this work is designed to work ofﬂine. Thus,\nit uses historical data comprised of measurement snapshots in\nwhich any possible bad data has been already detected, identiﬁed\nand removed by the online state estimator used in the operation\nof the grid. Of course, removal of bad data may reduce the\nredundancy of the measurement set. However, as it is shown in\nthe case studies presented in Section V, the proposed algorithm\nconverges to the solution even in low redundancy scenarios.\nIn summary, as the bad data is pre-treated by the online state\nestimator, the proposed ofﬂine parameter estimator does not\nneed further ﬁltering of the input measurements.\nNevertheless, it is interesting to point out that model inaccu-\nracies, such as those that may appear during the initialization\nprocess (i.e. when k = 1 is adopted as an educated guess of\nthe transformer impedance ratios), can lead the online state\nestimator to an undesired removal of measurements (erroneously\nﬂagged as bad data). The inﬂuence of this aspect on the proper\nestimation of the parameters is studied in Section V-E.\nD. Initialization and Pseudomeasurement Strategy\nThe initialization of the iterative process presented in (8) is\nconducted considering a ﬂat proﬁle, i.e. all the bus voltage mag-\nnitudes are set to 1 p.u. and all the bus voltage phase angles are\nset to 0 deg. For the case of transformer impedance ratios, k,t h e y\nare set to 1, which is a sensible educated guess according to [4].\n3288 IEEE TRANSACTIONS ON POWER SYSTEMS, VOL. 36, NO. 4, JULY 2021\nNonetheless, once the algorithm has been run for the ﬁrst time in\na particular grid, the initialization of the transformer impedance\nratios can be changed to adopt the estimated parameters provided\nas an output by the last execution.\nAs it is analysed in Subsection IV-B, adding new elements to\nthe state vector reduces measurement redundancy. To counteract\nthis fact, a general practice was common in parameter estimation\nmethods: the inclusion of the last available estimates of the\nsuspicious parameters as pseudomeasurements in the problem.\nThis practice can be applied to the case of the estimation of\ntransformer impedance ratios; however, this strategy has been\nargued as controversial [6], [14]. Certainly, if the system is\nnot observable without the pseudomeasurements, then the pa-\nrameters become critical and their estimates become equal to\nthe initialization values. On the other hand, if the pseudomea-\nsurements are not critical, but redundant, the arbitrary weights\nassigned to them can lead to largely biased results. For this\nreason, transformer impedance ratios have not been included\nas pseudomeasurements in the present implementation.\nIt is important to note that, if pseudomeasurements of the\nestimated parameters are not used, as in the case of the present\nproposal, initiating the iterative process from a ﬂat start leads\nto the singularity of the Jacobian matrix at the ﬁrst iteration.\nCertainly, all the derivatives with respect to the parameters\nbecome zero at this operating point. This problem can be easily\ncounteracted by including the parameters in the state vector only\nafter the ﬁrst iteration [6]. This is the strategy followed by the\nauthors in the present contribution.\nV. C ASE STUDIES\nA well-tested industrial power system, previously used\nin [17], has been adopted in these case studies to validate and an-\nalyze the proposal. The topology of the network, which includes\nfour tap-changing transformers, together with the voltage levels\nare depicted in Fig. 5. The speciﬁc data of the lines, transformers\nand loads are summarized in Table I.\nIn order to generate data for the multi-snapshot scenario, the\ntap position of the transformers and the value of the loads are\nrandomly assigned at each instant. All the transformers provide\na voltage regulating range of ±7%, with a regulating step, ΔU,\nof 1%. Thus, each p.u. turns ratio is calculated at every snapshot\naccording to\na = 1\n1+Δ U ×I, (40)\nwith I being a random integer which follows a uniform discrete\ndistribution in the range −7 to +7. It is worth mentioning that,\naccording to (2)–(7), at central taps, i.e. a=1, the impedance ra-\ntio, k, has no effect on the impedance values of the π-equivalent\ntransformer model. Thus, any snapshot with one or more trans-\nformers operating at the central tap positions does not aid in the\nestimation of the impedance ratio of those particular machines.\nHowever, provided that there is not a transformer in the grid\npermanently connected at the central tap position (i.e. during the\nT snapshots considered in the problem), the measurement sets\ninclude information on every transformer impedance ratio, and\nthus, all those parameters become observable. The diversity of\nFig. 5. 9-bus test grid. The speciﬁc set of measurements used in the case study\nshown in Section V-D are highlighted in this ﬁgure.\nTABLE I\nPARAMETERS OF THE 9-BUS TEST GRID\n1 Taps are randomly selected within this range.\n2 Preceded by the number of transformers connected in parallel.\n3 Load data are randomly generated around the mean values.\neach snapshot is further guaranteed by assigning random values\nto each active and reactive power injection. Thus, a random\nvalue from a continuous uniform distribution within the range\nof −50% to +50% is added to the mean value of each of the\nloads shown in Table I. In this way, the case studies presented in\nthis section incorporate the possible inﬂuence of the variation of\nMOJUMDAR et al. : ESTIMATION OF IMPEDANCE RATIO PARAMETERS FOR CONSISTENT MODELING OF TAP-CHANGING TRANSFORMERS 3289\nTABLE II\nCOMPARISON OF ACTUAL AND ESTIMATED IMPEDANCE RATIOS -F ULL\nREDUNDANCY -2 0S NAPSHOTS\nthe transformer load level in the performance of the parameter\nestimation algorithm.\nWith the aim of emulating the measurement acquisition pro-\ncess, the topological information and assigned values for taps\nand loads were used to conduct a power ﬂow of the grid for\neach snapshot. The system states, which were veriﬁed with\nOpenDSS [18], were used to calculate the full set of ideal mea-\nsurements: bus voltages magnitudes, active and reactive power\ninjections and active and reactive line power ﬂows. Eventually,\nGaussian noise was added to these measurements in order to\nobtain a set of corrupted regular measurements which, together\nwith virtual measurements (from zero injection buses), were\nincluded in the SE process. According to [6], sensible values for\nthe standard deviation of the measurements can be selected as\nσ =0 .1·γ ·FS for voltage measurements and as σ = γ ·FS\nfor power measurements, where γ stands for the accuracy class\nof the measurement device and FS stands for the full scale\nvalue in accordance with the largest magnitude expected at the\nrespective measurement point. In the present proposal, devices\nof accuracy class 0.1 according to [19] were considered and,\nfor the sake of simplicity, the value of the corresponding ideal\nmeasurement was adopted as the full scale value.\nA. Validation of the Proposal\nFor an initial validation of the proposal, a full redundancy\nscenario is considered. This includes measurements for bus\nvoltage magnitudes, sending and receiving branch power ﬂows,\nand power injections at each bus (except for bus 1 that is\ntaken as the slack). According to (38), a redundancy of 3.35\ncorresponds to this base case. However, considering (39), the\ninclusion of kparameters in a single-snapshot implementation of\nthe augmented SE problem reduces the redundancy level to 2.71.\nTo recover most of the redundancy of the base case, 20 snapshots\nare considered in this initial study, which, according to (39),\nincreases its level to 3.31. In this full redundancy scenario, the\nalgorithm converges in 7 iterations using a threshold of 1e−8\nfor the maximum absolute value of the state variable deviations,\nΔx. The conventional state variables, not shown here for space\nconstraints, are found to be very close to the actual values,\npreviously obtained from the power ﬂow analysis. Finally, the\nestimated values of the transformer p.u. impedance ratios, kSE ,\nare presented in Table II, together with their actual values, kAC,\nand absolute errors, |e|. A maximum absolute error (MAE) of\n1.94% and an average absolute error (AAE) of 0.83% allow to\ndemonstrate the validity of the proposal.\nTABLE III\nCOMPARISON OF ESTIMATION ERRORS IN STATEVARIABLES -A )U SING AN\nEDUCATED GUESS, kt = 1, B) U SING ESTIMATES OF kt\nB. Improvement in SE Results\nIn [4], [5], through several case studies, the advantages of\nusing the new transformer model with an educated guess of k\n= 1, was established. However, as the present proposal allows\nfor the ofﬂine estimation of accurate values of transformer p.u.\nimpedance ratios, it is interesting to assess the expected improve-\nment in the accuracy of SE results, as those provided by an online\nstate estimator, as a consequence of this reﬁnement. With this\naim, a single snapshot standard WLS augmented matrix state\nestimator was used to calculate the state variables of the grid\nin Fig. 5 for the 20 measurement snapshots considered in the\nprevious case study (i.e. the one shown in subSection V-A). This\ntest was carried out with two different setups of the transformer\nimpedance ratios: Case A) uses the educated guess proposed\nin [4], [5], i.e. all the parameters are assumed as equal to 1;\nconversely, in Case B) the estimated parameters shown in the\n3rd column of Table II were used along the SE process.\nAs it is highlighted in [4], [5], the errors derived from the use\nof an inaccurate value of k become more signiﬁcant at extreme\ntap positions and are highly dependent on the power factor of\nthe power ﬂow. As the case study reported in subSection V-A\nuses both load values and tap positions randomly generated,\na diverse inﬂuence of the errors caused by k is assured. Two\nﬁgures of merit have been used to assess the comparison: (1) the\nMAE of bus voltage magnitudes and phase angles with respect\nto the true state, calculated considering the full set of buses and\nsnapshots, and (2), the average value of the sum of variances\nover Q snapshots, deﬁned as\nσ2\nav = 1\nQ\nQ∑\nq=1\n[\n1\nS\nS∑\ns=1\n(ˆxsq −xsq)2\n]\n, (41)\nwith ˆxsq and xsq being the estimated and true state of the s-th\nstate variable of the system at snapshot q, which has been used\nwith this aim in similar studies [20]. The true state of the system\nwas previously obtained for each snapshot by using a power ﬂow\nalgorithm with the true values of k, i.e, those shown in the 2nd\ncolumn of Table II. The results in Table III show the values of\nthe aforementioned ﬁgures of merit.\nFrom Table III, it becomes evident that the errors in the\nestimated states are signiﬁcantly reduced with the use of accurate\nestimates of transformer impedance ratios. This result ensures\nthe practical usefulness of the proposal.\nC. Inﬂuence of the Number of Snapshots\nAs it is stated in (39), using a large number of snapshots\nshould return the redundancy of the SE problem close to the one\nfrom the base case. However, it is still interesting to analyze if\n3290 IEEE TRANSACTIONS ON POWER SYSTEMS, VOL. 36, NO. 4, JULY 2021\nFig. 6. Estimation errors of transformer impedance ratios vs. number of\nsnapshots - full redundancy.\nthe quality of the estimates of the transformer impedance ratios\nkeeps improving with the number of snapshots or if, from a\ncertain point, adding more snapshots is not really worthy. This\ncase study is designed to test this speciﬁc feature, and for that,\nthe same base case of subSection V-A is used. However, now,\nthe test is repeated with an increasing number of snapshots,\nQ, ranging from 1 to 60. The quality of these multi-snapshot\nestimates is assessed by using different ﬁgures of merit. Thus,\nFig. 6 represents the value of the MAE, AAE and root mean\nsquare error (RMSE). The deﬁnitions of these ﬁgures of merit,\nin the context of this test, are included in the legend of the ﬁgure.\nNote that kAC\nt and kSE\nt are the actual and estimated values of\np.u. impedance ratios, t, and T being the particular and the total\nnumber of transformer impedance ratios to be estimated.\nFrom Fig. 6, it can be concluded that using a very low number\nof snapshots is not feasible, as Q in ranges from 1 to 11 may\nlead to gross errors in the estimation of the parameters. On the\nother hand, the graph shows that these errors decline very fast\nas new information is included into the problem by increasing\nthe number of snapshots. In this case study, the MAE is always\nlower than 5% when 12 or more snapshots are included into the\nproblem, and lower than 3.5% if Q is raised to 17. Regarding\nthe RMSE, it is always lower than 5% if at least 11 snapshots\nare used and lower than 3.5% if more than 12 snapshots are\nincluded. Similarly, 9 and 11 snapshots are enough to assure an\nAAE under 5% and 3.5%, respectively.\nIt is also interesting to note that, from a certain number of Q,\nthe beneﬁt of adding new snapshots is only marginally signiﬁ-\ncant. Thus, none of the p.u. impedance ratio estimation shows an\nerror higher than 5% (compared with the actual values) when the\nnumber of snapshots included in the problem is at least 20. This\ncomparison is presented in Table IV. In any case, a compromise\nbetween accuracy and computational burden should be assumed\nby the user.\nD. Inﬂuence of the Redundancy Level\nAn interesting concern related to the utilisation of the pro-\nposed methodology, is to analyze the inﬂuence of the redun-\ndancy level on its capability to provide accurate estimates of\nthe transformer impedance ratios. With this aim, the base case\nused in Section V-A is downgraded now by removing some of\nTABLE IV\nCOMPARISON OF ACTUAL AND ESTIMATED VALUES -F ULL REDUNDANCY -\nDIFFERENT SNAPSHOTS\nFig. 7. Estimation errors of transformer impedance ratios vs. number of\nsnapshots - minimum redundancy.\nthe measurements, down to the point in which the system is just\nobservable with a single snapshot. In this minimum redundancy\ncase study, the 17 state variables and 4 parameters to be estimated\nin the single snapshot scenario, are obtained from a set of 21\nmeasurements, thus leading, according to (39), to a redundancy\nlevel of 1 for a single-snapshot implementation, i.e. ε1 = 1.\nSpeciﬁcally, all the power ﬂow measurements, less common at\ncertain parts of the grid, have been completely removed. On the\nother hand, 5 of the 9 bus voltage magnitudes as well as the full\nset of power injection measurements are retained. For the beneﬁt\nof the reader, the speciﬁc set of measurements considered in the\nproblem is depicted in Fig. 5.\nThe same multi-snapshot analysis previously conducted in\nSection V-C for the full redundancy case, has been carried out\nhere for the new minimum redundancy scenario. Fig. 7 shows\nthe values of the different ﬁgures of merit, i.e. MAE, AAE and\nRMSE for the different number of snapshots included into the\nproblem, ranging from 1 to 60. Thus, according to (39), the\nmaximum redundancy level considered along the test is limited\nto ε60 = 1.23.\nAs it can be seen in Fig. 7, a similar pattern to the one\nderived from the full redundancy scenario is obtained, though\nslightly higher errors arise in this case. However, it is important\nto highlight that the convergence ratio of the problem is not\ndeteriorated and not more than 8 iterations are needed to solve the\nSE for any value of Q. This is an important observation for those\nparts of the grid where full redundancy is typically far from the\nreality of standard infrastructures. Speciﬁcally, the MAE needs\nat least 18 snapshots to drop under 5%. For the case of the RMSE,\n11 snapshots are needed to go under this error threshold. Finally,\nMOJUMDAR et al. : ESTIMATION OF IMPEDANCE RATIO PARAMETERS FOR CONSISTENT MODELING OF TAP-CHANGING TRANSFORMERS 3291\nTABLE V\nCOMPARISON OF ACTUAL AND ESTIMATED VALUES -M INIMUM REDUNDANCY\n-D IFFERENT SNAPSHOTS\njust 10 snapshots are enough to reduce the AAE under 5%.\nEstimations from speciﬁc snapshots are presented in Table V for\nthe minimum redundancy case. This allows to conclude that, in\norder to achieve similar accuracy levels, the user should be aware\nof including a higher number of snapshots when redundancy is\ncompromised. Indeed, this observation is aligned with the nature\nof the problem, as fewer information about the system is being\nprovided if this compensation is not conducted.\nE. Inﬂuence of Bad Data\nAs it was stated in Section IV-C, the proposed parameter\nestimation algorithm is designed to work ofﬂine, and thus, a\nconventional online state estimator is responsible for the de-\ntection, identiﬁcation and removal of bad data. However, using\ninaccurate values of the transformer impedance ratios (as during\nthe initialization process in which an educated guess is used,\nk = 1), can lead the online state estimator to erroneously\nﬂag and remove measurements as bad data. The present case\nstudy analyses if the removal of these measurements from the\ndata set could have a signiﬁcant inﬂuence on the estimation of\ntransformer impedance ratios by the ofﬂine algorithm.\nTo replicate the performance of an online state estimator, a\nsingle snapshot standard WLS augmented matrix algorithm was\napplied to the 60 snapshots considered in the full redundancy\ncase study analysed in Section V-C. A value of k = 1w a s\nassigned to the impedance ratio of each of the four tapped\ntransformers in Fig. 5. The normalized residual test, with a\nthreshold level of 4, was used to detect, identify and remove bad\ndata. The estimation process and bad data test are sequentially\nrepeated until the complete ﬁltering of the input data. As a\nresult, bad data was identiﬁed in 28 of the 60 snapshots. Up\nto a maximum of 4 measurements had to be removed from a\nsingle snapshot to reach a set of fully ﬁltered data.\nThe parameter estimation algorithm proposed in this work\nwas applied to the ﬁltered set of measurements for an increasing\nnumber of snapshots (from 1 to 60). Fig. 8 compares the value\nof the average absolute error of the estimated parameters with\nthose obtained in Section V-C. As can be observed in Fig. 8,\nthe removal of measurements can lead to a slight increase in\nparameter estimation errors when a low number of snapshots are\nused as input data. However, this effect is practically obliterated\nby the addition of more snapshots.\nFig. 8. Estimation errors of transformer impedance ratios vs. number of\nsnapshots - inﬂuence of bad data.\nIt is important to highlight that this situation is only expected\nduring the ﬁrst execution of the algorithm in a particular grid.\nOnce a realistic approximation to the values of k is available\nfor the online estimator, erroneous bad data detections due to\ntransformer model inaccuracies are not likely to occur. Thus,\nusing a larger number of snapshots during the initialization can\nbe considered a sensible recommendation.\nFinally, in a context of lower redundancy, the same pattern\nshown in Section V-D is expected. Notice that if the removal\nof bad data causes the loss of observability, the corresponding\nsnapshot would just not be provided by the online estimator, and\nthus, it will not have any inﬂuence on the parameter estimation\nalgorithm.\nVI. C ONCLUSION\nAn ofﬂine state-vector-augmented parameter estimation\nmethod, capable of providing accurate estimates of transformer\nimpedance ratios, is proposed, validated, and analyzed in this\nwork. Moreover, the derivatives of the different measurement\nfunctions in terms of the new parameter, which are essential for\nthis or any other linearized state estimator, are provided as a\ncontribution. This study, calls attention to the hindrances found\nin the estimation of these parameters, such as the signiﬁcantly\nlower sensitivity of the measurement functions with respect to\np.u. impedance ratios and the reduction of redundancy that their\ninclusion causes in the state estimation problem. To overcome\nthese difﬁculties, the authors propose a method based on the\nuse of a multi-snapshots scenario. A set of case studies are\npresented in order to validate and demonstrate the usefulness\nof the proposal, including an analysis of the effect of the num-\nber of snapshots and the redundancy level on the accuracy of\nthe estimation. They allow to conclude that, a lower number\nof snapshots, in the range 1 to 10, are not enough to derive\naccurate results regardless of the redundancy level. However, the\ninclusion of a higher number of snapshots always allows to reach\nacceptable estimates. Though a low measurement redundancy\nlevel requires a higher number of snapshots to reach the same\naccuracy, this work demonstrates that even those systems close\nto the limit of observability can be handled successfully by the\nproposed algorithm.\n3292 IEEE TRANSACTIONS ON POWER SYSTEMS, VOL. 36, NO. 4, JULY 2021\nREFERENCES\n[1] J. D. Glover, M. S. Sarma, and T. Overbye, Power System Analysis and\nDesign., 5th ed., Boston, MA, USA: Cengage Learning, 2012.\n[2] Powerworld User’s Guide, 2011. [Online]. Available: http://www.\npowerworld.com.\n[3] L. V . Barboza, H. Zurn, and R. Salgado, “Load tap change transformers:\nA modeling reminder,” IEEE Power Eng. Rev. , vol. 21, no. 2, pp. 51–52,\nFeb. 2001.\n[4] J. M. Cano, M. R. R. Mojumdar, and G. A. Orcajo, “Rec-\nonciling tap-changing transformer models,” IEEE Trans. Power\nDel., vol. 34, no. 6, pp. 2266–2268, Dec. 2019.\n[5] J. M. Cano, M. R. R. Mojumdar, and G. A. Orcajo, “On the consistency of\ntap-changing transformer models in power system studies,” in Proc. IEEE\nPower Energy Soc. Gen. Meeting ., 2020, pp. 1–5.\n[6] A. Abur and A. G. Exposito, Power System State Estimation: Theory and\nImplementation. Boca Raton, FL, USA: CRC Press, 2004.\n[7] A. Monticelli, State Estimation in Electric Power Systems: A Generalized\nApproach. Berlin, German: Springer Science & Business Media, 2012.\n[8] O. Alsac, N. Vempati, B. Stott, and A. Monticelli, “Generalized state\nestimation,” IEEE Trans. Power Syst. , vol. 13, no. 3, pp. 1069–1075,\nAug. 1998.\n[9] M. Castillo, J. London Jr, and N. Bretas, “Identiﬁcation and estimation of\npower system branch parameter error,” in Proc. IEEE Power Energy Soc.\nGen. Meeting , 2009, pp. 1–8.\n[10] P. A. Teixeira, S. R. Brammer, W. L. Rutz, W. Merritt, and J. Salmonsen,\n“State estimation of voltage and phase-shift transformer tap settings,”IEEE\nTrans. Power Syst., vol. 7, no. 3, pp. 1386–1393, Aug. 1992.\n[11] Y . Lin and A. Abur, “Enhancing network parameter error detection\nand correction via multiple measurement scans,” IEEE Trans. Power\nSyst., vol. 32, no. 3, pp. 2417–2425, May 2017.\n[12] Y . Lin and A. Abur, “Robust state estimation against measurement and\nnetwork parameter errors,” IEEE Trans. Power Syst. , vol. 33, no. 5,\npp. 4751–4759, Sep. 2018.\n[13] G. N. Korres, P. J. Katsikas, and G. C. Contaxis, “Transformer\ntap setting observability in state estimation,” IEEE Trans. Power\nSyst., vol. 19, no. 2, pp. 699–706, May 2004.\n[14] P. Zarco and A. G. Exposito, “Power system parameter estimation: A\nsurvey,”IEEE Trans. Power Syst. , vol. 15, no. 1, pp. 216–222, Feb. 2000.\n[15] F. Aschmoneit, N. Peterson, and E. Adrian, “State estimation with equality\nconstraints,” in Proc. 10th PICA Conf. , 1977, pp. 427–430.\n[16] A. Gjelsvik, S. Aam, and L. Holten, “Hachtel’s augmented matrix method-\na rapid method improving numerical stability in power system static state\nestimation,”IEEE Trans. Power App. Syst., vol. PAS-104, no. 11, pp. 2987–\n2993, Nov. 1985.\n[17] M. R. R. Mojumdar, J. M. Cano, S. Jaman, and G. A. Orcajo, “Smooth-\ning parameter optimization routine for high-quality a priori estimates in\nforecasting-aided state estimation,” in Proc. IEEE Power Energy Soc. Gen.\nMeeting, 2018, pp. 1–5.\n[18] R. C. Dugan and D. Montenegro, “Open distribution system simulator\n(OpenDSS): Reference guide,” Elect. Power Res. Inst. , Inc., Knoxville,\nTN, Jun. 2019. [Online]. Available: https://sourceforge.net/p/electricdss/\nwiki/Home/\n[19] Electricity Meters, 0.1, 0.2 and 0.5 Accuracy Classes . ANSI C12. 20.2015,\nAmerican National Standards Institute, Washington, D.C., Standard, 2015.\n[20] S. Chakrabarti, E. Kyriakides, G. Ledwich, and A. Ghosh, “Inclusion of\nPMU current phasor measurements in a power system state estimator,”\nIET Gener., Transmiss. Distrib. , vol. 4, no. 10, pp. 1104–1115, 2010.\nMd Rejwanur R. Mojumdar (Graduate Student\nMember, IEEE) received the Joint M.Sc. degree in\n2014 from the Erasmus Mundus Master Course in\nSustainable Transportation and Electrical Power Sys-\ntems (EMMC STEPS). He is currently working to-\nward the Ph.D. degree from the University of Oviedo,\nSpain. He started as a SCADA Engineer for AREV A\nT&D. Then he was in several research positions with\nthe University of Oviedo, Spain, University of Sta-\nvanger, Norway, and INESC TEC, Portugal. In 2020,\nhe joined the Electrical Control System Department,\nABB AS, Norway. His research interests include the state estimation, modeling\nand algorithms for power management systems, distributed generation and smart\ngrids.\nJosé M. Cano (Senior Member, IEEE) received the\nM.Sc. and Ph.D. degrees in electrical engineering\nfrom the University of Oviedo, Spain, in 1996 and\n2000, respectively. In 1996, he joined the Depart-\nment of Electrical Engineering, University of Oviedo,\nSpain, where he is currently a Full Professor. During\n2012 and 2014, he was a Visiting Associate Professor\nwith the Department of Electrical and Computing En-\ngineering, University of British Columbia, Canada.\nHis main research interests include power quality so-\nlutions for industry, power converters, power system\nstate estimation, distributed generation and smart grids.\nGonzalo A. Orcajo (Member, IEEE) was born in Gi-\njón, Spain, in 1965. He received the M.Sc. and Ph.D.\ndegrees in electrical engineering from the University\nof Oviedo, Spain, in 1990 and 1998, respectively. In\n1992, he joined the Department of Electrical Engi-\nneering, University of Oviedo, where he is currently\nan Associate Professor. His main research interests\ninclude power quality in industrial power systems. In\nrecent years, he has focused on the detection and lo-\ncation of faults in distribution systems and on reactive\npower compensation systems.",
  "topic": "Estimator",
  "concepts": [
    {
      "name": "Estimator",
      "score": 0.6288649439811707
    },
    {
      "name": "Transformer",
      "score": 0.6148259043693542
    },
    {
      "name": "Electrical impedance",
      "score": 0.6101821660995483
    },
    {
      "name": "Control theory (sociology)",
      "score": 0.43177980184555054
    },
    {
      "name": "Estimation theory",
      "score": 0.41091811656951904
    },
    {
      "name": "Computer science",
      "score": 0.40720587968826294
    },
    {
      "name": "Mathematics",
      "score": 0.3184460401535034
    },
    {
      "name": "Engineering",
      "score": 0.3028179407119751
    },
    {
      "name": "Algorithm",
      "score": 0.18004554510116577
    },
    {
      "name": "Statistics",
      "score": 0.14133742451667786
    },
    {
      "name": "Voltage",
      "score": 0.13753053545951843
    },
    {
      "name": "Electrical engineering",
      "score": 0.11182770133018494
    },
    {
      "name": "Artificial intelligence",
      "score": 0.0
    },
    {
      "name": "Control (management)",
      "score": 0.0
    }
  ]
}