{
  "title": "A comprehensive transformer-based approach for high-accuracy gas adsorption predictions in metal-organic frameworks",
  "url": "https://openalex.org/W4392359620",
  "year": 2024,
  "authors": [
    {
      "id": "https://openalex.org/A2143041298",
      "name": "Jingqi Wang",
      "affiliations": [
        "Tsinghua University"
      ]
    },
    {
      "id": "https://openalex.org/A2131494802",
      "name": "Jiapeng Liu",
      "affiliations": [
        "Sun Yat-sen University"
      ]
    },
    {
      "id": "https://openalex.org/A2137862367",
      "name": "Hongshuai Wang",
      "affiliations": [
        "Soochow University"
      ]
    },
    {
      "id": "https://openalex.org/A2983420750",
      "name": "Musen Zhou",
      "affiliations": [
        "University of California, Riverside"
      ]
    },
    {
      "id": "https://openalex.org/A2412774117",
      "name": "Guolin Ke",
      "affiliations": []
    },
    {
      "id": "https://openalex.org/A2113412591",
      "name": "Linfeng Zhang",
      "affiliations": []
    },
    {
      "id": "https://openalex.org/A2103483409",
      "name": "Jianzhong Wu",
      "affiliations": [
        "University of California, Riverside"
      ]
    },
    {
      "id": "https://openalex.org/A2114914632",
      "name": "Zhifeng Gao",
      "affiliations": []
    },
    {
      "id": "https://openalex.org/A2151908955",
      "name": "Diannan Lu",
      "affiliations": [
        "Tsinghua University"
      ]
    },
    {
      "id": "https://openalex.org/A2143041298",
      "name": "Jingqi Wang",
      "affiliations": [
        "Tsinghua University"
      ]
    },
    {
      "id": "https://openalex.org/A2131494802",
      "name": "Jiapeng Liu",
      "affiliations": [
        "Sun Yat-sen University",
        "Institute for History of Natural Sciences"
      ]
    },
    {
      "id": "https://openalex.org/A2137862367",
      "name": "Hongshuai Wang",
      "affiliations": [
        "Soochow University"
      ]
    },
    {
      "id": "https://openalex.org/A2983420750",
      "name": "Musen Zhou",
      "affiliations": [
        "University of California, Riverside"
      ]
    },
    {
      "id": "https://openalex.org/A2412774117",
      "name": "Guolin Ke",
      "affiliations": []
    },
    {
      "id": "https://openalex.org/A2113412591",
      "name": "Linfeng Zhang",
      "affiliations": [
        "Institute for History of Natural Sciences"
      ]
    },
    {
      "id": "https://openalex.org/A2103483409",
      "name": "Jianzhong Wu",
      "affiliations": [
        "University of California, Riverside"
      ]
    },
    {
      "id": "https://openalex.org/A2114914632",
      "name": "Zhifeng Gao",
      "affiliations": []
    },
    {
      "id": "https://openalex.org/A2151908955",
      "name": "Diannan Lu",
      "affiliations": [
        "Tsinghua University"
      ]
    }
  ],
  "references": [
    "https://openalex.org/W2339540635",
    "https://openalex.org/W4296221673",
    "https://openalex.org/W2992843173",
    "https://openalex.org/W2737857566",
    "https://openalex.org/W1983642250",
    "https://openalex.org/W2080298157",
    "https://openalex.org/W2061229359",
    "https://openalex.org/W2970431513",
    "https://openalex.org/W2375347670",
    "https://openalex.org/W2054169485",
    "https://openalex.org/W2141939342",
    "https://openalex.org/W2977837898",
    "https://openalex.org/W4210632708",
    "https://openalex.org/W2325103942",
    "https://openalex.org/W2099486431",
    "https://openalex.org/W4292641216",
    "https://openalex.org/W4311758697",
    "https://openalex.org/W3047237491",
    "https://openalex.org/W2983039574",
    "https://openalex.org/W2430656774",
    "https://openalex.org/W1998829408",
    "https://openalex.org/W2892113269",
    "https://openalex.org/W2147632348",
    "https://openalex.org/W1986614779",
    "https://openalex.org/W3050328806",
    "https://openalex.org/W3157364410",
    "https://openalex.org/W4298126027",
    "https://openalex.org/W3200152265",
    "https://openalex.org/W2116341502",
    "https://openalex.org/W2766856748",
    "https://openalex.org/W6739901393",
    "https://openalex.org/W4324032752",
    "https://openalex.org/W4318262876",
    "https://openalex.org/W4323304388",
    "https://openalex.org/W2756398738",
    "https://openalex.org/W2514123320",
    "https://openalex.org/W2902702590",
    "https://openalex.org/W4308255806",
    "https://openalex.org/W2095204227",
    "https://openalex.org/W2016160332",
    "https://openalex.org/W2062904068",
    "https://openalex.org/W2049729880",
    "https://openalex.org/W2064477776",
    "https://openalex.org/W2037498697",
    "https://openalex.org/W3048908832",
    "https://openalex.org/W2894558355",
    "https://openalex.org/W2530805533",
    "https://openalex.org/W2983028326",
    "https://openalex.org/W2611292439",
    "https://openalex.org/W2084266203",
    "https://openalex.org/W2030971064",
    "https://openalex.org/W2039969846",
    "https://openalex.org/W2078402834",
    "https://openalex.org/W3003201860",
    "https://openalex.org/W2015197254",
    "https://openalex.org/W2053294416",
    "https://openalex.org/W2701047705",
    "https://openalex.org/W3150635270",
    "https://openalex.org/W2011301426",
    "https://openalex.org/W6892498765"
  ],
  "abstract": null,
  "full_text": "Article https://doi.org/10.1038/s41467-024-46276-x\nA comprehensive transformer-based\napproach for high-accuracy gas adsorption\npredictions in metal-organic frameworks\nJingqi Wang1,2,7,J i a p e n gL i u3,4,7, Hongshuai Wang 2,5, Musen Zhou 6,\nGuolin Ke 2,L i n f e n gZ h a n g2,4, Jianzhong Wu 6 , Zhifeng Gao 2 &\nDiannan Lu 1\nGas separation is crucial for industrial production and environmental pro-\ntection, with metal-organic frameworks (MOFs) offering a promising solution\ndue to their tunable structural properties and chemical compositions. Tradi-\ntional simulation approaches, such as molecular dynamics, are complex and\ncomputationally demanding. Although feature engineering-based machine\nlearning methods perform better, they are susceptible to overﬁtting because\nof limited labeled data. Furthermore, these methods are typically designed for\nsingle tasks, such as predictinggas adsorption capacity under speciﬁcc o n d i -\ntions, which restricts the utilization ofcomprehensive datasets including all\nadsorption capacities. To address thesec h a l l e n g e s ,w ep r o p o s eU n i - M O F ,a n\ninnovative framework for large-scale,three-dimensional MOF representation\nlearning, designed for multi-purpose gas prediction. Speciﬁcally, Uni-MOF\nserves as a versatile gas adsorption estimator for MOF materials, employing\npure three-dimensional representations learned from over 631,000 collected\nMOF and COF structures. Our experimental results show that Uni-MOF can\nautomatically extract structural representations and predict adsorption\ncapacities under various operating conditions using a single model. For\nsimulated data, Uni-MOF exhibits remarkably high predictive accuracy across\nall datasets. Additionally, the valuespredicted by Uni-MOF correspond with\nthe outcomes of adsorption experiments. Furthermore, Uni-MOF demon-\nstrates considerable potential for broadapplicability in predicting a wide array\nof other properties.\nGas separation1–3 is a signiﬁcant industrial challenge that requires\nimmediate attention, given its critical role in various applications. For\nexample, separating CH\n4 from CO2 is essential for obtaining high-\nquality natural gas and effectively achieving the carbon capture,\nutilization and storage for environmental reasons4,5. Gas separation\nalso has implications for otherﬁelds, such as the production of high-\npurity oxygen6,7 and nitrogen8,9 for industrial purposes and the pur-\niﬁcation of noble gases for medical diagnosis, and lasers10,11. Given its\nReceived: 23 May 2023\nAccepted: 20 February 2024\nCheck for updates\n1Department of Chemical Engineering, Tsinghua University, Beijing 100084, China.2DP Technology, Beijing 100089, China.3School of Advanced Energy, Sun\nYat-Sen University, Shenzhen 518107, China.4AI for Science Institute, Beijing 100190, China.5Jiangsu Key Laboratory for Carbon-Based Functional & Materials\nDevices, Institute of Functional & Nano Soft Materials (FUNSOM), Soochow University, Suzhou 215123, China.6Department of Chemical and Environmental\nEngineering, University of California, Riverside, CA 92521, USA.7These authors contributed equally: Jingqi Wang, Jiapeng Liu.e-mail: jwu@engr.ucr.edu;\ngaozf@dp.tech; ludiannan@mail.tsinghua.edu.cn\nNature Communications|         (2024) 15:1904 1\n1234567890():,;\n1234567890():,;\nimportance, research in this area is crucial for advancing technology\nand meeting industry demands.\nMetal-organic frameworks (MOFs) have emerged as a kind of\npromising material in theﬁeld of gas separation due to their unique\nproperties12–14. MOFs are composed of metal ions and organic ligands,\nwhich provide them with highly ordered pore structures and adjus-\ntable aperture sizes. These properties make them ideal for various gas\nseparation applications\n15–17. The ability to control the pore size and\nchemical composition of MOFs allows for selective adsorption and\nseparation of different gases. MOFs with different pore sizes exhibit\nvaried capacities for gas adsorption\n18, and tuning the chemical\ncomposition19 can affect the preference for adsorbate gases. The\nability to selectively adsorb and separate different gases makes MOFs a\npromising material for various industrial and environmental\napplications\n20,21.\nWhile the potential of MOFs for gas adsorption is promising,\naccurately predicting their adsorption capacity remains a challenge.\nMolecular dynamics\n22,23, Monte Carlo (MC)24 and other simulation/\ncalculation methods25,26 have been applied to provide reference values,\nbut these approaches are computationally expensive and complicated\nfor implementation, limiting their application to large-scale, multi-gas,\nand high-throughput calculations. Moreover, the vast range of oper-\nating conditions for gas adsorption further complicates the\npredictions.\nMachine learning techniques have demonstrated signi ﬁcant\npotential in accurately predicting properties of crystalline\nmaterials\n27–29, reducing the cost of traditional trial and error experi-\nments, and eliminating the need for expensive simulations. However,\nthese methods often rely on feature engineering based on expert\ndomain knowledge, leading to overﬁtting and biased performance\nwhen using a limited amount of labeled data. With the emergence of\ndeep learning, graph neural networks,\n30,31 and Transformers32–34 have\nproven successfully in predicting MOF properties. These models\ndirectly incorporate structural information such as chemical bonds,\natoms, and spatial coordinates as inputs, and automatically learn\nstructural features through data-driven approaches. Thanks to the\npowerful representation capacity of these deep-learning frameworks,\nlearned features can effectively eliminate biases introduced by feature\nengineering mentioned earlier.\nDespite their high performance and powerful predictive cap-\nabilities, existing models for predicting adsorption properties are\ntypically designed for single tasks, speciﬁcally predicting the adsorp-\ntion uptake of a particular gas under certain conditions. However, the\navailable datasets for these single task predictions are often limited,\nthereby hindering the models generalizability and full utilization of\ntheir capabilities. On the other hand, the combination of labeled data\nfrom various adsorbate gases across different temperature and pres-\nsure environments can create a substantial dataset suitable for training\nacross the entire working conditions. The increased data size may also\nenhance the model ability to generalize and improve their practical\nindustrial use. Therefore, a uniﬁed adsorption framework is necessary\nfor advancing these models. Additionally, integrating representation\nlearning (or pre-training) for large-scale unlabeled MOF structures may\nfurther improve the model performance as well as representation\nability. The pre-training trick has been widely implemented in combi-\nnation with large-scale models to discover drugs\n35, where pure three-\ndimensional molecular structures were used to pre-train these models.\nExperimental results have also demonstrated that pre-trained models\noutperform previous methods, particularly in property prediction\n33,\nsuggesting remarkable improvement through pre-training.\nInspired by this, we propose the Uni-MOF framework as a multi-\npurpose solution for predicting gas adsorption of MOFs under dif-\nferent conditions using structural representation learning. Compared\nwith other Transformer-based models such as MOFormer\n34 and\nMOFTransformer33, our Uni-MOF, as a Transformer-based framework,\nnot only can the pre-training recognize and recover the three-\ndimensional structure of nanoporous materials and thus greatly\nimprove the robustness of the model, but theﬁne-tuning task also\nfurther takes into account the operating conditions such as tempera-\nture, pressure, and different gas molecules, which makes Uni-MOF\nsuitable for both scientiﬁc research and practical applications. Uni-\nMOF, as a comprehensive gas adsorption estimator for MOF materials,\nrequires only the crystallographic informationﬁle (CIF) of the MOF,\nalong with the associated gas, temperature, and pressure parameters,\nto predict the gas adsorption properties of nanoporous materials over\na wide range of operating conditions. Our framework is easy to use and\nallows for module selection. Additionally, it effectively addresses the\nissue of overﬁtting by integrating various cross-system absorption\nlabeled data with representation learning from massive amounts of\nunlabeled structural data. This compensates for the lack of high-\nquality and insufﬁcient data, ultimately leading to higher accuracy in\ngas adsorption predictions. Our study utilized a self supervised\nlearning approach on a database containing over 631,000 MOF and\nCOF structures. The results were remarkable, demonstrating a high\nprediction accuracy. Fine-tuning experiments revealed that the Uni-\nMOF framework is robust in databases with ample data. When applied\nto databases with sufﬁcient sampling of working conditions, our Uni-\nMOF framework is able to screen high performance adsorbents under\nhigh pressure accurately by feeding only the labeled data obtained at\nlow pressure by home-brew simulations. We must stress that Uni-MOF\nprovides a convenient approach for high pressure adsorption capa-\ncities, which are generally more computationally demanding for tra-\nditional simulations. The results are consistent with experimental\nscreening outcomes. Furthermore, the performance of Uni-MOF on\ncross-system datasets exceeded that on single-system tasks. By lever-\naging support from other gas adsorption data, Uni-MOF accurately\npredicted the adsorption properties of unknown gases.\nUni-MOF framework achieves material recognition accuracy at the\natomic level, while the integrated model makes Uni-MOF more\napplicable to engineering problems. Undoubtedly, accomplishing\ntruly uniﬁed models is the future direction of the materialsﬁeld, rather\nthan just focusing on specialized areas. Uni-MOF is a pioneering\npractice of Machine Learning in gas adsorption.\nResults and discussion\nOverview of workﬂow\nThe Uni-MOF framework comprises pre-training on three-dimensional\nnanoporous crystals and ﬁne-tuning for multitask prediction in\ndownstream applications. Figure1 provides a schematic representa-\ntion of the Uni-MOF framework. The pre-training of three-dimensional\ncrystal materials signiﬁcantly enhances the prediction performance of\ndownstream tasks, particularly for large-scale unlabeled data. To\naddress the issue of inadequately supervised training datasets, we\ncollected an extensive dataset of MOF structures and generated over\n300,000 MOFs using ToBaCCo.3.0\n36,37. High-throughput construction\nof COFs based on materials genomics strategy with quasi-reactive\nassembly algorithms (QReaxAA) is feasible, leading to a comprehen-\nsive library of COFs\n38. Through the spatial conﬁguration of materials,\nUni-MOF is capable of learning the material structural properties, most\nimportantly the chemical bonding information, very well. In order to\nenable Uni-MOF to learn more diverse materials and thus improve the\ngeneralization ability to a broader range of materials, we introduced\nMOFs and COFs both virtually and experimentally during the pre-\ntraining process. Similar to the masking tagging task in BERT\n39 and Uni-\nMol35, Uni-MOF employs a prediction task for masked atoms, thereby\npromoting the pre-trained models to acquire an in-depth under-\nstanding of the material spatial structures. To enhance the robustness\nof pre-training and generalize the learned representation, we intro-\nduced noises to the original coordinates of MOFs, as depicted in Fig.1a.\nIn the pre-training stage, we devised two tasks. 1) reconstructing the\nArticle https://doi.org/10.1038/s41467-024-46276-x\nNature Communications|         (2024) 15:1904 2\npristine three-dimensional positions from the noisy data, and 2) pre-\ndicting the masked atoms. These tasks can augment the model\nrobustness and improve downstream prediction performance.\nIn addition to diverse spatial conﬁgurations, a comprehensive set\nof material property data points is also crucial for model training. To\nenrich the dataset, we established a custom data generation process\n(as illustrated in Fig.1b). For example, we utilized the CoRE MOF\ndatabase that comprises successfully synthesized MOFs, gases that are\nsigniﬁcant in the separationﬁeld, as well as the common temperature\nand pressure operating range under the corresponding system. By\nrandomly sampling from these various materials, gases, temperatures,\nand pressure pools, a signiﬁcant volume of adsorption uptake data can\nbe generated for Uni-MOFﬁne-tuning. This data generation process\nimproves the efﬁciency of data generation and can form a widely\nsampled dataset, Table1 lists all the databases applied in this study.\nThe simulation-derived database with diversity is beneﬁcial for model\nﬁne-tuning and optimization, ultimately accomplishing the objective\nof virtual screening for material performance.\nFig. 1 | Schematic overview of Uni-MOF framework. apre-training workﬂow. In\nthe pre-training stage, in addition to predicting the types of masked atoms, a three-\ndimensional position denoising task was used to learn the three-dimensional spatial\nrepresentation. Uniform noise of [−1 Å,1 Å] is added to the 15% of atomic coordi-\nnates randomly, and then the spatial position encoding is calculated based on the\ncorrupted coordinates.b data generation workﬂow. Cross-system performance\ndatasets can be collected or generated by random sampling of different operating\nconditions.c workﬂow of Uni-MOFﬁne-tuning. A uniﬁed gas adsorption prediction\nmodel Uni-MOF is built by the embedding of pre-trained weight, MOF material, gas,\ntemperature, and pressure.d overall workﬂow of Uni-MOF. For the multi-purpose\nUni-MOF framework, no additional analytical calculations for materials are\nrequired, and the properties under varied working conditions can be predicted\nbased solely on the crystallographic informationﬁle (CIF) of MOF materials. MOF\nmeans metal-organic framework.\nArticle https://doi.org/10.1038/s41467-024-46276-x\nNature Communications|         (2024) 15:1904 3\nThe ﬁne-tuning of Uni-MOF depicted in Fig.1ci sb a s e do nt h e\nextraction of representations acquired through pre-training, as well as\nthe generation and collection of extensive datasets using our home-\nbrew workﬂows. During theﬁne-tuning process, we trained the model\nusing around 3,000,000 labeled data points across various adsorption\nconditions of MOFs and COFs, enabling accurate prediction of\nadsorption capacities. With the diverse database of cross-system tar-\ngeted data, the ﬁne-tuned Uni-MOF can predict the multi-system\nadsorption property of MOFs under arbitrary states, including differ-\nent gases, temperatures, and pressures. As a result, Uni-MOF is a uni-\nﬁed and readily available framework for predicting the adsorption\nperformance of MOF adsorbents.\nAbove all, Uni-MOF obviates the requirement for additional labor\nin identifying human-deﬁned structural features. Instead, the CIF of\nMOFs, along with pertinent gas, temperature, and pressure para-\nmeters, sufﬁces. The self-supervised learning strategy and abundant\ndatabases ensure that Uni-MOF can foretell gas adsorption properties\nof nanoporous material in a wide range of operating parameters,\nthereby rendering it a proﬁcient gas adsorption estimator for MOF\nmaterials.\nOverall performance in large-scale databases\nIn order to evaluate the predictive capability of Uni-MOF as a com-\nprehensive framework for adsorption performance prediction, two\nmixed-state databases for gas adsorption, namely hMOF_MOFX-DB\nand CoRE_MOFX-DB, were compiled with adsorbate gases consisting\nof [CO\n2,N 2,C H4,K r ,X e ]a n d[ N2,A r ] ,r e s p e c t i v e l y .I na d d i t i o n ,t h e\nCoRE_MAP_DB database was generated via our home-brew MC simu-\nlation workﬂow for the adsorption uptake of seven gases (CO\n2,C H4,A r ,\nKr, Xe, O2,H e ) .\nSince the data sources of the three databases are different, we\nconducted model training for each database separately in order to\nensure the consistency of data sets. Details of these three databases,\nincluding temperature and pressure ranges, are listed in Supplemen-\ntary Table 1. To prevent data bias and ensure that the test set remained\nunseen by the model, we divided the data set into three different data\nsets (train, valid, and test) with the ratio of 8:1:1 according to the MOF\nstructure instead of randomly splitting, that is, there is no identical\nmaterial between the three datasets. The splitting ensures that the\nmodel accomplishes the prediction of new materials in validation and\ntest set, rather than those materials that have already been seen. The\nmodel parameters are optimized during the training process and\nreﬂected in the results of the validation set. The optimal model cor-\nresponding to the validation set is saved, and the prediction results in\nthe never-before-seen test set represent theﬁnal performance (R\n2\nshown here) of the model, thus reasonably avoiding over-ﬁtting.\nThe collected datasets, hMOF_MOFX_DB and CoRE_MOFX_DB,\nexhibit relatively concentrated temperature and pressure distribu-\ntions, as depicted in the sub-ﬁgure of Fig.2a, b. Notably, both data-\nbases offer adequate data, with over 2,000,000 and 400,000 data\npoints, respectively. The prediction results demonstrate that Uni-MOF\nis remarkably robust when applied to databases that possess sufﬁcient\ndata with relatively concentrated operating states, such as hMOF_-\nMOFX_DB and CoRE_MOFX_DB, with R\n2 values of 0.98 and 0.92,\nrespectively. In contrast, our CoRE_MAP_DB database, which we have\nlearned from Supplementary Table 1, contains slightly less than\n100,000 data points. It encompasses an extensive sampling of the\nadsorption of seven adsorbed gases in over 10,000 MOFs, covering a\ntemperature range of 150–300 K and a pressure range of 1 Pa–3b a r ,a s\ndepicted in the sub-ﬁgure of Fig.2c. For such a widely distributed\ndatabase, Uni-MOF can still achieve excellent prediction accuracy with\nan R\n2 value of 0.83, demonstrating its good generalizability.\nThe analysis also incorporates two other error metrics, i.e., Mean\nAbsolute Error (MAE) and Root Mean Square Error (RMSE). However,\nthe CoRE_MOFX dataset shows larger errors, particularly inRMSE.\nCoRE_MOFX dataset contains Ar and N2 adsorption amounts at 77 K\nand 87 K, which are signiﬁcantly lower temperatures compared to the\nother two databases. Consequently, the adsorption values in CoR-\nE_MOFX are generally larger. The adsorption isotherms with the most\nsigniﬁcant errors are depicted in Supplementary Fig. 1. MOF materials\nwith the largest error typically have Cu (with the lowest energy para-\nmeter of 2.52 K) as the metal site. This implies that MOF materials with\nlow energy parameter metal sites or large pore sizes are the limiting\nfactors for low-temperature data prediction. Intriguingly, even with\nthe highest errors, Uni-MOF can accurately reproduce the adsorption\ntrend from low to high pressure. Additionally, CoRE_MOFX_DB, as the\ncollected experimental structural database, contains 1800+ dis-\nordered materials out of 12,000+ MOFs. Disordered MOFs were found\nto adversely affect the model performance, as the unrealistic internal\nstructures and limited material samples lead to the challenging pre-\ndiction of gas adsorption, as demonstrated by the outlier\nja5111317_ja5111317_si_003_clean and LELDOX_clean in Supplementary\nTable 3. Therefore, disordered materials were excluded from the\ngenerated CoRE_MAP_DB database, which results in reduced errors\nand is more suggested to use for prediction of gas adsorption in\nnanoporous materials. The forceﬁe l du s e di nt h i sw o r kd o e sn o t\naccount the effect of open-metal sites. For the top ten outliers in the\nCoRE_MOFX_DB database (shown in Supplementary Table 4), 80% of\nthem have open-metal sites. This suggests that the signiﬁcant devia-\ntions between simulations and Uni-MOF predictions could be due to\nthe missing interaction between open-metal sites and adsorbate con-\nsidered in the simulation.\nAdditionally, we discovered that the prediction accuracy in the\npre-training stage could reach 0.98 before and after incorporating COF\nmaterials. This indicates that Uni-MOF is capable of effectively learning\nthe three-dimensional spatial structure of multiple nanoporous\nmaterials. As for the downstream tasks, the predictive performance\n(R\n2, RMSE,a n dMAE) of Uni-MOF for all three databases surpassed that\nof Uni-MOF with only MOF pre-training, as illustrated in Supplemen-\ntary Tables 5, 6. This indicates that incorporating COF not only main-\ntains but also enhances the model robustness, further demonstrating\nthe superiority of our Uni-MOF framework.\nExperimental adsorption uptake prediction\nDespite the excellent prediction performance of Uni-MOF on simu-\nlated results, we are wondering how the framework would behave in\ncomparison to the real experimentally collected results. In this study,\nwe have chosen commonly used laboratory materials, such as MOF-5\nand MOF-177\n40–43, and compared the predicted gas adsorption capacity\nwith existing experimental data. Considering that the CoRE_MAP_DB\ndatabase contains a diverse range of operating conditions and\nTable 1 | Structure & Data resources\nData Types Sources Availability Software Size\nStructure collection hMOF 50 — 137,000+\nStructure collection ToBaCCo — 10,000+\nStructure collection CoRE MOF 51 — 12,000+\nStructure collection CCDC — 12,000+\nStructure collection CoRE COF 52 — 600+\nStructure collection GCOFs 38 — 160,000+\nStructure generation this work ToBaCCo.3.0 300,000+\nAdsorption\nUptake Data\ncollection hMOF_\nMOFX_DB\n— 2,400,000+\nAdsorption\nUptake Data\ncollection CoRE_\nMOFX_DB\n— 460,000+\nAdsorption\nUptake Data\ngeneration this work RASPA 54 99,000+\nOther Property Data generation this work Zeo++ 60 149,000+\nArticle https://doi.org/10.1038/s41467-024-46276-x\nNature Communications|         (2024) 15:1904 4\nexperimentally validated MOF structures, we chose the weights\ntrained using this database to predict the adsorption performance of\nexperimental materials. Figure3 displays the predicted results under\ndifferent conditions, details are listed in Supplementary Tables 8–10.\nFigure 3a presents the Langmuir adsorption isotherm\n44 obtained\nby ﬁtting the predicted methane adsorption capacity under low pres-\nsure (less than 5 bar). It shows that the high pressure adsorption\ncapacity displayed by the Langmuir adsorption isotherm is consistent\nwith the experimental values. Speciﬁcally, the high pressure adsorp-\ntion capacity of (Zn2(bdc)2(dabco), methane, 393 K) > (MIL-101,\nmethane, 373 K) > (MOF-177, methane, 398 K). This suggests that the\nUni-MOF framework is capable of accurately screening high perfor-\nmance adsorbents under high pressure based solely on prediction\nadsorption capacity under low pressure. Nevertheless, we still notice\nsigniﬁcant deviations between many predicted and experimental\nvalues under low pressure, especially in the cases of Mg-dobdc and\nMOF-5. Simulations may not precisely represent experimental values\nfor MOFs with open metal sites, such as Mg-dobdc\n45.H o w e v e r ,M O F - 5\nhas close metal sites, and previous studies have shown that simulations\ncan effectively depict experimental gas adsorption values\n46.D e s p i t e\nthese ﬁndings, we observed that the gas adsorption performance of\nMOFs varies even under the same operating conditions (refer to\nSupplementary Tables 8–10). This suggests that different methods and\nsigniﬁcant objective errors exist in the experimental values. Therefore,\nwe did not purposely select data but instead aimed to provide as\ncomprehensive a representation of the collected data as possible. For\nexample, the black intersections in Fig.3e represent experimental\nvalues from various literature sources under identical operating con-\nditions. The results demonstrate that, despite signiﬁcant variations in\nexperimental values, the Uni-MOF framework maintains a high level of\naccuracy in material ranking, rendering it suitable for addressing\nengineering challenges.\nFurthermore, the experimental values are introduced to correct\nthe adsorption isotherms. For example, Fig.3b shows the Langmuir\nadsorption isotherm obtained by ﬁtting both the predicted and\nexperimental adsorption data. While we use simulated datasets to\naddress data scarcity, we can also properly introduce experimental\nvalues to correct adsorption isotherms, which helps a more quantita-\ntive prediction of adsorption performance at high-pressure where the\ngas-gas interaction becomes more signiﬁcant. In Fig. 3b, one can\nobserve that the corrected adsorption isotherms have a strong cor-\nrelation with experimental adsorption capacity to some extent. The\nresults exhibit that Uni-MOF not only has the ability to screen the\nadsorption performance of the same gas in different materials but also\nFig. 2 | Overall performance of Uni-MOF in large-scale databases.The correla-\ntion between predicted and simulated value of gas adsorption amount for (a)\nDatabase of hMOF_MOFX_DB (mol⋅kg−1), (b) Database of CoRE_MOFX_DB\n(cm3\nSTP /C1 g/C0 1) and (c) Database of CoRE_MAP_DB (cm3\nSTP /C1 g/C0 1). Sub-ﬁgure is the\ndistribution of temperature (K) and pressure (bar) for each database.R2 means\ncoefﬁcient of determination, MAE represents mean absolute error, MOF means\nmetal-organic framework. Source data are provided as a Source Dataﬁle.\nArticle https://doi.org/10.1038/s41467-024-46276-x\nNature Communications|         (2024) 15:1904 5\ncan accurately screen the adsorption performance of different gases in\nt h es a m em a t e r i a l( F i g .3c, d) or at different temperatures (Fig.3e, f).\nIn the foreseeable future, the intersection of Artiﬁcial Intelligence\n(AI) and materials science will necessitate the resolution of practical\nand scientiﬁc issues. Nonetheless, the attainment of process imple-\nmentation by AI in the realm of machine learning techniques that entail\ncopious amounts of data remains a formidable challenge, given the\ndearth of experimental data and the diverse array of synthetic tech-\nnology and characterization conditions implicated. Our research has\nmade a signiﬁcant stride in materials science by incorporating oper-\nating conditions into the Uni-MOF framework to ensure data adequacy\nand enable screening functions that are consistent with experimental\nﬁndings.\nCross-system forecasting\nIn order to showcase the predictive capabilities of Uni-MOF with\nregard to cross-system properties, ﬁve materials were randomly\nselected from each of the six systems (carbon-dioxide at 298 K,\nmethane at 298 K, krypton at 273 K, xenon at 273 K, nitrogen at 77 K\nand argon at 87 K) contained in databases hMOF_MOFX_DB and\nCoRE_MOFX_DB, which have been thoroughly sampled in terms of\ntemperature and pressure. The predicted and simulated values of gas\nadsorption uptake at varying pressures were then compared, with the\nresults presented in Fig.4a–f. Adsorption isothermsﬁtting from both\nUni-MOF predictions and simulated values would artiﬁcially reduce\nvisual errors. In order to eliminate data bias, adsorption isotherms in\nall cases were obtained only by simulated values. It is evident that, due\nto the fact that the adsorption isotherms were obtained purely\nthrough simulated values, the predicted values of adsorption uptake\ngenerated by Uni-MOF for the hMOF_MOFX_DB and CoRE_MOFX_DB\ndatabases align closely with the simulated values across all cases. This\nﬁnding is further supported by the high prediction accuracy demon-\nstrated in Fig.2a, b.\nGiven the ability of Uni-MOF to predict properties across systems,\nwe were intrigued by its potential to forecast the adsorption capacity\nof unknown gases. The CoRE_MAP_DB database contains a diverse\narray of adsorption data points for various gases, such as methane,\ncarbon dioxide, argon, krypton, xenon, oxygen, and helium. To eval-\nuate the predictive capability of Uni-MOF, we randomly divided the\nCoRE_MAP_DB data points by adsorbate gas into three datasets (train,\nFig. 3 | Adsorption isotherms based on low-pressure predictions and high-\npressure experimental values, each curve represents Langmuirﬁt. aUni-MOF\npredicted and (b) experimentally corrected adsorption isotherms of methane\nadsorption in Zn2(bdc)2(dabco), MIL-101 and MOF-177 at 393 K, 373 K, and 398 K,\nrespectively.c Uni-MOF predicted and (d) experimentally corrected adsorption\nisotherms of methane and carbon-dioxide adsorption in Mg-dobdc at 298 K.e Uni-\nMOF predicted and (f) experimentally corrected adsorption isotherms of methane\nand carbon-dioxide adsorption in MOF-5 at 298 K and 296 K. Each set of horizontal\nplots (i.e.,a and b, c and d, e and f) represents the same system, that is, the same\nMOF and gas molecule. The hollow marker represents the predicted value of Uni-\nMOF, and theﬁlled marker represents the experimental data referenced from\nprevious literature.\nArticle https://doi.org/10.1038/s41467-024-46276-x\nNature Communications|         (2024) 15:1904 6\nvalid, and test dataset with a ratio of 5:1:1), then predicted the\nadsorption capacity for each gas separately. The resulting predictions\nare depicted in Fig.4g and summarized in Supplementary Table 11.\nRemarkably, Uni-MOF demonstrated robustness in predicting the\nadsorption capacity of unknown gases, achieving a high prediction\naccuracy (R\n2) of 0.85 for krypton and a prediction accuracy above 0.35\nfor all unknown gases.\nOne can observe that prediction performance varies among gases.\nFor instance, Ar, Kr, and Xe are all noble gases with Kr demonstrating\nthe best performance among them withR2 of 0.85, while the prediction\nperformance of Xe is inferior (R2 = 0.41). A similar distribution of MOF\nmaterial features across Ar, Kr, and Xe databases is observed, as illu-\nstrated in the corresponding sub-ﬁgure of Supplementary Fig. 2,\nindicating that MOF material sampling differences have minimal\nimpact in this case. Despite the larger molecular diameter of Xe,\nmaking it less favorable for adsorption in small pores, it shows a higher\nadsorption limit (depicted in Supplementary Fig. 3) compared to\nargon and krypton. This may be a result of the greater energy para-\nmeters of Xe (ϵ = 167.1 K) when interacting with MOF material atoms. In\nthe sub-ﬁgure of Supplementary Fig. 2c, materials with high Xe\nadsorption capacity (exceeding 400 cm\n3 g−1) are highlighted in yellow.\nThese materials generally exhibit larger pore sizes and void fractions,\npossessing an largest cavity diameter (LCD) greater than 6.73Å,av o i d\nfraction exceeding 0.68, and a PLD of at least 4.18Å (close to the\nkinetic diameter of xenon with 3.96Å). Although it is challenging to\nestablish a comprehensive connection between model predictions and\nthe physicochemical properties of gases, it is discernible that gases\npossessing larger energy parameters typically demonstrate inferior\npredictive performance, such as CH\n4,C O2, and Xe. This phenomenon\ncan be attributed to the increased signiﬁcance of gas molecule inter-\nactions with escalating pressure, coupled with the complexity intro-\nduced by high energy parameters, ultimately complicating transfer\nlearning.\nNotwithstanding the challenges, encouraging outcomes can still\nbe observed, as the model precisely predicts the adsorption of mod-\nerate krypton, premised on the adsorption behavior of argon and\nxenon within the same inert gas category.\nIn this study, we showcase the general performance of Uni-MOF\nfor gas transfer learning, employing a database comprising fewer than\n100,000 data points. This suggests that even the optimal prediction\nconditions were not speciﬁcally selected, Uni-MOF is capable in engi-\nneering domains. To mitigate over-ﬁtting, the data is typically divided\ninto three sets. However, transfer learning across diverse gases pre-\nsents a considerable challenge, especially when confronted with a\nrestricted number of gas varieties and data points. As a result, in order\nto optimize the utilization of the scarce data, the results obtained by\ndividing the data into two datasets based on the gas types are also\nshown in Supplementary Fig. 5. Results revealed an improvement in\ntransfer learning accuracy for each gas to some extent. Unlike the\nprediction of adsorption between different materials, the prediction of\nFig. 4 | Uni-MOF cross-system prediction cases.The predicted and simulated\nvalues of gas adsorption amount versus pressure in hMOF_MOFX_DB database for\n(a) Carbon-dioxide at 298 K, (b) Methane at 298 K, (c) Krypton at 273 K and (d)\nXenon at 273 K, and in CoRE_MOFX_DB database for (e)N i t r o g e na t7 7Ka n d(f)\nArgon at 87 K. Different markers in eachﬁgure denote different MOF adsorbents.\nThe hollow marker represents the predicted adsorption uptake of Uni-MOF, and\nthe ﬁlled marker represents the simulated adsorption uptake in the database. The\nadsorption isotherms are obtained only by simulated values to eliminate data bias.\ng Gas transfer learning under multi-system conditions, with the random division\ninto three datasets (train, validation, and test dataset with a ratio of 5:1:1) according\nto adsorbate gases.h Predicted and simulated CH4 adsorption isotherms at 300 K\nin COF materials, different marker types represent different COFs. The hollow\nmarker means predicted value, theﬁlled marker represents simulated value.R\n2\nrepresents the coefﬁcient of determination. Source data are provided as a Source\nData ﬁle.\nArticle https://doi.org/10.1038/s41467-024-46276-x\nNature Communications|         (2024) 15:1904 7\nadsorption behavior for unknown gases is a formidable challenge.\nVariations in molecular size, surface adsorption energy, and inter-\nmolecular forces among different gas types have a signiﬁcant impact\non the adsorption mechanism and behavior. Despite this complexity,\nUni-MOF exhibits exceptional generalizability, as evidenced by its\nability to accurately predict the adsorption properties of unknown\ngases with only the support of adsorption data from other gases.\nFurthermore, we investigated the capability of Uni-MOF to predict\nthe gas adsorption behavior in COFs. Around 500 data points of CH\n4\nadsorption uptake in CoRE COFs at 300 K were simulated. Despite the\nlimited size of the COF adsorption database, Uni-MOF maintains high\npredictive performance, achieving anR2 of 0.76. Additionally, as shown\nin Fig.4h, Uni-MOF exhibits high ranking capability for the adsorption\nof diverse materials under various pressures.\nFramework applying pre-training\nIn order to verify that the self-supervised learning strategy of pre-\ntraining can effectively improve the robustness and downstream pre-\ndiction performance of the Uni-MOF, we established and compared\nUni-MOF w/o pre-training against Uni-MOF on three databases, namely\nCoRE_MOFX_DB, hMOF_MOFX_DB, and CoRE_MAP_DB. The CoR-\nE_MOFX_DB and hMOF_MOFX_DB databases exhibit a high degree of\ndata concentration, thereby enabling their partitioning into smaller\ndatabases containing adsorption data for various materials under\nidentical working conditions (i.e., same gas, temperature, and pres-\nsure). We trained both CoRE_MOFX_DB and hMOF_MOFX_DB data-\nbases using Uni-MOF and Uni-MOF w/o pre-training, and subsequently\ncalculated the coefﬁcients of determination for each small dataset. In\naddition, each small dataset is trained separately using the Uni-MOF\nframework to derive the corresponding coefﬁcient of determination.\nAs shown in Fig.5a, the ﬁlled markers represent the predictive\nperformance of the whole CoRE_MOFX_DB database. It can be seen\nthat the Uni-MOF performs better than Uni-MOF w/o pre-training. The\nself-supervised learning strategy of pre-training allows the model to\nlearn the three-dimensional conﬁguration of nanoporous materials in\ndepth, thus improving the accuracy of modelﬁne-tuning. In this part,\nthe data sets are divided in a manner where each set comprises the\nrelevant subsystem data. Therefore, all the hexagonal markers in\nFig. 5a represent the overall predicted performance of Uni-MOF.\nIndeed, Uni-MOF demonstrates equally high performance on the\ncomplete data set as it does on an individual data set, even when the\nperformance of a single data set relies on more extensive data than its\nspeciﬁc prediction task. Forﬁne-tuning of single-system tasks, that is,\ntraining individually for each small data set, the predicted perfor-\nmance hardly exceeded the performance of Uni-MOF. Thus, we know\nthat far-ranging data sampling can further promote the prediction\ncapacity of the learning model. The same conclusions can be sum-\nmarized for hMOF_MOFX_DB from Fig.5b.\nHowever, due to the scattered sampling of the CoRE_MAP_DB\ndatabase, limited small data sets cannot be divided following the same\nprocedure as the previous two databases. Therefore, the correlations\nbetween predicted and simulated values from Uni-MOF and Uni-MOF\nw/o pre-training are compared, shown in Fig.5c. Similarly, compared\nwith Uni-MOF w/o pre-training, the performance of Uni-MOF was\nFig. 5 | Uni-MOF and Uni-MOF w/o pre-training comparison.The performance\ncomparison of Uni-MOF and Uni-MOF w/o pre-training in (a) CoRE_MOFX_DB and\n(b) hMOF_MOFX_DB. Theﬁlled marker represents the prediction performance of\nthe entire database. The hollow marker represents the prediction performance of\nthe sub-dataset (certain gas, temperature and pressure). Details can be found in\nSupplementary Table 15–17. c The comparison of correlation between predicted\nand simulated value of gas adsorption amount via Uni-MOF and Uni-MOF w/o pre-\ntraining for CoRE_MAP_DB database.R\n2 means the coefﬁcient of determination.\nArticle https://doi.org/10.1038/s41467-024-46276-x\nNature Communications|         (2024) 15:1904 8\nimproved from 0.70 to 0.83, which further proved the signiﬁcance of\nthe pre-training strategy for Uni-MOF.\nStructural features prediction and high-throughput screening\nWhile the Uni-MOF framework is adept at discerning the spatial\narrangement of nanoporous materials, we aim to further explore its\npotential in forecasting structural attributes. The structural feature\nprediction results of Uni-MOF for the hMOF and CoRE_MOF materials\nlibraries are presented in Fig.6a–d.\nIt can be observed that the prediction performance of hMOF\nstructural parameters is generally superior to that of CoRE_MOF. By\nemploying a combination of structural building blocks (metal nodes,\nligands, and functional groups), the design space of the hypothetical\nMOF (hMOFs) dataset was fully explored, and structural features are\nmore evenly distributed compared to the CoRE_MOF dataset. Experi-\nmentally synthesized MOF materials (CoRE_MOF) tend to have struc-\ntural preferences for metal nodes (e.g., with zinc, copper, and\ncadmium) and linkers. Previous research has demonstrated that the\nexperimental MOF (CoRE-2019) is primarily concentrated in the small\npore region, while the hMOF (Tobacco) is more evenly distributed with\na slight shift of focus towards the large pore region\n47. The same\nobservation can be found in Supplementary Fig. 6, where Supple-\nmentary Fig. 6a and Supplementary Fig. 6b show the differences\nbetween CoRE_MOF and hMOF structures using the t-distributed sto-\nchastic neighbor embedding (t-SNE) method. Through Supplementary\nFig. 6c–f, it can be seen that the apertures of CoRE_MOF are obviously\nconcentrated in the small aperture region, especially the PLD. hMOF,\non the other hand, can still observe the aperture gradient due to its rich\nstructural sampling and data points, even though the apertures are\ngenerally small. Thus, for different types of databases, the prediction\nof structural features performs differently, especially for PLD. Notably,\nin materials such as hMOFs, its predictive capability attains a coefﬁ-\ncient of determination greater than 0.99, signifying a high level of\nprecision and dependability. One has come to recognize that Uni-MOF\ndemonstrates a strong capability in predicting the structural features\nof materials, owing to the utilization of pre-training on a substantial\nnumber of three-dimensional structures. Thus, Uni-MOF not only\naccurately predicts the desired performance of MOF materials but also\nprecisely predicts their structural features, which holds signiﬁcant\nimportance for material research and application.\nInnumerable nanoporous materials can be created with varied\nsecondary building units\n48, leading to exceptionally diverse MOF\nstructures, making MOF structure-property analysis a very strategic\ninitiative. In this work, multi-gas adsorption uptakes under various\noperating conditions were collected and generated, where the argon\nuptakes at 87 K and 1 bar is representative and analyzable. Argon\naccounts for the vast majority of noble gases in the atmosphere\n(9340 ppm at ambient conditions), and has been widely used for\ninsulation and illumination with a commercial value of 3.1 USD kg\n−114.\nFigure6e shows a comparison of the kernel density estimate (KDE) for\ndifferent structural features between the entire CoRE_MOF with argon\nadsorption values and MOFs in CoRE_MOF with the top 10% perfor-\nmance of argon adsorption. KDE visualizes the distribution of data\nusing a continuous probability density curve in a less cluttered way.\nAs the distribution of some structural features is bounded, it may\nlead to distortions (such as the minus value of surface area and\nvolume). However, it still presents interpretable and accurate trends in\nthe structure of top MOF adsorbents. The typical parameters\ndescribing pore sizes are as follows. 1) pore limiting diameter (PLD) is\nthe largest free sphere; 2) LCD is the largest included sphere along the\nfree sphere path. Thus, LCD is intrinsically larger than PLD in the same\nmaterial. Compared with the entire MOF database, the top 10% of\nMOFs have larger distribution values of 5–10 Å and 10–12 Å for PLD and\nLCD, respectively. The void fraction of the whole database is moder-\nately distributed around 0.5, while that of the top 10% MOFs is much\nlarger, mainly distributed around 0.75. Since most of the adsorption\nFig. 6 | Structural features prediction and analysis.The correlation between\npredicted and computational value of (a) Pore Limiting Diameter (PLD) (Å), (b)\nLargest Cavity Diameter (LCD) (Å), (c) void fraction, and (d) pore volume (cm3 g−1)\nof MOFs in hMOF (mainﬁgure) and CoRE_MOF (sub-ﬁgure) databases.\ne Comparison of the kernel density estimate (KDE) for different structural features\n[PLD (Å), LCD (Å), void fraction, surface area (m2 g−1), volume (Å3)] between the\nCoRE_MOF with all argon adsorption values and the CoRE_MOF with the top 10%\nperformance of argon adsorption at 87 K and 1 bar.R2 is the coefﬁcient of deter-\nmination, MOF means metal-organic framework. Source data are provided as a\nSource Dataﬁle.\nArticle https://doi.org/10.1038/s41467-024-46276-x\nNature Communications|         (2024) 15:1904 9\noccurs on the surface of nanoporous materials, the surface area\nbecomes one of the most critical determinants, and the results show\nthat the top 10% of MOFs possess a very large surface area of about\n3000 m2 g−1, which is consistent with common sense. The surface area\ndetermines the surface adsorption process, while the LCD determines\nthe internal absorption process. Therefore, the top 10% MOFs were\nclassiﬁed into three tiers according to their adsorption performance\non argon, and the numerical distribution of these two key factors\n(surface area/LCD) was explored (shown in Supplementary Fig. 8). One\ncan see that at 87 K and 1 bar, the most promising MOF adsorbents for\nargon mainly possess an LCD of about 15Å and a surface area of about\n4100 m\n2 g−1.\nModeling of material structural representation\nTo validate that the MOF structures are well learned in both the pre-\ntraining andﬁne-tuning stages, we visualize the structural features,\nwhich are 512-dimensional vectors, using the t-SNE method49.T h e\nresults are shown in Fig.7. As illustrated in Fig.7a, b, the learned\nfeatures are capable of classifying MOFs either from CoRE_MOF or\nhMOF datasets. One may also notice that the boundary between\nCoRE_MOF and hMOF in theﬁne-tuned features is much more obvious,\nsuggesting a signiﬁcant improvement of these features after theﬁne-\ntuning. Remarkably, this is clearly demonstrated when we draw the\nembeddings versus the surface areas of MOFs, as shown in Fig.7d,\nwhere the structures with small surface areas are located in the upper-\nright and lower-left corners, and the structures with large surface areas\nare in the center. In comparison to the pre-training features, Fig.7c, the\nﬁne-tuning can signiﬁcantly improve the representation quality.\nOn the other hand, we are more curious about whether the\nlearned structural representations are closely correlated with the\nadsorption behaviors. To address this issue, we visualize the structural\nembeddings versus the adsorbate values of both Ar and N\n2,a n ds h o w\nthe result of Ar here as an example, see Fig.7e–f. As one can observe,\nthe representations learned in the pre-training stage are not able to\nclassify the structures with different adsorbate capacities while struc-\ntures with various adsorbate values are grouped together, see Fig.7e.\nHowever, after theﬁne-tuning, the structures with different adsorbate\nbehaviors are well separated, demonstrating a good relationship\nbetween the learned representations and the target of adsorbate\nvalues, see Fig.7f. This well explained the functions of theﬁne-tuning\nstage in further affecting the structural representations as well as other\nmodel parameters.\nFurthermore, the multi-head attention mechanism of the Trans-\nformer can learn the interactions within the material structure. With\nthe 64-Heads attention algorithm, the atomic interaction landscapes of\nhmof-5004238 in two different heads are represented in Fig.7h, i. As\nshown in Fig.7h, strong interactions can be observed between the\nmetal sites (Zn), Zn and O atom, and also O atoms. Figure7i also\ndepicts the interaction between the linear carbon chains (C7-C15). In\naddition, there is a noticeable correlation between the O0 atom and\nthe Zn atoms (Zn0, Zn2, Zn4, Zn6). The structural illustration in Fig.7g\nfurther conﬁrms this result, as the four atoms are chemically linked.\nBeyond this, the various chemical landscapes of hmof-5004238 in\ndifferent heads are depicted in Supplementary Fig. 9. In this manner,\nUni-MOF identiﬁes tremendous materials and provides reliable pre-\ndictions for diverse properties.\nConclusion\nIn this study, we introduced Uni-MOF, a multi-purpose framework that\ncan accurately predict gas adsorption in MOF materials. We also\nFig. 7 | Visualization of structural representations of MOFs in the hMOF and\nCoRE_MOF datasets, the low-dimensional embeddings are computed by t-SNE\n(t-distributed stochastic neighbor embedding) method.The representations\nretrieved after (a), (c), and (e) pre-training and (b), (d), and (f) ﬁne-tuning versus the\nother properties.a, b The low-dimensional embeddings versus dataset labels,\nwhere darker color represents CoRE_MOF and lighter color represents hMOF.\nc, d illustrate the representations versus surface area in m2 g−1 for hMOF and\nCoRE_MOF combined.e, f show the relationship of representations with respect to\nthe adsorbate values of Ar at 87 K, 0.01 Pa for the CoRE_MOF dataset only.\nExplainable Artiﬁcial Intelligence (XAI).g Illustration of hMOF-5004238 structure\nand (h), (i) heat map of atomic interactions learning from multi-head attention\nalgorithm in head 10 and head 18. MOF means metal-organic framework. Source\ndata are provided as a Source Dataﬁle.\nArticle https://doi.org/10.1038/s41467-024-46276-x\nNature Communications|         (2024) 15:1904 10\ngenerated, collected, and organized relevant databases of nanoporous\nmaterials and gas adsorption datasets. The self-supervised learning of\na database containing over 631,000 MOFs and COFs was performed,\nresulting in a high prediction accuracy of 0.98. This indicates that the\nrepresentation learning framework based on three-dimensional pre-\ntraining effectively learns the complex structural information of MOFs\nwhile avoiding over-ﬁtting. We applied Uni-MOF to predict the gas\nadsorption performance of three major databases and achieved a high\nprediction accuracy of up to 0.98 in database with sufﬁcient data. In\nthe case of a sufﬁciently sampled dataset, Uni-MOF not only maintains\na predictive accuracy above 0.83, but also accurately selects high-\nperformance adsorbents under high pressure by solely predicting\nadsorption under low pressure, consistent with experimental screen-\ning results. Thus, Uni-MOF represents a signiﬁcant breakthrough in the\nﬁeld of material science with regards to the application of machine\nlearning techniques. Furthermore, our Uni-MOF framework shows\nsuperior performance on cross-system datasets compared to single-\nsystem tasks and can accurately predict the adsorption properties of\nu n k n o w ng a s e sw i t hah i g hp r e d i c t i o na c c u r a c yo fu pt o0 . 8 5 ,\ndemonstrating its strong predictive ability and generality. Through\nextensive pre-training of three-dimensional structures, Uni-MOF\neffectively learns the structural features of MOFs, achieving a high\ncoefﬁcient of determination of 0.99 for hMOFs. Additionally, t-SNE\nanalysis conﬁrms that theﬁne-tuning stage can further learn structural\nfeatures, and structures with different adsorbate behaviors are well\nidentiﬁed, indicating a strong correlation between learned repre-\nsentations and gas adsorption targets.\nOur database encompasses a pressure range of 0–10 bar and\ntemperature ranges of 77–87 K and 150–300 K, making it suitable for\nthe majority of gas adsorption issues. Uni-MOF has demonstrated\nprecise prediction outcomes for a fairly comprehensive collection of\nMOF structures and distinct COF materials. Even under some extreme\nconditions, the predicted trend remains highly dependable. With Uni-\nMOF, the continuous updating of databases and even usage scenarios\nare supportable, which further emphasizes its universality. In sum-\nmary, Uni-MOF framework serves as a versatile predictive platform for\nMOF materials, functioning as a gas adsorption estimator for MOFs, as\nit exhibits high precision in predicting gas adsorption under diverse\noperating conditions and has broad applications in theﬁeld of material\nscience.\nMethods\nMaterials and data collection and generation\nThe MOF/COF structures used for pre-training are either collected\nfrom the currently available database or generated using the corre-\nsponding program. There is a wealth of existing MOF/COF databases,\nincluding computer-synthesized databases of hMOFs\n50, ToBaCCo\n(Topologically Based Crystal Constructor) MOFs, and experimental-\nlevel databases of CoRE (Computation-Ready Experimental) MOFs51,\nCoRE COFs52 and CCDC (The Cambridge Crystallographic Data Cen-\ntre), etc. One integrated database online isMOFXDB, where more than\n168,000 MOF/COF structures are available. Apart from exploring\nnanoporous materials in the materials library, we employed the\nToBaCCo.3.0program to generate over 306,773 MOF structures. The\nToBaCCo program takes as input a topological blueprint, searches\ncompatible node building blocks from a deﬁned set, and constructs all\npossible structures using the topology in combination with different\nnode building blocks and edge building blocks. In particular, the\nprogram generates structures with three folders as input variables, i.e.,\n“templates”, “nodes”, “edges”. To generate as many MOF structures as\npossible, we use all edges as provided in“edges_database”, all nodes as\nprovided in“nodes_database” and all templates as provided in“tem-\nplate_database”. For the downstream task, i.e., gas adsorption uptake\nby MOFs, we collected data from online sources such asMOFXDB,\ncomposing datasets of more than 2,400,000 sorptions of hMOFs on\nﬁve gases (CO\n2,N 2,C H4, Kr, Xe) at 273/298 K and 0.01–10 Pa and over\n460,000 sorptions of CoRE MOFs on two gases (Ar, N2)a t7 7 / 8 7Ka n d\n1–105 Pa. In this work, only single component gas adsorption data are\nconsidered. In addition, we conducted Grand Canonical Monte Carlo\n(GCMC)53 simulations using the RASPA54 software to produce another\n99,000+ gas adsorption uptake dataset, with 50,000 initialization\ncycles and an additional 50,000 cycles employed for adsorption\ncapacity samples. The collected sorptions were obtained within\n150–300 K and 1 Pa–3 bar, considering seven types of gas molecules\n(CH\n4,C O2,A r ,K r ,X e ,O2, He). Interactions between gas molecules and\natoms in adsorbent materials were described in terms of Lennard-\nJones (12–6) potential, and the cutoff radius is set to 12.9Å with the tail-\ncorrection. The force ﬁeld parameters of framework atoms were\ndescribed by UFF (Universal Force Field)\n55.T h ef o r c eﬁeld parameters\nof noble gas molecules (i.e., argon, krypton, and xenon) were esti-\nmated from the principle of corresponding states for the second virial\ncoefﬁcients56 (listed in Supplementary Table 19). The molecular model\nTransferable Potentials for Phase Equilibria57 was also used. In our\nwork, the partial charge of the framework atoms is not considered\nbecause of computational cost and signiﬁcant deviations observed in\nadsorption results by using different partial charges assignment\nmethods\n58.\nMaterial analysis\nThe key to high-throughput computational materials science is robust\nsoftware tools. Here, we use the Python Materials Genomics\n59\n(pymatgen), a robust and open-source Python library, to derive useful\nmaterial properties from raw crystallographic structural data and\nconduct comprehensive materials analysis. Materials properties,\nincluding lattice vectors, lattice angles, unit cell volume, atoms, and\ncoordinates, are extracted using the pymatgen. The atom types and\ncoordinates will be used in the pre-training stage for the self-\nsupervised learning strategy. The Python package -\nOpenMetalDetector\n51, was used to analyze collections of Metal Organic\nFrameworks for open metal sites.\nUni-MOF framework\nPre-training. We employed Uni-Mol as the pre-training framework,\nwhich is a dedicated pure three-dimensional pre-training framework\ndesigned for molecules. Uni-Mol has shown high performance in var-\nious downstream tasks in theﬁeld of drug discovery. However, due to\nthe completely different structure and three-dimensional spatial dis-\ntribution of MOF materials compared to small molecule drugs, as well\nas the periodic boundary conditions (PBC) of porous structures and\nthe much larger number of heavy atoms in crystals, we made necessary\nmodiﬁcations to Uni-Mol based on these facts.\n1) We leverage an extra head of the lattice matrix to preserve cell\ngeometric information. The presence of PBC is considered in MOF\nrepresentation learning as PBC is natural for MOF materials. Besides\nmasked atoms prediction and coordinates recovery in Uni-Mol pre-\ntraining, a regression head to prediction lattice 3 × 3 matrix is used to\nlearn the PBC information.\nL\nlattice = MSEðA, ^AÞ = 1\nn\nXn\ni =1\n∣Ai /C0 FFN ðCLSi\nrepr Þ∣\n2\nð1Þ\nL= Llattice + LUni/C0 Mol ð2Þ\nwhere CLSrepr indices representation of Uni-Mol for classiﬁcation\ntoken, classiﬁcation token (CLS) refers to the special token in the input\nsequence of atoms, which is used to represent the entire molecule in\nthe output of Uni-Mol.A is the lattice matrix, we use Feedforward\nNeural Network (FFN)o f CLS\nrepr to predict lattice matrix with\noptimizing MSE loss directly. L in Uni-MOF pre-training is a\nArticle https://doi.org/10.1038/s41467-024-46276-x\nNature Communications|         (2024) 15:1904 11\nsummation ofLlattice and originalLUni/C0 Mol .I n LUni/C0 Mol , the atom-\nmasked prediction and coordinates recovery are two major compo-\nnents of loss items. For more details, the readers are welcome to refer\nto original paper of Uni-Mol.\n2) We propose an edge gated kernel for geometric spatial posi-\ntional encoding. MOFs share totally different arrangement of atoms\ncompared to drug molecules in three-dimensional space, with porous\nstructures and an average above 1000 heavy atoms in a single cell. Uni-\nMol uses a Gaussian kernel to encode spatial positional information,\nwhile in MOF pre-training suffers from training instability with a\nGaussian kernel of much larger pair distance and atom counts. To\naddress this, we propose an edge gated distance kernel.\nAðd, r; a, bÞ = a\nrd + br ð3Þ\npij = pproj\nij + pemb\nij = LNðFFN ðdijÞÞ + σðAðdij, tij; a, bÞÞ /C1 Embedding ðtijÞ\nð4Þ\nwhere dij is the Euclidean distance of atom pairij,a n dtij is the edge\ntype of atom pairij. Please note the edge here is not the chemical bond,\nand edge type is determined by the atom types of pairij. Að/C1 ,/C1 ; a, bÞ is\nthe afﬁne transformation with parametersa and b,i ta fﬁnes dij corre-\nsponding to its edge type.pij indices the edge gated distance kernel,\nwhich is a summation of distance projection and edge gated embed-\nding. FFN is the Feedforward Neural Network about the non-linear\ntransformation of distanced\nij, and LN is the LayerNorm operation. A\nsigmoid gated is used as the afﬁne transformation ofA to weight edge\npair type embedding.\nFine-tuning. Prediction of multi-gas adsorption under different oper-\nating conditions, theﬁne-tuning model should be fed with not only the\nthree-dimensional spatial structure but also the gas and operating\nconditions (i.e., temperature and pressure). Therefore, gas block and\ntemperature/pressure blocks are proposed in Uni-MOF to form a\ncross-system performance prediction module.\nGas blockThe gas representation is a combination of gas id and\ngas intrinsic property-related descriptors.\n^x\ng = concatðEembedding ðgiÞ; FFN ðgxÞÞ ð5Þ\nwhere gi i n d i c e st h eg a si do fg a sg, gx represents the gasg descriptors\n(listed in Supplementary Table 2). The gas representationbxg is a con-\ncatenation of gas id embedding and FFN layer mapping of gas\ndescriptors.\nNum block We use Equal Distance Discretization (EDD) and\nLogarithm Discretization (LD) for temperature and pressure encoding,\nrespectively. EDD ﬁrst maps the numerical value into the corre-\nsponding bucket with equal width, then applies embedding mapping.\nLD utilizes the logarithm transform with EDD to accommodate loga-\nrithmic likely features.\nEDDðx\njÞ = Eembedding ðbððxj /C0 xmin\nj Þ=wÞcÞ ð 6Þ\nLDðxjÞ = EDDðlog10ðxjÞÞ ð7Þ\nxnum = concatðEDDðxtempÞ; FFNðxtemp Þ; LDðxpressure Þ; FFNðxpressure ÞÞ\nð8Þ\nwhere the interval width is noted asw = ðxmax\nj /C0 xmin\ni Þ=Nj, x denotes\nnumerical features,xtemp and xpressure are the original temperature and\npressure values of the corresponding environment. For the tempera-\nture feature, we useEDD and FFN embeddings, and for the pressure\nfeature, we choose to useLD and FNN with consideration of logarith-\nmic likely transformation in pressure.\nHigh-throughput analysis of large MOF database\nTo further investigate the effect of material structure on gas adsorp-\ntion, Zeo++\n60, a software package for crystalline porous materials\nanalysis, was used to perform an analysis of the structure and topology\nof the material geometry. Structural features include the LCD, PLD,\nvoid fraction, void volume, and speciﬁc surface area. The internal void\nvolume can largely inﬂuence the performance of nanoporous materi-\nals. Precise deﬁnitions exist for volume from different methods,\nespecially the accessible and nonaccessible probe center pore volume\n(Ac-PC, NAc-PC), accessible and nonaccessible probe-occupiable pore\nvolume (Ac-PO, NAc-PO)\n61. The concept of accessibility relies on the\nprobe size, and a probe of the radius of 1.8Å is used in our work in\norder to directly relate the pore volumes to experimentally measured\nNitrogen (kinetic diameter of 3.64Å) isotherms. Accessible volume\ncalculated here is also deﬁned as the volume available to the center of\nthe spherical probe, corresponding to the accessible probe center\npore volume.\nStatistical data visualization\nIn this work, Python data visualization libraries such as seaborn62 and\nmatplotlib63 were used for informative statistical graphics. Three-\ndimensional structures are drawn using the web service BohriumTM at\nhttps://bohrium.dp.tech.\nComputing environment\nUni-MOF pre-training andﬁne-tuning are performed on V100/A100\nGPUs, and Monte Carlo simulations are performed on CPU cluster of\nBohrium\nTM.\nReporting summary\nFurther information on research design is available in the Nature\nPortfolio Reporting Summary linked to this article.\nData availability\nThe data presented in this study are available in the manuscriptﬁle,\nthe Supplementary Informationﬁle and Source Dataﬁles. Source Data\nin this study have been deposited in theﬁgshare database64 under\naccession code ofhttps://doi.org/10.6084/m9.ﬁgshare.24996317.\nCode availability\nCode to run the Uni-MOF model is available in GitHub (https://github.\ncom/dptech-corp/Uni-MOF)65.\nThe notebook demo can be found athttps://bohrium.dp.tech/\nnotebook/cca98b584a624753981dfd5f8bb79674.\nReferences\n1. Sholl, D. S. & Lively, R. P. Seven chemical separations to change the\nworld. Nature 532,4 3 5–437 (2016).\n2. Kohl, A. L. & Nielsen, R.Gas Puriﬁcation (Elsevier, 1997).\n3. Yang, R. T. Gas Separation by Adsorption Processes,V o l .1( W o r l d\nScientiﬁc, 1997).\n4 . B o y d ,P .G .e ta l .D a t a - d r i v e nd e s i g no fm e t a l–organic frameworks\nfor wetﬂue gas CO2 capture.Nature 576,2 5 3–256 (2019).\n5. Koytsoumpa, E. I., Bergins, C. & Kakaras, E. The CO2 economy:\nreview of CO2 capture and reuse technologies.J. Supercrit. Fluids\n132,3 –16 (2018).\n6. Kather, A. & Scheffknecht, G. The oxycoal process with cryogenic\noxygen supply.Naturwissenschaften96, 993–1010 (2009).\n7. Jee, J.-G., Kim, M.-B. & Lee, C.-H. Pressure swing adsorption pro-\ncesses to purify oxygen using a carbon molecular sieve.Chem. Eng.\nSci. 60,8 6 9–882 (2005).\nArticle https://doi.org/10.1038/s41467-024-46276-x\nNature Communications|         (2024) 15:1904 12\n8. Van Groenestijn, J. & Kraakman, N. Recent developments in biolo-\ngical waste gas puriﬁcation in europe.Chem. Eng. J.113,\n85–91 (2005).\n9. Zhuang, L.-L., Yang, T., Zhang, J. & Li, X. The conﬁguration, pur-\niﬁcation effect and mechanism of intensiﬁed constructed wetland\nfor wastewater treatment from the aspect of nitrogen removal: a\nreview. Bioresour. Technol.293, 122086 (2019).\n10. Akerib, D. et al. Chromatographic separation of radioactive noble\ngases from xenon.Astropart. Phys.97,8 0–87 (2018).\n11. Lu, Z.-T. et al. Tracer applications of noble gas radionuclides in the\ngeosciences.Earth Sci. Rev.138,1 9 6–214 (2014).\n12. Furukawa, H., Cordova, K. E., O’Keeffe, M. & Yaghi, O. M. The\nchemistry and applications of metal-organic frameworks.Science\n341, 1230444 (2013).\n1 3 . D i n g ,M . ,C a i ,X .&J i a n g ,H . - L .I m p r o v i n gm o fs t a b i l i t y :a p p r o a c h e s\nand applications.Chem. Sci.10,1 0 2 0 9–10230 (2019).\n14. Wang, J., Zhou, M., Lu, D., Fei, W. & Wu, J. Virtual screening of\nnanoporous materials for noble gas separation.ACS Appl. Nano\nMater. 5,3 7 0 1–3711 (2022).\n15. Yang, Q., Liu, D., Zhong, C. & Li, J.-R. Development of computational\nmethodologies for metal–organic frameworks and their application\nin gas separations.Chem. Rev.113,8 2 6 1–8323 (2013).\n16. Li, J.-R., Kuppler, R. J. & Zhou, H.-C. Selective gas adsorption and\nseparation in metal–organic frameworks.C h e m .S o c .R e v .38,\n1477–1504 (2009).\n17. Knebel, A. & Caro, J. Metal–organic frameworks and covalent\no r g a n i cf r a m e w o r k sa sd i s r u p t i v em e m b r a n em a t e r i a l sf o re n e r g y -\nefﬁcient gas separation.Nat. Nanotechnol.17,9 1 1–923 (2022).\n18. Zhou, M. & Wu, J. Inverse design of metal–organic frameworks for\nc2h4/c2h6 separation.npj Comput. Mater.8, 256 (2022).\n19. Wang, J., Zhou, M., Lu, D., Fei, W. & Wu, J. Computational screening\nand design of nanoporous membranes for efﬁcient carbon isotope\nseparation.Green. Energy Environ.5,3 6 4–373 (2020).\n20. Lin, R.-B., Xiang, S., Zhou, W. & Chen, B. Microporous metal-organic\nframework materials for gas separation.Chem 6, 337–363 (2020).\n21. Banerjee, D. et al. Metal–organic framework with optimally selective\nxenon adsorption and separation.Nat. Commun.7,\nncomms11831 (2016).\n2 2 . I f t i m i e ,R . ,M i n a r y ,P .&T u c k e r m a n ,M .E .A bi n i t i om o l e c u l a r\ndynamics: Concepts, recent developments, and future trends.\nP r o c .N a t lA c a d .S c i .102, 6654–6659 (2005).\n23. Hollingsworth, S. A. & Dror, R. O. Molecular dynamics simulation for\nall. Neuron 99,1 1 2 9–1143 (2018).\n24. Rubinstein, R. Y. & Kroese, D. P.Simulation and the Monte Carlo\nMethod (John Wiley & Sons, 2016).\n25. Weinan, E., Ren, W. & Vanden-Eijnden, E. String method for the\nstudy of rare events.Phys. Rev. B66,0 5 2 3 0 1( 2 0 0 2 ) .\n26. Zhou, M. & Wu, J. A gpu implementation of classical density func-\ntional theory for rapid prediction of gas adsorption in nanoporous\nmaterials.J. Chem. Phys.153, 074101 (2020).\n2 7 . A l t i n t a s ,C . ,A l t u n d a l ,O .F . ,K e s k i n ,S .&Y i l d i r i m ,R .M a c h i n el e a r n i n g\nmeets with metal organic frameworks for gas storage and separa-\ntion. J. Chem. Inf. Model.61,2 1 3 1–2146 (2021).\n28. Abdi, J. & Mazloom, G. Machine learning approaches for predicting\narsenic adsorption from water using porous metal–organic frame-\nworks. Sci. Rep.12, 16458 (2022).\n29. Nandy, A. et al. Mofsimplify, machine learning models with\nextracted stability data of three thousand metal–organic frame-\nworks. Sci. Data9, 74 (2022).\n30. Scarselli, F., Gori, M., Tsoi, A. C., Hagenbuchner, M. & Monfardini, G.\nThe graph neural network model.IEEE Trans. Neural Netw.20,\n61–80 (2008).\n3 1 . X i e ,T .&G r o s s m a n ,J .C .C r y s t a lg r a p hc o n v o l u t i o n a ln e u r a ln e t -\nworks for an accurate and interpretable prediction of material\nproperties.Phys. Rev. Lett.120,1 4 5 3 0 1( 2 0 1 8 ) .\n32. Vaswani, A. et al. Attention is all you need.Advances in Neural\nInformation Processing Systems(eds Guyon, I. et al.) Vol. 30\n(Curran Associates, Inc., 2017).\n33. Kang, Y., Park, H., Smit, B. & Kim, J. A multi-modal pre-training\ntransformer for universal transfer learning in metal-organic frame-\nworks. Nat. Mach. Intell.5,3 0 9–318 (2023).\n34. Cao, Z., Magar, R., Wang, Y. & Barati Farimani, A. Moformer:\nself-supervised transformer model for metal–\norganic frame-\nwork property prediction. J. Am. Chem. Soc.145,2 9 5 8–2967\n(2023).\n35. Zhou, G. et al. Uni-mol: a universal 3d molecular representation\nlearning framework. InProc. International Conference on Learning\nRepresentations(2023).\n36. Colón, Y. J., Gómez-Gualdrón, D. A. & Snurr, R. Q. Topologically\nguided, automated construction of metal-organic frameworks and\ntheir evaluation for energy-related applications.Cryst. Growth Des.\n17,5 8 0 1–5810 (2017).\n37. Gómez-Gualdrón, D. A. et al. Evaluating topologically diverse\nmetal-organic frameworks for cryo-adsorbed hydrogen storage.\nEnergy Environ. Sci.9,3 2 7 9–3289 (2016).\n38. Lan, Y. et al. Materials genomics methods for high-throughput\nconstruction of cofs and targeted synthesis.Nat. Commun.9,\n5274 (2018).\n39. Kenton, J. D. M.-W. C. & Toutanova, L. K. Bert: Pre-training of deep\nbidirectional transformers for language understanding. InProc. of\nnaacL-HLT,v o l .1 ,2( 2 0 1 9 ) .\n4 0 . N a t h ,K . ,A h m e d ,A . ,S i e g e l ,D .J .&M a t z g e r ,A .J .M i c r o s c a l e\ndetermination of binary gas adsorption isotherms in mofs.J. Am.\nChem. Soc.144,2 0 9 3 9–20946 (2022).\n41. Zhao, Z., Li, Z. & Lin, Y. Adsorption and diffusion of carbon dioxide\non metal- organic framework (mof-5).Ind. Eng. Chem. Res.48,\n10015–10020 (2009).\n42. Walton, K. S. et al. Understanding inﬂe c t i o n sa n ds t e p si nc a r b o n\ndioxide adsorption isotherms in metal-organic frameworks.J. Am.\nChem. Soc.130,4 0 6–407 (2008).\n43. Nugent, P. et al. Porous materials with optimal adsorption thermo-\ndynamics and kinetics for co2 separation.Nature 495,8 0–84\n(2013).\n44. Duff, D. G., Ross, S. M. & Vaughan, D. H. Adsorption from solution:\nan experiment to illustrate the langmuir adsorption isotherm.J.\nChem. Educ.65, 815 (1988).\n4 5 . K r i s h n a ,R .&v a nB a t e n ,J .M .I ns i l i c os c r e e n i n go fm e t a l–organic\nframeworks in separation applications.P h y s .C h e m .C h e m .P h y s .13,\n10593–10616 (2011).\n4 6 . P i l l a i ,R .S . ,P i n t o ,M .L . ,P i r e s ,J . ,J o r g e ,M .&G o m e s ,J .R .U n d e r -\nstanding gas adsorption selectivity in irmof-8 using molecular\nsimulation.ACS Appl. Mater. Interfaces7,6 2 4–637 (2015).\n47. Moosavi, S. M. et al. Understanding the diversity of the metal-\norganic framework ecosystem.Nat. Commun.11\n,1 –10 (2020).\n48. Kalmutzki, M. J., Hanikel, N. & Yaghi, O. M. Secondary building units\nas the turning point in the development of the reticular chemistry of\nmofs. Sci. Adv.4,e a a t 9 1 8 0( 2 0 1 8 ) .\n49. van der Maaten, L. & Hinton, G. Visualizing data using t-sne.J. Mach.\nLearn. Res.9,2 5 7 9–2605 (2008).\n50. Chung, Y. G. et al. In silico discovery of metal-organic frameworks\nfor precombustion co2 capture using a genetic algorithm.Sci. Adv.\n2, e1600909 (2016).\n51. Chung, Y. G. et al. Advances, updates, and analytics for the com-\nputation-ready, experimental metal–organic framework database:\ncore mof 2019.J .C h e m .E n g .D a t a64,5 9 8 5–5998 (2019).\n52. Tong, M., Lan, Y., Yang, Q. & Zhong, C. Exploring the structure-\nproperty relationships of covalent organic frameworks for noble\ngas separations.C h e m .E n g .S c i .168,4 5 6–464 (2017).\n53. Hammersley, J.Monte Carlo Methods(Springer Science & Business\nMedia, 2013).\nArticle https://doi.org/10.1038/s41467-024-46276-x\nNature Communications|         (2024) 15:1904 13\n54. Dubbeldam, D., Calero, S., Ellis, D. E. & Snurr, R. Q. Raspa: mole-\ncular simulation software for adsorption and diffusion inﬂexible\nnanoporous materials.Mol. Simul.42,8 1–101 (2016).\n55. Rappé, A. K., Casewit, C. J., Colwell, K., Goddard III, W. A. & Skiff,\nW. M. UFF, a full periodic table forceﬁeld for molecular mechanics\nand molecular dynamics simulations.J. Am. Chem. Soc.114,\n10024–10035 (1992).\n56. Boato, G. & Casanova, G. A self-consistent set of molecular para-\nmeters for neon, argon, krypton and xenon.Physica 27,\n571–589 (1961).\n57. Martin, M. G. & Siepmann, J. I. Transferable potentials for phase\nequilibria. 1. united-atom description of n-alkanes.J. Phys. Chem. B\n102,2 5 6 9–2577 (1998).\n58. Altintas, C. & Keskin, S. Role of partial charge assignment methods\nin high-throughput screening of mof adsorbents and membranes\nfor co 2/ch 4 separation.Mol. Syst. Des. Eng.5,5 3 2–543 (2020).\n59. Ong, S. P. et al. Python materials genomics (pymatgen): a robust,\nopen-source python library for materials analysis.Comput. Mater.\nSci. 68,3 1 4–319 (2013).\n60. Willems, T. F., Rycroft, C. H., Kazi, M., Meza, J. C. & Haranczyk, M.\nAlgorithms and tools for high-throughput geometry-based analysis\nof crystalline porous materials.Microporous Mesoporous Mater.\n149,1 3 4–141 (2012).\n61. Ongari, D. et al. Accurate characterization of the pore volume in\nmicroporous crystalline materials.Langmuir33,1 4 5 2 9–14538 (2017).\n62. Waskom, M. L. seaborn: statistical data visualization.J. Open Source\nSoftw. 6, 3021 (2021).\n63. Hunter, J. D. Matplotlib: a 2d graphics environment.Comput. Sci.\nEng. 9,9 0–95 (2007).\n64. Wang, J. Source Dataﬁle. ﬁgshare https://ﬁgshare.com/articles/\ndataset/Source_Data_ﬁle_zip/24996317(2024).\n65. Jingqi. dptech-corp/uni-mof: Vol. 2https://doi.org/10.5281/\nzenodo.10521477(2024).\nAcknowledgements\nD.L. was supported by National Natural Science foundation of China, No.\nU1862204 and 21878175. This research was supported in part by the\nTsinghua University and the DP Technology.\nAuthor contributions\nJ.W.(Wang) and J.L. contributed equally to this work. D.L., Z.G. and\nJ.W.(Wu) designed and guided the project. J.W.(Wang), J.L. and Z.G.\nperformed the data collection, developed the breakthrough model and\ndrafted the paper. H.W., M.Z., G.K.and L.Z. provided important advice\nand revised the paper. All authors contributed to the discussion of\nresults and commented on the paper.\nCompeting interests\nThe authors declare no competing interests.\nAdditional information\nSupplementary informationThe online version contains\nsupplementary material available at\nhttps://doi.org/10.1038/s41467-024-46276-x.\nCorrespondenceand requests for materials should be addressed to\nJianzhong Wu, Zhifeng Gao or Diannan Lu.\nPeer review informationNature Communicationsthanks Ilia Kevlishvili,\nand the other, anonymous, reviewer(s)for their contribution to the peer\nreview of this work. A peer reviewﬁle is available.\nReprints and permissions informationis available at\nhttp://www.nature.com/reprints\nPublisher’s noteSpringer Nature remains neutral with regard to jur-\nisdictional claims in published maps and institutional afﬁliations.\nOpen AccessThis article is licensed under a Creative Commons\nAttribution 4.0 International License, which permits use, sharing,\nadaptation, distribution and reproduction in any medium or format, as\nlong as you give appropriate credit to the original author(s) and the\nsource, provide a link to the Creative Commons licence, and indicate if\nchanges were made. The images or other third party material in this\narticle are included in the article’s Creative Commons licence, unless\nindicated otherwise in a credit line to the material. If material is not\nincluded in the article’s Creative Commons licence and your intended\nuse is not permitted by statutory regulation or exceeds the permitted\nuse, you will need to obtain permission directly from the copyright\nholder. To view a copy of this licence, visithttp://creativecommons.org/\nlicenses/by/4.0/.\n© The Author(s) 2024\nArticle https://doi.org/10.1038/s41467-024-46276-x\nNature Communications|         (2024) 15:1904 14",
  "topic": "Overfitting",
  "concepts": [
    {
      "name": "Overfitting",
      "score": 0.8838400840759277
    },
    {
      "name": "Metal-organic framework",
      "score": 0.7578011751174927
    },
    {
      "name": "Computer science",
      "score": 0.6409074068069458
    },
    {
      "name": "Adsorption",
      "score": 0.638954758644104
    },
    {
      "name": "Representation (politics)",
      "score": 0.4563681483268738
    },
    {
      "name": "Materials science",
      "score": 0.3527396321296692
    },
    {
      "name": "Machine learning",
      "score": 0.3412154018878937
    },
    {
      "name": "Process engineering",
      "score": 0.3310878872871399
    },
    {
      "name": "Biological system",
      "score": 0.3266577124595642
    },
    {
      "name": "Artificial neural network",
      "score": 0.2743557393550873
    },
    {
      "name": "Chemistry",
      "score": 0.14126524329185486
    },
    {
      "name": "Engineering",
      "score": 0.07831385731697083
    },
    {
      "name": "Politics",
      "score": 0.0
    },
    {
      "name": "Political science",
      "score": 0.0
    },
    {
      "name": "Law",
      "score": 0.0
    },
    {
      "name": "Biology",
      "score": 0.0
    },
    {
      "name": "Organic chemistry",
      "score": 0.0
    }
  ],
  "institutions": [
    {
      "id": "https://openalex.org/I99065089",
      "name": "Tsinghua University",
      "country": "CN"
    },
    {
      "id": "https://openalex.org/I157773358",
      "name": "Sun Yat-sen University",
      "country": "CN"
    },
    {
      "id": "https://openalex.org/I103635307",
      "name": "University of California, Riverside",
      "country": "US"
    }
  ]
}