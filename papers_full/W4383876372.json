{
  "title": "GreenHill: a de novo chromosome-level scaffolding and phasing tool using Hi-C",
  "url": "https://openalex.org/W4383876372",
  "year": 2023,
  "authors": [
    {
      "id": "https://openalex.org/A5112418030",
      "name": "S. Ouchi",
      "affiliations": [
        "Tokyo Institute of Technology"
      ]
    },
    {
      "id": "https://openalex.org/A5048101754",
      "name": "Rei Kajitani",
      "affiliations": [
        "Tokyo Institute of Technology"
      ]
    },
    {
      "id": "https://openalex.org/A5082209541",
      "name": "Takehiko Itoh",
      "affiliations": [
        "Tokyo Institute of Technology"
      ]
    }
  ],
  "references": [
    "https://openalex.org/W3108028701",
    "https://openalex.org/W2104360069",
    "https://openalex.org/W2032033112",
    "https://openalex.org/W3156261638",
    "https://openalex.org/W3130788486",
    "https://openalex.org/W2897774129",
    "https://openalex.org/W3047598142",
    "https://openalex.org/W3022801335",
    "https://openalex.org/W2233072870",
    "https://openalex.org/W2560383108",
    "https://openalex.org/W2538143681",
    "https://openalex.org/W2936883600",
    "https://openalex.org/W2090037139",
    "https://openalex.org/W3159918988",
    "https://openalex.org/W2895074862",
    "https://openalex.org/W2965879979",
    "https://openalex.org/W3090734171",
    "https://openalex.org/W3186561301",
    "https://openalex.org/W3189835550",
    "https://openalex.org/W3112640289",
    "https://openalex.org/W4220668127",
    "https://openalex.org/W3159728495",
    "https://openalex.org/W2950354111",
    "https://openalex.org/W2788228074",
    "https://openalex.org/W3134382222",
    "https://openalex.org/W3002362821",
    "https://openalex.org/W2133059825",
    "https://openalex.org/W2969330652",
    "https://openalex.org/W2396077153",
    "https://openalex.org/W2968499116",
    "https://openalex.org/W3085758516",
    "https://openalex.org/W2157539385",
    "https://openalex.org/W2950261807",
    "https://openalex.org/W3049406222",
    "https://openalex.org/W2784788330",
    "https://openalex.org/W2481029670",
    "https://openalex.org/W2789843538",
    "https://openalex.org/W2979931451",
    "https://openalex.org/W2096128575",
    "https://openalex.org/W3012094285",
    "https://openalex.org/W2903125175",
    "https://openalex.org/W4394666350",
    "https://openalex.org/W2999262337",
    "https://openalex.org/W2108234281",
    "https://openalex.org/W2102619694",
    "https://openalex.org/W3012009036",
    "https://openalex.org/W6913073924",
    "https://openalex.org/W3128198169"
  ],
  "abstract": "Abstract Chromosome-level haplotype-resolved genome assembly is an important resource in molecular biology. However, current de novo haplotype assemblers require parental data or reference genomes and often fail to provide chromosome-level results. We present GreenHill, a novel scaffolding and phasing tool that considers various assemblers’ contigs as input to reconstruct chromosome-level haplotypes using Hi-C without parental or reference data. Its unique functions include new error correction based on Hi-C contacts and the simultaneous use of Hi-C and long reads. Benchmarks reveal that GreenHill outperforms other approaches in contiguity and phasing accuracy, and the majority of chromosome arms are entirely phased.",
  "full_text": "Open Access\n© The Author(s) 2023. Open Access  This article is licensed under a Creative Commons Attribution 4.0 International License, which permits \nuse, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original \nauthor(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third \nparty material in this article are included in the article’s Creative Commons licence, unless indicated otherwise in a credit line to the mate-\nrial. If material is not included in the article’s Creative Commons licence and your intended use is not permitted by statutory regulation or \nexceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit http:// \ncreat iveco mmons. org/ licen ses/ by/4. 0/. The Creative Commons Public Domain Dedication waiver (http:// creat iveco mmons. org/ publi \ncdoma in/ zero/1. 0/) applies to the data made available in this article, unless otherwise stated in a credit line to the data.\nMETHOD\nOuchi et al. Genome Biology          (2023) 24:162  \nhttps://doi.org/10.1186/s13059-023-03006-8\nGenome Biology\nGreenHill: a de novo chromosome-level \nscaffolding and phasing tool using Hi-C\nShun Ouchi1, Rei Kajitani1 and Takehiko Itoh1*   \nAbstract \nChromosome-level haplotype-resolved genome assembly is an important resource \nin molecular biology. However, current de novo haplotype assemblers require paren-\ntal data or reference genomes and often fail to provide chromosome-level results. \nWe present GreenHill, a novel scaffolding and phasing tool that considers various \nassemblers’ contigs as input to reconstruct chromosome-level haplotypes using Hi-C \nwithout parental or reference data. Its unique functions include new error correction \nbased on Hi-C contacts and the simultaneous use of Hi-C and long reads. Benchmarks \nreveal that GreenHill outperforms other approaches in contiguity and phasing accu-\nracy, and the majority of chromosome arms are entirely phased.\nKeywords: Genome assembly, Haplotype, Hi-C, Scaffolding, Phasing\nBackground\nMost of the higher eukaryotic organisms are diploid and possess two copies of homol -\nogous chromosomes. A nucleotide sequence from one homologous chromosome \n(i.e., copy-specific) is called a haplotype, and high-quality haplotype-resolved refer -\nence genome sequences, with separately constructed homologous chromosomes, are \nfundamental resources for research in genomics, agriculture [1 ], medicine [2 , 3], and \nother related biological fields [4 ]. For example, when completely phased haplotypes \nfrom 32 human individuals were examined, researchers discovered several unidenti -\nfied structural variants in disease-associated regions [5 ]. The set of full-length haplo -\ntypes of all chromosomes provides lossless information about an individual diploid \ngenome, which is the ultimate goal of genome assembly. In the initial genome projects \ntargeting inbred model organisms, researchers did not have to consider haplotypes \ndifferences because the inbred samples had few heterozygous sites. This is not the \ncase even for the human genome, much less for wild-type samples; however, draft \ngenomes with mosaics of haplotypes (pseudo-haplotypes) were continuously used \nfor these samples owing to technical limitations. Recently, the importance of haplo -\ntypes has been widely recognized, and the number of studies in which haplotypes are \n*Correspondence:   \ntakehiko@bio.titech.ac.jp\n1 School of Life Science \nand Technology, Tokyo Institute \nof Technology, 2-12-1 Ookayama, \nMeguro-Ku, Tokyo 152-8550, \nJapan\nPage 2 of 27Ouchi et al. Genome Biology          (2023) 24:162 \nseparately investigated is increasing. However, most genome assemblers neglect the \ndifferences between haplotypes and construct mosaic haplotypes that do not exist or \npossess only one haplotype sequence, thereby misleading biological interpretation in \ndownstream analysis.\nThere are three main approaches for haplotype-resolved assembly. The first approach \nis trio binning [6–8] that attempts haplotype-specific assembly by identifying parent-\nspecific k-mers and labeling the long reads with k-mers as haplotype-specific markers. \nTrioCanu [6] separates long reads into two independent haplotypes, assembles two \nseparate reads independently and generates two haplotype genomes. Hifiasm [7] with \nthe trio-binning mode generates a phased assembly by removing one-side allele-derived \nhaplotype reads from the assembly graph. Trio binning approaches provide highly accu -\nrate phased assembly; however, they require parental data which are often unavailable \nfor wild individuals. The second approach is reference-based haplotype reconstruction \n[9, 10] that generates a haplotype by mapping reads to an existing reference, calling vari-\nants, and resolving the chain relationships between variants. However, this approach \nrequires a high-quality reference genome and relies on mapping-based variant calls, \nwhich may lead to errors. Particularly, in regions with high heterozygosity or structural \nvariants, it is difficult to call variants based on the mapping of reads, and the tools often \nfail to reconstruct haplotypes. The third approach is a de novo assembly-based method \n[11, 12]. On the assembly graph, a branched structure called a bubble is formed in a \nregion where there are differences between haplotypes. De novo assembly-based meth -\nods generate haplotypes by resolving the chain of bubbles from the information in the \nreads that link the bubbles. This approach can reconstruct genomes without parental \ndata and references, and can capture variants that are not included in the reference \ngenomes. Although long homozygous regions and repetitive sequences hinder haplotype \nassembly, the advent of long read DNA sequencing technologies overcome the limita -\ntions associated with these regions and enhance the length of assembled haplotypes.\nTo obtain longer chromosome-level haplotypes, chromosome conformation capture \ntechnologies, such as Hi-C [13] have been used in haplotype-aware assemblies [14–19]. \nFALCON-Phase [14] uses the results of FALCON-Unzip [11] as input and phases hap -\nlotypes using Hi-C. The Hi-C method can also be utilized for scaffolding, a process to \ndetermine the orders of assembled sequences; however, FALCON-Phase has no scaffold-\ning function. Therefore, it is combined with other Hi-C scaffolding tools to reconstruct \nchromosome-level haplotypes. However, chromosomal-level haplotype assembly gener -\nated by FALCON-Phase has low accuracy and swaps large haplotype blocks between the \ntwo phases [20]. Like FALCON-Phase, Hifiasm Hi-C mode has a Hi-C phasing func -\ntion [21] but does not use Hi-C data for scaffolding or resolving repeats. AllHiC [15, 16], \na Hi-C scaffolding and phasing tool for polyploid genomes, requires a priori chromo -\nsome number and a closely related reference genome as input. As a fundamental prob -\nlem, the accuracy of Hi-C scaffolders is often insufficient for automatically determining \nend-to-end chromosomal sequences. In the Vertebrate Genome Project, which intends \nto produce thousands of chromosome-level draft genomes, it was argued that manual \ncorrections of sequences are necessary although Hi-C data are used [22]. This problem \nlikely affects the haplotype phasing described above and demands a more accurate Hi-C \nscaffolder.\nPage 3 of 27\nOuchi et al. Genome Biology          (2023) 24:162 \n \nThe existence of various types of data structures in assembler program results is \nanother factor that hinders the completion of the genome sequence at the chromosome-\nlevel and subsequent use of the results for downstream analysis. Particularly, certain \nassemblers, such as Platanus-allee [12] and Hifiasm [7], output pairs of separated het -\nerozygous regions in addition to collapsed homozygous regions that cannot be phased. \nFALCON-Unzip [11] outputs long pseudo-haplotype sequences (primary contigs) and \nphased short sequences (alternative contigs and haplotigs). Unfortunately, this result \ndoes not provide information on where the phased short sequences correspond to long \npseudo-haplotype sequences. Moreover, the long pseudo-haplotype sequences were \nmosaic-like for both alleles. Furthermore, assembling a diploid genome using assemblers \nsuch as Canu [23], Flye [24], or SMARTdenovo [25] often produce contigs between one \nand two times the length of the haploid genome size, depending on the heterozygosity \nof the target genome. This is due to the fact that regions with high heterozygosity are \nassembled separately for each haploid, whereas regions with low heterozygosity are col -\nlapsed. In many cases, users have to identify and purge contigs derived from separately \nassembled heterozygous alleles [22] using external tools, such as Purge_dups [26]; how -\never, these circumstances hamper the automation of genome assemblies.\nIn this study, we present GreenHill, a novel scaffolding and phasing tool using Hi-C \nin combination with other read information, such as long read, mate-pair, and paired-\nend reads (PE). GreenHill is designed to generate chromosomal-level haplotypes with -\nout parental data or references; in other words, it adopts a de novo assembly approach. \nUsing a newly developed algorithm, long reads and Hi-C were synergistically used to \nimprove the accuracy of the resulting haplotypes. In addition, this tool can automati -\ncally detect homologous regions in the input assembly (contigs) and handle any type of \nassembly, thereby enhancing its versatility. We evaluated the performance of GreenHill \non de novo assemblies from both simulation data and actual data from a variety of spe -\ncies. Benchmarking results indicate that GreenHill outperforms other tools in various \naspects, suggesting that this tool can facilitate the automation of de novo assembly of \nchromosome-level haplotypes.\nResults\nOverview of GreenHill\nAn overview of GreenHill is shown in Fig.  1. The details on each step are present in \nthe Methods section. GreenHill receives Hi-C and long reads in addition to the assem -\nbled contigs (output result sequences) from other assemblers as inputs, and simultane -\nously performs scaffolding and phasing. Any format of assembled sequences (contigs) \nis acceptable, such as (1) paired-haplotype (fully phased output: primary and secondary \ncontigs), (2) pseudo-haplotype (separate output: consensus and alternative contig), and \n(3) haplotype-ignorant (mixed output of consensus and alternative contig) styles. The \nformats of Platanus-allee [12], FALCON-Unzip [11], and Canu [23] correspond to the \naforementioned styles, respectively. First, contig pairs that consist of the same loci from \nhomologous chromosomes were identified, and each corresponding pair was merged \ninto a single contig as a “consensus contig” (Fig.  1b). The pair information and merged \ncontigs were retained and reused in the downstream step. Next, consensus contigs were \ninputted into the scaffolding (Fig.  1c and d). As a unique function, this step is executed \nPage 4 of 27Ouchi et al. Genome Biology          (2023) 24:162 \nusing both Hi-C and long reads, whereas the existing Hi-C scaffolders only accept one \ntype of read. GreenHill utilizes long reads to improve the quality of scaffolds in vari -\nous ways as follows: joining contigs, checking the joined contig pairs, and determining \nthe breakpoints of misassemblies inferred using Hi-C data. In addition, the Hi-C scaf -\nfolding module has a characteristic error-detection function, which uses a variance-\nbased thresholding method [27] for the contact map of Hi-C. Lastly, consensus contigs \nwere divided into two contigs using the information saved in the merge haplotype step \n(Fig. 1b) and phased using both long read and Hi-C read links (Fig. 1e).\nComparison of GreenHill with other approaches\nWe evaluated the performance of GreenHill and compared it with the results of other \napproaches employing FALCON-Phase and Hi-C scaffolding tools. We followed the \nFig. 1 Overview of GreenHill. a GreenHill receives assembled contigs from other assembler as inputs. Any \nformat of contigs is acceptable, such as paired-haplotype, pseudo-haplotype, and haplotype-ignorant styles. \nb Contig pairs that consist of the same loci from homologous chromosomes were identified, and each contig \npair was merged into a single contig as consensus contig. c Consensus contigs were scaffolded using long \nreads. d Consensus contigs were scaffolded using Hi-C. e Consensus contigs were divided into two contigs \nand phased using long reads and Hi-C\nPage 5 of 27\nOuchi et al. Genome Biology          (2023) 24:162 \n \nprocedure proposed in the FALCON-Phase paper [14], which involves running FAL -\nCON-Phase twice, before and after Hi-C scaffolding. First, input contigs were phased \nusing FALCON-Phase. The input contigs were generated using multiple tools (in addi -\ntion to FALCON-Unzip), and FALCON-Phase was used to extend the phased contigs. \nCanu’s contigs were modified using Purge_dups [26] for FALCON-Phase. Next, contigs \nfrom FALCON-Phase were scaffolded using two existing state-of-the-art Hi-C scaf -\nfolding tools (SALSA2 [28] and 3D-DNA [29]) because FALCON-Phase lacks scaffold -\ning function. After scaffolding, the scaffolds from Hi-C scaffolding tools were phased \nusing FALCON-Phase and chromosome-level and haplotype-aware assemblies were \ngenerated. The details of the procedures above are described in the Methods  section. In \nbenchmarks with high-fidelity reads (HiFi reads [30]), Hifiasm Hi-C mode [21], which \ngenerates haplotype-resolved assembly using Hi-C, was also compared with GreenHill \nin addition to the combined pipelines using FALCON-Phase and Hi-C scaffolding tools.\nAssembly performance metrics\nThe assembly performance was evaluated by several metrics given below.\nContiguity\nN50 was used to measure the contiguity of the assembly. N50 was defined as the length \nof the shortest contig for which longer and equal-length contigs covered at least 50% of \nthe assembly.\nAccuracy\nQuality value (QV), switch error rate, and phasing accuracy were used to measure the \naccuracy of the assembly. QV was calculated using Merqury [31], assuming that k-mers \nare found only in the assembly as fine-scale errors. Switch error rates were calculated \nusing Merqury with the haplotype-specific k-mer (hap-mer) found in the assembly. \nPhasing accuracy was calculated using an in-house script with hap-mers. Phasing accu -\nracy was defined as follows:\nThis corresponds to the proportion of the majority of hap-mers in a scaffold. Notably, \nonly one switch error can cause a large decrease in the value (e.g., error in the middle of \na scaffold), and a low value of this indicator suggests large-scale haplotype inconsistency, \nwhich can have a negative effect on downstream analysis.\nIf the reference genome was available, we evaluated the accuracy of the assembly using \nthe reference alignment-based method instead of the k-mer-based one (Merqury). The \nnumber of misassemblies and switch errors was calculated in a similar manner as previ -\nously described [12].\nBenchmarking experiments\nWe evaluated the performance of GreenHill on de novo assemblies using both simula -\ntion data and actual data from a variety of species.\nPhasing accuracy = the total number of hap − mers from the major haplotype\nthe total number of hap − mers from both haplotypes\nPage 6 of 27Ouchi et al. Genome Biology          (2023) 24:162 \nCaenorhabditis elegans simulation dataset\nWe initially generated a simulated diploid dataset of Caenorhabditis elegans consist -\ning of crosses of N2 and CB4856 strains (heterozygosity, 0.31%) for detailed accuracy \nevaluation (Additional file  1: Table S1). In this benchmark, assembled haplotypes were \nevaluated based on the reference genome, and the influence of local dense chroma -\ntin conformation, such as topologically associated domains (TAD) for Hi-C data, was \nexcluded. We used ART [32] to generate Illumina paired-end reads for each strain at \n80 × coverage, which was calculated for the haploid genome size. PacBio long reads \n(continuous long reads, CLR) were sequenced using Sequel and downsampled for each \nstrain at 80 × coverage. Sim3C [33] (default setting except for the –linear option) was \nused to generate Hi-C reads for each strain at 60 × coverage. The reads from each strain \nwere combined, resulting in a read set for the simulated diploid genome (N2 × CB4856). \nThree input style contigs were tested as follows: paired-haplotype (Platanus-allee), \npseudo-haplotype (FALCON-Unzip), and haplotype-ignorant (Canu) style inputs.\nTable  1 shows the output assembly statistics for the C. elegans data. FALCON-\nUnzip input results revealed that FALCON-Unzip + GreenHill achieved the largest \nN50 (17.1  Mb), while FALCON-Unzip + SALSA2 yielded fragmented assembly (N50: \n9.5 Mb). Assembly accuracy indicated that FALCON-Unzip + GreenHill had the small -\nest number of switch errors and the second smallest number of misassemblies. FAL -\nCON-Unzip + 3D-DNA assembly had the largest number of misassemblies and switch \nerrors. Canu input results revealed that Canu + GreenHill achieved the largest N50, \nsmallest number of misassemblies, and smallest number of switch errors in compari -\nson with the results from other scaffolding tools. However, Platanus-allee + GreenHill \nachieved the most accurate result in terms of switch errors. In summary, GreenHill gen -\nerated the most accurate results for each style of contig, suggesting its versatility.\nDrosophila melanogaster dataset\nSubsequently, we tested whether GreenHill worked with HiFi reads using HiFi actual \ndata and Hi-C simulation data of D. melanogaster (Additional file  1: Table S1). Haplo -\ntype-ignorant-style input contigs generated using HiCanu [34] and the haplotype-aware \nassembler for HiFi reads, Hifiasm [7], were tested. Haplotype-ignorant-style input con -\ntigs generated using Canu [23] (for CLR) were tested for comparison with HiFi input \nresult. FALCON-Unzip was not tested because read data in an acceptable format (BAM \nTable 1 Benchmarking results for Caenorhabditis elegans data\nSize, N50, #misassembly, and #switch error were calculated for sequences whose length ≧500 bp. Size represents the size of \nassemblies generated by each assembler. #misassembly and #switch error is the number of misassemblies and switch errors \ncalculated using the reference alignment-based method. A bold value indicates the best one for each input assembly\nAssembler Size (bp) Max Length (bp) N50 (bp) #misassembly #switch error\nPlatanus-allee + GreenHill 208,814,372 20,808,020 17,065,040 105 1,657\nFALCON-Unzip + GreenHill 204,407,441 20,723,971 17,142,644 108 2,121\nFALCON-Unzip + 3D-DNA 226,102,670 22,381,602 16,567,875 286 2,444\nFALCON-Unzip + SALSA2 216,393,292 13,113,712 9,455,592 104 2,244\nCanu + GreenHill 195,748,221 19,835,919 16,219,706 182 1,742\nCanu + 3D-DNA 223,116,127 21,318,404 14,712,650 665 2,165\nCanu + SALSA2 209,942,443 15,218,531 6,564,248 315 1,989\nPage 7 of 27\nOuchi et al. Genome Biology          (2023) 24:162 \n \nfiles) were unavailable. Hi-C reads were simulated in a similar manner to those of C. ele -\ngans benchmarks. The target sample was an F1 individual from the ISO1 and A4 strains \n(heterozygosity, 0.74%) [34], and paired-end reads from its parents were used for evalua-\ntion. The number of misassemblies and switch errors was calculated using the reference \ngenomes of the parental strains.\nTable 2 indicates that the N50 values of GreenHill exceeded those of the other results \nin all cases. In each case, the number of misassemblies of GreenHill was approximately \nhalf than those of the other results. GreenHill had the smallest number of switch errors, \nexcept in one case (HiCanu input). These results suggest that GreenHill functions well \nfor inputting either HiFi or CLR reads.\nCow dataset\nThe third benchmark evaluated GreenHill’s performance on actual data using the actual \ncow (Bos taurus ) dataset (Additional file  1: Table S1) with trio data from offspring and \nparents. Its heterozygosity is estimated to be 0.65–0.93%. The CLR, short (paired-end), \nand Hi-C reads from the offspring were used for de novo assembly and the parental \nshort reads were used for evaluation. The estimated genome size was approximately \n3  Gb; thus, these data were suitable for evaluating the performance of a relatively \nlarge genome. Platanus-allee was not used as input for GreenHill because the available \npaired-end read data were based on 2-channel SBS technology using NextSeq 500. The \nsequence quality was low and thus, Platanus-allee generated the assembly with a high \nswitch error rate (Additional file  1: Table  S2). In contrast, FALCON-Unzip generated \ncontigs with a large N50 (4.6 Mb) and a low switch error rate (0.18), suggesting that the \ncontigs are of high quality and are suitable for downstream analysis.\nTable  3 shows the output assembly statistics for the cow dataset. FALCON-\nUnzip + GreenHill achieved the largest N50 (89.8  Mb), outperforming the other \napproaches. In addition, FALCON-Unzip + GreenHill had the highest QV, lowest switch \nerror rate, and highest phasing accuracy.\nTable 2 Benchmarking results for Drosophila melanogaster data\nSize, N50, #misassembly, and #switch error were calculated for sequences whose length ≧500 bp. Size represents the size of \nassemblies generated by each assembler. #misassembly and #switch error is the number of misassemblies and switch errors \ncalculated using the reference alignment-based method. A bold value indicates the best one for each input assembly\nAssembly Input \nfor \ncontigs\nSize (bp) Max Length (bp) N50 (bp) #misassembly #switch error\nCanu + GreenHill CLR 298,393,407 32,550,496 25,267,681 515 2,316\nCanu + 3D-DNA 377,404,855 14,057,924 637,829 1,095 2,604\nCanu + SALSA2 318,193,525 23,535,552 12,777,832 661 2,409\nHiCanu + GreenHill HiFi 321,609,584 33,217,621 24,975,482 930 686\nHiCanu + 3D-DNA 351,304,469 21,680,562 2,482,127 1,631 688\nHiCanu + SALSA2 297,968,925 28,602,144 24,843,359 1,435 646\nHifiasm + GreenHill HiFi 307,145,492 27,892,039 24,570,326 742 480\nHifiasm + 3D-DNA 371,012,458 33,126,928 1,795,858 2,546 752\nHifiasm + SALSA2 327,819,782 25,140,693 9,592,386 2,330 735\nHifiasm Hi-C mode 308,439,591 26,052,400 21,522,312 1,346 637\nPage 8 of 27Ouchi et al. Genome Biology          (2023) 24:162 \nTo gain additional insight regarding the phasing accuracy of the assemblies, we \nvisualized the compositions of hap-mers and lengths of scaffolds from hap-mer \nblob plots using Merqury (Fig.  2). Each scaffold is represented by a circle, whose \nsize indicates the length of the scaffold. The number of hap-mers from the mother \nand father is indicated on the x-axis and y-axis, respectively. The higher the phasing \naccuracy, the fewer the number of hap-mers from the other haplotype; therefore, the \ncircles are aligned closer to the axis. The circles in the hap-mer blob plot of FAL -\nCON-Unzip + GreenHill were aligned closer to the axis than those of the FALCON-\nPhase-based approaches, indicating that FALCON-Unzip + GreenHill outperformed \nFALCON-Phase-based approaches in phasing accuracy.\nTo further validate the correctness of the assemblies, we created alignment dot \nplots using nucmer, delta-filter, and a modified version of the mummerplot in \nthe MUMmer package [35] to display the consistency between the benchmark \nresults and the trio-binned assembly (TrioCanu). Figure  3 shows the alignment \ndot plots for Chromosome 1. FALCON-Phase-based approaches had large switch \nerrors that swap large haplotype blocks between two haplotypes, while FALCON-\nUnzip + 3D-DNA had an inversion error. In contrast, FALCON-Unzip + GreenHill \ndid not exhibit large switch errors or misassemblies. Assembly contiguity revealed \nTable 3 Benchmarking results for cow data\nSize and N50 were calculated for sequences whose length ≥ 500 bp. Size represents the size of assemblies generated by \neach assembler. QV and switch error rate were calculated by Merqury. Phasing accuracy represents the proportion of the \nmajority of hap-mers in a scaffold, and a high value of this indicator suggests large-scale haplotype consistency. A bold \nvalue indicates the best one for each input assembly\nAssembler Size (bp) Max Length (bp) N50 (bp) QV Switch \nerror \nrate\nPhasing accuracy\nFALCON-Unzip + Green-\nHill\n5,265,512,220 156,630,926 89,758,138 42.40 0.18 0.949\nFALCON-\nUnzip + 3D-DNA\n5,649,125,145 156,722,321 77,197,018 41.15 0.23 0.826\nFALCON-\nUnzip + SALSA2\n5,479,993,517 139,927,026 68,805,579 41.25 0.22 0.856\nFig. 2 Hap-mer blob plots for cow data. The numbers of hap-mers (parent-specific k-mer) from the mother \nand father are indicated on the x-axis and y-axis, respectively. Each scaffold is represented as a circle. The sizes \nof the circles indicate sequence lengths. The higher the phasing accuracy, the closer the circles are aligned \nto the axis. a FALCON-Unzip + GreenHill result; b FALCON-Unzip + 3D-DNA result; c FALCON-Unzip + SALSA2 \nresult\nPage 9 of 27\nOuchi et al. Genome Biology          (2023) 24:162 \n \nthat FALCON-Unzip + SALSA2 reconstructed each Chromosome 1 haplotype with \nmultiple scaffolds (> 1 Mb), whereas FALCON-Unzip + GreenHill reconstructed each \nChromosome 1 haplotype with a single scaffold (> 1 Mb).\nZebra finch dataset\nFourth, we performed a benchmark using the actual dataset of Zebra finches (Taeniopy -\ngia guttata), which had trio data with a high heterozygous sample (1.47%) (Additional \nfile 1: Table S1). The CLR, HiFi, 10X, and Hi-C reads from the offspring were used for \nthe de novo assembly, and the parental short reads were used for evaluation. Contig \nassembly was performed using Platanus-allee (for 10X and CLR), FALCON-Unzip (for \nCLR), Canu (for CLR), and Hifiasm (for HiFi). We used 10X data instead of paired-end \ndata for running Platanus-allee because paired-end reads were unavailable. Unlike the \nresults from the cow dataset, the N50 length of the contigs using FALCON-Unzip was \nrelatively small (931 kb; Additional file  1: Table S2), probably due to its high heterozy -\ngosity. We anticipate that the performance of scaffolders for fragmented inputs can be \nmeasured using this benchmark.\nThe output assembly statistics for the zebra finch data are listed in Table  4. FALCON-\nUnzip input results indicated that FALCON-Unzip + GreenHill generated scaffolds with \nsimilar N50 lengths (70.6  Mb) in comparison with those generated using FALCON-\nUnzip + 3D-DNA (N50: 73.4  Mb). FALCON-Unzip + SALSA2 yielded a considerably \nfragmented assembly (N50: 14.2 Mb). Assembly accuracy using GreenHill outperformed \nthe other approaches in QV, switch error rate, and phasing accuracy. Canu input results \nrevealed that GreenHill generated scaffolds with similar N50 lengths (70.9  Mb) as \n3D-DNA (74.6 Mb) and achieved the highest QV and phasing accuracy. Of all the com -\nbinations of the contig-assemblers and scaffolders with CLR, Platanus-allee + GreenHill \nachieved the highest phasing accuracy. The results of the contigs obtained using Canu \nhad a higher switch error rate and lower phasing accuracy than those obtained from \nother tools, suggesting that haplotype-ignorant style input contigs are relatively difficult \nto handle for phasing. Nonetheless, GreenHill showed the best performance in accu -\nracy for each input contig set, which supports its versatility for input contig. Hifiasm \nFig. 3 Alignment dot plots for the cow scaffolds on the Chromosome 1. Dot plots of alignment between \nbenchmark results and trio-binned assembly for the cow scaffolds on the Chromosome 1. Each dot in the \nplot represents an alignment between benchmark results and the trio-binned assembly, and the color \nindicates the identity of the alignment. The upper left and lower right quadrants correspond to the scaffolds, \nwhich are color-coded according to their haplotypes. Red, blue, and gray correspond to maternal, paternal, \nand homozygous regions, respectively. The black dashed lines represent the boundaries of the scaffolds. a \nFALCON-Unzip + GreenHill result; b FALCON-Unzip + 3D-DNA result; c FALCON-Unzip + SALSA2 result\nPage 10 of 27Ouchi et al. Genome Biology          (2023) 24:162 \ninput results showed that GreenHill generated scaffolds with the largest N50 lengths \n(62.8 Mb), while other tools generated more fragmented scaffolds (N50 < 12 Mb). Hifi -\nasm Hi-C mode generated the most accurate results in terms of QV, switch error rate, \nand phasing accuracy, but the result was more fragmented than GreenHill due to the \nlack of a scaffolding function. Moreover, GreenHill generated scaffolds with high phas -\ning accuracy (> 0.9) despite it having high contiguity. Consequently, Greenhill’s assem -\nblies were also generated with good accuracy and the highest contiguity for Hifiasm \ninput results, suggesting its robustness to HiFi data.\nIn addition, the hap-mer blob plots of each output assembly show that GreenHill-\nbased assemblies have greater phasing accuracy than FALCON-phase-based assemblies \n(Fig.  4). To validate the accuracy at the chromosomal level, we color-coded scaffolds \naccording to the corresponding haplotype using a hap-mer (Fig.  5, Additional file  1: \nFig. S1). Figure  5 shows the haplotype structure of Chromosome 3. Although FAL -\nCON-Phase-based approaches exhibited several large switch errors, GreenHill-based \napproaches generated each haplotype on Chromosome 3 as a single scaffold (> 1  Mb) \nwithout large switch errors (except for the Hifiasm input result).\nOther species datasets\nTo further investigate GreenHill’s versatility, we used the tools for genome assembly \nconstruction for three species: budgerigar (Melopsittacus undulatus), black rhinoceros \n(Diceros bicornis), and sterlet (Acipenser ruthenus). The estimated heterozygosities were \n1.04%, 0.21%, and 0.58%, respectively. The sequencing data are publicly available (Addi -\ntional file 1: Table S1). The long reads (CLR or HiFi) and Hi-C reads from offspring were \nused for de novo assembly and the parental short reads were used for evaluation. Input \nTable 4 Benchmarking results for zebra finch data\nSize and N50 were calculated for sequences whose length ≥ 500 bp. Size represents the size of assemblies generated by \neach assembler. QV and switch error rate were calculated by Merqury. Phasing accuracy represents the proportion of the \nmajority of hap-mers in a scaffold, and a high value of this indicator suggests large-scale haplotype consistency. A bold \nvalue indicates the best one for each input assembly\nAssembler Input for \ncontigs\nSize (bp) Max Length \n(bp)\nN50 (bp) QV Switch \nerror \nrate\nPhasing \naccuracy\nPlatanus-\nallee + GreenHill\n10X, CLR 2,309,934,319 152,477,488 61,881,567 35.55 0.57 0.953\nFALCON-\nUnzip + GreenHill\nCLR 2,025,894,925 150,748,938 70,617,212 35.97 0.79 0.886\nFALCON-\nUnzip + 3D-DNA\n2,165,277,869 153,652,046 73,366,558 35.29 0.87 0.639\nFALCON-\nUnzip + SALSA2\n2,153,682,369 67,065,260 14,220,490 35.35 0.87 0.717\nCanu + GreenHill CLR 1,995,878,168 148,688,728 70,920,789 35.98 2.28 0.849\nCanu + 3D-DNA 2,283,995,575 163,319,697 74,641,957 35.57 2.22 0.589\nCanu + SALSA2 2,263,303,629 27,304,387 6,544,809 35.61 2.22 0.658\nHifiasm + Green-\nHill\nHiFi 2,139,611,083 152,614,629 62,848,794 49.40 0.02 0.914\nHifiasm + 3D-DNA 2,667,759,650 77,682,004 1,858,283 49.83 0.02 0.929\nHifiasm + SALSA2 2,352,582,037 64,427,564 11,305,740 49.84 0.02 0.784\nHifiasm Hi-C \nmode\n2,172,318,724 33,557,543 7,896,913 50.51 0.01 0.997\nPage 11 of 27\nOuchi et al. Genome Biology          (2023) 24:162 \n \ncontigs were generated using FALCON-Unzip (for budgerigar) and Hifiasm (for black \nrhinoceros and sterlet).\nThese results are shown in Table  5. GreenHill yielded scaffolds with similar (budg -\nerigar: 88.1 Mb) or larger (black rhinoceros: 52.2 Mb, sterlet: 25.8 Mb) N50 lengths \ncompared to other tools. Hifiasm Hi-C mode generated the most accurate results, but \nthey were more fragmented than those of GreenHill due to its lack of a scaffolding \nFig. 4 Hap-mer blob plots for zebra finch data. The numbers of hap-mers (parent-specific k-mer) from \nthe mother and father are indicated on the x-axis and y-axis, respectively. The sizes of the circles indicate \nsequence lengths. The higher the phasing accuracy, the closer the circles are aligned to the axis. a \nPlatanus-allee + GreenHill; b FALCON-Unzip + GreenHill result; c FALCON-Unzip + 3D-DNA result; d \nFALCON-Unzip + SALSA2 result; e Canu + GreenHill result; f Canu + 3D-DNA result; g Canu + SALSA2 result; h \nHifiasm + GreenHill result; i Hifiasm + 3D-DNA result; j Hifiasm + SALSA2 result; k Hifiasm Hi-C mode result\nPage 12 of 27Ouchi et al. Genome Biology          (2023) 24:162 \nfunction. GreenHill generated more accurate results than FALCON-Phase-based \napproaches in terms of switch error rate and phasing accuracy, except in cases where \nthe N50 values of the FALCON-Phase-based approaches were very low (< 4 Mb). Fur-\nthermore, the hap-mer blob plots for each output assembly indicated that the phasing \naccuracy of GreenHill-based assemblies is slightly lower than that of Hifiasm Hi-C \nmode assemblies but higher than that of FALCON-Phase-based assemblies (Addi -\ntional file  1: Fig. S2, S3, S4). These results show GreenHill’s versatility for use in differ -\nent species.\nFig. 5 Haplotype structures of the zebra finch scaffolds on the Chromosome 3. Each scaffold was \ncolor-coded according to the corresponding haplotype. Red, blue, and gray regions correspond to maternal, \npaternal, and homozygous ones, respectively. The black dashed lines represent boundaries between scaffolds\nPage 13 of 27\nOuchi et al. Genome Biology          (2023) 24:162 \n \nKnock‑out tests to evaluate the effectiveness of GreenHill\nTo confirm the effectiveness of the characteristic functions of GreenHill, we conducted \ntests in which certain functions were deactivated (knocked out). The target functions \nwere simultaneous long-read-use (LR-use) and Hi-C-based corrections. The number of \nmisassemblies was calculated using the reference genomes of parental strains for the C. \nelegans and D. melanogaster data and the trio-binned assembly for the cow and zebra \nfinch data. As expected, the number of misassemblies and/or phasing accuracies dra -\nmatically worsened when the functions were knocked out (Additional file  1: Table S3), \nconfirming the effectiveness of the novel functions.\nRuntime and memory usage evaluation\nWe evaluated the runtime and memory usage of the three tools on all datasets. Nota -\nbly, GreenHill performs purging input contigs, mapping Hi-C reads to contigs, scaffold -\ning with Hi-C, and phasing with Hi-C in the tool, so FALCON-Phase + Hi-C scaffolding \ntool’s runtime is calculated by adding the runtime of purge_dups, Hi-C mapping (Juicer \n[36] or Arima mapping pipeline [37]), Hi-C scaffolding (3D-DNA or SALSA2), and Hi-C \nphasing (FALCON-Phase). CPU times, real times, and peak memory usage of the tools \nwere measured with the GNU time command on a computer with an Intel(R) Xeon(R) \nGold 6342 CPU (2.80 GHz clocks, dual 24 cores) and 512 GB of RAM. The number of \nthreads was specified as 48 for each process provided it was configurable.\nTable 5 Benchmarking results for other species\nSize and N50 were calculated for sequences whose length ≥ 500 bp. Size represents the size of assemblies generated by \neach assembler. QV and switch error rate were calculated by Merqury. Phasing accuracy represents the proportion of the \nmajority of hap-mers in a scaffold, and a high value of this indicator suggests large-scale haplotype consistency. A bold \nvalue indicates the best one for each input assembly\nSpecies Assembler Input \nfor \ncontigs\nSize (bp) Max Length \n(bp)\nN50 (bp) QV Switch \nerror \nrate\nPhasing \naccuracy\nBudg-\nerigar\nFALCON-\nUnzip + Green-\nHill\nCLR 2,273,118,342 140,405,933 88,135,996 40.78 0.28 0.896\nFALCON-\nUnzip + 3D-DNA\n2,620,388,952 159,155,647 90,074,506 39.20 0.36 0.701\nFALCON-\nUnzip + SALSA2\n2,437,415,698 95,254,517 34,574,245 39.31 0.34 0.741\nBlack \nrhinoc-\neros\nHifiasm + Green-\nHill\nHiFi 5,325,705,542 101,752,101 52,259,952 58.44 0.05 0.982\nHifi-\nasm + 3D-DNA\n6,523,963,142 136,733,613 48,162,421 55.16 0.09 0.615\nHifiasm + SALSA2 6,206,904,826 40,586,421 3,069,332 55.53 0.05 0.785\nHifiasm Hi-C \nmode\n6,047,793,056 94,248,160 30,503,132 67.13 0.06 0.995\nSterlet Hifiasm + Green-\nHill\nHiFi 3,712,891,508 83,435,872 25,813,405 58.82 0.03 0.849\nHifi-\nasm + 3D-DNA\n3,882,750,516 14,958,612 1,019,399 54.98 0.04 0.889\nHifiasm + SALSA2 3,474,135,770 47,228,216 7,128,235 55.15 0.04 0.751\nHifiasm Hi-C \nmode\n3,748,196,843 55,271,118 9,593,284 60.99 0.02 0.975\nPage 14 of 27Ouchi et al. Genome Biology          (2023) 24:162 \nResults are shown in Additional file  1: Table  S4. GreenHill required similar or less \ntime than other approaches. GreenHill generated assemblies within approximately \n1 h for data with small genome sizes (< 500 Mb, C. elegans and D. melanogaster), and \nwithin 2  days for data with large genome sizes (> 2  Gb, Black rhinoceros). FALCON-\nPhase + 3D-DNA and FALCON-Phase + SALSA2 are time-consuming, especially when \nthe genome size is large (approximately 10 days or more for black rhinoceros data). This \nmay be due to the Hi-C mapping each time the Hi-C scaffolding tool and Hi-C phasing \ntool are run. GreenHill’s peak memory usage was higher than the other tools, but it was \nless than 206 GB even for the data from large genome sizes (> 2 Gb, Black rhinoceros).\nDiscussion\nIn this study, we developed a novel algorithm, GreenHill, and tested its performance and \nversatility using data from many species with various types of input contigs. In the first \n(C. elegans) and the second (D. melanogaster) benchmark with the Hi-C simulated data, \nwe confirmed that the basic performance of GreenHill was high under the condition of \nideal Hi-C reads without local dense chromatin conformations, such as TAD, that can \ndisturb the behaviors of Hi-C scaffolders. The high performance of GreenHill was dem -\nonstrated in the two benchmarks, one using CLR input and the other using HiFi input.\nIn the third (cow) and the fourth (zebra finch) benchmarks of actual data, the CLR \ninput contigs were contiguous and relatively fragmented, respectively. Short contigs \nare difficult to determine the order and orient owing to the small number of mapped \nHi-C reads. Therefore, fragmented contigs may be difficult for the scaffolders. GreenHill \nachieved the highest values for all metrics regarding phasing quality for both contiguous \nand fragmented input contigs, suggesting its versatility. It is worth noting that 3D-DNA \nand SALSA2 had substantially low phasing accuracy (maximum of 0.639 and 0.717, \nrespectively) for the zebra finch, which implies that approximately one-third of regions \nin their resulting haplotype sequences were misphased. Moreover, GreenHill exhibited \nphasing accuracies ranging from 0.849–0.953 in both cow and zebra finch benchmarks. \nThe results of Platanus-allee + GreenHill showed high phasing accuracy (0.953 for zebra \nfinch), and this combination may be preferable for accurate haplotypes if a short-read \nlibrary has sufficient quality and coverage. In addition, the majority of phased scaffolds \nfrom GreenHill covered the entire chromosome arm. Therefore, the result of GreenHill \nwas close to our goal of de novo assembly of haplotypes of all chromosomes.\nWe tested GreenHill’s performance on a variety of heterozygosity species ranging from \n0.21 ~ 1.47. The heterozygosity of a genome assembly can have a significant impact on its \nquality. High levels of heterozygosity can lead to increased fragmentation and misassem-\nbly, while low levels of heterozygosity can make phasing difficult with few heterozygous \nsites. In all data, GreenHill was able to construct highly accurate and contiguous haplo -\ntypes and showed high robustness to heterozygosity.\nRegarding algorithms, the unique functions of GreenHill include the simultaneous \nuse of long and Hi-C reads and error correction using Hi-C contact information with \nvariance-based threshold selection [27]. Some existing pipelines [14, 20] and proto -\ncols [22] accept both long and Hi-C reads; however, they separately use each read set. \nIn addition, GreenHill iteratively attempts to scaffold and phase changing parameters \nsuch as L  (see “  Consensus scaffolding using Hi-C ” in the Methods  section), which \nPage 15 of 27\nOuchi et al. Genome Biology          (2023) 24:162 \n \nmay be minor in terms of novelty but effective in improving the lengths of sequences. \nThe effectiveness of the novel functions was confirmed in the benchmarks in which \nthese functions were deactivated (knocked out).\nGreenHill can accept fully or partially phased contigs using any tool. Moreover, \neven the haplotype-ignorant style contigs from Canu, which were assumed to be diffi -\ncult to handle because contigs were not classified into primary and alternative phases, \ncould be used to construct haplotypes, supporting the versatility of GreenHill. For the \nother types of input data in this study, we dealt with HiFi reads [30] which have low \nerror rates (< 1%) as well as PacBio CLR whose error rates were high (10%–15%). The \nbenchmark results with HiFi + Hi-C dataset (D. melanogaster, zebra finch, black rhi -\nnoceros, and sterlet) show that GreenHill also performs well on HiFi reads. HiFi reads \nmay be more effective for phase haplotypes than CLR because of sequence accuracy. \nHowever, the DNA extraction protocol for HiFi reads requires a narrow range of frag -\nment lengths (e.g., 15–18 kb) [30], whereas that for CLR can utilize all long fragments \n(e.g., ≥ 15  kb). Thus, it is possible that the HiFi protocol requires higher total DNA \nand is difficult to apply to samples in which DNA extraction is complex. This suggests \nthat CLR has wider applicability than HiFi, and our benchmark results show high \nperformance even for the CLR input case, which is more computationally challeng -\ning and versatile. In summary, GreenHill has versatility for both HiFi and CLR input \ncontig types and works well efficiently with high-error-rate long reads, suggesting the \npracticability of various projects targeting diploid organisms.\nHowever, there are certain limitations of the study: (1) GreenHill has no function in \ndetecting and correcting switch errors in the input assembly; therefore, the phasing \naccuracy of the assembly generated by GreenHill depends on the phasing accuracy of \nthe input assembly. (2) GreenHill is designed for diploid genomes; therefore, it can -\nnot handle polypoid genomes. Future studies should detect switch errors in the input \nassembly from mapping results of reads and extend a method to accommodate poly -\nploid genomes.\nConclusions\nIn this study, we presented GreenHill, a novel scaffolding and phasing tool for recon -\nstructing chromosome-level haplotypes using Hi-C. Benchmarking with simulation \nand actual data showed that GreenHill outperformed other existing approaches in \nassembly contiguity and phasing accuracy. GreenHill, which can reconstruct chromo -\nsome-level haplotypes with high accuracy, is expected to facilitate a large variety of \ndownstream analyses, such as structural variation analysis or gene analysis between \nhaplotypes.\nMethods\nGreenHill method\nGreenHill has three stages: (1) merging of two corresponding haplotigs into a “consensus \ncontig, ” (2) consensus scaffolding, and (3) phasing (Fig.  1). GreenHill was implemented \nin an easy-to-use open-source tool https:// github. com/ ShunO uchi/ Green Hill.\nPage 16 of 27Ouchi et al. Genome Biology          (2023) 24:162 \nInput assembly\nGreenHill inputs a partially phased assembly generated by the other assemblers. “paired-\nhaplotype style, ” “pseudo-haplotype style, ” and “haplotype-ignorant style” can be used as \nthe input format.\nThe paired-haplotype style is the format in which a heterozygous haplotype contig is \nassociated with a homologous counterpart from end to end as a bubble. For each bubble, \nthe contig with more non-N bases is defined as a “primary bubble, ” whereas the other \ncontig is defined as a “secondary bubble. ” A contig that is not a bubble is defined as a \n“non-bubble. ” A paired-haplotype style was used for the Platanus-allee assembly.\nThe pseudo-haplotype style is the format consisting of pseudo-haplotype and alterna -\ntive sequences. A pseudo-haplotype sequence contains collapsed regions with low or no \nheterozygosity and/or heterozygous regions. An alternative sequence is a heterozygous \nsequence that is associated with a pseudo-haplotype region. The pseudo-haplotype style \nis used for assemblers namely FALCON-Unzip.\nThe haplotype-ignorant style is the format consisting of sequences with no haplotype \ninformation. Using assemblers, such as Canu, certain highly heterozygous regions are \nunintentionally phased, resulting in assembly sizes 1–2 times the genome size. Green -\nHill can use such inputs.\nMerge haplotype\nIn the merge haplotype step, we identified the heterozygous regions in the input assem -\nbly. The merge haplotype method depends on the input format.\nFor pseudo-haplotype and haplotype-ignorant style inputs, we exchanged the input \nformat for the paired-haplotype style as follows (Additional file 1: Fig. S5a). First, we cal-\nculated the self-alignment of the input contigs using Minimap2 [38] (2.24-r1122) with \nthe following options: “-D –secondary = no” . Alignment results with < 80% identity were \nfiltered. Next, we computed the opposite contig for each contig, where the opposite \ncontig was the contig with the longest alignment to the contig. In order of alignment \nlength, we associated a contig with the opposite contig. If the opposite contig of a contig \nu is already associated with another contig v and the alignment of u and that of v over -\nlap, the contig u is removed as a repeat contig. We then mince contigs according to the \nopposite contig information. Lastly, the coverage and bubble information of the contigs \nwere included in the header. The coverage of the contigs associated with another contig \nwas set to C, and the coverage of other contigs was set to 2 × C (C is the constant value, \ndefault: 40).\nFor the paired-haplotype style (Platanus-allee) input, we first retrieved coverage depth \nand bubble information of contigs in the headers of the input assembly. Second, a pri -\nmary-bubble contig and a secondary-bubble counterpart were merged into a consensus \ncontig using bubble information (Additional file  1: Fig. S5b). For non-bubble contigs, if \nthe coverage depth of a contig was < Chetero × rupper-threshold, the contig was considered to \nbe a heterozygous contig that could not be associated. Otherwise, the contig was consid-\nered a homozygous contig. Chetero is the average coverage of heterozygous contigs calcu -\nlated in a similar manner to that calculated by Platanus-allee (r upper-threshold is a constant \nvalue; default = 1.75).\nPage 17 of 27\nOuchi et al. Genome Biology          (2023) 24:162 \n \nThe merging result is stored in array T. A consensus contig that merges primary-bub -\nble contig u and secondary-bubble contig v is stored as [u, v]. A heterozygous non-bub-\nble contig u is stored as [u, -]. A homozygous non-bubble contig u is stored as [u, u].\nMapping reads to contigs\nFor short reads (Illumina, 10X), the reads were mapped in a similar manner to that \nmapped by Platanus-allee using the k-mer exact unique match between a read and con -\ntig. The difference in GreenHill from Platanus-allee is as follows: if a k-mer matches two \ncontigs and the contigs belong to the same consensus contig, the read is mapped on one \nof the contigs as a “consensus link. ” Platanus-allee uses only unique k-mer matches for \nmapping. Consensus links are used in consensus scaffolding and not in phasing.\nLong reads (PacBio) were mapped to contigs in a similar manner as that mapped by \nPlatanus-allee using Minimap2. The difference in GreenHill from Platanus-allee is the \nmethod of greedy selecting the alignments. Platanus-allee selects the alignments accord-\ning to the order of #match-sites, whereas GreenHill selects according to the order of \nsequence identity (#match-sites divided by alignment length).\nFor Hi-C reads, the reads were mapped in the same manner as the mapping short \nreads, except for ignoring the insert length and read orientation between pairs of reads.\nConsensus scaffolding using long reads\nIn the first step of consensus scaffolding, we scaffolded consensus contigs using long \nread (and PE) information in a similar manner as that used by Platanus-allee (Additional \nfile 1: Fig. S6). The extension is that GreenHill can use Hi-C data to detect and correct \nmisassemblies.\nBriefly, we constructed a scaffold graph, where nodes represent contigs and edges \nindicate long read links between contigs. Next, we combined the non-branching nodes \nin which the indegree and outdegree are equal to one. Then, we removed erroneous \nedges using Hi-C (see the “ Detection of erroneous edges using Hi-C ” section), and con-\nstructed a scaffold using an algorithm similar to that used in Platanus-allee.\nConsensus scaffolding using Hi‑C\nIn the second step of consensus scaffolding, we also extended consensus scaffolds \n(results from the previous step) using Hi-C information (Additional file 1: Fig. S7). Chro-\nmosome-level consensus scaffolds were generated as follows.\n(1) We detected and corrected misassemblies in the input consensus scaffold. First, we \ndetected misassembly candidate regions in the consensus scaffold using Hi-C (see \n“Detection of misassembly using Hi-C ”), and determined the breakpoints using the \ncoverage of long read (and PE). Since a drop in coverage indicated a likely misas -\nsembly, we divided the scaffold at a minimum-coverage point in each misassembly-\ncandidate region.\n(2) We constructed an undirected graph where nodes represented the 5ʹ or 3ʹ ends of \nscaffolds and edges indicated Hi-C links between the ends of scaffolds. Node v’ was \ndenoted as the opposite end of node v, and the edge weight was calculated by the \nnumber of the Hi-C read pairs bridging the input scaffolds in the region at a dis -\nPage 18 of 27Ouchi et al. Genome Biology          (2023) 24:162 \ntance of L from the ends. Edges with weights smaller than a predefined threshold \n(default: 50 [L < 100 kb], 100 [L ≥ 100 kb]) were filtered out.\n(3) We identified the edge e with the maximum weight.\n(4) We checked if the edge e is an erroneous edge using Hi-C (see “  Detection of erro-\nneous edges using Hi-C ”) and long read (and PE) information (see “  Detection of \nerroneous edges using long reads”).\n(5) If edge e was surmised to be an erroneous edge at (4), it was removed; otherwise, \nwe connected the start and end nodes of edge e.\n(6) We iterated procedures (3)–(5) until the graph remained constant.\n(7) We iterated procedures (2)–(6) and gradually increased L by 10 kb (i.e., from 10 to \n100 kb) and 100 kb (i.e., from 100 kb to 1 Mb).\n(8) Without checking using long read (and PE) information, we reiterated procedures \n(2)–(7) to connect scaffolds across long repeat regions that cannot be exceeded by \nlong read.\nDetection of erroneous edges using Hi‑C\nWe checked the edge e between nodes u and w using the Hi-C contact matrix (Addi -\ntional file 1: Fig. S8) based on two facts: (1) the intra-chromosomal Hi-C interaction fre -\nquency is higher than the inter-chromosomal interaction frequency and (2) the closer \nthe distance, the stronger the intra-chromosomal interaction frequency [13].\n(1) We connected the scaffolds, represented as nodes u and w into a scaffold, and par -\ntitioned the scaffold into bins of fixed length (default: 100 kb). We created a Hi-C \nmatrix M by counting the number of linking Hi-C read pairs between bins. Each \npixel M i,j corresponds to the number of Hi-C links between a pair of bins (in this \ncase, ith and jth bins).\n(2) We calculated separation scores S and R at the boundary between u and w. The \nseparation scores S and R were defined as follows:\nwhere k is the distance from the diagonal; N in,k is the number of pixels in the inner \nregion within k of the diagonal; N out,k is the number of pixels in the outer region at a \ndistance k from the diagonal; µin,k is the average of the values of the pixels in the inner \nregion at a distance k from the diagonal; µout,k is the average of the values of the pixels \nin the outer region at a distance k from the diagonal; and Lout,k is the number of pix -\nels whose value is lower than µin,k in the outer region at a distance k from the diago -\nnal. The separation score S corresponds to the between-class variance, where the inner \nand outer regions are assumed to be two classes. This concept was derived from Otsu’s \nmethod [ 27]. The other score R was used to handle the sparse contact map, in which \n(1)S = k\nN in,k N out,k µin,k − µout,k\n2\nN in,k + N out,k\n2\n(2)R =\n∑\nk Lout,k∑\nk N out,k\nPage 19 of 27\nOuchi et al. Genome Biology          (2023) 24:162 \n \nmisassemblies are falsely detected. If edge e is an erroneous edge, the difference between \nthe inner and outer regions will be large, and the values of S and R will be large. S and \nR were calculated on both the upper and lower sides, and were denoted as S upper, Slower, \nRupper, and Rlower.\n(3) Edge e was surmised to be an erroneous edge if\nand\nwhere Supper,0 and Slower,0 are S values when the values of the pixels in the outer region \nare set to 0.\nDetection of misassembly using Hi‑C\nWe detected misassemblies in each scaffold using the Hi-C matrix (Additional file 1: Fig. \nS9). This step was inspired by other Hi-C scaffolding tools, such as 3D-DNA and HiCAs-\nsembler [39]. The concept of this function is similar to that of the detection of erroneous \nedges using Hi-C described in the previous section; however, the implementation is dif -\nferent for handling continuous input scaffolds.\n(1) We created Hi-C matrices of scaffolds larger than 300 kb and calculated the average \nnumber of Hi-C links between bins in the same scaffold for each distance from the \ndiagonal.\n(2) We created the Hi-C matrix of the target scaffold.\n(3) We calculated the misassembly score by placing a triangular motif along the diago -\nnal as follows:\nwhere k is the distance from the diagonal, µtarget,k is the average value of the pixels at a \ndistance k from the diagonal of the target scaffold, and µall,k is the average value of the \npixels at a distance k from the diagonal of all scaffolds. If the value of the misassembly \nscore is anomalously high, it suggests that the corresponding bin spans the misassembly \n(Additional file 1: Fig. S9a).\n(4) Peaks were detected in the misassembly score.\n(5) We defined P as the threshold for the misassembly score peak. If the misassembly \nscore peak is higher than P, we surmised that the corresponding bin spans a misas -\nsembly. Other Hi-C scaffolding tools used a fixed value for this type of threshold; \nhowever, GreenHill automatically determined this threshold. First, we divided the \ntarget scaffold at the position of the peak above P and calculated S at each cut posi -\n(3)S upper /S upper ,0 + S lower/S lower,0 ≥ s(constantvalue;default, 1.0)\n(4)R upper + R lower ≥ r(constantvalue;default, 1.6)\n(5)Score =\n∑ 10\nk=1\n(\nµall,k − µtarget,k\n)2\nµtarget,k\nPage 20 of 27Ouchi et al. Genome Biology          (2023) 24:162 \ntion. Then, we varied P from 0 to the maximum of the peaks and determined P \nsuch that the average of S was the maximum (Additional file 1: Fig. S9b).\n(6) The bins that have a peak above P were surmised as misassembly candidate regions \nif conditions (3) and (4) were satisfied.\nDetection of erroneous edges using long reads\nThe edge e  between nodes u  and w  were checked using long read (and PE) informa -\ntion (Additional file 1 : Fig. S10).\n(1) If the number of long read (and PE) links between nodes u and w exceeded the \nthreshold minLink (default: 0), edge e was surmised to be the correct edge.\n(2) We calculated the long read (and PE) links between nodes u and w’,  u’ and w, and \nu’ and w’ . If a node pair had links greater than minLink, then the edge between the \nnodes was used instead of edge e.\n(3) Otherwise, misassemblies were detected in the area within 300 kb from the ends \nof the scaffold based on the mapping information of the long read (and PE). First, \nwe identified the misassembly candidate region using mapping information. For PE \nand MP , we calculated the start (where the read was mapped) and end positions \n(the start position plus insert length tolerance) for each read, and calculated the \ninsertion length tolerance using the formula:\nwhere a is the average insert size of the library and d  is the standard deviation of \nthe insert size of the library. For long reads, the starting position was calculated as \nthe end of the alignment region to the scaffold.  The end position was calculated as the \nstart position plus the distance between the alignment region to the scaffold and the \nalignment region to the other scaffold. Misassemblies were considered to be located \nbetween the start and end positions. Therefore, the region between the start and end \npositions was detected as the misassembly candidate region. Next, the breakpoint in \nthe misassembly candidate region was determined. Since a drop in coverage indicated \na likely misassembly, we divided the scaffold at a minimum coverage point in each \nmisassembly candidate region.\nIn the presence of misassemblies, we corrected and surmised edge e  as the correct \nedge; otherwise, edge e  was surmised to be an erroneous edge.\nPhasing\nIn the phasing step, we divided the consensus scaffolds into haplotype blocks and \nconducted phasing using long read (and PE) and Hi-C read links (Additional file  1: \nFig. S11) as follows:\n(6)Insert length tolerance = a + 3 × d\nPage 21 of 27\nOuchi et al. Genome Biology          (2023) 24:162 \n \n(1) We identified the array of haplotype blocks (contigs or scaffolds), which was stored \nin the merge haplotype step. A phase was represented by a binary value (0 or 1), and \neach haplotype block consisted of a pair of sequences with phases (haplotype0 and \nhaplotype1). Blocks such as haplotype0 ≠ haplotype1 were identified as haplotype \nblocks, and blocks such as haplotype0 = haplotype1 were identified as homozygous \nblocks.\n(2) Let  haplotypei0 and  haplotypei1 be the sequences of phases 0 and 1 in the i-th hap -\nlotype block, respectively, where i represents an integer. Below, j also represents an \ninteger. We calculated long read (and PE) and Hi-C links between haplotype blocks \nand the number of links supporting the parallel  (haplotypei0 and  haplotypej0 in \nthe same phase) and cross paths  (haplotypei0 and  haplotypej1 in the same phase) \nbetween i-th and j-th haplotype blocks.\n(3) We connected the pair of haplotype blocks with the largest difference in the num -\nber of supporting links between the parallel and cross paths. If the number of links \nsupporting the cross path was larger than that of the parallel path, we swapped the \nhaplotype0 and haplotype1 of one of the haplotype blocks before connecting the \npair.\n(4) We repeated procedure (3) until no pair of haplotype blocks were connected.\n(5) We divided the scaffold between haplotype blocks that failed to connect. If there \nwas an unphased haplotype block inside a set of connected haplotype blocks, the \nphase of the unconnected block was determined randomly and the scaffold was not \ndivided.\nEstimation of heterozygosity\nHeterozygosity was estimated by k-mers (k-length sequences) in whole-genome \nsequencing reads (Illumina PE for C. elegans and cow, HiFi reads for D. melanogaster, \nzebra finch, black rhinoceros, and sterlet, 10X for budgerigar). The k-mer in the read was \ncounted, and the k-mer histogram was calculated by jellyfish [40]. Genomescope [41] \nwas used to estimate the level of heterozygosity. Results are shown in Additional file  1: \nTable S1. Notably, the cow sample’s heterozygosity was estimated from previous studies \nbecause the model fitting of Genomescope had a large discrepancy with the data.\nContig assembly\nPlatanus-allee (v2.2.2-modified; deposited in the repository of GreenHill v1.1.0) was \nexecuted using default parameters, except for the input files and multithreading. Par -\nticularly, the three commands of Platanus-allee, “assemble, ” “divide, ” and “phase, ” were \nexecuted, which corresponded to the contig-assembly, dividing contig at misassem -\nbly and phasing modules. The inputs of the “assemble” and “divide” were the Illumina \npaired-ends, excluding PacBio long reads or Hi-C reads. All libraries were inputted to \nthe “phase” command. For zebra finch, 10X reads were used instead of paired ends.\nFALCON-Unzip (v1.2.0 in Bioconda) was executed using the following parame -\nters: (length_cutoff = -1; length_cutoff_pr = 5000; pa_daligner_option = -e0.76 -l1200 \n-k18 -h70 -w8 -s100; ovlp_daligner_option = -k24 -h1024 -e.95 -l1800 -s100; pa_\nHPCdaligner_option = -v -B128 -M24; ovlp_HPCdaligner_option = -v -B128 -M24; \nPage 22 of 27Ouchi et al. Genome Biology          (2023) 24:162 \npa_HPCTANmask_option = -k18 -h480 -w8 -e.8 -s100; pa_HPCREPmask_option = -k18 \n-h480 -w8 -e.8 -s100; pa_DBsplit_option =—× 500 -s400; ovlp_DBsplit_option = -s400; \nfalcon_sense_option = –output-multi –min-idt 0.70 –min-cov 3 –max-n-read 400 \n–n-core 24; overlap_filtering_setting = –max-diff 100 –max-cov 150 –min-cov 3 –n-core \n24). For cow and zebra finch, FALCON-Unzip assembly was downloaded from NCBI \n(see “Data availability”). The FALCON-Unzip assembly of zebra finches is the result of \nrunning purge haplotig [42] on FALCON-Unzip for removing haplotype duplications in \nthe primary contig set.\nCanu (v2.1.1) was executed using the following options: “corOutCoverage = 200 \nbatOptions = -dg 3 -db 3 -dr 1 -ca 500 -cp 50. ” The option “corOutCoverage = 200” was \nset to output corrected reads with sufficient coverage depth. Other options were set \nfor the strict criterion of overlap detection among reads in terms of error rates. Over -\nall, these options were set to avoid the collapse of heterozygous regions and separate \nhaplotypes.\nHiCanu (v2.1.1) and Hifiasm (v0.16.1) were executed using default parameters, except \nfor input files and multithreading.\nExecution of FALCON‑Phase and Hi‑C scaffolding tools\nAdditional file  1: Fig. S12 shows how the FALCON-Phase and Hi-C scaffolding tools \nwere executed according to the methods in the FALCON-Phase paper [14].\nIf the input contigs were not generated by FALCON-Unzip, the input contigs were \nseparated into two sequences, purged contigs and haplotigs, using Purge_dups (v1.2.5) \n[26]. The coverage cutoffs were set manually from the coverage histogram. The headers \nof the purged contigs and haplotigs were renamed in the format required by FALCON-\nPhase using an in-house script. Briefly, each haplotigs was mapped to the purged contigs \nusing Minimap2 to find the associated purged contigs. The headers of purged contigs \nand haplotigs were renamed to indicate the placement.\nInput contigs were phased using FALCON-Phase (v1.2.0 in Bioconda) with the follow-\ning parameters: (min_aln_len = 3000, iterations = 1,000,000, output_format = pseudo-\nhap). The parameter for enzyme recognition was set to the recognition corresponding \nto the Hi-C library (“ AAG CTT ” for C. elegans, “ AAG CTT ” for D. melanogaster, “GATC” \nfor cow and sterlet, “GATC, GAATC, GATTC, GAGTC, GACTC” for zebra finch and \nbudgerigar, and “GATC, GAATC, GATTC, GAGTC, GACTC, CTAAG, CTTAG, \nCTGAG, CTCAG, TTAA” for black rhinoceros). Two haplotypes named “phased.0” and \n“phased.1” were generated using FALCON-Phase. For cow and zebra finches, FALCON-\nUnzip + FALCON-Phase results were downloaded from NCBI (see “Data availability”). \nThis process was performed to increase the accuracy of the following Hi-C scaffolding \nby creating phased contigs.\nNext, we scaffolded phased.0 using two Hi-C scaffolding tools, 3D-DNA and SALSA2.\nScaffolding via 3D-DNA was executed using Hi-C read mapping onto the contigs \nwith Juicer (v1.5.6) [36] using the default parameters. The read-mapping tool was Bur -\nrows–Wheeler Alignment (BWA) (v0.7.17-r1188) [43]. The restriction fragment file \nrequired by Juicer was generated using the “generate_site_positions.py” script. For mul -\ntiple restriction enzymes, we generated the BED file using the “digest_genome2.py” \nscript [44] and converted the BED file to the restriction fragment file for Juicer using \nPage 23 of 27\nOuchi et al. Genome Biology          (2023) 24:162 \n \nthe “hic-pro2juicer.py” script. Scaffolding via 3D-DNA (v180922) was performed using \ndefault parameters.\nScaffolding via SALSA2 was executed using the Hi-C read mapping results from the \nArima mapping pipeline (v100617) [37] with BWA, SAMtools (v1.3.1) [45], and Picard \n(v1.141) [46]. The mapping result in BAM format was converted into a BED file required \nby SALSA2 using the bamToBed of BEDTools (v2.27.1) [47]. The BED file was used as \nthe input for scaffolding using SALSA2 with default parameters.\nFinally, we executed FALCON-Phase again using the pairing of phased.1 and Hi-C \nscaffolding result as input. The headers of the phased.1 and Hi-C scaffolding results were \nrenamed in the format required by FALCON-Phase using an in-house script. Briefly, \neach phased.1 contig was mapped to the Hi-C scaffolding results using Minimap2 to \nfind the associated Hi-C scaffolding result. The headers of phased.1 and Hi-C scaffold -\ning results were renamed to indicate the placement. The FALCON-Phase was executed \nusing the same parameters as those in the first FALCON-Phase.\nCreating alignment dot plots\nWe created the alignment dot plots shown in Fig. 3 using the following method:\n(1) The scaffolds were aligned to the trio-binned assembly (TrioCanu) with nucmer \nand the alignment results were filtered using delta-filter.\n(2) We determined the placement of scaffolds on the trio-binned assembly by aligning \nthem to the trio-binned assembly using Minimap2 with the options of “-c -k 19. ” \nThe alignment score was calculated based on the value of the “ AS” tag in the PAF \nfile (output of Minimap2). The alignment of a scaffold to the same chromosome \nin the same direction was chained together. The position of the scaffold was then \ndetermined as the alignment position with the largest alignment score.\n(3) A modified version of the mummerplot was used to create alignment dot plots \nfor chromosome 1 with the alignment results from (1) and placement information \nfrom (2).\n(4) Coloring scaffolds were created using the same method as the “  Coloring scaffolds \nby haplotypes” section and placed on the left of the dot plots.\nOf note, the plot generated by this method is not strictly a “dot plot” , because the \nmummerplot represents the aligned regions as lines, not dots. However, we refer to it as \na \"dot plot\" in this study, because such a plot was often referred to as a “dot plot” in other \narticles and the mummperplot document.\nColoring scaffolds by haplotypes\nWe color-coded scaffolds according to the corresponding haplotype as follows:\n(1) The scaffolds (≧ 500  kb) were divided into non-overlapping and fixed-length \n(100 kb) fragments. The short scaffolds (< 500 kb) were not used for downstream \nsteps.\n(2) We identified the parental haplotype from which the fragment was inherited. Using \nthe hap-mer information from Merqury, we calculated the number of hap-mers \nPage 24 of 27Ouchi et al. Genome Biology          (2023) 24:162 \ninherited from the mother and father in the fragment. The fragment was identified \nas being inherited from the parental haplotype with a large number of inherited \nhap-mers. If the number of inherited hap-mers is the same for the parents, the frag-\nment was identified as homozygous. The fragments were color-coded according to \nthe corresponding haplotype (red for mother, blue for father, and gray for homozy -\ngote).\n(3) We determined the placement of scaffolds on the trio-binned assembly (see “  Cre-\nating alignment dot plots” (2)).\n(4) The fragments were displayed in position on the trio-binned assembly using the \nplacement information from (3) in the color determined by (2).\nSupplementary Information\nThe online version contains supplementary material available at https:// doi. org/ 10. 1186/ s13059- 023- 03006-8.\nAdditional file 1: Figure S1. Haplotype structures of the zebra finch assemblies for all chromosomes. Figure S2. \nHap-mer blob plots for budgerigar data. Figure S3. Hap-mer blob plots for black rhinoceros data. Figure S4. Hap-\nmer blob plots for sterlet data. Figure S5. Merge haplotype step. Figure S6. Consensus scaffolding using long reads. \nFigure S7. Consensus scaffolding using Hi-C. Figure S8. Detection of erroneous edges using Hi-C. Figure S9. Detec-\ntion of misassembly using Hi-C. Figure S10. Detection of erroneous edges using long reads. Figure S11. Phasing \nsteps. Figure S12. Execution of FALCON-Phase and Hi-C scaffolding tools. Table S1. Sample information. Table S2. \nContig assembly statistics. Table S3. Knock-out test for evaluation of the characteristic functions of GreenHill. \nTable S4. Resource requirements.\nAdditional file 2. Review_history.\nAcknowledgements\nNot applicable.\nPeer review information\nAndrew Cosgrove was the primary editor of this article and managed its editorial process and peer review in collabora-\ntion with the rest of the editorial team.\nReview history\nThe review history is available as Additional file 2.\nAuthors’ contributions\nSO, RK, and TI conceived the idea and designed the study. SO and RKdeveloped the software. SO, RK, and TI wrote the \nmanuscript. SO and RK performedthe benchmarks. All authors read and approved the final version of themanuscript.\nFunding\nJSPS KAKENHI [JP16H06279 (PAGS), JP22H04925(PAGS), JP15H05979,JP18K19286, JP19H03206, JP20K15769, JP21K19211, \nJP22H02598] from the Ministryof Education, Culture, Sports, Science and Technology of Japan.\nAvailability of data and materials\nC. elegans:\nThe reference sequences are available in the NCBI genome database (N2: GCF_000002985.6 [48] and CB4856: \nGCA_000975215.1 [49]). PacBio CLR reads are available in the DNA Data Bank of Japan DRA database (N2: DRR142774 \nand CB4856: DRR142768 [50]).\nD. melanogaster:\nThe reference sequences are available in the NCBI genome database (ISO1: GCF_000001215.4 [51] and A4: \nGCA_003401745.1 [52]). Parental short reads are available in the NCBI SRA database (ISO1: SRR6702604 [53] and A4: \nSRR457665, SRR457666, and SRR457707 [54]). PacBio HiFi, CLR reads are available from https:// obj. umiacs. umd. edu/ \nmarbl_ publi catio ns/ hicanu/ index. html [55].\nCow:\nIllumina paired-end, PacBio CLR, Hi-C, and parental short reads are available in the NCBI SRA database (PE: SRR6691721–\nSRR6691727, SRR6691748, SRR6691951–SRR6691953, and SRR6691961, CLR: SRR8224240–SRR8224250, SRR8695274, \nSRR6691737, SRR6691756–SRR6691758, SRR6691760, SRR6691761, SRR6691781, SRR6691805, SRR6691818, SRR6691819, \nSRR6691839, SRR6691844, SRR6691846, SRR6691858, SRR6691885, SRR6691887–SRR6691898, SRR6691900, SRR6691916, \nSRR6691919–SRR6691929, SRR6691945, SRR6691972, SRR6691973, SRR6691976–SRR6691983, and SRR8872908–\nSRR8872920, and Hi-C: SRR6691720, B. indicus short reads: SRR6691719, SRR6691880, SRR6691881, SRR6691906, B. taurus \nshort reads: SRR6691901–SRR6691903, and SRR6691907 [56]). Trio-binned parental Canu assemblies are available in the \nNCBI genome database (GCA_003369685.2 [57] and GCA_003369695.2 [58]). FALCON-Unzip contigs are available in the \nNCBI genome database (GCA_012069665.1 [59] and GCA_012070425.1 [60]). FALCON-Unzip + FALCON-Phase contigs are \navailable in the NCBI genome database (GCA_012070465.1 [61] and GCA_012070445.1 [62]).\nPage 25 of 27\nOuchi et al. Genome Biology          (2023) 24:162 \n \nZebra finch:\nPacBio CLR, HiFi, 10X, Hi-C, parental short reads, and trio-binned parental Canu assemblies are available in the Genom-\neArk database (https:// vgp. github. io/ genom eark/ Taeni opygia_ gutta ta [63]). FALCON-Unzip contigs are available in the \nNCBI genome database (GCA_012069585.1 [64] and GCA_012069535.1 [65]). FALCON-Unzip + FALCON-Phase contigs are \navailable in the NCBI genome database (GCA_012069615.1 [66] and GCA_012069575.1 [67]).\nBudgerigar:\nPacBio CLR, 10X, Hi-C, and parental short reads are available in the GenomeArk database (https:// vgp. github. io/ genom \neark/ Melop sitta cus_ undul atus [68]).\nBlack rhinoceros:\nHiFi, Hi-C, and parental short reads are available in the GenomeArk database (https:// vgp. github. io/ genom eark/ Dicer os_ \nbicor nis [69]).\nSterlet:\nHiFi, Hi-C, and parental short reads are available in the GenomeArk database (https:// vgp. github. io/ genom eark/ Acipe \nnser_ ruthe nus [70]).\nThe source code of GreenHill is GPL-3.0 licensed, and publicly available from both the Github repository (https:// github. \ncom/ ShunO uchi/ Green Hill [71]) and Zenodo open data repository (https:// doi. org/ 10. 5281/ zenodo. 80413 74 [72]).\nDeclarations\nEthics approval and consent to participate\nNot applicable.\nConsent for publication\nNot applicable.\nCompeting interests\nThe authors declare that they have no competing interests.\nReceived: 27 April 2022   Accepted: 4 July 2023\nReferences\n 1. Brinton J, Ramirez-Gonzalez RH, Simmonds J, Wingen L, Orford S, Griffiths S, et al. A haplotype-led approach to \nincrease the precision of wheat breeding. Commun Biol. 2020;3:1–11.\n 2. Glusman G, Cox HC, Roach JC. Whole-genome haplotyping approaches and genomic medicine. Genome Med. \n2014;6:73.\n 3. Tewhey R, Bansal V, Torkamani A, Topol EJ, Schork NJ. The importance of phase information for human genomics. \nNat Rev Genet. 2011;12:215–23.\n 4. Garg S. Computational methods for chromosome-scale haplotype reconstruction. Genome Biol. 2021;22:101.\n 5. Ebert P , Audano PA, Zhu Q, Rodriguez-Martin B, Porubsky D, Bonder MJ, et al. Haplotype-resolved diverse human \ngenomes and integrated analysis of structural variation. Science. 2021;372:6537.\n 6. Koren S, Rhie A, Walenz BP , Dilthey AT, Bickhart DM, Kingan SB, et al. De novo assembly of haplotype-resolved \ngenomes with trio binning. Nat Biotechnol. 2018;36:1174–82.\n 7. Cheng H, Concepcion GT, Feng X, Zhang H, Li H. Haplotype-resolved de novo assembly using phased assembly \ngraphs with hifiasm. Nat Methods. 2021;18:170–5.\n 8. Low WY, Tearle R, Liu R, Koren S, Rhie A, Bickhart DM, et al. Haplotype-resolved genomes provide insights into struc-\ntural variation and gene content in Angus and Brahman cattle. Nat Commun. 2020;11:2071.\n 9. Patterson M, Marschall T, Pisanti N, van Iersel L, Stougie L, Klau GW, et al. WhatsHap: Weighted Haplotype Assembly \nfor Future-Generation Sequencing Reads. J Comput Biol. 2015;22:498–509.\n 10. Edge P , Bafna V, Bansal V. HapCUT2: robust and accurate haplotype assembly for diverse sequencing technologies. \nGenome Res. 2017;27:801–12.\n 11. Chin C-S, Peluso P , Sedlazeck FJ, Nattestad M, Concepcion GT, Clum A, et al. Phased diploid genome assembly with \nsingle-molecule real-time sequencing. Nat Methods. 2016;13:1050–4.\n 12. Kajitani R, Yoshimura D, Okuno M, Minakuchi Y, Kagoshima H, Fujiyama A, et al. Platanus-allee is a de novo haplotype \nassembler enabling a comprehensive access to divergent heterozygous regions. Nat Commun. 2019;10:1–15.\n 13. Lieberman-Aiden E, van Berkum NL, Williams L, Imakaev M, Ragoczy T, Telling A, et al. Comprehensive mapping of \nlong range interactions reveals folding principles of the human genome. Science. 2009;326:289–93.\n 14. Kronenberg ZN, Rhie A, Koren S, Concepcion GT, Peluso P , Munson KM, et al. Extended haplotype-phasing of long-\nread de novo genome assemblies using Hi-C. Nat Commun. 2021;12:1935.\n 15. Zhang J, Zhang X, Tang H, Zhang Q, Hua X, Ma X, et al. Allele-defined genome of the autopolyploid sugarcane Sac-\ncharum spontaneum L. Nat Genet. 2018;50:1565–73.\n 16. Zhang X, Zhang S, Zhao Q, Ming R, Tang H. Assembly of allele-aware, chromosomal-scale autopolyploid genomes \nbased on Hi-C data. Nat Plants. 2019;5:833–45.\n 17. Zhou Q, Tang D, Huang W, Yang Z, Zhang Y, Hamilton JP , et al. Haplotype-resolved genome analyses of a heterozy-\ngous diploid potato. Nat Genet. 2020;52:1018–23.\n 18. Wu JQ, Song L, Ding Y, Dong C, Hasan M, Park RF. A Chromosome-Scale Assembly of the Wheat Leaf Rust Pathogen \nPuccinia triticina Provides Insights Into Structural Variations and Genetic Relationships With Haplotype Resolution. \nFront Microbiol. 2021;12:2180.\nPage 26 of 27Ouchi et al. Genome Biology          (2023) 24:162 \n 19. Cheng S-P , Jia K-H, Liu H, Zhang R-G, Li Z-C, Zhou S-S, et al. Haplotype-resolved genome assembly and allele-specific \ngene expression in cultivated ginger. Hortic Res. 2021;8:1–15.\n 20. Garg S, Fungtammasan A, Carroll A, Chou M, Schmitt A, Zhou X, et al. Chromosome-scale, haplotype-resolved \nassembly of human genomes. Nat Biotechnol. 2021;39:309–12.\n 21. Cheng H, Jarvis ED, Fedrigo O, Koepfli K-P , Urban L, Gemmell NJ, et al. Haplotype-resolved assembly of diploid \ngenomes without parental data. Nat Biotechnol. 2022;40:1332–5.\n 22. Rhie A, McCarthy SA, Fedrigo O, Damas J, Formenti G, Koren S, et al. Towards complete and error-free genome \nassemblies of all vertebrate species. Nature. 2021;592:737–46.\n 23. Koren S, Walenz BP , Berlin K, Miller JR, Bergman NH, Phillippy AM. Canu: scalable and accurate long-read assembly \nvia adaptive k-mer weighting and repeat separation. Genome Res. 2017;27:722–36.\n 24. Kolmogorov M, Yuan J, Lin Y, Pevzner PA. Assembly of long, error-prone reads using repeat graphs. Nat Biotechnol. \n2019;37:540–6.\n 25. Liu H, Wu S, Li A, Ruan J, Wu S, Li A, et al. SMARTdenovo: a de novo assembler using long noisy reads. Gigabyte. \n2021;2021:1–9.\n 26. Guan D, McCarthy SA, Wood J, Howe K, Wang Y, Durbin R. Identifying and removing haplotypic duplication in \nprimary genome assemblies. Bioinformatics. 2020;36:2896–8.\n 27. Otsu N. A Threshold Selection Method from Gray-Level Histograms. IEEE Trans Syst Man Cybern. 1979;9:62–6.\n 28. Ghurye J, Rhie A, Walenz BP , Schmitt A, Selvaraj S, Pop M, et al. Integrating Hi-C links with assembly graphs for \nchromosome-scale assembly. PLoS Comput Biol. 2019;15: e1007273.\n 29. Dudchenko O, Batra SS, Omer AD, Nyquist SK, Hoeger M, Durand NC, et al. De novo assembly of the Aedes aegypti \ngenome using Hi-C yields chromosome-length scaffolds. Science. 2017;356:92–5.\n 30. Wenger AM, Peluso P , Rowell WJ, Chang P-C, Hall RJ, Concepcion GT, et al. Accurate circular consensus long-read \nsequencing improves variant detection and assembly of a human genome. Nat Biotechnol. 2019;37:1155–62.\n 31. Rhie A, Walenz BP , Koren S, Phillippy AM. Merqury: reference-free quality, completeness, and phasing assessment for \ngenome assemblies. Genome Biol. 2020;21:245.\n 32. Huang W, Li L, Myers JR, Marth GT. ART: a next-generation sequencing read simulator. Bioinformatics. 2012;28:593–4.\n 33 DeMaere MZ, Darling AE. Sim3C: simulation of Hi-C and Meta3C proximity ligation sequencing technologies. GigaS-\ncience. 2018;7:gix103.\n 34. Nurk S, Walenz BP , Rhie A, Vollger MR, Logsdon GA, Grothe R, et al. HiCanu: accurate assembly of segmental duplica-\ntions, satellites, and allelic variants from high-fidelity long reads. Genome Res. 2020;30:1291–305.\n 35. Marçais G, Delcher AL, Phillippy AM, Coston R, Salzberg SL, Zimin A. MUMmer4: A fast and versatile genome align-\nment system. PLoS Comput Biol. 2018;14: e1005944.\n 36. Durand NC, Shamim MS, Machol I, Rao SSP , Huntley MH, Lander ES, et al. Juicer provides a one-click system for \nanalyzing loop-resolution Hi-C experiments. Cell Syst. 2016;3:95–8.\n 37. mapping_pipeline. https:// github. com/ Arima Genom ics/ mappi ng_ pipel ine. Accessed 26 Apr 2022.\n 38. Li H. Minimap2: pairwise alignment for nucleotide sequences. Bioinformatics. 2018;34:3094–100.\n 39. Renschler G, Richard G, Valsecchi CIK, Toscano S, Arrigoni L, Ramírez F, et al. Hi-C guided assemblies reveal conserved \nregulatory topologies on X and autosomes despite extensive genome shuffling. Genes Dev. 2019;33:1591–612.\n 40. Marçais G, Kingsford C. A fast, lock-free approach for efficient parallel counting of occurrences of k-mers. Bioinfor-\nmatics. 2011;27:764–70.\n 41. Ranallo-Benavidez TR, Jaron KS, Schatz MC. GenomeScope 2.0 and Smudgeplot for reference-free profiling of poly-\nploid genomes. Nat Commun. 2020;11:1432.\n 42. Roach MJ, Schmidt SA, Borneman AR. Purge Haplotigs: allelic contig reassignment for third-gen diploid genome \nassemblies. BMC Bioinformatics. 2018;19:460.\n 43. Li H. Aligning sequence reads, clone sequences and assembly contigs with BWA-MEM. arXiv. 2013. https:// doi. org/ \n10. 48550/ arXiv. 1303. 3997.\n 44 Kadota M, Nishimura O, Miura H, Tanaka K, Hiratani I, Kuraku S. Multifaceted Hi-C benchmarking: what makes a dif-\nference in chromosome-scale genome scaffolding? GigaScience. 2020;9:giz158.\n 45. Li H, Handsaker B, Wysoker A, Fennell T, Ruan J, Homer N, et al. The sequence alignment/map format and SAMtools. \nBioinformatics. 2009;25:2078–9.\n 46. Picard. https:// broad insti tute. github. io/ picard. Accessed 26 Apr 2022.\n 47. Quinlan AR, Hall IM. BEDTools: a flexible suite of utilities for comparing genomic features. Bioinformatics. \n2010;26:841–2.\n 48. C. elegans Sequencing Consortium, Caenorhabditis elegans. WBcel235. NCBI Assembly. 2013. https:// www. ncbi. \nnlm. nih. gov/ assem bly/ GCF_ 00000 2985.6.\n 49. University of Washington, Caenorhabditis elegans. Cael_CB4856_1.0. NCBI Assembly. 2015. https:// www. ncbi. nlm. \nnih. gov/ assem bly/ GCA_ 00097 5215.1.\n 50. Kajitani R, Yoshimura D, Okuno M, Minakuchi Y, Kagoshima H, Fujiyama A, et al. Platanus-allee is a de novo haplotype \nassembler enabling a comprehensive access to divergent heterozygous regions. DDBJ BioProject. 2019. https:// \nddbj. nig. ac. jp/ resou rce/ biopr oject/ PRJDB 7193.\n 51. The FlyBase Consortium/Berkeley Drosophila Genome Project/Celera Genomics, Drosophila melanogaster. Release \n6 plus ISO1 MT. NCBI Assembly. 2014. https:// www. ncbi. nlm. nih. gov/ assem bly/ GCA_ 00000 1215.4.\n 52. University of California - Irvine, Drosophila melanogaster. ASM340174v1. NCBI Assembly. 2018. https:// www. ncbi. \nnlm. nih. gov/ assem bly/ GCA_ 00340 1745.1.\n 53. Stowers Institute for Medical Research, Drosophila melanogaster. NCBI BioProject. 2018. https:// www. ncbi. nlm. nih. \ngov/ biopr oject/ PRJNA 433573.\n 54. The Drosophila Synthetic Population Resource - University of California, Drosophila melanogaster. NCBI BioProject. \n2012. https:// www. ncbi. nlm. nih. gov/ biopr oject/ PRJNA 156883.\n 55. Nurk S, Walenz BP , Rhie A, Vollger MR, Logsdon GA, Grothe R, et al. HiCanu: accurate assembly of segmental duplica-\ntions, satellites, and allelic variants from high-fidelity long reads. Down-sampled data sets. 2020. https:// obj. umiacs. \numd. edu/ marbl_ publi catio ns/ hicanu/ index. html.\nPage 27 of 27\nOuchi et al. Genome Biology          (2023) 24:162 \n \n•\n \nfast, convenient online submission\n •\n  \nthorough peer review by experienced researchers in your ﬁeld\n• \n \nrapid publication on acceptance\n• \n \nsupport for research data, including large and complex data types\n•\n  \ngold Open Access which fosters wider collaboration and increased citations \n \nmaximum visibility for your research: over 100M website views per year •\n  At BMC, research is always in progress.\nLearn more biomedcentral.com/submissions\nReady to submit y our researc hReady to submit y our researc h  ?  Choose BMC and benefit fr om: ?  Choose BMC and benefit fr om: \n 56. University of Adelaide, Bos indicus x Bos taurus breed:angus and brahman. NCBI BioProject. 2018. https:// www. ncbi. \nnlm. nih. gov/ biopr oject/ PRJNA 432857.\n 57. University of Adelaide, Bos indicus x Bos taurus. UOA_Angus_1. NCBI Assembly. 2018. https:// www. ncbi. nlm. nih. \ngov/ assem bly/ GCA_ 00336 9685.2.\n 58. University of Adelaide, Bos indicus x Bos taurus. UOA_Brahman_1. NCBI Assembly. 2018. https:// www. ncbi. nlm. nih. \ngov/ assem bly/ GCA_ 00336 9695.2.\n 59. PacBio, Bos indicus x Bos taurus. cow.Unzip_primary. NCBI Assembly. 2020. https:// www. ncbi. nlm. nih. gov/ assem bly/ \nGCA_ 01206 9665.1.\n 60. PacBio, Bos indicus x Bos taurus. cow.Unzip_haplotigs. NCBI Assembly. 2020. https:// www. ncbi. nlm. nih. gov/ assem \nbly/ GCA_ 01207 0425.1.\n 61. PacBio, Bos indicus x Bos taurus. cow.phase0_contigs. NCBI Assembly. 2020. https:// www. ncbi. nlm. nih. gov/ assem \nbly/ GCA_ 01207 0465.1.\n 62. PacBio, Bos indicus x Bos taurus. cow.phase1_contigs. NCBI Assembly. 2020. https:// www. ncbi. nlm. nih. gov/ assem \nbly/ GCA_ 01207 0445.1.\n 63. Vertebrate Genomes Project, Taeniopygia guttata. GenomeArk. 2023. https:// genom eark. github. io/ genom eark- all/ \nTaeni opygia_ gutta ta.\n 64. PacBio, Taeniopygia guttata. zebrafinch.Unzip_purge_primary. NCBI Assembly. 2020. https:// www. ncbi. nlm. nih. gov/ \nassem bly/ GCA_ 01206 9585.1.\n 65. PacBio, Taeniopygia guttata. zebrafinch.Unzip_purge_haplotigs. NCBI Assembly. 2020. https:// www. ncbi. nlm. nih. \ngov/ assem bly/ GCA_ 01206 9535.1.\n 66. PacBio, Taeniopygia guttata. zebrafinch.phase0_contigs. NCBI Assembly. 2020. https:// www. ncbi. nlm. nih. gov/ assem \nbly/ GCA_ 01206 9615.1.\n 67. PacBio, Taeniopygia guttata. zebrafinch.phase1_contigs. NCBI Assembly. 2020. https:// www. ncbi. nlm. nih. gov/ assem \nbly/ GCA_ 01206 9575.1.\n 68. Vertebrate Genomes Project, Melopsittacus undulatus. GenomeArk. 2019. https:// genom eark. github. io/ genom eark- \nall/ Melop sitta cus_ undul atus.\n 69. Vertebrate Genomes Project, Diceros bicornis. GenomeArk. 2022. https:// vgp. github. io/ genom eark/ Dicer os_ bicor \nnis.\n 70. Vertebrate Genomes Project, Acipenser ruthenus. GenomeArk. 2022. https:// vgp. github. io/ genom eark/ Acipe nser_ \nruthe nus.\n 71. GreenHill. https:// github. com/ ShunO uchi/ Green Hill. Accessed 10 May 2023.\n 72. Ouchi S, Kajitani R. ShunOuchi/GreenHill: GreenHill v1.1.0 (v1.1.0). Zenodo. 2023. https:// doi. org/ 10. 5281/ zenodo. \n80413 74.\nPublisher’s Note\nSpringer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.",
  "topic": "Contig",
  "concepts": [
    {
      "name": "Contig",
      "score": 0.807894229888916
    },
    {
      "name": "Biology",
      "score": 0.7588914036750793
    },
    {
      "name": "Chromosome",
      "score": 0.6426352858543396
    },
    {
      "name": "Haplotype",
      "score": 0.6403837203979492
    },
    {
      "name": "Genome",
      "score": 0.6368324756622314
    },
    {
      "name": "Genetics",
      "score": 0.5677456259727478
    },
    {
      "name": "Computational biology",
      "score": 0.5184575915336609
    },
    {
      "name": "Phaser",
      "score": 0.5113713145256042
    },
    {
      "name": "Ploidy",
      "score": 0.46828052401542664
    },
    {
      "name": "Contiguity",
      "score": 0.4307372570037842
    },
    {
      "name": "Gene",
      "score": 0.1422255039215088
    },
    {
      "name": "Physics",
      "score": 0.090119868516922
    },
    {
      "name": "Ecology",
      "score": 0.0
    },
    {
      "name": "Optics",
      "score": 0.0
    },
    {
      "name": "Genotype",
      "score": 0.0
    }
  ],
  "institutions": [
    {
      "id": "https://openalex.org/I114531698",
      "name": "Tokyo Institute of Technology",
      "country": "JP"
    }
  ]
}