{
  "title": "Transformer fault diagnosis method based on SMOTE and NGO-GBDT",
  "url": "https://openalex.org/W4393190681",
  "year": 2024,
  "authors": [
    {
      "id": "https://openalex.org/A2516832495",
      "name": "Li-Zhong Wang",
      "affiliations": [
        "Shanghai Electric (China)"
      ]
    },
    {
      "id": null,
      "name": "Jian-fei Chi",
      "affiliations": [
        "Shanghai Electric (China)"
      ]
    },
    {
      "id": "https://openalex.org/A5108911806",
      "name": "Ye-qiang Ding",
      "affiliations": [
        "Shanghai Electric (China)"
      ]
    },
    {
      "id": "https://openalex.org/A2213117226",
      "name": "Hai-yan Yao",
      "affiliations": []
    },
    {
      "id": "https://openalex.org/A2006571878",
      "name": "Qiang Guo",
      "affiliations": []
    },
    {
      "id": "https://openalex.org/A5102635672",
      "name": "Hai-qi Yang",
      "affiliations": [
        "Northeast Electric Power University"
      ]
    },
    {
      "id": "https://openalex.org/A2516832495",
      "name": "Li-Zhong Wang",
      "affiliations": []
    },
    {
      "id": null,
      "name": "Jian-fei Chi",
      "affiliations": []
    },
    {
      "id": "https://openalex.org/A5108911806",
      "name": "Ye-qiang Ding",
      "affiliations": []
    },
    {
      "id": "https://openalex.org/A2213117226",
      "name": "Hai-yan Yao",
      "affiliations": [
        "Shanghai Electric (China)"
      ]
    },
    {
      "id": "https://openalex.org/A2006571878",
      "name": "Qiang Guo",
      "affiliations": [
        "Shanghai Electric (China)"
      ]
    },
    {
      "id": "https://openalex.org/A5102635672",
      "name": "Hai-qi Yang",
      "affiliations": [
        "Northeast Electric Power University",
        "Electric Power University"
      ]
    }
  ],
  "references": [
    "https://openalex.org/W4312307467",
    "https://openalex.org/W4388297021",
    "https://openalex.org/W4387882831",
    "https://openalex.org/W4386826691",
    "https://openalex.org/W4210587662",
    "https://openalex.org/W4213348428",
    "https://openalex.org/W4385688160",
    "https://openalex.org/W4320001385",
    "https://openalex.org/W4376645472",
    "https://openalex.org/W4378806072",
    "https://openalex.org/W4293707325",
    "https://openalex.org/W4386435890",
    "https://openalex.org/W4385604189",
    "https://openalex.org/W4388558401",
    "https://openalex.org/W4388271669",
    "https://openalex.org/W4321380810",
    "https://openalex.org/W4366572569",
    "https://openalex.org/W4380627103",
    "https://openalex.org/W4294955571",
    "https://openalex.org/W4388634715",
    "https://openalex.org/W3167503623",
    "https://openalex.org/W4206146696",
    "https://openalex.org/W4313368164",
    "https://openalex.org/W4285010829",
    "https://openalex.org/W4380995421",
    "https://openalex.org/W4324137853",
    "https://openalex.org/W4382047806"
  ],
  "abstract": null,
  "full_text": "1\nVol.:(0123456789)Scientific Reports |         (2024) 14:7179  | https://doi.org/10.1038/s41598-024-57509-w\nwww.nature.com/scientificreports\nTransformer fault diagnosis \nmethod based on SMOTE \nand NGO‑GBDT\nLi‑zhong Wang 1, Jian‑fei Chi 1, Ye‑qiang Ding 1, Hai‑yan Yao 2, Qiang Guo 2 & Hai‑qi Yang 3*\nIn order to improve the accuracy of transformer fault diagnosis and improve the influence of \nunbalanced samples on the low accuracy of model identification caused by insufficient model training, \nthis paper proposes a transformer fault diagnosis method based on SMOTE and NGO‑GBDT. Firstly, \nthe Synthetic Minority Over‑sampling Technique (SMOTE) was used to expand the minority samples. \nSecondly, the non‑coding ratio method was used to construct multi‑dimensional feature parameters, \nand the Light Gradient Boosting Machine (LightGBM) feature optimization strategy was introduced \nto screen the optimal feature subset. Finally, Northern Goshawk Optimization (NGO) algorithm was \nused to optimize the parameters of Gradient Boosting Decision Tree (GBDT), and then the transformer \nfault diagnosis was realized. The results show that the proposed method can reduce the misjudgment \nof minority samples. Compared with other integrated models, the proposed method has high fault \nidentification accuracy, low misjudgment rate and stable performance.\nKeywords Fault diagnosis, Transformers, Oversampling, LightGBM feature selection, GBDT, Northern \ngoshawk optimization algorithm\nPower transformers are key equipment in the transmission and transformation system, and their operating status \nis related to the stability of the power system. When a transformer malfunctions, if accurate diagnosis cannot \nbe made in a timely manner, it will cause significant economic losses. Therefore, how to improve the accuracy \nof transformer fault diagnosis has always been a hot topic for scholars to study.\nAs the aging process of transformer insulation progresses,  H2,  CH4,  C2H6,  C2H4,  C2H2,  CO2, and other gases \nare produced and dissolve into the insulating oil. The present condition of the transformer may be inferred from \nthe concentration and composition of these dissolved gases within the  oil1. The predominant analytical tech-\nniques employed to assess the transformer’s condition encompass the IEC three-ratio  method2, Rogers’ four-ratio \n method3, Duval  Pentagon4, Doernberg’s ratio  method5, among others.  In6, a fuzzy logic approach was proposed to \novercome the shortcomings of traditional IEC methods and enhance the accuracy of model diagnosis.  In7, based \nupon the data of dissolved gases within oil, a fuzzy logic-based transformer fault diagnosis model employing \nthe Rogers Four Ratio Method has been developed. The model’s implementation has demonstrated its capacity \nto rectify the deficiencies inherent in conventional fault diagnosis methods, thereby enhancing the accuracy of \nfault diagnosis. Conversely, this method lacks comprehensive coding and the diagnostic threshold is too rigidly \ndefined, thereby failing to capture the intricate nature of faults within the transformer and compromising the \naccuracy of fault  diagnosis8.  In9, the ratio coding method and raw gas data are used to construct 24-dimensional \nfeatures, which improves the model’s ability to distinguish between different faults and makes it more versatile. \nRef.10. proposes a PSO-RF diagnostic model that extracts transformer fault characteristic information without \nusing coding ratios, thereby improving the model’s fault diagnosis capabilities. However, in existing research, \nthe dimensionality explosion problem is less considered when constructing feature parameters. Because as the \nsample size increases, the fault diagnosis model becomes better. However, the increase in feature dimension leads \nto an exponential increase in the amount of calculation and an increase in redundant information. Therefore, it \nis necessary to remove redundant information to improve model operation efficiency and diagnostic accuracy.\nAs artificial intelligence technology advances, machine learning applications in transformer fault diagno -\nsis have gained momentum. Support Vector  Machine11–13, Convolutional Neural Network(CNN) 14,15, Self-\nOrganizing Mapping Neural Network(SOM)16, Gate Recurrent Unit(GRU)17,18, Cloud Model(CM)19, Adaptive \nOPEN\n1State Grid Zhejiang Power Co., Ltd, Hangzhou Linping Power Supply Company, Hangzhou 311199, \nChina. 2Hangzhou Electric Power Equipment Manufacturing Co., Ltd, Yuhang Qunli Complete Sets Electricity \nManufacturing Branch Electric, Hangzhou 311000, China. 3School of Mechanical Engineering, Northeast Electric \nPower University, Jilin 132012, China. *email: xhaiqi0526@163.com\n2\nVol:.(1234567890)Scientific Reports |         (2024) 14:7179  | https://doi.org/10.1038/s41598-024-57509-w\nwww.nature.com/scientificreports/\nBoosting(AdaBoost)20, Gradient Boosting Decision Tree(GBDT)21 and other models have demonstrated remark-\nable success in classification identification. Y et, The fault diagnosis models mentioned above were all constructed \nbased on the assumption of having a relatively large dataset. However, in practical operations, transformers \nrarely experience failures and the frequencies of different types of faults vary significantly. This makes it difficult \nto meet the precision requirements using big data samples. Therefore, when addressing the practical challenges \nof transformer fault diagnosis, the issue of sample imbalance needs to be given immediate attention in order to \nachieve precision.\nThe formulation of transformer fault diagnosis models hinges upon an abundance of data sets. In practical \noperations, the likelihood of transformer malfunction is slim; the variance of diverse fault types is vast, thereby \nmaking it challenging to attain the requisite standards for extensive datasets.\nResearch on imbalanced datasets mainly focuses on developing classifiers and data preprocessing techniques. \nData-level processing involves reconstructing the dataset to better align with its inherent characteristics, thereby \naddressing issues arising from an imbalance in sampling frequency.  undersampling22 involves selecting a subset of \nthe most representative samples from the majority classes to mitigate the issue of class imbalance. However, this \napproach may result in the loss of crucial information regarding the bulk of sample classes, ultimately impairing \nthe performance of classifiers. Oversampling involves artificially increasing a limited sample size to achieve data \nbalance. This can be done through techniques such as Synthetic Minority Oversampling Technique(SMOTE)23,24, \nSVM  SMOTE25, Borderline-SMOTE 26, Adaptive Synthetic Sampling(ADASYN) 27, Generative Adversarial \nNetwork(GAN)28, and others. Common approaches at the classification algorithm level include  CostSensitive29 \nand Ensemble  Learning30.  In31, cost-sensitive classifiers are used to address class disparities and improve fault \ncategorization accuracy. The Auxiliary Generation Mutual Countermeasure Network (AGMAN) was proposed \nin Ref.32. to enhance the accuracy of small sample class imbalance fault diagnosis.  In33, MeanRadius-SMOTE is \nproposed based on the traditional SMOTE oversampling algorithm, which effectively avoids the generation of \nuseless samples and noisy samples, and the generalization of this algorithm is verified.\nThe main contributions of this work are as follows: (1) Improved classification performance on imbalanced \nand small sample data using oversampling methods, avoiding classifiers focusing too much on majority samples \nand causing the classifier’s hyperplane to shift towards minority class samples. (2) Established a deep relation -\nship between dissolved gases in oil and fault types, reduced redundancy between features by using LightGBM \nfeature selection, and improved the computational efficiency of the diagnostic model. (3) Optimized algorithm \nfor parameter optimization of the diagnostic model to establish the optimal diagnostic model. Finally, the effec-\ntiveness of the proposed methods in this paper was verified through different sampling methods, different feature \nselection methods, and different diagnostic models.\nNGO‑GBDT transformer fault diagnosis method based on balanced data set\nComposite minority oversampling technique\nThe main idea of the SMOTE is to randomly select a majority class sample, then find the k  nearest neighbors, \nand select a sample from the k nearest neighbors according to the sampling probability to generate a new sample \nbased on formula (1), repeatedly balancing the dataset.\nAmong them, Z1 is the majority class sample; Z2 is one of the k samples closest to Zi; rand belongs to a random \nnumber of [0,1]; Y represents the newly generated minority class sample.\nNorthern goshawk optimization algorithm\nThe northern goshawk optimization  algorithm34 is a new meta heuristic algorithm proposed in 2022, which \nsimulates the behavior of northern goshawks during hunting. The hunting strategy is mainly divided into two \nstages: prey identification stage and chase and escape behavior stage.\n(1) Initialization phase\n  Population initialization, as shown in formula (2):\n  Among them, X represents the matrix of the population, Xi is the initial value of the ith individual, xi,j are \nthe values of the jth dimension of the ith individual, N is the number of populations, and m is the dimen-\nsion of the search space.\n  The objective function of the population is shown in formula (3):\n(1)Y = Zi + rand × (Z1 − Z2)\n(2)X =\n\n\nX1\n...\nXi\n...\nXN\n\n\nN ×m\n=\n\n\nx1,1 ··· x1, j ··· x1, m\n... ... ... ... ...\nxi,1 ··· xi,j ··· xi,m\n... ... ... ... ...\nxN ,1 ··· xN ,j ··· xN ,m\n\n\n3\nVol.:(0123456789)Scientific Reports |         (2024) 14:7179  | https://doi.org/10.1038/s41598-024-57509-w\nwww.nature.com/scientificreports/\n  Among them, F is the vector of the obtained objective function value, and F i is the objective function \nvalue corresponding to the ith solution.\n(2) Prey identification stage\n  In the first stage of hunting, the goshawk randomly selects its prey and quickly attacks it. The mathemati-\ncal expressions of the northern goshawk at this stage are shown in formulas (4) to (6):\n  Among them, Pi is the prey position corresponding to the ith goshawk; Fp,i is the corresponding objec-\ntive function value; A random integer k ∈[1, N] and not equal to i; xnew,p1 x,j are the new positions of the \nith solution, and Fnew,p1 i are the corresponding objective function values for the prey recognition stage; \nrandom numbers with k  ∈[0,1]; I = 1 or 2; r and I are random numbers used to generate random NGO \nbehavior in search and update.\n(3)  Chasing and escaping behavior stage\n  After attacking its prey, the eagle instinctively attempts to escape. Due to the rapid and agile movements \nof the goshawk, it pursues its prey in any situation and ultimately hunts. The mathematical expressions at \nthis stage are as follows:\nwhere: t and T represent the current and maximum number of iterations, respectively; R is the attack radius, \nwhich decreases as the number of iterations increases; Xnew, p2 x, j are the new positions of the ith solution; \nFnew,p2 iis the objective function value for this stage.\nBased on LightGBM feature selection\nLightGBM35 is an efficient framework of gradient enhancement decision tree algorithm, which can evaluate the \nimportance of features, and speed up the training of models by eliminating features of low importance to avoid \ndimensional disasters. The steps for calculating the feature importance are as follows:\nFor the training set W = {w1,w2,…,wn} corresponding to{g1,g2,…,gn}, the sampling rate of the sample is a, and \nthe sampling rate of the small gradient sample is b, then the steps for calculating feature importance are as follows:\nStep 1: sorting the fault samples in descending order according to the absolute value of the gradient;\nStep 2: selecting the initial a × N samples to form a large gradient sample subset C1;\nStep 3: a random selection of b  × N samples is drawn from the remaining faulty samples to form a smaller \ngradient sample subset D1;\nStep 4: adopting C1 × D1 to learn new decision trees, assign weights (1-a)/b to small gradient faulty samples \nwhen calculating information gain at computing nodes;\nStep 5: reiterate Steps 1–4 until reaching a predetermined iteration count or convergence threshold. Through-\nout the model, the sum of the information gain of each feature across all nodes of a split feature represents the \nsignificance of that feature.\nTransformer fault diagnosis process\nThe methodology for transformer fault diagnosis through SMOTE and NGO-GBDT entails two stages: offline \nmodel training and online identification and diagnosis. The specific workflow is depicted in Fig.  1. During the \n(3)F(X ) =\n\n\nF1 = F(X1 )\n...\nFi = F(Xi)\n...\nFN = F(XN )\n\n\nN ×1\n(4)Pi = Xk,k = 1, 2,··· ,k − 1,··· ,N\n(5)xnew ,p1\nx,j =\n{\nxi,j + r\n(\npi,j − Ixi,j\n)\n,Fp,i < Fi\nxi,j + r\n(\nxi,j − pi,j\n)\n,Fp,i ≥ F\n(6)X i =\n{\nX new,p1\ni ,Fnew,p1\ni < Fi\nX i,Fnew,p1\ni ≥ F\n(7)xnew ,p2\nx,j = xi,j + R (2r − 1)xi,j\n(8)R = 0.02\n(\n1 − t\nT\n)\n(9)X i =\n{\nX new,p1\ni ,Fnew,p2\ni < Fi\nX i,Fnew,p2\ni ≥ F\n4\nVol:.(1234567890)Scientific Reports |         (2024) 14:7179  | https://doi.org/10.1038/s41598-024-57509-w\nwww.nature.com/scientificreports/\noffline training stage for transformer faults, a single session suffices; upon securing the optimal diagnostic model, \nthe deployment is conducted, paving the way for online identification and diagnosis.\nThe specific steps in the offline training phase are as follows:\nStep 1: Sample data preprocessing. The collected DGA samples are normalized, and the data set is balanced \nthrough the application of the SMOTE.\nStep 2: Feature selection. The candidate feature set is established through the code-free ratio method, while \nthe optimal input feature is determined via the LightGBM.\nStep 3: Model training and validation. The training set, validation set, and test set are separated; the param -\neters of the GBDT model, including those of max_ depth, n_ estimators, and learning_rate, are optimized using \nthe NGO algorithm. Therefore, utilizing the verification set to assess the diagnostic efficacy of each iterationary \nmodel, if the disparity in accuracy between successive training sessions does not exceed five percent, save the \nmodel parameters upon conclusion of the training; In the event that such conditions are not met, one must \nretrain the model until they are fulfilled.\nStep 4: Model validation. The test dataset is fed into the optimal model; the diagnostic accuracy of the NGO-\nGBDT model is validated.\nThe specific steps in the online identification and diagnosis stage are as follows:\nStep 1: Sample data preprocessing. Normalizing the DGA samples collected in real-time.\nStep 2: The candidate feature set is established through the code-free ratio method, while the optimal input \nfeature is determined via the LightGBM.\nStep 3: The subset of optimal characteristics is directly inputted into the optimal model, thereby obtaining \nthe results of online diagnosis of transformers.\nTransformer fault diagnosis process\nIn the context of imbalanced data classification, an overabundance of samples from dominant classes can result \nin the model’s tendency to excessively focus on the majority categories, thereby neglecting a select few. This can \nlead to the plane of the classifier shifting towards a subset of samples within these categories. To effectively assess \nthe efficacy of the transformed transformer fault diagnosis model, this paper selects a multi classification evalu-\nation index system based on confusion matrix, with accuracy, recall, F1 value, G-mean, and Kappa coefficient \nas the model evaluation indicators.\n(1) Precision and recall\n  The accuracy is the proportion of predicted positive samples to actual positive samples. The recall rate \nrepresents the proportion of predicted positive samples in the actual positive sample results.\nTraining set Test setValidation set\nNGO-GBDT\nmodel training\nVerification \nmodel\nsatisfy the \naccuracy˛\nSave the model\nOptimal \nclassifier\nDiagnostic \nresults\nEnd\nYes\nNo\nOffline training\nStart\nDGA data set\nNormalisation\nRatio coding method\nLightGBM feature screening\nSMOTE oversampling\nReal-time \noperational data\nNormalisation\nRatio coding \nmethod\nAdaBoost feature \nscreening\nOnline identification \nof diagnostic stages\nFigure 1.  Flow chart of transformer fault diagnosis.\n5\nVol.:(0123456789)Scientific Reports |         (2024) 14:7179  | https://doi.org/10.1038/s41598-024-57509-w\nwww.nature.com/scientificreports/\n  Among them, represents the accuracy; R represents the recall rate; TP is the case when the classification \nof the positive sample is correct; FP is the case where the counter example sample is misclassified; FN is the \ncase where the positive sample is misclassified.\n(2)  F1 value (F1 score)\n  The F1 value represents the harmonic average of accuracy and recall.\n(3) Kappa coefficient\n  The kappa coefficient reflects the consistency between real classification and predicted classification, and \nis one of the commonly used indicators to evaluate the accuracy of fault diagnosis.\n  Among them, P0 is the number of correctly predicted samples divided by the total number of samples.\n  Assuming that the true samples for each class are a 1, a2, …, ae, and the predicted unclassified samples \nare b1, b2, …, be, respectively\n  The range of Kappa coefficient values is [0,1], which is generally divided into five groups to represent dif-\nferent levels of consistency: 0–0.20 (extremely low consistency), 0.21–0.40 (general consistency), 0.41–0.60 \n(medium consistency), 0.61–0.80 (high consistency), and 0.81–10 (almost identical). That is, the closer the \nkappa coefficient is to 1, the better the diagnostic effect.\nExample analysis\nAccording to DL/T722-2014 Analysis and Judgment Criteria for Dissolved Gases in Transformer  Oil27, trans-\nformers are classified into six types based on whether or not the transformer has malfunctioned and the type \nof fault. They are represented by labels 1–6, including low energy discharge (D1), high energy discharge (D2), \nmedium low temperature heat release (T1&T2), high temperature heat release (T2), partial discharge (PD), and \nnormal (N) This article selects 480 sets of monitoring data provided by a power supply company in Yuhang City, \nZhejiang Province as the fault sample set. Each operating state in the sample set includes 5 characteristic gases, \nincluding  H2,  CH4,  C2H6,  C2H4, and  C2H2. The distribution of the dataset and sample labels are shown in Table 1.\nData preprocessing\nWhen a transformer malfunctions, the composition and content of dissolved gases in the insulation oil will \nchange. This article selects  H2,  CH4,  C2H6,  C2H4, and  C2H2 dissolved in the oil as sample inputs. Normalize the \ncharacteristic gas, as shown in formula (15):\nAmong them, xi and x′ are features before and after normalization; Ximin and Ximax is the minimum and \nmaximum values of each column feature in the raw data before normalization.\n(10)P = TP\nTP + FP\n(11)R = TP\nTP + FN\n(12)F1 = 2PR\nP + R\n(13)Kappa = p0 − pe\n1 − pe\n(14)pe = a1 × b1 + a2 × b2 +···+ an × bn\nn × n\n(15)x ′ = x i − x imin\nx imax − x imin\nTable 1.  Dataset distribution and sample labels.\nStatus type Quantity Proportion (%) Label\nN 78 16.3 1\nD2 105 21.9 2\nT1&T2 147 30.6 3\nT2 76 15.8 4\nPD 45 9.4 5\nD1 29 6.0 6\n6\nVol:.(1234567890)Scientific Reports |         (2024) 14:7179  | https://doi.org/10.1038/s41598-024-57509-w\nwww.nature.com/scientificreports/\nData balancing processing\nIn accordance with Table 1, it becomes apparent that mid-to-low temperature overheat failures constitute 30.6% \nof all instances, whereas partial discharge failures comprise merely 6.0%. Should the data sets employed for model \nformulation be imbalanced, the model may not acquire sufficient proficiency in certain sample types, leading \nto an increased likelihood of misclassifying these sample types during the identification stage, thereby compro-\nmising the accuracy of the model’s classification. In this study, we employ SMOTE to balance the dataset. The \nsample distribution subsequent to SMOTE oversampling is depicted in Table  2. In preparation for subsequent \nfeature optimization, model training, and diagnostic purposes, the sample count for each category in Table  2 \nhas been harmonized.\nOptimization of transformer fault characteristics\nIn the field of DGA fault diagnosis, the IEC three-ratio method, Rogers four-ratio method, and uncoded ratio \nmethod are generally used as references. However, the above methods have incomplete feature selection and \ninsufficient data utilization, and cannot fully reflect the relationship between faults and features. Therefore, \nthis paper uses 5 characteristic gases as the basis to construct 19-dimensional ratio characteristics, as shown in \nTable 3.\nThe 19-dimensional features constructed in this article expand the feature space and make full use of data \ninformation. However, there will be information redundancy. These redundant features will increase the com -\nputational burden of the model. It is necessary to reduce the data dimensions and reduce the complexity of the \nmodel. Therefore, the LightGBM feature importance evaluation method is introduced to optimize the 19-dimen-\nsional features. The feature importance ranking results are shown in Table  4. Features sorted according to the \nTable 2.  Data distribution before and after SMOTE balancing.\nData type\nSample quantity\nN D2 T1&T2 T2 PD D1\nRaw data 78 105 147 76 45 29\nAfter SMOT balancing treatment 147 147 147 147 147 147\nTable 3.  Characteristic code and characteristic quantity of dissolved gas in oil. \nTHC =  CH4+  C2H6+  C2H4+  C2H2. ALL =  H2+  CH4+  C2H6+  C2H4+  C2H2.\nFeature encoding Characteristic quantity Feature encoding Characteristic quantity\nS1 H2 S11 CH4/H2\nS2 CH4 S12 C2H2/H2\nS3 C2H6 S13 C2H4/THC\nS4 C2H4 S14 C2H6/THC\nS5 C2H2 S15 CH4/THC\nS6 CH4/  C2H6 S16 C2H2/THC\nS7 CH4/  C2H4 S17 H2/THC\nS8 C2H6/  C2H4 S18 (CH4+  C2H4)/THC\nS9 C2H2/  C2H4 S19 H2/ALL\nS10 C2H4/  C2H6\nTable 4.  Feature importance ranking results.\nFeature ranking Feature encoding value (%) Feature encoding Feature ranking Feature encoding value (%) Feature encoding\n1 18.7 S11 11 3.0 S19\n2 15.0 S3 12 2.7 S17\n3 14.2 S7 13 2.1 S18\n4 8.7 S9 14 1.8 S8\n5 5.5 S1 15 1.7 S10\n6 5.0 S4 16 1.4 S14\n7 4.4 S5 17 0.4 S5\n8 4.0 S12 18 0.9 S15\n9 4.0 S2 19 0.8 S6\n10 3.5 S16\n7\nVol.:(0123456789)Scientific Reports |         (2024) 14:7179  | https://doi.org/10.1038/s41598-024-57509-w\nwww.nature.com/scientificreports/\nimportance of LightGBM features are sequentially and incrementally input into the GBDT model for diagno-\nsis and identification. In order to avoid contingency, ten-fold cross-validation is performed on the input data \nsampling, and the average accuracy is taken as the final result, as shown in Fig.  2. As the number of features \nincreases from 1 to 8 in Fig. 2, the diagnostic accuracy of the GBDT model gradually increases. When the num-\nber of features is 8, the average diagnostic accuracy reaches a maximum of 93.68%. When the fault diagnosis \naccuracy reaches a high point, as the number of features continues to increase, its accuracy remains unchanged \nor decreases. The reason is that too many features lead to an increase in the complexity of the model. Based on \nthis, the first 8-dimensional features sorted by LightGBM are selected for model training and diagnosis.\nAnalysis of fault diagnosis results\nThe selected optimal feature subset is divided into training set, test set and verification set according to the ratio \nof 6:2:2. The specific distribution is shown in Table 5.\nIn order to ensure the accuracy and effectiveness of the model, NGO is used to optimize max_depth, learning \nrate, learning_rate and n_estimators. The GBDT hyperparameter optimization range is set as shown in Table 6. \nFigure 3 shows the confusion matrix of the transformer fault diagnosis results based on SMOTE and NGO-GBDT. \nThe blue diagonal line in the figure represents the number of correct predictions in the real samples, and the \nsum of each row of data is expressed as the total number of samples. Among the 174 test samples in Fig. 3, a total \nof seven fault samples were misjudged. The total accuracy of transformer fault diagnosis was 95.98%. Among \nthem, normal and medium–low temperature exothermic samples were correctly identified. Among them, the \nmisjudgment rates for high-temperature exothermic, low-energy discharge and partial discharge samples are \nonly 7.40%, 7.40% and 3.45%, indicating that the model proposed in the article has good stability. Based on the \nFigure 2.  The number of feature subsets corresponds to the average diagnostic accuracy of the model.\nTable 5.  Distribution of the sample data.\nStatus type Training set Test set Verification set\nN 89 29 29\nD2 89 29 29\nT1&T2 89 29 29\nT2 89 29 29\nPD 89 29 29\nD1 89 29 29\nTable 6.  Hyperparameter optimization range setting.\nHyperparameter name Optimization scope\nMax_depth (2,10)\nLearnning_rate (0.1,0.5)\nn_estimators (0,50)\n8\nVol:.(1234567890)Scientific Reports |         (2024) 14:7179  | https://doi.org/10.1038/s41598-024-57509-w\nwww.nature.com/scientificreports/\ninformation in the confusion matrix, the precision P , recall R and F1 values of the diagnostic model are 0.9598, \n0.9601 and 0.9599 respectively. The Kappa coefficient of the model is 0.9521, that is, the consistency between the \nmodel’s true classification and the predicted classification is almost completely consistent, indicating that The \nmodel proposed in this article has strong fault identification and classification capabilities.\nResults and discussion\nComparative analysis of different feature selection methods\nTo validate the efficacy of the proposed feature selection strategy, this paper employs four distinct approaches: \nRecursive Feature Elimination (RFE), XGBoost Feature Selection, RF Feature Optimization, and 19-dimensional \nfeature extraction as inputs for the NGO–GBDT model. The classification results are delineated in Fig.  4 and \nTable 7. It is apparent from Table  7 that, following the rigorous selection of features, the diagnostic precision \nand Kappa coefficient undergo significant enhancement across various degrees, while the duration of opera-\ntion diminishes. Among these methods, the LightGBM feature selection approach exhibits the most favorable \ndiagnostic performance compared to the others, thereby affirming the superiority of the LightGBM feature \nselection method.\nComparative analysis of sample equalization effects\nIn order to verify the effectiveness of the diagnostic model in processing unbalanced data, random oversam-\npling and ADASYN oversampling methods were used from the data processing level to compare the diagnostic \nresults with the original data set. The confusion matrix is shown in Fig. 5 , and the model evaluation indicators \nare shown in Table 8 shown. According to the diagnosis results, it can be seen that the original data set without \nbalance processing has insufficient training for minority class samples, resulting in high misjudgment rates for the \nthree types of minority class samples: high temperature overheating, partial discharge, and low energy discharge \nduring identification and diagnosis. After oversampling, the model diagnosis accuracy and Kappa coefficient \nhave been improved to varying degrees. After using SMOTE for data enhancement in this article, the diagnostic \naccuracy and comprehensive indicators of each type are better than other sampling methods, further validating \nthis article. The superiority of the proposed method in handling imbalanced data.\nComparative analysis of diagnostic effects of multiple models\nIn order to verify that the integrated learning method proposed in this article can effectively improve the accuracy \nof transformer fault identification, NGO-GBDT was compared with WOA-GBDT, GBDT, RF and DT, and the \nmodel classification effect was evaluated through multiple indicators. In order to make the model more convinc-\ning, the GA-XGBoost diagnostic model proposed in Ref. 36. and The PSO-BiLSTM diagnostic model proposed \nin Ref.37. The WOA-SVM diagnostic model proposed  in38 ensures that the input features are consistent. Table 9 \nshows the diagnostic results of different models.\nFrom the perspective of a single diagnostic model, GBDT has a better classification effect than RF and DT. \nAfter optimizing the hyperparameters of the GBDT model through the optimization algorithm, the model \ndiagnosis accuracy has been improved, indicating that the NGO optimization algorithm has strong optimization \ncapabilities. It can effectively improve model diagnosis performance. At the same time, comparing GA-XGBoost, \nPSO-BiLSTM and WOA-SVM with NGO-GBDT, the diagnostic accuracy increased by 1.68%, 2.32% and 3.66% \nrespectively. Based on the parameter analysis of recall rate, precision rate, F1 value and Kappa coefficient, it \nis shown that the model proposed in this article has better diagnostic effect than other models, verifying the \nsuperiority of the NGO-GBDT model.\nFigure 3.  Test set sample confusion matrix.\n9\nVol.:(0123456789)Scientific Reports |         (2024) 14:7179  | https://doi.org/10.1038/s41598-024-57509-w\nwww.nature.com/scientificreports/\nConclusion\nIn response to the issue of misjudgment of minority samples caused by imbalanced transformer fault samples, \nthis paper proposes a transformer fault diagnosis method based on SMOTE and NGO-GBDT based on data \noversampling and ensemble learning algorithm models. The following conclusions are drawn from actual data:\n(1)  By using the LightGBM feature selection method to select the optimal feature subset, redundant informa-\ntion can be avoided and the accuracy of transformer fault identification can be effectively improved.\n(2) This article deals with imbalanced fault samples from the data processing level, and solves the problem of \nlow diagnostic accuracy caused by insufficient and imbalanced sample data through the SMOTE oversam-\npling method, reducing the misdiagnosis rate of the diagnostic model.\n(a) (b)\n(c) (d) \nFigure 4.  Comparison of diagnostic results of different feature optimization methods. (a) Recursive feature \nelimination, (b) RF feature selection, (c) XGBoost feature selection, (d) 19 dimensional joint features.\nTable 7.  The Kappa coefficient of different features was selected for comparison.\nFeature subset type Kappa coefficient Calculation time (s)\nLightGBM feature selection 0.9521 0.257\nRFE 0.9183 0.486\nRF feature selection 0.9000 0.512\nXGBoost feature selection 0.9850 0.663\n19 dimensional features 0.8652 1.075\n10\nVol:.(1234567890)Scientific Reports |         (2024) 14:7179  | https://doi.org/10.1038/s41598-024-57509-w\nwww.nature.com/scientificreports/\n(3) Compared with other ensemble learning models, this article constructs an NGO–GBDT transformer fault \ndiagnosis model with high diagnostic accuracy, and further verifies the superiority of the proposed method \nthrough evaluation indicators such as accuracy, recall, F1 value, etc.\nIn summary, the strategy proposed in this paper enables the online diagnosis of electrical transformers, \naugmenting the operational efficiency of transformer management; to some extent, addressing the scarcity and \nimbalance of fault sample occurrence during actual operation. Y et, in the selection of K near-neighbors for the \nsynthesis of new samples, this approach possesses a certain degree of blindness, subject to interference from \nnoisy samples, and lacks clarity regarding the boundary between samples, hindering the model’s diagnostic \ncapabilities. The text insufficiently delves into the study of dissolved gases in oil, neglecting the impact of two \ndistinctive gases—CO and  CO2—on transformer faults. Further research is imperative to thoroughly analyze \nand enhance these issues.\n(a) (b) \n(c)\nFigure 5.  Comparison of sample equalized diagnosis (a) ADASYN oversampling, (b) random oversampling, \n(c) imbalanced dataset.\nTable 8.  Comparison of diagnostic results under different sampling methods.\nData sampling method Accuracy Kappa coefficient\nADASYN oversampling 94.83% 0.9386\nRandom oversampling 93.68% 0.9251\nImbalanced dataset 86.21% 0.8360\n11\nVol.:(0123456789)Scientific Reports |         (2024) 14:7179  | https://doi.org/10.1038/s41598-024-57509-w\nwww.nature.com/scientificreports/\nData availability\nThe datasets generated and/or analysed during the current study are not publicly available due [The data set is a \ncompany secret] but are available from the corresponding author on reasonable request. E-mail:xhaiqi0526@163.\ncom.\nReceived: 9 November 2023; Accepted: 19 March 2024\nReferences\n 1. Rajesh, K. N. et al. Influence of data balancing on transformer DGA fault classification with machine learning algorithms. IEEE \nTrans. Dielectr. Electr. Insul. 30(1), 385–392 (2022).\n 2. IEC. Mineral Oil-Impregnated Electrical Equipment in Service-Guide to the Interpretation of Dissolved and Free Gases Analysis: IEC \n60599-2007 [S]. (IEC, 2007)\n 3. Hechifa, A. et al. Improved intelligent methods for power transformer fault diagnosis based on tree ensemble learning and multiple \nfeature vector analysis. Electr. Eng. https:// doi. org/ 10. 1007/ s00202- 023- 02084-y (2023).\n 4. Hechifa, A. et al. The effect of source data on graphical pentagons DGA methods for detecting incipient faults in power transform-\ners. In 2023 International Conference on Decision Aid Sciences and Applications (DASA) (eds Hechifa, A., Lakehal, A., Labiod, C. \net al.) 152–157 (IEEE, 2023).\n 5. DGA Guide Working Group. IEEE Guide for the Interpretation of Gases Generated in Oil-Immersed Transformers: IEEE Std C57.104-\n2008 [S]. (IEEE, 2009)\n 6. Dhiman, A., Rahi, O. P . & Sharma, N. Fuzzy logic-based incipient fault detection in power transformers using IEC Method. In 2023 \nSecond International Conference on Electrical, Electronics, Information and Communication Technologies (ICEEICT) (eds Dhiman, \nA. et al.) 01–05 (IEEE, 2023).\n 7. Zhang, Y . W . Transformer fault diagnosis based on fuzzy rogers 4 ratio method. Electr. Eng. 546(12), 89–92 (2021).\n 8. Zhang, K. et al. Fault diagnosis of transformer based on cloud model and improved D⁃ S evidence theory. High Volt. Appartus.  \n58(4), 196–204 (2022).\n 9. Zhao, B. et al. Filter-wrapper combined feature selection and adaboost-weighted broad learning system for transformer fault \ndiagnosis under imbalanced samples. Neurocomputing 560, 126803 (2023).\n 10. Li, H. J. et al. Transformer fault diagnosis model based on particle swarm optimization and random forest. J. Kunming Univ. Sci. \nTechnol. 46(3), 94–101 (2021).\n 11. Wu, Y . et al. A transformer fault diagnosis method based on hybrid improved grey wolf optimization and least squares-support \nvector machine. IET Gen. Transm. Dis. 16(10), 1950–1963 (2023).\n 12. Tan, X. et al. A novel two-stage dissolved gas analysis fault diagnosis system based semi-supervised learning. High Volt.  7(4), \n676–691 (2022).\n 13. Zhang, Q. Z. et al. Improved GWO-MCSVM algorithm based on nonlinear convergence factor and tent chaotic mapping and its \napplication in transformer condition assessment. Electr. Power Syst. Res. 224, 109754 (2023).\n 14. Thomas, J. B. et al. CNN-based transformer model for fault detection in power system networks. IEEE Trans. Instrum. Meas. 72, \n1–10 (2023).\n 15. Li, C. et al. Convolutional neural network-based transformer fault diagnosis using vibration signals. Sensors 23(10), 4781 (2023).\n 16. Raj, R. A. et al. Key gases in transformer oil–An analysis using self organizing map (SOM) neural networks. In 2023 IEEE 12th \nInternational Conference on Communication Systems and Network Technologies (CSNT) (eds Raj, R. A., Sarathkumar, D., Andrews, \nL. J. B. et al.) 642–647 (IEEE, 2023).\n 17. Xing, Z. & He, Y . Multi-modal information analysis for fault diagnosis with time-series data from power transformer. Int. J. Electr. \nPower 144, 108567 (2023).\n 18. Zhang, Z. et al. Attention gate guided multiscale recursive fusion strategy for deep neural network-based fault diagnosis. Eng. Appl. \nArtif. Intell. 126, 107052 (2023).\n 19. Bai, X. et al. Transformer fault diagnosis method based on two-dimensional cloud model under the condition of defective data. \nElectr. Eng. 106(1), 1–13 (2023).\n 20. Mian, Z. et al. A literature review of fault diagnosis based on ensemble learning [J]. Eng. Appl. Artif. Intel. 127, 107357 (2024).\n 21. Pan, R. et al. State of health estimation for lithium-ion batteries based on two-stage features extraction and gradient boosting \ndecision tree. Energy 285, 129460 (2023).\n 22. Ren, Z. et al. A systematic review on imbalanced learning methods in intelligent fault diagnosis. IEEE Trans. Instrum. Meas. 72, \n1–35 (2023).\n 23. Wang, L., Littler, T. & Liu, X. Hybrid AI model for power transformer assessment using imbalanced DGA datasets. IET Renew. \nPower Gen. 17(8), 1912–1922 (2023).\n 24. Cai, Q. et al. Malfunction diagnosis of main station of power metering system using LSTM-ResNet with SMOTE method. J. Comput. \nMethods Sci Eng. 23(5), 2621–2633 (2023).\n 25. Ezziane, H. et al. A novel method to identification type, location, and extent of transformer winding faults based on FRA and \nSMOTE-SVM. Russ. J. Nondestruct. 58(5), 391–404 (2022).\nTable 9.  Model comparison analysis results.\nModel name Precision Recall F1 value Kappa coefficient Accuracy (%)\nNGO-GBDT 0.9598 0.9601 0.9599 0.9521 95.98\nGA-XGBoost 0.9427 0.9440 0.9433 0.9417 94.30\nPSO-BiLSTM 0.9372 0.9352 0.9347 0.9352 93.66\nWOA-SVM 0.9298 0.9308 0.9304 0.9288 92.32\nWOA-GBDT 0.9540 0.9573 0.9556 0.9453 94.53\nGBDT 0.9425 0.9425 0.9425 0.9318 93.18\nRF 0.9253 0.9269 0.9261 0.9117 91.17\nDT 0.9138 0.9193 0.9165 0.8983 89.83\n12\nVol:.(1234567890)Scientific Reports |         (2024) 14:7179  | https://doi.org/10.1038/s41598-024-57509-w\nwww.nature.com/scientificreports/\n 26. Luo, Y . C. Y . L. et al. Improved GWO-SVM transformer fault diagnosis method based on borderline-SMOTE-IHT mixed sampling. \nSmart Power 51(07), 108–114 (2023).\n 27. Wang, Y . H. et al. Transformer fault diagnosis method. Inf. Control 52, 235–244 (2023).\n 28. Jia, Z. et al. A fault diagnosis strategy for analog circuits with limited samples based on the combination of the transformer and \ngenerative models. Sensors 23(22), 9125 (2023).\n 29. Zhang, L. et al. An adaptive fault diagnosis method of power transformers based on combining oversampling and cost-sensitive \nlearning. IET Smart Grid 4(6), 623–635 (2021).\n 30. Yu, T. et al. A survey of ensemble learning for complex heterogeneous data. Control Eng. China 30(08), 1425–1435 (2023).\n 31. Wu, Z. et al. Imbalanced bearing fault diagnosis under variant working conditions using cost-sensitive deep domain adaptation \nnetwork. Expert Syst. Appl. 193, 116459 (2022).\n 32. Ranran, L. I. et al. Auxiliary generative mutual adversarial networks for class-imbalanced fault diagnosis under small samples. \nChin. J. Aeronaut. 36(9), 464–478 (2023).\n 33. Duan, F . et al. An oversampling method of unbalanced data for mechanical fault diagnosis based on MeanRadius-SMOTE. Sensors \n22(14), 5166 (2022).\n 34. Xu, X. et al. A method based on NGO-HKELM for the autonomous diagnosis of semiconductor power switch open-circuit faults \nin three-phase grid-connected photovoltaic inverters. Sustainability 15(12), 9588 (2023).\n 35. Meng, Y . et al. Multi-branch AC arc fault detection based on ICEEMDAN and LightGBM algorithm. Electr. Power Syst. Res. 220, \n109286 (2023).\n 36. Zhang, Y . W . et al. Fault diagnosis method for oil-immersed transformer based on XGBoost optimized by genetic algorithm. Electr. \nPower Autom. Equip. 41(02), 200–206 (2021).\n 37. Fan, Q. C., Yu, F . & Xuan, M. Power transformer fault diagnosis based on optimized Bi-LSTM model. Comput. Simul.  39(11), \n136–140 (2022).\n 38. An, G. Q. et al. Fault diagnosis of WOA–SVM transformer based on RF feature optimization. High Volt. Apparatus 58(02), 171–178 \n(2022).\nAcknowledgements\nProject supported by Jilin Provincial Science and Technology Development Plan Project under Grant \n(20220508014RC).\nAuthor contributions\nLizhong Wang, Jianfei Chi and Haiqi Y ang designed the experiments and contributed reagents/materials/analysis \ntools; Y eqiang Ding, Haiyan Y ao and Qiang Guo analyzed the data; Haiqi Y ang wrote the paper.\nCompeting interests \nThe authors declare no competing interests.\nAdditional information\nCorrespondence and requests for materials should be addressed to H.Y .\nReprints and permissions information is available at www.nature.com/reprints.\nPublisher’s note Springer Nature remains neutral with regard to jurisdictional claims in published maps and \ninstitutional affiliations.\nOpen Access  This article is licensed under a Creative Commons Attribution 4.0 International \nLicense, which permits use, sharing, adaptation, distribution and reproduction in any medium or \nformat, as long as you give appropriate credit to the original author(s) and the source, provide a link to the \nCreative Commons licence, and indicate if changes were made. The images or other third party material in this \narticle are included in the article’s Creative Commons licence, unless indicated otherwise in a credit line to the \nmaterial. If material is not included in the article’s Creative Commons licence and your intended use is not \npermitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from \nthe copyright holder. To view a copy of this licence, visit http:// creat iveco mmons. org/ licen ses/ by/4. 0/.\n© The Author(s) 2024",
  "topic": "Computer science",
  "concepts": [
    {
      "name": "Computer science",
      "score": 0.7271423935890198
    },
    {
      "name": "Transformer",
      "score": 0.6525394320487976
    },
    {
      "name": "Boosting (machine learning)",
      "score": 0.49925756454467773
    },
    {
      "name": "Artificial intelligence",
      "score": 0.49578794836997986
    },
    {
      "name": "Data mining",
      "score": 0.483323335647583
    },
    {
      "name": "Pattern recognition (psychology)",
      "score": 0.48129287362098694
    },
    {
      "name": "Decision tree",
      "score": 0.425345778465271
    },
    {
      "name": "Machine learning",
      "score": 0.3718986213207245
    },
    {
      "name": "Engineering",
      "score": 0.11079570651054382
    },
    {
      "name": "Voltage",
      "score": 0.0
    },
    {
      "name": "Electrical engineering",
      "score": 0.0
    }
  ],
  "institutions": [
    {
      "id": "https://openalex.org/I4210126065",
      "name": "Shanghai Electric (China)",
      "country": "CN"
    },
    {
      "id": "https://openalex.org/I179060312",
      "name": "Northeast Electric Power University",
      "country": "CN"
    }
  ]
}