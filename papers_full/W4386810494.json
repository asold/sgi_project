{
    "title": "Evaluation of large language models for discovery of gene set function",
    "url": "https://openalex.org/W4386810494",
    "year": 2023,
    "authors": [
        {
            "id": "https://openalex.org/A2119942814",
            "name": "Dexter Pratt",
            "affiliations": [
                "University of California, San Diego"
            ]
        },
        {
            "id": "https://openalex.org/A3128387818",
            "name": "Mengzhou Hu",
            "affiliations": [
                "University of California, San Diego"
            ]
        },
        {
            "id": "https://openalex.org/A2740448420",
            "name": "Sahar Alkhairy",
            "affiliations": [
                "University of California, San Diego"
            ]
        },
        {
            "id": "https://openalex.org/A2145748982",
            "name": "Ingoo Lee",
            "affiliations": [
                "University of California, San Diego"
            ]
        },
        {
            "id": "https://openalex.org/A2660302768",
            "name": "Rudolf Pillich",
            "affiliations": [
                "University of California, San Diego"
            ]
        },
        {
            "id": null,
            "name": "Robin Bachelder",
            "affiliations": [
                "University of California, San Diego"
            ]
        },
        {
            "id": "https://openalex.org/A2000084066",
            "name": "Trey Ideker",
            "affiliations": [
                "University of California, San Diego"
            ]
        }
    ],
    "references": [
        "https://openalex.org/W2158076892",
        "https://openalex.org/W6669115984",
        "https://openalex.org/W7075690393",
        "https://openalex.org/W3154538502",
        "https://openalex.org/W6748339906",
        "https://openalex.org/W6783132813",
        "https://openalex.org/W2058462745",
        "https://openalex.org/W6838924236",
        "https://openalex.org/W2732346161",
        "https://openalex.org/W6774493174",
        "https://openalex.org/W6803807601",
        "https://openalex.org/W2608199730",
        "https://openalex.org/W6808258512",
        "https://openalex.org/W6849997723",
        "https://openalex.org/W6775168056",
        "https://openalex.org/W6838702163",
        "https://openalex.org/W2139703939",
        "https://openalex.org/W2049527386",
        "https://openalex.org/W2130410032",
        "https://openalex.org/W1997921822",
        "https://openalex.org/W6675471023",
        "https://openalex.org/W2047291244",
        "https://openalex.org/W6647548779",
        "https://openalex.org/W6813094581",
        "https://openalex.org/W2164298117",
        "https://openalex.org/W6653069523",
        "https://openalex.org/W4323353510",
        "https://openalex.org/W2894795605",
        "https://openalex.org/W7074137041",
        "https://openalex.org/W3204152948",
        "https://openalex.org/W4286489052",
        "https://openalex.org/W2528958085",
        "https://openalex.org/W4224308101",
        "https://openalex.org/W2214074259",
        "https://openalex.org/W4283706018",
        "https://openalex.org/W3212303755",
        "https://openalex.org/W2074353056",
        "https://openalex.org/W4323036511",
        "https://openalex.org/W4320012061",
        "https://openalex.org/W4372279899",
        "https://openalex.org/W2113142309",
        "https://openalex.org/W3138300258",
        "https://openalex.org/W1998767819",
        "https://openalex.org/W2159482845",
        "https://openalex.org/W2102992354",
        "https://openalex.org/W2155852899",
        "https://openalex.org/W4367189299",
        "https://openalex.org/W3164540570",
        "https://openalex.org/W2103017472",
        "https://openalex.org/W4308616307",
        "https://openalex.org/W2070050178",
        "https://openalex.org/W2041816353",
        "https://openalex.org/W4309944312",
        "https://openalex.org/W1984991076",
        "https://openalex.org/W2158217645",
        "https://openalex.org/W2895456557",
        "https://openalex.org/W2103318667",
        "https://openalex.org/W4210765383",
        "https://openalex.org/W4292779060",
        "https://openalex.org/W2938704169",
        "https://openalex.org/W2098967508",
        "https://openalex.org/W4210567659",
        "https://openalex.org/W2121824548",
        "https://openalex.org/W4237335579",
        "https://openalex.org/W3011794626",
        "https://openalex.org/W4353112996",
        "https://openalex.org/W4307432965",
        "https://openalex.org/W4281249394",
        "https://openalex.org/W4320165837",
        "https://openalex.org/W4385245566",
        "https://openalex.org/W4361866031",
        "https://openalex.org/W3007516256",
        "https://openalex.org/W2945883683",
        "https://openalex.org/W4392619039",
        "https://openalex.org/W1989277387",
        "https://openalex.org/W4231254854",
        "https://openalex.org/W3165111266",
        "https://openalex.org/W2905102681",
        "https://openalex.org/W2969718750",
        "https://openalex.org/W4304195432",
        "https://openalex.org/W1969056720",
        "https://openalex.org/W4307425304",
        "https://openalex.org/W3083662059",
        "https://openalex.org/W4221143046",
        "https://openalex.org/W2885735890",
        "https://openalex.org/W2786755330",
        "https://openalex.org/W2026656222",
        "https://openalex.org/W2931036699",
        "https://openalex.org/W2129563923",
        "https://openalex.org/W4233698560",
        "https://openalex.org/W2110183893",
        "https://openalex.org/W2941211633",
        "https://openalex.org/W2118258530",
        "https://openalex.org/W2010502047",
        "https://openalex.org/W2315171359"
    ],
    "abstract": null,
    "full_text": "Evaluation of large language models for discovery\nof gene set function\nDexter Pratt \nUniversity of California, San Diego https://orcid.org/0000-0002-1471-9513\nMengzhou Hu \nUniversity of California San Diego https://orcid.org/0000-0002-1571-8029\nSahar Alkhairy \nUniversity of California, San Diego\nIngoo Lee \nUniversity of California, San Diego\nRudolf Pillich \nUniversity of California, San Diego\nRobin Bachelder \nUniversity of California, San Diego https://orcid.org/0000-0001-7502-2907\nTrey Ideker \nUniversity of California, San Diego\nAnalysis\nKeywords:\nPosted Date: September 18th, 2023\nDOI: https://doi.org/10.21203/rs.3.rs-3270331/v1\nLicense:   This work is licensed under a Creative Commons Attribution 4.0 International License.  \nRead Full License\nAdditional Declarations: Yes there is potential Competing Interest. TI is a co-founder, member of the\nadvisory board, and has an equity interest in Data4Cure and Serinus Biosciences. TI is a consultant for\nand has an equity interest in Ideaya BioSciences and Light Horse Therapeutics. The terms of these\narrangements have been reviewed and approved by UC San Diego in accordance with its con\u0000ict of\ninterest policies.\nVersion of Record: A version of this preprint was published at Nature Methods on November 28th, 2024.\nSee the published version at https://doi.org/10.1038/s41592-024-02525-x.\nEvaluation of large language models for discovery of gene set function\nMengzhou Hu1†, Sahar Alkhairy2†, Ingoo Lee1, Rudolf T. Pillich1, Robin Bachelder1,\nTrey Ideker1,2*, and Dexter Pratt1*\n1Department of Medicine, University of California San Diego, La Jolla, California, USA\n2Department of Computer Science and Engineering, University of California San Diego, La Jolla,\nCalifornia, USA\n†These authors contributed equally\n*To whom correspondence should be addressed:\ntideker@health.ucsd.edu, depratt@health.ucsd.edu\nAbstract\nGene set analysis is a mainstay of functional genomics, but it relies on manually curated databases of\ngene functions that are incomplete and unaware of biological context. Here we evaluate the ability of\nOpenAI’s GPT-4, a Large Language Model (LLM), to develop hypotheses about common gene functions\nfrom its embedded biomedical knowledge. We created a GPT-4 pipeline to label gene sets with names\nthat summarize their consensus functions, substantiated by analysis text and citations. Benchmarking\nagainst named gene sets in the Gene Ontology, GPT-4 generated very similar names in 50% of cases,\nwhile in most remaining cases it recovered the name of a more general concept. In gene sets discovered\nin ‘omics data, GPT-4 names were more informative than gene s et enrichment, with supporting\nstatements and citations that largely verified in human review. The ability to rapidly synthesize common\ngene functions positions LLMs as valuable functional genomics assistants.\n2\nIntroduction\nA fundamental goal of the ‘omic sciences is to identify the sets of genes that are responsible for all of the\ndistinct biological functions of life, health and disease. In this vein, numerous mRNA expression\nexperiments over the past two decades have produced (and continue to produce) sets of genes that are\ndifferentially expressed across conditions or that cluster by expression similarity. Similarly, proteomics\nexperiments produce lists of proteins that are co-abundant, co-modified, or physically interacting; CRISPR\ngene knockout screens produce lists of genes required for fitness or a particular response, and so on. In\nall of these cases, the basic premise is that the identified genes work coherently towards the same\nbiological process or function.\nTo understand these functions, one turns to functional enrichment analysis. Among the numerous\napproaches that have been developed, some of the most widelyused are the hypergeometric statistic1–4\nand gene set enrichment analysis5–8 (GSEA). Such approaches seek to identify similarities between the\nidentified set of genes and those from a separate, pre-defined gene function database like the Gene\nOntology9,10 (GO) or Reactome 11–13, which annotate genes to known functional and pathway\ncategories12,14–18.\nParadoxically, a gene set for which there is a very strong enrichment in a gene function database may be\nof lesser interest, since the set and its function have already been well characterized by previous studies.\nOf greater interest are gene sets that fail functional enric hment or overlap known functions only\nmarginally, because it is precisely from these ‘failures’ that new biological findings emerge. In these\ncases, an immediate next step is to explore the biological literature, as well as complementary data sets,\nto learn as much as possible about the genes in question. The goal is to mine knowledge pertinent to\neach gene and then use this knowledge to synthesize mechanistic hypotheses for a function that might be\nheld in common by all or most genes in the set. As a result, new functional categories might be defined\nand added to existing collections of functions. This protracted process of discerning relevant findings from\ndata and literature, then reasoning on this information to synthesize functional hypotheses, has not yet\nbeen widely automated but is one of the central tasks performed by a genome scientist.\n3\nHighly relevant to these tasks is the recent advent of generative artificial intelligence (AI) models and\nspecifically Large Language Models (LLMs) such as GPT-419 and PaLM20, which are reshaping many\ndomains including computational biology. At its core, generative AI is an approach to machine learning in\nwhich a model is trained to recognize underlying patterns indata in a manner that allows it to generate\nnew data with similar properties as the training data. The underlying technology behind LLMs is the\ntransformer architecture21–23, which uses a self-attention mechanism to understand context and handle\nlong-range dependencies in text, delivering significant advancements in tasks such as text translation,\nsummarization, and generation. Large-scale training of ge neral-purpose LLMs such as GPT-4\nincorporates information from an enormous corpus of sources, including the biomedical literature.\nHere, we evaluate the degree to which LLMs provide insightful functional analyses of gene sets. First, we\ndevelop a gene set analysis pipeline based on queries to GPT-4, as of this writing one of the most\ncapable general LLMs available19. We then test the ability of this system to propose succinct names and\nanalysis paragraphs for gene sets of interest. In addition,we formulate a separate GPT-4-based method\nto orchestrate relevant literature search and to verify statements made in the primary analysis. Finally, we\ndiscuss our findings and their implications for the general use of LLMs in functional genomics\napplications.\nResults\nDevelopment of a GPT-4 functional genomics pipeline.We designed a pipeline in which the GPT-4\nmodel is instructed to formulate biologically descriptivenames and supporting analysis text for a gene set\n(Fig. 1a–b). A separate GPT-4-based system was implemented to validate statements made in the\nanalysis text with pertinent literature citations (Extended Data Fig. 1, Methods). The instruction to an\nLLM is called a “prompt” and can include data and examples to guide the response. Best practices for\nformulating this prompt are the subject of ongoing experimentation24–26, but in this study our prompt simply\ndescribed desired properties of the name and analysis to be generated, including guiding phrases such\n4\nas “For each important point, describe your reasoning and supporting information” (Fig. 1a, Extended\nData Fig. 1e).\nTo assess this gene set analysis pipeline, we implemented evaluation workflows that score the quality of\nnames given by GPT-4 and assess statements in the summary analysis text. Reference gene sets were\nderived from two primary sources. The first was literature curation, for which we evaluated sets of genes\ndrawn from Gene Ontology terms9,10 (Workflow 1;Fig. 1c). The second source was ‘omics analysis, for\nwhich we evaluated gene sets identified by (1) similarity inmRNA expression data27, and (2) modular\ncommunity detection in protein interaction networks28 (Workflow 2;Fig. 1d). In both the literature-curation\nand ‘omics-analysis workflows, GPT-4 performance for a gene set was measured by the semantic\nsimilarity of its proposed name to the name proposed by humanscientists. This performance measure,\n“semantic similarity,” uses a numerical score in the range [0–1] to approximately capture how similar two\nphrases are to each other in conceptual meaning within a language29 (see Online Methods). For\nexample, the word “socks'' is semantically closer to the word “shoes'' than it is to “airplane.”\nWorkflow 1: Benchmarking GPT-4 names against names assigned by GO.For the first workflow, we\nqueried GPT-4 to propose names and supporting analysis textfor 1000 human gene sets drawn randomly\nfrom terms in the Gene Ontology Biological Process branch (GO-BP, 2022-10-07 release, sampling terms\nfrom 3 to 500 genes; seeExtended Data Fig. 2). On average, it took about 70 seconds for the GPT-4\nmodel to process each gene set (Extended Data Table 1), after which time it returned a proposed\nconcise name and supporting analysis text. For example, the gene set annotated to GO term\n“Acute-Phase Response” (GO:0006953) resulted in GPT-4 proposing a nearly exact match, “Acute Phase\nResponse” (differing from the GO name only in omission of thehyphen). GPT-4 also generated eight\nparagraphs of supporting text describing the various lines of evidence for specific genes and their\ncommon functional roles (Table 1).\nTo quantify the accuracy of name generation, we then computed the semantic similarity between the\nGPT-4 proposed name and the name assigned by GO. These scoresranged from values as high as 1, in\n5\ncases where the GPT-4 name was an exact match to the GO name (e. g., “Mitochondrial tRNA\nModification”), to values below 0.2, in cases where the names were not intuitively similar (e.g., GPT-4:\n“Hedgehog Signaling Pathway” versus GO: “Positive Regulation of Protein Import Into Nucleus”) (Table 2\nand Supplementary Table 1). To calibrate this similarity, we ranked it against a background semantic\nsimilarity distribution, defined by comparing the GPT-4 name against all 12,214 term names documented\nin GO-BP ( Fig. 1c, see Online Methods). For example, the GPT-4 name (“DNA Repair and\nChromosome Segregation”) had a semantic similarity to the assigned GO name (“Regulation of Sister\nChromatid Cohesion”) of 0.46, a score that was higher than 95% of alignments between the GPT-4 name\nand every other term name in GO-BP (Fig. 2a). Using this scoring approach, we found that exactly half of\nthe gene set names proposed by GPT-4 were close matches to thecorresponding GO term names, with\nsemantic similarities ranking in the 98th percentile (500/1000;Fig. 2b).\nIn many other cases, we observed that GPT-4 had suggested a name matching a more general ancestor\nin the GO term hierarchy. For example, the gene set annotatedto the GO term “Triglyceride Catabolic\nProcess'' resulted in the GPT-4 name “Lipid Metabolism and Regulation\" with a semantic similarity of 0.47\nranking in the 96th percentile. The GPT-4 name matched most closely to the GO term “Lipid Metabolic\nProcess,” a less specific category higher in the ontology (Fig. 2c) and annotated by a larger set of genes\n(Fig. 2d). This observation was reinforced by a systematic analysisof the 500 queries for which GPT-4\nand GO names were less similar (bottom half by semantic similarity). In 47.2% of these cases, the best\nmatching GO name (i.e., that with the highest semantic similarity to the GPT-4 name) corresponded to a\ngene set representing a broader ancestral concept in the GO hierarchy. Moreover, across all 1000\nqueries, the GO terms with the best matching names to GPT-4 often had significant gene set intersection\nwith the actual gene set queries (862/1000 cases or 86.2%, q-value < 0.1, hypergeometric test coupled\nwith Benjamini-Hochberg correction; Fig. 2e). Thus, even when the GPT-4 name is semantically\ndissimilar to the actual name assigned by GO, it often matches another GO name annotated by a similar,\nsometimes broader, set of genes.\n6\nWorkflow 2: Benchmarking GPT-4 names for ‘omics gene sets. In workflow 2, we tested the\nperformance of GPT-4 in naming and analyzing 100 gene sets informed by ‘omics approaches. The first\n50 of these gene sets, drawn from MSigDB27, integrated information from clusters of coordinately\nexpressed genes identified in a broad collection of mRNA transcriptomic studies. Each gene set had been\nreviewed and named by a panel of human authors based on their p rior knowledge of biological\nprocesses. The second set of 50 gene sets was drawn from the NeST collection of cancer protein\ncomplexes, based on identifying communities of interactin g proteins in a large protein interaction\nnetwork28. Here also, the corresponding gene sets had been named by a panel of human experts.\nTogether, these resources included gene sets covering a range of sizes (5 to 323 genes per set;\nExtendedData Fig. 3and Supplementary Table 2).\nFor each gene set, we instructed GPT-4 to propose a name and a supporting analysis (Fig. 1b). For\nexample, for the protein interaction cluster NeST:34 “Histone Modification,” GPT-4 proposed the name\n“Epigenetic Regulation and DNA Repair” along with eight paragraphs of supporting text (Table 3). We\nthen compared the GPT-4 proposed name to the expert-determined name using semantic similarity (Fig.\n1d, seeOnline Methods). Comparisons over the 100 ‘omics gene sets produced similarity scores in the\nrange of approximately 0.2 to 1.0, with a median of 0.5 (Fig. 3a). To calibrate and assess these scores,\nwe repeated the evaluation but replaced GPT-4 with a standard gene set enrichment analysis (GSEA),\nusing the name of the most enriched GO term as the proposed name for the ‘omics gene set. In general,\nwe observed that the similarities between GPT-4-proposed names and expert-determined names were\nsignificantly higher than the similarities between GSEA-proposed names and expert-determined names (p\n= 1.2 10−2; Fig. 3a).×\nAssessment and validation of GPT-4 supporting analysis text. We next transitioned from analysis of\nGPT-4 naming to an examination of its supporting analysis text. We first noted that the fraction of genes\nmentioned in a supporting analysis spanned a very large range, from below 10% to 100% (‘omics gene\nsets; Fig. 3b). This fraction tended to be very high for the NeST protein interaction complexes in particular\n(median 91%). As a benchmark for comparison, we examined thefraction of gene set queries that were\n7\ncovered by the most-enriched GO terms from GSEA. Here, we found that this coverage was significantly\nlower than the fraction covered by GPT-4 analysis (p = 1.1 10−7; Fig. 3b). For example, GPT-4 presented×\narguments for the involvement of all 36 members of the gene set “Hedgehog Signaling” (GPT-4 name:\n“Neuronal Development and Axon Guidance”) while the best enriched GO term, “Nervous System\nDevelopment'' covered 11 of the 36 genes (31%;Fig. 3and Extended Data Table 2). Thus, GPT-4\nactively assembles a broad synthesis of biological statements that typically include mention of the\nmajority of genes in the set, without being limited to a predetermined gene set database.\nIn interpreting these results, an important concern with LL Ms is their documented tendency to\n“hallucinate,” i.e., generate plausible but unverifiableor nonfactual statements19. To gain insight into the\naccuracy of the analysis text, we performed a structured review process for 50 paragraphs drawn from\nthe analysis of 10 ‘omics gene sets (seeOnline Methods). For each paragraph, a human scientist\nattempted to verify each statement by a manual literature search. As a conservative criterion, we\nconsidered a paragraph “verified” if the reviewer found evidence for every statement. The reviewer also\nclassified the paragraph as to whether, in their judgment, one or more of its statements supported the\nargument for the proposed name. Verification of accuracy an d name support were evaluated\nindependently, i.e., supportive paragraphs could includeunverified statements. Of the 50 paragraphs\nevaluated, 39 were verified, and 44 were judged supportive (Supplementary Table 3). Examination of\nthe 11 unverifiable paragraphs revealed a variety of misleading statements of 2 major types, related to (a)\npossible miscategorization of gene functions or (b) assertion of unverified biophysical interactions. In one\ncase relevant to type (a), GPT-4 stated that “MMUT catalyzes the conversion of homocysteine to\nmethionine” when in fact, it breaks down methionine to succinyl-CoA. Relevant to type (b), GTP-4’s\nstatement “CDK5RAP1 also interacts with TRMT61B…” could no t be verified, although such an\ninteraction is plausible as both modify tRNA30,31. Thus, the verbose GPT-4 analysis paragraphs, with their\nmany statements covering a high percentage of genes in a query set, appear to be largely but not entirely\nverifiable by human examination of the literature.\n8\nIdentification and assessment of relevant citations.Given the need to verify statements in GPT-4’s\nanalysis text, we developed a separate GPT-4-based system to identify publications that provide evidence\nfor statements made in the analysis text (ExtendedData Fig. 1, seeOnline Methods). This system was\ntested on the corpus of GPT-4 analysis paragraphs generatedfrom the 100 ‘omics gene sets in Workflow\n2. We recorded an average of 77 seconds to find and evaluate references for a gene set, approximately 9\nseconds per paragraph (Extended Data Table 1). Out of 908 paragraphs, there were 187 for which the\ncitation module did not detect any gene symbols or recognizable functions (e.g., see paragraphs 1 and 8\nin Table 3). For nearly all remaining paragraphs (720/721), it returned at least one reference passing its\nevaluation criteria (seeOnline Methods).\nTo assess the relevance of these references, we performed a manual examination of selected citations\n(Supplementary Table 4) in which we required that the cited abstract must clearly and directly support\none or more statements in the corresponding GPT-4 analysis paragraph. We did not require that the\nabstract be primarily about the statement; it was sufficient that a supporting fact was present. Of the 50\ncitations examined, we found that in 40 cases, the abstract and/or title indeed provided evidence for\nstatements in the corresponding GPT-4 analysis paragraph.For example, the statements that GATA1\n“regulates the expression of genes involved in RBC development, such as HBB, HBD, and ALAS2” and\n“is crucial for the differentiation of erythroid progenitor cells into mature RBCs” were supported by Zhang\net al.32, \"Intron 1 GATA site enhances ALAS2 expression indispensably during erythroid differentiation.\"\nDiscussion\nThe evaluations performed here suggest that GPT-4 indeed has notable potential as an automated\nassistant for understanding gene function. In the analysisof gene sets from the Gene Ontology (GO),\nGPT-4 produced highly similar names in 50% of instances, andin the majority of other cases, its name\nmapped to a term with a similar gene set, often a broader concept in the hierarchy. For gene sets\nemerging from transcriptomic and proteomic analyses, GPT-4 suggested names that compared favorably\nto classical gene set enrichment. Its accompanying analysis paragraphs provided supporting statements\nthat were found to be largely factual, although its occasional generation of unverifiable statements (in\n9\napproximately 22% of analysis paragraphs in our tests) suggests it should be coupled to some type of\nfact-checking or reference validation, whether automatedor manual. In what follows, we discuss specific\nconsiderations related to computation time and scalability, comparison to classical gene set enrichment,\ninterpretation of mismatches between GPT-4 and GO, and limitations of the present assessment.\nRelative to humans, GPT-4 is very fast in synthesizing commonfunctions for gene sets.The time\nfor GPT-4 to name, analyze, and find references for a gene setwas variable depending on the service’s\nresponse time but typically in the range of two to four minutes (ExtendedData Table 1). By comparison,\nthe time required for a human scientist to produce a comparable analysis is far greater, easily on the\norder of hours to build a sufficient understanding of the biological functions relevant to a gene set.\nAlthough this time estimate varies greatly depending on theanalyst's experience, the size of the gene set,\nand the specific gene functions involved, it includes (at minimum) multiple rounds of literature search,\nreading, and hypothesis generation, followed by authorship of a page of coherent summary analysis text.\nInterpretation of large numbers of gene sets, such as those produced by transcriptomics or proteomics\n(the technologies exemplified in Workflow 2), requires a significant commitment of human resources. In\ncontrast, the detailed analysis of 100 gene sets performed in Workflow 2 was completed in roughly five\nhours.\nGPT-4 versus classical gene set enrichment: apples versus oranges. While GPT-4 may be fast\ncompared to human operators, it is slow compared to gene set e nrichment, which is based on\nstraightforward closed-form statistical equations requiring fractions of a second on a modern computer.\nThe type of analysis offered by GPT-4 is very different from classical gene set enrichment analysis,\nhowever. The goal of enrichment analysis is to identify the agreement of a gene set with those stored in\nreference databases. In contrast, GPT-4 predicts common functions for genes based on active reasoning\nover a large corpus of biomedical knowledge, producing results even in cases where the gene set does\nnot resemble any recorded in reference databases. Accompanying the proposed functions is a rationale,\ngiven in the form of a summary analysis with arguments that can be critiqued, and subsequently validated\nor rejected by human investigators.\n10\nOn the one hand, standard enrichment analysis could be said to be highly “transparent” because it uses\nwell-defined statistical methods and documented reference databases of gene sets that researchers can\nreview. In contrast, the knowledge accessed by the GPT-4 is n ot directly subject to definition or\ninspection, as it is embedded in the latent space of the model, and the mathematical calculation behind a\ngiven output is practically opaque. On the other hand, thereis another sense in which an LLM analysis is\nextremely transparent because it presents ade novonarrative of facts and reasoning that considers all of\nthe genes of interest, assisted by reference citation toolssuch as the one developed in this study.\nUltimately, how an analysis was performed may be less relevant if the output is useful and its statements\nare supported by reasoned arguments and verifiable literature citations. Indeed, these are the criteria we\napply to analyses produced by human researchers; we can see their output but not the operation of their\nminds.\nMismatch of GPT-4 and GO names for gene sets: bug or feature?For GO gene sets in which GPT-4\nnames were approximate matches to the names given by GO curators but conceptually more general (as\nmany as one-fourth of queries we examined;Fig. 2c–e), it is possible this behavior should be called a\nGPT-4 failure mode. However, in detailed examinations of some of these instances, it remains unclear to\nus whether the GPT-4 name tends to be overly general or the GO name overly specific. In addition to the\nexamples detailed above in our Results, consider the set of 36 genes annotated to GO:0048536: Spleen\ndevelopment, named “Regulation of cell cycle and apoptosis” by GPT-4 (Supplementary Table 1). We\nfound that the majority of genes in this set, such as CDKN2B, BCL2L11, and ABL1, play established roles\nin cell cycle, apoptosis, and other processes with functions well outside of a specific organ system like the\nspleen33–35. In evaluating the choice of a broader rather than more specific name for such gene sets, we\nfound the GPT-4 analysis paragraphs to be quite useful as a starting point for subsequent critical\nevaluation by human investigators. In comparison, it is notimmediately clear how to access the rationale\nused by the GO curators in naming a GO term, although some of this information can be reconstructed\nindirectly by tracing the evidence codes and citations of each gene annotation.\n11\nLimitations of this study.It is important to stress that our evaluation of the GPT-4 model was based on\nsingle queries using prompts developed by informal experimentation. Further research should investigate\nmore sophisticated prompting strategies such as “chain of thought”36 for gene set analyses and the use of\nmethods that apply external tools and orchestrate multiple LLM interactions37–43, such as integrating\nliterature searches into the LLM analysis rather than as a post hoc verification method. Our study also\nmakes the implicit assumption that all gene sets emerging from a biological study have a coherent\nfunction to be summarized. What about gene sets that emerge erroneously from an ‘omics screen and\nare not functionally coherent, i.e., a type of false positive? One could imagine first asking the LLM to\ndecide if the gene set has a common function and, even if the evidence is in favor, ask whether there are\nnon-coherent genes that should be removed from the set or, alternatively, functionally similar genes that\nare missing and might be added. Finally, a critical consideration not yet addressed by our work is that\ngene functions are typically not universal but are specific to experimental conditions and biological\ncontexts. Our study has not attempted to prompt LLMs with thecontexts in which the gene set was\ndiscovered, information that might emerge as highly valuab le to the quality of the analysis. Such\nknowledge is also absent from gene set functional enrichment tools, since their pre-existing mapping of\ngene sets to functions cannot encode the practically infinite space of biological conditions.\nConclusions. When applied to study gene function, one might have suspected that LLMs might produce\nstatements, hypotheses, and references that hallucinate so uncontrollably as to be unusable. In fact, in\nour evaluations, GPT-4 typically did not, showing reasonable and often exemplary performance over a\nseries of complementary benchmarks. We thus conclude that,given appropriate framing, the current\ngeneral platform provides researchers with a new and powerful tool for gene set interpretation.\n12\nOnlineMethods\nChoosing the large language model.We used the ‘gpt-4-0314’ version of the OpenAI GPT-4 large\nlanguage model for naming and analyzing gene sets, as a state-of-the-art model accessible using a\nwell-defined API. GPT-4 has been reported to exhibit enhanced “steerability” over the earlier GPT–3\nmodels19, meaning it can better infer a user's intentions without extensive prompt tuning.\nControllingthe variability of GPT-4 responses.The OpenAI API enables queries to set a “temperature”\nparameter that controls the variability of the generated response, with lower temperatures producing more\nreproducible and reliable responses44,45. Exploring the effect of temperature on GPT-4 analyses is outside\nthe scope of this study, and therefore our queries used the lowest, most conservative/reproducible,\ntemperature value = 0.0. In a manual inspection of repeated queries at temperature 0.0, we found that\nGPT-4 names and analyses were conceptually equivalent, butthe specific text could vary, from near\nidentity to considerable differences in phrasing. Additio nally, we made our manual review process\nmanageable by forcing the responses to be concise. For this purpose, we set the maximum number of\ntokens (roughly corresponding to words) in each response tobe 1,000.\nCalculation of semantic similarity. Semantic similarity between names was determined using the\nSapBERT model46. SapBERT produces embeddings of each name and then computes the cosine\nsimilarity between the embeddings, yielding a similarity score ranging from 0 (no similarity) to 1 (identical).\nSapBERT is a domain-specific language representation model that has been pre-trained on large-scale\nbiomedical data, including Unified Medical Language System (UMLS), a massive collection of biomedical\nontologies with 4M+ concepts. Since models like BERT are trained on vast amounts of textual data, they\ncan learn general patterns and relationships and also capture context by considering surrounding words,\nproviding a measure of similarity based on semantics rather than lexical matching. Although both\nSapBERT and GPT-4 are LLMs, they are two separate models with different purposes, model\narchitecture, and training objectives and data. However, to address potential concerns that one language\nmodel was used in evaluating another, we performed the following test. For each ‘omics gene set in\nworkflow 2, a panel of three humans conducted an independentand blinded evaluation of whether the\n13\nGPT-4 determined name, or the most enriched GSEA term name, best matched the expert-determined\nname assigned in the MSigDB or NeST publications27,28. In 75/100 (75%) of these gene sets, the\nconsensus of the independent panel matched the result of Sap BERT semantic similarity testing\n(Extended Data Table 3). When SapBERT and the human panel disagreed, the disagreements were not\nsignificantly biased in favor of GPT-4 or GSEA (p = 0.21, binomial test).\nCalibrating the similarity between GPT-4 names and GO names.To evaluate the performance of the\nGPT-4 model in recapitulating GO names, we computed the semantic similarity between the GPT-4 name\nand the assigned name of the GO term query, using SapBERT as described above. We then performed\nthis semantic similarity calculation for the same GPT-4 name against every other GO term name in the\nBiological Process branch (GO-BP), yielding a background distribution of semantic similarity scores. The\nactual and background similarities were then concatenatedinto a single list, sorted in descending order\n(largest to smallest), and the rank of the actual similaritywas recorded and expressed as a percentile.\nThis percentile score is thus the percentage of GO-BP term names that are less similar to the GPT-4\nname than to the assigned name of the GO term query.\nObtaining top enrichedGOterms for the ‘omics gene sets.We used GSEA to obtain the top enriched\nGO term for gene sets using the “gp.enrichr” function from GSEAPY package47 with the parameter\nsettings {gene_sets = 'GO_Biological_Process_2023', organism='human'}. The best-matching GO term\nwas selected based on the adjusted p-value and treated as theproposed GO name for the predominant\nbiological process of the gene set.\nIdentification and validation of relevant references (citation module).The process of identifying and\nevaluating references for a given gene set involved severalsteps (ExtendedData Fig. 1a–d). Firstly, we\nengineered a GPT-4 prompt to request two types of keywords from each analysis paragraph (as had been\ngenerated by an earlier GPT-4 query): (1) gene symbols explicitly mentioned in the paragraph and (2) up\nto three keywords associated with gene functions or biological processes, ordered by their importance.\nThe prompt also gave the instruction that paragraphs shouldbe skipped if they did not yield at least one\n14\ngene symbol and one functional keyword and that the model should yield ‘unknown’ in those cases. The\nprompt to extract gene function keywords incorporated an example paragraph and corresponding answer\nas a guide. Following identification of gene symbols and function keywords, these were assembled in a\nseries of logical query expressions, one per function, in which all gene symbols were combined using the\n'OR' operator and linked with a function keyword by 'AND' (Extended Data Fig. 1b). The search then\niterated over the query expressions, querying PubMed via its web API to find scientific publications in\nwhich the title or abstract matched the query expression, sorted by relevance (Extended Data Fig. 1c).\nThe search process terminated when all query expressions were tried. Upon finding a match, the abstract\nof the relevant publication was extracted and provided to the GPT-4 model. This model was asked to\nassess whether the abstract agreed with one or more statements in the analysis paragraph (Extended\nData Fig. 1d). A maximum of three references were returned per paragraph.\nReviewer fact-checking of GPT-4 analysis text.We performed a structured review of 50 paragraphs\nselected randomly from GPT-4 generated analysis text, gathered in a scoring table (Supplementary\nTable 3). In this analysis, a reviewer recorded scores for each paragraph based on two Boolean criteria,\n“Verified” and “Supporting,” in corresponding columns. Citations and other literature evidence were\nrecorded in an “Evidence” column. The scoring rubric was as follows:\n● Verified: Are all statements in the paragraph verified by literature review?\na. Verified paragraphs were scored as “1”, otherwise “0”.\nb. Simple per-gene statements were checked against information from NCBI Gene content\nmaintained by the National Library of Medicine, http://www.ncbi.nlm.nih.gov.\ni. For example, “Oxytocin (OXT) is a neuropeptide hormone th at binds to its\nreceptor, oxytocin receptor (OXTR).” can be quickly verified by the NCBI Gene\nentries for the two genes.\nii. If the NCBI entry verified one or more statements, the URL for the entry was\nadded to the Evidence column, e.g., “NLM: OXT\nhttp://www.ncbi.nlm.nih.gov/gene/5020”\n15\nc. For statements not verified by NCBI Gene, the reviewer sea rched PubMed for\npublications to provide evidence for the statement.\nd. Search strategies included:\ni. Search using gene-keyword pairs, such as “TP53 cell cycle”.\nii. For paragraphs that discuss multiple genes, search for r eview articles with\nphrases such as “acute phase response proteins.”\niii. Search for family member proteins together, such as “TAS2Rs bitter taste”.\ne. If no evidence for a statement could be found within roughly ten minutes of searching,\nthis was noted in the Evidence column.\n● Supportive: In the reviewer's judgment, do any of the statements in the paragraph support the\ngene set name proposed by GPT-4?\na. Paragraphs judged supportive were scored as “1”, otherwise “0”.\nb. Supportive paragraphs could include unverified statements.\nData availability\nPublicly available gene sets were used in this study. Gene Ontology (2022-10-07 release) is available at\nhttp://release.geneontology.org/2022-10-07/ontology/index.html. MSigDB can be found here:\nhttps://www.gsea-msigdb.org/gsea/msigdb and the selected NeST gene set is available to download from\nhttps://github.com/idekerlab/llm_evaluation_for_gene_set_interpretation/blob/main/data/NeST_table.txt.\nCode availability\nThe pipeline for running the gene set interpretation and cit ation search is available at\nhttps://github.com/idekerlab/llm_evaluation_for_gene_set_interpretation, along with the code for running\nthe evaluation.\n16\nFigures and Tables\nFig. 1. Use and evaluation of GPT-4 for functional analysis of gene sets. a, The prompt provided to\nGPT-4 for its input fields “System” and “User.” The specificlist of genes is inserted into the {gene_set}\nfield at the end of the prompt template.b, Generation of a proposed name for a gene set, with an\naccompanying analysis, using GPT-4.c, Benchmarking against GO gene sets: Calculation of semantic\nsimilarity between the GPT-4 proposed name and the name assigned by the GO curators (Left yellow\nstar). Calibration of this similarity against the distribution of semantic similarities between the GPT-4 name\nand every term name in GO-BP.d, Benchmarking against ‘omics gene sets (MSigDB hallmark gene sets,\nNeST cancer systems): Computation of semantic similarity between the GPT-4 proposed name and the\nname curated by human experts (Right yellow star). Additional comparison to the name assigned by\nclassical gene set enrichment analysis (GSEA).\n17\n\nFig. 2. Evaluationof GPT-4 inrecovery of GOterm names. a, The raw semantic similarity between the\nGPT-4 name and the assigned GO name (blue dashed line, x-axis) is converted to the percentage of all\nnames in the GO database with lower similarity to the GPT-4 name (blue dashed line, y-axis). Plot shown\nis for the GPT-4 name “DNA Repair and Chromosome Segregation ”, generated for the GO term\n“Regulation of Sister Chromatid Cohesion.” b, Cumulative number of GO term names recovered by\nGPT-4 (y-axis) at a given similarity percentile (x-axis). 0= least similar, 100 = most similar. Blue curve:\nsemantic similarities between GPT-4 names and assigned GO term names. Grey dashed curve: semantic\nsimilarities between GPT-4 names and random GO term names. The red dotted line marks that half of the\n1000 sampled GO names are recovered by GPT-4 at a similarity percentile of 98%.c, Hierarchical view of\nthe GO term “Triglyceride Catabolic Process” and its ancestors. Blue box: gene set query, yellow box:\ngene set of best match GO name (most similar GO name to GPT-4 name), dashed lines with arrows:\nsemantic similarities between names, red text: GPT-4 proposed name.d, Venn diagram showing overlap\nbetween the gene set query (blue, LEFT) and gene set of best match GO name (yellow, RIGHT). The\nfalse discovery rate (q-value) is obtained from the hypergeometric test between the two gene sets.e,\nSignificance (q-value by hypergeometric test) of overlap between the gene set with the best match GO\n18\n\nname and the gene set query (y-axis). Red dashed line: signif icance cutoff at q = 0.1\n(Benjamini-Hochberg correction). Black horizontal line within violin plot shows median q-value (Best\nmatch GO: 1.40 10−8, Random GO: 1.0). **** p = 1.18 10−279 by Mann–Whitney U test.× ×\n19\nFig. 3. Evaluation of GPT-4 for analysis of gene sets discovered in ‘omics data. a, Violin plots\nshowing the distribution of semantic similarity scores between GPT-4 names and expert-determined\nnames (LEFT) or between GSEA and expert-determined names (RIGHT) for gene sets discovered in\n‘omics studies (points, n = 100). Blue: Gene sets based on expression clusters (MSigDB). Red: Gene\nsets based on protein interaction clusters (NeST). Horizontal lines denote median ± upper and lower\nquartiles. b, Distribution of the percentage of genes informed by GPT-4 analysis (LEFT) or GSEA analysis\n(RIGHT). Plots elements same as panel a. For both panels, p-v alues determined by Wilcoxon\nnonparametric two-sample comparison. * p=10–3; ** p=10–7.\n20\n\nTable 1. Example of successful GOname recovery (GO:0006953 “Acute-Phase Response”).\nGenes\n(n = 48)\nA2M, AHSG, APOL2, APCS, ASS1, CD163, CEBPB, CNR1, CRP, EPO, EDNRB, F2,\nF8, FN1, HAMP, HP, IL1A, IL1B, IL6, IL6R, IL22, INS, ITIH4, LBP, MBL2, MRGPRX1,\nORM1, ORM2, PLSCR1, PTGER3, PTGES, PTGS2, REG3A, REG3G, SAA1, SAA2,\nSAA4, SERPINA1, SERPINA3, SERPINF2, SIGIRR, TFRC, TFR2, TNF, TNFRSF11A,\nTNFSF11, TRPV1, UGT1A1\nGPT-4 Name\n(Semantic Similarity)\nAcute Phase Response\n(0.99)\nGPT-4 Analysis Paragraph\nThe most prominent biological process performed by this system of interacting proteins is the acute phase\nresponse (APR), which is a rapid inflammatory response to tissue injury, infection, or inflammation. The APR is\ncharacterized by the increased production of acute phase proteins (APPs) by the liver, which play a crucial role in\nthe body's defense against pathogens and tissue repair.\n1. Acute phase proteins: Several proteins in the list are well-known APPs, such as SERPINA1, SERPINA3, CRP,\nSAA1, SAA2, SAA4, ORM1, ORM2, HP, and A2M. These proteins are primarily synthesized in the liver and are\ninvolved in various aspects of the immune response, including opsonization, complement activation, and\nneutralization of proteases.\n2. Cytokines and inflammation: The list includes several cytokines and their receptors, such as IL1A, IL1B, IL6,\nIL6R, IL22, TNF, and TNFRSF11A, which are key mediators of inflammation and regulate the synthesis of APPs.\nFor example, IL6 is a major inducer of the APR and stimulates the production of CRP and other APPs.\n3. Coagulation and fibrinolysis: Proteins like F2, F8, and SERPINF2 are involved in the coagulation cascade,\nwhich is activated during the APR to prevent blood loss and facilitate tissue repair. Additionally, the fibrinolytic\nsystem is regulated by proteins such as SERPINA1 and SERPINF2, which inhibit plasminogen activators and\nplasmin, respectively.\n4. Iron homeostasis: Proteins like TFRC, TFR2, and HAMP are involved in iron homeostasis, which is altered\nduring the APR to limit the availability of iron for pathogens. HAMP, also known as hepcidin, is an APP that\nregulates iron absorption and distribution by binding to ferroportin and inducing its internalization and degradation.\n5. Lipid metabolism and transport: Proteins like APOL2, APCS, and AHSG are involved in lipid metabolism and\ntransport, which is essential for the immune response and tissue repair. For example, APOL2 is an apolipoprotein\nthat plays a role in lipid transport and metabolism, while APCS is involved in the clearance of apoptotic cells.\n6. Cellular stress response: Proteins like CEBPB and HSP90AA1 are involved in the cellular stress response,\nwhich is activated during the APR to protect cells from damage and promote their survival. CEBPB is a\ntranscription factor that regulates the expression of several APPs, while HSP90AA1 is a molecular chaperone that\nassists in protein folding and stabilization.\nIn conclusion, the acute phase response is the most prominent biological process performed by this system of\ninteracting proteins, as evidenced by the presence of numerous acute phase proteins, cytokines, and other\nproteins involved in inflammation, coagulation, iron homeostasis, lipid metabolism, and cellular stress response.\n21\nTable 2. Best andworst GPT-4 names for GOterms by semantic similarity.\nGOName\n(# of genes)\nGPT-4 Name\n(% of genes captured)\nSemantic\nSimilarity\nRank among\nall GOterms\n(n= 12,214)\nGPT-4 Names withHighest Similarity to GO Names\nMitochondrial tRNA Modification (9) Mitochondrial tRNA Modification\n(100%) 1.00 1\nAcute-Phase Response (48) Acute Phase Response (56%) 0.99 1\nBranched-Chain Amino Acid Catabolic\nProcess (21)\nBranched–Chain Amino Acid\nCatabolism (100%) 0.99 1\nHomocysteine Metabolic Process (14) Homocysteine Metabolism (93%) 0.99 1\nTryptophan Catabolic Process (9) Tryptophan Catabolism (100%) 0.98 1\nGPT-4 Names withLowest Similarity to GO Names\nOvulation From Ovarian Follicle (10) Regulation of Cell Proliferation and\nApoptosis (100%) 0.16 11,431\nPositive Regulation of Prostaglandin\nBiosynthetic Process (7) Inflammation Regulation (100%) 0.16 11,945\nPositive Regulation of Protein Import Into\nNucleus (39) Hedgehog Signaling Pathway (97%) 0.15 11,324\nPositive Regulation of Norepinephrine\nSecretion (4)\nOxytocin Signaling and Regulation\n(100%) 0.14 11,964\nPositive Regulation of Histone H4\nAcetylation (6)\nDNA Repair and Transcription\nRegulation (100%) 0.13 11,887\n22\nTable 3. Representative analysis for proteininteractionclusters (NeST:34 “Histone Modification”).\nGenes\n(n = 30)\nBARD1 BCL11B BRD4 CHD4 CREBBP DNMT1 DNMT3A DNMT3B E2F1 EMSY EZH2\nHDAC1 HDAC2 HDAC3 HIST3H3 ING1 IRF2 KDM5A MTA1 PALB2 PARP1 PHF6 PRDM1\nRB1 RUNX1 SMARCA1 TERT TP53 ZBTB2 ZNF217\nAnalysis\nMethod Assigned Name Semantic\nSimilarity\n# Genes\nCovered\nGPT-4 Epigenetic Regulation and DNA Repair 0.50 30\nGSEA Negative Regulation Of Transcription By RNA\nPolymerase I 0.25 20\nGPT-4 Analysis Paragraph\nThe primary biological process performed by this system of interacting proteins is epigenetic regulation and DNA\nrepair. The proteins involved in this system play crucial roles in modulating gene expression, chromatin\nremodeling, and maintaining genomic stability.\n1. Chromatin remodeling and histone modification: CHD4, SMARCA1, and ING1 are involved in chromatin\nremodeling, which is essential for regulating gene expression. HDAC1, HDAC2, and HDAC3 are histone\ndeacetylases that remove acetyl groups from histones, leading to chromatin condensation and transcriptional\nrepression. CREBBP is a histone acetyltransferase that adds acetyl groups to histones, promoting transcriptional\nactivation. EZH2 is a histone methyltransferase that catalyzes the addition of methyl groups to histone H3, leading\nto gene silencing. KDM5A is a histone demethylase that removes methyl groups from histone H3, allowing for\ngene activation.\nCurtis et al., \"The chromatin-remodeling enzymes BRG1 and CHD4 antagonistically regulate vascular\nWnt signaling.\" Molecular and cellular biology, 2012, pp. 1312-20.\nLarsen et al., \"The chromatin-remodeling factor CHD4 coordinates signaling and repair after DNA\ndamage.\" The Journal of cell biology, 2010, pp. 731-40.\nZhang et al., \"Coordinated silencing of MYC-mediated miR-29 by HDAC3 and EZH2 as a therapeutic\ntarget of histone modification in aggressive B-Cell lymphomas.\" Cancer cell, 2012, pp. 506-523.\n2. DNA methylation: DNMT1, DNMT3A, and DNMT3B are DNA methyltransferases that add methyl groups to\ncytosine residues in DNA, leading to gene silencing. This process is crucial for maintaining genomic stability and\nregulating gene expression.\nDura et al., \"DNMT3A-dependent DNA methylation is required for spermatogonial stem cells to commit\nto spermatogenesis.\" Nature genetics, 2022, pp. 469-480.\nZhang et al., \"Structural basis for DNMT3A-mediated de novo DNA methylation.\" Nature, 2018, pp.\n387-391.\nMadsen et al., \"An Important Role for DNMT3A-Mediated DNA Methylation in Cardiomyocyte\nMetabolism and Contractility.\" Circulation, 2020, pp. 1562-1578.\n3. Transcriptional regulation: E2F1, IRF2, PRDM1, RB1, RUNX1, TP53, and ZBTB2 are transcription factors that\nbind to specific DNA sequences and regulate gene expression. BCL11B and ZNF217 are also involved in\ntranscriptional regulation through their interactions with other transcription factors and chromatin modifiers.\nChoo et al., \"The role of IRF1 and IRF2 transcription factors in leukaemogenesis.\" Current gene therapy,\n2006, pp. 543-50.\n23\nWang et al., \"Prognostic analysis of E2F transcription factors E2F1 and E2F3 in four independent\npediatric neuroblastoma cohorts.\" BMC pediatrics, 2022, pp. 376.\nOwens et al., \"Dynamic Runx1 chromatin boundaries affect gene expression in hematopoietic\ndevelopment.\" Nature communications, 2022, pp. 773.\n4. DNA repair and genomic stability: BARD1, BRD4, EMSY, MTA1, PALB2, and PARP1 are involved in DNA\nrepair pathways, such as homologous recombination and non-homologous end joining. These proteins help\nmaintain genomic stability by repairing DNA damage and preventing mutations.\nRay Chaudhuri et al., \"The multifaceted roles of PARP1 in DNA repair and chromatin remodelling.\"\nNature reviews. Molecular cell biology, 2017, pp. 610-621.\nTarsounas et al., \"The antitumorigenic roles of BRCA1-BARD1 in DNA repair and replication.\" Nature\nreviews. Molecular cell biology, 2020, pp. 284-299.\nZada et al., \"Parp1 promotes sleep, which enhances DNA repair in neurons.\" Molecular cell, 2021, pp.\n4979-4993.e7.\n5. Telomere maintenance: TERT is the catalytic subunit of telomerase, which is responsible for maintaining\ntelomere length and preventing cellular senescence.\nDuan et al., \"TERT-mediated and ATRX-mediated Telomere Maintenance and Neuroblastoma.\" Journal\nof pediatric hematology/oncology, 2018, pp. 1-6.\nWang et al., “The association of telomere maintenance and TERT expression with susceptibility to\nhuman papillomavirus infection in cervical epithelium.\" Cellular and molecular life sciences : CMLS,\n2022, pp. 110.\nGoldstein et al., \"Association of germline variants in telomere maintenance genes (POT1, TERF2IP,\nACD, and TERT) with spitzoid morphology in familial melanoma: A multi-center case series.\" JAAD\ninternational, 2023, pp. 43-51.\n6. Protein-protein interactions: PHF6 and HIST3H3 are involved in protein-protein interactions that modulate the\nactivity of other proteins in this system.\nWendorff et al., \"Phf6 Loss Enhances HSC Self-Renewal Driving Tumor Initiation and Leukemia Stem\nCell Activity in T-ALL.\" Cancer discovery, 2019, pp. 436-451.\nGan et al., \"Chromatin-Binding Protein PHF6 Regulates Activity-Dependent Transcriptional Networks to\nPromote Hunger Response.\" Cell reports, 2020, pp. 3717-3728.e6.\nAillaud et al., \"Tau Aggregation Inhibiting Peptides as Potential Therapeutics for Alzheimer Disease.\"\nCellular and molecular neurobiology, 2023, pp. 951-961.\nIn summary, this system of interacting proteins plays a critical role in epigenetic regulation and DNA repair,\nensuring proper gene expression and maintaining genomic stability.\n24\nReferences\n1. Breitling, R., Amtmann, A. & Herzyk, P. Iterative Group Analysis (iGA): a simple tool to enhance\nsensitivity and facilitate interpretation of microarray experiments. BMC Bioinformatics5, 34 (2004).\n2. Huang, D. W., Sherman, B. T. & Lempicki, R. A. Systematic and integrative analysis of large gene\nlists using DAVID bioinformatics resources.Nat. Protoc.4, 44–57 (2009).\n3. Pomaznoy, M., Ha, B. & Peters, B. GOnet: a tool for interactive Gene Ontology analysis.BMC\nBioinformatics 19, 470 (2018).\n4. Zeeberg, B. R. et al.GoMiner: a resource for biological interpretation of genomic and proteomic data.\nGenome Biol.4, R28 (2003).\n5. Al-Shahrour, F. et al.From genes to functional classes in the study of biological systems. BMC\nBioinformatics 8, 114 (2007).\n6. Subramanian, A. et al.Gene set enrichment analysis: a knowledge-based approach for interpreting\ngenome-wide expression profiles.Proc. Natl. Acad. Sci. U. S. A.102, 15545–15550 (2005).\n7. Backes, C. et al.GeneTrail—advanced gene set enrichment analysis.Nucleic Acids Res.35,\nW186–W192 (2007).\n8. Beissbarth, T. & Speed, T. P. GOstat: find statistically overrepresented Gene Ontologies within a\ngroup of genes.Bioinformatics 20, 1464–1465 (2004).\n9. Ashburner, M. et al.Gene Ontology: tool for the unification of biology.Nat. Genet.25, 25–29 (2000).\n10. Gene Ontology Consortiumet al.The Gene Ontology knowledgebase in 2023.Genetics 224, (2023).\n11. Croft, D. Reactome: A database of biological pathways.Nature Precedings(2010)\ndoi:10.1038/npre.2010.5025.1.\n12. Fabregat, A.et al.The Reactome pathway Knowledgebase.Nucleic Acids Res.44, D481–7 (2015).\n13. Jassal, B.et al.The reactome pathway knowledgebase.Nucleic Acids Res.48, D498–D503 (2020).\n14. Cerami, E. G.et al.Pathway Commons, a web resource for biological pathway data. Nucleic Acids\nRes. 39, D685–90 (2011).\n15. Pico, A. R.et al.WikiPathways: pathway editing for the people.PLoS Biol.6, e184 (2008).\n16. Kanehisa, M., Goto, S., Sato, Y., Furumichi, M. & Tanabe,M. KEGG for integration and interpretation\nof large-scale molecular data sets.Nucleic Acids Res.40, D109–14 (2012).\n17. Pillich, R. T.et al.NDEx IQuery: a multi-method network gene set analysis leveraging the Network\nData Exchange.Bioinformatics 39, (2023).\n18. Wang, S.et al.Typing tumors using pathways selected by somatic evolution. Nat. Commun.9, 4159\n(2018).\n19. OpenAI. GPT-4 Technical Report.arXiv [cs.CL](2023).\n20. Chowdhery, A.et al.PaLM: Scaling Language Modeling with Pathways.arXiv [cs.CL](2022).\n21. Vaswani, A.et al.Attention is all you need.arXiv [cs.CL]I (2017).\n22. Devlin, J., Chang, M.-W., Lee, K. & Toutanova, K. BERT: Pre-training of Deep Bidirectional\n25\nTransformers for Language Understanding. inProceedings of the 2019 Conference of the North\nAmerican Chapter of the Association for Computational Linguistics: Human Language Technologies,\nVolume 1 (Long and Short Papers)4171–4186 (Association for Computational Linguistics, 2019).\n23. Brown, T. B.et al.Language Models are Few-Shot Learners.arXiv [cs.CL](2020).\n24. Moghaddam, S. R. & Honey, C. J. Boosting Theory-of-Mind Performance in Large Language Models\nvia Prompting.arXiv [cs.AI](2023).\n25. Hebenstreit, K., Praas, R., Kiesewetter, L. P. & Samwald, M. An automatically discovered\nchain-of-thought prompt generalizes to novel models and datasets. arXiv [cs.CL](2023).\n26. Caufield, J. H.et al.Structured prompt interrogation and recursive extractionof semantics (SPIRES):\nA method for populating knowledge bases using zero-shot learning. arXiv [cs.AI](2023).\n27. Liberzon, A.et al.The Molecular Signatures Database (MSigDB) hallmark gene set collection.Cell\nSyst 1, 417–425 (2015).\n28. Zheng, F.et al.Interpretation of cancer mutations using a multiscale map of protein systems.Science\n374, eabf3067 (2021).\n29. Miller, G. A. & Charles, W. G. Contextual correlates of semantic similarity.Lang. Cogn. Process.6,\n1–28 (1991).\n30. Reiter, V.et al.The CDK5 repressor CDK5RAP1 is a methylthiotransferase acting on nuclear and\nmitochondrial RNA.Nucleic Acids Res.40, 6235–6240 (2012).\n31. Martín, A.et al.Mitochondrial RNA methyltransferase TRMT61B is a new, potential biomarker and\ntherapeutic target for highly aneuploid cancers.Cell Death Differ.30, 37–53 (2023).\n32. Zhang, Y.et al.Intron 1 GATA site enhances ALAS2 expression indispensablyduring erythroid\ndifferentiation. Nucleic Acids Res.45, 657–671 (2017).\n33. Soto, J. L., Cabrera, C. M., Serrano, S. & López-Nevot, M.A. Mutation analysis of genes that control\nthe G1/S cell cycle in melanoma: TP53, CDKN1A, CDKN2A, and CDKN2B. BMC Cancer5, 36\n(2005).\n34. Hafezi, S. & Rahmani, M. Targeting BCL-2 in Cancer: Advances, Challenges, and Perspectives.\nCancers 13, (2021).\n35. Shaul, Y. & Ben-Yehoyada, M. Role of c-Abl in the DNA damage stress response.Cell Res.15,\n33–35 (2005).\n36. Wei, J.et al.Chain-of-Thought Prompting Elicits Reasoning in Large Language Models.arXiv [cs.CL]\n(2022).\n37. Schick, T.et al.Toolformer: Language Models Can Teach Themselves to Use Tools. arXiv [cs.CL]\n(2023).\n38. Yao, S.et al.ReAct: Synergizing reasoning and acting in language models. arXiv [cs.CL](2022).\n39. Fezari, M. & Ali-Al-Dahoud, A. A. D. From GPT to AutoGPT: aBrief Attention in NLP Processing\nusing DL.researchgate.net.\n40. Shen, Y.et al.HuggingGPT: Solving AI Tasks with ChatGPT and its Friends inHugging Face.arXiv\n[cs.CL] (2023).\n41. Nair, V., Schumacher, E., Tso, G. & Kannan, A. DERA: Enhancing Large Language Model\n26\nCompletions with Dialog-Enabled Resolving Agents.arXiv [cs.CL](2023).\n42. Shinn, N.et al.Reflexion: Language Agents with Verbal Reinforcement Learning. arXiv [cs.AI]\n(2023).\n43. Li, G., Al Kader Hammoud, H. A., Itani, H., Khizbullin, D.& Ghanem, B. CAMEL: Communicative\nAgents for ‘Mind’ Exploration of Large Scale Language ModelSociety. arXiv [cs.AI](2023).\n44. Keskar, N. S., McCann, B., Varshney, L. R., Xiong, C. & Socher, R. CTRL: A Conditional Transformer\nLanguage Model for Controllable Generation.arXiv [cs.CL](2019).\n45. Holtzman, A., Buys, J., Du, L., Forbes, M. & Choi, Y. The Curious Case of Neural Text Degeneration.\narXiv [cs.CL](2019).\n46. Liu, F., Shareghi, E., Meng, Z., Basaldella, M. & Collier, N. Self-Alignment Pretraining for Biomedical\nEntity Representations.arXiv [cs.CL](2020).\n47. Fang, Z., Liu, X. & Peltz, G. GSEApy: a comprehensive package for performing gene set enrichment\nanalysis in Python.Bioinformatics 39, (2023).\nAcknowledgments\nWe would like to thank all members of the Ideker lab, especially Xiaoyu Zhao and Akshat Singhal for\nproofreading the manuscript and providing insightful comments, Christopher Churas for helping with the\norganization of the GitHub repository, and Samson Fong for helping with the blinded human determination\nstudy. This work was supported by National Institutes of Health grants U24 CA269436, OT2 OD032742,\n5U24HG012107, U01 MH115747, and U54 CA274502. Additional support was received from Schmidt\nFutures.\nAuthor information\nAuthors and Affiliations\nDepartment of Medicine, University of California SanDiego, LaJolla, California, USA\nMengzhou Hu, Ingoo Lee, Rudolf T. Pillich, Robin Bachelder,Trey Ideker & Dexter Pratt\nDepartment of Computer Science and Engineering, University ofCalifornia San Diego, La Jolla,\nCalifornia, USA\nSahar Alkhairy & Trey Ideker\nContributions\n27\nM.H., S.A., T.I., and D.P. designed the study. M.H. and S.A. developed and implemented the automated\nGPT-4-based gene set interpretation pipeline, performed the data analysis, and organized the GitHub\nrepository. S.A. developed and assessed the semantic similarity calculation. M.H. and I.L. contributed to\nthe development of the citation search and validation pipeline. D.P. contributed to the coding and the\nevaluation of the analysis. R.P. assisted in the study design and the evaluation of the analysis. R.B. and\nD.P. conducted the scientific review of the GPT-4 output. S.A., M.H., T.I., and D.P. wrote the manuscript\nwith input from all authors. All authors approved the final version of this manuscript.\nCorresponding author\nCorrespondence to Trey Ideker and Dexter Pratt.\nEthics declarations\nTI is a co-founder, member of the advisory board, and has an equity interest in Data4Cure and Serinus\nBiosciences. TI is a consultant for and has an equity interest in Ideaya BioSciences and Light Horse\nTherapeutics. The terms of these arrangements have been reviewed and approved by UC San Diego in\naccordance with its conflict of interest policies.\n28\nExtended Data Figures and Tables\nExtended Data Fig. 1. Schematic of the citation module. a, GPT-4 is asked to provide gene symbol\nkeywords and functional keywords separately.b, Multiple gene keywords are combined with ‘OR’ and\nthen with one function using ‘AND’.c, PubMed is searched for relevant titles and/or abstracts inthe\nscientific literature.d, GPT-4 is queried to evaluate the abstract, saving supporting references.e, Prompts\nused for each query of the GPT-4 model.\n29\n\nExtended Data Fig. 2. Distribution of GO term gene sizes. a, Distribution of number of genes per GO\nterm among all terms in GO-BP (n = 12,214; y axis).b, Distribution of number of genes per GO term\namong selected 1000 GO terms (y axis).\nExtended Data Fig. 3. Distribution of ‘omics gene set sizes.Number of genes per gene set among all\n‘omics gene sets considered in this study. (n=100).\n30\n\nExtendedData Table 1. Estimatedtime anddollar usage for GPT-4 gene set analysis.\nEstimate time usage\n(second/gene set)\nEstimate cost\n($/gene set)\nQuery gene set interpretation 70 0.54\nReference searchandvalidation 77 1.04\nExtendedData Table 2. Representative names from ‘omics gene set analysis.\nExpert\ndetermined name\nGPT-4\ndetermined name\nGSEA\ndetermined name # of Genes\n% of Genes Captured\nGPT-4 GSEA\nHedgehog Signaling Neuronal Development\nand Axon Guidance\nNervous System\nDevelopment 36 100% 31%\nNotch Signaling Notch Signaling\nPathway\nNotch Signaling\nPathway 32 34% 100%\nUbiquitin regulation of\np53 activity\nProtein Degradation\nand Regulation\nProtein Modification By\nSmall Protein\nConjugation\n9 100% 67%\np53 regulation of cell\ncycle Cell Cycle Regulation Cellular Response To\nUV 5 100% 80%\nPancreas Beta Cells\nPancreatic Islet Cell\nDevelopment and\nFunction\nRegulation Of Insulin\nSecretion 40 95% 23%\nInterferon Alpha\nResponse\nAntiviral Immune\nResponse\nDefense Response To\nVirus 97 35% 34%\nRAS-RAF-MAPK MAPK/ERK Signaling\nPathway MAPK Cascade 7 100% 71%\nATM-independent\nDNA repair\nDNA Damage\nResponse and Repair DNA Repair 32 97% 63%\nEstrogen Response\nEarly\nCell Proliferation and\nDifferentiation Vascular Transport 200 5% 5%\nNucleus DNA Damage\nResponse and Repair\nRegulation Of\nTranscription By RNA\nPolymerase II\n194 72% 51%\n31\nExtendedData Table 3. Evaluationof SapBERTfor determinationof semantic similarity.\nSapBERT Humanpanel Number of gene sets\nGPT-4 > GSEA GPT-4 > GSEA 47 (agreement)\nGPT-4 > GSEA GPT-4 < GSEA 15 (disagreement)\nGPT-4 < GSEA GPT-4 > GSEA 10 (disagreement)\nGPT-4 < GSEA GPT-4 < GSEA 28 (agreement)\nSupplementary Information\nSupplementary Table 1\nComplete GPT-4 analysis of GO terms (related to workflow1, Fig. 2).\nSupplementary Table 2\nComplete GPT-4 analysis of omics gene sets (related to workflow2, Fig. 3).\nSupplementary Table 3\nReviewer fact-checking of GPT-4 analysis text.\nSupplementary Table 4\nReviewer evaluation of citation relevance.\n32\nSupplementary Files\nThis is a list of supplementary \u0000les associated with this preprint. Click to download.\nSupplementaryTable1.CompleteGPT4AnalysisofGOTerms.xlsx\nSupplementaryTable2.CompleteGPT4AnalysisofOmicsGeneSets.xlsx\nSupplementaryTable3.ReviewerFactCheckingofGPT4AnalysisText.xlsx\nSupplementaryTable4.ReviewerEvaluationofCitationRelevance.xlsx"
}