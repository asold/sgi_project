{
  "title": "Compensation of Current Transformers’ Nonlinearities by Tensor Linearization",
  "url": "https://openalex.org/W2946251599",
  "year": 2019,
  "authors": [
    {
      "id": "https://openalex.org/A4288196592",
      "name": "Collin, Adam J.",
      "affiliations": [
        "University of Campania \"Luigi Vanvitelli\""
      ]
    },
    {
      "id": null,
      "name": "Femine, Antonio Delle",
      "affiliations": [
        "University of Campania \"Luigi Vanvitelli\""
      ]
    },
    {
      "id": "https://openalex.org/A2210956228",
      "name": "Gallo Daniele",
      "affiliations": [
        "University of Campania \"Luigi Vanvitelli\""
      ]
    },
    {
      "id": "https://openalex.org/A2753594587",
      "name": "Langella Roberto",
      "affiliations": [
        "University of Campania \"Luigi Vanvitelli\""
      ]
    },
    {
      "id": "https://openalex.org/A4288486587",
      "name": "Luiso Mario",
      "affiliations": [
        "University of Campania \"Luigi Vanvitelli\""
      ]
    }
  ],
  "references": [
    "https://openalex.org/W2503348341",
    "https://openalex.org/W2087061179",
    "https://openalex.org/W2125874589",
    "https://openalex.org/W2060335106",
    "https://openalex.org/W2067973011",
    "https://openalex.org/W6685612045",
    "https://openalex.org/W2231985385",
    "https://openalex.org/W1988185442",
    "https://openalex.org/W2808295644",
    "https://openalex.org/W2808008454",
    "https://openalex.org/W2490773235",
    "https://openalex.org/W2795298520",
    "https://openalex.org/W2905303652",
    "https://openalex.org/W2896570202",
    "https://openalex.org/W2550744871",
    "https://openalex.org/W2162524506",
    "https://openalex.org/W2098397735",
    "https://openalex.org/W2164386812",
    "https://openalex.org/W2056394722",
    "https://openalex.org/W2800238587",
    "https://openalex.org/W2725674593",
    "https://openalex.org/W2897938179",
    "https://openalex.org/W2901613173",
    "https://openalex.org/W2901543600",
    "https://openalex.org/W2181128810"
  ],
  "abstract": "With the proliferation of harmonic sources in power systems, current transformers (CTs), which are the most widely used current transducers in power systems, will have to measure and monitor signals with increasing levels of distortion. The accuracy of the measurement can be affected by the nonlinear response of the CT, which is dependent on the distortion in the measured signal, but nonlinear mathematical models can be used to compensate the measured value. In this paper, the complex ratio of the CT is modeled using a frequency domain model based on tensor linearization, obtaining a real-valued compensation matrix. An accurate measurement setup has been built to characterize the CTs performance in distorted conditions. Experimental results using the proposed compensation technique are presented and discussed for two commercial CTs of accuracy class 0.5 and 1. It is demonstrated that the proposed technique can accurately reconstruct the harmonic components (up to several kilohertz) of the CT primary current from the measured CT distorted secondary current.",
  "full_text": "IEEE TRANSACTIONS ON INSTRUMENTATION AND MEASUREMENT, VOL. 68, NO. 10, OCTOBER 2019 3841\nCompensation of Current Transformers’\nNonlinearities by Tensor Linearization\nAdam J. Collin , Member, IEEE, Antonio Delle Femine , Member, IEEE, Daniele Gallo , Member, IEEE,\nRoberto Langella , Senior Member, IEEE, and Mario Luiso , Member, IEEE\nAbstract— With the proliferation of harmonic sources in power\nsystems, current transformers (CTs), which are the most widely\nused current transducers in power systems, will have to measure\nand monitor signals with increasing levels of distortion. The\naccuracy of the measurement can be affected by the nonlinear\nresponse of the CT, which is dependent on the distortion in\nthe measured signal, but nonlinear mathematical models can\nbe used to compensate the measured value. In this paper,\nthe complex ratio of the CT is modeled using a frequency domain\nmodel based on tensor linearization, obtaining a real-valued\ncompensation matrix. An accurate measurement setup has been\nbuilt to characterize the CTs performance in distorted conditions.\nExperimental results using the proposed compensation technique\nare presented and discussed for two commercial CTs of accuracy\nclass 0.5 and 1. It is demonstrated that the proposed technique\ncan accurately reconstruct the harmonic components (up to\nseveral kilohertz) of the CT primary current from the measured\nCT distorted secondary current.\nIndex Terms— Current transformer (CT), frequency coupling\nmatrix (FCM), harmonics, nonlinearity compensation, phase-\ndependent characteristics, power quality, power system measure-\nments.\nI. I NTRODUCTION\nT\nHE measurement of harmonics and power quality, in gen-\neral, is an essential task, particularly in the new context\nof smart grids with a high penetration of nonlinear loads and\nenergy production from renewable sources. Nowadays, current\nand voltage instrument transformers (CTs and VTs) are still\nthe most commonly installed current and voltage transducers\nin power systems, at all voltage levels. As a consequence,\nmost measuring instruments fo r power system applications\n(power/energy measurement, power quality measurement, pha-\nsor measurement unit, etc.) use CTs and VTs.\nSome recent scientiﬁc literature [1]–[6] has experimentally\ndemonstrated that even high accuracy class CTs and VTs (i.e.,\naccuracy class better than 0.5) may suffer from nonlinearity\nManuscript received November 19, 2018; revised January 24, 2019;\naccepted March 1, 2019. Date of publication May 13, 2019; date of current\nversion September 13, 2019. This work received funding by: 1) the EMPIR\nprogramme co-ﬁnanced by the Participating States within EURAMET and\nfrom the European Union’s Horizon 2020 research and innovation programme\n(Grant 17IND06 Future Grid II); 2) University of Campania “Luigi Van-\nvitelli” (Piano Strategico V ALERE—OPEN ACCESS); 3) Italian Ministry of\nUniversity and Research (Grant PON 03PE-00178-1). The Associate Editor\ncoordinating the review process was Sara Sulis. (Corresponding author:\nMario Luiso.)\nThe authors are with the Departmen t of Engineering, University of\nCampania Luigi Vanvitelli, Aversa 81100,Italy (e-mail: adam.collin@ieee.org;\nantonio.dellefemine@unicampania.it; daniele.gallo@unicampania.it;\nroberto.langella@unicampania.it; mario.luiso@unicampania.it).\nColor versions of one or more of the ﬁgures in this article are available\nonline at http://ieeexplore.ieee.org.\nDigital Object Identiﬁer 10.1109/TIM.2019.2905908\neffects. Due to these effects, the accuracy of the CT/VT is\nstrongly dependent on the amp litude, phase angle, and the\norder of harmonic content of the input waveform. Therefore,\nthe measurement of harmonics by CTs and VTs could present\nan accuracy which is much lower than the accuracy class of\nthe instrument transformer us ed in the measurement chain.\nAccordingly, accurate measur ement of harmonics by the CT\nor VT requires the use of a nonlinear mathematical (either\nanalytic or numerical) model for the instrument transformer,\nwhich is able to accurately reconstruct the primary quantity\n(i.e., current for CTs and voltage for VTs) from the measured\nsecondary quantity.\nDifferent techniques for mathematically describing the non-\nlinearity of instrument transformers have been proposed in\nthe scientiﬁc literature, e.g., [6]–[9]. These approaches are\nessentially based on modeling the saturation and eddy currents\nphenomena in transformers. However, the performances of the\nproposed techniques have not been veriﬁed when harmonic\ndistortion is present in the primary quantity. Only in [6], non-\nsinusoidal operating conditions are accounted but the distortion\nintroduced by the CT at the secondary is considered dependent\nonly on the fundamental primary amplitude.\nAnother approach to model nonlinear devices, commonly\nused for power system harmonic penetration studies in the\nfrequency domain, is the frequency coupling matrix (FCM)\napproach [10]–[20]. FCMs are based on the theory of small\nsignal analysis and are used in this research to relate the\ngeneric harmonic components of the secondary current to the\nvariations of all of the considered harmonic components of\nthe primary current. FCMs are a powerful tool: they are able\nto model the nonlinearities in power system components for\nboth traditional devices (i.e., power transformers, ac motors,\ncables, and so on) as well as modern devices based on\npower electronic technologies. FCMs can be obtained both\nanalytically or by numerical or experimental tests.\nIn [21], the FCM approach was applied to model the\ncomplex ratio of a class 0.5 CT in order to compensate the\nnonlinearity of the CT behavior. The FCM was derived and it\nwas shown that by inverting this matrix, the harmonic content\nof the primary current can be accurately identiﬁed from the\nmeasurement of the secondary current.\nThis paper builds on and signiﬁcantly extends the initial\nwork presented in [21] by providing: 1) further analytical\ndetails about the FCM derivation; 2) the description of the\nnew, and much more accurate, test setup built; 3) an extension\nof the frequency range from 1 to 10 kHz; 4) the character-\nization of a new CT with lower accuracy class; 5) a new\n0018-9456 © 2019 I EEE. Translations and c ontent mining are perm itted for academic research only. Personal use is also permitted,\nbut republication/redistribution r equires IEEE permission. See http://www.ieee.org/publicat ions_standards/publications/rights/index.html for more information.\n3842 IEEE TRANSACTIONS ON INSTRUMENTATION AND MEASUREMENT, VOL. 68, NO. 10, OCTOBER 2019\nFig. 1. Block diagram of the measurement setup for CT characterization [3].\nset of experimental tests for the veriﬁcation of the proposed\nmethodology; 6) the introductio n of one additional method\nfor comparing the performance of the proposed compensation\ntechnique.\nThe paper is organized as follows. Section II analytically\ndescribes the proposed CT compensation technique. Section III\npresents the experimental setup and describes the experimental\ntests performed to characteriz e the CT. Section IV shows the\nderivation of the FCM of the two CTs under study. Section V\ndiscusses the use of the proposed compensation technique in\na practical case comparing its performance with two other\nmethods presented in the literature. Conclusions are given in\nSection VI.\nII. CT C\nOMPENSATION TECHNIQUE\nUnder the hypothesis of time-periodic signals, the secondary\ncurrent of a current transformer (CT) is(t) is a function of the\nprimary current i p(t)\nis(t) = g(i p(t)) (1)\nwhere g is a function which accounts for the nonlinearities\nrelated to the nonideal operation of the CT itself.\nUnder small-signal operation, any device can be linearized\naround proper operation base points is\nb(t) and i p\nb (t). Evaluating\nthe complex Fourier series of the quantities (italic fonts are\nused for complex numbers) involved gives\n[\u0002Is ]=\n\u0002\nIs − Is\nb\n\u0003\n= G\n\u0004\u0002\nI p − I p\nb\n\u0003\u0005\n= G([\u0002I p]) (2)\nwhere \u0002Is and \u0002I p are vectors of harmonic phasors and the\nfunction G is a complex function.\nIf G is linear, it may include lin ear cross-coupling and\nphase dependence between harmonics [10]. However, when\nlinearizing general nonlinear devi ces, representation by a sin-\ngle matrix of complex numbers is not possible. The general\nrepresentation is\n\u0002I\ns = G+\u0002I p + G−\u0002I p∗ (3)\nwhere G+ and G− are two matrices of complex numbers\nthat couple \u0002I p and its conjugate \u0002I p∗, respectively, to give\n\u0002Is [18]–[21].\nIn real terms, G+ is able to take into account the cross\ncoupling between primary and secondary harmonic currents,\nwhile G− takes into account the dependence of the secondary\ncurrent harmonics on the phase angle of the primary current\nharmonics. For example, a linear device will have a diagonal\nconstant G+ matrix and a nil G− matrix. These concepts will\nbe addressed in more detail in Section IV .\nEquation (3) can be elegantly and efﬁciently rewritten using\na real-valued rank 2 tensor representation as in the following\nequation:\n⎡\n⎢⎢⎢⎢\n⎢⎣\n\t \u0002I\ns\n2r\n\u0002Is\n2i\n\n...\t \u0002Is\nHr\n\u0002Is\nHi\n\n⎤\n⎥⎥⎥⎥\n⎥⎦\n=\n⎡\n⎢⎢⎢⎢\n⎢\n⎢\n⎢⎢⎢⎣\n\t g\n2r2r g2r2i\ng2i2r g2i2i\n\n···\n\t g2rKr g2rKi\ng2iKr g2iKi\n\n..\n.\n... ...\n\t g\nHr2r gHr2i\ngHi2r gHi2i\n\n···\n\t gHrKr gHrKi\ngHiKr gHiKi\n\n⎤\n⎥⎥⎥⎥\n⎥\n⎥\n⎥⎥⎥⎦\n×\n⎡\n⎢⎢⎢⎢\n⎢\n⎢\n⎢⎣\n\u000e\n\u0002I\np\n2r\n\u0002Ip\n2i\n\u000f\n..\n.\u000e\n\u0002I\np\nKr\n\u0002Ip\nKi\n\u000f\n⎤\n⎥⎥⎥⎥\n⎥\n⎥\n⎥⎦\n(4)\nwhere H and K are the maximum harmonic order considered\nin the matrix derivation; the generic element of the matrix in\n(4) is a real valued rank 2 tenso r evaluated by the following\nexpression:\n\t g\nhrkr ghrki\nghikr ghiki\n\n=\n\t g+\nhkr −g+\nhki\ng+\nhki g+\nhkr\n\n+\n\t g−\nhkr g−\nhki\ng−\nhki −g−\nhkr\n\n(5)\nwhere g+\nhkr and g+\nhki\n(g−\nhkr and g−\nhki\n) are the real and imaginary\nparts of the generic complex element g+\nhk (g−\nhk) of the matrix\nG+ (G−) in (3), which can be written in a more compact form\n[\u0002Is]=[ G(2)][\u0002I p] (6)\nwhere G(2) is a matrix whose elements are tensors of rank 2.\nIf G(2) is invertible, the following relation can be written :\n[\u0002I p]=[ G(2)]−1[\u0002Is]=[ R(2)][\u0002Is]. (7)\nCOLLIN et al.: COMPENSATION OF CTs’ NONLINEARITIES BY TENSOR LINEARIZATION 3843\nThe ratio compensation matrix R(2) in (7) can be used to\ncompensate for the measured secondary current spectrum.\nIn practice, as R(2) is derived at a speciﬁc operating point,\nthe CT should be characterized at several expected operat-\ning points and the appropriate compensation matrix selected\nbasing on the observed operating condition. Alternatively, the\ncomputational burden can be reduced by considering that as\nR\n(2) is a real-valued matrix, it is mathematically possible\nto obtain a single, averaged matrix from these individual\nmatrices. The error introduced by either approach will depend\non the speciﬁc CT characteristic s and the number of discrete\nintervals deﬁned.\nIII. M EASUREMENT SETUP\nA. Hardware Description\nThe block diagram of the setu p for CT characterization\nis shown in Fig. 1. Current generation is obtained through\nthe Fluke 52120A transconductance ampliﬁer (up to three in\nparallel, each rated up to 120 A, up to 10 kHz), remotely\ncontrolled through IEEE 488. It is driven by the NI PXI\n(PCI eXtension for Instrumentation) 5422 arbitrary waveform\ngenerator (AWG) (±12 V , 200 MHz maximum sampling rate,\n16 bit, onboard memory 256 MB).\nThe AWG is housed in a PXI chassis and the 10 MHz PXI\nclock is used as the reference clock for its high-resolution\nphase-locked loop circuitry. The generation frequency of the\nAWG is therefore chosen to be an integer multiple of the\ngenerated fundamental frequency.\nAnother AWG is used to generate a 12.8 MHz clock, which\nis used as the time base clock for the comparator [22], [23],\nremotely controlled through a LAN connection. This is based\non the NI cDAQ chassis with two different acquisition mod-\nules: NI 9239 ( ±10 V , 24 bit, and 50 kHz) and NI 9238\n(±500 mV , 24 bit, and 50 kHz). In this way, generation and\nacquisition are synchronized.\nThe current reference value is obtained by means of a set of\ncalibrated current shunts (REF in Fig. 1), Fluke A40B series,\n1/0.8, 5/0.8, 20/0.8, and 100/0.8 A/V . They are among the\nmost accurate current shunts, with an input frequency range\nup to 100 kHz, available on the market, with the best accuracy\nof some parts per million. The output current of the CT is\nsensed through a LEM NORMA TRIAX Shunt (SH in Fig. 1),\n30/300 A/mV (0.03% up to 100 kHz).\nB. CT Testing Procedure\nIn order to characterize the CT performance in the pres-\nence of distorted signals, an event-based state machine has\nbeen developed in LabVIEW. A large choice of signal types\nmay be selected, for example, sinusoidal, fundamental plus a\nharmonic tone (FH1), fundamental with N harmonics (FHN),\nand fundamental with an interharmonic (FI1).\nOnce the signal is generated, the software waits for a\nvariable time interval, depending on the setup conﬁguration,\nin order to ensure that all of the devices are at the correct\noperating temperature. Then, the output waveforms of the\nREF and the CT under test (CT in Fig. 1) are simultaneously\nsampled and stored in ﬁles. The sampling frequency is set to\n50 kHz. The samples stored in the ﬁles are then postprocessed\nin the MATLAB environment.\nThe CT complex frequency response is determined at every\nfrequency component that is generated: as the sampling is\nsynchronous with generation, the phasors of primary and\nsecondary currents are obtained by means of discrete Fourier\ntransform (DFT). Following the calculation of all the phasors,\nthe ratio error and phase error, deﬁned in the following\nequations, are evaluated f or each harmonic component of\norder j:\n\u0002R\nj =\n\u0010\nK\n\u0011\u0011Is\nj\n\u0011\u0011\n\u0011\n\u0011I\np\nj\n\u0011\u0011 − 1\n\u0012\n· 100 (8)\n\u0002ϕj = ϕs\nj − ϕp\nj (9)\nwhere K is the rated ratio of the CT, |I p\nj | and ϕp\nj are the\namplitude and phase angle of the primary current, and |Is\nj |\nand ϕs\nj are the amplitude and phase angle of the secondary\ncurrent, obtained, respectively, from the output of the reference\nshunt and the shunt at the CT secondary winding.\nIn order to evaluate the performance of the proposed\ncompensation technique, the ratio and phase errors are also\nevaluated with the compensated secondary current\n\u0002RFCM,j =\n\u0010\u0011\u0011˜I\np\nj\n\u0011\u0011\n\u0011\u0011Ip\nj\n\u0011\u0011 − 1\n\u0012\n· 100 (10)\n\u0002ϕFCM,j =˜ϕp\nj − ϕp\nj (11)\nwhere | ˜I p\nj | and ˜ϕp\nj are the amplitude and the phase angle of\nthe primary current obtained by compensating the secondary\ncurrent with the FCM.\nC. Characterization of the Measurement Setup\nThe evaluation of the equations (8)–(11) requires the knowl-\nedge of the complex gain of the CT, i.e., the ratio of\nthe secondary to primary current phasors. Following Fig. 1,\nthe complex gain G\nCT\nj of the CT, for the jth harmonic\ncomponent, can be expressed as\nGCT\nj =\nIs\nj\nI p\nj\n=\nGREF\nj\nV REF\nj\nV SH\nj\nGSH\nj\n=\nV 1\nj\nV 0\nj\nG0\nj\nG1\nj\nGREF\nj\nGSH\nj\n(12)\nwhere V REF\nj (V SH\nj ), G0\nj (G1\nj ),a n d V 0\nj (V 1\nj ) are, respectively,\nthe phasor of the voltage at the output of the shunt REF\n(SH) acquired by channel 0 (channel 1) of the comparator,\nthe complex gain of the channel 0 (channel 1) and the\nmeasured phasor by the channel 0 (channel 1). G\nREF\nj and GSH\nj\nare the complex gains of shunt REF and SH.\nTherefore, the measurement of GCT\nj , and thus the measure-\nment of the quantities in (8)–(11) is affected by the systematic\nerrors introduced by the quantities\n\u0002G\nCOMP\nj =\nG0\nj\nG1\nj\n(13)\n\u0002GS\nj =\nGREF\nj\nGSH\nj\n(14)\n3844 IEEE TRANSACTIONS ON INSTRUMENTATION AND MEASUREMENT, VOL. 68, NO. 10, OCTOBER 2019\nTABLE I\nSYSTEMATIC RATIO AND PHASE ERRORS , AND RELATIVE EXPANDED\nUNCERTAINTY (99%), I NTRODUCED BY THE COMPARATOR AT 50 Hz\nAND 10 KHz FOR SIGNALS OF 10% OF THE INPUT RANGE\nwhich, in turn, have to be measured and compensated.\nThese quantities have been measured by performing tests of\ntype FH1.\n\u0002G\nCOMP\nj is linked to the accuracy of the comparator, whose\ncharacterization has been extensively discussed in [22]. The\nsystematic ratio and phase errors, and the relative expanded\nuncertainty (99% conﬁdence level), introduced by the com-\nparator at 50 Hz and 10 kHz, for input signals equal to 10%\n(i.e., 0.7 V) of the full-scale range, are summarized in Table I.\n\u0002G\nS\nj represents the mismatch between the frequency\nresponses of the primary (reference) and the secondary shunts\nof the CT. As different reference shunts are used, different\n\u0002GS\nj have been evaluated for each, using the same measure-\nment setup shown in Fig. 1 (excluding the CT under test\nand making the primary current ﬂow into both REF and SH\nshunts).\nAnother important feature of a calibration setup for instru-\nment transformers is the accuracy of the generated current\nvalue. The accuracy of the generated current depends both on\nthe stability and on the repeatability of the AWG and of the\nampliﬁer. Speciﬁc tests (of type FH1) have been performed\nto evaluate the stability and the repeatability of the generated\ncurrent. The stability, evaluated as the standard deviation of\nthe amplitude and phase of the current during a speciﬁc test,\nwas very good, lower than ﬁve parts per million. However, the\nrepeatability, evaluated as the standard deviation of amplitude\nand phase of current generated over several repetitions of each\nFH1 test, was in the order of 0.05% and was considered not\nacceptable for the application at hand.\nTherefore, in order to improve the repeatability of the\ngenerated current, a closed loop generation has been used:\nfor each test, the desired waveform is generated and acquired.\nIf the amplitude and phase of the generated tones differ\nfrom the desired values, the waveform is regenerated until\nboth values are within 10 μA/A and 10 μrad. In this way,\na very precise and accurate signal is obtained up to 10 kHz.\nIn particular, the gain and phase errors of the generation\nsystem are below 10 μA/A and 10 μr a du pt o1 0k H z ;t h e\nexpanded uncertainties (95% conﬁdence level) are 8 μA/A and\n11 μr a da t4 7H za n d9 2μA/A and 2.2 mrad at 10 kHz.\nD. Current Transformers Under Test\nThe previously described system has been used to char-\nacterize the behavior of two commercial CTs. The ﬁrst CT,\nnamed CT1, is a window type 100/5 A/A CT, with a rated\nratio of 20, accuracy class of 1 and rated burden of 3 V A.\nFig. 2. CT1: Values of the main diagonal elements of the matrix G+ in p.u.\nof the rated ratio of the CT.\nThe second CT, named CT2, is a wound 10/5 A/A CT, with\na rated ratio of 2, accuracy class of 0.5, and rated burden\nof 5 V A. For both of the CTs, the operating frequency is\n50/60 Hz. For CT1, one additional primary turn is used in\norder to increase the equivalent measured primary current.\nIn this way, CT1 becomes a 50/5 A/A CT, with a ratio equal\nto 10. Regarding the burden, all tests have been performed\nwith only shunt SH connected to the secondary terminals of\nthe CTs; as it has a resistance of 10 m \u0003, it corresponds to a\nburden of 0.25 V A, i.e., 8% burden for CT1 and 5% for CT2.\nIV . C\nOMPENSATION MATRIX DERIV ATION\nThe compensation matrix calculation process begins with\nthe derivation of the gain matrices G+ and G− (3) and then\nthe ratio compensation matrix R(2) is computed using (4)–(7).\nVarious tests of type FH1 have been performed on both\nCTs. Three amplitudes, 120%, 100%, and 50%, of the CT’s\nrated value Ir and zero phase angle have been used for the\nfundamental tone. For the fundamental frequency, a value\nof 47 Hz was chosen to avoid interference with the power\nsystem frequency. An amplitude of 10% of the CT’s rated\nvalue, 30 log-spaced frequencies from 2nd to 213th order (i.e.,\nabout 10 kHz) and 13 phase angles from 0 to 2 π have been\nused for the sweeping harmonic tone. For each test waveform,\na sampling frequency of 50 kHz was used and 50 000 points\nacquired (i.e., 1 s). Measurements with each test waveform\nwere repeated ten times.\nA. Current Transformer CT1\nFig. 2 shows the magnitudes of the main diagonal elements\nof the gain matrix G\n+ in (3) for CT1, normalized with the\ngain measured at the fundamental frequency (dotted black\nline), versus the harmonic order, for the three fundamental\nmagnitudes analyzed with a superimposed harmonic of 10%.\nThe maximum deviation between the three operating points\n(∼0.2%) is about one order of magnitude lower than the\ndeclared accuracy class limit. The two curves corresponding\nto I p\n1 = 100% and 120% of Ir are almost coincident. It is also\npossible to observe that due to the effect of stray parameters\nCOLLIN et al.: COMPENSATION OF CTs’ NONLINEARITIES BY TENSOR LINEARIZATION 3845\nFig. 3. CT1: Values of the off-diagonal elements of matrix G+ in p.u. of the rated ratio of the CT versus the harmonic order for the three fundamental\ncurrents considered.\nFig. 4. CT1: Values of the matrix G− in p.u. of the rated ratio of the CT versus the harmonic o rder for the three fundamental currents considered.\n(leakage inductance and coupling capacitances between the\nturns), when the harmonic order increases (above ∼10 kHz),\nthe gain trend is likely to exit from the declared accuracy class.\nFig. 3 shows the magnitudes of the off-diagonal elements of\nthe gain matrix G+ that takes into account the cross coupling\nbetween harmonics of the primary current with harmonics\nof the secondary current of different orders (cross-coupling\ngains) due to the nonlinearities present. The harmonic order is\nlimited to 14, as the values beyond this range are of such small\nmagnitude that they have little effect on the CT response.\nFig. 4 shows the magnitudes of the elements (diagonal and\noff-diagonal) of the gain matrix G\n− that takes into account the\nphase angle dependence between harmonics of different orders\ndue to the nonlinearities present (phase-dependent gains).\nValues greater than 0.3 are marked in the matrix plots.\nFrom Figs. 3 and 4, it is possible to observe the following.\n1) The main coupling is between the adjacent harmonics\nalong the matrix diagonals; this coupling decreases with\nfrequency (Fig. 3).\n2) The coupling for I p\n1 = 50% is slightly higher but there is\nnot a large difference between the three working points.\n3) The values of such gains (Fig. 3) are about three orders\nof magnitude lower than those of the main diagonal\n(Fig. 2), demonstrating an overall linear behavior of\nthe CT.\n4) The phase dependence (Fig. 4) is almost negligible,\nas the elements of the matrix G− are about one order of\nmagnitude lower than those of G+, except for the second\nFig. 5. CT1: Exemplar magnitudes ﬁrs t ﬁve harmonic orders of the secondary\ncurrent for the 12 phase angle considered in the tests.\non itself (primary versus secondary) and on the third and\nfourth harmonics.\nThe cross coupling and the pha se dependence modeled by the\nmatrices G+ and G− can be better appreciated in Fig. 5, which\nreports the magnitudes of the ﬁrst ﬁve harmonic orders of the\nprimary I\np and secondary current Is observed for the 12 phase\nangles considered during an FH1 test with 100% fundamental\ntone and 10% second harmonic.\n3846 IEEE TRANSACTIONS ON INSTRUMENTATION AND MEASUREMENT, VOL. 68, NO. 10, OCTOBER 2019\nFig. 6. CT2: Values of the main diagonal elements of the matrix G+ in p.u.\nof the rated ratio of the CT.\nWhen the (approximately) constant second-order harmonic\nis superimposed on the primary side fundamental component\nI p [Fig. 5(a)], the other harmonics are almost nil [Fig. 5(c)],\ndemonstrating the very good performance of the generation\nsystem.\nHowever, the second-order harmonic on the secondary side\nIs [Fig. 5(b)] is shifted up by 1 · 10−3 p.u. (c.f. the gain\non Fig. 2 at the second-harmonic order) and oscillates with\nan amplitude of about 1 · 10\n−3 p.u. due to the phase angle\ndependence on itself (1 .2 · 10−3 p.u. in the corresponding\nsquare of Fig. 4). The cross-coupling effect is evident around\nthe third–ﬁfth harmonics [Fig. 5(d)], which show amplitudes\ncomparable to the corresponding gain values of Fig. 3, with\noscillations with amplitudes c omparable to the corresponding\ngain values of Fig. 4.\nB. Current Transformer CT2\nFigs. 6, 7, and 8 are equivalent to Figs. 2, 3, and 4.\nFrom Fig. 6, it is possible to observe that the values of\nthe main diagonal elements of the matrix G\n+ increase with\nfrequency, showing a possible resonance at frequencies over\n10 kHz. Moreover, for a primary current of 50% of the rated\ncurrent, the gain exits from the accuracy class (i.e., it exceeds\n1.005 p.u.) around the 120th harmonic order (i.e., around\n5.7 kHz). From Fig. 8, it is evident that CT2 exhibits a similar\ntrend to CT1, i.e., the main c oupling is between the adjacent\nharmonics along the matrix diagonals, this coupling decreases\nwith frequency and the values obtained for the three operating\npoints are similar, despite the difference in the main diagonal\nresponse. However, the magnitudes of the matrix elements are\nsmaller than those of CT1; comparing Figs. 3 and 7, it is\nseen that values in Fig. 7 are almost half the magnitude of\nthose in Fig. 3. Concerning the phase dependence (Fig. 8),\nit is evident that it is almost negligible, except for the second\nharmonic on itself.\nV. V\nERIFICATION BY MEANS OF RANDOM SIGNALS\nAn experimental case study using 100 synthetic waveforms\napplied to the CTs was used to assess the performance of the\ncompensation matrixes derived. The waveforms consist of a\nfundamental tone I p = 100% of Ir and harmonics across the\nentire frequency range considered; however, the total harmonic\ndistortion (THD) is ﬁxed at 10% and the harmonic magnitudes\nand phase are randomly allocated based on this constraint.\nThree different ratio and phase errors have been compared:\na) those calculated with (10) and (11), i.e., using the FCM\napproach; b) those calculated with (8) and (9) i.e., with a\nconstant ratio (CR) measured at fundamental frequency; and c)\nthose calculated with (10) and (11) but using only the inverse\nof the elements of the main diagonal of G\n+ (DR+), of the\nderived matrix, to compensate the secondary current. The DR+\nmethod is equivalent to using a linear model for the CT, which\nmakes use of a complex gain variable with frequency [see Figs.\n2 and 6], to compensate the secondary current.\nA. Current Transformer CT1\nThe results in Figs. 9 and 10 show the ratio and phase\nerrors [see (8)–(11)] versus the harmonic order for CT1 using\nthe three different methods considered by means of boxplots.\nFor each box, the central mark is the median, the edges of the\nbox are the 25th and 75th percentiles, and the whiskers extend\nto the most extreme data points ( ±2.7σ and 99.3% coverage\nif the data are normally distributed) not considering outliers.\nThe declared accuracy class borders ( ±1% and ±1.8 crad) are\nalso marked.\nIt is possible to observe the following.\n1) The proposed FCM method accurately compensates the\nnonlinearities of the CT for the entire considered fre-\nquency range, maintaining both ratio and phase errors\nwithin one accuracy class below the declared value.\n2) The CR and DR\n+ approaches, as they assume a linear\nmodel for the CT, are not able to compensate the\nnonlinearities, which are responsible for the very high\namplitude of the whiskers, especially at low frequencies.\n3) The ratio error of the CR approach is outside the\naccuracy class for the ﬁrst four harmonics (around ±5%\nat the third harmonic) and reaches the lower boundary\nof the accuracy class at the end of the frequency range\nconsidered.\n4) The phase error of the CR approach is outside the\naccuracy class for the ﬁrst two harmonics and also exits\nthe lower border boundary around the 95th harmonic\n(4.5 kHz).\n5) The ratio and phase errors of the DR\n+ approach are\nsimilar to those of the CR approach but, after the ﬁfth\nharmonic, they remain within the declared accuracy\nclass range as, unlike the CR method, the DR+ approach\nevaluates the ratio and phase errors using a complex gain\nvariable with frequency.\nB. Current Transformer CT2\nFigs. 11 and 12 are equivalent to Figs. 9 and 10 but for CT2.\nThe declared accuracy class borders ( ±0.5% and ±0.9 crad)\nare also marked. It is possible to observe the following.\nCOLLIN et al.: COMPENSATION OF CTs’ NONLINEARITIES BY TENSOR LINEARIZATION 3847\nFig. 7. CT2: Values of the off-diagonal elements of the matrix G+ in p.u. of the rated ratio of the CT versus the harmonic order for the three fundamental\ncurrents considered.\nFig. 8. CT2: Values of the matrix G− in p.u. of the rated ratio of the CT versus the harmonic o rder for the three fundamental currents considered.\nFig. 9. CT1: Ratio error evaluated at rated current Ir with FCM, CR, and\nDR+ versus the harmonic order.\n1) Again, the FCM method allows the CT to remain in the\ndeclared accuracy class for the entire frequency range\nof interest.\n2) The CR and DR + approaches are not able to compensate\nthe CT nonlinearities.\n3) The ﬁrst two harmonics are largely outside from\nthe declared class limit for both the CR and DR +\nFig. 10. CT1: Phase angle error evaluated at rated current Ir with FCM,\nCR, and DR + versus the harmonic order.\napproaches, with values up to ±3.5% ratio error and\n±3.5 crad phase error observed for the second and third\nharmonics.\n4) The CR approach also exits from the class accuracy\nat the highest frequency, i.e., 10 kHz, analyzed in this\npaper; however, unlike CT1, the phase error of the higher\norder harmonics is maintained within the accuracy class.\n3848 IEEE TRANSACTIONS ON INSTRUMENTATION AND MEASUREMENT, VOL. 68, NO. 10, OCTOBER 2019\nFig. 11. CT2: Ratio error evaluated at rated current Ir with FCM, CR, and\nDR+ versus the harmonic order.\nFig. 12. CT2: Phase angle error evaluated at rated current Ir with FCM,\nCR, and DR + versus the harmonic order.\n5) Similar to comment 5) in Section V .A, DR + performs\nbetter than CR, allowing the ratio and phase error\nto remain within the declared accuracy class for the\nfrequency range of interest, beyond the fourth harmonic\norder.\nVI. C\nONCLUSION\nThis paper has presented a new approach for the compensa-\ntion of the nonlinearities of a CT by modeling its complex ratio\nusing a frequency domain model based on the FCM approach\nand tensor linearization.\nAn accurate measurement setup has been built to character-\nize CTs performance in distorted conditions up to 10 kHz. Two\ncommercial CTs belonging to two different accuracy classes\nhave been characterized and modeled.\nThe proposed compensation technique has been applied to\nthe two CTs using a set of 100 random signals.\nThe main outcomes of this paper are as follows.\n1) It provides a methodology to test a CT and to analyze its\nnonlinearity, quantifying the cross-coupling effects and\nthe phase dependence between primary and secondary\ncurrent harmonics of different orders.\n2) It proposes a new compensation technique that allows a\nCT to maintain its accuracy class, or to improve it, for\nevery kind of distorted primary current and in a wide\nfrequency range, up to several kilohertz.\n3) The computational load of the proposed approach is low\nsince it consists of simple summations and multiplica-\ntions between real numbers.\n4) This compensation techni que can be easily implemented\neven on low-cost power and power quality measuring\ninstruments, typically ch aracterized by low computa-\ntional performance, thus improving their accuracy in a\nwide frequency range.\n5) As the proposed methodology is fully digital, it can\nbe easily implemented in IEDs (Intelligent Electronic\nDevices, e.g. merging units and digital relays) [24], [25],\nwhich are key components of the new digital substations,\nto improve the performance of both measuring, as well\nas protection devices.\nA\nCKNOWLEDGMENT\nThe paper was prepared at the SUN-EMC Laboratory,\nUniversity of Campania “Luigi Vanvitelli,” Aversa (CE), Italy.\nREFERENCES\n[1] A. Cataliotti, D. Di Cara, A. E. Emanuel, and S. Nuccio, “Current\ntransformers effects on the measurement of harmonic active power in LV\nand MV networks,”IEEE Trans. Power Del., vol. 26, no. 1, pp. 360–368,\nJan. 2011.\n[2] A. Cataliotti, D. Di Cara, A. E. Emanuel, and S. Nuccio, “A novel\napproach to current transformer characterization in the presence of\nharmonic distortion,” IEEE Trans. Instrum. Meas. , vol. 58, no. 5,\npp. 1446–1453, May 2009.\n[3] M. Faifer, C. Laurano, R. Ottoboni, S. Toscani, and M. Zanoni, “Char-\nacterization of voltage instrument transformers under nonsinusoidal\nconditions based on the best linear approximation,”IEEE Trans. Instrum.\nMeas., vol. 67, no. 10, pp. 2392–2400, Oct. 2018.\n[4] T. Lei et al., “Behavior of voltage transformers under distorted condi-\ntions,” in Proc. IEEE Int. Instrum. Meas. Technol. Conf., May 2016,\npp. 1–6.\n[5] M. Faifer, C. Laurano, R. Ottoboni, S. Toscani, and M. Zanoni,\n“A simple method for compensating the harmonic distortion introduced\nby voltage transformers,” in Proc. 9th Int. Workshop Appl. Meas. Power\nSyst. (AMPS), Sep. 2018, pp. 1–6.\n[6] A. Cataliotti et al., “Compensation of nonlinearity of voltage and current\ninstrument transformers,” IEEE Trans. Instrum. Meas., to be published.\n[7] N. Locci and C. Muscas, “Hysteresis and eddy currents compensation\nin current transformers,” IEEE Trans. Power Del., vol. 16, no. 2,\npp. 154–159, Apr. 2001.\n[8] M. Zou, W. Sima, M. Yang, L. Li, Q. Yang, and P. Sun, “Improved low-\nfrequency transformer model based on J iles-Atherton hysteresis theory,”\nIET Gener., Transmiss. Distrib., vol. 11, no. 4, pp. 915–923, 2017.\n[9] X. Wang, D. W. P. Thomas, M. Sumner, J. Paul, and S. H. L. Cabral,\n“Characteristics of Jiles-Therton model parameters and their application\nto transformer inrush current simulation,” IEEE Trans. Magn., vol. 44,\nno. 3, pp. 340–345, Mar. 2008.\n[10] J. Arrillaga, B. C. Smith, N. R. Watson, and A. R. Wood, Power System\nHarmonic Analysis. Hoboken, NJ, USA: Wiley, 1997.\n[11] B. C. Smith, N. R. Watson, A. R. Wood, and J. Arrillaga, “Harmonic\ntensor linearisation of HVDC converters,” IEEE Trans. Power Del.,\nvol. 13, no. 4, pp. 1244–1250, Oct. 1998.\n[12] Y . Sun, G. Zhang, W. Xu, and J. G. Mayordomo, “A harmonically\ncoupled admittance matrix model for AC/DC converters,” IEEE Trans.\nPower Syst., vol. 22, no. 4, pp. 1574–1582, Nov. 2007.\n[13] R. Carbone, A. L. Schiavo, P. Marino, and A. Testa, “Frequency coupling\nmatrixes for multi stage conversion system analysis,” Eur. Trans. Elect.\nPower, vol. 12, no. 1, pp. 17–24, Jan./Feb. 2002.\nCOLLIN et al.: COMPENSATION OF CTs’ NONLINEARITIES BY TENSOR LINEARIZATION 3849\n[14] P. W. Lehn and K. L. Lian, “Frequency coupling matrix of a voltage-\nsource converter derived from piecewise linear differential equations,”\nIEEE Trans. Power Del., vol. 22, no. 3, pp. 1603–1612, Jul. 2007.\n[15] L. Frater, “Light ﬂicker and harmonic modelling of electrical light-\ning,” Ph.D. dissertati on, Dept. Elect. Comput. Eng., Univ. Canterbury,\nChristchurch, New Zealand, 2015.\n[16] M. F. Romero, L. E. Gallego, S. Müller, and J. Meyer, “Characterization\nof non-linear household loads for frequency domain modeling,” Ing.\nInvest., vol. 35, pp. 65–72, Dec. 2015.\n[17] M. Fauri, “Harmonic modelling of non-linear load by means of crossed\nfrequency admittance matrix,” IEEE Trans. Power Syst., vol. 12, no. 4,\npp. 1632–1638, Nov. 1997.\n[18] R. Langella et al., “On the use of Fourier descriptors for the assessment\nof frequency coupling matrices of power electronic devices,” in Proc.\n18th Int. Conf. Harmon. Qual. Power (ICHQP), Ljubljana, Slovenia,\nMay 2018, pp. 1–6.\n[19] J. E. Caicedo, A. A. Romero, H. C. Zini, R. Langella, J. Meyer, and\nN. R. Watson, “Impact of referenc e conditions on the frequency cou-\npling matrix of a plug-in electric vehicle charger,” in Proc. 18th Int.\nConf. Harmon. Qual. Power (ICHQP), Ljubljana, Slovenia, May 2018,\npp. 1–6.\n[20] D. Gallo, R. Langella, M. Luiso, A. Testa, and N. R. Watson, “A\nnew test procedure to measure power electronic devices’ frequency\ncoupling admittance,” IEEE Trans. Instrum. Meas., vol. 67, no. 10,\npp. 2401–2409, Oct. 2018.\n[21] A. J. Collin, A. D. Femine, D. Gallo, R. Langella, and M. Luisa,\n“Compensation of current transformers’ non-linearities by means of\nfrequency coupling matrices,” in Proc. IEEE 9th Int. Workshop Appl.\nMeas. Power Syst. (AMPS), Sep. 2018, pp. 1–6.\n[22] G. Crotti, D. Gallo, D. Giordano, C. Landi, and M. Luiso, “Industrial\ncomparator for smart grid sensor calibration,” IEEE Sensors J., vol. 17,\nno. 23, pp. 7784–7793, Dec. 2017.\n[23] G. Crotti et al., “Calibration of current transformers in distorted condi-\ntions,” J. Phys., Conf. Ser., vol. 1065, no. 5, 2018, Art. no. 052033. doi:\n10.1088/1742-6596/1065/5/052033.\n[24] Communication Networks and Systems for Power Utility Automation -\nPart 1: Introduction and Overview, document ITU 61850-1, 2013.\n[25] S. D. Prete, A. D. Femine, D. Ga llo, C. Landi, and M. Luiso, “Imple-\nmentation of a distributed stand alone merging unit,” J. Phys., Conf. Ser.,\nvol. 1065, no. 5, 2018, Art. no. 052042.\nAdam J. Collin (S’10–M’12) was born in Edin-\nburgh, Scotland, in 1985. He received the B.Eng.\ndegree in electrical and electronic engineering from\nthe University of Edinburgh, in 2007, the M.Sc.\ndegree in renewable energy and distributed gen-\neration from Heriot-Watt University, in 2008 and\nthe Ph.D. degree from the University of Edinburgh,\nin 2013.\nHe is currently a Researcher with the University\nof Campania “Luigi Vanvitelli,” Aversa, Italy. His\ncurrent research interests include power system har-\nmonics, load modeling, and distribution system analysis.\nAntonio Delle Femine (S’18–M’19) was born in\nCaserta, Italy, in 1980. He received the M.Sc. degree\n(summa cum laude)in electronic engineering and the\nPh.D. degree in electrical energy conversion from the\nUniversity of Campania “Luigi Vanvitelli,” Aversa\n(CE), Italy, in 2005 and 2008, respectively.\nFrom 2008 to 2017, he was a Freelancer with many\nnational and international companies. He worked\nas Software Engineer, Senior Embedded Firmware\nEngineer, Hardware Engineer, and Project Manager.\nHe was involved in the design of many products for\nboth industrial and consumer electronics: ﬂeet monitoring systems, thermal\nprinters, electronic scales and cash registers, distributed monitoring systems\nfor photovoltaic plants, Hi-Fi radios an d home appliances, automatic end-of-\nline testing systems, augmented reality devices, and radioactivity measurement\ninstrumentation (in collaboration with national institute of nuclear physics,\nINFN). In 2018, he joined the University of Campania “Luigi Vanvitelli” as a\nResearcher. His current research interests include the power measurement the-\nory, the design, implementation and characterization of digital-measurement\ninstrumentation of automatic measurement systems, and the radioactivity\nmeasurements.\nDr. Femine is a member of the IEEE Instrumentation and Measurement\nSociety.\nDaniele Gallo (S’00–M’04) was born in Santa\nMaria C. V . (CE), Italy, in 1974. He received the\nLaurea degree in electronic engineering and the\nPh.D. degree in electrical energy conversion from\nUniversity of Campania “Luigi Vanvitelli,” Aversa\n(CE), Italy, in 1999 and 2003, respectively.\nHe is currently an Associate Professor with the\nUniversity of Campania “Luigi Vanvitelli.” He has\nauthored or coauthored more than 130 papers pub-\nlished in books, international scientiﬁc journals, and\nconference proceedings. His current research inter-\nests include design, implementation, and characterization of measurement\nsystems for electrical power system, power quality issues, power and energy\nmeasurement in nonsinusoidal conditions, design and implementation of smart\nmeter for smart grid application, and electrical transducer characterization.\nRoberto Langella(S’00–M’01–SM’10) was born in\nNaples, Italy, in 1972. He received the Laurea degree\nin electrical engineering from the University of\nNaples, Naples, Italy, in 1996, and the Ph.D. degree\nin electrical energy conversion from the University\nof Campania L. Vanvitelli, Aversa, Italy, in 2000.\nHe is currently a Full Professor of electrical power\nsystems with the University of Campania L. Van-\nvitelli. He is a Senior Member of the IEEE Power\nEngineering Society, Vice Chair of the IEEE PES\nItaly Section, and Chair of the IEEE PES Task Force\non Harmonic Modeling, Simulation, and Assessment.\nMario Luiso(S’07–M’08) was born in Naples, Italy,\nin 1981. He received the Laurea degree (summa cum\nlaude) in electronic engineering and the Ph.D. degree\nin electrical energy conversion from the University\nof Campania “Luigi Vanvitelli,” Aversa (CE), Italy,\nin 2005 and 2007, respectively.\nHe currently is an Associate Professor with the\nDepartment of Engineering, University of Campania\n“Luigi Vanvitelli.” He has authored or co-authored\nmore than 150 papers published in books, interna-\ntional scientiﬁc journals, a nd conference proceed-\nings. His current research interests include the development of innovative\nmethods, sensors and instrumentation for power system measurements, in par-\nticular power quality, calibration of instrument transformers, phasor measure-\nment units, and smart meters.\nDr. Luiso is a member of the IEEE Instrumentation and Measurement\nSociety.",
  "topic": "Linearization",
  "concepts": [
    {
      "name": "Linearization",
      "score": 0.7176382541656494
    },
    {
      "name": "Current transformer",
      "score": 0.6816259622573853
    },
    {
      "name": "Total harmonic distortion",
      "score": 0.6432538032531738
    },
    {
      "name": "Nonlinear distortion",
      "score": 0.6232863664627075
    },
    {
      "name": "Control theory (sociology)",
      "score": 0.5626484751701355
    },
    {
      "name": "Nonlinear system",
      "score": 0.5579001307487488
    },
    {
      "name": "Distortion (music)",
      "score": 0.5122734904289246
    },
    {
      "name": "Electronic engineering",
      "score": 0.46840402483940125
    },
    {
      "name": "Compensation (psychology)",
      "score": 0.4680124521255493
    },
    {
      "name": "Transformer",
      "score": 0.4446236491203308
    },
    {
      "name": "Harmonic analysis",
      "score": 0.4422307014465332
    },
    {
      "name": "Engineering",
      "score": 0.32095515727996826
    },
    {
      "name": "Computer science",
      "score": 0.3027946352958679
    },
    {
      "name": "Voltage",
      "score": 0.26774030923843384
    },
    {
      "name": "Physics",
      "score": 0.17151865363121033
    },
    {
      "name": "Electrical engineering",
      "score": 0.153221994638443
    },
    {
      "name": "Amplifier",
      "score": 0.07246127724647522
    },
    {
      "name": "CMOS",
      "score": 0.0
    },
    {
      "name": "Psychoanalysis",
      "score": 0.0
    },
    {
      "name": "Psychology",
      "score": 0.0
    },
    {
      "name": "Quantum mechanics",
      "score": 0.0
    },
    {
      "name": "Artificial intelligence",
      "score": 0.0
    },
    {
      "name": "Control (management)",
      "score": 0.0
    }
  ]
}