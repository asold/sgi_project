{
    "title": "Bidirectional de novo peptide sequencing using a transformer model",
    "url": "https://openalex.org/W4392242910",
    "year": 2024,
    "authors": [
        {
            "id": "https://openalex.org/A2261094106",
            "name": "Sang-Jeong Lee",
            "affiliations": [
                "Korea Institute of Science & Technology Information"
            ]
        },
        {
            "id": "https://openalex.org/A2239728134",
            "name": "Hyunwoo Kim",
            "affiliations": [
                "Korea Institute of Science & Technology Information"
            ]
        },
        {
            "id": "https://openalex.org/A2261094106",
            "name": "Sang-Jeong Lee",
            "affiliations": []
        },
        {
            "id": "https://openalex.org/A2239728134",
            "name": "Hyunwoo Kim",
            "affiliations": []
        }
    ],
    "references": [
        "https://openalex.org/W2091375086",
        "https://openalex.org/W1995693931",
        "https://openalex.org/W1971887998",
        "https://openalex.org/W2095650214",
        "https://openalex.org/W2089273345",
        "https://openalex.org/W2028673251",
        "https://openalex.org/W2544360569",
        "https://openalex.org/W2038615001",
        "https://openalex.org/W752259472",
        "https://openalex.org/W2736859409",
        "https://openalex.org/W2064675550",
        "https://openalex.org/W2157331557",
        "https://openalex.org/W3136924813",
        "https://openalex.org/W4210902118",
        "https://openalex.org/W4386327798",
        "https://openalex.org/W6739901393",
        "https://openalex.org/W4361279726",
        "https://openalex.org/W2917049097",
        "https://openalex.org/W2935811960",
        "https://openalex.org/W2548763820",
        "https://openalex.org/W2575647550",
        "https://openalex.org/W2512489438",
        "https://openalex.org/W2566894387",
        "https://openalex.org/W2534610127",
        "https://openalex.org/W2561019872",
        "https://openalex.org/W2565502474",
        "https://openalex.org/W2461971948",
        "https://openalex.org/W2531537628",
        "https://openalex.org/W2802342298",
        "https://openalex.org/W3011311414",
        "https://openalex.org/W3025095871",
        "https://openalex.org/W3043208496",
        "https://openalex.org/W4385245566",
        "https://openalex.org/W4387773470",
        "https://openalex.org/W2999635570",
        "https://openalex.org/W4376618222"
    ],
    "abstract": "In proteomics, a crucial aspect is to identify peptide sequences. De novo sequencing methods have been widely employed to identify peptide sequences, and numerous tools have been proposed over the past two decades. Recently, deep learning approaches have been introduced for de novo sequencing. Previous methods focused on encoding tandem mass spectra and predicting peptide sequences from the first amino acid onwards. However, when predicting peptides using tandem mass spectra, the peptide sequence can be predicted not only from the first amino acid but also from the last amino acid due to the coexistence of b -ion (or a - or c -ion) and y -ion (or x - or z -ion) fragments in the tandem mass spectra. Therefore, it is essential to predict peptide sequences bidirectionally. Our approach, called NovoB, utilizes a Transformer model to predict peptide sequences bidirectionally, starting with both the first and last amino acids. In comparison to Casanovo, our method achieved an improvement of the average peptide-level accuracy rate of approximately 9.8% across all species.",
    "full_text": "RESEA RCH ARTICL E\nBidirectional de novo peptide sequencing\nusing a transformer model\nSangjeong Lee, Hyunwoo Kim\nID\n*\nCenter for Biomedic al Computing, Korea Institute of Science and Technolo gy Informatio n, Daejeon, Republic\nof Korea\n* pardess@ kisti.re.kr\nAbstract\nIn proteomics, a crucial aspect is to identify peptide sequences. De novo sequencing meth-\nods have been widely employed to identify peptide sequences, and numerous tools have\nbeen proposed over the past two decades. Recently, deep learning approaches have been\nintroduced for de novo sequencing. Previous methods focused on encoding tandem mass\nspectra and predicting peptide sequences from the first amino acid onwards. However,\nwhen predicting peptides using tandem mass spectra, the peptide sequence can be pre-\ndicted not only from the first amino acid but also from the last amino acid due to the coexis-\ntence of b-ion (or a- or c-ion) and y-ion (or x- or z-ion) fragments in the tandem mass\nspectra. Therefore, it is essential to predict peptide sequences bidirectionally. Our\napproach, called NovoB, utilizes a Transformer model to predict peptide sequences bidirec-\ntionally, starting with both the first and last amino acids. In comparison to Casanovo, our\nmethod achieved an improvement of the average peptide-level accuracy rate of approxi-\nmately 9.8% across all species.\nAuthor summary\nUnderstanding the characteristics of data is very important in deep learning methods.\nWhen predicting sentences, the transformer model naturally predicts from the first word.\nFor this reason, previous methods predicted peptide sequences from the first amino acid.\nHowever, in tandem mass spectra, it is possible to predict peptide sequences bidirection-\nally. This method shows better results than previous approaches because it can better\nencode tandem mass spectra. We have demonstrated that good results can be achieved\nsimply by understanding the characteristics of such data and using the model appropri-\nately. We hope that this paper will help various readers improve the performance capabili-\nties of their models. Furthermore, given that bidirectional peptide sequence prediction is\ncrucial in de novo peptide sequence analysis, we hope that this approach will be applied to\nboth existing and future methods utilizing deep learning techniques.\nPLOS COMP UTATIONAL  BIOLOGY\nPLOS Computationa l Biology | https:/ /doi.org/10.13 71/journal.p cbi.1011892 February 28, 2024 1 / 12\na1111111111\na1111111111\na1111111111\na1111111111\na1111111111\nOPEN ACCESS\nCitation: Lee S, Kim H (2024) Bidirectiona l de novo\npeptide sequenci ng using a transform er model.\nPLoS Comput Biol 20(2): e1011892. https://do i.\norg/10.1371 /journal.pcbi.10 11892\nEditor: Wout Bittremieux, Univers ity of Antwerp,\nBELGIUM\nReceived: October 18, 2023\nAccepted: February 2, 2024\nPublished: February 28, 2024\nCopyright: © 2024 Lee, Kim. This is an open\naccess article distributed under the terms of the\nCreative Commons Attribution License, which\npermits unrestricte d use, distribu tion, and\nreproduction in any medium, provided the original\nauthor and source are credited.\nData Availabilit y Statement: NovoB is available at\nhttps://github .com/Prote omeTeam/Nov oB. MS/MS\ndata are publicly available from https://ww w.ebi.ac.\nuk/pride/arc hive/ using PXD004 948, PXD00442 4,\nPXD0038 68, PXD004 325, PXD004467 ,\nPXD0049 47, PXD005 025, PXD004565 , and\nPXD0045 36 (see Table A in S1 Text). Additional ly,\nPXD0061 09, PXD016 315, PXD013233 , and\nPXD0160 01 are available (see Table B in S1 Text).\nAll data are available for download at https:// doi.\norg/10.5281 /zenodo.102588 74.\nFunding: This work was supported by a grant from\nthe National Research Foundation of Korea (NRF)\nIntroduction\nIn proteomics, the identification of peptide sequences is of paramount importance. To identify\npeptide sequences, proteins are initially digested to peptide fragments. Subsequently, tandem\nmass spectra are generated by the digested peptides [1]. The generated tandem mass spectra\nare then utilized for peptide sequence identification.\nThe two most widely used methods for identifying peptide sequences in proteomics are de\nnovo sequencing and a database search [2–7]. De novo sequencing relies on the unique charac-\nteristics of tandem mass spectra to determine peptide sequences. On the other hand, the data-\nbase search method involves searching for the most similar peptide sequences in a database\nusing the tandem mass spectra to identify peptide sequences. The database search method is\nfast and accurate when used to identify peptide sequences that already exist in a database, but\nit is limited in its ability to identify peptide sequences that are not present in a protein database.\nTherefore, de novo sequencing becomes essential when identifying peptide sequences that are\nnot in a protein database or when dealing with peptide sequences for which a suitable protein\ndatabase is unavailable.\nOver the past two decades, several tools, such as PepNovo [8], PEAKS [3], and Novor [9],\nhave been proposed for de novo sequencing. More recently, there has been growing interest in\nutilizing deep learning techniques for de novo sequencing. DeepNovo [10] introduced a\nmethod that combines a convolutional neural network (CNN) and a recurrent neural network\n(RNN) [11,12] achieving superior results compared to methods that do not use deep learning\nacross various species. Building on the progress made by DeepNovo, the same research team\nproposed PointNovo [13], which offers a faster and more accurate approach for high-resolu-\ntion tandem mass spectra compared to DeepNovo. Furthermore, Casanovo [14] and Insta-\nNovo [15], which use a Transformer model [16] of the type generally used for natural language\nprocessing, were also proposed\n13\n. Recently, BiATNovo [17] and GraphNovo [18] were sug-\ngested. BiATNovo employ a combination of a CNN and an attention function, and Graph-\nNovo uses a combination of a graph neural network (GNN) [19] and an attention function.\nBiATNovo utilizes a bidirectional peptide sequencing method as a way to solve the output\nunbalance and deviation accumulation phenomenon caused by one-way predictions in exist-\ning de novo sequencing methods. The GraphNovo model was proposed to address the missing\nfragmentation problem by means of a two-step analysis. This model uses graph neural net-\nworks to not only resolve the missing fragmentation problem but also to predict peptides\neffectively.\nMost previous methods focused on the encoding of tandem mass spectra and predictions of\npeptide sequences from the first amino acid onwards. However, when predicting peptides\nusing tandem mass spectra, the peptide sequence can be predicted not only from the first\namino acid but also from the last amino acid owing to the coexistence of b-ion (or a- or c-ion)\nand y-ion (or x- or z-ion) fragments in tandem mass spectra. Therefore, it is essential to predict\npeptide sequences bidirectionally. DeepNovo uses two separate sets (forward and backward)\nof parameters for bidirectional sequencing. BiATNovo employs bidirectional synchronous\nprediction, inspired by the bidirectional synchronous generation of natural language [20,21],\nfor efficient predictions of the amino acid at a specific position in the middle using the forward\nand backward prediction sequences.\nOur method is similar to existing methods that use a Transformer model, but it predicts the\npeptide sequence more accurately than these methods by modifying a total of three parts. First,\nfor the encoder, the precursor mass, charge, m/z, and intensity were used as input values. Sec-\nond, for the decoder, the residual mass is additionally concatenated and used while predicting\namino acids. Third, the key feature of our approach is the bidirectional prediction of peptide\nPLOS COMP UTATIONAL  BIOLOGY\nNovoB\nPLOS Computationa l Biology | https:/ /doi.org/10.13 71/journal.p cbi.1011892 February 28, 2024 2 / 12\nfunded by the Korean Ministry of Science and ICT\n(No. 2021M3H 9A2030520 and RS-2023 -\n00263899 ). The funders had no role in study\ndesign, data collection and analysis, decision to\npublish, or preparation of the manuscript.\nCompeting interests : The authors have declared\nthat no competing interests exist.\nsequences, which is achieved using two decoders. This means that we predict peptide\nsequences from both the first and last amino acid using two decoders in the single model. Our\nmethod demonstrated an average peptide-level accuracy improvement of approximately 9.8%\nover Casanovo across all species. Moreover, it outperformed DeepNovo by 17.4% and Point-\nNovo by 11.1% in terms of the peptide-level accuracy.\nDatasets and evaluation metric\nWe used nine datasets acquired from Thermo Scientific Q-Exactive with HCD peptide frag-\nmentation [22–30]. These datasets were first used in the DeepNovo paper and then used\nequally in PointNovo and Casanovo. The species tested were Mouse, Human, Yeast, M. mazei,\nHoneybee, Tomato, Rice bean, Bacillus, and Clam bacteria (Table A in S1 Text). For these\ndatasets, the PEAKS DB was run, with fixed modification of the carbamidomethylation of cys-\nteine (C) and variable modifications of the oxidation of methionine (M) and deamidation of\nasparagine (N) and glutamine (Q).\nWe used data from the nine species (Mouse, Human, Yeast, M. mazei, Honeybee, Tomato,\nRice bean, Bacillus, Clam bacteria) in Table A in S1 Text and used the existing leave-one-out\ncross-validation method for comparison. This method uses eight species to learn and one spe-\ncies to verify. We compared the amino acid and peptide-level accuracy rates of the proposed\nmethod with DeepNovo, PointNovo, and Casanovo (Fig 1 and Table C in S1 Text). We used\nthe same evaluation metric adopted by PointNovo and Casanovo when calculating the amino\nacid and peptide-level accuracy rates. The amino acid-level accuracy is N\nmatch\n/N\npredict\n, where\nN\nmatch\nis the number of predicted amino acids matching actual amino acids and N\npredict\nis the\nnumber of predicted amino acids. A predicted amino acid matches a real amino acid if their\nmass difference is smaller than 0.1Da and if the prefix masses before them are different by less\nthan 0.5Da. The peptide-level accuracy is N\nmatch\n/N\npredict\n, where N\nmatch\nis the number of pre-\ndicted peptides matching actual peptides and N\npredict\nis the number of predicted peptides.\nResult\nBidirectional prediction\nA tandem mass spectrum may contain both types (e.g., b-ion and y-ion) of fragments, and\nsometimes only one type of ion, but the methods proposed thus far only predict peptide\nsequences in one direction. NovoB selects a peptide sequence with a higher probability by pre-\ndicting both forward and reverse peptide sequences using two decoders. As shown in Fig 1, we\ncompared the accuracy of the prediction results in the three cases (when only the forward pep-\ntide sequence is predicted, when only the reverse peptide sequence is predicted, and when a\npeptide sequence with a high probability is selected between the forward and reverse peptide\nsequences).\nCompared to other models, the forward peptide-level accuracy of NovoB increased by\napproximately 12.2% (DeepNovo), 5.9% (PointNovo), and 4.6% (Casanovo) on average. The\nreverse peptide-level accuracy of NovoB increased by approximately 12.1 (DeepNovo), 5.8%\n(PointNovo), 4.4% (Casanovo) on average. The peptide-level accuracy of NovoB is improved\non average compared to the three models, regardless of the forward and reverse peptide-level\naccuracy outcomes. Furthermore, when compared to the other models, the forward amino\nacid-level accuracy of NovoB decreased by approximately 0.8% for DeepNovo and 2.2% for\nPointNovo and increased by approximately 17.1% (Casanovo) on average. The reverse amino\nacid-level accuracy of NovoB decreased on average by approximately 3.6% for DeepNovo and\n5.0% for PointNovo, whereas it increased on average by approximately 14.3% for Casanovo.\nPLOS COMP UTATIONAL  BIOLOGY\nNovoB\nPLOS Computationa l Biology | https:/ /doi.org/10.13 71/journal.p cbi.1011892 February 28, 2024 3 / 12\nFor forward and reverse peptide levels, NovoB show higher accuracy for all species com-\npared to DeepNovo and PointNovo, but compared to Casanovo, these peptide accuracy rates\nonly decreased by about 1.5% (forward) and 2.8% (reverse) for mouse. Furthermore, for the\nforward and reverse amino acid levels, NovoB show higher accuracy for all species than Casa-\nnovo. For the forward amino acid level, the accuracy of NovoB compared to DeepNovo\ndecreased for six species (human, yeast, M mazei, honeybee, tomato, and bacillus), and com-\npared to PointNovo, it decreased for seven species (human, yeast, M mazei, honeybee, tomato,\nrice bean, and bacillus). For the reverse amino acid level, the accuracy of NovoB compared to\nDeepNovo and PointNovo decreased for all species.\nHowever, the bidirectional peptide-level accuracy of NovoB increased by approximately\n17.4% (DeepNovo), 11.1% (PointNovo), and 9.8% (Casanovo) on average, and the bidirec-\ntional amino acid-level accuracy increased by approximately 7.9% (DeepNovo), 6.5% (Point-\nNovo), and 25.8% (Casanovo) on average. Casanovo has cases in which the accuracy decreases\ncompared to the peptide-level accuracy of PointNovo for two species (tomato and rice bean),\nwhile the accuracy decreases in all cases of amino acid-level accuracy. However, compared to\nDeepNovo, PointNovo, and Casanovo, NovoB as proposed here shows higher accuracy for\nboth peptide and amino acid-levels across all species.\nWe additionally used GraphNovo’s dataset to compare the peptide and amino acid-level\naccuracy rates of DeepNovo, PointNovo, Casanovo, GraphNovo and NovoB. GraphNovo used\nthe HeLa and Cerebellum datasets for training, the Plasma dataset for validation, and the A.\nthaliana, C. elegans, and E. coli datasets for testing [31–34] (for details, see Table B and Fig B\nin S1 Text). The bidirectional peptide-level accuracy of NovoB increased by approximately\n20.4% (DeepNovo), 8.0% (PointNovo), and 13.3% (Casanovo) on average. When compared to\nFig 1. Compar ison of DeepNovo, PointNovo, Casanov o, NovoB (Forward ), NovoB (Reverse) and NovoB (Bidirection ). These figures show the\npeptide-leve l and amino acid-level accuracy rates of six models on all nine species.\nhttps://doi.o rg/10.1371/j ournal.pcbi. 1011892.g001\nPLOS COMP UTATIONAL  BIOLOGY\nNovoB\nPLOS Computationa l Biology | https:/ /doi.org/10.13 71/journal.p cbi.1011892 February 28, 2024 4 / 12\nGraphNovo, NovoB showed an increase in the peptide-level accuracy for E. coli, though it\nshowed a decrease for A. thaliana and C. elegans. Additionally, the bidirectional amino acid-\nlevel accuracy rates of NovoB increased by approximately 7.6% (DeepNovo), 1.3% (Point-\nNovo), and 22.4% (Casanovo) on average. In comparison to GraphNovo, NovoB presents\nlower accuracy rates across three species.\nResidual mass\nFor the predicted peptide to be the actual correct answer, it must have the precursor mass as\nthe tandem mass spectra within the tolerance limit. However, for Casanovo, as shown in Fig 2,\nonly about 59.8% of the total results predicted the precursor mass within the tolerance level,\nwhile the remaining 39.8% failed to predict the precursor mass within tolerance. Compared to\nthe database search, which selects only peptides corresponding to the precursor mass within\nthe tolerance level, Casanovo has a high rate of not predicting the precursor mass within toler-\nance. To solve this problem, various methods use the knapsack algorithm effectively to address\nprecursor-mass mismatches by ensuring that all sequences match the precursor mass. How-\never, we conducted training while including the residual mass in the decoder input. Conse-\nquently, as shown in Fig 2, approximately 98.6% of the total results predicted the precursor\nmasses within tolerance. That is, only about 1.4% failed to predict the precursor mass within\ntolerance.\nTo evaluate the accuracy against DeepNovo and Casanovo at the same coverage level, we\nmeasured the accuracy-coverage curve and AP (average precision) by applying the coverage of\neach species to NovoB to compare this outcome. Consequently, compared to DeepNovo and\nCasanovo, our approach showed an increase in the AP values (Fig 3).\nAblation study\nWe explored the factors contributing to the enhanced performance of the proposed method\nthrough an ablation study of NovoB (Table 1). We conducted a comparison between scenarios\nwhere the residual mass was included as the decoder input and when it was omitted. This com-\nparison involved cases where only the forward decoder was utilized, where only the reverse\ndecoder was utilized, and where both the forward and reverse decoders were utilized\nFig 2. Compar ison of coverage outcomes between Casanovo and NovoB. These figures are the precursor mass coverag e for all nine species.\nhttps://doi.o rg/10.1371/j ournal.pcbi. 1011892.g002\nPLOS COMP UTATIONAL  BIOLOGY\nNovoB\nPLOS Computationa l Biology | https:/ /doi.org/10.13 71/journal.p cbi.1011892 February 28, 2024 5 / 12\nsimultaneously. We also used the leave-one-out cross-validation method for this comparison,\nwhere we used yeast data to verify and eight species to learn.\nFor peptide-level accuracy, when including the residual mass as the decoder, the input\nincreased by approximately 1.1% (Forward), 2.4% (Reverse), and 3.4% (Bidirection). For the\namino acid-level accuracy, when including the residual mass as the decoder, the input\nFig 3. Accurac y-coverage curve for DeepNovo, Casanovo and NovoB. This figure evaluates peptide-leve l accuracy rates across all coverag es for nine\nspecies. The x-axis represents the peptide-l evel accuracy, while the y-axis denotes the coverage. Additionall y, the AUC value is expressed for each curve.\nhttps://doi.o rg/10.1371/j ournal.pcbi. 1011892.g003\nTable 1. Compariso n between Scenarios with the Inclusion and Exclusion of the Residual Mass as the Decoder Input.\nPeptide -level accuracy Amino acid-level accuracy\nNovoB\n(Forwar d)\nNovoB\n(Reverse)\nNovoB\n(Bidirectio n)\nNovoB\n(Forward)\nNovoB\n(Reverse)\nNovoB\n(Bidirec tion)\nNot including\nresidual mass\n0.590 0.589 0.627 0.685 0.668 0.712\nIncluding\nresidual mass\n0.601 0.613 0.661 0.739 0.712 0.825\nhttps://do i.org/10.1371/j ournal.pc bi.1011892. t001\nPLOS COMP UTATIONAL  BIOLOGY\nNovoB\nPLOS Computationa l Biology | https:/ /doi.org/10.13 71/journal.p cbi.1011892 February 28, 2024 6 / 12\nincreased by approximately 5.4% (Forward), 4.4% (Reverse), and 11.3% (Bidirection). Regard-\ning the peptide and amino acid-level accuracy rates, when the decoder includes the residual\nmass, it shows higher accuracy than when it does not.\nIn particular, when the residual mass was used as the decoder input, approximately 99.5%\nof the results overall predicted the precursor mass within the tolerance level. In contrast, when\nthe residual mass was not used as the decoder input, only about 76.1% of the results in total\npredicted the precursor mass within the tolerance level.\nConclusion and discussion\nOur method, NovoB, utilizes the Transformer model to predict peptide sequences bidirection-\nally. The tandem mass spectrum may contain both b-ion (or a- or c-ion) and y-ion (or x- or z-\nion) fragments, and sometimes only one type of ion. By predicting peptide sequences bidirec-\ntionally, our approach proves to be more effective when used to identify peptide sequences\ncompared to conventional methods. Across all species, our method demonstrates an average\npeptide-level accuracy improvement of approximately 9.8% over Casanovo.\nMethods\nOur method is similar to existing methods that use a Transformer model, but it predicts the\npeptide sequence more accurately than these methods by modifying a total of three parts. First,\nfor the encoder, the precursor mass, charge, m/z, and intensity were used as input values. The\nprecursor mass and m/z were encoded by means of positional encoding. Regarding the charge,\nit was also encoded with positional encoding. For intensity, we used only the integer part by\nmultiplying it by 100 after normalization using the base peak. We concatenated the obtained\nprecursor mass and charge for use as a single vector (only one). Also, the obtained m/z and\nintensity outcomes were concatenated for use as a single vector (according to the number of\npeaks). Second, for the decoder, the residual mass is additionally concatenated and used while\npredicting amino acids. At this time, the residual mass was also encoded using positional\nencoding. Third, the key feature of our approach is its ability to undertake the bidirectional\nprediction of peptide sequences, which is achieved using two decoders. One decoder predicts\nthe forward peptide sequence, while the other predicts the reverse peptide sequence. Unlike\ntraditional Transformer models, which typically predict only forward text as language models,\nit is crucial in de novo peptide sequencing to train the model to predict both forward and\nreverse sequences. This is essential because tandem mass spectra may contain both b-ion (or\na- or c-ion) and y-ion (or x- or z-ion) fragments, or sometimes only one type of ion.\nWith bidirectional peptide sequence predictions, our method can more effectively identify\npeptide sequences compared to conventional approaches. After employing two decoders for\nthe bidirectional peptide sequence prediction, we select the peptide sequence with the higher\nprobability as the final prediction.\nModel architecture\nOur method uses the Transformer model. Fig A in S1 Text shows the model of NovoB. The\nNovoB model consists of one encoder and two decoders in the Transformer model. The inputs\nof the encoder are the precursor mass, charge, and tandem mass spectrum (m/z and intensity).\nThe inputs of the decoder are the amino acid sequence and the residual mass. The forward\ndecoder predicts the forward peptide sequence, and the reverse decoder predicts the reverse\nsequence. Ultimately, the peptide sequence with a higher probability between those predicted\nby the forward and reverse decoders is selected.\nPLOS COMP UTATIONAL  BIOLOGY\nNovoB\nPLOS Computationa l Biology | https:/ /doi.org/10.13 71/journal.p cbi.1011892 February 28, 2024 7 / 12\nEncoding\nOur method mostly encodes various values. We use positional encoding as used in the Trans-\nformer model for encoding. This is done as shown below.\nE\nk;2ið Þ\n¼ sin k=Max\nk\n2i\nd\n� �\nE\nðk;2iþ1Þ\n¼ cos k=Max\nk\n2i\nd\n� �\nHere, k denotes the values of the precursor mass, charge, m/z, and intensity; i is the dimen-\nsion; Max\nk\nis the max of k; and d is the size of the encoding vector.\nEncoder input\nThe encoder input uses the vector obtained after Start Encoding and Peak Encoding.\nStart Encoding of the encoder\nStart Encoding is used by concatenating the vectors obtained from precursor mass encoding\nand charge encoding.\nPrecursor mass encoding\nWe calculated PM(p) for encoding as follows:\nPM ðpÞ ¼ ðp � reso lut io nÞ\nIn these equations, p is the precursor mass and resolution is the resolution of the tandem\nmass spectra. Considering the tolerance, we used 1,000 for the value of resolution to represent\nup to three decimal places. PM(p) was encoded by means of encoding.\nCharge encoding\nCharge encoding encodes the charge by means of encoding.\nPeak encoding of the encoder\nPeak encoding concatenates the vectors obtained from m/z encoding and intensity encoding.\nm/z encoding\nWe calculated MZ(m/z) for encoding as follows:\nMZ ðm=z Þ ¼ ðm=z � re sol utio nÞ\nHere, m/z is the m/z value and resolution is the resolution of the tandem mass spectra. Con-\nsidering the tolerance, we used 1,000 for the value of resolution to represent up to three decimal\nplaces. MZ(m/z) was encoded by means of Encoding.\nPLOS COMP UTATIONAL  BIOLOGY\nNovoB\nPLOS Computationa l Biology | https:/ /doi.org/10.13 71/journal.p cbi.1011892 February 28, 2024 8 / 12\nIntensity encoding\nOur method also encodes the intensity values. Int\n(I)\nwas calculated as follows:\nSI\nðI Þ\n¼ sqr t ðI Þ\nInt\nðI Þ\n¼ flo or ðSI\nðI Þ\n=base pe ak � 100Þ\nIn these equations, I is the value of the intensity, sqrt is the function that calculates the\nsquare root, floor is the function which truncates the values into integers, and basepeak is the\nmax of SI(I). Int\n(I)\nwas encoded by means of Encoding.\nDecoder input\nThe decoder input is used by amino-acid embedding and residual mass encoding.\nResidual mass encoding\nWe calculated RM(r) for encoding as follows:\nRM ðr Þ ¼ ðr � reso lut ionÞ\nHere, r is the residual mass and resolution is the resolution of the tandem mass spectra.\nConsidering the tolerance, we used 1,000 for the value of resolution to represent up to three\ndecimal places. RM(r) was encoded by means of Encoding.\nHyper parameter\nWe train models with a total of ten encoder and decoder layers. The total size (d) of the input\nvector of the Encoder and Decoder is 64. There are two main types of input vector for the\nEncoder. The vector of start encoding includes information about the precursor mass and\ncharge, and the vector of peak encoding includes information about the m/z and intensity. At\nthis time, the size of the start encoding vector is 64, which is the concatenation value of the\nsizes of the precursor mass encoding vector (60) and the charge encoding vector (4). The max\nvalues of the precursor mass and charge are 8,000 and 20, respectively. In addition, the size of\nthe peak encoding vector is 64, which is the concatenation value of the sizes of the m/z encoding\nvector (60) and the intensity encoding vector (4). The max values of m/z and intensity are 8,000\nand 150, respectively. These vectors (start encoding vector (only one) and peak encoding vector\n(according to the number of peaks)) are utilized as the input vector for the Encoder. The start\nencoding vector (64) = precursor mass (60) + charge (4), the peak encoding vector (64) = m/z\n(60) + intensity (4). Also, the input vector of the Decoder includes information about the\namino acid and residual mass. The size of Decoder input vector is 64, which is the concatena-\ntion value of the size of the residual mass encoding vector (60) and the amino acid embedding\nvector (4). The max value of residual mass is 8,000. The input vector of the Decoder (64) =\namino acid (4) + residual mass (60). The size of the multi-head vectors is 64, and there are\neight heads, yielding a total of ~12M model parameters. NovoB has significantly fewer parame-\nters compared to Casanovo at 47M and DeepNovo at 86M, with the total number of parame-\nters being 12M (not reported for PointNovo). We used a batch size of 256. We used the\nformula below to vary the learning rate during the training process. This method increases the\nlearning rate linearly for the first warmup_steps training step and decreases the learning rate\nproportional to the inverse square root of the number of subsequent steps. Here,\nPLOS COMP UTATIONAL  BIOLOGY\nNovoB\nPLOS Computationa l Biology | https:/ /doi.org/10.13 71/journal.p cbi.1011892 February 28, 2024 9 / 12\nwarmup_steps = 32K.\nlear ning rat e ¼ v\n\u0000 0:5\n� minðsn\n\u0000 0:5\n; sn � ws\n\u0000 1:5\nÞ\nIn this equation, v is the vector size, sn is the number of steps, and ws denote warmup_steps.\nThe model was trained for approximately one day for 30 epochs on a single NVIDIA A100\nGPU, and the model hyperparameters were applied identically in all experiments (Table D in\nS1 Text).\nSupporting information\nS1 Text. NovoB supplementary information.\n(DOCX)\nAcknowledgmen ts\nThis study was supported by the Korea Institute of Science and Technology Information and\nby the Korea Bio Data Station (K-BDS) with computing resources including technical support.\nAuthor Contributions\nConceptualization: Hyunwoo Kim.\nData curation: Hyunwoo Kim.\nMethodology: Sangjeong Lee, Hyunwoo Kim.\nSupervision: Hyunwoo Kim.\nValidation: Sangjeong Lee, Hyunwoo Kim.\nVisualization: Sangjeong Lee, Hyunwoo Kim.\nWriting – original draft: Sangjeong Lee, Hyunwoo Kim.\nWriting – review & editing: Sangjeong Lee, Hyunwoo Kim.\nReferences\n1. Steen H, Mann M The ABC’s (and XYZ’s) of peptide sequencin g. Nature reviews Molecular cell biology\n2004; 5.9:699– 711. https://doi.or g/10.103 8/nrm146 8 PMID: 15340378\n2. Dančı ´ k V, Addona T A, Clauser K R, Vath J E, Pevzner P A De novo peptide sequencin g via tandem\nmass spectrom etry. Journal of comput ational biology 1999; 6.3–4:32 7–342.\n3. Ma B, Zhang K, Hendrie C, Liang C, Li M, Doherty -Kirby A et al. PEAKS: powerful software for peptide\nde novo sequencing by tandem mass spectrometr y. Rapid commu nications in mass spectrometr y\n2003; 17.20:23 37–2342. https://do i.org/10.1002 /rcm.1196 PMID: 145581 35\n4. Chi H, Sun R-X, Yang B, Song C-Q, Wang L-H, Liu C pNovo: de novo peptide sequencin g and identifi-\ncation using HCD spectra. Journal of proteome research 2010; 9.5:2713 –2724. https:// doi.org/10.10 21/\npr100182k PMID: 20329752\n5. Eng J K, Jahan T A, Hoopmann M R Come t: an open-sourc e MS/MS sequence database search tool.\nProteomic s 2013; 13.1:22– 24. https://doi. org/10.1002/p mic.201200 439 PMID: 23148064\n6. Kim S, Pevzner P MS-GF+ makes progress towards a universal database search tool for proteomic s.\nNature communicat ions 2014; 5.1:5277 . https://doi.or g/10.103 8/ncomms 6277 PMID: 25358478\n7. Tyanova S, Temu T, Cox J The MaxQuan t computation al platform for mass spectrometr y-based shot-\ngun proteomi cs. Nature protocol s 2016; 11.12:23 01–2319. https://doi. org/10.1038/n prot.201 6.136\nPMID: 278093 16\n8. Frank A, Pevzner P PepNovo: de novo peptide sequencin g via probabilist ic network modeling. Analyti-\ncal chemis try 2005; 77.4:964 –973. https://doi.or g/10.102 1/ac0487 88h PMID: 15858974\nPLOS COMP UTATIONAL  BIOLOGY\nNovoB\nPLOS Computationa l Biology | https:/ /doi.org/10.13 71/journal.p cbi.1011892 February 28, 2024 10 / 12\n9. Ma B Novor: real-tim e peptide de novo sequencin g software . Journal of the American Society for Mass\nSpectrom etry 2015; 26.11:18 85–1894. https:/ /doi.org/10.10 07/s1336 1-015-120 4-0 PMID: 26122521\n10. Tran NH, Zhang X, Xin L, Shan B, Li M De novo peptide sequencin g by deep learning. Proceedings of\nthe National Academy of Sciences 2017; 114.31: 8247–825 2. https://doi.or g/10.1073/ pnas.\n1705691114 PMID: 28720701\n11. Hochreiter S, Ju ¨ rgen S Long short-te rm memory. Neural computation 1997; 9.8:1735 –1780. https://doi.\norg/10.1162/ neco.1997. 9.8.1735 PMID: 937727 6\n12. Cho K, van Merrienboer B, Gulcehre C, Bahdanau D, Bougares F, Schwenk H et al. Learning phrase\nrepresentat ions using RNN encoder-dec oder for statistical machine translation . arXiv preprint arXiv\n2014;1406. 1078.\n13. Ru Qiao, Tran N H, Xin L, Chen X, Li M, Shan B et al. Comp utationally instrumen t-resolution- indepen -\ndent de novo peptide sequencin g for high-resolu tion devices. Nature Machine Intelligenc e 2021; 3.5:\n420–425.\n14. Yilmaz M, Fondrie W, Bittremieux W, Oh S, Noble W S De novo mass spectrom etry peptide sequencin g\nwith a transforme r model. In: Interna tional Conferen ce on Machine Learning. PMLR 2022;255 14–\n25522.\n15. Eloff K, Kalogerop oulos K, Morell O, Mabona A, Jesperse n JB, Williams W et al. De novo peptide\nsequencin g with InstaNovo: Accurate, database -free peptide identifi cation for large scale proteomic s\nexperime nts. bioRxiv 2023;2023–08 .\n16. Vaswani A, Shazeer N, Parmar N, Uszkoreit J, Jones L, Gomez A N Attention is all you need. Advances\nin neural information process ing systems 2017; 30.\n17. Wu S, Luan Z, Fu Z, Wang Q, Guo T BiATNovo: A Self-Attentio n based Bidirectiona l Peptide Sequenc -\ning Method. bioRxiv 2023;20 23–05.\n18. Mao Z, Zhang R, Xin K, Li M Mitigating the missing fragmenta tion problem in de novo peptide sequenc-\ning with a two stage graph-based deep learning model. Nature Machine Intelligence 2023.\n19. Hamilton W L, Ying R, Leskov ec J Representa tion learning on graphs: Methods and applicati ons. arXiv\npreprint arXiv 2017;1709. 05584.\n20. Zhang J, Zhou L, Zhao Y, Zong C Synchronous bidirectional inference for neural sequence generation .\nArtificial Intelligenc e 2020; 281:103 234.\n21. Zhou L, Zhang J, Zong C Synchron ous bidirec tional neural machine translati on. Transaction s of the\nAssociation for Comput ational Linguistics 2019; 7:91–10 5.\n22. Paiva AL, Oliveira J TA, de Souza G A, Vasconcelo s I M Label-free proteomi c reveals that cowpea\nsevere mosaic virus transien tly suppresses the host leaf protein accumulation during the compatible\ninteractio n with cowpea (Vigna unguicu lata [L.] Walp.). Journal of Proteom e Research 2016;\n15.12:42 08–4220. https://doi.or g/10.102 1/acs.jprote ome.6b00 211 PMID: 27934294\n23. Nevo N, Thomas L, Chhuon C, Andrze jewska Z, Lipecka J, Guillonne au F et al. Impact of cystinosin gly-\ncosylation on protein stability by differential dynamic stable isotope labeling by amino acids in cell cul-\nture (SILAC). Molecular & Cellular Proteom ics 2017; 16.3:457–468. https://doi.or g/10.1074/ mcp.M116.\n063867 PMID: 280825 15\n24. Cassidy L, Prasse D, Linke D, Schmitz RA, Tholey A Combination of bottom-up 2D-LC-MS and semi-\ntop-down GelFree-L C-MS enhance s coverage of proteome and low molecular weight short open read-\ning frame encoded peptides of the archaeon Methanos arcina mazei. Journal of proteome research\n2016; 15.10:37 73–3783. https://do i.org/10.1021 /acs.jproteo me.6b005 69 PMID: 275571 28\n25. Reuß D R, Altenbuc hner J, Ma ¨ der U, Rath H, Ischebeck T, Sappa PK et al. Large-sc ale reductio n of the\nBacillus subtilis genome: consequen ces for the transcrip tional network, resource allocatio n, and metab-\nolism. Genome research 2017; 27.2:289 –299. https://doi.or g/10.110 1/gr.215293.1 16 PMID: 27965289\n26. Petersen JM, Kemper A, Gruber-Vodi cka H, Cardini U, van der Geest M, Kleiner M et al. Chemos yn-\nthetic symbionts of marine invertebrate animals are capable of nitrogen fixation. Nature microbiol ogy\n2016; 2.1:1–11 . https://doi.or g/10.103 8/nmicrob iol.2016.195 PMID: 277757 07\n27. Mata CI, Fabre B, Hertog M L A T M, Parsons H T, Deery M J, Lilley K S et al. In-depth character ization\nof the tomato fruit pericarp proteome . Proteom ics 2017; 17:1–2:160040 6. https:/ /doi.org/10.10 02/pmic.\n201600406 PMID: 27957804\n28. Seidel G, Meierhofer D, en N-E, Guenth er A, Krobits ch S, Auburger G Quantitative global proteomi cs of\nyeast PBP1 deletion mutants and their stress response s identifi es glucose metabolism, mitocho ndrial,\nand stress granule changes. Journal of proteome research 2017; 16.2: 504–51 5. https://doi.or g/10.\n1021/acs.jp roteome.6 b00647 PMID: 27966978\n29. Hu H, Bienefeld K, Wegene r J, Zautke F, Hao Y, Feng M et al. Proteom e analysis of the hemolym ph,\nmushroom body, and antenna provide s novel insight into honeybe e resistance against varroa\nPLOS COMP UTATIONAL  BIOLOGY\nNovoB\nPLOS Computationa l Biology | https:/ /doi.org/10.13 71/journal.p cbi.1011892 February 28, 2024 11 / 12\ninfestation . Journal of proteo me research 2016: 15.8:2841–2 854. https://doi.or g/10.102 1/acs.\njproteom e.6b00423 PMID: 273841 12\n30. Cypryk W, Lorey M, Puustinen A, Nyman TA, Matikainen S Proteom ic and bioinform atic character iza-\ntion of extracellu lar vesicles released from human macrophage s upon influenza A virus infection. Jour-\nnal of Proteom e Research 2017; 16.1:217 –227. https://doi.or g/10.102 1/acs.jprote ome.6b00 596 PMID:\n27723984\n31. Meier F, Geyer PE, Winter SV, Cox J, Mann M BoxCar acquisition method enables single-sh ot proteo-\nmics at a depth of 10,000 proteins in 100 minutes . Nature methods 2018; 15.6:440–448. https://doi.or g/\n10.1038/ s41592-018- 0003-5 PMID: 29735998\n32. Fı ´ la J, Klodova ´ B, Potěs ˇ il D, Juřı ´ ček M, S\nˇ\nesta ´ k P, Zdra ´ hal Z et al. The beta subunit of nascent polypep-\ntide associat ed complex plays a role in flowers and Siliques developme nt of Arabidops is Thaliana. Inter-\nnational Journal of Molecular Sciences 2020; 21.6:2065. https:// doi.org/10.33 90/ijms210 62065 PMID:\n32192231\n33. Tharyan R G, Annibal A, Schiffer I, Laboy R, Atanassov I, Weber A L et al. NFYB-1 regulate s mitochon-\ndrial function and longevity via lysosomal prosapo sin. Nature Metabolism 2020; 2.5:387–396. https://\ndoi.org/10.10 38/s42255-020 -0200-2 PMID: 326946 63\n34. Yu Y, O’Rourke A, Lin Y-H, Singh H, Eguez R V, Beyhan S et al. Predict ive signatures of 19 antibiotic -\ninduced Escherich ia coli proteomes . ACS Infectious Disease s 2020; 6.8:2120 –2129. https:// doi.org/10.\n1021/acsin fecdis.0c 00196 PMID: 32673475\nPLOS COMP UTATIONAL  BIOLOGY\nNovoB\nPLOS Computationa l Biology | https:/ /doi.org/10.13 71/journal.p cbi.1011892 February 28, 2024 12 / 12"
}