{
  "title": "MassGenie: A Transformer-Based Deep Learning Method for Identifying Small Molecules from Their Mass Spectra",
  "url": "https://openalex.org/W3217248762",
  "year": 2021,
  "authors": [
    {
      "id": "https://openalex.org/A3134751219",
      "name": "Aditya Divyakant Shrivastava",
      "affiliations": [
        "University of Liverpool",
        "Nirma University"
      ]
    },
    {
      "id": "https://openalex.org/A2531644906",
      "name": "Neil Swainston",
      "affiliations": [
        "University of Liverpool"
      ]
    },
    {
      "id": "https://openalex.org/A2143041687",
      "name": "Soumitra Samanta",
      "affiliations": [
        "University of Liverpool"
      ]
    },
    {
      "id": "https://openalex.org/A3033033095",
      "name": "Ivayla Roberts",
      "affiliations": [
        "University of Liverpool"
      ]
    },
    {
      "id": "https://openalex.org/A2696136175",
      "name": "Marina Wright Muelas",
      "affiliations": [
        "University of Liverpool"
      ]
    },
    {
      "id": "https://openalex.org/A2087190859",
      "name": "Douglas B. Kell",
      "affiliations": [
        "Technical University of Denmark",
        "Novo Nordisk Foundation",
        "University of Liverpool"
      ]
    }
  ],
  "references": [
    "https://openalex.org/W2069936863",
    "https://openalex.org/W2034873249",
    "https://openalex.org/W2023535481",
    "https://openalex.org/W6677805925",
    "https://openalex.org/W2997728144",
    "https://openalex.org/W2017254234",
    "https://openalex.org/W2023818227",
    "https://openalex.org/W1757990252",
    "https://openalex.org/W2063021257",
    "https://openalex.org/W2787894218",
    "https://openalex.org/W2902454325",
    "https://openalex.org/W3016036651",
    "https://openalex.org/W2951891306",
    "https://openalex.org/W1911778379",
    "https://openalex.org/W6795424497",
    "https://openalex.org/W6683632896",
    "https://openalex.org/W6688345324",
    "https://openalex.org/W3033596205",
    "https://openalex.org/W3160644197",
    "https://openalex.org/W2777466035",
    "https://openalex.org/W2767955262",
    "https://openalex.org/W2922522932",
    "https://openalex.org/W2609624643",
    "https://openalex.org/W2162539049",
    "https://openalex.org/W1963989877",
    "https://openalex.org/W2802909948",
    "https://openalex.org/W6673920631",
    "https://openalex.org/W2949129058",
    "https://openalex.org/W2279763510",
    "https://openalex.org/W2616976488",
    "https://openalex.org/W2937662637",
    "https://openalex.org/W2907470641",
    "https://openalex.org/W3017343831",
    "https://openalex.org/W3094361883",
    "https://openalex.org/W3036150132",
    "https://openalex.org/W2075999343",
    "https://openalex.org/W2970109320",
    "https://openalex.org/W3158187537",
    "https://openalex.org/W3099485282",
    "https://openalex.org/W3178037384",
    "https://openalex.org/W2086457680",
    "https://openalex.org/W2123010993",
    "https://openalex.org/W2160411185",
    "https://openalex.org/W2160317546",
    "https://openalex.org/W2114704115",
    "https://openalex.org/W2529996553",
    "https://openalex.org/W2919115771",
    "https://openalex.org/W2076063813",
    "https://openalex.org/W2925830236",
    "https://openalex.org/W2982209755",
    "https://openalex.org/W2998473774",
    "https://openalex.org/W2790608062",
    "https://openalex.org/W2883583109",
    "https://openalex.org/W2578240541",
    "https://openalex.org/W2945551948",
    "https://openalex.org/W3111995631",
    "https://openalex.org/W3143491409",
    "https://openalex.org/W4236044224",
    "https://openalex.org/W3166142427",
    "https://openalex.org/W3037095052",
    "https://openalex.org/W2096035730",
    "https://openalex.org/W2092818812",
    "https://openalex.org/W2065104255",
    "https://openalex.org/W2285468881",
    "https://openalex.org/W2954086013",
    "https://openalex.org/W2800712778",
    "https://openalex.org/W2969504867",
    "https://openalex.org/W2946929676",
    "https://openalex.org/W2101394823",
    "https://openalex.org/W2886679599",
    "https://openalex.org/W3206878019",
    "https://openalex.org/W2548357532",
    "https://openalex.org/W3019108305",
    "https://openalex.org/W6684191040",
    "https://openalex.org/W2896926617",
    "https://openalex.org/W3135012552",
    "https://openalex.org/W3163832451",
    "https://openalex.org/W4283794074",
    "https://openalex.org/W3210839179",
    "https://openalex.org/W2008127220",
    "https://openalex.org/W2950838202",
    "https://openalex.org/W3113151404",
    "https://openalex.org/W2622236128",
    "https://openalex.org/W7075591241",
    "https://openalex.org/W2320034101",
    "https://openalex.org/W2412446857",
    "https://openalex.org/W2064576005",
    "https://openalex.org/W1934481644",
    "https://openalex.org/W3150051545",
    "https://openalex.org/W2026872331",
    "https://openalex.org/W6769723617",
    "https://openalex.org/W1979597489",
    "https://openalex.org/W3036319923",
    "https://openalex.org/W3036559261",
    "https://openalex.org/W2166478947",
    "https://openalex.org/W2103397879",
    "https://openalex.org/W2944729956",
    "https://openalex.org/W2094855848",
    "https://openalex.org/W2610443297",
    "https://openalex.org/W3172942063",
    "https://openalex.org/W2962843773",
    "https://openalex.org/W3083024963",
    "https://openalex.org/W2947950688",
    "https://openalex.org/W2907492528",
    "https://openalex.org/W3087318293",
    "https://openalex.org/W2946547492",
    "https://openalex.org/W4206706211",
    "https://openalex.org/W2484640097",
    "https://openalex.org/W3023105709",
    "https://openalex.org/W3098269892",
    "https://openalex.org/W2618530766",
    "https://openalex.org/W3217248762",
    "https://openalex.org/W2159819304",
    "https://openalex.org/W2980773467",
    "https://openalex.org/W2992072991",
    "https://openalex.org/W3176980311",
    "https://openalex.org/W3162917764",
    "https://openalex.org/W4210257598",
    "https://openalex.org/W3045522182",
    "https://openalex.org/W2163605009",
    "https://openalex.org/W2956419562",
    "https://openalex.org/W3092087377",
    "https://openalex.org/W2093999858",
    "https://openalex.org/W1611854178",
    "https://openalex.org/W3164743754",
    "https://openalex.org/W2979387401",
    "https://openalex.org/W2200140537",
    "https://openalex.org/W2118588291",
    "https://openalex.org/W4225985320",
    "https://openalex.org/W3103874809",
    "https://openalex.org/W4281688302"
  ],
  "abstract": "The ‘inverse problem’ of mass spectrometric molecular identification (‘given a mass spectrum, calculate/predict the 2D structure of the molecule whence it came’) is largely unsolved, and is especially acute in metabolomics where many small molecules remain unidentified. This is largely because the number of experimentally available electrospray mass spectra of small molecules is quite limited. However, the forward problem (‘calculate a small molecule’s likely fragmentation and hence at least some of its mass spectrum from its structure alone’) is much more tractable, because the strengths of different chemical bonds are roughly known. This kind of molecular identification problem may be cast as a language translation problem in which the source language is a list of high-resolution mass spectral peaks and the ‘translation’ a representation (for instance in SMILES) of the molecule. It is thus suitable for attack using the deep neural networks known as transformers. We here present MassGenie, a method that uses a transformer-based deep neural network, trained on ~6 million chemical structures with augmented SMILES encoding and their paired molecular fragments as generated in silico, explicitly including the protonated molecular ion. This architecture (containing some 400 million elements) is used to predict the structure of a molecule from the various fragments that may be expected to be observed when some of its bonds are broken. Despite being given essentially no detailed nor explicit rules about molecular fragmentation methods, isotope patterns, rearrangements, neutral losses, and the like, MassGenie learns the effective properties of the mass spectral fragment and valency space, and can generate candidate molecular structures that are very close or identical to those of the ‘true’ molecules. We also use VAE-Sim, a previously published variational autoencoder, to generate candidate molecules that are ‘similar’ to the top hit. In addition to using the ‘top hits’ directly, we can produce a rank order of these by ‘round-tripping’ candidate molecules and comparing them with the true molecules, where known. As a proof of principle, we confine ourselves to positive electrospray mass spectra from molecules with a molecular mass of 500Da or lower, including those in the last CASMI challenge (for which the results are known), getting 49/93 (53%) precisely correct. The transformer method, applied here for the first time to mass spectral interpretation, works extremely effectively both for mass spectra generated in silico and on experimentally obtained mass spectra from pure compounds. It seems to act as a Las Vegas algorithm, in that it either gives the correct answer or simply states that it cannot find one. The ability to create and to ‘learn’ millions of fragmentation patterns in silico, and therefrom generate candidate structures (that do not have to be in existing libraries) directly, thus opens up entirely the field of de novo small molecule structure prediction from experimental mass spectra.",
  "full_text": null,
  "topic": "Mass spectrum",
  "concepts": [
    {
      "name": "Mass spectrum",
      "score": 0.6911988258361816
    },
    {
      "name": "Molecule",
      "score": 0.5500813126564026
    },
    {
      "name": "Fragmentation (computing)",
      "score": 0.5326029658317566
    },
    {
      "name": "Chemistry",
      "score": 0.47646403312683105
    },
    {
      "name": "Mass spectrometry",
      "score": 0.4726910889148712
    },
    {
      "name": "Transformer",
      "score": 0.4197390079498291
    },
    {
      "name": "Spectral line",
      "score": 0.4159037470817566
    },
    {
      "name": "Chemical physics",
      "score": 0.394244909286499
    },
    {
      "name": "Biological system",
      "score": 0.37218648195266724
    },
    {
      "name": "Computer science",
      "score": 0.34577956795692444
    },
    {
      "name": "Computational chemistry",
      "score": 0.3310996890068054
    },
    {
      "name": "Physics",
      "score": 0.2958810329437256
    },
    {
      "name": "Quantum mechanics",
      "score": 0.12088698148727417
    },
    {
      "name": "Operating system",
      "score": 0.0
    },
    {
      "name": "Biology",
      "score": 0.0
    },
    {
      "name": "Organic chemistry",
      "score": 0.0
    },
    {
      "name": "Chromatography",
      "score": 0.0
    },
    {
      "name": "Voltage",
      "score": 0.0
    }
  ],
  "institutions": [
    {
      "id": "https://openalex.org/I146655781",
      "name": "University of Liverpool",
      "country": "GB"
    },
    {
      "id": "https://openalex.org/I165831266",
      "name": "Nirma University",
      "country": "IN"
    },
    {
      "id": "https://openalex.org/I2801134892",
      "name": "Novo Nordisk Foundation",
      "country": "DK"
    },
    {
      "id": "https://openalex.org/I96673099",
      "name": "Technical University of Denmark",
      "country": "DK"
    }
  ]
}