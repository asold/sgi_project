{
    "title": "Neural-Network-Based Automated Synthesis of Transformer Matching Circuits for RF Amplifier Design",
    "url": "https://openalex.org/W4293812269",
    "year": 2022,
    "authors": [
        {
            "id": "https://openalex.org/A5101845258",
            "name": "Dong-Yoon Lee",
            "affiliations": [
                "Pohang University of Science and Technology"
            ]
        },
        {
            "id": "https://openalex.org/A5014088025",
            "name": "Gibeom Shin",
            "affiliations": [
                "Pohang University of Science and Technology"
            ]
        },
        {
            "id": "https://openalex.org/A5100399231",
            "name": "Seunghoon Lee",
            "affiliations": [
                "Pohang University of Science and Technology"
            ]
        },
        {
            "id": "https://openalex.org/A5077334973",
            "name": "Kyung-Hwan Kim",
            "affiliations": [
                "Pohang University of Science and Technology"
            ]
        },
        {
            "id": "https://openalex.org/A5078114111",
            "name": "Tae-Hyun Oh",
            "affiliations": [
                "Pohang University of Science and Technology"
            ]
        },
        {
            "id": "https://openalex.org/A5090103689",
            "name": "Ho-Jin Song",
            "affiliations": [
                "Pohang University of Science and Technology"
            ]
        }
    ],
    "references": [
        "https://openalex.org/W1981025032",
        "https://openalex.org/W2051812123",
        "https://openalex.org/W6687045409",
        "https://openalex.org/W6744104549",
        "https://openalex.org/W6679671054",
        "https://openalex.org/W3091793048",
        "https://openalex.org/W1909241728",
        "https://openalex.org/W2967156884",
        "https://openalex.org/W2126428215",
        "https://openalex.org/W2146080060",
        "https://openalex.org/W3033614366",
        "https://openalex.org/W2169278276",
        "https://openalex.org/W2805966918",
        "https://openalex.org/W2165666706",
        "https://openalex.org/W1998752433",
        "https://openalex.org/W2121698306",
        "https://openalex.org/W2974630122",
        "https://openalex.org/W6680006602",
        "https://openalex.org/W2744874989",
        "https://openalex.org/W3146814345",
        "https://openalex.org/W3092040835",
        "https://openalex.org/W3141616412",
        "https://openalex.org/W2098103715",
        "https://openalex.org/W6659127799",
        "https://openalex.org/W6734266705",
        "https://openalex.org/W4285451629",
        "https://openalex.org/W2886648682",
        "https://openalex.org/W2885353759",
        "https://openalex.org/W3199687129",
        "https://openalex.org/W2116831149",
        "https://openalex.org/W3124213455",
        "https://openalex.org/W2172135569",
        "https://openalex.org/W2799969132",
        "https://openalex.org/W2074046446",
        "https://openalex.org/W2560474429",
        "https://openalex.org/W2152814452",
        "https://openalex.org/W2913821872",
        "https://openalex.org/W2807851282",
        "https://openalex.org/W2591882232",
        "https://openalex.org/W2753215597",
        "https://openalex.org/W2033509557",
        "https://openalex.org/W4235788006",
        "https://openalex.org/W2135354436",
        "https://openalex.org/W2188365844"
    ],
    "abstract": "Rich experience and intuition play important roles in designing planar transformers (TFs) for contemporary radio frequency integrated circuits (RFICs). In general, RFIC designers have been heavily relying on multiple iterations of full electromagnetic (EM) simulations, which consumes much time and effort. Here, we propose an automated matching circuit synthesizer (AMCS) using neural networks (NNs). The proposed AMCS directly synthesizes a matching circuit combined with a TF throughout the entire design process, ranging from the desired performance to layout. In the AMCS, which is a \"spec-to-layout\" synthesizer, one NN returns physical parameters of matching circuits, and another NN estimates the electrical performance in two-port S-parameters from the desired impedances. Before the NNs are trained, input feature design is conducted to avoid the one-to-many problem, which cannot be well characterized with an inverse NN. This significantly reduces the time and effort for iterative circuit and EM simulations. The AMCS generated the matching circuit layouts for simple single-stage amplifiers operating at different frequencies up to 70 GHz or in different bandwidths of up to 32.5%. The estimated S-parameters of the amplifiers show good agreement with the EM simulation results.",
    "full_text": "4726 IEEE TRANSACTIONS ON MICROW A VE THEORY AND TECHNIQUES, VOL. 70, NO. 11, NOVEMBER 2022\nNeural-Network-Based Automated Synthesis of\nTransformer Matching Circuits for\nRF Ampliﬁer Design\nDongyoon Lee, Gibeom Shin, Seunghoon Lee , Graduate Student Member, IEEE ,\nKyunghwan Kim , Graduate Student Member, IEEE , Tae-Hyun Oh , Member, IEEE,\nand Ho-Jin Song , Senior Member, IEEE\nAbstract— Rich experience and intuition play important roles\nin designing planar transformers (TFs) for contemporary radio\nfrequency integrated circuits (RFICs). In general, RFIC design-\ners have been heavily relying on multiple iterations of full\nelectromagnetic (EM) simulations, which consumes much time\nand effort. Here, we propose an automated matching circuit\nsynthesizer (AMCS) using neural networks (NNs). The proposed\nAMCS directly synthesizes a matching circuit combined with a\nTF throughout the entire design process, ranging from the desired\nperformance to layout. In the AMCS, which is a “spec-to-layout”\nsynthesizer, one NN returns physical parameters of matching\ncircuits, and another NN estimates the electrical performance in\ntwo-port S-parameters from the desired impedances. Before the\nNNs are trained, input feature design is conducted to avoid the\none-to-many problem, which cannot be well characterized with\nan inverse NN. This signiﬁcantly reduces the time and effort\nfor iterative circuit and EM simulations. The AMCS generated\nthe matching circuit layouts for simple single-stage ampliﬁers\noperating at different frequencies up to 70 GHz or in different\nbandwidths of up to 32.5%. The estimated S-parameters of the\nampliﬁers show good agreement with the EM simulation results.\nIndex Terms— Automated synthesis, neural network (NN),\nradio frequency (RF) ampliﬁers, radio frequency integrated\ncircuit (RFIC), transformer (TF).\nI. I NTRODUCTION\nP\nLANAR transformers (TFs) based on multilevel backend\nthick metallization technologies have been commonly\nused as impedance matching circuits (MCs) in contempo-\nrary millimeter-wave (mm-wave) CMOS circuits for a com-\npact layout and broadband operation [1], [2], [3], [4], [5],\nManuscript received 18 May 2022; accepted 20 July 2022. Date of publica-\ntion 31 August 2022; date of current version 4 November 2022. This work was\nsupported by the Institute of Information and Communications Technology\nPlanning and Evaluation (IITP) Grants funded by the Ministry of Science\nand ICT (MSIT), Korea, (Investigation on Future mm-Wave Circuits, Pack-\nages, and System) under Grant IITP-2018-0-00823 and (Automatic Design\nGeneration of Ultra High-Speed I/O Circuits to Support Intelligent Semi-\nconductor Devices) under Grant IITP-2019-0-01394.(Corresponding authors:\nHo-Jin Song; Tae-Hyun Oh.)\nThe authors are with the Department of Electrical Engineering, Pohang\nUniversity of Science and T echnology, Pohang 37673, South Korea\n(e-mail: daniellee97@postech.ac. kr; taehyun@postech.ac.kr; hojin.song@\npostech.ac.kr).\nThis article has supplementary material provided by the authors and\ncolor versions of one or more ﬁgures available at https://doi.org/\n10.1109/TMTT.2022.3199756.\nDigital Object Identiﬁer 10.1109/TMTT.2022.3199756\n[6], [7], [8]. However, the common equivalent models of\nTFs consisting of inductors, coupling factors, and parasitic\ncapacitors and resistors are inaccurate at mm-wave or tera-\nhertz (THz) frequencies because of the distributed behavior\nof the parasitic elements [9]. Thus, characterizing TFs by\nelectromagnetic (EM) simulations is a common method for\nmm- or THz-wave circuit design. Moreover, because of the\ninaccuracy of empirical or theorical models, multiple iterations\nbetween the initial guess in the equivalent circuit models and\nEM simulations are always required, which are very time-\nconsuming and require experience-based knowledge.\nThere have been various efforts to develop automated circuit\nsynthesis systems for digital as well as analog circuits. Genetic\nalgorithms (GAs) have been used for topology selection and\ncompact layouts in analog ampliﬁers [10], [11]. Power dis-\nsipation of an analog circuit was optimized with a GA [12].\nA neural network (NN) with a rider optimization algorithm\n(ROA), RideNN, has been studied for fault diagnosis [13].\nMoreover, a feedforward NN with a GA has been studied to\nmake an automated synthesis system for operational ampli-\nﬁers [14] in analog circuits.\nAutomated circuit synthesis techniques for radio fre-\nquency (RF) circuits have also been developed in order to\nmitigate iterative tasks such as model-order reduction [15].\nA least-squares ﬁtting algorithm has been studied to extract a\nspiral inductor’s equivalent circuit [16], and analysis and sim-\nulation of inductors and TFs for integrated circuits (ASITIC)\nhave been studied to design tunable inductors [17], [18].\nIn addition, a GA has been employed for optimizing the ﬁgure\nof merit (FoM) of low-noise ampliﬁers [19].\nMachine-learning-based differential evolution has been sug-\ngested as a way to synthesize passive elements such as\ninductors and TFs at a single frequency [20]. Furthermore,\nunder a smoothness assumption that similar design parame-\nters have similar performance, general mm-wave integrated\ncircuit (IC) synthesis based on differential evolution assisted\nby a Gaussian process model has been proposed to optimize\ninductors and TFs [21], [22]. Amultilayer perceptron has been\nleveraged to predict the operation of square microstrip spiral\ninductors [23]. A knowledge-based NN with the concept of\nspace mapping had been researched to synthesize microstrip\nbandpass ﬁlters [24].\nThis work is licensed under a Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 License.\nFor more information, see https://creativecommons.org/licenses/by-nc-nd/4.0/\nLEE et al.: NEURAL-NETWORK-BASED AUTOMATED SYNTHESIS OF TRANSFORMER MATCHING CIRCUITS 4727\nFig. 1. Comparison of (a) classical design cycle for TFs, (b) prior work\nbased on an equivalent circuit model,(c) prior work based on an NN with a\nshared encoder, and (d) proposed design cycle with the AMCS in this work.\nInverse modeling has been proposed to synthesizeLC ﬁlters\nor microstrip ﬁlters [25], [26], [27] using an NN that takes\nelectrical performance as input and layout as output. In order\nto synthesize TFs, inverse modeling has been employed to\nreplace such iterative tasks [28], [29].\nIn this article, an NN-based automated matching cir-\ncuit synthesizer (AMCS) is proposed. The AMCS suggests\nthat MCs combined with a TF and shunt capacitors and\nthus have the potential to replace all the time-consuming\nprocesses in single-stage RF ampliﬁer design (i.e., synthe-\nsize MCs). It determines the desired performance, such as\noutput impedances in a wideband frequency range, and then\ndirectly returns TF layouts and shunt capacitors that satisfy the\ndesired performance requirements without additional proce-\ndures. In the AMCS, two NN cores are trained. One generates\nmultiple potential layouts that can match the given core transis-\ntors to 50\u0002, and the other returns the estimated performance\nof the auto-generated MCs. Then, the designer selects the\nmost suitable layout based on the MCs’ performance and\naddresses other issues that were not included in the NN such\nas the form factor, as shown in Fig. 1(d). The relationship\nbetween the target matching impedance and the MC layout\nis fundamentally a one-to-many problem and thus cannot be\ncompletely characterized by standard feedforward NNs [30].\nIn this work, an input feature design was conducted by utiliz-\ning the quality factor (Q-factor) and insertion loss (IL) of TFs\nas input features to relax the one-to-many problem. The MCs\nwere generalized to consist of a TF and capacitors to match the\ninput and output impedances of core transistors to an external\n50-\u0002 source and load terminals. The key innovation introduced\nin this work is a direct MC synthesis method and a solution for\nthe one-to-many problem for training NNs with the human-\nin-the-loop (HITL) concept. To demonstrate the effectiveness\nof these innovations, we present design examples of MCs for\nsingle-stage ampliﬁers operating at different frequencies up\nto 70 GHz or in different bandwidths of up to 32.5%.\nSection II covers prior research on automated synthesis\nsystems for RF circuit design and describes the purpose of\nthis work. Section III describes the primary issue of an AMCS\nbased on NNs and proposes the main idea for a solution\nand the structure of the AMCS. Section IV presents the basic\ninformation about NN training and the results. Section V dis-\ncusses another NN that can predict MC characteristics. Design\nexamples obtained with the AMCS at various frequencies and\nbandwidths are provided in Sections VI and VII, respectively.\nSection VIII discusses the limitations of the proposed AMCS\nand summarizes this article.\nII. RFIC D\nESIGN WITH TF MATCHING CIRCUITS\nRecently, TFs have been widely used as impedance MCs\nor signal baluns in CMOS RF circuits, in particular for those\noperating at mm-wave frequencies. TFs provide a compact lay-\nout and broadband operation. However, unlike capacitors, it is\nhard to directly synthesize TF layouts at high frequencies even\nwith accurate material and dimension parameters due to the\ndistributed nature of parasitic elements associated with TFs.\nThis section brieﬂy compares the design procedure between\nthe classical and automated synthesis techniques, including the\none proposed in this work for MCs, and presents the proposed\nAMCS.\nA. Classic MC/TF Synthesis\nIn the classic RF circuit design process, for which a brief\nﬂowchart is shown in Fig. 1(a), designers ﬁrst select matching\nimpedance \u0003\ns and \u0003L from the characteristics of core TRs\nfor the desired performance in, for instance, power, gain, or\nnoise. To match the given source and load impedances to\n\u0003s and \u0003L , respectively, one may start to design the MCs\nwith equivalent circuits, which is an iterative task. Once the\nequivalent circuit parameters are ﬁxed, an initial MC layout\nshould then be drawn based on the designers’ experience.\nDue to the distributed parasitic elements, the equivalent circuit\nmodels cannot accurately represent nor estimate the actual\ncharacteristics of the TFs, and thus, for recent mm-wave radio\nfrequency integrated circuits (RFICs), the layout is commonly\nveriﬁed by the EM simulation, which is also an iterative\nand time-consuming task. The iterative task between layout\nand EM simulation is continued until the EM simulation\nresults satisfy the desired performance, as shown in Fig. 1(a).\nDue to the recent progress in high-performance computing\nhardware and accurate numericalsimulators, the overall time\nconsumed for the iterative task has been signiﬁcantly reduced.\nHowever, the absence of a direct synthesis method for TFs\nfundamentally limits the degree of optimization and design\nthroughput.\nB. Automated TF Synthesis Techniques\nThere have been a few efforts to develop automated TF\nsynthesizers for RF MCs. Munzer et al. [28] presented an\nNN-based synthesis technique that can address all design\naspects, from the equivalent model parameters to the layout.\nFig. 1(b) shows the design ﬂow. As can be seen, the most\ntime-consuming task between the layout and EM simulation\ncan be avoided, but any inaccuracy of the equivalent model\nwill be reﬂected in the ﬁnal design.\n4728 IEEE TRANSACTIONS ON MICROW A VE THEORY AND TECHNIQUES, VOL. 70, NO. 11, NOVEMBER 2022\nFig. 2. Single-stage ampliﬁer matching situation assumed in AMCS.\nC. Direct Synthesis Techniques for MC Consisting of TF and\nShunt Capacitors\nIn [29], further direct generation of TF layouts from the\ndesired matching impedance was presented using a shared\nencoder composed of two NNs, as shown in Fig. 1(c). How-\never, in that work, the design frequency was ﬁxed to 30 GHz,\nand the capacitance value affecting the required transformation\nratio of the TF has to be provided by the designer as an input\nparameter.\nD. AMCS (Automated Matching Circuit Synthesizer)\nThe ultimate “spec-to-la yout” design process with an\nAMCS would be the direct generation of the most optimum\nMC layout from the matching impedances \u0003\ns ,a n d\u0003L that\nthe designer selects for the desired performance in the target\nfrequency band, as shown in Fig. 1(d). Here, our aim is to\npropose the ultimate “spec-to-layout” design tool using NNs.\nIII. AMCS D ESCRIPTION\nA. Primary Issue in Training NN (One-to-Many Problem)\nThe proposed AMCS using NNs can produce an MC layout.\nThe auto-synthesized MC along with shunt capacitors will\nmatch the desired impedance Zin or Zout to 50\u0002. In this work,\nwe aimed to design a simple single-stage ampliﬁer whose input\nand output are matched by the AMCS, as shown in Fig. 2.\nObviously, the desired impedances should be input parameters.\nOne of the naïve ways to implement an AMCS is to train a\nregression NN so that it directly predicts MC layouts from\nan input of desired target impedances. However, since there\nmust be many diverse possible layouts resulting in the same\nimpedance, modeling such a one-to-many relationship by any\ntype of regression is ambiguous and may only provide a rough\ngeneric answer that would never be desirable [31], [32], [33].\nFundamentally, designing a two-port network with single port\nimpedance is a kind of one-to-many problem that even NNs\ncannot converge to an optimum and realistic solution. For\ninstance, it is expected that the NN returns the optimum\ncombination of a TF and, if necessary, capacitors for matching\nthe given impedance Z\nm to 50 \u0002, as shown in Fig. 3(a).\nHowever, as shown in Fig. 3(b), the given constraint can also\nbe satisﬁed with a TF whose two ports are isolated (or the\nmutual coupling factor= 0) and with a shunt element whose\nimpedance is equal toZ\nm. This is one radical example, but to\nrealize the design scenario shown in Fig. 1(d), the one-to-many\nproblem needs to be carefully dealt with.\nIn addition, for wideband circuit design, the MCs should\nmatch the desired impedance, which is commonly a function\nFig. 3. Equivalent circuits of (a) MC that user desires, (b) MC unexpected\nfrom NN when input features are not designed, and (c) predicted MC from\nNN when input features are well designed.\nof frequency in the operating frequency range. Thus, to accom-\nmodate wideband operation, the NN should deal with the\nseries of desired impedancesZ\nm( f ) (or \u0003m ( f ) as a reﬂection\ncoefﬁcient) with respect to the frequency.\nB. Input Feature Design for Relaxing One-to-Many Problem\nIn the machine learning community, generative modeling\nhas been introduced to overcome the limitation of regres-\nsion in modeling one-to-many relationships [31], which are\ncumbersome to model, train, and use in practice. We take a\ndifferent approach that, by tackling the design space of input\nfeatures, is straightforward yet effective in relaxing the one-\nto-many relationship between MC layouts and impedances.\nWe introduce domain-speciﬁc auxiliary constraints into inputs,\nwhich we call input feature design. Thereby, the desirable\nlayout can be guided further by more speciﬁc inputs.\nFirst, the one-to-many problem mainly arises from the\nlimited information the designer can provide. It can be simply\nresolved if the full two-port parameters of the desired TF\nare provided. However, in general, estimating them is beyond\nthe capabilities of even highly experienced designers. There\nare other electrical parameters that can be gauged by users\nand represent the full two-port characteristics, such as the\nQ-factors (Q\n1 and Q2) and IL of a TF [34]\nQ1( f ) = Im\n(\nZTF,11( f )\n)\nRe(ZTF,11( f )\n) (1)\nQ2( f ) = Im\n(\nZTF,22( f )\n)\nRe\n(\nZTF,22( f )\n) (2)\nand\nIL( f ) = STF,21( f )\nSTF,12( f )\n(\nK ( f ) −\n√\nK ( f )2 − 1\n)\n(3)\nwhere ZTF,ij ( f ) represents the Z-parameters of TFs as a\nfunction of frequency. K is Rollett’s stability factor deﬁned\nas\nK ( f ) = 1 −\n⏐⏐STF,11( f )\n⏐⏐2\n−\n⏐⏐STF,22( f )\n⏐⏐2\n+ |\u0004( f )|2\n2\n⏐⏐STF,12( f )STF,21( f )\n⏐⏐ (4)\n\u0004( f ) = STF,11( f )STF,22( f ) − STF,12( f )STF,21( f ). (5)\nLEE et al.: NEURAL-NETWORK-BASED AUTOMATED SYNTHESIS OF TRANSFORMER MATCHING CIRCUITS 4729\nFig. 4. Assumed (a) layout structure of TF and (b) MC in this work.\nC. Inverse NN\nAs shown in Fig. 3(c), the NN for “spec-to-layout” syn-\nthesis, hereafter referred to as the “inverse” NN (INN),\nreturns layout parameters of the MC from given input features\n[i.e., given features consist of the functions of frequency such\nas Q1, Q2, IL, and the desired impedances (Zm)]. The MC\nassumed in this work consists of a TF and shunt capacitors,\nas shown in Fig. 4. The layout parameters are the TF layout\nparameters and the values of capacitive matching elements\n(c\n1 and c2), which are assumed, as shown in Fig. 4.\nThe input and output vectors of the INN,x and ˆyMC, are\ndeﬁned as follows:\nx = [f , Zm ( f ), Q1,min, Q2,min,ILmin\n]\u0002\n(6)\nˆyMC =\n[ˆd1, ˆd2, ˆw1, ˆw2, ˆδ, ˆc1, ˆc2\n]\u0002\n(7)\nˆyMC = INN (x). (8)\nTo verify whether the designed input features relax the\none-to-many problem and the training sets x and yMC are\nmapped one-to-one, as shown in Fig. 5(a), two additional\nreference input feature vectors, xr1 =[ f SMC( f )] and\nxr2 =[ f Zm( f )], were prepared and used to train the INN.\nFor the aforementioned reason in Section III-A, if the INN\nis designed with an input feature vector composed of only\noutput impedances (Z\nm), it would be a one-to-many system.\nAs shown in Fig. 5(a), case (III) is a one-to-many system\nsince the input feature vector ( xr2) is only composed of\noutput impedances. As can be seen in Fig. 5(b),xr2 leads to\nan NN converging with test error 2.154× 10−2 larger than\n10−4 (approximately equal to 1%) since xr2 only includes\ninformation about one port of the matching network, which\nmeans that it is a one-to-many problem. While the training\nresult with x\nr2 does not converge well, the NN from xr1\n[case (II)], including the full two-port S-parameters of the\nMC [SMC(f)], is expected to converge well. As can be seen\nin Fig. 5(b), the test error of training with xr1 [case (II)]\nwas 3.730 × 10−4, which is signiﬁcantly lower than that in\ncase (III), and this indicates that the one-to-many problem is\nrelaxed well. On the other hand, the other input feature vector\nx [case (I)], which was designed in this work, consists of\nfrequencies ( f ), output impedances [Z\nm( f )], Q-factors, and\nIL. The proposed one results in a 3.033 × 10−5 test error,\nwhich is also signiﬁcantly better than that forxr2 [case (III)],\n2.154 × 10−2. The results indicate that the proposed input\nfeature design effectively solves the one-to-many problem even\nwith fewer input features. The NN has a simple multilayer\nFig. 5. Comparison among input feature case of (a) input and output vectors\nof INN. (b) Test error of INN [red: designed features in this work, blue: full\ntwo-port S-parameters, and black: only output impedances (Zm )].\nperceptron structure, which is set to 100 × 8, for all three\ninput feature vectors, x, xr1,a n dxr2.\nIt should be noted that, in general, designers do not seek\nspeciﬁc values of Q1, Q2, and IL but can provide them as\nconstraints. For instance, to achieve the target performance,\nthey may guess that Q1 should be at least greater than\n9 based on their experience. There must be numerous potential\ncircuits that satisfy the condition, and thus, this is still a one-\nto-many problem. However, unlike the two-port parameters,\nthis problem can be dealt with by using an HITL architecture,\nin which the user makes the ﬁnal decision among potential\ncandidates.\nSeveral studies have shown that NNs can solve a problem\nwith constraints by using, for instance, a constraint violation\npenalty concept [35]. However, Q\n1, Q2, and IL of TFs in\nthe MC cannot be simply judged with a single standard; the\ndesigner may comprehensively look at various performance\nparameters such as gain, return loss, or bandwidth and ﬁnally\nselect a matching network from various possible ones, even if\nQ\n1, Q2, or IL is slightly worse than expected one. To deal with\nthis particular problem, we employed the concept of HITL\nin this work [36], where the user makes the ﬁnal decision.\nDeﬁnitions of input and output variables and a brief algorithm\nof an AMCS consisting of two NNs are shown in Fig. 6 and\nAlgorithm 1.\nThe overall ﬂowchart of the AMCS is given as follows.\n1) The user enters three target frequencies ( f ), three\ndesired impedances [Z\n\u0006\nm( f )], and minimum and\n4730 IEEE TRANSACTIONS ON MICROW A VE THEORY AND TECHNIQUES, VOL. 70, NO. 11, NOVEMBER 2022\nFig. 6. Structure of AMCS.\nVariables\nf := [f1, f2, f3], design frequencies\nZ∗\nm( f ) := desired impedances at each frequency\nQ1,minQ1,max := Min, Max constraint of primary turn’Q factor\nQ2,min,Q2,max := Min, Max constraint of secondary turn’Q factor\nILmin,LLmax := Min, Max constraint of IL\nx := input vector of INN\nˆyMC := predicted structure parameters of MC\nMClist := List of candidates of MC\nAlgorihtm 1 Pseudo Code of AMCS\n1: Input: f ,Z\u0006\nm( f ),Q1, min ,Q1, max , Q2, min ,Q2, max ,ILmin,ILmax\n2: Output: MClist\n3: deﬁne: FoM\n4: count = 1\n5: Q1 =[ Q1,min,Q1,min + 1,..., Q1,max]\n6: Q2 =[ Q2,min,Q2,min + 1,..., Q2,max]\n7: IL =[ ILmin,ILmin + 1,ILmin + 2,..., ILmax]\n8: for i = 1: do\n9: for j = 1: m do\n10: for k = 1: n do\n11: x ←[ f Z\u0006\nm( f )Q1(i)Q2(j)IL(k)]\n12: ˆyMC := [ˆd1 ˆd2 ˆw1 ˆw2 ˆδ ˆc1 ˆc2]← INN (x)\n13: MClist(count)← ˆyMC\n14: count ← count +1\n15: end for\n16: end for\n17: end for\n18: Sort MClist according to FoM\n19: Return MClist\nmaximum acceptable bounds of Q-factors ( Q1,min,\nQ1,max, Q2,min, Q2,max) and IL (ILmin,I Lmax).\n2) The AMCS iterates the INN for various potential combi-\nnations ofQ1, Q2, and IL that satisfy the limits speciﬁed\nby the user. MC layout parameters from the INN are\nsaved along with the user-deﬁned FoM.\n3) The AMCS lists the outputs in terms of, for instance,\nthe FoM, and the user selects one of the top candidates,\nwhich is an implementation of HITL in this work.\nIV . I\nNVERSE NN TRAINING\nA. Learning Data Preparation\nIn this work, the TF in the MC was assumed to have a\nsimple 1:1 octagonal shape [Fig. 4(a)]. First, layout samples\n[graphic design system (GDS)] for training were prepared\nFig. 7. Preparation and separation of TF dataset.\nby using SKILL language and PCELL. EM simulations were\nconducted, using shell script, at up to 100 GHz for various TF\nlayouts whose dimensions were swept as follows: diameters\n(d\n1, d2) from 70 to 210 μm in 20-μm steps, widths (w1,\nw2) from 5 to 10 μmi n2 . 5 -μm steps, and offsets between\nprimary and secondary TFs (δ) from 0% to 30% of bigger\ndiameters in 10% steps. Fixed parameters were the widths\nof the guard ground ring (A, B), 10 μm; the spacing from\nthe ground (C) to the edge of TFs, 20 μm; the spacing\nbetween differential feeding lines, 15 μm; and the width\nof the feeding lines, 5 μm. d2 was forced to be in the\nrange of 70%–130% of d1. Then, 1476 TF samples were\nprepared, and samples that had poor performance, namely,\na Q-factor lower than 5 and IL bigger than 2, were excluded.\nFinally, a total of 1285 samples were prepared, and 50 of them\nwere used as back-to-back validation test samples, as shown\nin Fig. 7.\nTo train the INN to return the MC structure parameters,\nsuch as the layout parameters of the TF and values of shunt\ncapacitors, as shown in Fig. 4, simple circuit simulations were\nconducted with the S-parameters and capacitors of the TF\nsamples in the range of [0,c\nmax], where cmax is deﬁned as\nc1,max = 1\n(2π f )2 L1\n(9)\nc2,max = 1\n(2π f )2 L2\n(10)\nwhere L1 and L2 are inductances of the TF’s primary and\nsecondary turn, respectively, which are deﬁned as\nL1 = Im\n(\nZTF,11\n)\n2π f (11)\nL2 = Im\n(\nZTF,22\n)\n2π f . (12)\nA brief ﬂowchart of data preparation for the INN is shown\nin Fig. 8. The detailed pseudocode and notation of data\npreparation are described in Fig. 9 and Algorithm 2. From the\ncircuit simulation, output impedances [Z\nm( f )]o fa l lp o s s i b l e\nMCs were extracted. Finally, 79 625 pairs of input and output\nvectors ( x, yMC) were extracted from the EM and circuit\nsimulations for the supervised learning of the INN. GDS\ngeneration took 1.1 s for each TF layout, so, totally, it took\nabout 27 min. The EM simulation took about 25 s for each\nTF layout, so, totally, it took 10 h on a Linux server (AMD\nLEE et al.: NEURAL-NETWORK-BASED AUTOMATED SYNTHESIS OF TRANSFORMER MATCHING CIRCUITS 4731\nFig. 8. Flowchart of data preparation for INN learning.\nFig. 9. Assumed MC in this work.\nEPYC 7601 32-Core processor, 512-GB RAM, CentOS Linux\n7.9.2009). In this work, we used MA TLAB, Cadence Virtuoso,\nand the EMX 3-D solver.\nIn machine learning, it should be veriﬁed whether the input\nvectors of a dataset sufﬁciently cover the desired design space.\nSince, as shown in Fig. 10(a), the key role of the AMCS is\nto generate an MC satisfying the designer’s requirements, the\ntraining set should include as wide a range of potential input\nparameters as possible, in particularZ\nm . Fig. 10(b) showsZm\nat 60 GHz. As can be seen,Zm in the training set widely covers\nthe inductive impedance region in the Smith chart suitable\nfor matching TR-based ampliﬁers, whose input and output are\ncapacitive.\nFor training the INN, we used a multilayer perceptron\nstructure, the mean squared error (mse) with the “percent”\noption in MATLAB [37] as an error function, the sigmoid\nfunction as the activation function, and the scaled conjugate\ngradient (SCG) algorithm [38]. The training was stopped when\nthe epochs reached 100 000, and the NN model with the lowest\nVariables\nf := [ fl , f2, f3], frequencies\nSTF,n( f ) := 2-port S-parameters ofn−thTF SMC\n(\nSTF,n, f i ,c1,j ,c2,k\n)\n:= 2-port S- parameters of MC composed ofn\n− th TF and shunt capacitors at frequencyf i\nc1,j , c2,k := primary, secondary shunt capacitances of MC\nAlgorihtm 2 Pseudocode of for loop in Fig. 8\n1: Input: STF,n, yTF,n\n2: Output: Dataset\n3: count = 1\n4: for i = 1 : 10 do\n5: f i =[ 261 0 ]+[ 10 10 10 ]∗ (i − 1)\n6: ZTF,11\n(\nf i\n)\n= 50 ×\n1+STF,11(f i )\n1−STF,11(f i )\n7: ZTF,22\n(\nf i\n)\n= 50 ×\n1+STF,22(f i )\n1−STF,22(f i )\n8: L1\n(\nf i\n)\n=\nlm(ZTF,11(f i ))\n2π f i\n9: L2\n(\nf i\n)\n=\nIm(ZTF,22(f i ))\n2π f i\n10: c1,max = max\n(\n1\n(2π f i )\n2×L1 (f i )\n)\n11: c2,max = max\n(\n1\n(2π f i )\n2×L2(f i )\n)\n12: c1 =\n[01234 ]\n× c1,max\n4\n13: c2 =\n[01234 ]\n× c1,max\n4\n14: for j = 1 : 5 do\n15: for k = 1 : 5 do\n16: SMC ← CircuitSimulation(\nSTF,n\n(\nf i\n)\n, f i ,c1,j ,c2,k\n)\n17: Dataset (count) ←\n[\nyTE,n, f i ,c1,j ,c2,k ,SMC\n]\n18: count ← count +1\n19: end for\n20: end for\n21: end for\n22: Return Dataset\nFig. 10. MC output impedance (Zm ). (a) Variation depending onc1 and c2\nand (b) training set at 60 GHz.\nvalidation error according to s tandard practice in machine\nlearning was selected [39].\nThe training results for various numbers of hidden layer\nnode and layer combinations (n × m) in the INN are shown\nin Fig. 11. We independently swept the number of hidden\nlayers from 1 to 9 and the number of nodes as 10, 20, 30, 50,\n100, and 200. As can be seen in Fig. 11(a), the test error\n4732 IEEE TRANSACTIONS ON MICROW A VE THEORY AND TECHNIQUES, VOL. 70, NO. 11, NOVEMBER 2022\nFig. 11. INN’s (a) test errors according to the number of layers and nodes\nand (b) layer structure that has the lowest validation error.\nis signiﬁcantly reduced as the number of nodes increases.\nIn addition, as the number of layers increases, the test error\nis reduced to 2.262× 10−5 for eight layers and 100 nodes at\n100 000 epochs. Finally, the 100× 8 NN in Fig. 11(b) was\nselected for the INN. Training for the 100× 8I N Nt o o k7h\non a PC (MA TLAB code in Intel i5-7500, RAM 16 GB, SDD,\nNVIDA GeForce RTX 2080 Ti).\nV. F\nORW ARDNEURAL NETWORK\nA. Forward Neural Network\nIn the AMCS procedure, the designer must, in general,\nverify whether the MC works properly by full EM simula-\ntion, which is a time-consuming task. In the AMCS, another\nnetwork, a forward neural network (FNN), is deployed to\nestimate the full two-port S-parameters (S\nTF) and Q-factors\n(Q1, Q2) at the target frequency with the TF’s layout from the\nINN. The input and output vectors for the FNN in this work\nwere intuitively designed by mapping the TF geometry to the\nS-parameters (“layout-to-spec”) as follows:\ny\nTF = [ f,d1,d2,w1,w2,δ ]\u0002 (13)\nˆx =\n[ˆSTF( f ), ˆQTF,1( f ), ˆQTF,2( f )\n]\u0002\n(14)\nˆx = FNN (yTF). (15)\nFig. 12. FNN’s (a) ﬂowchart of data preparation and (b) comparison with\nEM simulation.\nFig. 13. FNN’s (a) test error according to layer structure (hatched area could\nnot be determined due to memory limits) and (b) layer structure that has the\nlowest validation error.\nThe whole procedure of the training set preparation for the\nFNN, shown in Fig. 12(a), is almost identical to that for the\nINN. The FNN dataset shared the GDS and EM simulation\nresults from the INN dataset. It took 5 min to calculate the\nQ-factor and IL. It should be noted that, unlike the INN,\nFNN mapping from the TF layout toS-parameters is a many-\nto-one problem, in which an NN can be effectively modeled.\nThe FNN was trained with 295 200 pairs of input and output\nvectors by using the SCG algorithm with the mse and sigmoid\nfunction. Also, the training was stopped when the epochs\nreached 50 000. Training for the 100 × 8 FNN took 15 h\nLEE et al.: NEURAL-NETWORK-BASED AUTOMATED SYNTHESIS OF TRANSFORMER MATCHING CIRCUITS 4733\nFig. 14. Structure of AMCS combined with FNN which can predict MC’s operation.\nFig. 15. (a) Back-to-back validation procedure. (b) Histogram of\u0003error calculated from the back-to-back validation.\no nt h es a m eP Ca st h a tu s e df o rt h eI N N .T h eF N Np r e d i c t s\nTF operation very accurately, as shown in Fig. 12(b).\nThe hyperparameters n × m of the FNN were also var-\nied, the same as they were in the INN. As shown in Fig. 13(a),\nthe 100 × 8 NN in Fig. 13(b), which was chosen for accurate\nS-parameter estimation in this work, exhibited the minimum\nt e s te r r o ro f1 . 5 4 1× 10−6.\nThe FNN took around 0.1 s and the EM simulation took\naround 25 s for each TF sample, although the FNN was\nslightly less accurate than th e EM simulation. Therefore,\nby using the FNN, users can predict much faster whether\nan MC will work in a wider frequency range and select one\nbased on more detailed performance characteristics such as\nbandwidth. This work ultimately proposes a design procedure\nthat can also predict the MC operation, as shown in Fig. 14.\nIn this work, to examine how close the matching\nimpedances of the auto-synthesized matching network are to\nthose the user inputs, we deﬁned the FoM as the root mean\nsquare of the difference between desired impedances[\u0003\n\u0006\nm( f )]\nand predicted impedances[ ˆ\u0003m( f )]\nFoM = \u0004\u0003m :=\n√\n1\n3\n∑ 3\ni=1\n⏐⏐\u0003\u0006m ( fi ) − ˆ\u0003m( fi )\n⏐⏐2\n. (16)\nB. Back-to-Back Validation\nFig. 15(a) shows the detailed procedure for the back-to-back\nvalidation. To verify the accuracy of the AMCS, we prepared\nFig. 16. Method to select matching impedances (Zm ).\ntest MC samples consisting of a test TF sample and two\nshunt capacitors ( c1, c2) and, ﬁnally, extracted a total of\n3200 back-to-back validation sets comprising impedances at\nthree frequencies from the test MC samples. The back-to-back\nvalidation sets were then input to the AMCS, and the estimated\nimpedance ˆZ\nm( f ) was calculated fromˆSMC( f ).T ov e r i f yt h e\naccuracy of the AMCS, we compared output impedances from\nthe EM simulation with output impedances predicted by the\nAMCS. The comparison was made with the function of error\nin the reﬂection coefﬁcient domain as follows:\n\u0003\nerror =\n√\n1\n3\n∑ 3\ni=1\n⏐⏐\u0003m ( fi ) − ˆ\u0003m ( fi )\n⏐⏐2\n. (17)\nThe error distribution \u0003error shown in Fig. 15(b) was ﬁt to\nthe log-normal distribution, and the expectation was 0.0340.\n4734 IEEE TRANSACTIONS ON MICROW A VE THEORY AND TECHNIQUES, VOL. 70, NO. 11, NOVEMBER 2022\nTABLE I\nTEN MC LA YOUTCANDIDATES PROPOSED BY AMCS IN DESIGN EXAMPLE 1 40-GHz CASE\nVI. D ESIGN EXAMPLE 1: OPERATING FREQUENCY\nThe AMCS was veriﬁed by designing MCs for a simple\none-stage ampliﬁer required to offer 10% fractional bandwidth\nat 28, 40, 60, and 70 GHz. A common-source differential\ncore cell was assumed in this work. To improve the isolation\ncharacteristics, core TRs were neutralized with cross-coupled\ncapacitors to enable a unilateral MC design. In general, select-\ning input and/or output impedances to be matched with MCs\ndetermines the overall performance of ampliﬁers, in particular\nfor power and low-noise purposes. In this work, as shown in\nFig. 16, the target impedances were selected by the following\nprocedure: 1) assuming the input and output impedance of TRs\ncan be equivalently modeled with a shunt resistor and capaci-\ntor, plot constant gain circles at the edge and center frequencies\nof the target bandwidth, and 2) ﬁnd three intersection points\nbetween the gain circles and admittance circles in the Smith\nchart and use them as target impedances. The minimum and\nmaximum bounds ofQ were set to 4 and 30, and those of IL\nwere set to 0.5 and 2 dB, respectively, so that the AMCS could\nevaluate almost all possible circuit combinations generated by\nthe INN.\nTable I lists the best ten sets ofauto-generated MC structure\nparameters, including the TF layout generated for 40-GHz out-\nput matching. The ten candidates provide output impedances\nclose to desired ones overall with little deviation in\u0003\nerror but\nwith different TFs and capacitors. In this work, for instance,\nwe selected MC #3 because it consisted of a TF with high\nQ1 and Q2. Depending upon purposes, the user may choose\nanother MC with small capacitance.\nFig. 17 shows the characteristics of the auto-generated MCs\nfor 28, 40, 60, and 70 GHz from the FNN along with full-EM\nsimulators for direct comparison. As can be seen in Fig. 17, the\ntarget impedances at all frequencies except 28 GHz, at which\nthe target impedances are located in the region of\u0003> 0.94,\nare well matched with the MCs auto-generated with the\nAMCS. S-parameters estimated by the FNN well agree with\nthose from the EM simulation of the auto-generated layouts.\nFig. 18 shows the operations of ampliﬁers that were matched\nby the AMCS. As can be seen in Fig. 18, the ampliﬁers were\nwell matched throughS\n11 and S22’s magnitude below−10 dB\nat the design frequencies.\nFig. 17. Smith charts of proposed MCs. Gray line: gain circles of each\nfrequency. Dashed line: constant admittance circle. Black dots: selected\nmatching impedances. Red: impedances predicted by AMCS. Blue line: those\ncalculated by EM simulation of MC.\nAs shown in Table II, the bandwidth characteristics well\nnet the target. However, gain performance was lower than the\ntarget. This is because the desired impedances were in the\nhigh-\u0003 region and thus could not be matched with lossy TF\nelements, as seen in the 28-GHz case, because of the IL of\nthe MC itself, i.e., from 1 to 1.5 dB per MC. Table III and\nFig. 19 summarize the MC structure parameters for each case.\nLEE et al.: NEURAL-NETWORK-BASED AUTOMATED SYNTHESIS OF TRANSFORMER MATCHING CIRCUITS 4735\nFig. 18. EM simulated S-parameters of MCs generated by AMCS according\nto the operating frequency. Line with star: target gain. Colored solid lines:\nS\n21. Colored dashed lines:S11 and S22. Black solid line: maximum available\ngain.\nTABLE II\nCHARACTERISTICS OF AMPLIFIERS MATCHED BY AMCS\nTABLE III\nPROPOSED MC LA YOUTS A TEACH FREQUENCY\nIt should be noted that the AMCS’s “spec-to-layout” syn-\nthesis procedure from impedance input to layout generation\ntook around 10 min at each frequency with a PC (MATLAB\ncode in Intel i5-7500, RAM 16 GB, SDD, NVIDA GeForce\nRTX 2080 Ti).\nVII. D ESIGN EXAMPLE 2: BANDWIDTHS\nThe second example is the design of MCs for 40-GHz\nampliﬁers operating in various bandwidths of 10%, 20%, 25%,\nFig. 19. Layouts of all matched ampliﬁers depending on frequencies.\nFig. 20. Smith charts of the proposed MCs. Gray line: gain circles of\neach frequency. Dashed line: constant admittance circle. Black dots: selected\nmatching impedances. Red line: impedances predicted by AMCS. Blue line:\nthose calculated by EM simulation of MC.\nand 37.5%. To maintain in-band ﬂat gain, constant gain circles\nwere used to determine the target impedances.\n4736 IEEE TRANSACTIONS ON MICROW A VE THEORY AND TECHNIQUES, VOL. 70, NO. 11, NOVEMBER 2022\nFig. 21. EM simulated S-parameters of MCs generated by AMCS according\nto bandwidth. Line with star: target gain. Colored solid lines:S21. Colored\ndash lines: S11 and S22. Black solid line: maximum available gain.\nFig. 22. Layouts of all matched ampliﬁers depending on each bandwidth.\nFig. 20 shows the matching impedances of the designed\nMCs and the S-parameters of the ampliﬁers from the FNN\nalong with those from full-EM simulators for direct compar-\nison. As can be seen in Fig. 20, the target impedances at all\nfrequencies are well matched with the auto-generated MCs.\nS-parameters estimated by the FNN show good agreement\nwith those from the EM simulation. As shown in Fig. 21, the\nampliﬁers were well matched throughS\n11 and S22’s magnitude\nunder −10 dB at the design frequencies. Table IV summarizes\nthe target and performance results for all cases. Table V and\nFig. 22 summarize the MC structure parameters for each case.\nTABLE IV\nCHARACTERISTICS OF AMPLIFIERS MATCHED BY AMCS\nTABLE V\nPROPOSED MC LA YOUTSDEPENDING ON EACH BANDWIDTH\nTABLE VI\nCOMPARISON BETWEEN STATE OF THE ARTS\nOF AUTOMA TED TF SYNTHESIZERS\nVIII. C ONCLUSION AND DISCUSSION\nIn this article, an NN-based AMCS was presented to syn-\nthesize TF layouts for impedance MCs satisfying the desired\nimpedance. Input features were carefully designed to avoid\nthe one-to-many problem, which would be underﬁt by NNs.\nInstead of full two-port S-parameters of MCs, which cannot be\nprovided by designers, we suggested input features such as the\nLEE et al.: NEURAL-NETWORK-BASED AUTOMATED SYNTHESIS OF TRANSFORMER MATCHING CIRCUITS 4737\nQ-factors and IL of TFs for use as constraint factors. The pro-\nposed features effectively represent the full two-port charac-\nteristics of the desired MC and facilitate one-to-one mapping.\nThe concept of HITL to deal with the Q-factors and IL in the\nproposed AMCS gives us additional freedom to design MCs;\nthe AMCS returns multiple MCs and allows users to select\none of them depending upon their purposes in a handy way.\nWith the proposed AMCS, we designed simple single-stage\nampliﬁers operating at different frequencies up to 70 GHz or in\ndifferent bandwidths up to 32.5%. The estimated S-parameters\nof the ampliﬁers showed good agreement with the EM sim-\nulation results. As can be seen in Table VI, the AMCS\nprovides a faster and more efﬁcient way to synthesize MCs\nwith TFs. The proposed NN-based AMCS can dramatically\nreduce design time by eliminating various time-consuming\nand iterative tasks and can enhance the accuracy of the\nhigh-frequency circuit design by offering a “spec-to-layout”\nprocedure.\nFinally, it is worth noting the limitations of the current\napproach, which need to be overcome for fully automated RF\ncircuit design.\n1) The proposed AMCS currently matches core transistors\nonly to 50 \u0002. In order to generate interstage matching for\narbitrary impedance, training datasets should be prepared for\nall possible impedance combinations for a given TF. Though\nit will not cause the one-to-many problem, training error must\nhighly depend on the coverage of the impedance to be matched\nin the Smith chart.\n2) In this method, the designer should select the target\noutput impedances at target frequencies, which dominate\nthe ampliﬁer’s performance. If a user selects unachievable\noutput impedances, the AMCS may return wrong TF lay-\nouts that do not provide good enough RF performance.\nAnother loop for the various possible impedances based on\nthe HITL concept would be a simple way to avoid this,\nbut additional cost function design and input impedance\nselection routines will be required for reducing computing\ntime.\n3) The AMCS can only generate 1:1 TFs that are predeﬁned\nwith various parameters. Since there must be multiple possible\nlayouts for given impedances, training NNs for arbitrary-shape\nTF generation will suffer from the one-to-many problem. This\nis one of the most importance open research problems for the\nNN-based RFIC design.\n4) Currently, EM simulation based on the accurate process\nparameters would be the most efﬁcient and simplest way\nto prepare the training datasets; it would rarely be possi-\nble to prepare several thousand samples for measurement.\nHowever, to implement a more generalized AMCS support-\ning the functionalities mentioned above, several ten or even\nseveral hundred times more EM simulations need to be run\n(i.e., 1476 simulations in the current work). From this point of\nview, efﬁcient data sampling algorithms should be intensively\ninvestigated as well [40].\nDespite the limitations, this work clearly showed that the\nconcept of input feature design and HITL is effective for\nautomated RFIC design.\nR\nEFERENCES\n[1] K. Kim, K. Lee, S. Cho, G. Shin, and H. J. Song, “A 28–34-GHz\nstacked-FET power ampliﬁer in 28-nm FD-SOI with adaptive back-gate\ncontrol for improving linearity,”IEEE Solid-State Circuits Lett. ,v o l .4 ,\npp. 52–55, 2021, doi:10.1109/LSSC.2021.3054885.\n[2] K. Kim et al. , “A 50-Gb/s compact RadCom E-band transmitter with\nphase-controlled push–push quadrupler and stacked-FET power ampli-\nﬁer,” IEEE Solid-State Circuits Lett. , vol. 4, pp. 150–153, 2021, doi:\n10.1109/LSSC.2021.3108486.\n[3] K. Lee, K. Kim, G. Shin, and H. J. Song, “65.6–75.2-GHz phase-\ncontrolled push–push frequency quadrupler with 8.3% DC-to-RF efﬁ-\nciency in 40-nm CMOS,” IEEE Microw. Wireless Compon. Lett. ,\nvol. 31, no. 6, pp. 579–582, Jun. 2021, doi: 10.1109/LMWC.2021.\n3068179.\n[4] G. Shin, K. Kim, K. Lee, H.-H. Jeong, and H.-J. Song, “An\nE-band 21-dB variable-gain ampliﬁer with 0.5-V supply in 40-nm\nCMOS,” Electronics, vol. 10, no. 7, p. 804, Mar. 2021, doi:10.3390/\nelectronics10070804.\n[5] S. Hu, F. Wang, and H. Wang, “2.1 A 28 GHz/37 GHz/39 GHz\nmultiband linear Doherty power ampliﬁer for 5G massive MIMO\napplications,” in IEEE Int. Solid-State Circuits Conf. (ISSCC)\nDig. Tech. Papers , Feb. 2017, pp. 32–33, doi: 10.1109/ISSCC.2017.\n7870246.\n[6] K. Okada et al. , “20.3 A 64-QAM 60 GHz CMOS trans-\nceiver with 4-channel bonding,” in IEEE Int. Solid-State Circuits\nConf. (ISSCC) Dig. Tech. Papers , Feb. 2014, pp. 346–347, doi:\n10.1109/ISSCC.2014.6757463.\n[7] W. Shin, S. Callender, S. Pellerano, and C. Hull, “A compact 75 GHz\nLNA with 20 dB gain and 4 dB noise ﬁgure in 22 nm FinFET CMOS\ntechnology,” inProc. IEEE Radio Freq. Integr. Circuits Symp. (RFIC) ,\nJun. 2018, pp. 284–287, doi:10.1109/RFIC.2018.8429036.\n[8] S. Callender, S. Pellerano, and C. Hull, “A compact 75 GHz PA with\n26.3% PAE and 24 GHz bandwidth in 22 nm FinFET CMOS,” in\nProc. IEEE Radio Freq. Integr. Circuits Symp. (RFIC) , Jun. 2018,\npp. 224–227, doi: 10.1109/RFIC.2018.8428993.\n[9] C. Wang, H. Liao, Y . Xiong, C. Li, R. Huang, and Y . Wang,\n“A physics-based equivalent-circuit model for on-chip symmetric trans-\nformers with accurate substrate modeling,” IEEE Trans. Microw.\nTheory Techn. , vol. 57, no. 4, pp. 980–990, Apr. 2009, doi:\n10.1109/TMTT.2009.2014479.\n[10] J. D. Lohn and S. P. Colombano, “A circuit representation technique\nfor automated circuit design,”IEEE Trans. Evol. Comput., vol. 3, no. 3,\npp. 205–219, Sep. 1999, doi:10.1109/4235.788491.\n[11] T. Sripramong and C. Toumazou, “The invention of CMOS ampli-\nﬁers using genetic programming and current-ﬂow analysis,” IEEE\nTrans. Comput.-Aided Design Integr. , vol. 21, no. 11, pp. 1237–1252,\nNov. 2002, doi:10.1109/TCAD.2002.804109.\n[12] K. Usami et al. , “Automated low-power technique exploiting multiple\nsupply voltages applied to a media processor,” IEEE J. Solid-State\nCircuits, vol. 33, no. 3, pp. 463–472, Mar. 1998, doi:10.1109/4.661212.\n[13] D. Binu and B. S. Kariyappa, “ RideNN: A new rider optimization\nalgorithm-based neural network for fault diagnosis in analog circuits,”\nIEEE Trans. Instrum. Meas. , vol. 68, no. 1, pp. 2–26, Jan. 2019, doi:\n10.1109/TIM.2018.2836058.\n[14] G. Wolfe and R. Vemuri, “Extraction and use of neural network models\nin automated synthesis of operational ampliﬁers,” IEEE Trans. Very\nLarge Scale Integr. (VLSI) Syst.\n, vol. 22, no. 2, pp. 198–212, Feb. 2003,\ndoi: 10.1109/TCAD.2002.806600.\n[15] R. A. Rutenbar, G. G. E. Gielen, and J. Roychowdhury, “Hierarchical\nmodeling, optimization, and synthesis for system-level analog and RF\ndesigns,” Proc. IEEE , vol. 95, no. 3, pp. 640–669, Mar. 2007, doi:\n10.1109/JPROC.2006.889371.\n[16] A. C. Watson, D. Melendy, P. Francis, K. Hwang, and A. Weisshaar,\n“A comprehensive compact-modeling methodology for spiral induc-\ntors in silicon-based RFICs,” IEEE Trans. Microw. Theory Techn. ,\nvol. 52, no. 3, pp. 849–857, Mar. 2004, doi: 10.1109/TMTT.2004.\n823594.\n[17] N. Wainstein, T. Tsabari, Y . Goldin, E. Yalon, and S. Kvatinsky,\n“A dual-band CMOS low-noise ampliﬁer using memristor-based\ntunable inductors,” in Proc. IEEE Comput. Soc. Annu. Symp.\nVLSI (ISVLSI) , Jul. 2019, pp. 290–295, doi: 10.1109/ISVLSI.\n2019.00060.\n[18] A. M. Niknejad, “Modeling of passive elements with ASITIC,” in\nIEEE Radio Freq. Integr. Circuits (RFIC) Symp. Dig. Papers , 2002,\npp. 303–306, doi: 10.1109/RFIC.2002.1012054.\n4738 IEEE TRANSACTIONS ON MICROW A VE THEORY AND TECHNIQUES, VOL. 70, NO. 11, NOVEMBER 2022\n[19] A. Papadimitriou and M. Bucher, “Optimization of RF low noise\nampliﬁer design using analytical model and genetic computation,” in\nProc. 24th Int. Conf. “Mixed Design Integr. Circuits Syst. (MIXDES) ,\nJun. 2017, pp. 302–307, doi:10.23919/MIXDES.2017.8005220.\n[20] B. Liu, D. Zhao, P. Reynaert, and G. Gielen, “Synthesis of integrated\npassive components for high-frequency RF ICs based on evolutionary\ncomputation and machine learning techniques,”IEEE Trans. Comput.-\nAided Design Integr. Circuits Syst. , vol. 30, no. 10, pp. 1458–1468,\nOct. 2010, doi:10.1109/TCAD.2011.2162067.\n[21] B. Liu, D. Zhao, P. Reynaert, and G. G. E. Gielen, “GASPAD: A\ngeneral and efﬁcient mm-wave inte grated circuit synthesis method\nbased on surrogate model assisted evolutionary algorithm,”IEEE Trans.\nComput.-Aided Design Integr. Circuits Syst., vol. 33, no. 2, pp. 169–182,\nFeb. 2014, doi:10.1109/TCAD.2013.2284109.\n[22] R. Martins et al. , “Two-step RF IC block synthesis with preoptimized\ninductors and full layout generation in-the-loop,”IEEE Trans. Comput.-\nAided Design Integr. Circuits Syst. , vol. 38, no. 6, pp. 989–1002,\nJun. 2019, doi:10.1109/TCAD.2018.2834394.\n[23] G. L. Creech, B. J. Paul, C. D. Lesniak, T. J. Jenkins, and\nM. C. Calcatera, “Artiﬁcial neural networks for fast and accurate EM-\nCAD of microwave circuits,” IEEE Trans. Microw. Theory Techn. ,\nvol. 45, no. 5, pp. 794–802, May 1997, doi:10.1109/22.575602.\n[24] W. Na, F. Feng, C. Zhang, an d Q. Zhang, “A uniﬁed automated\nparametric modeling algorithm using knowledge-based neural network\nand l\n1 optimization,” IEEE Trans. Microw. Theory Techn., vol. 65, no. 3,\npp. 729–745, 2017, doi:10.1109/TMTT.2016.2630059.\n[25] C. Zhang, J. Jin, W. Na, Q. J. Zhang, and M. Yu, “Multivalued neural\nnetwork inverse modeling and applications to microwave ﬁlters,”IEEE\nTrans. Microw. Theory Techn., vol. 66, no. 8, pp. 3781–3797, Aug. 2018,\ndoi: 10.1109/TMTT.2018.2841889.\n[26] M. Ohira, A. Yamashita, Z. Ma, and X. Wang, “Automated microstrip\nbandpass ﬁlter design using feedforward and inverse models of neural\nnetwork,” in Proc. Asia–Paciﬁc Microw. Conf. (APMC) , Nov. 2018,\npp. 1292–1294, doi: 10.23919/APMC.2018.8617627.\n[27] H. Kabir, Y . Wang, M. Yu, and Q.-J. Zhang, “Neural network inverse\nmodeling and applications to microwave ﬁlter design,” IEEE Trans.\nMicrow. Theory Techn. , vol. 56, no. 4, pp. 867–879, Apr. 2008, doi:\n10.1109/TMTT.2008.919078.\n[28] D. Munzer et al. , “Residual network based direct synthesis of EM\nstructures: A study on one-to-one transformers,” inProc. IEEE Radio\nFreq. Integr. Circuits Symp. (RFIC) , Aug. 2020, pp. 143–146, doi:\n10.1109/RFIC49505.2020.9218278.\n[29] S. Er et al., “Deep learning assisted end-to-end synthesis of mm-wave\npassive networks with 3D EM structures: A study on a transformer-based\nmatching network,” inIEEE MTT-S Int. Microw. Symp. Dig., Jun. 2021,\npp. 66–69, doi: 10.1109/IMS19712.2021.9575030.\n[30] C. Tang and R. R. Salakhutdinov, “Learning stochastic feedforward\nneural networks,” in Proc. Adv. Neural Inf. Process. Syst. , 2013,\npp. 503–538.\n[31] K. P. Murphy, Probabilistic Machine Learning: An Introduction .\nCambridge, MA, USA: MIT Press, 2022.\n[32] L. Wang, A. Schwing, and S. Lazebnik, “Diverse and accurate image\ndescription using a variational auto-encoder with an additive Gaussian\nencoding space,” inProc. Adv. Neural Inf. Process. Syst., vol. 30, 2017,\npp. 1–11.\n[33] K. Sohn, H. Lee, and X. Yan, “Learning structured output representation\nusing deep conditional generative models,” in Proc. Adv. Neural Inf.\nProcess. Syst., vol. 28, 2015, pp. 1–9.\n[34] R. Bajwa and M. K. Yapici, “Integrated on-chip transformers: Recent\nprogress in the design, layout, modeling and fabrication,” Sensors,\nvol. 19, no. 16, p. 3535, Aug. 2019, doi:10.3390/s19163535.\n[35] P. P. Chu, “A neural network for solving optimization problems with lin-\near equality constraints,” inProc. Int. Joint Conf. Neural Netw. (IJCNN),\nvol. 2, Jun. 1992, pp. 272–277, doi:10.1109/IJCNN.1992.226996.\n[36] D. Honeycutt, M. Nourani, and E. Ragan, “Soliciting human-in-the-loop\nuser feedback for interactive machine learning reduces user trust and\nimpressions of model accuracy,” in Proc. AAAI Conf. Hum. Comput.\nCrowdsourcing, Jan. 2020, vol. 8, no. 1, pp. 63–72. [Online]. Available:\nhttps://ojs.aaai.org/index.php/HCOMP/article/view/7464\n[37] MathWorks. MATLAB MSE . Accessed: May 7, 2022. [Online]. Avail-\nable: https://mathworks.com/help/deeplearning/ref/mse.html\n[38] M. Møller, “A scaled conjugate gradient algorithm for fast super-\nvised learning,” Neural Netw., vol. 6, no. 4, pp. 525–533, 1990, doi:\n10.1016/S0893-6080(05)80056-5.\n[39] F. Girosi, M. Jones, and T. Poggio,“Regularization theory and neural\nnetworks architectures,” Neural Comput. , vol. 7, no. 2, pp. 219–269,\nMar. 1995, doi:10.1162/neco.1995.7.2.219.\n[40] Z. Zhang, Q. S. Cheng, H. Chen, and F. Jiang, “An efﬁcient hybrid sam-\npling method for neural network-based microwave component modeling\nand optimization,”IEEE Microw. Wireless Compon. Lett., vol. 30, no. 7,\npp. 625–628, Jul. 2020, doi:10.1109/LMWC.2020.2995858.\nDongyoon Lee received the B.S. degree in electrical\nengineering from the Pohang University of Sci-\nence and Technology (POSTECH), Pohang, Repub-\nlic of Korea, in 2022. He is currently pursuing\nthe M.S. degree in electrical engineering at the\nKorea Advanced Institute of Science and Technology\n(KAIST), Daejeon, Republic of Korea.\nGibeom Shin received the B.S. degree in electronics\nengineering from Kyungpook National University,\nDaegu, South Korea, in 2018, and the M.S. degree\nin electrical engineering from the Pohang University\nof Science and Technology (POSTECH), Pohang,\nSouth Korea, in 2020.\nSeunghoon Lee (Graduate Student Member, IEEE)\nreceived the B.S. degree in electrical engineering\nfrom the Pohang University of Science and Tech-\nnology (POSTECH), Pohang, Republic of Korea,\nin 2016, where he is currently pursuing the Ph.D.\ndegree.\nHis research interests include phased-array anten-\nnas and millimeter-wave transmitters for wireless\ncommunication and radar applications.\nKyunghwan Kim (Graduate Student Member,\nIEEE) r eceived the B.S. degree in electrical\nengineering from the Pohang University of Science\nand Technology (POSTECH), Pohang, South Korea,\nin 2016, where he is currently pursuing the Ph.D.\ndegree in electrical engineering.\nHis current research interests include millimeter-\nwave transceivers, power ampliﬁers, and\nphased-array systems for wireless communication\nand radar in CMOS technology.\nLEE et al.: NEURAL-NETWORK-BASED AUTOMATED SYNTHESIS OF TRANSFORMER MATCHING CIRCUITS 4739\nTae-Hyun Oh (Member, IEEE) r eceived the\nB.E. degree (Hons.) in computer engineering\nfrom Kwangwoon University, Seoul, South Korea,\nin 2010, and the M.S. and Ph.D. degrees in elec-\ntrical engineering from the Korea Advanced Insti-\ntute of Science and Technology (KAIST), Daejeon,\nSouth Korea, in 2012 and 2017, respectively.\nHe is currently an Assistant Professor of electrical\nengineering (adjunct with the Graduate School of\nAI and the Department of Creative IT Convergence)\nat the Pohang University of Science and Technol-\nogy (POSTECH), Pohang, South Korea. He is also the Research Director\nat OpenLab, POSCO-RIST, Pohang. Before joining POSTECH, he was\na Post-Doctoral Associate with MIT CSAIL, Cambridge, MA, USA, and\nFacebook AI Research, Cambridge. He was a Research Intern at Microsoft\nResearch, Beijing, China, in 2014 and 2016.\nDr. Oh was a recipient of the Microsoft Research Asia Fellowship, the\nSamsung HumanTech Thesis Gold Award, the Qualcomm Innovation Awards,\nand top research achievement awards from KAIST. He was also selected as\nan Outstanding Reviewer in CVPR 2020 and ICLR 2022. He serves as an\nAssociate Editor forThe Visual Computer journal.\nHo-Jin Song (Senior Member, IEEE) received the\nB.S. degree in electronics engineering from Kyung-\npook National University, Daegu, South Korea,\nin 1999, and the M.S. and Ph.D. degrees in electrical\nengineering from the Gwangju Institute of Science\nand Technology (GIST), Gwangju, South Korea, in\n2001 and 2005, respectively.\nHe joined Nippon Telegraph and Telephone,\nTokyo, Japan, in 2006, which is the third largest\ntelecommunication company in the world, and he\nhad engaged in the development of sub-millimeter-\nwave (mm-wave) and terahertz-wave devices, circuits, and systems for com-\nmunication, remote sensing, and imaging applications. In 2015, he was named\nto a Distinguished Research Scientist of NTT Labs. Since 2016, he has been\nwith the Department of Electrical Engineering, Pohang University of Science\nand Technology (POSTECH), Pohang, Gyeongbuk, South Korea. His current\nresearch interests include mm-wave and terahertz circuits, antennas, packages,\nand test-bed systems, particularly for wireless communication, connectivity\nand radar applications.\nDr. Song was a recipient of the GIST Best Thesis Award in 2005, the NTT\nLabs Research of the Year Award in 2009 and 2014, the Young Scientist\nAward of Spectroscopical Society of Japan in 2010, the IEEE Microwave and\nWireless Component Letters Tatsuo Itoh Best Paper Award in 2014, and the\nBest Industrial Paper Award at IEEE MTTs-IMS 2016 in 2016. He served as\nan IEEE Distinguished Microwave Lecturer from 2019 to 2021."
}