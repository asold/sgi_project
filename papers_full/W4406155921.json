{
  "title": "A foundation model of transcription across human cell types",
  "url": "https://openalex.org/W4406155921",
  "year": 2025,
  "authors": [
    {
      "id": "https://openalex.org/A2124796522",
      "name": "Fu Xi",
      "affiliations": [
        "Columbia University"
      ]
    },
    {
      "id": "https://openalex.org/A2950674037",
      "name": "Mo, Shentong",
      "affiliations": [
        "Mohamed bin Zayed University of Artificial Intelligence",
        "Carnegie Mellon University"
      ]
    },
    {
      "id": "https://openalex.org/A4302729646",
      "name": "Buendia, Alejandro",
      "affiliations": [
        "Columbia University"
      ]
    },
    {
      "id": null,
      "name": "Laurent, Anouchka P.",
      "affiliations": [
        "Columbia University",
        "Cancer Genetics (United States)"
      ]
    },
    {
      "id": "https://openalex.org/A4299200229",
      "name": "Shao, Anqi",
      "affiliations": [
        "Columbia University"
      ]
    },
    {
      "id": null,
      "name": "Alvarez-Torres, Maria del Mar",
      "affiliations": [
        "Columbia University"
      ]
    },
    {
      "id": "https://openalex.org/A3015856511",
      "name": "Yu Tianji",
      "affiliations": [
        "Columbia University"
      ]
    },
    {
      "id": "https://openalex.org/A2362703685",
      "name": "Tan Jimin",
      "affiliations": [
        "New York University"
      ]
    },
    {
      "id": null,
      "name": "Su, Jiayu",
      "affiliations": [
        "Columbia University"
      ]
    },
    {
      "id": null,
      "name": "Sagatelian, Romella",
      "affiliations": [
        "Columbia University"
      ]
    },
    {
      "id": null,
      "name": "Ferrando, Adolfo A.",
      "affiliations": [
        "Regeneron (United States)",
        "Columbia University",
        "Cancer Genetics (United States)"
      ]
    },
    {
      "id": null,
      "name": "Ciccia, Alberto",
      "affiliations": [
        "Columbia University"
      ]
    },
    {
      "id": "https://openalex.org/A2348028104",
      "name": "Lan Yan-yan",
      "affiliations": [
        "Tsinghua University"
      ]
    },
    {
      "id": null,
      "name": "Owens, David M.",
      "affiliations": [
        "Columbia University"
      ]
    },
    {
      "id": null,
      "name": "Palomero, Teresa",
      "affiliations": [
        "Cancer Genetics (United States)",
        "Columbia University"
      ]
    },
    {
      "id": "https://openalex.org/A4222901025",
      "name": "Xing, Eric P.",
      "affiliations": [
        "Carnegie Mellon University",
        "Mohamed bin Zayed University of Artificial Intelligence"
      ]
    },
    {
      "id": "https://openalex.org/A2749556571",
      "name": "Rabadan, Raul",
      "affiliations": [
        "Columbia University"
      ]
    }
  ],
  "references": [
    "https://openalex.org/W3099179344",
    "https://openalex.org/W6785346400",
    "https://openalex.org/W3214158901",
    "https://openalex.org/W3016503012",
    "https://openalex.org/W3203588026",
    "https://openalex.org/W6793544515",
    "https://openalex.org/W3041677475",
    "https://openalex.org/W4323663453",
    "https://openalex.org/W3158339810",
    "https://openalex.org/W2151645052",
    "https://openalex.org/W4288096205",
    "https://openalex.org/W4310099676",
    "https://openalex.org/W2744729996",
    "https://openalex.org/W4385493137",
    "https://openalex.org/W3046196569",
    "https://openalex.org/W2883945062",
    "https://openalex.org/W3042669608",
    "https://openalex.org/W4286500588",
    "https://openalex.org/W4327550249",
    "https://openalex.org/W4378838672",
    "https://openalex.org/W4392168151",
    "https://openalex.org/W4399387478",
    "https://openalex.org/W4313557922",
    "https://openalex.org/W3103797259",
    "https://openalex.org/W6785810135",
    "https://openalex.org/W4280598116",
    "https://openalex.org/W3131634425",
    "https://openalex.org/W4388141911",
    "https://openalex.org/W2294584067",
    "https://openalex.org/W2889944648",
    "https://openalex.org/W2198606573",
    "https://openalex.org/W2991283206",
    "https://openalex.org/W3151678771",
    "https://openalex.org/W4388648559",
    "https://openalex.org/W2157388004",
    "https://openalex.org/W2944545583",
    "https://openalex.org/W2096040928",
    "https://openalex.org/W2030513330",
    "https://openalex.org/W2219596071",
    "https://openalex.org/W2900569176",
    "https://openalex.org/W3133915806",
    "https://openalex.org/W4210828082",
    "https://openalex.org/W3177828909",
    "https://openalex.org/W1971055167",
    "https://openalex.org/W2141776442",
    "https://openalex.org/W3007340233",
    "https://openalex.org/W4390414466",
    "https://openalex.org/W2909547032",
    "https://openalex.org/W2964674548",
    "https://openalex.org/W3093880911",
    "https://openalex.org/W1912537483",
    "https://openalex.org/W1984065010",
    "https://openalex.org/W1769620789",
    "https://openalex.org/W2170222864",
    "https://openalex.org/W1966384388",
    "https://openalex.org/W2089478119",
    "https://openalex.org/W2063662864",
    "https://openalex.org/W4387372690",
    "https://openalex.org/W4361284454",
    "https://openalex.org/W4280512834",
    "https://openalex.org/W4313893501",
    "https://openalex.org/W2171808845",
    "https://openalex.org/W6684835615",
    "https://openalex.org/W2561544479",
    "https://openalex.org/W4313156423",
    "https://openalex.org/W6796581206",
    "https://openalex.org/W4378977530",
    "https://openalex.org/W2304846645",
    "https://openalex.org/W3095688667",
    "https://openalex.org/W6863518065",
    "https://openalex.org/W6930244433",
    "https://openalex.org/W4234765197",
    "https://openalex.org/W1854727002",
    "https://openalex.org/W3173720709",
    "https://openalex.org/W4220824576"
  ],
  "abstract": "Transcriptional regulation, which involves a complex interplay between regulatory sequences and proteins, directs all biological processes. Computational models of transcription lack generalizability to accurately extrapolate to unseen cell types and conditions. Here we introduce GET (general expression transformer), an interpretable foundation model designed to uncover regulatory grammars across 213 human fetal and adult cell types<sup>1,2</sup>. Relying exclusively on chromatin accessibility data and sequence information, GET achieves experimental-level accuracy in predicting gene expression even in previously unseen cell types<sup>3</sup>. GET also shows remarkable adaptability across new sequencing platforms and assays, enabling regulatory inference across a broad range of cell types and conditions, and uncovers universal and cell-type-specific transcription factor interaction networks. We evaluated its performance in prediction of regulatory activity, inference of regulatory elements and regulators, and identification of physical interactions between transcription factors and found that it outperforms current models<sup>4</sup> in predicting lentivirus-based massively parallel reporter assay readout<sup>5,6</sup>. In fetal erythroblasts<sup>7</sup>, we identified distal (greater than 1 Mbp) regulatory regions that were missed by previous models, and, in B cells, we identified a lymphocyte-specific transcription factor-transcription factor interaction that explains the functional significance of a leukaemia risk predisposing germline mutation<sup>8-10</sup>. In sum, we provide a generalizable and accurate model for transcription together with catalogues of gene regulation and transcription factor interactions, all with cell type specificity.",
  "full_text": "Nature | Vol 637 | 23 January 2025 | 965\nArticle\nA foundation model of transcription across \nhuman cell types\nXi Fu1,2,13 ✉, Shentong Mo3,4,13, Alejandro Buendia1,13, Anouchka P . Laurent5, Anqi Shao6, \nMaria del Mar Alvarez-Torres1, Tianji Yu1, Jimin Tan7, Jiayu Su1, Romella Sagatelian1, \nAdolfo A. Ferrando5,8, Alberto Ciccia9, Yanyan Lan10,11, David M. Owens6,12, Teresa Palomero5,12, \nEric P . Xing3,4 ✉ & Raul Rabadan1,2 ✉\nTranscriptional regulation, which involves a complex interplay between regulatory \nsequences and proteins, directs all biological processes. Computational models of \ntranscription lack generalizability to accurately extrapolate to unseen cell types and \nconditions. Here we introduce GET (general expression transformer), an interpretable \nfoundation model designed to uncover regulatory grammars across 213 human fetal \nand adult cell types1,2. Relying exclusively on chromatin accessibility data and sequence \ninformation, GET achieves experimental-level accuracy in predicting gene expression \neven in previously unseen cell types3. GET also shows remarkable adaptability across \nnew sequencing platforms and assays, enabling regulatory inference across a broad \nrange of cell types and conditions, and uncovers universal and cell-type-specific \ntranscription factor interaction networks. We evaluated its performance in prediction \nof regulatory activity, inference of regulatory elements and regulators, and \nidentification of physical interactions between transcription factors and found  \nthat it outperforms current models4 in predicting lentivirus-based massively parallel \nreporter assay readout5,6. In fetal erythroblasts7, we identified distal (greater than \n1 Mbp) regulatory regions that were missed by previous models, and, in B cells, we \nidentified a lymphocyte-specific transcription factor–transcription factor interaction \nthat explains the functional significance of a leukaemia risk predisposing germline \nmutation8–10. In sum, we provide a generalizable and accurate model for transcription \ntogether with catalogues of gene regulation and transcription factor interactions,  \nall with cell type specificity.\nTranscriptional regulation constitutes a critical yet largely unresolved \ndomain that underpins diverse biological processes, including those \nassociated with human genetic diseases and cancers11. Transcriptional \nchanges are orchestrated by a conserved regulatory machinery, includ-\ning transcription factors (TFs) that bind to regulatory sequences; \ncoactivators, mediators, and core transcriptional factors; and RNA poly-\nmerase II (PolII)12. Although different cell types may possess different \nsubsets of regulatory regions, the biochemistry of protein–protein and \nprotein–DNA interactions remains largely the same across cell types \nwhen epigenetic conditions are fixed. Clustering of known TF binding \nsite motifs13 demonstrates significant homology in TF DNA-binding \ndomains, further reducing the combinatorial variability of regulatory \ninteractions. However, our understanding of transcription regula-\ntion is often limited to specific cell types, and it is not clear how the \ncombinatorial interaction of different TFs determines the diversity of \nexpression profiles observed across cell types. As an example, previous \nexpression prediction methods such as Expecto14, Basenji2 (ref. 15) \nand Enformer4 are designed to make predictions on the training cell \ntypes after they have been fine-tuned, hindering the generalizability \nand utility of these models.\nRecently, foundation models such as GPT-4 (ref. 16) and ESM-2 (ref. 17)  \nhave emerged as a transformative approach. With extensive pretraining \non broad and diverse datasets, foundation models provide a gener-\nalized understanding of their training data, upon which specialized \nadaptations can be built to address specific tasks or challenges. For \nexample, recent developments in single-cell foundation models such \nas Geneformer18, scGPT19 and scFoundation20 have demonstrated how \ndiverse transcriptome profiles can be encoded in one model, enabling \nvarious contextualized downstream tasks including cell type anno-\ntation and perturbation prediction. However, no foundation model \nhttps://doi.org/10.1038/s41586-024-08391-z\nReceived: 24 September 2023\nAccepted: 12 November 2024\nPublished online: 8 January 2025\nOpen access\n Check for updates\n1Program of Mathematical Genomics, Department of Systems Biology, Columbia University, New York, NY, USA. 2Department of Biomedical Informatics, Columbia University, New York, NY, USA. \n3Mohamed bin Zayed University of Artificial Intelligence, Abu Dhabi, UAE. 4Department of Machine Learning, Carnegie Mellon University, Pittsburgh, PA, USA. 5Institute for Cancer Genetics, \nColumbia University, New York, NY, USA. 6Department of Dermatology, Columbia University, New York, NY, USA. 7Institute for Systems Genetics, New York University Grossman School of \nMedicine, New York, NY, USA. 8Regeneron Genetics Center, Regeneron, Tarrytown, NY, USA. 9Department of Genetics and Development, Columbia University, New York, NY, USA. 10Institute for \nAI Industry Research, Tsinghua University, Beijing, China. 11Beijing Frontier Research Center for Biological Structure, Tsinghua University, Beijing, China. 12Department of Pathology and Cell \nBiology, Columbia University, New York, NY, USA. 13These authors contributed equally: Xi Fu, Shentong Mo, Alejandro Buendia. ✉e-mail: xf2217@cumc.columbia.edu; epxing@cs.cmu.edu; \nrr2579@cumc.columbia.edu\n966 | Nature | Vol 637 | 23 January 2025\nArticle\nof how transcription emerges from the chromatin landscape has yet \nbeen explored.\nHere we introduce the general expression transformer (GET), an \ninterpretable foundation model for transcriptional regulation. GET \nlearns transcriptional regulatory syntax from chromatin accessibility \ndata across 213 human fetal and adult cell types and accurately predicts \ngene expression in both seen and unseen cell types (Fig. 1a). In addition, \nGET offers zero-shot prediction of reporter assay readout, outperforms \nprevious state-of-the-art models in identifying cis-regulatory elements, \nand identifies previously unknown and known upstream regulators of \nfetal haemoglobin. GET also provides rich cell-type-specific regula-\ntory insights: using coregulation information predicted by GET, we \npinpointed potential motif–motif interactions and constructed a struc-\ntural interaction catalogue of human TFs and coactivators (Fig. 1b). \nUsing this, we identified a lymphocyte-specific TF–TF interaction \ninvolving PAX5 and nuclear receptor family TFs and highlighted a pos-\nsible disease-driving mechanism of a leukaemia-associated germline \nvariant that affects the binding of the PAX5 disordered region to the \nnuclear receptor domain.\nModelling cell-type-specific expression\nThe design philosophy of GET is rooted in the transcription regula-\ntion mechanism. A local genomic region (approximately 2 Mbp) with \npromoters and regulatory elements can be characterized by how well \nthese elements bind different TFs and how accessible they are in specific \ncell types. These features shape a chromatin environment (p(X)) that \ngoverns how PolII drives expression at each individual element, which \ncan be approximated from RNA sequencing (RNA-seq) data. Using \nan embedding and attention architecture21 specifically designed for \nthe regulatory elements, we performed self-supervised pretraining \nto allow GET to learn how the regions and features interact with each \nother across diverse cell types. Specifically, by randomly masking out \nregulatory elements, the model is trained to predict motif binding \nscores and optionally accessibility scores in the masked regions. Sub-\nsequently, PolII will read out the chromatin environment p (X) into \nan expression E. A fine-tuning stage with the same architecture but \na different output head simulates this process (Fig. 1a and Extended \nData Fig. 1). This two-stage design makes it possible to use chromatin \naccessibility data without paired expression measurement, greatly \nimproving the diversity of regulation information in the training data. \nThe pretraining of GET uses pseudobulk chromatin accessibility gath-\nered from single-cell assay for transposase-accessible chromatin with \nsequencing (scATAC-seq) data across 213 human fetal and adult cell \ntypes1,2,22. Of these, 153 cell types were coupled with expression data \nacquired through either a multiome protocol or separate single-cell \nRNA-seq experiments23,24 (Methods: ‘ ATAC-seq data processing’ and \n‘RNA-seq data processing’) and used for fine-tuning and evaluation.\nWe first assessed GET’s ability to accurately predict gene expression \nin unseen cell types in a setting where one cell type is left out during \nthe expression fine-tuning process. On left-out astrocytes and genes \nwith accessible promoters, the Pearson correlation between GET’s \npredicted expression values and the observed expression reached 0.94 \n(R2 = 0.88) (Fig. 1c), in line with experimental accuracy across different \nculture systems and biological replicates of human astrocytes3 (Pearson \nr = 0.92–0.99, Extended Data Fig. 2a). GET’s performance surpassed that \nof both transcription start site (TSS) accessibility (r = 0.47, R2 = −0.23) \nand gene activity score25 (r = 0.51, R2 = −0.67), emphasizing the signifi-\ncance of DNA sequence specificity and distal context information in \ntranscription regulation. Furthermore, GET outperformed top cor-\nrelated cell type expression (r = 0.83, R2 = 0.62) and mean expression \nacross training cell types (r = 0.78, R2 = 0.53; Fig. 1c). GET also accurately \npredicted expression log fold change between two cell types, even \nwhen one of them was unseen (Extended Data Fig. 2b). Across a wide \nrange of fetal cell types evaluated, GET consistently outperformed \ngenome-wide prediction using Enformer’s cap analysis of gene expres-\nsion (CAGE) output tracks and the training cell type mean expression \nbaseline (Extended Data Fig. 2c). We found that the pretraining stage \nwas crucial for leave-out cell type prediction accuracy, as GET with \nonly the fine-tuning stage suffered a significant performance drop \n(Pearson r = 0.6; Extended Data Fig. 2d). GET also outperformed sim-\npler machine learning approaches in both the leave-out cell type and \nStructural\ncatalogue\nof TF\ninteractions\nCausal \ndiscovery\nof TF–TF\ninteractions\nRNA \npolymerase\nTranscription\nfactor\nGET:\nE = (f·p)(X)\nP = p(X)\nX = [Motifs,\naccessibility]\nPretrain p model using accessibility data\nMotifs\nAccessible regions\nMotifs\nAccessible regions\nRandom mask\np\nFinetune f·p model using paired expression data\na\nMotifs\nAccessible regions\nStrandsAccessible regions\nTrain Evaluate\nFill-in mask\nc\nIn silico\nlentiMPRA\nIdentifying\nCREs and\nregulators\nGATA\nb\n03\nGET prediction\n0\n1\n2\n3\nObserved log(TPM) r = 0.94\nR2 = 0.89\n03\nTop correlated cell type\n0\n1\n2\n3\nr = 0.83\nR2 = 0.68\n03\nMean expression\nin training set\n0\n1\n2\n3\nr = 0.78\nR2 = 0.60\n01\nTSS accessibility\n0\n1\n2\n3\nObserved log(TPM) r = 0.47\nR2 = 0.22\n0 0.3\nGene activity\n0\n1\n2\n3\nr = 0.51\nR2 = 0.26\nTSS accessibility\n0.2\n0.4\n0.6\n0.8\n1.0\nf·p E\nFig. 1 | The GET model and its applications. a, Schematic illustration of GET.  \nThe input of GET is a peak (accessible region) × TF (motif) matrix derived from  \na human single-cell (sc)ATAC-seq atlas, summarizing regulatory sequence \ninformation across a genomic locus of more than 2 Mbp. Through self-supervised \nrandom masked pretraining of the input data across more than 200 cell types, \nGET learns transcriptional regulatory syntax (p). GET is fine-tuned on paired \nscATAC-seq and RNA-seq data and learns to transform the regulatory syntax to \ngene expression, even in leave-out cell types (f⋅p). b, Schematic illustration of \ndownstream applications of GET. CRE, cis-regulatory element. c, Benchmark of \nGET prediction performance on an unseen cell type (fetal astrocytes). Each point \nrepresents a gene. Colour represents normalized chromatin accessibility in  \nthe TSS. Gene activity is a score widely used in modern scATAC-seq analysis \npipelines25. Top correlated cell type is the training cell type whose observed gene \nexpression has the strongest correlation with fetal astrocyte (in this case, fetal \ninhibitory neurons). Mean cell type is the mean observed gene expression across \ntraining cell types. Dashed line represents linear fits. Prediction is made for all \naccessible TSS in astrocytes and averaged to gene level. Schematics in a and b \nwere created using BioRender (https://biorender.com).\nNature | Vol 637 | 23 January 2025 | 967\nleave-out chromosome evaluation settings when trained using the \nsame data and number of epochs (Extended Data Fig. 2e,f).\nGeneralizability\nGET also showed generalizability to adult cell types when trained solely \non fetal data, with an average R2 of 0.53 across diverse adult cell types, \nsurpassing the baseline ( R2 = 0.33) obtained using corresponding \nfetal cell types for prediction (Extended Data Fig. 3a). Furthermore, \nGET can be transferred to different sequencing platforms, including  \n10× multiome sequencing of lymph nodes (Extended Data Fig. 3b,c) and \nglioblastoma (GBM) tumour cells26 (Extended Data Fig. 3d–f), as well as \nother experimental assays, including prediction of CAGE and chromatin \naccessibility (Extended Data Fig. 4). Detailed analyses are provided \nin the Supplementary Information (‘Generalizability study of GET’).\nZeroshot regulatory activity prediction\nGiven the versatility of GET across diverse platforms and measure -\nments, we examined its capacity for zero-shot prediction of expression- \ndriving regulatory elements in unseen cell types. Lentivirus-based \nmassively parallel reporter assay (lentiMPRA) provides a robust mecha-\nnism to test the regulatory activity of numerous genetic sequences \nby integrating them into the genome, thereby circumventing the  \nlimitations inherent to episomal MPRAs and ensuring relevant  \nbiological readouts in hard-to-transfect cell lines 5. This experimen-\ntal assay was recently used to assess 226,243 sequences in the K562 \ncell line and enabled the creation of a comprehensive benchmark \ndataset for evaluation of whether the GET model could identify \nregulatory elements in a cell-type-specific context 6 (Fig. 2a). In an \nin silico procedure akin to the lentiMPRA experiment, we used the \nGET model fine-tuned on bulk ENCODE K562 OmniATAC chroma -\ntin accessibility and expression data from NEAT-seq (sequencing of \nnuclear protein epitope abundance, chromatin accessibility and the \ntranscriptome in single cells). Using the GET model, which had seen \nno lentiMPRA data, we inferred the activity of the mini promoter in \nthe corresponding chromatin context and averaged over all inser -\ntions to obtain a mean readout indicative of the regulatory activity \n(Fig. 2a and Methods: ‘LentiMPRA zero-shot prediction’). Overall, the \npredicted readout distribution for different types of element matched \nexpectation (Supplementary Information: ‘Overall distribution of  \nGET-MPRA prediction’).\nLentivirus\nMultiplex genome integration Measure mean \nexpression/insertion\nVector synthesis with \ndifferent regulatory elements\nRandom insertion to human\ngenome\nZero-shot K562 \nlentiMPRA prediction \nwith GET\nLentiMPRA\nIn silico\nlentiMPRA\nIn silico vector sequence\nwith different regulatory\nelements\na\nPredicted log10(TPM + 1)\nb\nObserved lentiMPRA log2(RNA/DNA)\n02\n0\n1\n2\nGET-MPRA\nPearson’s r = 0.53\nP = 1.6 × 10−40\nSlope = 0.45\nn = 541\n02\n0\n1\nPearson’s r = 0.16\nP = 1.4 × 10−3\nSlope = 0.09\nn = 404\n02\n0\n1\nPearson’s r = 0.16\nP = 2.1 × 10−3\nSlope = 0.10\nn = 360\n0 2.5\n0\n1\n2\nPearson’s r = 0.45\nP = 3.9 × 10−101\nSlope = 0.38\nn = 2,000\n02\nPromoter\n0\n2\nEnformer-MPRA\nPearson’s r = 0.40\nP = 3.2 × 10−22\nSlope = 0.17\nn = 541\n02\nEnhancer\n0.2\n0.4\nPearson’s r = 0.39\nP = 2.5 × 10−16\nSlope = 0.07\nn = 404\n02\nRepr. and quies.\n0\n0.5\n1.0\nPearson’s r = 0.43\nP = 7.8 × 10−18\nSlope = 0.07\nn = 360\n0 2.5\nAll\n0\n2\nPearson’s r = 0.44\nP = 1.3 × 10−96\nSlope = 0.14\nn = 2,000\nFig. 2 | In silico lentiMPRA with GET fine-tuned on K562. a, Schematic workflow \nof lentiMPRA experiments and in silico lentiMPRA using GET model fine-tuned  \non K562 multiome data. b, Benchmarking of GET lentiMPRA prediction against \nEnformer on a random subset of elements. The x axes show observed lentiMPRA \nreadout (log2(RNA/DNA)); y axes show predicted expression (log10 transcripts per \nmillion (TPM)). repr., repressive; quies., quiescent. Schematic in a was created \nusing BioRender (https://biorender.com).\n968 | Nature | Vol 637 | 23 January 2025\nArticle\nWhen benchmarking our model against Enformer, which was trained \non 486 tracks of functional K562 genomics data including TF and \nhistone modification chromatin immunoprecipitation followed by \nsequencing (ChIP–seq), CAGE and chromatin accessibility measure-\nments, we found that our model made more accurate predictions and \nscaled better overall (Pearson’s r = 0.55, slope = 0.63 when combined \nwith K562 accessibility signal, and Pearson’s r = 0.45, slope = 0.38 when \nusing only the expression prediction model, versus Enformer’s Pear-\nson’s r = 0.44, slope = 0.14; Fig. 2b and Extended Data Fig. 5a), and its \npredicted regulatory elements showed biologically meaningful enrich-\nment in histone marks and TF binding sites (Extended Data Fig. 5b–d \nand Supplementary Information: ‘Enrichment analysis of GET-MPRA \nprediction’). Enformer showed better correlations in enhancer and \nrepressed regions; this could be attributed to greater coverage of het-\nerochromatin and vast numbers of functional K562 assays in its training \ndata. GET also had significant advantages in terms of computational \ncost. For this comparison, subsampling to 2,000 elements was required \nto benchmark Enformer in 3 days, whereas using the same amount of \ncomputing time allowed GET to screen all 226,243 elements (Supple-\nmentary Information: ‘Computational cost comparison’).\nIdentifying cis-regulatory elements\nThrough model interpretation techniques (Methods: ‘Model interpre-\ntation’), we can efficiently derive region or motif contribution scores \nfor genes with accessible promoters across cell types, producing \nresults for virtually all genes in even less abundant cell types (approx-\nimately 1,000 cells). Focusing on fetal erythroblasts, we leveraged \npublished genome base-editing data to investigate four known fetal \nhaemoglobin-regulating loci7 (BCL11A, NFIX, KLF1 and HBG2; the first \nthree of these are known to regulate fetal haemoglobin, and HBG2  \nencodes a fetal haemoglobin subunit; Fig. 3a).\nApplying GET to fetal erythroblasts yielded insights into the regu-\nlation of fetal haemoglobin. We rediscovered the central role of the \nGATA TF , which, through its binding to an erythroid-specific enhancer, \norchestrates the expression of BCL11A, a known modulator of hae -\nmoglobin regulation27. GET also highlighted the role of the SOX fam-\nily of TFs in this enhancer, which have previously been linked to fetal \nhaemoglobin28 but were not known to function through this specific \nenhancer (Fig. 3b).\nExamining all four loci—BCL11A, NFIX, KLF1 and HBG2—we bench-\nmarked GET against established models including Enformer 4, \nHyenaDNA29, DeepSEA30 and Activity-by-Contact (ABC) 31,32. GET out-\nperformed these counterparts, especially in detecting long-range \nenhancer–promoter interactions (Fig.  3c,d  and Extended Data \nFig. 6a–c). We also found that although enhancer chromatin acces -\nsibility was predictive of regulatory activity for proximal enhancer–\npromoter relationships, its precision diminished for long-range \ninteractions. Alternative evaluations using different functional \nenhancer thresholds (top 10% or 25% of the experimental readout \nHbFBase) reaffirmed the precision of GET in this scenario (Fig. 3d, \ntop). We also benchmarked the same task for the K562 cell line using \na CRISPR interference (CRISPRi)-based benchmark dataset from \nENCODE33 and reached a similar conclusion (Fig.  3d, bottom, and \nExtended Data Fig. 6d).\nIdentifying upstream regulators\nGET can extract aggregated motif importance across cis-regulatory \nelements for specific genes. For HBG2, BCL11A and NFIX, the top motifs \nidentified were consistent with their known transcriptional regulators \nor haematopoietic TFs (Extended Data Fig. 7a), including NFY and \nSOX motifs for HBG2 and KLF1 for BCL11A7. In addition, for NFIX, GET \nhighlighted TAL1, a known GATA1 binding partner and haematopoietic \nfactor34 that has not been linked directly to NFIX regulation.\nT o determine downstream targets for specific regulators, we devel-\noped an in silico analysis, taking the GATA motif as a case study. Using \nthe GET motif contribution matrix, we identified the top 10% of genes \ninfluenced by the GATA motif. Notably, consistent with the role of \nGATA1 in erythroid development, the ‘hemopoiesis’ biological pro-\ncess was enriched35 (Fisher exact test, multiple hypothesis adjusted \nP = 7.6 × 10−4; Extended Data Fig. 7b and Methods: ‘Gene ontology \nenrichment of top target genes of a regulator’) within this gene set. \nKnown erythroid-lineage TFs including KLF1, GATA1, TAL1 and IKZF1 \nwere also predicted to be regulated by the GATA motif36. Further analy-\nsis of motif importance across different cell types demonstrated a link \nbetween motif contribution and target gene expression, supported \nby a universal regulatory embedding (Supplementary Information: \n‘Cross-cell-type motif contribution analysis’ and ‘Cross-cell-type \nembedding analysis’ , Extended Data Fig. 7c–g).\nFinding coregulating TFs\nGiven the proficiency of GET in elucidating regulatory mechanisms \nacross diverse cellular contexts, we next investigated whether it learned \nTF–TF functional interactions implicitly. Using a cell-type-agnostic \ngene-by-motif matrix (Methods: ‘Causal discovery of regulator inter-\naction’), we considered the hypothesis that high correlation between \nmotif columns might represent common genomic targets between \ndifferent TFs. Indeed, TF pairs with correlation values in the top \ndecile were more likely to participate in the same biological functions \ncompared with those in the bottom decile (Extended Data Fig. 7h,  \nKolmogorov–Smirnov test, P = 6.78 × 10−82). For example, MBD2 and \nMECP2, a high-correlation TF pair, both function as readers of DNA \nmethylation37,38.\nApplying a causal discovery algorithm to the cell-type-agnostic \ngene-by-motif matrix led to the discovery of known and previously \nunknown motif–motif interactions (Fig.  4a, Methods: ‘Causal dis -\ncovery of regulator interaction’; examples shown in Extended Data \nFig. 7i, Supplementary Figs. 5 and 6, and Supplementary Informa -\ntion: ‘ Analysis of the GET causal network’). T o quantitatively assess \nthe overlap with known physical interactions between TFs, we com-\npared the GET motif–motif interaction network using two different \napproaches, GET Causal and GET Correlation, with the STRING v.11 \ndatabase39 (Methods: ‘Causal discovery of regulator interaction’). \nOur results showed a precision (true positive rate) of 5.6% for random \nchance. However, by selecting the top 1% (n = 793 pairs) of causal or \ncorrelation pairs from GET’s predictions, we achieved precisions of \n25.2% and 15.9%, respectively (Fig. 4b), confirming the advantage of \nour causal-discovery-based model interpretation approach. As a com-\nparison, a recent mass-spectrometry-based TF–TF interaction study40 \nreported 30.4% precision with the top 1.25% (n = 990) pairs, whereas \na colocalization score computed from HepG2 ChIP–seq for 677 TFs \nyielded a larger number of motif–motif interactions yet had slightly \nlower precision and macro F1 score than GET Causal. Furthermore, \nGET Causal outperformed two accessibility-aware motif colocaliza-\ntion baselines, computed either across cell types or in hepatocytes. \nThis reflects the incompleteness of annotated TF–TF interactions and \nhighlights the value of GET-predicted motif pairs for identifying new \ninteractions.\nGET catalogue of TF interactions\nHaving obtained the network of causal motif interactions predicted by \nGET, we next built a structural catalogue of the human TF interactome \nusing AlphaFold2 (ref. 41). We started by categorizing TF–TF inter-\nactions into several different catalogues: direct interactions, which \nincluded homodimers and intrafamily and interfamily heterodimers; \nand cofactor-mediated interactions, which encompassed both coop-\nerative and competitive binding (Extended Data Fig. 8a). Starting with \nNature | Vol 637 | 23 January 2025 | 969\nthe most straightforward intrafamily interactions, we first acquired all \ndimeric structure predictions of more than 1,700 known human TFs and \nfound that AlphaFold seemed to reliably capture known dimer struc-\ntures and potentially could be used to detect intrafamily heterodimers \n(Methods: ‘ AlphaFold benchmark on intrafamily binder prediction’ , \nExtended Data Fig. 9a,b).\nWe then questioned whether the disordered region in the struc -\nture could fold upon binding to partners. On the basis of the causal- \ndiscovery-predicted TF–TF interactions, we sought to identify poten-\ntial structural interactions using AlphaFold2. We first focused on two \nmotif clusters with small numbers of member TFs, TFAP2/1 and ZFX,  \nwhich were among the largest out-degree motifs in the GET causal \nnetwork (Extended Data Fig. 7j). We segmented the TFAP2A and ZFX \nproteins into four distinct structured or disordered domains on the \nbasis of the predicted local distance difference test (pLDDT) (Extended \nData Fig. 8b) and predicted the multimer structure of all pairwise com-\nbinations of these segments. Remarkably, the originally unstructured \nZFX intrinsically disordered region (IDR) (Extended Data Fig. 8c) folded \ninto a well-defined multimeric structure when paired with TFAP2A \nstructured domains; this was mainly driven by electrostatic interactions \n(Extended Data Fig. 8d). Molecular dynamics simulations (Methods: \n‘Molecular dynamics simulation’) suggested that the monomer IDR \ngRNA\na b\nc\nHbFBase\nChr. 2:60324394–61074394 (0.75 Mbp)\nGET (Jacobian)\nEnformer\nHyenaDNA (ISM)\nABC powerlaw\nHUDEP-2\nFetal\nerythroblast\nHUDEP-2\nAccessibility Base editing\nGWAS\nAltered phenotype CREs\nGET modelling\nRegion/motif importance\nGATA\nIdenti/f_ied motif\nIdenti/f_ied \nd\nFetal\nerythroblast\nATAC\nMotifs\nBCL11A\nK562 CRISPRi n = 1,000 bootstrap\nBCL11A\nGround \ntruth\nInferred\nCRE\nATAC\nHiChIP\nNFIX\nHbFBase\nChr. 19:12694852–13794852 (1.10 Mbp)\nGET (Jacobian)\nEnformer\nHyenaDNA (ISM)\nABC powerlaw\nHUDEP-2\nFetal\nerythroblast\nHUDEP-2\nGround \ntruth\nInferred\nCRE\nATAC\nHiChIP\nTop 10% HbFBase n = 1,000 bootstrap\n–0.04 –0.02 0\nMotif score\nSOX/1ZIC GATA\n0.02 0.04\nGET (Jacobian, ATAC, powerlaw)\nGET (Jacobian)\nGET (Jacobian, powerlaw)\nEnformer (input x attention)\nHyenaDNA (ISM)\nDeepSEA (ISM)\nABC powerlaw\nATAC/DNase\nDistance\nRandom\n[0, 100,000)bp\nPositive: 11\nNegative: 71\n0\n0.1\n0.2\n0.3\n0.4\n[100,000, 5,000,000)bp\nPositive: 7\nNegative: 76\n0\n0.1\n0.2\n0.3\n0.4\n0.5\nAUPRC\n[0, 10,000)bp\nPositive: 110\nNegative: 70\n0\n0.2\n0.4\n0.6\n0.8\n[10,000, 100,000)bp\nPositive: 217\nNegative: 992\n0\n0.1\n0.2\n0.3\n0.4\n0.5\n[100,000, 5,000,000)bp\nPositive: 108\nNegative: 6,064\n0\n0.025\n0.050\n0.075\n0.100\n0.125\nAUPRC\nFig. 3 | GET identifies long-range cis -regulatory elements.  a, Case study \nidentifying cis-regulatory elements and regulators controlling a phenotype, \nfetal haemoglobin (HbF) level. b , GET identifies the GATA motif in an erythroid-  \nspecific enhancer that upregulates BCL11A, an HbF repressor. Top, guide RNA \n(gRNA) enrichment scores (HbFBase); higher scores indicate enrichment in a \ngreater number of HbF cells, implying that these edits disturb a cis -regulatory \nelement or regulator binding site that can upregulate BCL11A . Middle, scATAC- \nseq signal and peaks from fetal erythroblasts. Bottom, motif contribution \nscore for BCL11A expression in the erythroid-specific enhancer. c , Genome \ntracks displaying inferred cis -regulatory elements for BCL11A  and NFIX loci. \nPlots for HBG2 and MYB loci can be found in Supplementary Fig. 4c. From top to \nbottom, the tracks represent: HbFBase, showing the gRNA enrichment score \nfrom base-editing experiments; GET, showing the inferred region importance \nscore; Enformer, showing the inferred region importance score; HyenaDNA, \nshowing an in silico mutagenesis (ISM) result using the pretrained HyenaDNA \nlanguage model; ABC Powerlaw, showing the activity-by-contact prediction \nusing fetal erythroblast ATAC and K562 Hi-C powerlaw; ATAC-seq data from \nHUDEP-2, an erythroblast cell line; ATAC-seq data from fetal erythroblast cells, \nused in the training of GET; and HiChIP–seq data from HUDEP-2, demonstrating \nchromatin interactions. d , Benchmarking results comparing GET to other \nmethods for predicting enhancer–promoter pairs, including analysis of  \ndistal (greater than 100 kb) interactions. Top, erythroblast fetal haemoglobin- \nregulating enhancer prediction. Bottom, K562 CRISPRi enhancer target \nprediction; the area under the precision–recall curve (AUPRC) is shown. \nAblation of different GET prediction components (Jacobian, DNase, Powerlaw; \nMethods: ‘Enhancer–gene pair prediction’) is also shown in the plot. Data are \npresented as mean values with 95% confidence intervals across random \nbootstrapping (N = 1,000, 80% of the pairs). GWAS, genome-wide association \nstudy. Schematic in a was created using BioRender (https://biorender.com).\n970 | Nature | Vol 637 | 23 January 2025\nArticle\nhad a more collapsed structure after 100 ns (Extended Data Fig. 8e) \nand fewer interchain hydrogen bonds (Extended Data Fig. 9c,d). Known \nmotifs of the two TFs shared a common core (Extended Data Fig. 8f). \nIn a coimmunoprecipitation experiment (Extended Data Fig. 8g), we \nwere able to pull down ZFX using a TFAP2A antibody, whereas a nega-\ntive control TF , SRF , showed no interaction with TFAP2A (Extended \nData Fig. 9e, Methods: ‘TFAP2A coimmunoprecipitation’ , and raw gel \nimage in Supplementary Fig. 1).\nIn another example, the pair SNAI1 (Ebox/CACCTG) and RELA \n(NFKB/1) showed a strong predicted interaction effect size, but the \nabsence of robust predicted structural interactions between the TFs led \nus to explore cofactor-mediated interactions (Extended Data Fig. 8a, \nbottom). Both of these TFs are known to physically interact with EP300 \n(ref. 39), and the predicted structures indicated electrostatic inter-\nactions with the TAZ1 and TAZ2 domains of EP300 (Extended Data \nFig. 8h–j). This is consistent with findings of previous studies on the \nelectrostatic binding of the TF IDR to EP300 TAZ domains42–45.\nWe expanded our analysis to include a broader range of TF interac-\ntions predicted by GET. We focused on the top 5% of predicted inter-\nactions in each cell type; this resulted in 1,718 TF pairs (or 24,737 pairs \nwhen considering individual protein segments). Using these data, \nwe constructed a comprehensive structural catalogue of TF interac-\ntions (Methods: ‘Causal discovery of regulator interaction’). Further \ndiscussion and analysis of this catalogue can be found in the Supple-\nmentary Information: ‘ Analysis of the GET causal network’ (Extended \nData Fig. 9f–h).\nAn IDR mutation alters TF coregulation\nT o demonstrate the utility of information provided by the GET Cata-\nlog, we performed a case study on PAX5, a driver TF of B cell precursor \nacute lymphoblastic leukaemia (B-ALL)8. B-ALL is the most frequent \npaediatric malignancy, and somatic genetic alterations (deletions, \ntranslocations and mutations) in PAX5 occur in approximately 30% \nof sporadic cases9. Whereas most PAX5 somatic missense mutations \naffect the DNA-binding domain (V26G or P80R), G183S is a recurrent \nfamilial germline mutation that confers an elevated risk of developing \nB-ALL8–10. Somatic mutation of G183 and frameshift in a nearby hotspot \nare also seen in patients with B-ALL46. Although the pLDDT plot of PAX5 \nhighlighted G183 and the octapeptide domain as a small peak in the \nentire IDR, its functional role has remained elusive (Fig. 5a).\nT o probe this, we first explored potential interaction pairs involv-\ning PAX5 (PAX/2 motif) in fetal B lymphocytes (CXCR5+). We identi-\nfied interactions with several motifs, including E2F/2, RFX/1, MECP2, \nZSCAN3 and NR/3 (Fig. 5b). Subsequent exhaustive segment interaction \nscreening with AlphaFold Multimer revealed a new interaction between \nthe nuclear receptor domain of NR/3 TFs and the octapeptide domain \nof PAX5; this was supported by AlphaFold3 (Fig. 5c). This interaction \nwas further corroborated by both positive affinity purification mass \nspectrometry data for their paralogue PAX2-NR2C2 (ref. 40) and a \nstudy using BioID proximity labelling followed by mass spectrometry \nin mouse pre-B cells47. The binding interface of the PAX5 IDR and NR \ndomains showed hydrophobicity and, surprisingly, contained the G183 \nresidue as well as a series of serine residues linked by hydrogen bonds. \nThus, the glycine-to-serine mutation could potentially affect PAX5 \ninteraction with the NR domain.\nT o validate the interaction between PAX5 and NR/3-motif-containing \nproteins, we selected candidate NR/3 TFs by assigning priority to all \nTFs in the NR/3 motif family on the basis of their expression in 15 B-ALL \nPAX wild-type (PAX-WT) patient samples in a longitudinal study. We \nfound the highest expressed NR/3 TFs to be NR4A1 and NR2C2, with \nNR2C2 showing less variable expression across patients. We performed \nproximity labelling assay using PAX5-WT and the PAX5 G183S mutant \nlinked to a biotin ligase in the B-ALL REH cell line. Analysis of proteins \nbiotinylated by their proximity to the PAX5-BioID fusions identified \nthe nuclear corepressor NCOR1 (a previously described PAX5 inter-\nactor48,49), NR2C2 (an NR/3-motif-containing nuclear corepressor) \nand NRIP1 (a nuclear-receptor-interacting protein). This experiment \nshowed a clear interaction between PAX5 and NR2C2, consistent with a \nprevious report40,47, whereas NR4A1 showed no interaction with PAX5. \nNR3C1, a NR/20 motif TF that was predicted by GET to interact with \nNR/3 but not PAX/1, showed no interaction with PAX5. Notably, the \npresence of the G183S mutation resulted in an increased interaction \nbetween PAX5 and NR2C2 (Fig. 5d,e, Extended Data Fig. 10 and raw gel \nimage in Supplementary Fig. 2).\nT o determine whether the PAX/2 and NR/3 motifs coregulated \ngenes, we examined the top 10,000 promoters predicted to be most \ninfluenced by these motifs. Our analysis identified a set of 2,570 genes \ncommonly regulated by both (Extended Data Fig. 11a); these included \nsurface markers such as CD19 and CD79B, as well as known oncogenes \nthat have been implicated in B-ALL, including MYC, CEBPD and LMO2, \nalthough these oncogenes were also predicted to be strongly repressed \nby IKZF1 (IKAROS tumour suppressor, with ZNF143 motif) and were not \nhighly expressed. Enrichment analysis showed over-representation of \ngenes involved in lymphocyte activation and genes affected by PAX5 \nperturbation during B cell differentiation (Extended Data Fig. 11b), \nGenes\nMotifs Causal\ndiscovery\nMotif–motif \ninteraction\na\nb\n0.1% 0.5% 1% 2% 5% 10% 20%\nPercentile of motif pairs retained (n = 79,242)\n0\n0.05\n0.10\n0.15\n0.20\n0.25\n0.30\nMacro F1 score\nAP/BioID-MS; Göös et al.40\nHepG2 ChIP–seq colocalization\nGET causal\nGET correlation\nMotif colocalization (cross-cell type)\nMotif colocalization (hepatocyte)\nRandom (0.0534)\nZFX\nRFX/1\nEbox/CAGCTG\nRBPJ\nCTCF NR/18\nNR/7\nTFAP2/1\nZNF332\nREST/NRSF\nKLF/SP/2\nZBTB14\nFig. 4 | GET informs TF–TF interaction discovery. a, Causal discovery  \nusing the GET motif contribution matrix identifies motif–motif interactions. \nEdge weights represent interaction effect size. Edge directions mark casual \ndirections. Blue and red edge colours mark negative or positive estimated \ncausal effect size by LiNGAM, respectively. Node colour indicates community \ndetected on the full causal graph. In-community edges are marked by reduced \nsaturation. b, Benchmark of concordance of inferred TF–TF interactions using \ndifferent methods with physical interactions from the STRING database. The x \naxis shows different cutoffs for retained interactions by percentile of 79,242 \ntotal possible interactions; y  axis shows the ratio of selected interactions that \nare also marked as interactions in STRING. The dashed line indicates the random \nselection background; the orange line indicates the results of selection using \nmotif–motif contribution score correlation; the red line marks the mean of \ncausal discovery results across five bootstraps; the shaded area indicates the \nstandard error; and green and aqua lines show results from motif colocalization, \ncomputed as correlations between motif binding vectors in accessible regions \nacross all cell types (green) or in hepatocytes (aqua). The star indicated a result \nfrom a recent mass-spectrometry-based TF– TF interaction atlas40 (0.23 Macro \nF1 at 1.09% recall); and the round dot indicates the performance of a colocalization \nscore computed from 677 HepG2 TF ChIP–seq (0.13 Macro F1 at 5.24% recall, \nMethods: ‘Causal discovery of regulator interaction’).\nNature | Vol 637 | 23 January 2025 | 971\nconsistent with previous work on the G183S mutation 8,50–55. On the \nother hand, the genes that were specifically regulated by PAX/2 or NR/3 \nwere enriched in neuronal pathways and the cell cycle, respectively \n(Extended Data Fig. 11c,d).\nT o investigate the effects of the PAX5 G183S mutation on transcrip-\ntional programs of NR/3- and PAX5-regulated genes, we examined 141 \nsporadic childhood B-ALL samples, including four familial B-ALL sam-\nples with PAX5 G183S germline variants. We first selected only CDKN2A \nloss cases (n = 20) to match with familial cases (n = n, biallelic mutations, \nloss of PAX5-WT and CDKN2A). We further stratified the patients into \ntwo groups to perform two different comparisons: PAX5-WT (n = 10) \nversus PAX5 loss (n = 10) as a negative control; and PAX5 G183S (n = 4) \nversus PAX5 loss-of-function cases (for instance, PAX5 P80R, PAX5 \nloss, n = 12) to define the G183S-specific transcriptome signature. The \nanalysis identified a specific transcriptional program associated with \nthe G183S mutation (Extended Data Fig. 11e). T o evaluate whether this \nspecific transcriptional program was relevant to PAX5–NR interaction, \nwe performed further gene set enrichment analysis and found enrich-\nment in the PAX5-loss-associated differential expression genes (fold \nenrichment: 1.22, P = 1.5 × 10–3, hypergeometric test with Benjamini–\nHochberg correction) with predicted PAX5 targets and no significant \nenrichment in NR/3-regulated and PAX5 + NR/3-regulated genes, as \nexpected. However, the PAX5-G183S-specific differential expression \ngenes show significant enrichment in NR/3- and PAX5 + NR/3-regulated \ngenes (fold enrichment: 1.41 and 1.35; P = 1.05 × 10−30 and 1.57 × 10−18, \nrespectively). Moreover, we found that this mutant specific differential \nexpression gene set was also enriched among the genes activated in \nProB cells (fold enrichment: 1.57, P = 2.2 × 10−3), including well-known \nfunctionally relevant genes such as CD19, EBF1, BACH2 and PML \n(Extended Data Fig. 11f).\nDiscussion\nIn this study, we introduce GET, a state-of-the-art foundation model \nspecifically engineered to decipher mechanisms governing transcrip-\ntional regulation across a wide range of human cell types. By integrating \nchromatin accessibility data and genomic sequence information, GET \nachieves a level of predictive precision comparable with experimental \nreplicates in leave-out cell types. Furthermore, GET demonstrates \nexceptional adaptability across an array of sequencing platforms and \nassay types, as well as non-physiological cell types such as tumour \ncells. Through interpretation of the model, we identified long-range \n0\n0.5\n1.0\n1.5\n2.0\nNR2C2\n(total NR2C2 normalized)\nPAX5 WT_linker BioID\nPAX5 G183S_linker BioID\nRHOA WT_linker BioID\nNR2C2(B) PAX5(F)\nG183\nLinker PAX5 WTPAX5 G183S RHOA WTLinkerPAX5 WTPAX5 G183SRHOA WT\nNCOR1\nNR2C2\nGAPDH\n1% inputEnrichmentEn\nrichment\n1% input\n250\n100\n150\n50\n37\n75 NR3C1\nNRIP1\nd\nkDa\na\nb\nc\ne\nLow pLDDT region\nFrameshift hotspots\nSomatic mutations \nGermline variants\n05 01 00 1502 00 2503 00 350\nResidue\n40\n60\n80\n100PAX5 pLDDT\nP80R G183S/A/VV26G\nPAX5 IDR\nPAX5 DBD\nNR/3\nRFX/1\nE2F/2\nMECP2\nZSCAN3\nPAX/2\nFig. 5 | GET identifies a cell-type-specific TF–TF interaction affected  \nby a cancer-associated germline variant.  a, pLDDT plot for PAX5, showing \nthree mutational hotspots (V26G, P80R and G183S/A/V) and a frameshift \nhotspot46. DBD, DNA-binding domain. b, B cell-specific motif interactions  \nof PAX/2. PAX5 is the most highly expressed TF with a PAX/2 motif. The colour \nscheme follows that of Fig. 4a. c, AlphaFold3-predicted multimer structure  \nof PAX5 IDR and NR2C2 NR domain showing contacts around G183 (B, back;  \nf, front). The blue–yellow surface at the back represents hydrophilicity–\nhydrophobicity, respectively. Blue–red strands in the front show low–high \nprediction confidence. d , Detection of NCOR1, NRIP1, NR3C1 and NR2C2  \nPAX5-interacting proteins in streptavidin-enriched eluates (enrichment) from \nPAX5-WT, PAX5 G183S and RHOA WT-BioID-expressing B-ALL REH cell lines  \nand in total protein lysates (1% input) using proximity labelling assays. Three \nindependent experiments with similar results. A representative experiment is \nshown. GAPDH was used as a loading control in the same gel. Raw gel images are \nin Supplementary Fig. 2. e , Quantification of PAX5–NR2C2 interaction in the \nstreptavidin immunoprecipitation shown in d . Data are presented as mean \nvalues with s.d. as well as total NR2C2-normalized values.\n972 | Nature | Vol 637 | 23 January 2025\nArticle\nregulatory elements in fetal haemoglobin and their associated TFs. \nCollecting regulatory information from all 213 cell types and syner -\ngizing TF–TF interactions deduced through GET with protein struc-\nture predictions, we constructed the publicly accessible GET Catalog \n(https://huggingface.co/spaces/get-foundation/getdemo). Using the \nPAX5 gene as a case study, we illustrated the utility of the catalogue in \nidentifying functional variants in disordered protein domains that \nwere previously difficult to study.\nCurrent limitations of GET include a reliance primarily on chromatin \naccessibility data, bounded resolution to distinguish between TF homo-\nlogues that have very similar motifs, and training on only coarse-grained \ncell states and region-level sequence information. Future enhancements \nto GET could involve the incorporation of multiple layers of biological \ninformation, including but not limited to nucleotide-level regulator \nfootprints13,56,57, three-dimensional chromatin architecture58,59, and \nregulator expression profiles or single-cell embeddings18–20. Future \niterations of GET could incorporate more diseased, perturbed or treated \ncell states and a broader range of assays, including those that directly \nmeasure TF binding, histone modifications and PolII activity, to provide \na more holistic view of the regulatory landscape.\nMultiplexed nucleotide-level perturbations or randomizations will \nbe instrumental in calibrating GET for precise prediction of the func-\ntional impact of non-coding genetic variants. Determining the effects \nof non-coding variants in modulation of gene expression and disease \nsusceptibility remains an important area of exploration. Integrating \ngenomic variants into the GET framework will enable more accurate \nprediction of their impact on gene regulation, resulting in insights into \nthe genetic basis of complex traits and diseases. In addition, the kinetics \nof gene regulation, reflecting the temporal changes in transcriptional \nactivity in response to developmental cues or environmental stimuli, \nis another dimension of complexity that could be integrated into the \nmodel. As in our PAX5–NR2C2 example, other types of information such \nas TF expression in specific cell types or protein–protein interaction \ndata could help to further narrow down specific TFs within motif–motif \ninteraction networks predicted by GET. With our efficient fine-tuning \nframework, comparative interpretation analysis using pretrained and \nfine-tuned GET could be used to identify important regulatory regions \nor motifs driving cell state changes. Generative models built upon GET \ncould be developed and used to design megabase-scale enhancer arrays \nand engineer cell-type-specific TFs or their interaction inhibitors for \ntargeted therapeutic interventions. Collectively, GET represents a \npioneering approach in cell-type-specific transcriptional modelling, \nwith broad applicability in the identification of regulatory elements, \nupstream regulators and TF interactions.\nOnline content\nAny methods, additional references, Nature Portfolio reporting sum-\nmaries, source data, extended data, supplementary information, \nacknowledgements, peer review information; details of author contri-\nbutions and competing interests; and statements of data and code avail-\nability are available at https://doi.org/10.1038/s41586-024-08391-z.\n1. Domcke, S. et al. A human cell atlas of fetal chromatin accessibility. Science 370, \neaba7721 (2020).\n2. Zhang, K. et al. A single-cell atlas of chromatin accessibility in the human genome. Cell \n184, 5985–6001.e19 (2021).\n3. Li, J. et al. Conservation and divergence of vulnerability and responses to stressors \nbetween human and mouse astrocytes. Nat. Commun. 12, 3958 (2021).\n4. Avsec, Ž. et al. Effective gene expression prediction from sequence by integrating \nlong-range interactions. Nat. Methods 18, 1196–1203 (2021).\n5. Gordon, M. G. et al. lentiMPRA and MPRAflow for high-throughput functional \ncharacterization of gene regulatory elements. Nat. Protoc. 15, 2387–2412 (2020).\n6. Agarwal, V. et al. Massively parallel characterization of transcriptional regulatory \nelements in three diverse human cell types. Preprint at bioRxiv https://doi.org/10.1101/ \n2023.03.05.531189 (2023).\n7. Cheng, L. et al. Single-nucleotide-level mapping of DNA regulatory elements that control \nfetal hemoglobin expression. Nat. Genet. 53, 869–880 (2021).\n8. Shah, S. et al. A recurrent germline PAX5 mutation confers susceptibility to pre-B cell \nacute lymphoblastic leukemia. Nat. Genet. 45, 1226–1231 (2013).\n9. Escudero, A. et al. Clinical and immunophenotypic characteristics of familial leukemia \npredisposition caused by PAX5 germline variants. Leukemia 36, 2338–2342 (2022).\n10. Auer, F. et al. Familial predisposition to B-cell precursor acute lymphoblastic leukemia \nmediated by PAX5 germline variants. Blood 140, 8888–8889 (2022).\n11. Elkon, R. & Agami, R. Characterization of noncoding regulatory DNA in the human \ngenome. Nat. Biotechnol. 35, 732–746 (2017).\n12. Malik, S. & Roeder, R. G. Regulation of the RNA polymerase II pre-initiation complex by its \nassociated coactivators. Nat. Rev. Genet. https://doi.org/10.1038/s41576-023-00630-9  \n(2023).\n13. Vierstra, J. et al. Global reference mapping of human transcription factor footprints. Nature \n583, 729–736 (2020).\n14. Zhou, J. et al. Deep learning sequence-based ab initio prediction of variant effects on \nexpression and disease risk. Nat. Genet. 50, 1171–1179 (2018).\n15. Kelley, D. R. Cross-species regulatory sequence activity prediction. PLoS Comput. Biol. \n16, e1008050 (2020).\n16. OpenAI. GPT-4 technical report. Preprint at https://arxiv.org/abs/2303.08774 (2023).\n17. Lin, Z. et al. Evolutionary-scale prediction of atomic-level protein structure with a language \nmodel. Science 379, 1123–1130 (2023).\n18. Theodoris, C. V. et al. Transfer learning enables predictions in network biology. Nature \n618, 616–624 (2023).\n19. Cui, H. et al. scGPT: toward building a foundation model for single-cell multi-omics using \ngenerative AI. Nat. Methods https://doi.org/10.1038/s41592-024-02201-0 (2024).\n20. Hao, M. et al. Large-scale foundation model on single-cell transcriptomics. Nat. Methods \nhttps://doi.org/10.1038/s41592-024-02305-7 (2024).\n21. Vaswani, A. et al. Attention is all you need. in Proceedings of the 31st International Conference \non Neural Information Processing Systems 6000–6010 (ACM, 2017).\n22. Joung, J. et al. A transcription factor atlas of directed differentiation. Cell 186, 209–229.e26 \n(2023).\n23. Cao, J. et al. A human cell atlas of fetal gene expression. Science 370, eaba7721 (2020).\n24. The Tabula Sapiens Consortium. et al. The Tabula Sapiens: a multiple-organ, single-cell \ntranscriptomic atlas of humans. Science https://doi.org/10.1126/science.abl4896 (2022).\n25. Granja, J. M. et al. ArchR is a scalable software package for integrative single-cell chromatin \naccessibility analysis. Nat. Genet. 53, 403–411 (2021).\n26. Terekhanova, N. V. et al. Epigenetic regulation during cancer transitions across 11 tumour \ntypes. Nature 623, 432–441 (2023).\n27. Basak, A. & Sankaran, V. G. Regulation of the fetal hemoglobin silencing factor BCL11A. \nAnn. N. Y. Acad. Sci. 1368, 25–30 (2016).\n28. Listì, F. et al. Study on the role of polymorphisms of the SOX-6 and MYB genes and fetal \nhemoglobin levels in sicilian patients with β-thalassemia and sickle cell disease. \nHemoglobin 42, 103–107 (2018).\n29. Nguyen, E. et al. HyenaDNA: long-range genomic sequence modeling at single \nnucleotide resolution. in Proceedings of the 37th International Conference on Neural \nInformation Processing Systems 43177–43201 (ACM, 2024).\n30. Zhou, J. & Troyanskaya, O. G. Predicting effects of noncoding variants with deep learning–\nbased sequence model. Nat. Methods 12, 931–934 (2015).\n31. Fulco, C. P. et al. Activity-by-contact model of enhancer-promoter regulation from \nthousands of CRISPR perturbations. Nat. Genet. 51, 1664–1669 (2019).\n32. Nasser, J. et al. Genome-wide enhancer maps link risk variants to disease genes. Nature \n593, 238–243 (2021).\n33. Gschwind, A. R. et al. An encyclopedia of enhancer-gene regulatory interactions in the \nhuman genome. Preprint at bioRxiv https://doi.org/10.1101/2023.11.09.563812 (2023).\n34. Wu, W. et al. Dynamic shifts in occupancy by TAL1 are guided by GATA factors and drive \nlarge-scale reprogramming of gene expression during hematopoiesis. Genome Res. 24, \n1945–1962 (2014).\n35. Raudvere, U. et al. g:Profiler: a web server for functional enrichment analysis and \nconversions of gene lists (2019 update). Nucleic Acids Res. 47, W191–W198 (2019).\n36. Welch, J. J. et al. Global regulation of erythroid gene expression by transcription factor \nGATA-1. Blood 104, 3136–3147 (2004).\n37. Baubec, T., Ivánek, R., Lienert, F. & Schübeler, D. Methylation-dependent and -independent \ngenomic targeting principles of the MBD protein family. Cell 153, 480–492 (2013).\n38. Domcke, S. et al. Competition between DNA methylation and transcription factors \ndetermines binding of NRF1. Nature 528, 575–579 (2015).\n39. Szklarczyk, D. et al. STRING v11: protein-protein association networks with increased \ncoverage, supporting functional discovery in genome-wide experimental datasets. \nNucleic Acids Res. 47, D607–D613 (2019).\n40. Göös, H. et al. Human transcription factor protein interaction networks. Nat. Commun. 13, \n766 (2022).\n41. Jumper, J. et al. Highly accurate protein structure prediction with AlphaFold. Nature \nhttps://doi.org/10.1038/s41586-021-03819-2 (2021).\n42. De Guzman, R. N., Wojciak, J. M., Martinez-Yamout, M. A., Dyson, H. J. & Wright, P. E.  \nCBP/p300 TAZ1 domain forms a structured scaffold for ligand binding. Biochemistry 44, \n490–497 (2005).\n43. Miller Jenkins, L. M. et al. Characterization of the p300 Taz2-p53 TAD2 complex and \ncomparison with the p300 Taz2-p53 TAD1 complex. Biochemistry 54, 2001–2010 (2015).\n44. Lochhead, M. R. et al. Structural insights into TAZ2 domain-mediated CBP/p300 \nrecruitment by transactivation domain 1 of the lymphopoietic transcription factor E2A.  \nJ. Biol. Chem. 295, 4303–4315 (2020).\n45. Ferrie, J. J. et al. p300 is an obligate integrator of combinatorial transcription factor \ninputs. Mol. Cell 84, 234–243.e4 (2024).\n46. Gu, Z. et al. PAX5-driven subtypes of B-progenitor acute lymphoblastic leukemia. Nat. Genet. \n51, 296–307 (2019).\n47. Okuyama, K. et al. PAX5 is part of a functional transcription factor network targeted in \nlymphoid leukemia. PLoS Genet. 15, e1008280 (2019).\n48. Oshima, K. et al. Mutational and functional genetics mapping of chemotherapy resistance \nmechanisms in relapsed acute lymphoblastic leukemia. Nat. Cancer 1, 1113–1127 (2020).\nNature | Vol 637 | 23 January 2025 | 973\n49. McManus, S. et al. The transcription factor Pax5 regulates its target genes by recruiting \nchromatin‐modifying proteins in committed B cells. EMBO J. 30, 2388–2404 (2011).\n50. Mullighan, C. G. et al. Genome-wide analysis of genetic alterations in acute lymphoblastic \nleukaemia. Nature 446, 758–764 (2007).\n51. Pridans, C. et al. Identification of Pax5 target genes in early B cell differentiation. J. Immunol. \n180, 1719–1728 (2008).\n52. Revilla-i-Domingo, R. et al. The B-cell identity factor Pax5 regulates distinct  \ntranscriptional programmes in early and late B lymphopoiesis. EMBO J. 31, 3130–3146 \n(2012).\n53. Delogu, A. et al. Gene repression by Pax5 in B cells is essential for blood cell homeostasis \nand is reversed in plasma cells. Immunity 24, 269–281 (2006).\n54. Schebesta, A. et al. Transcription factor Pax5 activates the chromatin of key genes \nInvolved in B cell signaling, adhesion, migration, and immune function. Immunity 27,  \n49–63 (2007).\n55. Holmfeldt, L. et al. The genomic landscape of hypodiploid acute lymphoblastic leukemia. \nNat. Genet. 45, 242–252 (2013).\n56. Nair, S. et al. Transcription factor stoichiometry, motif affinity and syntax regulate single- \ncell chromatin dynamics during fibroblast reprogramming to pluripotency. Preprint at \nbioRxiv https://doi.org/10.1101/2023.10.04.560808 (2023).\n57. Hu, Y. et al. Single-cell multi-scale footprinting reveals the modular organization of DNA \nregulatory elements. Preprint at bioRxiv https://doi.org/10.1101/2023.03.28.533945 \n(2023).\n58. Zhou, J. Sequence-based modeling of three-dimensional genome architecture from \nkilobase to chromosome scale. Nat. Genet. 54, 725–734 (2022).\n59. Tan, J. et al. Cell-type-specific prediction of 3D chromatin organization enables \nhigh-throughput in silico genetic screening. Nat. Biotechnol. 41, 1140–1150 (2023).\nPublisher’s note Springer Nature remains neutral with regard to jurisdictional claims in \npublished maps and institutional affiliations.\nOpen Access This article is licensed under a Creative Commons Attribution-\nNonCommercial-NoDerivatives 4.0 International License, which permits any \nnon-commercial use, sharing, distribution and reproduction in any medium or \nformat, as long as you give appropriate credit to the original author(s) and the source, provide \na link to the Creative Commons licence, and indicate if you modified the licensed material.  \nYou do not have permission under this licence to share adapted material derived from this \narticle or parts of it. The images or other third party material in this article are included in the \narticle’s Creative Commons licence, unless indicated otherwise in a credit line to the material. \nIf material is not included in the article’s Creative Commons licence and your intended use is \nnot permitted by statutory regulation or exceeds the permitted use, you will need to obtain \npermission directly from the copyright holder. To view a copy of this licence, visit http://\ncreativecommons.org/licenses/by-nc-nd/4.0/.\n© The Author(s) 2025, corrected publication 2025\nArticle\nMethods\nA T AC-seq data processing\nPseudobulk. T o determine the chromatin accessibility score for each \nregion, we used the scATAC-seq count table and cell annotation table \nfrom each respective study. T o aggregate single cells into ‘pseudobulk \ncell types’ , we used the Louvain clustering results from each study. Log \ncount per million (logCPM) was used for each pseudobulk. The annota-\ntions of each cluster were used to determine the biological cell type. \nEmpirically, we set a threshold of more than 600 cell counts to ensure \nadequate sequencing depth for selected cell clusters. A comprehensive \ntable of pseudobulk cell types used during the training process can be \nfound in Supplementary Table 1.\nIn summary, we used ATAC-seq and expression data from  \nrefs. 1,2,22. In total, the dataset encompassed 1.3 million single nuclei. \nThe data were only presented in pseudobulked format. All cell types \nwere primary cell types from normal tissue. No disease states were \nincluded in the pretraining dataset. We incorporated further datasets \nin downstream tasks such as K562 and zero-shot analysis in tumour \ncells.\nCell-type-specific accessible region identification. For identification \nof cell-type-specific accessible regions, the peak calling results from \nthe original studies of each dataset were used to obtain a union set of \npeaks. Subsequently, to compile a list of accessible regions specific to \neach cell type, we filtered out peaks with no counts.\nIn the context of the human fetal and adult chromatin accessibility \natlas, we used the peak set produced by Zhang et al.2, incorporating the \nfetal chromatin accessibility atlas originally published by Domcke et al.1. \nWe also trained a version of the fetal-only GET model using the original \npeak calling and cell type annotation from Domcke et al.1, resulting \nin comparable expression prediction and regulatory analysis perfor-\nmance. For the 10× multiome data, we used the provided peak fragment \ncount matrix. For the K562 NEAT-seq and bulk chromatin accessibil-\nity data, a more permissive version of peaks was called using MACS2  \n(ref. 60), and different logCPM cutoffs were applied to the resulting \npeak set to select accessible regions. This accessibility-based data aug-\nmentation enhances the diversity of input data and fine-tunes the GET \nmodel for data from a single cell type.\nAccessibility features. In this study, the chromatin accessibility score \nfor a specific genomic region was defined by the count of fragments \nlocated within that region for a given cell type pseudobulk. T o enhance \nthe generalizability of the model, these counts were further normalized \nthrough the logCPM procedure. Specifically, let t be the total fragment \ncount in a pseudobulk, and let ci be the fragment count in region i. Then, \nthe accessibility score si can be computed as:\n∑s c\nt tc=l og +1 ,= .i\ni\ni\ni10\n\n\n\n\nFor most of the regulatory analysis, the binary ATAC version of the \nGET model was used to comprehensively evaluate the regulatory \ninfluences exerted by TFs. In both the training and inference phases \nof this specific model version, the accessibility scores were uniformly \nset to 1 if the region was identified as a chromatin accessibility peak. \nThis equates to assuming binary chromatin accessibility states in the \nstudied scenario.\nMotif features. T o calculate the motif binding score within a specific \ngenomic region, the corresponding sequence was scanned against the \nhg38 reference genome, using 2,179 TF motif position weight matrices \npreviously compiled by Vierstra et al. 13 (accessible at https://www. \nvierstra.org/resources/motif_clustering). For the scanning process, \nthe MOODS tool was used with default threshold61.\nMore specifically, to represent sequence information while miti-\ngating feature redundancy, a specialized motif scoring process was \nimplemented. Building on Vierstra’s research, we categorized these \n2,179 motifs into 282 motif clusters, a classification determined by \nposition weight matrix similarity. Using this established clustering \ndefinition, we eliminated redundant nucleotide-level motif matches, \nretaining only the match with the highest score within overlapping \nmatches belonging to the same motif cluster. Subsequently, the scores \nof all non-overlapping motif matches within each motif cluster were \nsummed, yielding one cumulative score for each of the 282 clusters. \nAs a final step, motif binding scores for all regions within a given cell \ntype were determined and subjected to min–max normalization across \nregions. This normalization facilitates model generalization and the \ntraining process, ensuring that each motif cluster’s score is processed \nin a standardized manner.\nThe annotation of the 213 cell types used in pretraining followed the \noriginal cell type classification provided in the fetal and adult acces-\nsibility atlases1,2,22. This classification was achieved through clustering \nof ATAC-seq count profiles, with subsequent labelling on the basis of \nthe expression of known marker genes. The comprehensive list of tis-\nsues and cell types, along with their annotations, can be found at the \nHuman Cell Atlas (http://catlas.org/humanenhancer/#!/cellType). The \noriginal atlas included 222 fetal and adult cell types but was further \nfiltered to remove cell types with low sequencing coverage (number of \ncells less than 600). This approach ensured that our model was trained \nacross diverse cellular contexts while ensuring enough coverage in the \nchromatin accessibility pseudobulk tracks. The data were not further \nbalanced or curated.\nInput data. GET is designed to capture the interaction between dif -\nferent regions and regulators. T o facilitate this, we needed each input \nsample to contain a certain number of consecutive accessible regions, \nmimicking the ‘receptive field’ of an RNA PolII. Through previous experi-\nments, we found that the ideal equivalent genome coverage is around \nor more than 2 Mbp, a range in which most of the chromatin contact \nhappens. As a result, on the basis of our current data prepossessing \npipeline, we chose to use 200 input regions per training sample. We \nused non-overlapping sampling during the pretraining and a sliding \nwindow approach during fine-tuning. The stride of the sliding window \nwas set to half the number of regions in one sample (that is, 100 peaks \nper step for samples with 200 peaks).\nThis number of regions per sample was selected to achieve a bal-\nance between computational efficiency and the need to encompass \na representative sample of the regulatory landscape for each cell \ntype. It is important to note that the actual genomic span covered by \nthese 200 peaks could vary depending on several factors, including \ncell-type-specific variations in chromatin accessibility, the threshold \napplied during peak calling and the chromosomal distribution of the \npeaks. In the context of the uniformly processed datasets covering \nfetal and adult cell types, we have observed that 200 peaks typically \ncorrespond to a genomic range of approximately 2–4 Mbp. This esti-\nmation was derived from the understanding that the human genome, \nwith its roughly 3 billion base pairs, yields about 150,000 accessible \npeaks when analysed comprehensively. Therefore, a subset of 200 \npeaks would, on average, represent a genomic span of 2–4 Mbp, given \nthe distribution and density of peaks across different cell types. In the \ntraining of our main model, the borders were entirely dependent on \nthe boundary of sampled peaks; no other priors were used. Sampling \nwas performed independently in each chromosome starting from the \nbeginning of the chromosomes.\nRNA-seq data processing\nCell type matching. For experiments encompassing multiomics, \nthe correspondence between accessibility and expression was inher-\nently determined through cell barcodes. In pseudobulk cases, where \naccessibility and expression were assessed independently, cell type \nannotations were used to facilitate the mapping. Specifically, the fetal \nexpression atlas from Cao et al.23 was used for fetal cell types, whereas \nadult data were extracted from Tabula Sapiens24. When several ATAC \npseudobulk shared the same cell type annotation, identical expression \nlabels were assigned. This compromise was necessitated by the current \ndearth of multiome sequencing data, a situation expected to change \ndramatically in the near future.\nExpression values. T o improve training stability, we log-transformed \nthe expression values as log10(TPM + 1). T o overcome the problem of \nmost scRNA-seq quantification being at gene level, not transcript level, \nwe mapped the gene expression to accessible regions using the follow-\ning approach: if a region overlapped with a gene’s TSS, the gene’s expres-\nsion value was assigned to that region as a label; if a region overlapped \nwith multiple genes’ TSS, the expression values of the corresponding \ngenes were summed, and the sum was used as the label of that region; \nif a region did not overlap with any TSS, the corresponding expression \nlabel was set to 0. Further, if a promoter had very low accessibility (for \ninstance, an accessibility CPM (aCPM) less than 0.05), we also set the \ncorresponding expression value to 0. Finally, each regulatory element \nwas assigned to an expression target value.\nExpression values were allocated to each region within our input. \nOwing to the limitations of poly(A) scRNA-seq data, only aggregated \nmRNA levels could be captured, resulting in values that were not reflec-\ntive of the nascent transcription rate more closely tied to regulatory \nevents. Nonetheless, these values provided valuable cell-type-specific \ninformation. The process begins by intersecting the input region list \nwith GENCODE v.40 transcript annotation to pinpoint promoters, \nfollowed by assignment of logCPM values to regions corresponding \nto these promoters. All remaining regions are assigned a value of 0. \nAlthough this does not perfectly represent all transcription events hap-\npening in a cell, we believe the zero label on the non-promoter region \nhelps to deliver informative negative labels to the model.\nInput target. In alignment with the 200 × 283 input matrix, the target \ninput is a 200 × 2 matrix, symbolizing the transcription levels of the \ncorresponding 200 regions across both positive and negative strands.\nModel architecture\nThe GET architecture consists of three parts: (1) a regulatory element \nembedding layer (RegionEmb); (2) regulatory-element-wise atten -\ntion layers (Encoder); and (3) a linear output layer as the expression \nprediction head, or, alternatively, other output heads. GET takes 200 \nregulatory elements, each with 282 motif binding scores and option-\nally one accessibility score as an input sample. As a result, the input is \na 200 × 283 matrix. When we choose to not use the quantitative acces-\nsibility score, we set the values in the 283-th column to 1.\nWe feed the sample into the RegionEmb layer to generate the regu-\nlatory element embedding with a dimension of 768 for each peak. As \nwe do not want to lose information in the input of the original regula-\ntory element, we apply a linear layer to capture the general informa-\ntion in the different classes of TF binding sites. T o learn the cis- and \ntrans-interactions between regulatory elements and TFs, we apply 12 \nEncoder layers with a multihead attention (MHA) mechanism on the \nregulatory element embeddings.\nSuppose Nh, dv and dk denote the number of heads, the depth of val-\nues and the depth of keys, respectively. The output from each head h \nis computed as\nO\nXW XW\nd\nXW=s oftmax\n′( ′)\n(′ ),h\nqk\nT\nv\nk\n\n\n\n\n\n\nwhere WW W,∈ ,∈qk\nnD d\nv\nnD d(× )× (× )×kvRR  are learnable linear transfor-\nmations.\nThen, we concatenate the output from each head h  for the \nregulatory-element-wise attention block. The layer normalization \n(LN), feed-forward network (FFN) and residual connections are finally \nused to generate the output for each layer. Thus, the mechanism behind \nthe regulatory-element-wise attention block can be summarized as:\nz′ =M HA(LN(z) )+ z; z= FFN(LN(z′ )) +z ′,ll ll ll−1 −1\nwhere z′, zll −1 denote the intermediate representation in the block l, \nzl−1 denotes the output from the block l −1 , LN is the layer normalization \nand FFN is the feed-forward network. We apply two linear layers with \na GELU activation layer in the feed-forward network layer.\nThe GET architecture is similar to the state-of-the-art model \nEnformer4. However, the following changes helped us to improve upon \nand exceed the performance of that model: GET uses the regulatory \nelement embedding layer to capture the general information of regu-\nlatory elements in the different classes of TF binding site. Moreover, a \nmasked regulatory element mechanism was used to learn the general \ncis- and trans-interactions between regulatory elements and TFs from \ndifferent human cell types. Specifically, a random set of positions was \nuniformly selected to mask out with a mask ratio of 0.5.\nSimilar to the Vision-Transformer-based Masked Autoencoders62, \nwe replaced the regions in the selected positions with a shared but \nlearnable [MASK] token; the masked input regulatory element is \ndenoted by X XM=( ,, [MASK])masked , where X x={ }ii\nn\n=1 is the input sam-\nple with n regulatory elements. The training goal is to predict the \noriginal values of the masked elements M. Specifically, we take masked \nregulatory element embeddings X masked as input to GET, while a simple \nlinear layer is appended as the prediction head. Therefore, the overall \nobjective of self-supervised training can be formulated as:\n\n\n\n\n\n∑ px X=− log( ),\niM\ni\n∈\nmaskedL E\nwhere xi denotes the masked region to be predicted.\nTraining scheme\nWe conducted pretraining in the large-scale single-cell chromatin \naccessibility data. Then we fine-tuned the pretrained model on the \npaired chromatin accessibility–gene expression data with the same \nPoisson negative log-likelihood loss function as Enformer4.\nThe GET implementation is based on the PyT orch framework. For \nthe first training stage, we applied AdamW as our optimizer with a \nweight decay of 0.05 and a batch size of 256. The model was trained \nfor 800 epochs with 40 warmup epochs for linear learning rate scaling. \nWe set the maximum learning rate to 1.5 × 10−4. The training usually \ntakes around a week for a cluster with 16 V100 GPUs. For the second \nfine-tuning stage, we used AdamW63 as our optimizer with a weight \ndecay of 0.05 and a batch size of 256. The model was trained for 100 \nepochs, which completes in around 8 h using eight A100 GPUs. Infer-\nence for all genes in a single cell type takes several minutes, making it \npossible to perform large-scale screening.\nTraining details\nWe include a more detailed description of the optimization hyperpa-\nrameters, computation infrastructure and convergence criteria used \nin the development of the model in the section below.\nPretraining phase. \n1. Computation infrastructure: the pretraining of our model was con-\nducted using 16 NVIDIA V100 GPUs or eight A100 GPUs, reflecting the \ncomputational demands of our training dataset and the complexity \nof the model architecture.\n2. Epochs and duration: the model underwent 800 epochs of training, \nwhich spanned approximately 1 week. This extensive training period \nArticle\nwas essential for the model to learn the regulatory grammar from \nchromatin accessibility data across a wide array of human cell types.\n3. Learning rate: a base learning rate of 1 × 10−3 together with cosine \nscheduler and linear annealing warmup in the first epoch.\n4. Mask ratio: 0.5.\n5. Optimizer: AdamW with weight decay of 0.05.\nFine-tuning phase. \n1. Computational infrastructure: similar to the pretraining phase, \nfine-tuning was performed on eight NVIDIA A100 GPUs, ensuring \nconsistency in computational resources.\n2. Epochs and duration: the fine-tuning process was shorter, consist-\ning of 100 epochs, and completed in around one day. This phase was \ncrucial for adapting the pretrained model to specific gene expression \nprediction tasks.\n3. Learning rate: A base learning rate of 1 × 10−3 together with a cosine \nscheduler and linear annealing warmup in the first epoch.\n4. Optimizer: AdamW with weight decay of 0.05.\n5. Early stopping: to optimize performance and prevent overfitting, \nwe used early stopping on the basis of validation loss, enabling us \nto select the best model checkpoints for subsequent evaluation.\nParameter-efficient fine-tuning. GET provides an option to per -\nform parameter-efficient fine-tuning over any specific layer through \nlow-rank adaptation (LoRA)64. This is commonly used to adapt to a \nnew assay or platform; we apply LoRA to the region embedding and \nencoder layers, while doing full fine-tuning on the prediction head. \nThis markedly reduces 99% of the parameters.\nModel evaluation\nCross-cell-type prediction. We validated the cross-cell-type prediction \nperformance beyond astrocytes to include a broader range of cell types. \nThe benchmark was performed on fetal cell types with a variable length \npeak set defined in the original fetal accessibility atlas1. This compari-\nson includes quantitative ATAC GET (n = 3), binarized ATAC GET, linear \nprobing of the Enformer CAGE output tracks trained on the Basenji15 \ntraining set and inferred genes in the Basenji test set, and a training cell \ntype mean expression baseline. We used Pearson correlation, Spearman \ncorrelation and R2 to evaluate prediction performance in all settings.\nBenchmarking against supervised approaches. We have imple -\nmented comparisons with the following methods on the task of  \nexpression prediction when leaving out chromosome 11 and leav -\ning out astrocytes, using the same input data as GET. The following \nparameters were used in our implementation.\n1. MLP: three linear layers separated by ReLU (layer dimensions: 283 \ninput, 512, 256, two output); SoftPlus was used for output activation.\n2. CNN: three Conv1d layers (layer dimensions: 283 input, 128, 64, 32, \n3 kernel size) followed by FC(32, 512) → ReLU → FC(512, 2); SoftPlus \nwas used for output activation. We used the same optimizer and pa-\nrameters as used in GET (base learning rate: 1 × 10−3, cosine scheduler, \nlinear annealing warmup, AdamW optimizer with weight decay of \n0.05).\n3. CatBoost: we used CatBoostRegressor with loss function Multi -\nRMSE for 1,000 iterations (learning rate: 1 × 10 −3).\n4. SVM: we used scikit-learn Support Vector Regression with epsilon \n0.2, linear kernel and max iterations 1,000. MultiOutputRegressor \nwas used to handle two-dimensional output.\n5. Random forest: we used scikit-learn RandomForestRegressor with \nten estimators and max depth 10. MultiOutputRegressor was used \nto handle two-dimensional output.\n6. Linear regression: we opted to use linear regression instead of logistic \nregression because our setting aligns better with regression than \nclassification. We used scikit-learn LinearRegression and MultiOut-\nputRegressor with default parameters.\nLeave-out-chromosome evaluation. We performed a leave-one-  \nchromosome-out benchmark across all chromosomes and found that \nthe performance remained consistent across chromosomes, condi-\ntioned on the same sequencing platform and data sources. We found \nan average Pearson correlation of 0.78 (minimum: 0.73, maximum: \n0.84) on fetal astrocytes. We also extended our evaluation of leave-out \nchromosomes to tumour cells from patients with IDH1 wild-type GBM \nfrom the Human Tumor Atlas Network. We performed fine-tuning of \nthe base GET model on tumour cells from a single patient (case ID: \nC3L-03405) and evaluated performance on each leave-out chromo-\nsome. This evaluation showed an average Pearson correlation of 0.75 \n(minimum: 0.68, maximum: 0.81) on leave-out chromosomes.\nFor K562 OmniATAC prediction, we performed leave-one-  \nchromosome-out prediction for all 22 autosomes, finding an average \nPearson correlation of 0.81 (minimum: 0.72, maximum: 0.84). For K562 \nCAGE prediction, we used GET to predict K562 CAGE (FANTOM5 sample \nID: CNhs12336). We note that this comparison privileges Enformer, \nwhich was trained extensively on CAGE tracks, including K562 (track \nID: 4828 and 5111), whereas GET needed to be transferred to the new \nassay. Here we evaluated fine-tuned GET against Enformer predictions \nsummed across the two CAGE output tracks for a leave-out peak set \nacross chromosome 14. We selected chromosome 14 because it did \nnot appear in the public Enformer checkpoint’s training or validation \nset. Pretrained GET was fine-tuned in three ways.\n1. BATAC LoRA from BATAC pretrain: in this setting, the base model \nwas trained on the fetal and adult atlases with binarized ATAC signal.  \nIn the fine-tuning, the ATAC data were binarized.\n2. QATAC LoRA from BATAC pretrain: in this setting, the base model \nwas trained on the fetal and adult atlases with binarized ATAC signal.  \nIn the fine-tuning, we used the original aCPM for ATAC signal.\n3. QATAC LoRA from QATAC fine-tuned: in this setting, the base model \nwas the leave-out astrocyte RNA-seq prediction model trained on the \nfetal accessibility and expression atlas. In the fine-tuning, we used \nthe original aCPM for ATAC signal.\nThese experiments leveraged LoRA parameter-efficient fine-tuning \nto achieve significant gains in time and storage complexity. On a single \nRTX 3090 GPU, all fine-tuning converged within 30 min, resulting in a \n3 MB K562-CAGE-specific adaptor that could be merged into the base \nmodel.\nLeave-out-motif evaluation. T o explore the impact of omitting motifs \nin the input features, we used K562 scATAC-seq data from ENCODE \n(accession: ENCFF998SLH) and evaluated the ATAC prediction per-\nformance when holding out randomly selected motifs. We first called \npeaks with MACS2 with a threshold of q = 0.05. Then, we merged this \npeak set with the union peak set from the fetal pretraining data, keeping \nthe peaks with at least ten counts in K562. For fine-tuning computa-\ntional efficiency, we used LoRA parameter-efficient fine-tuning of the \nbinary ATAC checkpoint pretrained on fetal and adult ATAC data with \na 200-region receptive field (the pretrained checkpoint used for motif \nanalysis in Fig. 4 and onward).\nWe explored holding out randomly selected 1, 2, 3, 4, 10 and 20 motifs. \nFor each motif, we checked whether a peak’s binding score was larger \nthan the top 20% scores in its score distribution across the genome. \nDuring the training stage, if a peak had any of the leave-out motifs pass-\ning this threshold, we set all input motif features of that peak as well \nas the observation aCPM to zero. In this approach, these ‘knockout’ \npeaks do not contribute to the loss. During the evaluation stage, we \ncalculated Pearson and Spearman correlations of aCPM only on these \nknockout peaks with the original observed aCPM. For example, when \nthere was only one leave-out motif CTCF , we were in effect be training \nwith about the top 20% of peaks that had low CTCF binding scores on \nthe training chromosomes, assuming evenly distributed binding sites \nacross chromosomes. Similarly, we were evaluating with 20% of peaks \nwith higher CTCF binding scores in the test chromosomes. In these \nexperiments, we evaluated on held-out chromosome 14.\nIn general, GET showed robust performance when leaving out one \nto ten motifs. The performance was degraded heavily when using 20 \nmotifs with a top 20% cutoff for each motif independently, owing to \nremoval of most of the training data.\nPlatform transfer prediction. When transferring to a new sequencing \nplatform, many domain shifts need to be addressed. These include but \nare not limited to the following.\n1. Sequencing depth: lower depth will lead to fewer captured peaks; \nit will also affect the signal-to-noise ratio in the accessibility quan -\ntification.\n2. Peak calling threshold and software.\n3. T echnical bias due to different library construction and sequencing \nmethods.\n4. Biological differences.\nOwing to these biases, it is difficult to directly apply a model trained \non one dataset to a new platform without fine-tuning. Thus, for a new \ndataset with multiple cell types available, we took a leave-out cell type \napproach to fine-tuning. For a dataset of sorted cell types where only \none cell type was available, we used leave-out chromosome training.\nTransfer to new datasets. The primary challenge in adapting our mod-\nel to new data lies in ensuring compatibility between the input spaces \nof the training and new datasets. Variations in cell types, sequencing \ntechnologies and preprocessing pipelines can result in substantially \ndifferent ATAC peak sets, potentially leading to incompatible input \nand embedding spaces. T o address this, we developed a strategy to \ncreate a compatible peak set by combining new and training peak \nsets. When overlaps occur between training and new peaks, we as -\nsign priority to the training peak set coordinates. Unique peaks from \nthe new data are incorporated as they are. We used a uniform peak \ncalling pipeline to maintain consistent peak lengths (for instance, \n400 bp in the fetal–adult atlas) across training and new datasets. \nThe comprehensive coverage of our fetal-only/fetal–adult peak set \n(1.3 M peaks) typically results in new, unseen peaks contributing \nless than 10% of the total peaks. This approach has demonstrated \npromising transferability to various data types, including SHARE-seq \ndata of perturbed human embryonic stem cells and 10× multiome  \nGBM data.\nFor example, we tested a ‘one-shot’ fine-tuning procedure using a \nsingle patient sample from a new dataset of patients with GBM. We \nthen assessed the performance of this fine-tuned model against the \npretrained ‘zero-shot’ model on 16 held-out patient samples. T o ensure \nrobust evaluation, we excluded two patients from this analysis to serve \nas a separate test set for assessing fine-tuning stability. The results were \npromising: fine-tuning on a single tumour patient sample enabled GET \nto achieve a Pearson correlation exceeding 0.9 when predicting expres-\nsion for held-out patients, whereas zero-shot performance reached a \n0.67 Pearson correlation. This demonstrates the model’s strong gen-\neralization capabilities and its potential for rapid adaptation to new \ndatasets with minimal further training. As the availability of ATAC-seq \nand multiome data continues to grow, more comprehensive reference \npeak sets, such as the ENCODE DHS index13 and cPeaks65, will further \nfacilitate the adaptation of the GET model to an even broader range of \ncell types and experimental conditions.\nTransfer to new assays. Here we show results for transfer of pretrained \nGET to different functional genomics assays. For K562 bulk ATAC pre-\ndiction, we collected ENCODE OmniATAC-seq data for K562 (ENCS-\nR483RKN). After calling peaks using MACS2 with default parameters, \nwe computed the log(aCPM) by counting Tn5 insertions located inside \nthe peak and filtered out the peaks with log(aCPM) less than 0.03. The \nremaining peaks and corresponding aCPM were used for motif scanning \nand prediction. We performed leave-one-chromosome-out fine-tuning \nusing 200 peaks per input sample. The base checkpoint was trained \non the fetal and adult atlas with the binarized ATAC setting and 200 \npeaks per input sample. LoRA was used for all layers. Each fine-tuning \ntook around 160 s to complete eight epochs, after which the model \nstarted to overfit. Pearson correlation was collected at eight epochs \nfor all fine-tuning. For CAGE prediction, we collected the K562 CAGE \n(CNhs12336) BAM file from FANTOM5 and used bedtools to extract \nalignment counts in peaks called from ENCODE K562 scATAC-seq data \n(ENCFF998SLH). Fine-tuning was performed using 200 peaks per input \nsample in three settings, depending on how ATAC information was \nused in conjunction with motif features, plus the base model used for \nfine-tuning.\n1. BATAC from BATAC pretrain: in this setting, the base model was \ntrained on the fetal–adult atlas with binarized ATAC signal; in the \nfine-tuning, we used binarized ATAC.\n2. QATAC from BATAC pretrain: in this setting, the base model was \ntrained on the fetal–adult atlas with binarized ATAC signal; in the \nfine-tuning, we used the original aCPM ATAC signal.\n3. QATAC from QATAC fine-tuned: in this setting, the base model was \nthe leave-out-astrocyte RNA-seq prediction model trained on the \nfetal accessibility and expression atlas. We further fine-tuned this \nmodel using quantitative ATAC signal.\nDataset considerations. Overall our results indicate that certain  \nintrinsic cellular characteristics may contribute to the observed \nvariations in model performance. We demonstrate that GET can be \napplied and extended to non-physiological cell types and states and \ncaptures cell-type-specific transcription information. Beyond the \nintrinsic biological differences between cell types, we believe the fol-\nlowing factors could also affect performance when generalizing to new  \ndatasets.\n1. Cell type rarity and library size: rare cell types often have smaller data \nlibraries, which can limit the model’s learning potential and affect \nthe accuracy of predictions.\n2. Cell type purity and heterogeneity: the dynamic and heterogeneous \nnature of certain cell types, such as stem cells, and the precision of \nidentification and classification of cell types can introduce variability \nin gene expression profiles, complicating the prediction task.\nModel interpretation\nIn this study, we conducted thorough model interpretation analyses \nto ensure that GET learns useful regulatory information and offers \nvaluable biological insights. Below, we outline the method used to \ninterpret GET.\nModel used for interpretation. We trained two GET models on data \nwith or without quantitative accessibility:\n1. Quantitative ATAC model: accessibility scores are set to the \nlog10(CPM) of Tn5 insertions in the given accessible region.\n2. Binary ATAC model: accessibility scores for all regions are set to 1; \nthe model focuses solely on motifs in accessible regions.\nIn our analysis and regulatory interpretation, we primarily used \nthe binary ATAC model. This approach offers improved attribution to \nsequence features, ensuring that the model does not overly depend on \naccessibility signal strength as a surrogate for sequence characteristics.\nFeature attribution methods. We used multiple feature attribution \nmethods in different analyses and provided all options to users in our \npackages. More specifically, the gradient of the model’s output with \nrespect to the input features, represented by the vector fx∇( ), measures \nhow much the model output (expression) will change when we change \na small amount of the input along a dimension (for instance, a certain \nArticle\nmotif in a cis-regulatory region). The generalization to multiple outputs \nin the context of neural network feature attribution extends to the \nJacobian matrix J =ij\nf\nx,\n∂\n∂\ni\nj\n, where fi is the ith output, representing the \ntranscription level on either the positive or negative strand, and xj is \nthe jth input feature, comprising scanned and summarized binding \nscores for 282 TF motif clusters and an extra dimension for accessibil-\nity scores. This formulation enables computation of the Jacobian  \nmatrix, which is vital for understanding the influence of individual \nfeatures on the transcription levels.\nEnhancer–gene pair prediction. We restricted the benchmark dataset \nto either the fetal erythroblast peak set or K562 DNase peak set for a \nfair comparison. T o obtain an enhancer importance score for each gene \nfrom GET, we used the ℓ2s-norm of the region embedding layer Jaco-\nbian and weighted it with the aCPM of each region as the GET Jacobian \nscore. This procedure could potentially be improved in the future, for \nexample, by using a random genomic background as the baseline for \nthe Jacobian calculation and other interpretation methods such as \nIntegrated-Gradients66 or DeepLIFT67. However, we believe the current \nbenchmark dataset size for this task is still limiting compared with the \ngenome scale (104 measured pairs versus 106 to 107 required measure-\nments of genome-wide enhancer–promoter interaction). Thus, we \nleave the systematic optimization of this task for future work. Other \nscores used in this study were as follows.\n1. ABC: we computed ABC Powerlaw by multiplying the powerlaw \nfunction in the official ABC repo with γ = 1.024238616787792 and \nscale = 5.9594510043736655, values that were trained on K562 Hi-C \ndata and provided in the same repo.\n2. Enformer: we used Enformer’s contribution score (gradient × input) \nwith background normalization, following the normalization pro-\ncedure described by Gschwind et al.33.\n3. HyenaDNA: we used the largest pretrained model available through \nHugging Face (context length: 1 Mbp). T o score enhancer–gene \npairs, we performed in silico mutagenesis by knocking down the \nenhancer element (that is, setting each base pair in the enhancer \nregion to the unknown nucleotide N in the vocabulary set) and com-\nparing against the wild-type likelihood of observing the promoter \nsequence.\n4. DeepSEA: nucleotide-level DeepSEA results were retrieved directly \nfrom the original publication and averaged over each peak.\nAll scores in this benchmark (ABC, Enformer, GET, HyenaDNA, Deep-\nSEA and DNase/ATAC) were further normalized across each gene’s ±100 \npeaks to make them comparable across genes.\nRecent studies have highlighted the dominant importance of one-  \ndimensional genomic distance in governing CRISPRi enhancer knock-\nout effects (for instance, Gschwind et al. 33). In this benchmark, most \nmethods include a component of genomic distance. For example, \nEnformer incorporates exponential decay in its positional encodings. \nHyenaDNA incorporates a sinusoidal positional encoding over the \nDNA sequence, and our benchmarking results follow an exponen-\ntial decay from the TSS (Fig.  3c; NFIX). We have also extended  \nGET to incorporate distance information. In particular, we designed \na simple DistanceContactMap module for GET to convert the pair-\nwise one-dimensional distance map between peaks to a pseudo-  \nHi-C contact map. DistanceContactMap is a simple three-layer two-  \ndimensional convolutional neural network (kernel size: 3) with \nlog (pairwise distance +1 )10  as input and SCALE-normalized observed \ncontact frequency as output. A Poisson negative log-likelihood loss \nwas used to train the model. We trained DistanceContactMap with \nthe same K562 Hi-C data (ENCFF621AIY) used for training ABC Pow -\nerlaw, resulting in a 0.855 Pearson correlation, which mostly captured \nthe exponential decay in contact frequency. We termed the prediction \nof this model ‘GET Powerlaw’ . The other two scores shown in Fig.  3d \nare defined as follows:\n1. GET ( Jacobian, DNase/ATAC, Powerlaw) = GET Jacobian + aCPM × GET \nPowerlaw;\n2. GET ( Jacobian, Powerlaw) = GET Jacobian × GET Powerlaw.\nThis model could be improved in future work by taking GET region \nembeddings as further input and learning to predict cell-type-specific \nthree-dimensional contacts.\nLentiMPRA zero-shot prediction. The experimental procedure  \ninvolves designing a library of lentivirus vectors that contain both  \ndesired sequence elements and a mini promoter. The vector is randomly \ninserted into the genome through viral infection; the regulatory activ-\nity is then measured through sequencing and counting the log copy \nnumber of transcribed RNAs and integrated DNA copies.\nT o simulate this approach using GET, we first collected the \nsequence element library and constructed the vector sequence for \ninsertion, including both the regulatory sequences and mini pro -\nmoters. We then followed the same data preprocessing procedure \nto get the motif scores of the inserted elements. For each element, \nwe performed in silico insertion by summing its motif score with an \nexisting region on the genome. The ±100 regions centred around the \ninsertion region were then used as an input sample for GET to make \nexpression predictions. The mean predicted expression (log 10(TPM)) \nwas multiplied by the mean predicted accessibility as the predicted \nregulatory activity. For each region, we performed 600 insertions \nacross the genome to match the experimental insertion count. We \nused the GET model fine-tuned on K562 NEAT-seq data to perform \nthe inference. In total, in silico lentiMPRA of all 200,000 elements \nin K562 took around 5 days.\nFor Enformer, we performed the same analysis, with the only differ-\nence being that we integrated the vector sequence to a random position \non the genome and collected a 196,608 bp sequence centred around the \ninsertion site. Enformer is trained on 5,313 human epigenome tracks, \nwith 486 experiments specifically for K562. T o compute the regulatory \nactivity, we selected the output from the K562 CAGE track, which is a \nquantitative and nucleotide-level map of the 5′ regions of transcripts. \nFollowing the practice of the original study, we used the average output \nof the three bins in the centre of the sequence as the predicted expres-\nsion for a sample. Each element was also inserted into 600 random \ngenome locations to compute the final averaged regulatory activity. \nWe were only able to perform these experiments for 1,000 enhancers \nand 1,000 non-enhancer elements owing to the time complexity of \nEnformer inference. The comparison with GET was performed on the \nsame set of elements.\nWe stratified the K562 lentiMPRA elements (approximately 200,000) \nby overlapping the annotated 15 ENCODE ChromHMM states computed \nfrom histone mark and other ChIP–seq data for K562. We selected the \nelements overlapping with states ‘12 EnhBiv’ , ‘6 EnhG’ and ‘7 Enh’ as \nenhancers, and those overlapping with ‘13 ReprPC’ , ‘14 ReprPCWk’ and \n‘15 Quies’ as repressive and quiescent regions.\nIdentifying important regions and regulators. We first gathered \ninference samples across the genome by producing 200-region win-\ndows centred around each gene’s promoter. Given a specific gene g \non strand s ∈{ 0, 1}, the expression value can be inferred using the GET \nmodel f applied to an input matrix X ∈ rm×R , where r denotes the num-\nber of regions, and m  includes motifs and (optionally) accessibility \nfeatures:\nEf X\nEE rs\n=( )\n=[ //2,] ,g\nwhere [⋅ ] is the index-selection operator and s  is the strand of the  \ngene.\nThe Jacobian matrix (tensor) JX ∈ rr m×2 ××R  of f  at the point (E , X) \nevaluates how each output dimension will change when each input \ndimension changes by a small quantity. We specifically pick the output \ndimension and strand that correspond to the given gene, represented \nby Rg∇∈ rm× :\ngJ rs\nJ E\nX\n∇= [ //2,]\n= ∂\n∂ .\nX\nX\nThe feature (motif) importance vector v ∈g\nmR  is obtained by mul-\ntiplying the gradient element-wise with the original input and sum -\nmarizing across regions:\n⊙∑ gX iv= (∇ )[ ,: ],g\ni\nr\n=1\nwhere ⊙ signifies the element-wise or Hadamard product. As the \ngene-by-motif matrix is mostly used for feature–feature interaction \nanalysis, we use the X with quantitative ATAC signal even when we infer \nJX  using a binary ATAC model. This facilitates study of the relationship \nbetween regulators and observed chromatin accessibility.\nThe cell-type-specific genome-wide gene-by-motif matrix for cell \ntype c, Vc is acquired by concatenating the vg across the genome. The \nsame process can be applied to different cell types.\nSimilarly, the region importance vector l ∈g\nrR  is given by:\n⊙∑lg Xj=( ∇) [:,] .g\nj\nm\n=1\nIn practice, we use the l2-norm of the Jacobian of the region embed-\nding with respect to output for calculating the region importance score \nas the embedding score distribution is less skewed than the input motif \nbinding score, potentially making the Jacobian more comparable across \nregions. The per-region Jacobian score is normalized by the maximum \nscore per gene to make scores comparable across genes with different \nexpression levels.\nGene ontology enrichment of top target genes of a regulator. Using \nthe gene-by-motif matrix Vc, we can choose a TF or motif (in our case, \nGATA) and ask which genes will be mostly affected by this TF by iden-\ntifying the largest entries in the motif column. We chose the top 1,000 \ngenes and performed gene ontology enrichment analysis using \ng:Profiler with the default g_SCS multiple hypothesis testing correction. \nWe filtered the results using term size (gene number in a term defini-\ntion) greater than 500 and less than 1,000. T erms with adjusted P value \nless than 0.05 were retained as significant terms. We further selected \nTFs in the ‘Hemopoiesis’ term with expression log10(TPM > 1) for visu-\nalization against the GATA motif score.\nTF and target gene correlation. In this analysis, we sought to elucidate \nthe relationships between TFs and expression of their target genes \nacross different cell types. Gene-by-motif files were aggregated and \norganized into a unified structure comprising genes, motifs and corre-\nsponding cell features. We identified the target genes for each TF within \npredefined motif clusters and computed the mean expression levels \nof both the target genes and the corresponding TFs. T o avoid potential \nartifacts in the expression measurement caused by experimental batch \neffects, we analysed both adult and fetal cell types, and fetal cell types \nonly, and found similar results. The analysis was performed iteratively \nfor all TFs within the motif clusters specific to fetal cell types.\nRegulatory embedding. GET is configured using a cross-cell-type \narchitecture to extract the regulatory context for genes spanning \nvarious cell types, embedding them within a shared high-dimensional \nspace. We collected the embedding of each gene after each transformer \nblock of GET. The embedding of a gene g is defined as the embedding \nvector of the promoter in the output of the ith block. The embedding \ncontains both promoter information and information from surround-\ning regions owing to the attention mechanism. In general, the deeper \nthe layer, the more its space is dominated by the expression output \n(Supplementary Fig. 4). tsne-cuda was used to visualize the embedding \nowing to data size. Louvain clustering was performed on the embed-\nding space to colourize the visualization. Resolution was arbitrarily \nchosen to keep the cluster number around 10 and close to the UMAP \ndensity. For cell-type-based subsampling, UMAP 68 was used instead \nfor visualization for better visual separation between clusters.\nWe computed the embeddings in two different settings: the cell- \ntype-specific setting, in which each dot is a gene embedding from a \nspecific cell, and the cell-type-agnostic setting, in which each dot is a \ngene embedding randomly sampled from all cell types; 50,000 embed-\ndings were sampled in the second case to make the UMAP computation \nfeasible.\nCausal discovery of regulator interaction. We performed pair -\nwise Spearman correlation using the gene-by-motif matrix in both \ncell-type-specific and cell-type-agnostic settings. Input × gradient \nscores were used to construct the matrix for computational efficiency. \nFor the cell-type-specific settings, all genes with promoter overlap with \nopen chromatin peaks in each cell type were used in the correlation \ncalculation. Causal discovery was performed on the gene-by-motif \nmatrix using LiNGAM69. For the cell-type-agnostic settings, 50,000 \ngenes were randomly sampled from all cell types, and the resulting \nmatrix was subjected to the LiNGAM algorithm implemented in the \nCausal Discovery T oolbox Python package with default parameters.\nT o benchmark the predicted causal edges in the cell-type-agnostic \nsetting, we downloaded the known physical interaction subnetwork \nfrom the STRING v.11 database39 and kept interactions with a combined \nscore greater than 400 as the ground truth label. As the pairs predicted \nby GET were on the motif cluster level, we mapped the physical inter-\nactions between TFs on to the motif clusters on the basis of the motif \ncluster annotation. The resulting motif–motif physical interaction \nnetwork was then compared with our prediction to calculate the pre-\ncision. We also downloaded and compiled all significant interactions \ndetermined by mass spectroscopy40 and mapped them to motif–motif \ninteractions for comparison. For comparison with ChIP–seq colocaliza-\ntion, we acquired colocalization results between ChIP–seq tracks for \n677 TFs in HepG2 from TF Atlas. The method for calculating colocaliza-\ntion is documented in the ChIP-Atlas repo. Each ChIP–seq peak set was \nstratified into three tiers (high, mid and low). Then, for a pair of TFs P1 \nand P2, we checked colocalization between every tier pair and assigned \nscores with a preference for high–high colocalization (score = 9). If the \nstrong binding peaks of P1 overlapped with strong binding peaks of P2, \nthe P1–P2 interaction was considered to be more robust than in the case \nin which the P1 strong binding sites only overlapped with the P2 weak \nbinding sites. We present the colocalizations stronger than mid–mid \ninteractions (score ≥ 4) in Fig. 4b, as these represent the more reliable \ninteractions. A stronger cutoff (score ≥ 9, keeping only high–high inter-\nactions) reduced the performance to a 0.097 macro F1 score at 2% recall.\nFor comparison with motif colocalization, we collected the GET input \nmatrix (accessible-region-by-motif) for hepatocytes or concatenated \nthe input matrix across all fetal and adult cell types. Pairwise Pearson \ncorrelation was computed across all collected regions, resulting in a \nscore for every pair of motifs. For the cell-type-specific motif–motif \ninteractions in the GET catalogue, we performed causal discovery using \nthe gene-by-motif matrix for all cell types. Interactions with the top \n5% absolute effect size were retained in the final database. For each \ninteraction, we performed structural analysis between the two TFs \nwith the highest expression in the corresponding cell types.\nStructural analysis\nAlphaFold benchmark on intrafamily binder prediction. We classi-\nfied a TF as an intrafamily binder if any two members in its TF family had \na known physical interaction annotated in the STRING v.11 database, \non the basis of the hypothesis that if a TF can bind as a heterodimer, \nArticle\nit should also have the potential to bind as a homodimer owing to \nsequence and structure similarity (although the dimerization affin -\nity might be different). We thus used AlphaFold to predict the hypo -\nthetical homodimer structures of all known TFs and tried to predict \nwhether a TF could be an intrafamily binder using AlphaFold-based \nmetrics. We used several different AlphaFold-based metrics, including \nmean_plddt (average pLDDT score across all residues), pAE (predicted \naligned error across all interchain interactions), pDockQ (predicted \nDockQ metric using interface pLDDT) and pDockQ × pAE. We found \nthat pDockQ × pAE led to the best area under the receiver operating \ncharacteristic curve (0.69) and area under the precision–recall curve \n(0.41) when classifying intrafamily binder TFs.\nProtein sequence segmentation. pLDDT from AlphaFold is a reli -\nable protein domain caller owing to its accurate structure prediction \nperformance. We segmented each TF protein sequence into low and \nhigh pLDDT regions. Empirically, we found that 80% (recall) of known \nDNA-binding domains could be easily identified using high pLDDT \nregions plus a high ratio of positively charged residues. More spe -\ncifically, we first computed smoothed pLDDT using a ten-amino-acid \nmoving-average kernel and then normalized the score by dividing \nby the maximum. After that, any region that had a smoothed pLDDT \nscore less than 0.6 was defined as a low pLDDT region. If two low pLDDT  \nregions were close (less than 30 amino acids), they were merged into \none. Any region that was not a low pLDDT region was labelled as a high \npLDDT region.\nMultimer structure prediction. LocalColabFold and ColabFold were \nused to predict multimer structures with the AlphaFold Multimer v.2.3 \nmodel. For homodimer prediction, we used all five models with three \nrecycles. For our large-scale interaction screening, we used model \n3 with three recycles for each prediction. The pAE and pLDDT were \nstored for downstream analysis. pDockQ was calculated using code \nfrom FoldDock70.\nIf the multimer structure had a newly appearing peak, we treated \nit as evidence of potential interaction. pAE, pDockQ and ipTM were \nfurther checked to assess the confidence of the interaction. After Alpha-\nFold3 was released, we reperformed structure prediction for full-length \nPAX5–NR2C2 sequences and identified the same PAX5 G183–NR domain \ninteraction.\nMolecular dynamics simulation. The initial configuration was prepared \nfrom the AlphaFold predicted PDB file. The Amber99SB-dispersion \n(a99SBdisp) force field was used for system parameterization. A cubic \nsimulation box was defined with a box size of 1 nm. Subsequently, the \nsystem was solvated using the TIP4P water model through the solvate \nmodule. T o neutralize the system and generate physiological ion con-\ncentrations, sodium (Na+) and chloride (Cl−) ions were added using the \ngenion module. The energy minimization terminated upon reaching \na maximum force below 1,000 kJ mol−1 nm−1. Each minimization itera-\ntion used a step size of 0.01 and was configured to run for a maximum \nof 50,000 steps. The system was then equilibrated in two steps: first in \nthe NVT (constant number, volume, temperature) ensemble and then in \nthe NPT (constant number, pressure, temperature) ensemble for 100 ps \nof simulation time. A 100 ns production run was then performed, and \ntrajectories and energy profiles were stored for subsequent analysis. All \nconfigs of these are available at the Proscope repo (https://github.com/\nfuxialexander/proscope). In our analysis, we found that the per-residue \npLDDT scores for ZFX, IDR and TFAP2A in the multimer structure were \ncorrelated strongly with residue instability, as measured by root mean \nsquared distance, consistent with the results of previous studies indicat-\ning that AlphaFold implicitly learns protein folding energy functions.\nStructure visualization. ChimeraX was used to visualize the predicted \nstructures.\nBiological experiments\nCell lines. HeLa cells (CCL-2) and REH cells (CRL-8286) were purchased \nfrom ATCC. Cell lines purchased from a certificated cell line bank were \nnot further authenticated. All cell lines tested negative for mycoplasma. \nNo commonly misidentified cell lines were used in the study.\nTFAP2A coimmunoprecipitation. HeLa cells were cultured in DMEM \n(Gibco, catalogue no. 11965) supplemented with 10% defined fetal \nbovine serum (HyClone, SH30070), at 37 °C and 5% CO 2. HeLa cell \nprotein lysates were generated with 0.5% NP-40 lysis buffer (50 mM \nTris-HCl, 150 mM NaCl, 0.5% NP-40) with a phosphatase and protease \ninhibitor cocktail (Sigma-Aldrich, PPC1010). Samples were incubated \nwith 5 µg agarose-conjugated TFAP2A primary antibody (Santa Cruz \nBiotechnology, sc-12726 AC) overnight at 4 °C before being run in \nLaemmli loading buffer (BioRad, 1610737). Proteins were separated \non 10% Tris–glycine gels (ThermoFisher, XP00100), transferred to \npolyvinylidene fluoride membranes (Immobilon-P, IPVH00010) and \nprobed with primary antibodies against TFAP2A (ABclonal, A2294, \n1:750), ZFX (ThermoFisher, PA5-34376, 1:500) and β-actin (Santa Cruz \nBiotechnology, sc-47778, 1:10000), followed by chemiluminescence \ndetection. A repeat experiment was performed for coimmunoprecipi-\ntation negative controls, which were probed with primary antibodies \nagainst SRF (Abclonal, A16718, 1:750) and β-actin (Cell Signaling T ech-\nnology, 4967, 1:10000), followed by chemiluminescence detection.\nProximity labelling assay to detect PAX5–NR2C2 interactions.  \nWe initially cloned PAX5-WT and the PAX5 G183S mutant into the pC\nDNA3.1-MCS-13Xlinker-BioID2-HA (Addgene, catalogue no. 80899)71. \nAfter verification, we subcloned PAX5-WT-13Xlinker-BioID2-HA and \nPAX5-G183S-13Xlinker-BioID2-HA into the pCDH-GFP-puro vector \n(System Bioscience, CD513B-1). We transduced the REH B-ALL cell \nline (ATCC, CRL-8286) with pCDH-PAX5-WT-13Xlinker-BioID2-HA-GFP \nand with pCDH-PAX5-G183S-13Xlinker-BioID2-HA-GFP and selected \ntransduced cells with puromycin (1 µg ml −1) to generate stable cell \nlines. The proximity labelling assay was performed following previ -\nously published methods71–73. Briefly, REH stable cell lines with control \nvector pCDH-13Xlinker-BioID2-HA-GFP, pCDH-PAX5-WT-13Xlinker-  \nBioID2-HA-GFP and pCDH-PAX5-G183S-13Xlinker-BioID2-HA-GFP \nwere incubated with 100 µM biotin (Sigma-Aldrich, B4501) for 24 h. \nWe collected the cells, washed them twice in cold phosphate-buffered \nsaline and incubated them for 50 min on ice with occasional vortex -\ning in lysis buffer (150 mM NaCl, 10 mM KCl, 10 mM Tris-HCl pH 8.0, \n1.5 mM MgCl, 0.5% IGEPAL) supplemented with protease and phos -\nphatase inhibitors (Life T echnologies, catalogue no. 78443) and 63 U \nof benzonase (Sigma-Aldrich, catalogue no. 70746-3). Proteins were \nclarified by centrifugation at 21,000g for 15 min at 4 °C. We performed \ntotal protein quantification using a Pierce BCA Protein Assay kit (Ther-\nmoFisher Scientific, catalogue no. 23225) and incubated 1 mg of total \nprotein extract with 100 µl of magnetic streptavidin beads (Dynabeads \nMyOne Streptavidin C1, Life T echnologies, catalogue no. 65002) on a \nrotator at 4 °C overnight to isolate biotinylated proteins. We washed \nthe beads twice with lysis buffer, once with 1 M KCl, once with 0.1 M \nNa2CO3, once with 2 M urea 10 mM Tris-HCL pH 8.0, and twice again \nwith lysis buffer. Biotinylated proteins were eluted by boiling in 4× \nprotein loading buffer supplemented with 2 mM biotin and 50 mM \ndithiothreitol at 95 °C for 10 min. Biotinylated proteins in total protein \nextracts or immunoprecipitates were detected by western blotting \nusing standard protocols and the following antibodies: streptavi -\ndin–HRP antibody (Life T echnologies, catalogue no. S911, 1:1000), \nanti-PAX5 (Cell Signaling, catalogue no. 8970, 1:500), anti-HA (Cell \nSignaling, catalogue no. 3724, 1:1000), anti-NR2C2 (Cell Signaling, \ncatalogue no. 31646, 1:500), anti-NCOR1 (Cell Signaling, catalogue \nno. 5948, 1:500), NRIP1–HRP (Santa Cruz Biotechnology, sc-518071, \n1:200) and NR3C1 (Cell Signaling, catalogue no. 12041, 1:500). Proteins \nwere detected using a Li-Cor Odyssey OFC instrument and quantified \nusing the GelAnalyzer 23.1 software.\nReporting summary\nFurther information on research design is available in the Nature Port-\nfolio Reporting Summary linked to this article.\nData availability\nPrecomputed regulatory inference results, preprocessed data, and \nstructure predictions can be viewed at the GET website (https://\nhuggingface.co/spaces/get-foundation/GET). The full processed \ndata and inference results are provided in a public AWS S3 bucket \nat s3://2023-get-xf2217/get_demo. Bulk RNA-seq data for patients \nwith B-ALL published in our previous study were acquired from the \nSequence Read Archive (PRJNA534488). Human TF protein interac-\ntion networks were downloaded from supplementary data of Göös \net al.40. Fetal accessibility data were downloaded from https://descartes.\nbrotmanbaty.org/bbi/human-chromatin-during-development/, adult  \naccessibility data from http://catlas.org/humanenhancer/, fetal \nexpression atlas data from https://descartes.brotmanbaty.org/bbi/\nhuman-gene-expression-during-development/ , adult expression \natlas data from Tabular Sapiens (https://figshare.com/articles/data-\nset/Tabula_Sapiens_release_1_0/14267219/5)74, HUDEP-2 HiChIP data \nfrom the Gene Expression Omnibus (GEO; GSE157311), erythroblast \nbase-editing benchmark data from https://github.com/YichaoOU/\nABE_NonCoding_functional_score/blob/master/per_A_base_score/\ncomparison_to_CADD_DeepSEA_GERP/Editable_A_scores.combined.\nscores.csv, K562 NEAT-seq data from GEO (GSE178707), K562 omniATAC \ndata from ENCODE (ENCSR483RKN), K562 scATAC-seq data from \nENCODE (ENCFF998SLH), K562 CRISPRi benchmark data from https://\ngithub.com/EngreitzLab/CRISPR_comparison/blob/main/resources/\ncrispr_data/EPCrisprBenchmark_ensemble_data_GRCh38.tsv.gz, K562 \nlentiMPRA quantification from ENCODE (ENCFF348WYK), K562 CAGE \nfrom FANTOM5 (CNhs12336), HTAN GBM data from GEO (GSE240822) \nand astrocyte bulk RNA-seq data from GEO (GSE147870).\nCode availability\nCode for pretraining, fine-tuning, data preprocessing and analysis, \nand the demo website, has been made available at GitHub (https://\ngithub.com/GET-Foundation). Code and accompanying data for  \nfigures in this study are available at Zenodo (https://doi.org/10.5281/\nzenodo.13357634)75. The pretrained models are provided in a public \nAWS S3 bucket at s3://2023-get-xf2217/get_demo/checkpoints.\n \n60. Zhang, Y. et al. Model-based analysis of ChIP-Seq (MACS). Genome Biol. 9, R137–R137 (2008).\n61. Korhonen, J. H., Palin, K., Taipale, J. & Ukkonen, E. Fast motif matching revisited: \nhigh-order PWMs, SNPs and indels. Bioinformatics 33, 514–521 (2017).\n62. He, K. et al. Masked Autoencoders Are Scalable Vision Learners. in 2022 IEEE/CVF \nConference on Computer Vision and Pattern Recognition 15979–15988 (IEEE, 2022).\n63. Loshchilov, I. & Hutter, F. Decoupled weight decay regularization. Preprint at https://arxiv.\norg/abs/1711.05101 (2019).\n64. Hu, E. J. et al. LoRA: low-rank adaptation of large language models. Preprint at https://\narxiv.org/abs/2106.09685 (2021).\n65. Meng, Q. et al. Toward a generic feature set defined by consensus peaks as a consistent \nreference for ATAC-seq data. Preprint at bioRxiv https://doi.org/10.1101/2023.05.30.542889 \n(2023).\n66. Sundararajan, M., Taly, A. & Yan, Q. Axiomatic Attribution for Deep Networks. in Proceedings \nof the 34th International Conference on Machine Learning 3319–3328 (PMLR, 2017).\n67. Shrikumar, A., Greenside, P. & Kundaje, A. Learning Important Features Through \nPropagating Activation Differences. in Proceedings of the 34th International Conference \non Machine Learning 3145–3153 (PMLR, 2017).\n68. McInnes, L., Healy, J. & Melville, J. UMAP: uniform manifold approximation and projection \nfor dimension reduction. Preprint at https://arxiv.org/abs/1802.03426 (2020).\n69. Shimizu, S., Hoyer, P. O., Hyvärinen, A. & Kerminen, A. A linear non-gaussian acyclic \nmodel for causal discovery. J. Mach. Learn. Res. 7, 2003–2030 (2006).\n70. Bryant, P., Pozzati, G. & Elofsson, A. Improved prediction of protein-protein interactions \nusing AlphaFold2. Nat. Commun. 13, 1265 (2022).\n71. Kim, D. I. et al. An improved smaller biotin ligase for BioID proximity labeling. Mol. Biol. \nCell 27, 1188–1196 (2016).\n72. Roux, K. J., Kim, D. I., Burke, B. & May, D. G. BioID: a screen for protein-protein interactions. \nCurr. Protoc. Protein Sci. 91, 19.23.1–19.23.15 (2018).\n73. Cho, K. F. et al. Proximity labeling in mammalian cells with TurboID and split-TurboID. Nat. \nProtoc. 15, 3971–3999 (2020).\n74. Pisco, A. & Tabula Sapiens Consortium. Tabula Sapiens Single-Cell Dataset. Figshare \nhttps://figshare.com/articles/dataset/Tabula_Sapiens_release_1_0/14267219/5 (2023).\n75. Fu, X. Code and accompanied data for figures in the GET paper. Zenodo https://doi.org/ \n10.5281/zenodo.13357634 (2024).\nAcknowledgements We acknowledge funding from NIH (R35 CA253126 to R.R., P01 CA174653 \nto R.R., R01 HL159377 to R.R. and U01 CA243073 to R.R. and T.P.) and SU2C Convergence 3.14 \nto R.R and P30CA013696. Figs. 1a,b, 2a and 3a and Extended Data Fig. 3b,d were created using \nBioRender.\nAuthor contributions A.P.L. and A.S. contributed equally as experimentalists. X.F. and S.M. \ninitiated the project. X.F. and R.R. conceived the study and designed the analyses. X.F. and  \nS.M. designed the model with advice from E.P.X. X.F. and S.M. implemented the model. X.F. \nperformed data processing. S.M., X.F. and A.B. performed model training, ablation and \nperformance analyses. X.F. performed model interpretation analysis including MPRA, \nregulatory elements and regulator prediction, network analysis and structural analysis. X.F. \nand S.M. constructed the GET catalogue. X.F., S.M. and A.B. built the website. A.S. and A.P.L. \nperformed the experimental validation with input from D.M.O. and T.P. M.d.M.A.-T., J.S., R.S.  \nand T.Y. helped with analysis. X.F. and J.T. codesigned a revised version of the data processing \npipeline. Y.L. provided suggestions and computational resources for a pilot study. A.C. \nprovided critical suggestions for the analysis. A.A.F. provided critical suggestions and edited \nthe manuscript. E.P.X. and R.R. supervised the study. X.F., S.M., A.B., M.d.M.A.-T., E.P.X. and R.R. \nprepared the manuscript with input from all authors.\nCompeting interests A provisional patent with application numbers 63/486,855 and PCT/\nUS2024/017064 has been filed by Columbia University on the use of the method developed in \nthis work to identify gene regulatory elements and alter gene regulation and expression; X.F. \nand R.R. are inventors on this patent. R.R. is a founder of Genotwin and a member of the SAB of \nDiatech Pharmacogenomics and Flahy. None of these activities are related to the work \ndescribed in this manuscript.\nAdditional information\nSupplementary information The online version contains supplementary material available at \nhttps://doi.org/10.1038/s41586-024-08391-z.\nCorrespondence and requests for materials should be addressed to Xi Fu, Eric P. Xing or  \nRaul Rabadan.\nPeer review information Nature thanks the anonymous reviewers for their contribution to the \npeer review of this work. Peer reviewer reports are available.\nReprints and permissions information is available at http://www.nature.com/reprints.\nArticle\nExtended Data Fig. 1 | Architecture of GET. The GET model uses chromatin \naccessibility data to predict gene expression. Input data consists of DNA \nsequences from ATAC-seq peaks, represented as (B, R, L *, 4), where B is batch \nsize, R is number of regions, L * is variable sequence length, and 4 represents the \nfour DNA bases. Motif mapping performed offline to the model converts \nsequences to a motif matrix (B, R, M), where M is the number of motifs. The \nquantitative ATAC signal can optionally be included in M. The RegionEmb layer \nprojects the motif matrix to a latent space (B, R, D), where D is the latent \ndimension. This embedding is then processed by 12 Transformer encoder \nlayers. The model output is generated by a projection layer followed by a \nSoftPlus activation, producing a (B, R, O) tensor, where O is the output channel. \nFour output heads are illustrated: MaskHead: Predicts masked motif matrix \nelements during pretraining (O = (R/2, M)). ExpHead: Predicts stranded gene \nexpression as log1p(TPM) (O = 2). ATACHead: Predicts peak accessibility as \nlog1p(CPM) (O = 1). CAGEHead: Predicts peak CAGE signal as log1p(CPM) (O = 1). \nThe model architecture enables flexible processing of regulatory genomic data, \ncapturing complex interactions between regulatory elements and transcription \nfactors to predict various genomic features and gene expression levels.\nExtended Data Fig. 2 | GET model performance and benchmarking. a. Pearson \ncorrelation of gene expression between biological replicates and across different \nculture systems for human astrocytes. b. Scatterplots showing predicted vs. \nobserved log fold change (log FC) in gene expression between different cell type \npairs. Top row compares erythroblast subtypes and hepatocytes. Bottom row \ncompares enteric neurons to erythroblasts and astrocytes. Pearson correlations \nand R2 values are provided for each comparison. c. Comparison of Pearson \ncorrelation between predicted and observed gene expression in left-out cell \ntypes for different models and baselines. Quantitative ATAC: GET model with \nquantitative ATAC and motif input. Training cell type mean: Mean expression \nvalue across all training cell types. Enformer LP: Linear probing of Enformer \n CAGE header outputs. Binarized ATAC: GET model with only motif input.  \nGET with finetuning shows the highest correlation at 0.94. d. Ablation study  \nof GET pretraining on leave-out astrocytes, showing superior performance of \nfinetuning the pretrained model when compared against random initialization \nand baselines. e. Comparison of GET to baseline machine learning models  \n(CNN, MLP , CatBoost, SVMRegression, RandomForest, and LinearRegression)  \non leave-out-chromosome 11 and leave-out-astrocyte prediction performance \n(R2, Pearson correlation, Spearman correlation). f. Radar plot showing leave-one- \nchromosome-out finetuning performance (R2, Pearson correlation, Spearman \ncorrelation) of GET in fetal astrocytes.\nArticle\nExtended Data Fig. 3 | Transfer learning adapts GET to new platforms and \ncell types.  a. GET trained on fetal cell types generalizes to adult cell types \nwithout retraining, outperforming the most correlated cell type baseline.  \nX axis shows R2 score between GET prediction in adult cell types and observed \nexpression in the most similar fetal cell types. Y axis shows R 2 score between \nGET prediction and observed expression in the adult cell type. b . Schematic \nillustration of transferring GET to a lymph node 10x multiome dataset.  \nc. Finetuned GET accurately predicts expression in training and leave-out \nevaluation lymph node cell types. d . Schematic showing the application of GET \nin the zero-shot setting to predict gene expression from glioblastoma (GBM) \npatient samples (top) and in the one-shot setting after being finetuned on a \nsingle GBM patient sample and used to predict gene expression for an \nextended cohort of GBM patients. e . Pearson correlation scores for GET \nexpression prediction on GBM cells (n = 16 samples) comparing tumor cells, \nmacrophages, and oligodendrocytes for zero-shot and one-shot (finetuned) \nsettings. f. Radar plot showing leave-one-chromosome-out finetuning \nperformance (R 2, Pearson correlation, Spearman correlation) of GET in one \nGBM tumor sample. Schematics in b and d created using BioRender ( https://\nbiorender.com).\n\nExtended Data Fig. 4 | Transfer learning adapts GET to new modalities.   \na. Three settings of GET finetuned on CAGE K562 dataset and evaluated on \nleave-out chromosome 14 as compared to Enformer predictions. GET finetuned \nwith quantitative ATAC (“QATAC LoRA from QATAC fetal finetune” and “QATAC \nLoRA from BATAC pretrain”) outperforms GET finetuned with binarized ATAC \n(“BATAC LoRA from BATAC pretrain”) and Enformer predictions for the peak \nevaluation regions. Evaluation was performed for all TSS in chromosome 14.  \nb. Performance of GET on ATAC prediction. GET performance for K562 and \nAstrocyte ATAC compared against Enformer’s predictions for DNase on K562 \nand Astrocyte output tracks. c . GET performance for K562 bulk OmniATAC, \nshowing leave-one-chromosome-out Pearson correlation for all autosomes.  \nd. GET performance for K562 scATAC, showing leave-out-motif analysis for \nrandomly selected 1, 2, 3, 4, 10, or 20 motif features from the training set and \nevaluating on peaks with the left-out motifs ( Methods: Model evaluation ).\nArticle\nExtended Data Fig. 5 | Ablation and enrichment analysis of GET-MPRA.  \na. Scatter plot of lentiMPRA readout versus GET-MPRA prediction (top), \nobserved ATAC signal (middle) and sum of GET-MPRA prediction and observed \nATAC signal (bottom). b. Promoter (top) or ATAC peak (bottom) elements are \ngated into four sub-categories, respectively, based on high (+) or low (−) in \nPrediction (cutoff=1) or Observation (cutoff=0.5). c. Histone mark enrichment \nanalysis of promoter (top) and peak (bottom) elements respectively using \nENCODE K562 ChIP-seq data. d. Transcription factor binding site enrichment \nanalysis of promoter (Top) and peak (Bottom) elements respectively using \nENCODE K562 ChIP-seq data. Fisher exact test was performed. Tests with a \np-value < 0.05 are shown. Color shows log10 (Fold enrichment). For transcription \nfactors, the variance of fold enrichment across four groups was calculated, and \nthe top 50 TFs are visualized.\nExtended Data Fig. 6 | Additional data on long range cis-regulatory \nelements identification.  a. Per-gene AUPRC benchmark of cis-regulatory \nregion prediction with top 10% HbFbase as the label cut off. No bootstrapping \nwas performed due to low number of enhancer-gene pairs. b. Distance stratified \nAUPRC benchmark using top 25% HbFbase as the label cut off. Data are \npresented as mean values with 95% confidence intervals across random \nbootstrapping (N = 1,000, 80% of the pairs). c. Cis-regulatory region prediction \nof HBG2 and MYB loci. d. Distance-stratified Pearson correlation between \npredicted scores and K562 CRISPRi effect size.\nArticle\nExtended Data Fig. 7 | Regulatory analysis with GET. a. Predicted top three \nregulators (motifs) for BCL11A, NFIX, and HBG2. Similar sequence patterns are \nhighlighted with color shades. b . GATA downstream targets inferred by GET \n(top 10% motif score) show functional enrichment in ‘hemopoiesis’. Scatterplot \nshows predicted gene expression (X axis) and GATA-motif score (Y axis) for \nGATA-targeted genes with predicted expression larger than 1. All transcription \nfactors among these genes are labeled in the plot, where those involved in \nHemopoiesis are highlighted in red. c . Workflow to collect and visualize the \ncross-cell-type regulatory embedding, showing a tSNE visualization of the \nresulting embedding space colored by Louvain clustering. d . Subsampled first \nlayer embeddings from fetal astrocyte (blue) and two fetal erythroblast cell \ntypes are visualized with UMAP (yellow and brown). e . Louvain clustering of \nsubsampled embedding in panel d. f. Gene ontology enrichment of genes in \ncluster 2, showing astrocyte-relevant terms and astrocyte marker genes e. \ng. NFIA, GLI3. X axis shows adjusted -log10 P-value from one-sided Fisher’s \nexact test. g. GET motif contribution Z-score (red means higher score compared \nto other clusters) for each cluster. Note that cluster 2 has elevated NFI/1 and \nNFI/2 motifs, which correspond to the NFI family transcription factors. h . Top \ncorrelated motif pairs have significantly larger functional similarity. X-axis is \ncosine similarity computed on term (motif clusters) frequency–inverse \ndocument (Gene Ontology biological process) frequency (transcription \nfactor-IDF) matrix. i . Example causal neighbor graph showing interactions \n(edges) between motifs (nodes). Edge weights represent interaction effect size. \nEdge directions mark causal direction. Blue and red edge colors mark negative \nand positive estimated causal effect sizes by LiNGAM, respectively. Node color \nmarks community detected on the full causal graph. In-community edges are \nmarked by reduced saturation. j. Out-degree distribution across cell-type-  \nspecific causal networks.\nExtended Data Fig. 8 | Structural properties of GET causal network.  \na. Catalogs of TF-TF interactions. Direct interactions include homodimers, \nintra-family heterodimers, or inter-family heterodimers. Cofactor-mediated \ninteractions may include both cooperative and competitive binding. b . pLDDT \nplot for the IDR (intrinsically disordered region) and DBD (DNA-binding domain) \nfor TFAP2A and ZFX. c . Predicted monomer structure of ZFX. d. Predicted \nmultimer structure of TFAP2A structured domains and ZFX IDR. Red and  \nblue color marks negative and positive electrostatic surfaces, respectively.  \ne. Molecular dynamics simulation (100 ns) of TFAP2A-ZFX IDR (red) and ZFX \nIDR monomer (purple). Collapsed structure in ZFX IDR monomer is highlighted \nin rectangle. f. Sequence logo of ZFX and TFAP2A transcription factor binding \nmotifs. g. Immunoblot detection of TFAP2A, ZFX, and β-ACTIN from HeLa  \ncell lysates subjected to co-immunoprecipitation using a TFAP2A antibody. \nβ-ACTIN serves as a loading control in the same gel. Abbreviation: Pre, HeLa cell \nlysate prior to bead incubation; Post, HeLa cell lysate after bead incubation; IP , \nimmunoprecipitated proteins. B, empty lane. Two independent experiments \nwere repeated with similar results. A representative result was shown. Raw gel \nimage is in Supplementary Fig. 1. h-j . Prediction of structural interactions \nbetween SNAI1 N-terminal and EP300 TAZ2 domain, SNAI1 N-terminal and \nEP300 TAZ1 domain, and RELA C-terminal and EP300 TAZ1 domain. Red and \nblue color marks negative and positive electrostatic surfaces, respectively.\n\nArticle\nExtended Data Fig. 9 | Additional structural analysis of GET causal \nnetwork.  a. Prediction performance of “intra-family binder” transcription \nfactors using different multimer structure prediction confidence scores.  \n(Left) ROC curve with X axis showing false positive rate and Y axis showing true \npositive rate. (Right) PR curve with X axis showing recall and Y axis showing \nprecision. mean_plddt : Average predicted Local Distance Difference Test \n(pLDDT) score across all residues. pae: Predicted Aligned Error across all \ninter-chain interactions. pdockq : Predicted DockQ metric using interface \npLDDT. pdockq_pae : Multiplication of pDockQ and pAE. b . Comparison of \nAlphaFold 2 predicted TFAP2A dimer structure (pink) with crystal structure  \nof TFAP2A (yellow)-DNA (green) complex. c . Change in number of hydrogen \nbonds in TFAP2A-ZFX IDR complex or ZFX IDR monomer across simulation \ntrajectory. d. Correlation between pLDDT and residue root mean square \ndeviation (RMSD) across the simulation trajectory of ZFX IDR in the complex \nstructure. Visualized in scatter plot (top) and line plot across the protein \nsequence (bottom). Yellow and blue shades in the line plot highlight beta \nsheets or alpha helices. e . Upper panel show AlphaFold3-based structure \nprediction between SRF IDR with its DNA-binding domain (133-230aa)  \nremoved and full length TFAP2A, demonstrating no clear interactions between \nthese two proteins and low prediction confidence for SRF IDR, indicating its \nhighly disordered structure. Color represents pLDDT (red is high, blue is  \nlow; left) or chains (pink, purple, green; right). Lower micrographs show \nimmunoblot detection of SRF and β-ACTIN from HeLa cell lysates subjected to \nco-immunoprecipitation using a TFAP2A antibody. β-ACTIN serves as a loading \ncontrol in the same gel, as well as a sample processing control for Extended \nData Fig. 7g. SRF and β-ACTIN both show no interactions with TFAP2A as \ndetermined by co-immunoprecipitation. Abbreviations: Pre, HeLa cell lysate \nprior to bead incubation; Post, HeLa cell lysate after bead incubation; IP , \nimmunoprecipitated proteins; B, empty lane. Raw gel image is in Supplementary \nFig. 1. f. Predicted multimer structure of EGR1 IDR-ZFX IDR. g . Predicted \nmultimer structure of ZEB1 C-terminal and ESR1 NR domain. h. Distribution of \nGET Causal Absolute Effect Size (Y axis) against AlphaFold2-derived EP300- \nmediated motif-motif interaction potential (X axis); Mann-Whitney U test P-value \n9.73e-3; Fisher exact test P-value 7.3e-3 (one-sided, odds ratio=1.57) with GET \nCausal cutoff at 95% percentile over all motif-motif pairs. Box plot showing \nmedian and interquartile range.\nExtended Data Fig. 10 | Validation experiments for proximity labelling assay \nin B-ALL REH cell line. a. Detection of biotinylated proteins in REH cell line \ntransduced with PAX5 WT-linker-BioID (PAX5 WT) and PAX5 G183S-linker-BioID \n(PAX5 G183S) fusion proteins by western blot analysis using streptavidin-HRP . \nExpression of RHOA WT-linker-BioID is used as specificity control (RHOA WT).  \nb. Detection of PAX5 and RHOA BioID-fusion proteins in REH cells by western \nblot analysis using anti-PAX5 and anti-HA antibodies. c. Fusion protein \nquantification from panel b. d. Detection of biotinylated proteins in whole  \ncell lysates (input; 1% of total protein lysate) and Streptavidin-enriched eluates \n(Enrichment) by streptavidin-HRP staining. GAPDH was used as a loading \ncontrol in the same gel. Raw gel images are in Supplementary Fig. 1.\nArticle\nExtended Data Fig. 11 | PAX5 G183S drives a PAX5-NR2C2 coregulated \ntranscriptional program.  a. Venn diagram of identified PAX/2 and NR/3 \nspecific and common regulatory targets using GET gene-by-motif importance \nmatrix. b. Enrichment analysis (-log 10 adjusted p-value from one-sided Fisher \nexact test) using B-cell associated gene sets in Shah et al.8 (top) and biological \nprocess gene ontology gene sets (bottom). Results for the PAX/2-NR/3 common \ngenes are shown in this figure. c. Gene enrichment analysis of NR/3-specific \n(orange) and PAX/2-specific (blue) target genes using published B cell related \ngene sets 8. d. Gene enrichment analysis of NR/3-specific (orange) and \nPAX/2-specific (blue) target genes using gene ontology biological processes.  \ne. Heatmap with the specific transcriptional program for the cases with the \ngermline PAX5 G183S mutation. f. Enrichment analysis for differentially \nexpressed genes between PAX5 wild type vs. PAX5 loss (left) and PAX5 G183S vs. \nother PAX5 alterations (CNV loss, P80R). * indicates statistical significance from \none-sided hypergeometric tests. Benjamini-Hochberg adjusted P-values: PAX5: \n6.34e-3 (left); NR/3: 4.24e-30; PAX5 + NR/3: 6.28e-18; ProB_Activated: 8.86e-3 \n(right).",
  "topic": "Foundation (evidence)",
  "concepts": [
    {
      "name": "Foundation (evidence)",
      "score": 0.6491347551345825
    },
    {
      "name": "Transcription (linguistics)",
      "score": 0.4943819046020508
    },
    {
      "name": "Computational biology",
      "score": 0.39194267988204956
    },
    {
      "name": "Biology",
      "score": 0.36927932500839233
    },
    {
      "name": "Geography",
      "score": 0.1598789393901825
    },
    {
      "name": "Archaeology",
      "score": 0.11777043342590332
    },
    {
      "name": "Philosophy",
      "score": 0.09687700867652893
    },
    {
      "name": "Linguistics",
      "score": 0.0
    }
  ],
  "institutions": [
    {
      "id": "https://openalex.org/I78577930",
      "name": "Columbia University",
      "country": "US"
    },
    {
      "id": "https://openalex.org/I4210113480",
      "name": "Mohamed bin Zayed University of Artificial Intelligence",
      "country": "AE"
    },
    {
      "id": "https://openalex.org/I74973139",
      "name": "Carnegie Mellon University",
      "country": "US"
    },
    {
      "id": "https://openalex.org/I4210145812",
      "name": "Cancer Genetics (United States)",
      "country": "US"
    },
    {
      "id": "https://openalex.org/I57206974",
      "name": "New York University",
      "country": "US"
    },
    {
      "id": "https://openalex.org/I99065089",
      "name": "Tsinghua University",
      "country": "CN"
    }
  ],
  "cited_by": 51
}