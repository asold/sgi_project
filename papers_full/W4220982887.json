{
  "title": "The SAMBA tool uses long reads to improve the contiguity of genome assemblies",
  "url": "https://openalex.org/W4220982887",
  "year": 2022,
  "authors": [
    {
      "id": "https://openalex.org/A1966385910",
      "name": "Aleksey V Zimin",
      "affiliations": [
        "Johns Hopkins University"
      ]
    },
    {
      "id": "https://openalex.org/A1904680277",
      "name": "Steven L. Salzberg",
      "affiliations": [
        "Johns Hopkins University"
      ]
    },
    {
      "id": "https://openalex.org/A1966385910",
      "name": "Aleksey V Zimin",
      "affiliations": [
        "Johns Hopkins University",
        "Johns Hopkins Medicine"
      ]
    },
    {
      "id": "https://openalex.org/A1904680277",
      "name": "Steven L. Salzberg",
      "affiliations": [
        "Johns Hopkins University",
        "Johns Hopkins Medicine"
      ]
    }
  ],
  "references": [
    "https://openalex.org/W6795410112",
    "https://openalex.org/W2011246380",
    "https://openalex.org/W2076163156",
    "https://openalex.org/W2167757586",
    "https://openalex.org/W2884954915",
    "https://openalex.org/W2130530163",
    "https://openalex.org/W2580040938",
    "https://openalex.org/W3110957961",
    "https://openalex.org/W2110145781",
    "https://openalex.org/W1579534339",
    "https://openalex.org/W2107772251",
    "https://openalex.org/W3085758516",
    "https://openalex.org/W3037791019",
    "https://openalex.org/W3042374389",
    "https://openalex.org/W3167062982",
    "https://openalex.org/W2789843538",
    "https://openalex.org/W2788228074",
    "https://openalex.org/W4225908069",
    "https://openalex.org/W2994865123",
    "https://openalex.org/W4220999759"
  ],
  "abstract": "Third-generation sequencing technologies can generate very long reads with relatively high error rates. The lengths of the reads, which sometimes exceed one million bases, make them invaluable for resolving complex repeats that cannot be assembled using shorter reads. Many high-quality genome assemblies have already been produced, curated, and annotated using the previous generation of sequencing data, and full re-assembly of these genomes with long reads is not always practical or cost-effective. One strategy to upgrade existing assemblies is to generate additional coverage using long-read data, and add that to the previously assembled contigs. SAMBA is a tool that is designed to scaffold and gap-fill existing genome assemblies with additional long-read data, resulting in substantially greater contiguity. SAMBA is the only tool of its kind that also computes and fills in the sequence for all spanned gaps in the scaffolds, yielding much longer contigs. Here we compare SAMBA to several similar tools capable of re-scaffolding assemblies using long-read data, and we show that SAMBA yields better contiguity and introduces fewer errors than competing methods. SAMBA is open-source software that is distributed at https://github.com/alekseyzimin/masurca .",
  "full_text": "RESEA RCH ARTICL E\nThe SAMBA tool uses long reads to improve\nthe contiguity of genome assemblies\nAleksey V. Zimin\nID\n1,2\n*, Steven L. Salzberg\nID\n1,2,3,4\n1 Department of Biomedic al Enginee ring, Johns Hopkins University, Baltimor e, Maryland , United States of\nAmerica, 2 Center for Computationa l Biology, Johns Hopkins University, Baltimor e, Maryland , United States\nof America, 3 Department of Computer Science, Johns Hopkins University, Baltimore, Maryland , United\nStates of America, 4 Department of Biostatistic s, Johns Hopkins Universit y, Baltimore, Maryland, United\nStates of America\n* aleksey .zimin@gm ail.com\nAbstract\nThird-generation sequencing technologies can generate very long reads with relatively high\nerror rates. The lengths of the reads, which sometimes exceed one million bases, make\nthem invaluable for resolving complex repeats that cannot be assembled using shorter\nreads. Many high-quality genome assemblies have already been produced, curated, and\nannotated using the previous generation of sequencing data, and full re-assembly of these\ngenomes with long reads is not always practical or cost-effective. One strategy to upgrade\nexisting assemblies is to generate additional coverage using long-read data, and add that to\nthe previously assembled contigs. SAMBA is a tool that is designed to scaffold and gap-fill\nexisting genome assemblies with additional long-read data, resulting in substantially greater\ncontiguity. SAMBA is the only tool of its kind that also computes and fills in the sequence for\nall spanned gaps in the scaffolds, yielding much longer contigs. Here we compare SAMBA\nto several similar tools capable of re-scaffolding assemblies using long-read data, and we\nshow that SAMBA yields better contiguity and introduces fewer errors than competing meth-\nods. SAMBA is open-source software that is distributed at https://github.com/a lekseyzimin/\nmasurca.\nAuthor summary\nThe DNA molecule that is in almost every cell in a living organism can be represented as\nsequence of four different nucleotides, or bases denoted by letters A,C,G, and T. The cur-\nrent sequencing technologies require breaking the DNA molecule into short fragments,\nsequencing them to find the corresponding sequence of letters, producing “reads”, and\nassembly, which recovered the DNA sequence from the reads. Repeats in the genome\nsequences typically prevented one from recovering full contiguous genome sequence\nbecause any repeat that is longer than the size of the read cannot be reliably resolved.\nThird-generation sequencing technologies can generate very long reads albeit with rela-\ntively high error rates. The lengths of the reads, which sometimes exceed one million\nbases, make them invaluable for resolving complex repeats that cannot be assembled\nPLOS COMP UTATIONAL  BIOLOGY\nPLOS Computationa l Biology | https:/ /doi.org/10.13 71/journal.p cbi.1009860 February 4, 2022 1 / 11\na1111111111\na1111111111\na1111111111\na1111111111\na1111111111\nOPEN ACCESS\nCitation: Zimin AV, Salzberg SL (2022) The\nSAMBA tool uses long reads to improve the\ncontiguity of genome assemblies. PLoS Comput\nBiol 18(2): e1009860. https://doi. org/10.1371/\njournal.pcb i.1009860\nEditor: Mingfu Shao, Carnegie Mellon Univers ity,\nUNITED STATES\nReceived: October 22, 2021\nAccepted: January 24, 2022\nPublished: February 4, 2022\nCopyright: © 2022 Zimin, Salzberg. This is an open\naccess article distributed under the terms of the\nCreative Commons Attribution License, which\npermits unrestricte d use, distribu tion, and\nreproduction in any medium, provided the original\nauthor and source are credited.\nData Availabilit y Statement: The Illumina and\nPacBio data for A. thaliana are available from NCBI\nSRA under access ions SRX533 607, SRX533608\nand from http://scha tzlab.cshl.edu/ data/ectoo ls/.\nThe human CHM13 data is available from https://\ngithub.co m/marbl/CHM 13. The data for HG01243\ngenome were released by Shafin et al., and are\navailable from https:// github.com/hum an-\npangenom ics/hpgp-da ta. SAMBA is open-sourc e\nsoftware that is distributed at https://g ithub.com/\nalekseyzim in/masurca.\nusing previous-generation reads. Many high-quality genome assemblies have already been\nproduced, curated, and annotated using the previous generation of sequencing data, and\nfull re-assembly of these genomes with long reads is not always practical or cost-effective.\nHere we introduce a tool called SAMBA that is designed to upgrade existing assemblies\nusing additional coverage with long-read data, resulting in substantially greater contiguity.\nHere we compare SAMBA to several similar tools capable of re-scaffolding assemblies\nusing long-read data, and we show that SAMBA yields better contiguity and introduces\nfewer errors than competing methods. SAMBA is open-source software that is distributed\nat https://github.com/alek seyzimin/masurca.\nIntroduction\nThe development of long-read sequencing technologies has revolutionized the genome assem-\nbly landscape. It is possible now, for example, to get reads that are up to a million bases long\nfrom Oxford Nanopore’s MinION and PromethION instruments [1]. These \"ultralong\" reads\nare extremely helpful for assembling genomic regions filled with long, complex repeats. How-\never, the high error rates are still an obstacle to obtaining high-quality genome sequences from\nlong reads alone. One effective strategy for creating assemblies with long reads is to generate\nboth short and long reads, and then to assemble the “easy” parts of the genome with short\nreads and use the long reads to resolve the hard-to-assemble regions. However, for many\ngenomes that have already been sequenced, existing assemblies already capture most of the\nnon-repetitive sequence, obviating the need to generate additional short-read data. For these\ngenome assemblies, adding long read data might provide a fast, cost-effective way to improve\ntheir contiguity.\nA hybrid approach for scaffolding genomes using long-read data was first proposed in [2].\nThe underlying algorithm is straightforward: first it maps long reads to contigs, then it uses the\nalignments to link the contigs into a graph, and finally it traverses the resulting graph to pro-\nduce scaffolds, in which gap sizes are estimated from the linking information. In practice,\nimplementing this approach may be quite complex, due to repetitive alignments that introduce\nloops and nested loops in the graph, and to erroneous links that result from spurious align-\nments of reads.\nIn this paper we describe a novel tool called SAMBA (Scaffolding Assemblies with Multiple\nBig Alignments) that uses long reads to re-scaffold contigs from an existing genome assembly\nand to fill gaps in those scaffolds. The tool is designed to use 10-30x coverage in long read data\nwith a set of existing contigs, although it can function with lower or higher coverage as well.\nSeveral previously developed tools also allow for scaffolding with long reads. These include\nAHA, which is part of the SMRT software analysis suite [2], SSPACE-LongRead [3], and\nLINKS [4], all of which were designed for bacteria and other small genomes. The SMIS scaf-\nfolder (https://www.sanger.ac.uk/tool/sm is/) utilizes an approach of creating artificial “mate-\npairs” from the long reads and using that mate-pair information to scaffold the contigs. The\nrecently published LRScaf tool [5] is one of the very few tools besides SAMBA that can handle\nmammalian-sized genome data, but its algorithm is prone to creating artificial duplications of\ncontigs. All tools except for SMIS attempt to merge contigs when negative gaps (overlaps\nbetween contigs within a scaffold) are detected, however none of these tools utilize the consen-\nsus of the long reads to fill gaps in the scaffolds as SAMBA does.\nThe SAMBA tool described here is also a general-purpose assembly improvement tool. It\nhas two modes or operation that are set by the “-d” parameter. It takes as input an assembly,\nPLOS COMP UTATIONAL  BIOLOGY\nThe SAMBA tool uses long reads to improve the contiguity of genome assemblies\nPLOS Computationa l Biology | https:/ /doi.org/10.13 71/journal.p cbi.1009860 February 4, 2022 2 / 11\nFunding: This work was supported in part by the\nUSDA National Institute of Food and Agriculture\nunder grant 2018-67015 -28199) to AVZ, by\nNational Science Foundation grant IOS-1744 309 to\nSLS, and by National Institutes of Health grants\nR01-HG00 6677 and R35-GM130 151 to SLS. The\nfunders had no role in study design, data collection\nand analysis, decision to publish, or preparation of\nthe manuscript.\nCompeting interests : The authors have declared\nthat no competing interests exist.\nwhich can be a set of contigs or scaffolds, plus either a set of long reads (“-d ont” for ONT\nreads, or “-d pbclr” for PacBio CLR or legacy reads) or another set contigs from the same or a\nclosely related genome, or PacBio HiFi reads (“-d asm”). It then uses the reads or the other\ncontigs to link and merge contigs of the input assembly. SAMBA is fast and memory efficient:\nit can scaffold and gap-fill a mammalian genome in only a few hours on a modern 24–32 core\nserver, utilizing no more than 50Gb of RAM for a human-size genome. In this paper we pres-\nent the results of running SAMBA on data sets from Arabidopsis thaliana and human, and we\ncompare its accuracy and run times to other comparable recently published and currently\nmaintained software.\nWe note that in cases where the original assembly was built from only short-read data, full\nre-assembly of the genome using both long and short reads, with a hybrid assembler such as\nMaSuRCA [6,7] or Wengan [8], will likely offer better results than re-scaffolding with\nSAMBA. However, in many cases full re-assembly is not practical due to resource constraints\nor to the unavailability of the original data. Also for existing assemblies that already used some\nlong read data, post-processing with even longer reads with SAMBA will yield improvements\nat a low computational cost.\nSAMBA is open source software, distributed with the MaSURCA assembler, included in\nversion 4.0.5 and above.\nResults\nWe compared the performance of SAMBA with three other long-read scaffolding algorithms:\nLRScaf version 1.1.11 [5], LINKS 1.8.7 [4], and SMIS v0.1-alpha (https://www.sanger.ac.uk /\ntool/smis/). Because AHA and SSPACE were designed for bacterial genomes, their memory\n(RAM) requirements make them impractical to use for large (mammalian-sized) genomes, so\nwe did not include them in these experiments.\nFor the experimental comparisons, we used data sets from two organisms, Arabidopsis\nthaliana Ler-0 and human, see Table 1. The Illumina and PacBio data for Arabidopsis was\ndescribed in [9], and the high-quality assembly of these data is available from [10]. See Data\nAvailability section for more details, including the URLs and accession numbers.\nArabidopsis thaliana evaluation\nWe first assembled the genome of Arabidopsis thaliana from Illumina paired-end reads, with-\nout using PacBio data, using MaSuRCA 4.0.3 [6,7]. For clarity we will refer to this assembly as\nTable 1. Data used for the scaffolding experiment s, including short and long reads from the model plant Arabi-\ndopsis thaliana, and reads from two different individual humans. The Illumina reads were paired-end reads of a\nfixed length. N50 read length is comput ed by summing all read lengths, and determini ng the value N50 such that 50%\nof that total length is covered by reads of N50 or longer.\nNumbe r of reads Genome coverage N50 read length\nA. thaliana\nIllumina 46,129,480 115x 300\nPacBio P6-C4 3,448,228 118x 7,205\nH. sapiens CHM13\nOxford Nanopor e 29,468,868 118x 56,695\nH. sapiens HG01243\nIllumina paired-e nd 1,307,137, 030 59x 150\nPacBio CLR 23,672,554 113x 28,837\nOxford Nanopor e 16,239,849 58x 44,052\nhttps://d oi.org/10.1371/j ournal.pc bi.1009860. t001\nPLOS COMP UTATIONAL  BIOLOGY\nThe SAMBA tool uses long reads to improve the contiguity of genome assemblies\nPLOS Computationa l Biology | https:/ /doi.org/10.13 71/journal.p cbi.1009860 February 4, 2022 3 / 11\nAthal-Illumina. The Athal-Illumina assembly contained a total of 118,048,454 bp of sequence\nin 4663 contigs, with an NG50 contig size of 172,147 bp; i.e., the size at which >50% of the\nassembly is contained in contigs of this length or longer. The NG50 size was computed by\nQuast [11] using as reference the previously-publishe d assembly of the same plant produced\nwith the PacBio data [10], which we refer to as Athal-Berlin. We did not use the Arabidopsis\nreference genome for this comparison to avoid introducing noise due to possible structural\ndifferences between the reference plant and the plant used for sequencing and assembly of\nAthal-Berlin. NG50 differs from the standard N50 computation in that the genome size used\nfor the computation is that of the reference (Athal-Berlin) rather than that of Athal-Illumina\nitself. Further evaluation of the Athal-Illumina assembly with Quast reported an NGA50 of\n150,736 bp with 139 mis-assemblies. Quast computes NGA50 by splitting the query (Athal-\nIllumina) genome at mis-assemblies detected by aligning it to the reference (Athal-Berlin), and\nthen re-running the NG50 computation.\nNote that in general, SAMBA is indifferent to the choice of the assembler used to produce\nthe input contigs, as long as the contigs satisfy our size guidelines, including an N90 value\nlarger than the minimum alignment length parameter.\nWe then scaffolded Athal-Illumina using (1) additional PacBio reads and (2) the Athal-Ber-\nlin assembly. For the first re-scaffolding, we randomly chose multiple subsets of long PacBio\nreads, each representing 10-50x coverage, from the total of 118X coverage available (Table 1).\nWe then used these to re-scaffold the Athal-Illumina assembly, and then to evaluate the scaf-\nfolder’s performance as function of long-read coverage. We evaluated assembly quality with\nQuast before and after scaffolding, using the Athal-Berlin assembly as the reference. For both\nSAMBA and LRScaf we used similar scaffolding parameters, setting the minimum long-read\nalignment length to 2500 bp and the maximum overhang length to 1000 bp. We experimented\nwith different values of minimum alignment length, and 2500 seemed to provide the best bal-\nance between the number of mis-assemblies and the size of output scaffolds for this data set.\nDecreasing that number led to more aggressive scaffolding (i.e., larger scaffolds) at the expense\nof a higher mis-assembly rate for both programs. LINKS and SMIS use different approaches to\nscaffolding and do not offer the user the ability to adjust these parameters, and thus we used\nthe defaults for these programs.\nThe scaffolding results for Arabidopsis as a function of long-read coverage depth are shown\nin Fig 1. SAMBA had the smallest number of scaffolding errors (Fig 1D), and it yielded the lon-\ngest contigs (Fig 1A). LRScaf and SMIS created the longest scaffolds (Fig 1B). LRScaf had the\nhighest number of errors in both contigs and scaffolds (Fig 1C and 1D). Improvements in con-\ntiguity obtained by all scaffolders saturated at about 30x coverage by long reads. We also\nnoticed that the total amount of sequence in LRScaf’s output varied substantially for different\ninputs, ranging from 118–127 Mbp for this 120 Mbp genome. We traced that to a tendency for\nLRScaf to create erroneous duplicate copies of contigs on the ends of some scaffolds. (Note\nthat we reported this as an issue on the LRScaf github site.)\nWhen we used the Athal-Berlin assembly [10] to scaffold the Athal-Illumina assembly, we\nwere able to achieve an NGA50 of 1,173 Kbp, more than twice as large as the 567 Kbp that was\nthe best NGA50 length when we re-scaffolded with long reads alone. Not surprisingly, assem-\nbly using Illumina and PacBio data was far superior to using Illumina data alone, so it would\nmake more sense to simply use both data sets in the first place. However, if one is assembling a\ngenome that is very closely related to a previously-assemble d species, one can use this\napproach to improve an Illumina-only assembly. SAMBA introduced only one contig mis-\nassembly, compared to 30 or more mis-assemblies introduced when using the PacBio data\nwith any of the scaffolding programs (Fig 1D). This shows the effectiveness of SAMBA in rec-\nonciling different assemblies of the same genome. Ideally, we would like to achieve the same\nPLOS COMP UTATIONAL  BIOLOGY\nThe SAMBA tool uses long reads to improve the contiguity of genome assemblies\nPLOS Computationa l Biology | https:/ /doi.org/10.13 71/journal.p cbi.1009860 February 4, 2022 4 / 11\ncontiguity as the reference when scaffolding with a better assembly of the same species, but\ncontig mis-assemblies in the Athal-Illumina assembly prevented that here. Below we discuss\nfurther the issue of detecting contig mis-assemblies.\nWe evaluated how the quality of consensus of the scaffolded assembly varied with the cover-\nage by the additional long read data. For this evaluation we used the mismatches and inser-\ntion/deletion statistics computed by Quast before and after running SAMBA. We then\ncomputed the number of total bases added to the assembly in “patches” (gap-filling sequence)\nand computed the average error rate of the patches. The overall error rate for the Arabidopsis\npatches was ~5%, as shown in Table 2. The PacBio data used for this experiment had error rate\nof about 17%, which we estimated by mapping the reads to the Athal-Berlin assembly with\nminimap2. The error rate in the patches only decreased very slightly as the coverage increased,\nprimarily because higher coverage allowed SAMBA to span a larger number of gaps, but not\nnecessarily with higher coverage of the patches.\nEvaluation of the Athal-Illumina assembly with Merqury [12] yielded a quality value (QV)\nof 51, and the re-scaffolded assemblies output by SAMBA had QVs ranging from 42 to 43 for\n10x-50x coverage of PacBio reads. SAMBA-scaffolded assemblies can be further polished,\nFig 1. Scaffolding the Athal-Illum ina assembly with LINKS, SMIS, LRScaf, and SAMBA. We compared performance as a\nfunction of long-read (PacBio) coverage, shown on the x-axis. Panels (a) and (b) show the NGA50 size for contigs and scaffolds\nafter scaffoldin g with each tool. SAMBA outputs contigs, and thus its scaffold and contig results are the same. Panels (c) and (d)\nshow the number of mis-asse mblies introduced by the scaffolding process. The LINKS scaffolder required more than 512GB of\nRAM for PacBio coverage >20x, and thus we did not run it with higher coverag e. SMIS does not change contigs, so we did not\ninclude its statistics on panels (a) and (c).\nhttps://d oi.org/10.1371/j ournal.pc bi.1009860. g001\nTable 2. Evaluation of the completenes s and the consensu s quality of the Arabid opsis assemblies after scaffolding with PacBio data with SAMBA. We computed the\naverage consensus quality of the gap-filling sequences for different levels of long-read coverag e based on the number of mismatches , insertion s and deletions reported by\nQUAST before and after scaffolding. Because more gaps were closed at higher coverag e, the average error rate of the patches decreased only marginally.\nAdditional long read coverage 10x 20x 30x 40x 50x\nGaps filled 741 831 874 907 910\nBases in patches that filled gaps 312,587 378,735 425,150 516,455 548,622\nAverage error rate for the patches 6% 5% 5% 4.8% 4.5%\nhttps://do i.org/10.1371/j ournal.pc bi.1009860. t002\nPLOS COMP UTATIONAL  BIOLOGY\nThe SAMBA tool uses long reads to improve the contiguity of genome assemblies\nPLOS Computationa l Biology | https:/ /doi.org/10.13 71/journal.p cbi.1009860 February 4, 2022 5 / 11\nincreasing the overall consensus quality substantially; for example, we polished the 30x re-\nassembly with POLCA [13] using the Illumina reads, and improved the QV to 57, correspond-\ning to fewer than 5 errors per megabase.\nWe observed that, due to the sequence added in the gaps, the completeness of the assem-\nblies after scaffolding with SAMBA increased slightly, from 93.75% in the original Athal-Illu-\nmina assembly to 94% in the assembly scaffolded with SAMBA using 50x coverage in PacBio\ndata.\nHomo sapiens evaluation\nNext, we examined the scaffolders’ performance on human data, which we evaluated on two\ndifferent human data sets. The first data set is from CHM13, a haploid human cell line that\nwas used to create the first-ever complete human genome assembly [1,14], and the second data\nset is diploid data from a Puerto Rican individual, HG01243, sequenced as part of the human\npangenome project (see Data Availability section). Details of these datasets are listed in\nTable 1. The Telomere-to-Telomere (T2T) consortium has produced a very high-quality, gap-\nfree assembly of CHM13 called CHM13 v1.1 [1] which makes evaluations of assembly correct-\nness for the CHM13 data straightforward. However, due to its pseudo-haploid nature, the\nCHM13 genome is considerably easier to assemble than a typical diploid human. Thus we also\ninclude in our comparison assemblies of the diploid human sample HG01243.\nFor the first human comparison, we used a draft assembly of CHM13 produced by the\nGenome Institute at Washington University School of Medicine in 2015 (NCBI accession\nGCA_000983455.2). This assembly, which we refer to as CHM13-WashU, was produced with\nthe Falcon assembler using 52x coverage in PacBio reads. Evaluation of this assembly with\nQuast yielded an NGA50 contig size of 9,287,872 bp, with 2,346 apparent mis-assemblies\nwhen compared to the CHM13 v1.1 assembly. To re-scaffold the CHM13-Washu assembly,\nwe used the ONT reads from the CHM13hTERT cell line described in Table 1.\nFor the comparison on diploid human data, we produced an assembly of HG01243 from\nIllumina and PacBio data (Table 1) using MaSuRCA, which we refer to as HG01243-IP. For\ncomparisons, we used the recently-published complete genome of HG01243, called PR1 [15]\nas the reference in QUAST. Evaluation of the HG01243-IP assembly with yielded an NGA50\ncontig size of 5,839,185 bp with 1,183 apparent mis-assemblies when compared to PR1.\nWe then used SAMBA, LINKS, SMIS and LRScaf to scaffold the CHM13-WashU and\nHG10243-IP assemblies using randomly chosen subsets of ultralong ONT reads representing\n10x, 20x and 30x coverage. We set the minimum long read alignment to 5000 bp for both\nSAMBA and LRScaf. LINKS required more than 512 GB of computer memory even at the low-\nest level of ONT read coverage, and SMIS was unable to complete the scaffolding in 2 weeks\non a 24-core server; therefore, we did not include the results from either of these tools in these\ncomparisons. We evaluated contiguity and correctness with Quast using CHM13 v1.1 as the\nreference.\nFig 2 compares the resulting scaffold sizes as a function of read coverage for both assem-\nblies, using NGA50 size for CHM13 and HG01243. Panels (a) and (c) refer to HG01243 evalu-\nations and panels (b) and (d) refer to CHM13 evaluations. For the CHM13 genome, LRScaf\nproduced bigger scaffolds with more errors than SAMBA, while for the HG01243 assembly\nSAMBA contigs were as big as scaffolds produced by LRScaf, while having much fewer mis-\nassemblies.\nIn terms of cost-benefit analysis, we observe that scaffold sizes continued to increase as cov-\nerage in ONT reads rose from 20x to 30x, suggesting that even deeper coverage would yield\nsome additional improvements.\nPLOS COMP UTATIONAL  BIOLOGY\nThe SAMBA tool uses long reads to improve the contiguity of genome assemblies\nPLOS Computationa l Biology | https:/ /doi.org/10.13 71/journal.p cbi.1009860 February 4, 2022 6 / 11\nFor the human experiments we used the ONT reads to create the final consensus of the\ngap-closing sequences, or patches. As mentioned above, the ONT reads in our experiments\nhad a lower error rate than the PacBio reads. This difference resulted in a higher consensus\nquality for the patches, ranging from an average of 3.5% error for the CHM13 assembly with\n10x in additional ONT coverage down to 2.6% with 30x ONT coverage.\nIn all our experiments, SAMBA ran much faster than SMIS and LINKS, but somewhat\nslower than LRScaf. For example, at 30x coverage in the Arabidopsis experiment (Fig 1),\nSAMBA scaffolded the Athal-Illumina assembly in about 36 minutes, with 30 minutes spent\non computing consensus on the sequence “patches” used for merging contigs. On the same\ndata set, LINKS took nearly 10 hours and SMIS took about 28 hours (Table 3). LRScaf was the\nfastest, completing the scaffolding in under 5 minutes, with most of the time (4 minutes) spent\nin alignment of the long reads with minimap2. SAMBA does extra work, as compared to\nLRScaf, in computing the consensus to fill the gaps. When the time spend computing the gap\nsequences is subtracted, LRScaf and SAMBA have very similar run times. On the human data\n(Fig 2), SAMBA completed scaffolding and gap filling with 30x Nanopore long reads in 12\nhours, with 9 hours spent on initial read alignment by minimap2 and 3 hours spent on com-\nputing the consensus sequences to fill gaps. LRScaf finished the scaffolding in about 9 hours.\nThe time spent on scaffolding (resolving the contig graph) was only a few minutes for both\nFig 2. Contiguity and accuracy results for SAMBA and LRScaf on scaffolding of human assemblies CHM13 (CHM13- WashU) and\nHG01243 (HG01243- IP) using varied coverage of Oxford Nanopore Technolo gies (ONT) ultralong reads. The x-axis shows\ncoverage in the ONT reads. All assemblies were evaluated by Quast using the CHM13 v1.1 assembly as the reference for CHM1 3, and\nthe PR1 assembly (Zimin et al., 2021) for HG01243 . Panels (a) and (b) compare NG50 sizes for the two different human assemblie s,\nwhile (c) and (d) compare the number of mis-asse mblies. Both scaffolders produced similar NG50 sizes for HG01243, while LRScaf\nproduced bigger scaffolds for CHM13 data. SAMBA had fewer mis-assembl ies in both genomes at all depths of coverage.\nhttps://do i.org/10.1371/j ournal.pc bi.1009860. g002\nTable 3. Total wall clock time (in hours) that each tool required for scaffolding the Arabidopsis and human assemblies with 30x coverage by long reads on a 24-core\nIntel(R) Xeon(R) 6248R server with 512 GB of RAM. In parentheses we list the time required for the alignment of the long reads for SAMBA and LRScaf .\nSAMBA LRScaf LINKS SMIS\nA. thaliana 0.6(0.07) 0.1(0.07) 10 28\nHuman (CHM13) 12(9) 9(8.9) – –\nhttps://do i.org/10.1371/j ournal.pc bi.1009860. t003\nPLOS COMP UTATIONAL  BIOLOGY\nThe SAMBA tool uses long reads to improve the contiguity of genome assemblies\nPLOS Computationa l Biology | https:/ /doi.org/10.13 71/journal.p cbi.1009860 February 4, 2022 7 / 11\nLRScaf and SAMBA. For all the timings reported here, we used a 24-core Intel(R) Xeon(R)\n6248R server with 512 GB of RAM. SAMBA was quite memory -efficient, using at most 50GB\nof RAM for the highest long-read coverage human experiment, and less than 2GB or RAM for\nthe Arabidopsis experiment with 50x long-read coverage.\nDesign and implementation\nThe input to SAMBA comprises a set of input contigs C and a set of sequences used to join the\ncontigs together, which we will designate as J. J can contain either long reads or contigs from\nanother assembly of the same organism made, for example, using a different assembler.\nSAMBA starts off by aligning all sequences J\ni\nin J to the contigs C\nk\nin C using minimap2 [16].\nWe only use the best alignments that are longer than 5Kb (a parameter) that may overhang the\nend of the contig by no more than 1Kb (also a parameter), and we call these the \"proper\" align-\nments. An overhang occurs when an alignment of sequence C\nk\nto a sequence J\ni\nis such that the\nalignment stops before an end of C\nk\n, but J\ni\ncontinues beyond the end of C\nk\n. The reason why\nwe allow for overhangs is that contigs may have local mis-assemblies on the ends, which fre-\nquently are the reason why an assembler could not extend the contig. SAMBA can sometimes\nfix these mis-assemblies while merging contigs with long reads. The requirement of a mini-\nmum alignment length ensures that short repeat-induced overlaps are filtered out. We only\nkeep the proper alignments of sequences in J that align to two or more contigs in C, and dis-\ncard all alignments where J\ni\nonly aligns properly to a single contig. We note here that in prac-\ntice SAMBA performs better on relatively contiguous input assemblies, with an N90 >10 Kb;\ni.e., 90% of the assembled sequence is found in contigs of 10 Kb or longer.\nA proper alignment of a sequence J\ni\nto two contigs C\ni\nand C\nj\nin C creates a proper edge\nbetween C\ni\nand C\nj\n. If the set J consists of reads that represent relatively deep coverage, we\nrequire more than one proper edge between each pair of connected contigs. We then bundle\nthe proper edges and produce consensus sequences for them using the Flye assembler’s con-\nsensus module [17]. This results in a set of linking sequences. If J represents another assembly\nof the same or a similar genome (as opposed to a set of long reads), then we skip the consensus\nstep. We then re-align the linking sequences to the contigs in C with minimap2 and build a\ngraph of contigs in C connected by the proper edges, where the edges are the proper align-\nments of the linking sequences. Each node (each contig) naturally has a beginning and an end\nwith an arbitrary (randomly chosen) direction, and we designate all adjacent edges as either\nincoming or outgoing.\nThe next step is to search for linear paths in the graph, defined as sequences of nodes that\nhave exactly one incoming and one outgoing edge. We collapse such paths into super-nodes,\nas shown in Fig 3. Following this step, we search for \"bubbles,\" which are paths that branch\ninto two alternative paths and then re-merge. We call the nodes in the bubbles B\n1\n. . .B\nn\n, where\nn> = 2, and all incoming edges to B\n1\n. . .B\nn\nare outgoing from the same node C\ni\nand all outgo-\ning edges are incoming to the same node C\nj\n. For example, Fig 3 shows a bubble beginning at\nnode C\n2\n, which has two outgoing edges, and ending in node C\n3\n, with two incoming edges. A\ncommon source of these bubbles is a haplotype variant in the original diploid genome, which\nmay lead to a contig graph where two haplotypes representing the same location on the\ngenome were assembled into two different contigs. We “pop” the bubbles by choosing the path\nthrough the bubble that is the longest of all B\nn\nnodes. To resolve “bubbles within bubbles” we\nperform bubble popping iteratively until no bubbles are left to pop in the graph.\nFollowing bubble popping, we look for repetitive contigs, indicated by nodes or super-\nnodes that have two or more incoming and two or more outgoing edges. In SAMBA we only\naim to resolve repeats that are completely spanned by long reads in J that in turn have long\nPLOS COMP UTATIONAL  BIOLOGY\nThe SAMBA tool uses long reads to improve the contiguity of genome assemblies\nPLOS Computationa l Biology | https:/ /doi.org/10.13 71/journal.p cbi.1009860 February 4, 2022 8 / 11\noverlaps with unique sequence surrounding the repeat. Therefore, we temporarily remove all\nrepeat nodes from the graph, noting their edges, and re-compute the graph without them. This\nusually simplifies the graph, introducing breaks in places where there are not enough data to\nresolve repeats. We then examine all nodes in the resulting graph, and if a node has two or\nmore incoming edges, we delete them both. We do the same if a node has two or more outgo-\ning edges. Thus, for example, if a node has two outgoing edges and a single incoming edge, we\nkeep the single incoming edge and delete the two outgoing edges. This breaks the graph into\nlinear paths. Finally, we re-insert all repeat nodes (contigs) that we temporarily removed into\nthe resulting linear paths according to their edges, duplicating the sequence if necessary. The\nfinal linear paths represent the scaffolded contigs. An example of the scaffolding process is\ndepicted in Fig 3. Finally, we collapse the linear paths, and fill positive-sized gaps with the link-\ning sequence obtained from the consensus of linking sequences in J.\nFollowing the scaffolding and gap filling steps, we extract all patch sequences that SAMBA\nused to fill gaps in the final scaffolds. We use minimap2 to align all contigs in C that are shorter\nFig 3. Overview of the SAMBA scaffolding algorithm . The method resolves the initial graph into three final contigs,\nC1-C2-B1-B 3-C3-C4 (S4), C5-R-C8 and C6-R-C7. The repeat contig R is duplicate d in the final output. Note that if\nthere were no proper edge between contigs C5 and C8, then the final output would contain C5 and C8 standalo ne\ninstead of C5-R-C8.\nhttps://d oi.org/10.1371/j ournal.pc bi.1009860. g003\nPLOS COMP UTATIONAL  BIOLOGY\nThe SAMBA tool uses long reads to improve the contiguity of genome assemblies\nPLOS Computationa l Biology | https:/ /doi.org/10.13 71/journal.p cbi.1009860 February 4, 2022 9 / 11\nthan the maximum patch size to the patches. We then look for contigs that are uniquely con-\ntained in a patch, aligning with more than 95% identity over more than 95% of their length.\nWe then replace the consensus of the patches by the consensus of the contigs based on the\nalignment coordinates, and remove the contigs that were merged from the final output. This\nimproves the accuracy of the patch sequences and ensures that we do not spuriously retain\nshort contigs that are duplicates of sequences that are now present in the patches.\nAvailability\nSAMBA is open-source software that is distributed with free open source MaSuRCA assembly\nand analysis package at https://github.com/alekseyzim in/masurca.\nFuture directions\nWe have shown here that SAMBA is a highly effective tool for improving the contiguity of\ngenome assemblies with additional long read data. The primary limitation of SAMBA is deter-\nmined by the contig lengths in the assembly being scaffolded. Since the default minimum over-\nlap for long reads is 5000 bp, any contigs that are shorter than this minimum will not be\nscaffolded by SAMBA. We recommend applying SAMBA to assemblies where most of the\nsequence is in contigs that are longer than 5000 bp, which is not difficult to achieve with mod-\nern sequencing technologies and assembly software.\nOur future plans for SAMBA development include detection and correction of contig mis-\nassemblies in the input assembly. We may be able to use discordant alignments, such as cases\nwhere long reads map to the interiors of two different contigs, to detect and break mis-assem-\nbled contigs. This may allow SAMBA to produce a re-scaffolded genome that is not only more\ncontiguous, but also more accurate than the original assembly.\nAuthor Contributions\nConceptualization: Aleksey V. Zimin, Steven L. Salzberg.\nData curation: Aleksey V. Zimin.\nFormal analysis: Aleksey V. Zimin.\nFunding acquisition: Aleksey V. Zimin, Steven L. Salzberg.\nInvestigation: Aleksey V. Zimin.\nMethodology: Aleksey V. Zimin.\nProject administration: Steven L. Salzberg.\nResources: Aleksey V. Zimin.\nSoftware: Aleksey V. Zimin.\nSupervision: Aleksey V. Zimin, Steven L. Salzberg.\nValidation: Aleksey V. Zimin, Steven L. Salzberg.\nVisualization: Aleksey V. Zimin.\nWriting – original draft: Aleksey V. Zimin, Steven L. Salzberg.\nWriting – review & editing: Aleksey V. Zimin, Steven L. Salzberg.\nPLOS COMP UTATIONAL  BIOLOGY\nThe SAMBA tool uses long reads to improve the contiguity of genome assemblies\nPLOS Computationa l Biology | https:/ /doi.org/10.13 71/journal.p cbi.1009860 February 4, 2022 10 / 11\nReferences\n1. Nurk S, Koren S, Rhie A, Rautiaine n M, Bzikadze A, et al. The complete sequence of a human genome.\nbioRxiv. 2021 Jan 1.\n2. Bashir A, Klammer , Robins WP, Chin CS, Webster D, Paxinos E, et al. A hybrid approac h for the auto-\nmated finishing of bacteria l genomes. Nature Biotechnology . 2012 Jul; 30(7):701– 7. https:// doi.org/10.\n1038/nbt .2288 PMID: 22750883\n3. Boetzer M, Pirovano W. SSPACE-L ongRead: scaffolding bacterial draft genomes using long read\nsequence informati on. BMC Bioinformatic s. 2014 Dec; 15(1):1–9. https:/ /doi.org/10.11 86/1471 -2105-\n15-211 PMID: 249509 23\n4. Warren RL, Yang C, Vandervalk BP, Behsaz B, Lagman A, Jones SJ, Birol I. LINKS: Scalabl e, align-\nment-fre e scaffolding of draft genomes with long reads. GigaScienc e. 2015 Dec 1; 4(1):s13742 –015.\nhttps://doi.or g/10.118 6/s13742 -015-0076-3 PMID: 26244089\n5. Qin M, Wu S, Li A, Zhao F, Feng H, Ding L, Ruan J. LRScaf : improving draft genomes using long noisy\nreads. BMC Genom ics. 2019 Dec; 20(1):1–2. https://doi.or g/10.118 6/s12864 -018-5379 -1 PMID:\n30606130\n6. Zimin AV, Marc ¸ ais G, Puiu D, Roberts M, Salzberg SL, Yorke JA. The MaSuRC A genome assemb ler.\nBioinformat ics. 2013 Nov 1; 29(21):266 9–77. https://doi.or g/10.109 3/bioinformat ics/btt476 PMID:\n23990416\n7. Zimin AV, Puiu D, Luo MC, Zhu T, Koren S, Marc ¸ ais G, et al. Hybrid assembly of the large and highly\nrepetitive genome of Aegilops tauschii, a progenitor of bread wheat, with the MaSuRCA mega-reads\nalgorithm. Genome Research. 2017 May 1; 27(5):787– 92. https://doi.or g/10.110 1/gr.213405.1 16\nPMID: 281303 60\n8. Di Genova A, Buena-Ati enza E, Ossows ki S, Sagot MF. Efficient hybrid de novo assembly of human\ngenomes with WENGAN. Nature Biotechnology . 2021 Apr; 39(4):422– 30. https://doi.o rg/10.1038/\ns41587-020 -00747-w PMID: 3331865 2\n9. Lee H, Gurtowski J, Yoo S, Marcus S, McComb ie WR, Schatz M. Error correctio n and assembly com-\nplexity of single molecule sequencin g reads. BioRxiv. 2014 Jan 1:00639 5.\n10. Berlin K, Koren S, Chin CS, Drake JP, Landolin JM, Phillippy AM. Assembling large genomes with sin-\ngle-molec ule sequencin g and locality-sen sitive hashing. Nature Biotechnology . 2015 Jun; 33(6):623.\nhttps://doi.or g/10.103 8/nbt.3238 PMID: 26006009\n11. Gurevich A, Savelie v V, Vyahhi N, Tesler G. QUAST : quality assessmen t tool for genome assemblies.\nBioinformat ics. 2013 Apr 15; 29(8):1072 –5. https://doi.or g/10.1093 /bioinformatic s/btt086 PMID:\n23422339\n12. Rhie A, Walenz BP, Koren S, Phillippy AM. Merqury: reference-fr ee quality, complete ness, and phasing\nassessmen t for genome assemblies . Genome Biology. 2020 Dec; 21(1):1–27 .\n13. Zimin AV, Salzberg SL. The genome polishing tool POLCA makes fast and accurate correctio ns in\ngenome assemblies. PLoS computat ional biology. 2020 Jun 26; 16(6):e100 7981. https://do i.org/10.\n1371/journa l.pcbi.100 7981 PMID: 325896 67\n14. Miga KH, Koren S, Rhie A, Vollger MR, Gershm an A, Bzikadze A, et al. Telomere -to-telom ere assembly\nof a complete human X chromosome. Nature. 2020 Sep; 585(7823) :79–84. https://doi.or g/10.103 8/\ns41586-020 -2547-7 PMID: 32663838\n15. Zimin AV, Shumate A, Shinder I, Heinz J, Puiu D, Pertea M, Salzberg SL. A reference -quality, fully\nannotate d genome from a Puerto Rican individual. Genetics. 2021, iyab227 , https://doi.or g/10.109 3/\ngenetics/iyab 227 PMID: 34897437\n16. Li H. Minimap2: pairwise alignment for nucleotid e sequences. Bioinform atics. 2018 Sep 15; 34\n(18):3094– 100. https:// doi.org/10.10 93/bioinform atics/bty191 PMID: 29750242\n17. Kolmogo rov M, Yuan J, Lin Y, Pevzner PA. Assem bly of long, error-prone reads using repeat graphs.\nNature Biotechnology . 2019 May; 37(5):540– 6. https://doi.o rg/10.1038/s4 1587-019-0 072-8 PMID:\n30936562\nPLOS COMP UTATIONAL  BIOLOGY\nThe SAMBA tool uses long reads to improve the contiguity of genome assemblies\nPLOS Computationa l Biology | https:/ /doi.org/10.13 71/journal.p cbi.1009860 February 4, 2022 11 / 11",
  "topic": "Contiguity",
  "concepts": [
    {
      "name": "Contiguity",
      "score": 0.76523357629776
    },
    {
      "name": "Computational biology",
      "score": 0.6148319840431213
    },
    {
      "name": "Genome",
      "score": 0.5268127918243408
    },
    {
      "name": "Biology",
      "score": 0.4447941482067108
    },
    {
      "name": "Computer science",
      "score": 0.44012871384620667
    },
    {
      "name": "Evolutionary biology",
      "score": 0.41940993070602417
    },
    {
      "name": "Genetics",
      "score": 0.3073844313621521
    },
    {
      "name": "Ecology",
      "score": 0.10043331980705261
    },
    {
      "name": "Gene",
      "score": 0.08958041667938232
    }
  ],
  "institutions": [
    {
      "id": "https://openalex.org/I145311948",
      "name": "Johns Hopkins University",
      "country": "US"
    }
  ]
}