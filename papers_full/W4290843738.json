{
    "title": "Remaining useful life prediction of lithium-ion batteries based on wavelet denoising and transformer neural network",
    "url": "https://openalex.org/W4290843738",
    "year": 2022,
    "authors": [
        {
            "id": "https://openalex.org/A2320192556",
            "name": "Wangyang Hu",
            "affiliations": [
                "Anqing Normal University"
            ]
        },
        {
            "id": "https://openalex.org/A3212794807",
            "name": "Shaishai Zhao",
            "affiliations": [
                "Anqing Normal University"
            ]
        },
        {
            "id": "https://openalex.org/A2320192556",
            "name": "Wangyang Hu",
            "affiliations": []
        },
        {
            "id": "https://openalex.org/A3212794807",
            "name": "Shaishai Zhao",
            "affiliations": []
        }
    ],
    "references": [
        "https://openalex.org/W2040861280",
        "https://openalex.org/W3212048882",
        "https://openalex.org/W2901287750",
        "https://openalex.org/W3175326495",
        "https://openalex.org/W2980373352",
        "https://openalex.org/W2789625876",
        "https://openalex.org/W2768606939",
        "https://openalex.org/W3029120371",
        "https://openalex.org/W4225016315",
        "https://openalex.org/W2921358399",
        "https://openalex.org/W3008712260",
        "https://openalex.org/W3214057009",
        "https://openalex.org/W2588506538",
        "https://openalex.org/W4229051391",
        "https://openalex.org/W2890439327",
        "https://openalex.org/W4213310304",
        "https://openalex.org/W4226144567",
        "https://openalex.org/W3197516882",
        "https://openalex.org/W2067682030",
        "https://openalex.org/W2795412675",
        "https://openalex.org/W2980011983",
        "https://openalex.org/W2094983775",
        "https://openalex.org/W2625850062",
        "https://openalex.org/W1694861895",
        "https://openalex.org/W4205303226",
        "https://openalex.org/W4220684523",
        "https://openalex.org/W2791632718",
        "https://openalex.org/W4224220755",
        "https://openalex.org/W4281674107"
    ],
    "abstract": "It is imperative to accurately predict the remaining useful life (RUL) of lithium-ion batteries to ensure the reliability and safety of related industries and facilities. In view of the noise sequence embedded in the measured aging data of lithium-ion batteries and the strong nonlinear characteristics of the aging process, this study proposes a method for predicting lithium-ion batteries’ RUL based on the wavelet threshold denoising and transformer model. To specify, firstly, the wavelet threshold denoising method is adopted to preprocess the measured discharging capacity data of lithium-ion batteries to eliminate some noise signals. Second, based on the denoised data, the transformer model output’s full connection layer is applied to replace the decoder layer for establishing the RUL prediction model of lithium-ion batteries. Finally, the discharging capacity of each charging–discharging cycle is predicted iteratively, and then the RUL of lithium-ion batteries can be calculated eventually. Two groups of lithium-ion batteries’ aging data from the Center for Advanced Life Cycle Engineering (CALCE) at the University of Maryland and the laboratory at Anqing Normal University (AQNU) are employed to verify the proposed method, individually. The experimental results demonstrate that this method can overcome the impacts of data measurement noise, effectively predict the RUL of lithium-ion batteries, and present a sound generalization ability and high accuracy.",
    "full_text": "Remaining useful life prediction\nof lithium-ion batteries based on\nwavelet denoising and\ntransformer neural network\nWangyang Hu* and Shaishai Zhao*\nSchool of Electronic Engineering and Intelligent Manufacturing, Anqing Normal University, Anqing,\nChina\nIt is imperative to accurately predict the remaining useful life (RUL) of lithium-\nion batteries to ensure the reliability and safety of related industries and facilities.\nIn view of the noise sequence embedded in the measured aging data of lithium-\nion batteries and the strong nonlinear characteristics of the aging process, this\nstudy proposes a method for predicting lithium-ion batteries’RUL based on the\nwavelet threshold denoising and transformer model. To specify,ﬁrstly, the\nwavelet threshold denoising method is adopted to preprocess the measured\ndischarging capacity data of lithium-ion batteries to eliminate some noise\nsignals. Second, based on the denoised data, the transformer model output’s\nfull connection layer is applied to replace the decoder layer for establishing the\nRUL prediction model of lithium-ion batteries. Finally, the discharging capacity\nof each charging– discharging cycle is predicted iteratively, and then the RUL of\nlithium-ion batteries can be calculated eventually. Two groups of lithium-ion\nbatteries’ aging data from the Center for Advanced Life Cycle Engineering\n(CALCE) at the University of Maryland and the laboratory at Anqing Normal\nUniversity (AQNU) are employed to verify the proposed method, individually.\nThe experimental results demonstrate that this method can overcome the\nimpacts of data measurement noise, effectively predict the RUL of lithium-ion\nbatteries, and present a sound generalization ability and high accuracy.\nKEYWORDS\nlithium-ion battery, remaining useful life, wavelet threshold denoising, transformer\nmodel, RUL prediction\n1 Introduction\nThanks to the advantages of high energy density, long storage life, high safety, and no\npollution, lithium-ion batteries are widely applied in theﬁeld of electric vehicles (Yuan\net al., 2015; Wang et al., 2021). However, with the use of electric vehicles starting,\nirreversible electrochemical reactions occur in the onboard lithium-ion batteries, which\nwill increase their internal resistance and decrease their maximum available capacity,\nleading to the attenuation of their remaining useful life (RUL) and a serious reduction of\nthe driving distances of electric vehicles (Guha and Patra., 2018; Ansari et al., 2022).\nBesides, it is well known that the discharging capacity of lithium-ion batteries is poor in a\nOPEN ACCESS\nEDITED BY\nXiao Wang,\nWuhan University, China\nREVIEWED BY\nJi Wu,\nHefei University of Technology, China\nBolun Du,\nChina Electric Power Research Institute\n(CEPRI), China\nJinping Wang,\nHefei University of Technology, China\n*CORRESPONDENCE\nWangyang Hu,\nhuwangyang2011@sina.com\nShaishai Zhao,\nzhaoshaishai@126.com\nSPECIALTY SECTION\nThis article was submitted to Smart\nGrids,\na section of the journal\nFrontiers in Energy Research\nRECEIVED 14 June 2022\nACCEPTED 01 July 2022\nPUBLISHED 12 August 2022\nCITATION\nHu W and Zhao S (2022), Remaining\nuseful life prediction of lithium-ion\nbatteries based on wavelet denoising\nand transformer neural network.\nFront. Energy Res.10:969168.\ndoi: 10.3389/fenrg.2022.969168\nCOPYRIGHT\n© 2022 Hu and Zhao. This is an open-\naccess article distributed under the\nterms of theCreative Commons\nAttribution License (CC BY). The use,\ndistribution or reproduction in other\nforums is permitted, provided the\noriginal author(s) and the copyright\nowner(s) are credited and that the\noriginal publication in this journal is\ncited, in accordance with accepted\nacademic practice. No use, distribution\nor reproduction is permitted which does\nnot comply with these terms.\nFrontiers inEnergy Research frontiersin.org01\nTYPE Methods\nPUBLISHED 12 August 2022\nDOI 10.3389/fenrg.2022.969168\nlow-temperature environment. Consequently, the accurate RUL\nis difﬁcult to be predicted (Zhang D. et al., 2022). If the lithium-\nion battery continues to work even after reaching its failure\nthreshold, it will attenuate drastically, which may result in serious\nsafety accidents (Liu et al., 2020). Therefore, accurate prediction\nof the battery RUL is of great signiﬁcance to guarantee the safe\nand reliable operation of electric vehicles (Murugan et al., 2022).\nRUL refers to the quantity of charging–discharging cycles\nrequired for the maximum available capacity of the power battery\nattenuating to the speciﬁed failure threshold (Zhao et al., 2022).\nThe RUL prediction is a process of forecasting and calculating the\nresidual power battery’s life based on its historical data through\ncertain mathematical approaches ( Dong et al., 2020 ). The\nexisting RUL prediction methods for lithium-ion batteries can\nmainly divide into model-driven and data-driven (Cadini et al.,\n2019; Song et al., 2022).\nThe model-driven method establishes a mathematically\nphysical model by analyzing the battery performance\ndegradation and failure mechanism for better predicting\nlithium-ion batteries RUL. The commonly-used lithium-ion\nbattery models mainly include the electrochemical model,\nequivalent circuit model, and empirical degradation model.\nThe electrochemical model primarily follows the internal\nchemical reaction mechanism of the lithium-ion battery to\nestablish the corresponding algebraic or differential equations\nfor forecasting the RUL. Its accuracy is high, but the model\nparameters are easily affected by temperature and other factors.\nConsequently, it is difﬁcult to identify the parameters and the\nmodeling procedure is really complex (Xiong et al., 2018). The\nequivalent circuit model adopts the traditional circuit elements\nlike resistance, capacitance, and a constant voltage source to\nconstitute a circuit network for describing the externality of the\npower battery (Guha and Patra, 2018). This model considers the\nbattery degradation mechanism, but its establishment depends\non impedance and other data difﬁcult to obtain in practice.\nFurthermore, the empirical degradation model is mainly based\non the exponential model of battery capacity and ﬁltering\nalgorithm to predict RUL (Zhang et al., 2018). Kalman ﬁlter\n(Xiong et al., 2012), sliding mode observer (Liu and Zhang.,\n2021), and particleﬁlter (Morstyn et al., 2017; Pugalenthi et al.,\n2018) have all been commonly-applied model methods, which\nhave achieved good research results. However, it has also been\nquite dif ﬁcult to establish an accurate and universal\nmathematically physical model to characterize the attenuation\nprocess of lithium-ion battery capacity due to the severe onboard\nworking conditions and the variability of the application\nenvironment.\nThe data-driven approach makes it possible to prognosticate\nthe RUL of lithium-ion batteries by analyzing past data, mining\nintrinsic principles governing capacity decline, and utilizing\nmathematical algorithms to analyze, expand, and promote\ndata. This method is simple and does not need to consider\nthe complex mechanism of the power battery. It is suitable for\nthe real vehicle operating environment. Common data-driven\nmethods include the artiﬁcial neural network (ANN), (Ansari\net al., 2021), support vector regression (SVR) (Xue et al., 2020),\nrelevance vector regression (RVR) ( Chen et al., 2021 ), and\ngaussian process regression (GPR) ( Li et al., 2019 ). The\ntransformer model, a deep learning neural network, has\nsucceeded in the ﬁeld of natural language processing and has\nsteadily moved to theﬁeld of time-series prediction owing to its\nunique structure, long-distance modeling capability, and\noutstanding parallel computing capacity ( Tian et al., 2022 ;\nVallés-Pérez et al., 2022).\nConsidering the capacity regeneration phenomenon in the\ndegradation process of lithium-ion batteries and the noise signal\ngenerated by load random interference in the measurement, data\npreprocessing technology is also widely used to improve the\naccuracy of RUL prediction, including empirical mode\ndecomposition (EMD) (Zhang et al., 2017), variational modal\ndecomposition (VMD) (Zhang et al., 2021), variationalﬁltering\n(VF) (Jiao et al., 2020), and particle ﬁlter (PF) (Ahwiadi and\nWang, 2019), etc. The method employed in this study, based on\nwavelet threshold denoising (WTD) (Zhang et al., 2015), cannot\nonly effectivelyﬁlter the noise but also maximize the noise and\nguarantee that the effective signal is not lost. The combination of\na data-driven method and data preprocessing technology can\nfurther realize RUL’s accurate prediction (Huang et al., 2022).\nBased on the above analyses, the key factors affecting the\naccuracy of RUL prediction are data preprocessing and its\nmodeling methods. In this study, the discharging capacity is\nselected as the health indicator and a prediction method is\nproposed. The main contributions are summarized as follows:\nThe wavelet threshold denoising data preprocessing\ntechnology is utilized to eliminate the capacity data noise\nsignals, which not only smooths the capacity data but also\nretains the original characteristics of the capacity data and\navoids the inﬂuence of noise components.\nWith the long-distance modeling ability and the feature\nrepresentation technique of the series data of the transformer\nmodel, the decoder part of the original model is replaced by the\noutput’s full connection layer, and the RUL prediction\nframework of the improved transformer model is established\nto output the predicted values. The experimental results show\nthat the wavelet denoising and transformer model can be\neffectively applied to the RUL prediction of the lithium-ion\nbattery.\nTwo groups of battery capacity data from the Center for\nAdvanced Life Cycle Engineering (CALCE) at the University of\nMaryland and the laboratory at the Anqing Normal University\n(AQNU) are applied to separately verify the RUL prediction\nmethod proposed in this study. The results exhibit that the\nperformance of this method is superior to the existing\nprediction methods.\nThe rest is summarized below.Section 2introduces the basic\nprinciples of wavelet threshold denoising and the transformer\nFrontiers inEnergy Research frontiersin.org02\nHu and Zhao 10.3389/fenrg.2022.969168\nmodel. Section 3 speciﬁes the proposed RUL prediction\nexperiment scheme for lithium-ion batteries, including data\npreprocessing technique, experimental procedures, and\nevaluation criteria. Section 4 elaborates on the experimental\nresults and compared experiment analyses.Section 5 describes\nthe concluding observations.\n2 Theoretical basis for remaining\nuseful life prediction\n2.1 Wavelet threshold denoising\nWavelet analysis is based on the characteristic that the\noriginal signal is generally concentrated in the low-frequency\nregion. First, a wavelet transform is performed on the high-\nfrequency noisy signal x(t) to obtain a group of wavelet\ndecomposition coefﬁcients W\nj,k and then a threshold valueλ\nis set for the wavelet coefﬁcients according to the characteristics\nof the transformed signal. This threshold is the dividing line to\nprocess high-frequency wavelet coef ﬁcients. For those with\namplitudes lower than this threshold, they will be removed\ndirectly; for those with amplitudes greater than the threshold,\nthey will be retained. After the wavelet decomposition\ncoefﬁcients are processed by the threshold, the wavelet\nestimation coefﬁcient\nWj,k is obtained to limit ∥Wj,k − Wj,k∥\nto the minimum. Finally, the estimated wavelet coefﬁcient Wj,k is\nused for wavelet reconstruction to acquire the estimation signal\nWj,k as the denoised signal. The principle of this wavelet\nthreshold denoising is shown inFigure 1.\nIn the process of wavelet threshold denoising, the commonly-\nused threshold functions mainly include the hard threshold\nfunction, soft threshold function, and semi-soft threshold\nfunction. Their formulas are as follows:\nThe expression of the hard threshold function is:\nWj,k /equals { Wj,k,\n⏐⏐\n⏐\n⏐W\nj,k\n⏐⏐\n⏐\n⏐≥ λ\n0,\n⏐⏐⏐\n⏐W\nj,k\n⏐⏐⏐\n⏐< λ (1)\nThe expression of the soft threshold function is:Wj,k /equals { sgn(Wj,k)(\n⏐⏐\n⏐\n⏐W\nj,k\n⏐⏐\n⏐\n⏐− λ),\n⏐⏐\n⏐\n⏐W\nj,k\n⏐⏐\n⏐\n⏐≥ λ\n0,\n⏐⏐\n⏐\n⏐W\nj,k\n⏐⏐\n⏐\n⏐< λ (2)\nThe expression of the semi-soft threshold function is:\nWj,k /equals\n⎧⎪⎪\n⎨\n⎪⎪\n⎩\nsgn(W\nj,k)\n⏐⏐\n⏐\n⏐W\nj,k\n⏐⏐\n⏐\n⏐− λ +\n2λ\n1 + e2Wj,k/λ\n,\n⏐⏐\n⏐\n⏐W\nj,k\n⏐⏐\n⏐\n⏐≥ λ\n0,\n⏐⏐\n⏐\n⏐W\nj,k\n⏐⏐\n⏐\n⏐< λ\n(3)\nwhere W\nj,k represents the wavelet estimation coefﬁcient; Wj,k is\nthe wavelet decomposition coefﬁcient; sgn() indicates the symbol\nfunction, and λ refers to the threshold value.\nWavelet threshold estimation is the optimal threshold\nobtained under the limitation of minimum and maximum\nestimation for the joint distribution of multidimensional\nindependent normal variables. The selection formula of this\nthreshold value is:\nλ\nj /equals σ\n/radicaltpext/radicaltpext/radicaltpext/radicaltpext/radicaltpext/radicaltpext/radicaltpext/radicaltpext\n2 log(N)\n√\n(4)\nwhere λj is the threshold under the scalej; σ refers to the noise’s\nstandard variance, and N represents the signal length. The\nwavelet denoising method can effectively eliminate or weaken\nthe noise signal in the lithium-ion battery capacity’s measured\ndata and restore the raw data.\n2.2 Time-series transformer\nThe transformer model relies on the attention mechanism to\ndraw the global dependency between input and output. Like most\nneural series transformation models, it has an encoder-decoder\nstructure. The encoder maps the input time-series X /equals\n(X1,X 2, /,X n) represented by the capacity data to the\ncontinuous representation series Z /equals( Z1,Z 2, /,Z n). Under\nthe condition ofﬁxed Z, the decoder generates output time-series\nY /equals( Y1,Y 2, /,Y n) from one element at a time. In each step of\ntime-series prediction, the model is automatically regressed, and\nwhen generating the output series at then + 1 time, the output\nseries generated at the lastn time will be used as an additional\ninput. The transformer time-series model’s architecture is shown\nin Figure 2.\nThe encoder part selects the original capacity data as the\ninput, while the decoder part replaces the decoder with the full\nFIGURE 1\nSchematic diagram of wavelet threshold denoising.\nFrontiers inEnergy Research frontiersin.org03\nHu and Zhao 10.3389/fenrg.2022.969168\nconnection layer to predict the unknown capacity data value by\nthe auto-regressive method (Jin et al., 2022). The decoder uses the\nattention mechanism to connect with the encoder, and“pays\nattention” to the most useful part of the input capacity data value\nbefore prediction, in which the padding mask part will be input\nfor the mask to avoid gaining future values during training.\nIn the time-series prediction task, the transformer actually\nadopts the calculation method of scaled dot product attention,\nwhich is also an attention mechanism that links the different\npositions of a single series to calculate the representation of the\nseries. Its general calculation process is shown inFigure 3.\nAccording to the three variables of query, key, and value\ngained from the linear mapping of the input series, the attention\nfunction is employed to calculate the Q matrix and K matrix for\nachieving the attention weight matrix. Based on this, the\nsimilarity between Q and K is also calculated to obtain the\noutput matrix A. The calculation process is as follows:\nA /equals softmax(QK\nT/\n/radicaltpext/radicaltpext\ndh\n√\n),A ∈ Rd×3dh (5)\nIn the time-series, query, key, value, and output are all\nvectors. Furthermore, calcul ate the Value according to A and\nobtain the weighted sum. The calculation process is as\nfollows:\nSA(z) /equals AV (6)\nIn order to improve the diversity of features, a multi-head\nattention layer is employed to calculate multiple self-attention\nheads in parallel. Eventually, theﬁnal results are obtained by\nsplicing the outputs of all attention heads (Zhang Q. et al.,\n2022).\nPositional encoding is adopted to prevent the loss of position\ninformation in the series of input batch capacity data. Its\nprinciple is to add sine and cosine data of different\nfrequencies to the input series as position codes so that the\nFIGURE 2\nTransformer time-series model’s architecture.\nFrontiers inEnergy Research frontiersin.org04\nHu and Zhao 10.3389/fenrg.2022.969168\nmodel can capture the relative position relationship of input\nvariables. The calculation process is expressed inEqs 7 and 8.\nPE(pos,2i) /equals sin(pos/100002i/d) (7)\nPE(pos,2i+1) /equals cos(pos/100002i/d) (8)\nwhere pos is the position of each capacity value in the whole\nseries; i ∈ [0, /,d /2] is used to calculate the index of the\nchannel dimension. For the same i, the coding of the 2i + 1\nand the 2i + 1 positions on the channel is the sine and cosine\nvalues with the same angular velocity to ensure that the position-\ncoding can be added to the input embedding.\n3 Remaining useful life prediction’s\nexperiment scheme\n3.1 Experimental data\nTwo kinds of lithium-ion battery datasets with different\nelectrode materials and discharge environments are used to\nverify the performance of the proposed algorithm.\nThe ﬁrst group of the battery degradation data is obtained\nfrom the University of Maryland’s CALCE company. The battery\naging test was realized by using the ArbinBT2000 battery test\nsystem. In the test, the LiCoO2 battery named CX2-37 accepted\nFIGURE 3\nGeneral calculation process of attention mechanism.\nFIGURE 4\nExperimental equipment.TABLE 1 Speciﬁcations of AQ-01 battery.\nCathode LiFePO 4\nAnode Graphite\nRated capacity 2.4 Ah\nNormal voltage 3.6 V\nAllowed voltage range 3 –4.2 V\nEnd-of-charge current 48 mA\nMax charge/discharge current 2400 mA/7200 mA\nFrontiers inEnergy Research frontiersin.org05\nHu and Zhao 10.3389/fenrg.2022.969168\nthe standard constant current/voltage protocol, charged at 0.5C\nconstant current (C is the measurement of the\ncharging–discharging current to the nominal capacity) until\nthe terminal voltage reached 4.2 V, then charged at the\nconstant voltage of 4.2 V until the charging current dropped\nbelow 0.05 A. Discharging was operated at a 1C constant current\nuntil the battery terminal voltage of CX2-37 dropped to 2.7 V.\nThe second set of lithium-ion battery aging data was\nmeasured in the laboratory of AQNU university based on the\nhigh-performance battery test system ( Zhang et al., 2021 ).\nExperimental equipment is shown inFigure 4. For simplicity,\nthis lithium-ion battery capacity data is named AQ-01 in this\nstudy. Table 1 presents the summary of its speciﬁcations.\nThe validity of the proposed prediction method is veriﬁed by\nusing two groups of battery degradation data of CX2-37 and AQ-01.\nAccording to the international standard, the lithium-ion battery\nperformance test stipulates that it shall be kept in a normal working\nstate at a normal temperature (25 ± 2)\n°C. When the actual capacity\nof the battery drops below 70–80% of the rated capacity, the lithium-\nion battery is considered to be invalid. In order to ensure the safety\nand reliability of the system operation, the EOL threshold of all the\nused batteries is both set to about 70% of the rated capacity when the\nexperiments will be terminated. Therefore, the rated capacity of\nbattery CX2-37 is 1.33 Ah, and the EOL threshold conﬁguration is\n0.93 Ah. The rated capacity of AQ-01 battery is 2.4 Ah, and the EOL\nthreshold is set to 1.68 Ah. The measured capacity data of CX2-37\nand AQ-01 batteries are listed inFigure 5.\n3.2 Experimental procedure\nIn order to better reﬂect the generalization of the proposed\nmethod. Experimental veriﬁcation of transformer method is\nmade with the selected two groups of the lithium-ion battery\nFIGURE 5\nMeasured capacity data of CX2-37 and AQ-01.\nFrontiers inEnergy Research frontiersin.org06\nHu and Zhao 10.3389/fenrg.2022.969168\ncapacity data from CALCE and AQNU laboratory. The\nframework of the RUL prediction method proposed in this\nstudy is shown inFigure 6.\nMore speciﬁcally, there are ﬁve steps to realize the goal\nprediction.\nStep 1: Select the discharging capacity as the health indicator\nreﬂecting the degradation trend of RUL, remove the noise\nsignal of the raw data by wavelet threshold denoising\nmethod, and obtain the capacity series with a relatively\nstable degradation trend.\nStep 2: Standardize the capacity data after denoising and\nsmoothing.\nStep 3: Divide theﬁrst 50% of the battery capacity data equally as\nthe training set and the last 50% as the testing set. Build\nthe transformer model in Pytorch and train the capacity\nseries data to obtain the RUL prediction model.\nStep 4: Use the transformer model to establish the mapping\nrelationship between the early and late stages of the\ncapacity, iteratively predicts the unknown discharging\ncapacity of each charging –discharging cycle, then\ncalculate the RUL of the lithium-ion battery.\nStep 5: Apply different evaluation indexes to evaluate the\nprediction results.\n3.3 Model evaluation indexes\nThe lithium-ion battery RUL is deﬁned as the number of\nremaining useful cycles from the beginning of prediction to the\nend of battery life. When the actual capacity of the battery\ndegrades to the failure threshold, the battery life is considered\nto be over. The RUL calculation formula of the battery is as\nfollows:\nTrul /equals Teol − Tcur (9)\nThe calculation formula of the battery’s RUL prediction value\ncan be expressed inEq. 10.\nT\n⌢\nrul /equals T\n⌢\neol − T\n⌢\ncur (10)\nAbsolute error (AE), mean absolute error (MAE), and root\nmean square error (RMSE) are adopted as the evaluation criteria\nof the prediction model. Their calculation formulas are as\nfollows:\nAE /equals\n⏐⏐\n⏐\n⏐\n⏐\n⏐\n⏐T\nrul − T\n⌢\nrul\n⏐⏐\n⏐\n⏐\n⏐\n⏐\n⏐ (11)\nMAE /equals\n1\nn ∑\nn\ni/equals 1\n⏐⏐\n⏐\n⏐\n⏐x(i) − x\n⌢\n(i)\n⏐⏐\n⏐\n⏐\n⏐ (12)\nRMSE /equals\n/radicaltpext/radicaltpext/radicaltpext/radicaltpext/radicaltpext/radicaltpext/radicaltpext/radicaltpext/radicaltpext/radicaltpext/radicaltpext/radicaltpext/radicaltpext/radicaltpext/radicaltpext\n1\nn ∑\nn\ni/equals 1\n[x(i) − x\n⌢\n(i)]\n2\n√\n(13)\nwhere Trul is the number of remaining useful cycles at the end of\nthe actual battery life;Tcur represents the cycle’s starting position,\nwhile Teol is the number of cycles at the end of the battery life in\nthe actual state;T\n⌢\nrul indicates the number of remaining useful\ncycles at the end of the battery life in the predicted case;T\n⌢\neol refers\nto the number of cycles at the end of the battery life in the\npredicted case;x(i) is the real value of capacity, andx\n⌢\n(i) stands\nfor the predicted capacity.\nFIGURE 6\nRUL prediction method’s framework.\nFrontiers inEnergy Research frontiersin.org07\nHu and Zhao 10.3389/fenrg.2022.969168\nIt should be noticed that RMSE is the most comprehensive\nevaluation index, which can measure the ﬁtness between the\nprediction curve and the actual degradation trend. The closer\nRMSE is to 0, the better the prediction effect.\n4 Experimental results and\ndiscussions\n4.1 Denoising results\nDue to an irreversible chemical reaction, the discharging\ncapacity of the lithium-ion battery will show a detailed\ndownward trend owing to the repeated charging and\ndischarging. The capacity data measurement process is\naffected by electromagnetic inte rference, instrument error,\nand changes in the external environment. The nonlinear\ncapacity data is mixed with noise signals, and the capacity\nregeneration phenomenon makes the degradation track rise\nrapidly, brie ﬂy, and irregularly in an uncertain\nperiod, which adds dif ﬁculty to the training process of the\nmodel.\nIn order to remove the irregular ﬂuctuations in the\ncapacity curve and retain the original characteristics of the\ndata, it helps the model achieve better learning results in the\ntraining stage. The raw data of battery capacity of CX2-37 and\nAQ-01 are smoothed by the wavelet threshold denoising\nmethod, and the large and small noise signals are\neliminated. The effect of processed battery capacity data is\nshown in Figure 7.\nFIGURE 7\nCapacity data of CX2-37 and AQ-01 batteries processed by wavelet threshold denoising.\nFrontiers inEnergy Research frontiersin.org08\nHu and Zhao 10.3389/fenrg.2022.969168\n4.2 Prediction results\nAE, MAE, and RMSE methods are individually adopted to\nevaluate the accuracy of the capacity data predicted by the RUL of\nlithium-ion batteries. Experiments are carried out through two\ngroups of battery degradation data of CX2-37 and AQ-01. Both\ngroups of capacity data set 50% of the series length as the\nprediction starting point, and the established transformer\nneural network model is employed to conduct the capacity\nprediction experiment. The prediction results are shown in\nFigure 8 and Table 2 gives the statistical errors of the above\nexperimental results.\nThe prediction results of both CX2-37 and AQ-01 batteries\nboth illustrate that the degrad ation trend can be accurately\ncaptured according to the mapping relationship between cycle\nand actual capacity, but the prediction results gradually deviate\nfrom the actual degradation curve with the increase of cycle\ntimes. From the capacity degradation trend line shown in\nFigure 8 and the data analysis in Table 2 ,t h eR U L\nprediction accuracy of CX2-37 battery based on the\nFIGURE 8\nTransformer model’s capacity prediction results.\nTABLE 2 Statistical errors of the transformer algorithm.\nBattery Actual RUL Predicted RUL AE MAE (%) RMSE (%)\nCX2-37 493 494 1 1.81 2.19\nAQ-01 556 555 1 1.81 2.39\nFrontiers inEnergy Research frontiersin.org09\nHu and Zhao 10.3389/fenrg.2022.969168\ntransformer model is 494, and 1 cycle later than the true RUL,\nwhich MAE is 1.81% and RMSE is 2.19%. The RUL prediction\naccuracy of AQ-01 battery is 556, and 1 cycle earlier than the\ntrue RUL, in which MAE is 1.81% and RMSE is 2.39%. It\ndemonstrates that this method has an accurate RUL prediction\neffect. It also shows the degradation trend prediction curve of\nAQ-01 battery is closer to the original curve than that of CX2-\n37 battery. A possible reason is transformer model mines the\ncorrelation from the global relationship and the accuracy highly\ndepends on data, which needs a lot of training to build a better\nRUL prediction model. It reﬂects that AQ-01 battery has the\nbest prediction results due to its long sequence length of data\nand better training effect.\n4.3 Compared experiment\nTo further verify the reliability of the wavelet threshold\ndenoising and transformer model RUL prediction methods\nproposed in this study, the relevance vector machine (RVM),\nsupport vector regression (SVR), and particleﬁlter (PF) methods\nare separately adopted to compare and analyze with the\ntransformer model prediction method, for proving the\ntransformer model’s accuracy and superiority in predicting the\nRUL. The capacity prediction results of CX2-37 and AQ-01\nbatteries based on the transformer, RVM, SVR, and PF\nmethods are shown in Figure 9 , while Table 3 gives the\nstatistical errors of the above experimental results.\nFIGURE 9\nCompared experiment results between different prediction methods for CX2-37 and AQ-01 batteries.\nFrontiers inEnergy Research frontiersin.org10\nHu and Zhao 10.3389/fenrg.2022.969168\nAccording to the capacity degradation trend line inFigure 9\nand the errors inTable 3, this prediction method is proven to\noffer a better prediction accuracy. The prediction errors of CX2-\n37 battery based on the transformer, RVM, SVR, and PF methods\nare 1, 13, 18, and 36, respectively. The prediction errors of AQ-01\nbattery based on the transformer, RVM, SVR, and PF are 1, 22,\n20, and 15, respectively. Among them, the prediction results of\nCX2-37 battery seriously deviate from the cycle range of the real\nthreshold based on the PF method, but the prediction effect on\nAQ-01 battery is signiﬁcantly better than those of the compared\nmethods, as the effects of both MAE and RMSE are less\nthan 2.4%.\nBy comparing with traditional RVM, SVR, and PF\nalgorithms, it is found that the transformer neural\nnetwork achieves the best prediction effect owing to the\nsuperior long-series data processing ability. According to\nFigure 9 , it can also be seen that the degradation trend\nprediction curve of AQ-01 battery based on the PF\nmethod is close to the original curve, but the CX2-37\nbattery comparison prediction curve obviously deviates\nf r o mt h eo r i g i n a la g i n gc u r v eu n d e rt h es a m ec o n d i t i o n .\nThis is the reason for the low accuracy of feature recognition.\nThe transformer model has the advantage of constructing a\nglobal information interaction mechanism, which helps to\nestablish a more sufﬁcient feature display. At the same time,\nthe modal data can be fused efﬁciently. Therefore, a better\nﬁtting trend is reﬂected in the two groups of experimental\ndata and reﬂects that the transformer prediction method has\na better generalization ability. However, the global attention\nmechanism also brings a large amount of computation,\nespecially in intensive prediction tasks with facing long\nseries of inputs. In addition, the training process of the\ntransformer model is unstable and sensitive to parameters.\nTherefore, the wavelet threshold denoising method is used to\nsmooth the original data, so as to better predict the future\ncapacity of lithium-ion batteries and improve the prediction\naccuracy.\n5 Conclusion\nIn this study, an RUL prediction method for lithium-ion\nbatteries based on wavelet threshold denoising and\ntransformer model has been proposed. First, the\ndischarging capacity has been selected as the health\nindicator, and the wavelet threshold denoising method has\nbeen adopted to eliminate th e noise signal caused by the\nactual measurement and instrument errors in the raw data.\nSecond, the pre-processed d ata have been equally divided\ninto the training set and testing set. Based on the training set,\nthe transformer neural network has been used to establish\nthe RUL prediction model of the lithium-ion battery.\nMoreover, two groups of experimental data from CALCE\nand AQNU laboratories have been chosen to verify the\nreliability of the proposed method. The conclusions are\nsummarized as follows:\nThe onboard battery is affected by various uncertain factors\nduring the working process, which causes the gathered data to\ncontain noises andﬂuctuations. Directly using the raw data to\npredict the signal affects the prediction accuracy of this model.\nConsequently, the necessary data preprocessing method has been\nutilized to improve the prediction accuracy of this prediction\nmodel in this study.\nOwing to the long-distance modeling ability and the feature\nrepresentation ability of the series data in the transformer model,\nan RUL prediction framework based on the transformer neural\nnetwork has been established, while a new RUL prediction\nmethod for lithium-ion batteries has been proposed and good\nprediction results have been achieved.\nTwo groups of battery capacity data from CALCE and\nAQNU laboratories have been employed to verify the RUL\nprediction method. The experimental results have shown\nthat the prediction effect of the proposed method is superior\nto those of some existing calculation ones, among which the\neffects of MAE and RMSE are kept within 1.81 and 2.39%,\nrespectively.\nTABLE 3 Statistical errors of the comparison experiment.\nBattery Algorithm Actual RUL Predicted RUL AE MAE (%) RMSE (%)\nCX2-37 Transformer 493 494 1 1.81 2.19\nRVM 493 506 13 0.92 1.19\nSVM 493 511 18 1.09 1.40\nPF 493 457 36 1.46 1.74\nAQ-01 Transformer 556 555 1 1.81 2.39\nRVM 556 578 22 4.33 5.24\nSVM 556 576 20 1.86 2.35\nPF 556 541 15 2.67 3.11\nFrontiers inEnergy Research frontiersin.org11\nHu and Zhao 10.3389/fenrg.2022.969168\nTo conclude, the RUL prediction method for lithium-ion\nbatteries consists of the data preprocessing by wavelet threshold\ndenoising and the transformer model with a high prediction\naccuracy, reducing the prediction error and providing a new idea\nfor the existing RUL prediction research of lithium-ion batteries.\nThis method could also be applied to the prediction of other\nsimilar issues.\nData availability statement\nThe datasets presented in this study can be found in online\nrepositories. The names of the repository/repositories and\naccession number(s) can be found in the article/\nsupplementary material.\nAuthor contributions\nWH: methodology, software, validation, investigation,\nwriting— original draft preparation, visualization. SZ:\nmethodology, data curation, validation, writing — reviewing,\nand editing.\nFunding\nThis study was supported by The Natural Science Research Key\nProject of Education Department of Anhui Province Grant No.\nKJ2020A0509, Anhui Provincial Natural Science Foundation Grant\nNo. 2008085MF197, Graduate Academic Innovation Project of\nAnqing Normal University Grant No. 2021yjsXSCX009.\nConﬂict of interest\nThe authors declare that the research was conducted in the\nabsence of any commercial orﬁnancial relationships that could\nbe construed as a potential conﬂict of interest.\nPublisher’s note\nAll claims expressed in this article are solely those of the authors\nand do not necessarily represent those of their afﬁliated organizations,\nor those of the publisher, the editors, and the reviewers. Any product\nthat may be evaluated in this article, or claim that may be made by its\nmanufacturer, is not guaranteed or endorsed by the publisher.\nReferences\nAhwiadi, M., and Wang, W. (2019). An enhanced mutated particle ﬁlter\ntechnique for system state estimation and battery life prediction. IEEE Trans.\nInstrum. Meas. 68 (3), 923–935. doi:10.1109/TIM.2018.2853900\nAnsari, S., Ayob, A., Hossain, L., Hussain, A., and Saad, M. H. M. (2021). Multi-\nchannel proﬁle based artiﬁcial neural network approach for remaining useful life\nprediction of electric vehicle lithium-ion batteries.Energies 14 (22), 7521. doi:10.\n3390/EN14227521\nAnsari, S., Ayob, A., Hossain, L., Hussain, A., and Saad, M. H. M. (2022). Multi-\nchannel proﬁle based artiﬁcial neural network approach for remaining useful life\nprediction of electric vehicle lithium-ion batteries.Energies 14 (22), 7521. doi:10.\n3390/EN14227521\nCadini, F., Sbarufatti, C., Cancelliere, F., and Giglio, M. (2019). State-of-life\nprognosis and diagnosis of lithium-ion batteries by data-driven particleﬁlters. Appl.\nEnergy 235, 661–672. doi:10.1016/j.apenergy.2018.10.095\nChen, Z., Shi, N., Ji, Y., Niu, M., and Wang, Y. (2021). Lithium-ion batteries\nremaining useful life prediction based on BLS-RVM.Energy 234, 121269. doi:10.\n1016/J.ENERGY.2021.121269\nDong, G., Yang, F., Wei, Z., Wei, J., and Tsui, K.-L. (2020). Data-driven battery\nhealth prognosis using adaptive brownian motion model.IEEE Trans. Ind. Inf.16\n(7), 4736–4746. doi:10.1109/TII.2019.2948018\nG u h a ,A . ,a n dP a t r a ,A .( 2 0 1 8 ) .O n l i n ee s t i m a t i o no ft h e\nelectrochemical impedance spectrum and remaining useful life of lithium-\nion batteries. IEEE Trans. Instrum. Meas.67 (8), 1836–1849. doi:10.1109/TIM.\n2018.2809138\nGuha, A., and Patra, A. (2018). State of health estimation of lithium-ion batteries\nusing capacity fade and internal resistance growth models. IEEE Trans.\nTransp. Electriﬁc. 4 (1), 135–146. doi:10.1109/TTE.2017.2776558\nHuang, K., Ding, H., and Guo, Y. (2022). Prediction of remaining useful life of\nlithium-ion battery based on adaptive data preprocessing and long short-term\nmemory networkr.Trans. China Electrotech. Soc.37 (7), 57–70. doi:10.19595/j.cnki.\n1000-6753.tces.210860\nJiao, R., Peng, K., and Dong, J. (2020). Remaining useful life prediction of\nlithium-ion batteries based on condition al variational autoencoders-particle\nﬁlter. IEEE Trans. Instrum. Meas. 99, 8831 –8843. doi:10.1109/tim.2020.\n2996004\nJin, Y., Hou, L., and Chen, Y. (2022). A time series transformer based method for\nthe rotating machinery fault diagnosis.Neurocomputing 494, 379–395. doi:10.1016/\nJ.NEUCOM.2022.04.111\nLi, X., Wang, Z., and Yan, J. (2019). Prognostic health condition for\nlithium battery using the partial i ncremental capacity and Gaussian\nprocess regression. J. Power Sources 421, 56 –67. doi:10.1016/j.jpowsour.\n2019.03.008\nLiu, H., Chen, F., Tong, Y., Wang, Z., Yu, X., Huang, R., et al. (2020). Impacts of\ndriving conditions on EV battery pack life cycle.World Electr. Veh. J.11, 17. doi:10.\n3390/wevj11010017\nLiu, R., and Zhang, C. (2021). An active balancing method based on SOC and\ncapacitance for lithium-ion batteries in electric vehicles. Front. Energy Res. 9,\n773838. doi:10.3389/fenrg.2021.773838\nMorstyn, T., Savkin, A. V., Hredzak, B., and Agelidis, V. G. (2017). Multi-agent\nsliding mode control for state of charge balancing between battery energy storage\nsystems distributed in a DC microgrid.IEEE Trans. Smart Grid9 (5), 4735–4743.\ndoi:10.1109/TSG.2017.2668767\nMurugan, M., Saravanan, A., Elumalai, P. V., Murali, G., Dhineshbabu, N.,\nKumar, P., et al. (2022). Thermal management system of lithium-ion battery packs\nfor electric vehicles: An insight based on bibliometric study.J. Energy Storage52,\n104723. doi:10.1016/j.est.2022.104723\nPugalenthi, K., and Raghavan, N. (2018). A holistic comparison of the different\nresampling algorithms for particleﬁlter based prognosis using lithium-ion batteries\nas a case study. Microelectron. Reliab. 91, 160–169. doi:10.1016/j.microrel.2018.\n08.007\nSong, T., Liu, C., Wu, R., Jin, Y., and Jiang, D. (2022). A hierarchical scheme for\nremaining useful life prediction with long short-term memory networks.\nNeurocomputing 487, 22–33. doi:10.1016/j.neucom.2022.02.032\nTian, Y., Wang, Y., Wang, J., Wang, X., and Wang, F. (2022). Key problems and\nprogress of vision transformers: The state of the art and prospects.Acta Autom. Sin.\n48 (4), 957–979. doi:10.16383/j.aas.c220027\nVallés-Pérez, I., Soria-Olivas, E., Martínez-Sober, M., Serrano-Lopez, A. J.,\nGomez-Sanchis, J., and Mateo, F. (2022). Approaching sales forecasting using\nrecurrent neural networks and transformers.Expert Syst. Appl.201, 116993. doi:10.\n1016/J.ESWA.2022.116993\nFrontiers inEnergy Research frontiersin.org12\nHu and Zhao 10.3389/fenrg.2022.969168\nWang, S., Jin, S., Deng, D., and Fernandez, C. (2021). A critical review of online\nbattery remaining useful lifetime prediction methods.Front. Mech. Eng.7 (1), 1–19.\ndoi:10.3389/fmech.2021.719718\nXiong, R., He, H., Sun, F., and Zhao, K. (2012).Evaluation on state of charge estimation of\nbatteries with adaptive extended kalmanﬁlter by experiment approach.IEEE Trans. Veh.\nTechnol.62 (1), 108–117. doi:10.1109/TVT.2012.2222684\nX i o n g ,R . ,L i ,L . ,L i ,Z . ,Y u ,Q . ,a n dM u ,H .(2018). An electrochemical model based\ndegradation state identiﬁcation method of lithium-ion battery for all-climate electric\nvehicles application.Appl. Energy219, 264–275. doi:10.1016/j.apenergy.2018.03.053\nXue, Z., Zhang, Y., Cheng, C., and Ma, G. (2020). Remaining useful life prediction\nof lithium-ion batteries with adaptive unscented kalman ﬁlter and optimized\nsupport vector regression. Neurocomputing 376, 95–102. doi:10.1016/j.neucom.\n2019.09.074\nYuan, X., Liu, X., and Zuo, J. (2015). The development of new energy vehicles for a\nsustainable future: A review.Renew. Sustain. Energy Rev.42, 298–305. doi:10.1016/j.\nrser.2014.10.016\nZhang, C., He, Y., Yuan, L., and Xiang, S. (2017). Capacity prognostics of lithium-\nion batteries using EMD denoising and multiple kernel RVM. IEEE Access 5,\n12061–12070. doi:10.1109/access.2017.2716353\nZhang, C., He, Y., Yuan, L., Xiang, S., and Wang, J. (2015). Prognostics of lithium-\nion batteries based on wavelet denoising and DE-RVM.Comput. Intell. Neurosci.14,\n1–8. doi:10.1155/2015/918305\nZhang, C., Zhao, S., and He, Y. (2021). An integrated method of the future\ncapacity and RUL prediction for lithium-ion battery pack. IEEE Trans. Veh.\nTechnol. 71 (3), 2601–2613. doi:10.1109/TVT.2021.3138959\nZhang, D., Tan, C., Ou, T., Zhang, S., Li, L., and Ji, X. (2022a). Constructing\nadvanced electrode materials for low-temperature lithium-ion batteries: A review.\nEnergy Rep. 8, 4525–4534. doi:10.1016/J.EGYR.2022.03.130\nZhang, L., Mu, Z., and Sun, C. (2018). Remaining useful life prediction for\nlithium-ion batteries based on exponential model and particleﬁlter. IEEE Access6,\n17729–17740. doi:10.1109/ACCESS.2018.2816684\nZhang, Q., Qin, C., Zhang, Y., Bao, F., and Liu, P. (2022b). Transformer-based\nattention network for stock movement prediction.Expert Syst. Appl.202, 117239.\ndoi:10.1016/J.ESWA.2022.117239\nZhao, S., Zhang, C., and Wang, Y. (2022). Lithium-ion battery capacity and\nremaining useful life prediction using board learning system and long short-term\nmemory neural network. J. Energy Storage 52, 104901. doi:10.1016/j.est.2022.\n104901\nFrontiers inEnergy Research frontiersin.org13\nHu and Zhao 10.3389/fenrg.2022.969168"
}