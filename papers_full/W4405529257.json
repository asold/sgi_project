{
  "title": "EpiGePT: a pretrained transformer-based language model for context-specific human epigenomics",
  "url": "https://openalex.org/W4405529257",
  "year": 2024,
  "authors": [
    {
      "id": "https://openalex.org/A2735508635",
      "name": "Zijing Gao",
      "affiliations": [
        "Tsinghua University"
      ]
    },
    {
      "id": "https://openalex.org/A2100640555",
      "name": "Qiao Liu",
      "affiliations": [
        "Stanford University"
      ]
    },
    {
      "id": "https://openalex.org/A2735079484",
      "name": "Wanwen Zeng",
      "affiliations": [
        "Stanford University"
      ]
    },
    {
      "id": "https://openalex.org/A2094922298",
      "name": "Rui Jiang",
      "affiliations": [
        "Tsinghua University"
      ]
    },
    {
      "id": "https://openalex.org/A2125669533",
      "name": "Wing Hung Wong",
      "affiliations": [
        "Stanford University"
      ]
    },
    {
      "id": "https://openalex.org/A2735508635",
      "name": "Zijing Gao",
      "affiliations": [
        "Ministry of Education of the People's Republic of China",
        "Tsinghua University"
      ]
    },
    {
      "id": "https://openalex.org/A2100640555",
      "name": "Qiao Liu",
      "affiliations": [
        "Stanford University"
      ]
    },
    {
      "id": "https://openalex.org/A2735079484",
      "name": "Wanwen Zeng",
      "affiliations": [
        "Stanford University"
      ]
    },
    {
      "id": "https://openalex.org/A2094922298",
      "name": "Rui Jiang",
      "affiliations": [
        "Tsinghua University",
        "Ministry of Education of the People's Republic of China"
      ]
    },
    {
      "id": "https://openalex.org/A2125669533",
      "name": "Wing Hung Wong",
      "affiliations": []
    }
  ],
  "references": [
    "https://openalex.org/W4285490847",
    "https://openalex.org/W2401562190",
    "https://openalex.org/W4322768301",
    "https://openalex.org/W2802729845",
    "https://openalex.org/W2198606573",
    "https://openalex.org/W2984156730",
    "https://openalex.org/W2601970700",
    "https://openalex.org/W4285006295",
    "https://openalex.org/W4213140257",
    "https://openalex.org/W2765651856",
    "https://openalex.org/W2966629694",
    "https://openalex.org/W4393178368",
    "https://openalex.org/W4315641887",
    "https://openalex.org/W3127238141",
    "https://openalex.org/W6601313673",
    "https://openalex.org/W3203588026",
    "https://openalex.org/W2960370523",
    "https://openalex.org/W4220889904",
    "https://openalex.org/W2952060487",
    "https://openalex.org/W2149118429",
    "https://openalex.org/W2259938310",
    "https://openalex.org/W2768013244",
    "https://openalex.org/W2612724210",
    "https://openalex.org/W3161076052",
    "https://openalex.org/W2099062342",
    "https://openalex.org/W2906884244",
    "https://openalex.org/W2991283206",
    "https://openalex.org/W3092353457",
    "https://openalex.org/W2523285811",
    "https://openalex.org/W4304109168",
    "https://openalex.org/W2606675097",
    "https://openalex.org/W6702248584",
    "https://openalex.org/W2921983621",
    "https://openalex.org/W2147231609",
    "https://openalex.org/W2793937297",
    "https://openalex.org/W4280652752",
    "https://openalex.org/W3097582316",
    "https://openalex.org/W2782454362",
    "https://openalex.org/W2770609313",
    "https://openalex.org/W3168560461",
    "https://openalex.org/W2174602966",
    "https://openalex.org/W2557981253",
    "https://openalex.org/W2905452503",
    "https://openalex.org/W4200429845",
    "https://openalex.org/W3028410545",
    "https://openalex.org/W4292880333",
    "https://openalex.org/W3001118548",
    "https://openalex.org/W2471356895",
    "https://openalex.org/W3015622053",
    "https://openalex.org/W4280588204",
    "https://openalex.org/W4386824148",
    "https://openalex.org/W4404793799",
    "https://openalex.org/W4313544615",
    "https://openalex.org/W4382932469",
    "https://openalex.org/W4387035512",
    "https://openalex.org/W2953462601",
    "https://openalex.org/W4310597577",
    "https://openalex.org/W3213171917",
    "https://openalex.org/W2790546589",
    "https://openalex.org/W4388615767",
    "https://openalex.org/W2767749844",
    "https://openalex.org/W2014677321",
    "https://openalex.org/W2952239877",
    "https://openalex.org/W4308292989",
    "https://openalex.org/W2097160089",
    "https://openalex.org/W2084160423",
    "https://openalex.org/W4384696778",
    "https://openalex.org/W6930416197",
    "https://openalex.org/W2320983896"
  ],
  "abstract": "Abstract The inherent similarities between natural language and biological sequences have inspired the use of large language models in genomics, but current models struggle to incorporate chromatin interactions or predict in unseen cellular contexts. To address this, we propose EpiGePT, a transformer-based model designed for predicting context-specific human epigenomic signals. By incorporating transcription factor activities and 3D genome interactions, EpiGePT outperforms existing methods in epigenomic signal prediction tasks, especially in cell-type-specific long-range interaction predictions and genetic variant impacts, advancing our understanding of gene regulation. A free online prediction service is available at http://health.tsinghua.edu.cn/epigept .",
  "full_text": "Open Access\n© The Author(s) 2024. Open Access This article is licensed under a Creative Commons Attribution 4.0 International License, which permits \nuse, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original \nauthor(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third \nparty material in this article are included in the article’s Creative Commons licence, unless indicated otherwise in a credit line to the mate-\nrial. If material is not included in the article’s Creative Commons licence and your intended use is not permitted by statutory regulation or \nexceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit http://\ncreativecommons.org/licenses/by/4.0/.\nMETHOD\nGao et al. Genome Biology          (2024) 25:310  \nhttps://doi.org/10.1186/s13059-024-03449-7\nGenome Biology\nEpiGePT: a pretrained transformer-based \nlanguage model for context-specific human \nepigenomics\nZijing Gao1†, Qiao Liu2*†, Wanwen Zeng2, Rui Jiang1* and Wing Hung Wong2,3* \nAbstract \nThe inherent similarities between natural language and biological sequences have \ninspired the use of large language models in genomics, but current models struggle \nto incorporate chromatin interactions or predict in unseen cellular contexts. To address \nthis, we propose EpiGePT, a transformer-based model designed for predicting context-\nspecific human epigenomic signals. By incorporating transcription factor activities \nand 3D genome interactions, EpiGePT outperforms existing methods in epigenomic \nsignal prediction tasks, especially in cell-type-specific long-range interaction predic-\ntions and genetic variant impacts, advancing our understanding of gene regulation. \nA free online prediction service is available at http:// health. tsing hua. edu. cn/ epige pt.\nKeywords: Epigenomics, Gene Regulation, 3D genome, Transformer, Language model\nBackground\nA fundamental but largely unresolved problem in genomics is to decode the informa -\ntion residing in the non-coding part of the human genome. It remains incompletely \nunderstood how regulatory elements govern gene expression in different contexts [1], \nand how noncoding variants may disrupt the underlying regulatory syntax of DNA [2]. \nFortunately, recent advances in epigenome sequencing [3, 4] have resulted in the accu -\nmulation of data useful for the study of these questions, including chromatin accessibil -\nity, DNA methylation, histone modifications, and 3D chromatin interaction. Thus, there \nis great interest in performing systematic analysis of these data to enhance our ability to \ninterpret the non-coding part of the genome [5–11].\nThe inherent similarities between natural language and biological sequences have also \nstimulated interest in developing large language models (LLM) for the interpretation \nof genome sequences. As is well known, the development of LLM has been the main \ndriving force behind many recent breakthroughs in artificial intelligence such as Chat -\nGPT, leading to numerous applications in bioinformatics [12, 13]. The architecture of \n†Zijing Gao and Qiao Liu \ncontributed equally to this work.\n*Correspondence:   \nliuqiao@stanford.edu; \nruijiang@tsinghua.edu.cn; \nwhwong@stanford.edu\n1 Ministry of Education Key \nLaboratory of Bioinformatics, \nBioinformatics Division \nat the Beijing National Research \nCenter for Information Science \nand Technology, Center \nfor Synthetic and Systems \nBiology, Department \nof Automation, Tsinghua \nUniversity, Beijing 100084, China\n2 Department of Statistics, \nStanford University, CA, \nStanford 94305, USA\n3 Department of Biomedical \nData Science, Bio-X Program, \nCenter for Personal Dynamic \nRegulomes, Stanford University, \nStanford, CA 94305, USA\nPage 2 of 30Gao et al. Genome Biology          (2024) 25:310 \nthe LLM is a multilayer transformer network, and the model is trained on a very large \ncorpus of natural language data. Such pre-trained models can be readily tailored or \nadapted to various downstream tasks. Considering DNA sequences as the texts in the \ngenomic language, similar transformer-based approaches have been used to model DNA \nsequences [14, 15]. For example, the Enformer model [16] takes the DNA sequence of a \nlarge genomic region as input and predict thousands of epigenomic features across cel -\nlular contexts covered by the training data. Although already useful in many applica -\ntions, such models relying on only DNA sequences as input are not capable of predicting \nthe function of sequences in new cellular contexts. Furthermore, despite the importance \nof 3D chromatin contacts in gene regulation, 3D interaction data have not been included \nin the training of current genomic LLMs. Therefore, there is an urgent need to further \ndevelop the core technologies of genomic LLMs to overcome these limitations.\nIn this paper, we present EpiGePT, a transformer-based model for human epigenom -\nics prediction with the following new capabilities. First, the inability to make predic -\ntions in novel contexts has greatly limited the applicability of current methods, EpiGePT \nremoves this limitation by making both the input and output context-dependent, where \nthe context is represented by a TF-profile vector specifying the expression of key tran -\nscription factors (TFs) in that context. This choice is motivated by the fact that refer -\nence gene expression data are available for many cellular contexts that are important in \ndevelopment and diseases, but for which few epigenomic features have been measured. \nWe note that the reference TF expression profile has been used to represent cellular \ncontext in earlier works on accessibility prediction [17, 18], but this idea has not been \nexplored for the development of genomic LLMs. Second, a new learning algorithm is \ndeveloped to enable the inclusion of 3D chromatin contact data in the training data. In \nthis way, EpiGePT can predict 3D genome features such as enhancer-promoter interac -\ntions that are known to be important for gene regulation but are not modeled in current \ngenomic LLMs. Besides, by using a masked training strategy, EpiGePT can be trained on \na diverse set of contexts even if different sets of epigenomics signals are available in dif -\nferent contexts.\nThere is a profound difference in training strategy between EpiGePT and current \ngenomic LLMs. Each input genomic region provides an example for training in current \nLLMs such as the Enformer. In contrast, each combination of input region and cellu -\nlar context provides an example for training in EpiGePT, thus providing a much larger \nnumber of examples available for model training. As for training data sets, since most \ncellular contexts that have epigenomic data will also have expression data, we can use \nmost available epigenomic data, such as those used by the Enformer, to train our model. \nIn a series of experiments, we illustrate that our model is superior to existing methods in \nepigenomic signal prediction, long-range chromatin interaction prediction, and the vari-\nant effect prediction.\nResults\nOverview of EpiGePT\nEpiGePT is a genomic language model for cross-cell-type prediction of chromatin states \nby multi-task learning based on genome-wide pre-training on epigenomic data (Fig.  1 \nand Additional file  1: Fig. S1). The model is composed of four modules, including a \nPage 3 of 30\nGao et al. Genome Biology          (2024) 25:310 \n \nsequence module, a TF module, a transformer module, and a prediction module. The \nsequence module is responsible for processing the long DNA sequence of interest (e.g., \n128 kb) by employing a series of convolutional and pooling blocks (e.g., 5) to extract a \ncomprehensive set of sequence features. The TF module is specifically designed to rep -\nresent a cellular context by a TF-profile vector, which specifies the state of a few hun -\ndred TFs in that context. The features computed by the sequence and TF modules are \nthen fed as input tokens to the transformer module, where each token corresponds to \na genomic bin (e.g., a 128-bp window) in the original DNA sequence. The transformer \nmodule leverages self-attention mechanisms to learn the relationships among the input \nbins, enabling the model to make predictions of multiple chromatin states given the con-\ntext information from the TF module. Importantly, by including a novel loss term that \ninvolves the self-attention weights, EpiGePT is capable of learning from data on context-\nspecific chromatin interactions. Since 3D interaction is known to be a key mechanism in \ngene regulation, the ability to learn from interaction data is an attractive feature of our \napproach. Finally, the fourth module in EpiGePT is a predictive module which predicts \nepigenomic signals and chromatin interactions based on the output of the transformer \nmodule.\nGenome‑wide prediction of epigenomic signals\nTo assess the performance on predicting epigenomic signals, we first compared EpiGePT \nto task-specific models that are specifically designed for predicting a single epigenomic \nsignal. Taking the chromatin accessibility for instance, the performance of EpiGePT was \ncompared against existing task-specific models such as BIRD [19], ChromDragoNN \n[17], and DeepCAGE [18]. The widely available public DNase-seq [20] data across 129 \nFig. 1 Overview of EpiGePT model for multiple epigenomic signals prediction. The EpiGePT model consists \nof four modules, namely the Sequence module, the TF module, the Transformer module, and the Multi-task \nprediction module. The sequence module comprises multiple layers of convolution applied to the one-hot \nencoded DNA sequence input. The input sequence length consists of 1000 genomic bins of 128 bp for the \nprediction of multiple signals and 50 bins of 200 bp for the prediction of DNase signal alone. The TF module \nencompasses the binding status and expression of 711 transcription factors. The Transformer module \nconsists of a series of consecutive transformer encoders, while the multi-task module is composed of a fully \nconnected layer. Additionally, the EpiGePT framework integrates an optional knowledge guidance module \nthat enhances the interpretability of the model by incorporating three-dimensional chromatin interaction \ndata into the attention layer, thus improving its understanding of regulatory mechanisms\nPage 4 of 30Gao et al. Genome Biology          (2024) 25:310 \ncellular contexts on 1,175,374 genomic regions were collected and preprocessed from \nENCODE project [21] (see “Methods ”). Performance is evaluated in three prediction \nsettings: (i) “cross-region” setting where the predictive model is tested on new genomic \nregions not seen in training, (ii) “cross-cell type” setting where the model is tested on \nnew cell types, and (iii) “cross-both” setting where testing is done on new regions in new \ncell types (Additional file 1: Fig. S2, Text S1). In each setting, we employed three evalua -\ntion metrics, namely Pearson correlation coefficient (PCC), Spearman correlation coef -\nficient (SCC), and prediction square error (PSE), to assess the similarity between the \npredicted and true values of the DNase signals (see “Methods”). The results, presented in \nFig. 2a and Additional file 1: Fig. S3-S4, showed that EpiGePT consistently outperformed \nFig. 2 Performance of EpiGePT and baseline methods on the benchmark experiment. a EpiGePT and \nbaseline methods were compared in terms of their regression performance for DNase signal regression \nacross cell types, genomic regions, and combined cell type and genomic regions. b Comparison of EpiGePT \nand Enformer performance. Each point in the scatter plot represents the performance of Enformer on the \ndata of a specific cell type (x-axis) compared to the performance of EpiGePT (y-axis). The top three graphs \nrepresent the prediction of continuous DNase signals (PCC), while the bottom three graphs represent the \nbinary classification of chromatin accessibility regions. c EpiGePT and baseline methods’ performance on \nbinary prediction of DNase-seq signals. d EpiGePT demonstrates more excellent performance in predicting \ndiverse epigenetic signals across various cell types, compared with the pre-trained Enformer on 78 genomic \ntracks across 19 unseen cell types. The orange points represent SCC, and the blue points represent PCC. \ne EpiGePT cross-cell-type predictions compared to experimental signals visualized for a representative \nexample. The predictions specific to DNase are based on the hg19 reference genome, while predictions for \nmultiple epigenomic profiles are conducted using the hg38 reference genome\nPage 5 of 30\nGao et al. Genome Biology          (2024) 25:310 \n \nbaseline methods including BIRD [19], and ChromDragoNN [17] by a relatively large \nmargin under the above settings. For example, EpiGePT achieved a cross-cell type pre -\ndiction PCC of 0.787, demonstrated a 6.9% higher performance than the best baseline \nmethod, ChromDragoNN. In addition, we also evaluated the prediction of binary chro -\nmatin accessibility status, i.e., predicting whether a peak exists within the correspond -\ning genomic bin (> 50% overlap). For binary prediction, EpiGePT again achieved a \nsuperior performance with an average auPRC (area under the precision-recall curve) of \n0.767 compared to 0.623 of DeepCAGE [18] and 0.476 of ChromDragoNN [17] (Fig. 2c). \nFinally, we compared EpiGePT and ChromDragoNN [17] in the binary classification of \nfunctional regions versus nonfunctional regions, using the functional chromatin sta -\ntus derived from ChromHMM [22] annotations as ground truth (Additional file 1: Text \nS2). EpiGePT achieved an average 8.1% higher auROC (area under the receiver operat -\ning characteristic curve) than ChromDragoNN [17], and an average 2.3% higher macro-\nauROC than ChromDragoNN [17] (p-value < 0.001 under one-sided Wilcoxon signed \nrank test) in a finer-grained classification for different types of regulatory elements \n(Additional file 1: Fig. S5a-b). We also compare the consistency and discrepancy of dif -\nferent methods by treating the predicted label of one method as ground truth and evalu -\nate on other methods (Additional file 1: Text S3, Fig. S6). These results demonstrate that \nEpiGePT provides better predictions than task-specific models.\nNext, we compared EpiGePT with a state-of-the-art genomic LLM, Enformer [16], \nin two different ways. First, we trained an Enformer model from scratch with only the \naforementioned DNase-seq data (Additional file 1: Text S4, Fig. S7). EpiGePT demon -\nstrates a 3.3 to 5.2% higher performance than Enformer in terms of the median PCC \nunder the three prediction settings (Fig.  2b). Additionally, EpiGePT also outperforms a \nretrained Enformer model from scratch with eight different epigenomic signals, achiev -\ning a 12.3% improvement in the average PCC across all genomic tracks (Additional file 1: \nFig. S8a-b). Second, we compared EpiGePT directly to the pretrained Enformer model \nprovided by the original paper. To do this, we collected eight different epigenomic sig -\nnals from 104 different cellular contexts (see “Methods ”). We first left out 13 of these \ncontexts where HiChIP data are also available for downstream chromatin interactions \nvalidation. Then, EpiGePT model was trained across 72 training cellular contexts (with -\nout using HiChIP-based chromatin contacts data in the training) and subsequently \ncompared against pre-trained Enformer on the remaining 19 test cellular contexts, on \n15,870 training genomic regions with 128 kbp length. Since most of the cellular contexts \nhave missing epigenomic signals, we designed a masked training strategy to handle this \nissue (see “Methods”). Under the test cellular contexts, EpiGePT exhibited superior per -\nformance with higher PCC than Enformer in 60 out of 78 matched epigenomic signals \nacross 19 test cellular contexts by achieving an average PCC of 0.510, compared to 0.440 \nof Enformer (Fig.  2d and Additional file  1: Fig. S8c-d). For DNase-seq specifically, the \naverage PCC of EpiGePT reached 0.710 and the average SCC reached 0.664 across 7 cell \ntypes, compared to the average PCC of 0.455 and the average SCC of 0.488 of Enformer. \nIn the above comparison, we are in fact comparing out-sample prediction by EpiGePT \nto in-sample prediction by Enformer. The favorable results achieved by EpiGePT in this \nexperimental setting suggest that our model enables prediction in novel contexts with -\nout sacrificing performance. To illustrate the prediction performance further, several \nPage 6 of 30Gao et al. Genome Biology          (2024) 25:310 \ntracks of predicted chromatin states and the corresponding ground truth chromatin \nstates are displayed in Fig. 2e.\nWe further explored EpiGePT’s applicability to other species using zero-shot learn -\ning and fine-tuning strategies. Given the high conservation of TFs between mouse and \nhuman [23], we adapted EpiGePT to mouse data, identifying 688 overlapping TFs and \nsetting the expression of non-overlapping TFs to zero. Using chromatin accessibility data \nfrom three organ-level mouse datasets (brain, lung, kidney) as examples, we employed \nOpenAnnotate [24, 25] to annotate 247,750 peaks for brain data, 243,900 peaks for lung \ndata, and 180,400 peaks for kidney data, respectively. First, in the zero-shot experiments, \nEpiGePT demonstrated PCC ranging from 0.330 to 0.422 (Additional file 1: Fig. S9). For \nexample, the brain dataset achieved a PCC of 0.422, and a SCC of 0.379 on the test chro-\nmosomes (chromosomes 18, 19, X, and Y). Following fine-tuning, the model’s predictive \naccuracy improved significantly, even with limited data, with PCC increases of 18.1, 18.4, \nand 19.5% observed in brain, kidney, and lung datasets, respectively (Additional file 1: \nFig. S10a, S10c). We further explored the EpiGePT’s cross-cell type prediction capabili -\nties on mouse data. The model fine-tuned on lung data achieved a PCC of 0.490 on brain \ndata, and the kidney-fine-tuned model reached a PCC of 0.448, both outperforming the \nzero-shot predictions (Additional file  1: Fig. S10b). Additionally, we demonstrated the \nimportance of TF module in a fine-tuning setting on mouse data (Additional file 1: Fig. \nS11). These comprehensive experiments highlight the pretrained EpiGePT model’s sub -\nstantial potential for cross-species applications.\nEpiGePT enables the prediction of chromatin interactions\nWe examined the capacity of EpiGePT for predicting long-range chromatin interactions, \nwhich is important for understanding chromatin architecture and relations between reg-\nulatory elements and target genes. We employed several experimental settings to exam -\nine the ability of EpiGePT in capturing long-range chromatin interactions. In setting (A), \nwe directly utilized the self-attention weights extracted from the pretrained EpiGePT \nmodel (without including HiChIP data in the training) to predict enhancer-promoter \n(E-P) interactions and silencer-promoter (S-P) interactions. In setting (B), we integrated \nHiChIP-derived 3D chromatin contacts into the training of the model and then use the \nmodel to predict E-P interactions in novel contexts not seen in the training. In setting \n(C), we designed a pretrain-finetune strategy for EpiGePT model to predict E-P interac -\ntions. The results under each setting are discussed below.\nSetting (A): prediction by EpiGePT not trained with 3D contact data. In this setting, \nwe use the cell-type specific self-attention scores to predict chromatin interactions, \nincluding E-P and S-P interactions (see “Methods ”). Two sets of interactions contain -\ning 664 and 5091 candidate element-gene interactions, obtained by CRISPRi [26] exper -\niments on K562 cell line, were collected and further filtered and divided into positive \nand negative samples, for use as ground truths to evaluate E-P prediction performance. \nIn the Gasperini et  al. [27] dataset, EpiGePT consistently outperformed Enformer by \nachieving the highest auPRC in most cases (Fig.  3a). For instance, EpiGePT achieved \nauPRC of 0.647 to 0.887 for identifying enhancer-gene transcription start site (TSS) \npairs in different distance groups (Fig. 3a and Additional file 1: Fig. S12a-b). In the Fulco \net al. [28] dataset, EpiGePT also outperformed other competing methods. For example, \nPage 7 of 30\nGao et al. Genome Biology          (2024) 25:310 \n \nEpiGePT achieves an auPRC of 0.504, compared to 0.307 of Enformer in the 30–45 kbp \ngroup (Fig.  3a). Next, to assess performance on S-P interactions, we downloaded puta -\ntive silencers from the SilencerDB [29] and used the TSS of annotated nearest gene as \nthe potential target. We selected the same number of negative pairs randomly while \nFig. 3 Application of self-attention mechanism in EpiGePT for long-range chromatin interaction \nidentification. a The performance (auPRC) of attention score of EpiGePT in distinguishing enhancer-gene \npairs at different distance ranges on two different datasets. b The performance (auPRC) of attention score of \nEpiGePT in distinguishing silencer-gene pairs at different distance ranges based on the data from SilencerDB \n[29]. c Heatmap of the self-attention matrix of each attention head centered at the TSS of the CHD4 gene, \nthe (i, j) element in the matrix denotes the average attention score between the ith genomic bin and the jth \ngenomic bin across all layers. d The performance (auPR) of self-attention scores of EpiGePT and EpiGePT-3D \nin identifying enhancer-promoter interactions across different distance ranges on the K562 cell type. e \nThe predictive performance (blue points denote PCCs and orange points denote SCCs) of EpiGePT with \nknowledge guidance across 19 cell types and 15,870 long sequences (128 kbp). f Attention scores centered \nat the TSS of the CHD4 gene, and putative enhancer regions in its vicinity. g The performance (auROC and \nauPR) of attention score of EpiGePT in distinguishing HiChIP loops of H3K27ac at different distance ranges \non GM12878 cell line. h The performance table (auROC and auPRC) of the fine-tuned EpiGePT model and \nbaseline methods (DeepTACT and Kmer-MLP) in distinguishing enhancer-gene pairs at various distance \nranges (0–20 kbp, 20–40 kbp, and 40–64 kbp) on K562 cell line under a fivefold cross validation setting. The \nsize of the circles represents the rank of different methods, with larger circles indicating higher performance \nand a better rank. A score of 0% represents the lowest-performing method, while 100% represents the \nhighest-performing method. The sizes of the remaining circles are determined based on their percentage \nscores. The color also reflects the rank, with lighter colors indicating better performance. The average score \nbar reflects the mean of the three metrics\nPage 8 of 30Gao et al. Genome Biology          (2024) 25:310 \nconserving the distance distribution. The results show that EpiGePT achieved a better \nperformance in distinguishing positive S-P pairs from negative pairs than Enformer. \nFor instance, EpiGePT achieves an auROC of 0.575 in long-range S-P interactions (32–\n64 kbp) compared to 0.483 of Enformer (Fig.  3b, Additional file  1: Fig. S12c). Finally, \nto assess performance in predicting chromatin interactions, we collected HiChIP [30] \nloops on K562 and GM12878 cell lines from the HiChIPdb [31]. EpiGePT achieves a \nsuperior performance by discerning HiChIP loops from randomly selected loops with \nthe same distance distribution. For instance, EpiGePT achieves an auPRC of 0.520 \nfor long range loops (40–64 kbp) prediction in GM12878 cell line, surpassing that of \nEnformer (0.484) by a large margin (Fig.  3g, Additional file 1: Fig. S12d). These results \nclearly demonstrated the utility of EpiGePT attention scores in capturing functional \nchromatin interactions.\nTo better understand the self-attention mechanism of EpiGePT, we showed the atten -\ntion weights (averaged across heads) for the bin containing the TSS of the gene CHD4. \nThe attention weights were computed based on the pretrained EpiGePT model with \nK562 cell line as the context of interest. We also display chromatin interactions detected \nunder K562 as well as regulatory element annotations from the GeneHancer [32]. It is \nseen that both the interaction data and the regulatory element annotations are consist -\nent with the attention weights learned by EpiGePT (Fig. 3c and Fig. 3f).\nSetting (B): Prediction by EpiGePT-3D, which include Hi-C data in its training. The \nabove results suggest that in a good transformer-based genomic language model, the \nattention weight given by one bin to another bin (within the input region) should be \nconsistent with the strength of 3D interaction between them. Thus, when experimen -\ntal data on 3D interaction are available, we can leverage this data to improve the learn -\ning of the parameters of our genomic language model, by penalizing parameter values \nthat resulted in poor correlation between the attention weights and the interaction data \n(see “Methods ”). To obtain such training data, we collected 4,107,687 H3K27ac-based \nHiChIP loops across 13 cell lines or tissues from HiChIPdb [31], which denote poten -\ntial E-P interactions. Setting aside loops from K562 and GM12878 cell lines as test data, \nother HiChIP loops are incorporated into the training. The resulting model is denoted \nas EpiGePT-3D. We found that adding 3D interaction data in the training can lead to \na noticeable improvement for cross-cell-type prediction (3.3% higher in PCC) (Fig.  3e). \nMoreover, EpiGePT-3D demonstrated improved predictive performance on E-P interac-\ntions identified by HiChIP loops in new cellular contexts (Fig.  3d, Additional file 1: Fig. \nS13). For instance, the auPRC increased from 0.652 to 0.695 for Gasperini et al. ’s dataset, \nwhich is on a context not covered by the Hi-C data in the training, in 24–40 kbp group \nwhen incorporating 3D genome data.\nSetting (C): Prediction by fine-tuning pretrained EpiGePT. Fine-tuning is an strategy \nthat transfers the knowledge of a pretrained model to new tasks, which is particularly \nprevalent in language models such as GPT [33] and BERT [34]. Here, we explore the \nperformance of fine-tuning given a pretrained EpiGePT model on downstream tasks, \nsuch as predicting 3D genome interaction. Specifically, we fixed the weights of the pre -\ntrained EpiGePT model and trained an additional finetune network utilizing the last \nhidden states of the Transformer module for predicting E-P interactions. We compared \nEpiGePT with fine-tuning strategy (EpiGePT-finetune) to two baselines, DeepTACT \nPage 9 of 30\nGao et al. Genome Biology          (2024) 25:310 \n \n[35] and a k-mer frequency-based  method29 with HiChIP H3K27ac loops from K562 \nand GM12878 cell lines (see “Methods ”). The results illustrate that EpiGePT-finetune \nexhibited a superior classification performance across diverse distance ranges and posi -\ntive–negative sample ratios compared to baselines (Additional file 2: Table S1-S4). For \nexample, EpiGePT-finetune achieved an average auROC of 0.982, surpassing 0.886 of \nDeepTACT [35] and 0.694 of Kmer by a large margin in the GM12878 cell line within the \n0–20 kbp distance range at a positive–negative sample ratio of 1:1 (Fig.  3h, Additional \nfile 1: Fig. S14-S15). This significant improvement demonstrates the power of fine-tuning \na base pretrained genomic language model on a downstream task with limited data. In \naddition, we utilized the hg38 genome and evaluated the performance of EpiGePT-3D, \nEpiGePT after fine-tuning, with baseline methods. The results indicate that EpiGePT-3D \nachieved a slight overall advantage in predicting chromatin interactions under the same \ntraining conditions (Additional file  1: Fig. S16-S17). Furthermore, EpiGePT-3D also \nslightly outperformed the pretrained Enformer (Additional file 1: Fig. S18) in predicting \nepigenomic tracks, further validating the improvements brought by the 3D genome data.\nIn summary, we designed three settings for chromatin interaction prediction and have \ndiscussed and summarized the details and differences of each setting in relation to vari -\nous application scenarios (Additional file 1: Text S5, Additional file 2: Table S5). We also \nvalidated the improvements brought by incorporating 3D genome data, suggesting that \nEpiGePT-3D pretrained on larger datasets has significant potential as more comprehen -\nsive 3D genome data become available.\nEpiGePT unveils the regulatory relationships between TFs and target genes\nIn this section, we further explored the TF module to see whether EpiGePT is able to \nlearn the regulatory relationships between TFs and target genes (TGs). We defined gra -\ndient importance scores (GIS) based on the absolute gradient values of predicted epig -\nenomic signals with respect to the expression of a TF in the input TF profile, to rank the \nTFs for their potential to regulate a given TG (see “Methods ”). Particularly, we use the \nTF profile of embryonic stem cell (ESC) to specify the context in the EpiGePT model. \nWe selected the important ESC regulator POU5F1 as the target gene and calculated the \nGIS for identifying TF-TF interactions (see “Methods ”). Multiple potential regulators \nfor POU5F1 identified by EpiGePT in ESC context are consistent with literatures, such \nas ESRRB-POU5F1 [36] (rank 2nd), and ETV5 -POU5F1 [37] (rank 5th). Next, we focus \non ESRRB which plays essential role for balancing pluripotency of ESCs [38]. Treating \nESRRB as the target gene, our GIS-based ranking identified several key TFs, such as \nPOU5F1 and REST , that have significantly higher ranks than other TFs (Fig.  4a, Addi-\ntional file 1: Fig. S19a). By using ChIP-seq data of POU5F1 for validation, we observed \nsignificantly higher GIS in bins overlapping with the ChIP-seq data (Additional file  1: \nFig. S19b, p-value < 0.00018 under one-sided Mann–Whitney U test). Next, we visual -\nized the TF ranks obtained from eight epigenomic profiles across 1000 bins surround -\ning the TSS of ESRRB . By averaging ranks across these signals and bins among all the \n711 TFs, the important ESC regulator POU5F1 ranks 3 out of 711 (Fig.  4b). We fur -\nther collected the top 5% of TFs for each bin and conducted gene ontology (GO) enrich -\nment analysis based on these TF coding genes. Interestingly, the GO terms enriched \nalso included biological processes of embryonic cell differentiation and development. \nPage 10 of 30Gao et al. Genome Biology          (2024) 25:310 \nHowever, using the top 5% of TFs with high expression in ESCs resulted in lower signifi -\ncance for biological processes associated with embryonic cell development (Fig.  4c and \nAdditional file 1: Fig. S20), which again demonstrates the effectiveness of the GIS-based \nranking. Furthermore, we use TF-TG relationships from either ChIP-seq data or exter -\nnal databases as ground truth to validate the TF-TG relationships inferred by EpiGePT. \nWe defined potential TF-target gene pairs based on TF ChIP-seq data specific to certain \ncell types among all human genes (see “Methods ”). The results demonstrated a signifi -\ncant higher rank of TF-target gene pairs, compared to TF-non-target gene pairs based \nFig. 4 Gradient importance scores (GIS) uncover regulatory transcription factors. a Genomic regions around \nTSS of the ESRRB gene and TF expression data on ESC were used in EpiGePT. The scatter plot represents \nthe GIS scores of 711 TFs on each genomic bin. Each dot represents the GIS score of a core TF on a specific \ngenomic bin. Two important ESC regulators REST and POU1F5 are highlighted. b Bar plot of the top 5% \nranked TFs, based on the average ranks from the GIS of eight epigenomic signals across bins (below). c Based \non the top 5% ranked TFs in 128-kbp region centered at TSS of the ESRRB gene, gene ontology enrichment \nanalysis revealed significant enrichment in biological processes related to embryonic development and \ncellular differentiation. d Based on TF ChIP-seq data, all 23,635 human genes were classified into target \ngenes and non-target genes. The results revealed that TFs exhibited significantly higher ranks on potential \ntarget genes compared to non-target genes. e The distribution of the rank of TFs in the GIS and expression \nvalue among the 2705 TF-gene pairs from the TRRUST database and 1066 TF-gene pairs derived from \ngenotype-tissue expression (GTEx) data of the liver sourced from the GRNdb database\nPage 11 of 30\nGao et al. Genome Biology          (2024) 25:310 \n \non the integrated GIS-based ranking (Fig.  4d, p-value < 0.001 under one-sided Mann–\nWhitney U test). Second, we collected TF-TG regulatory network data from two pub -\nlicly available databases. We obtained a total of 1066 TF-TG pairs from the GRNdb [39] \ndatabase based on liver-specific GTEx data, and 2705 TF-TG pairs from the TRRUST \n[40] database after filtering. Then we calculated the rank of each TF based on either \nintegrated GIS or the TF expression value by using the liver expression as the TF ref -\nerence profile. Interestingly, we found that the median ranking percentile of TFs from \nTRRUST was 3.1%, significantly higher than the percentile of 20.4% based on expres -\nsion values (Fig.  4e, p-value < 1e − 5 under one-sided Wilcoxon signed rank test). With \na similar result was obtained using another database GRNdb, where EpiGePT is seen \nto achieve a median ranking percentile of 6.3%, compared to 36.0% by gene expression \nvalue. For instance, TMEM55B, which plays a significant role in lysosome movement, \nand is regulated by sterol response element binding factor 2 (SREBF2) [41]. Consistently, \nGIS ranking identified SREBF2 as the top-ranked TF associated with TMEM55B. Over -\nall, the validation results from both ChIP-seq datasets and external databases support \nthe effectiveness of GIS in identifying context-specific TF-TG relationships.\nEpiGePT improves variant effect prediction\nContext-specific prediction of the functional impact of genetic variants is important for \ngenetic studies. To test the utility of EpiGePT in this task, we first collected an eQTLs \ndataset [42] that contains 20,913 causal and non-causal variant-gene pairs across 49 dif -\nferent tissues from the supplementary data of Wang et al. [42]. EpiGePT, EpiGePT-seq \n(i.e. EpiGePT without the TF module) and Enformer were then applied to estimate the \ncontext-specific log-ratio scores (LOS) between the alternative DNA sequence and the \nreference DNA sequence (see “Methods ” , Fig. 5a). Finally, a random forest classifier is \ntrained based on these LOS’s to distinguish causal variant-gene pairs from non-causal \npairs. The experimental results show that better prediction performance can be achieved \nwhen the LOS is based on EpiGePT than when the LOS is based on Enformer. For \nexample, in the lung tissue, EpiGePT achieved an auPRC of 0.922, compared to 0.873 of \nEnformer, for the classification of casual SNPs vs non-causal SNPs. To verify the effec -\ntiveness of TF module, we replace the TF reference profile of lung with a less relevant \ncell type, stomach, and the auPRC decreases from 0.922 to 0.892 (Fig. 5b). Similar results \nwere seen for other tissue contexts—across 48 tissues, EpiGePT-seq achieved an average \nauPRC of 0.910, compared to 0.898 of Enformer (Additional file 1: Fig. S5c). The above \nexperiments demonstrated the usefulness of EpiGePT in assessing variant effects.\nTo further evaluate the performance of EpiGePT in predicting disease-associated vari-\nants, we extracted 52,876 pathogenic SNPs from the ClinVar [43] database and 418,863 \nbenign SNPs from the ClinVar database, also with 84,095 benign SNPs from the ExAC \ndatabase [ 44] as positive and negative sets, respectively. We defined a 128-kbp region \nsurrounding each pathogenic SNP as the risk region. We extracted all benign or likely \nbenign SNPs that fall within the risk region as the positive samples. As the relevant tis -\nsue or cell type information is not available, we concatenated the LOS of the eight epig -\nenomic signals and the self-attention scores, across multiple cellular contexts, and then \nevaluated whether the constructed features are beneficial in distinguishing pathogenic \nSNPs from benign ones in a classification analysis. To achieve this, we augmented the \nPage 12 of 30Gao et al. Genome Biology          (2024) 25:310 \npopular CADD-derived features (CADD [45] scores) by concatenating them to the Epi -\nGePT-derived features discussed in the above, to obtain a comprehensive feature vec -\ntor (see “Methods ”). Subsequently, we compared the performance of the multi-layer \nperceptron (MLP) classifier based on the comprehensive feature vector to that based on \nCADD-derived features alone. The results demonstrated that incorporating EpiGePT-\nderived features significantly enhance the performance in predicting pathogenic SNPs. \nSpecifically, when the positive-to-negative sample ratio was set to be 1:1, the average \nauROC increased from 0.772 to 0.806, and the average accuracy increased from 0.690 to \n0.723 (Fig. 5c). This observation indicates that features extracted by EpiGePT provide a \nvaluable complement to CADD scores, enabling a more comprehensive interpretation of \ndisease-associated variants.\nEpiGePT prioritizes potential SNPs associated with comorbidities of COVID‑19\nWe investigated whether using EpiGePT to predict variant effects could help in the dis -\ncovery of key SNPs related to COVID-19. COVID-19 is an infectious disease caused \nFig. 5 Variant effect prediction of EpiGePT. a The LOS for each epigenomic signal is calculated by the log \nchange fold of the predicted epigenomic signal for reference genome and WGS genome. b The performance \nof EpiGePT and Enformer in discriminating causal SNPs on the Lung tissue. c The three subplots from left to \nright respectively depict the classification results for disease-related SNPs and benign SNPs down-sampled \nsourced from the ClinVar database, with balanced positive and negative samples (1:1 and 1:2 ratio), as \nwell as normal SNPs sourced from the ExAC database with a MLP classifier. d The ranked position of \nCOVID-19-related GWAS data among surrounding benign SNPs based on their LOS, as determined using \ndifferent tissue or cell-type expression data. The results were stratified based on the distance range of the risk \nregion. The resulting mean and median ranks were both below 0.5. e Enrichment result (biological process, \ncellular component, and molecular function) of the nearest genes of the COVID-19 associated SNPs with the \nmax LOS\nPage 13 of 30\nGao et al. Genome Biology          (2024) 25:310 \n \nby the SARS-CoV-2 virus, which emerged in late 2019 and quickly spread around the \nworld, causing a global pandemic [46]. In order to validate the ability of EpiGePT in \nidentifying key SNPs, we collected GWAS data from a COVID-19 genetic study [47], \nincluding 9484 variants derived from 4933 patients with confirmed severe respiratory \nsymptoms and 1,398,672 control individuals without COVID-19 symptoms. To validate \nthe ability of the model to identify COVID-19-associated SNPs, we firstly defined a risk \nregion around the selected COVID-19-associated SNPs and computed the rank of the \nvariant score of pathogenic SNPs within the surrounding benign SNPs from the ClinVar \ndatabase. Note that the expected percentile rank for random guessing (uniform distribu-\ntion) is 0.5 (see “Methods ”). Previous studies [48, 49] suggested that COVID-19 infec -\ntion could potentially impair the function of the heart or the lungs, leading to congestive \nheart failure or decreased lung function. Interestingly, we found that the average rank \nof COVID-19-associated SNPs was 0.250 when lung expression data was employed for \nthe TF reference profile and a 6-kbp risk region was examined (Fig.  5d, p-value < 0.05 \nunder one-sided Binomial exact test). However, when we employed the expression data \nfrom less relevant contexts, such as K562 cells or Testis cells, the median rank is close to \nrandom guessing (i.e. 0.5), indicating its ineffectiveness in discerning SNPs pertinent to \nCOVID-19. These results suggest that EpiGePT is able to prioritize the COVID-19-asso-\nciated SNPs thus shedding lights on finding the potential disease-associated variants and \nthe relevant tissue contexts.\nNext, we examine whether the genes close to max-LOS SNPs are likely be associ -\nated with biological processes and functions relevant to COVID-19, when compared \nwith genes close to low scores SNPs or not closed to associated SNPs. Since the genetic \npathology of COVID-19 is not yet clear and the earliest lesion is in the lungs, we ranked \nall 9484 possible SNPs using lung expression data as the TF reference profile. We then \nidentified the SNPs with the highest ranks and performed GO enrichment analysis \non nearest genes of the top-30 scored SNPs (Fig.  5e). The enrichment results revealed \npotential biological processes that are relevant to COVID-19, such as the regulation of \nglucokinase activity which is associated with the homeostasis of human blood glucose \n[50]. Notably, diabetes mellitus, a condition closely associated with hyperglycemia, is a \ntypical comorbidity of COVID-19 [51]. However, GO enrichment analysis based on the \nnearest genes of the lowest-scored 30 SNPs resulted in enrichment outcomes that were \nless relevant to COVID-19 or its complications (Additional file 1: Fig. S21). Among the \npotential genes around the top-10 scored SNPs, we identified that the TBC1D4 gene, \nwhich regulates glucose homeostasis, is potentially associated with COVID-19 comor -\nbidities. Our findings are consistent with previous research by Pellegrina et al. [52] and \nhighlights the potential of our EpiGePT approach in discovering new genetic markers \nthat may be implicated in the pathogenesis of COVID-19. Overall, our EpiGePT model \nprovides new perspectives for understanding how the genetic variants could contribute \nto the COVID-19 susceptibility and severity.\nModel ablation analysis\nTo verify the roles of the main modules in the model, we first conducted ablation experi-\nments on the model architecture (Additional file 1: Fig. S22). For TF module ablation, \nthe results compared to EpiGePT without TF module (EpiGePT-seq) and the inclusion \nPage 14 of 30Gao et al. Genome Biology          (2024) 25:310 \nof the TF module led to improvement in cross-cell-type prediction of DNase signals, \nwith a median PCC of 0.787 of EpiGePT, compared to 0.74 for EpiGePT-seq. We addi -\ntionally examined the impact of the TF module by employing three methods, namely \nreplacing TF scores with zero, replacing TF scores with random noise, and removing \nmotif binding scores. The results again confirmed the positive impact of the TF mod -\nule. For sequence module ablation, we trained a TF-only model without the sequence \nmodule. The results indicated that removing the sequence module resulted in an average \ndecrease of 0.084 in the PCCs of the epigenomic signals on a cell-type-wise basis (Addi -\ntional file 1: Fig. S22a). For multi-task module ablation, we trained eight separate predic-\ntive models for each of the eight epigenomic signals. In the case of the H3K4me1 signal \nprediction, the performance of the single-task prediction model exhibited an average \nPCC decrease from 0.408 to 0.329 compared to the multi-task prediction model. Simi -\nlarly, the overall prediction performance for the eight signals declined by 0.074 (Addi -\ntional file 1: Fig. S22b). This decrease may be attributed to the intricate nature of gene \nregulation that multiple epigenomic signals can synergize with each other, allowing their \njoint modeling to gain deeper biological insights.\nSecond, we conducted three ablation experiments on the TF module to address sce -\nnarios where TF profiles are sparse or missing. We evaluated the performance of pre-\ntrained EpiGePT with a different number of randomly missing TFs by imputing missing \nTF expression values with zero, the mean or the median of reference TF profiles. Results \nconsistently showed that a larger number of missing TF profiles leads to a more signifi -\ncant decrease in the model performance, highlighting the importance of the TF module \n(Additional file 1: Fig. S23). To handle the scenarios where the TF expression data are \nnot available, we also simulated scenarios using similar cellular contexts and sequenc -\ning data from different samples of the same cell type (Additional file  1: Fig. S24-S25). \nMoreover, we constructed a comprehensive TF reference dataset and provided guidance \non how to construct the TF reference profile for specific cell types based on the large \namount of existing sequencing data [53, 54] (Additional file 1: Text S6, Fig. S26-28).\nThird, we conducted ablation experiments on the number of training cellular contexts \nto assess the impact of cell type quantity on performance improvement in predicting \nepigenomic signals using EpiGePT. The performance of EpiGePT continues to increase \nas the more training contexts are incorporated (Additional file  1: Fig. S29-S30). Even \nwith a single training context, the incorporation of the TF module yields a 1.2% aver -\nage improvement in PCC compared to the best sequence-based method. These extensive \nexperiments emphasized the central role of TF module to account for the context-spe -\ncific gene regulation and leading to a better prediction performance even with a limited \nnumber of training cellular contexts.\nOnline prediction tool for EpiGePT\nIn order to facilitate the utilization of EpiGePT for the prediction of multiple chro -\nmatin states of any cellular context and genomic regions, we have developed a user-\nfriendly web server, named EpiGePT-online (http:// health. tsing  hua. edu. cn/ epige \npt) (Additional file 1: Text S7). The web server was developed using PHP , JavaScript \nand HTML, which provides an interactive web interface for efficiently online pre -\ndiction of epigenomic profiles (Fig.  6). The web server includes a built-in kernel that \nPage 15 of 30\nGao et al. Genome Biology          (2024) 25:310 \n \nencompasses the framework for data preprocessing, TF motif binding scores calculat -\ning, and prediction of epigenomic signals for both hg19 and hg38 human reference \ngenome. Users can obtain the predicted signals for multiple genomic regions by sub -\nmitting a region file and a TF expression file in Numpy or CSV formats, or predicted \nsignals for a specific region by submitting a TF expression file (Additional file 1: Fig. \nS31). We provided TF expression profile across more than 100 cellular contexts from \nENCODE on the download page. Users can download the results in csv format for \nfurther applications such as genetics analysis. Furthermore, we provide a case appli -\ncation of the EpiGePT-online to enable users to quickly learn how to use our website \n(Additional file 1: Text S8). We anticipate that this web server will assist researchers \nin deepening their understanding of gene regulatory mechanisms.\nFig. 6 Overview of the online prediction web server of EpiGePT. We collected eight types of epigenetic \ngenome modification signals and corresponding expression data of transcription factors in different cell \ntypes or tissues from the ENCODE project. Based on these data, we trained the EpiGePT model and deployed \nit as a built-in kernel on an Apache server. Users without much coding experience can also access the web \nserver in two ways to obtain the eight types of epigenetic genome modification signals for specified cell \ntypes and genomic regions without programming or installation\nPage 16 of 30Gao et al. Genome Biology          (2024) 25:310 \nDiscussion\nThere exist several extensions and refinements that can be applied to further improve \nthe EpiGePT model. Firstly, the incorporation of chromatin regulators (CRs) as trans-\nacting factors into the TF module could enhance the modeling of regulated transcription \nprocesses, thereby increasing the accuracy of the predictions. Second, the integration \nof DNA methylation information [55, 56] while modeling DNA sequences allows for a \nmore comprehensive and accurate decoding of the epigenomic language, providing a \nmore comprehensive model of gene regulation states compared to the analysis solely \nbased on DNA sequences. Third, advancements in sequencing technologies have led to \nthe generation of extensive multi-omics data, spanning from molecules to tissues [57]. \nIntegrating single-cell level data into EpiGePT as pseudo-bulk data can further expand \nthe training context, facilitating a comprehensive understanding of regulatory heteroge -\nneity in a finer resolution. Fourth, the 3D genome data in a limited number of contexts \ndemonstrate improvement in cross-cell-type prediction power. Model performance \nmay be further improved by imputing the missing 3D genome data through 3D genome \ndata generative models [58, 59]. Fifth, despite the promising performance of EpiGePT in \nhuman epigenomics, there are limitations when applying it across species. We discussed \nthe potential and effectiveness of transferring EpiGePT to other type of species such as \nplants [60] and fungi [61, 62] (Additional file 1: Text S9, Fig. S32).\nConclusions\nIn this paper, we introduced a pretrained transformer-based language model for epig -\nenomics. Compared with the existing task-specific models and sequence-based language \nmodel, EpiGePT has the added capability to make predictions on novel contexts. Fur -\nthermore, EpiGePT is able to incorporate a new type of data (3D genome interaction \ndata) during model training, which enables the identifying functional regulatory interac -\ntions such as enhancer-promoter interactions. EpiGePT demonstrates state-of-art per -\nformance in diverse experimental settings compared to existing methods. Based on the \npredicted epigenomic features and 3D interactions from EpiGePT, we performed two \ninvestigations on how information is encoded in the human genome sequence: First, \nwe identify the interactions of cis-regulatory elements and their target genes with the \nhelp of self-attention mechanism in EpiGePT. Through direct utilization of self-atten -\ntion scores, model fine-tuning, and leveraging 3D genome interactions, we validated the \ncapacity of EpiGePT to capture regulatory interactions. Second, to assist the identifica -\ntion and interpretation of human disease-associated SNPs, we estimate the effect of a \nvariant on the epigenomic features around the variant, based on the LOS computed by \nthe outputs of EpiGePT. Such variant effect prediction by EpiGePT establishes a founda-\ntion for understanding the underlying relationship between genetic variations and dis -\nease mechanisms.\nBased on EpiGePT, users are able to predict multiple chromatin profiles in different \ncell lines or tissues, which could provide a foundation for biological discovery, decod -\ning transcriptional regulation mechanisms and investigating disease mechanisms. We \nanticipate EpiGePT will furnish researchers with valuable insights into understanding \nregulatory mechanisms.\nPage 17 of 30\nGao et al. Genome Biology          (2024) 25:310 \n \nMethods\nData processing\nChromatin accessibility data and expression data\nWe used three different datasets in the experiments. For chromatin accessible data, we \ndownloaded DNase bam files across 129 human biosamples from ENCODE [ 21] project \n(Additional file 2: Table S6). We divided the human hg19 genome into 200-bp non-over-\nlapping bins, and we assigned the label for each bin in each cell type. For the regression \ndesign, we pooled the bam files of multiple replicates for a cell type, and obtain the raw \nread count n lk for bin l in cell type k . We normalized the raw read count in order to \neliminate the effect of sequencing depths, in the form of nlk = Nn lk/N k , where Nk \ndenotes the total number of pooled reads for cell type k and N = min\nk\nNk denotes the \nminimal number of pooled reads across all cell types. The normalized read counts are \nfurther log transformed with pseudo count 1, which represent the continuous level of \nchromatin accessibility. For binary classification design, we assigned a binary label ylk to \n1 if the number of raw read counts of the bin l in the cell type k greater than 30, which \nrepresent the bin is an accessible region in this cell type, resulting in the identification of \nregions as accessible in 13% on average and 8% at median in the screened genomic \nregions across 129 cell types. The proportion of open regions varies among different cell \ntypes, and the average openness level mentioned above is generally consistent with that \nmaintained in ChromDragoNN [17].\nRNA-seq data of the 711 human TFs were downloaded and extracted from the \nENCODE project (Additional file 2: Table S7- S8). We perform log transformation with \npseudo count 1 and quantile normalization based on TPM values. The normalized TPM \nvalues were averaged across replicates and mean expression profile after normalization \nof each cell type was finally used to calculated of the transcription feature.\nMultiple chromatin signals data\nFor the human reference genome hg19 (GRCh37), DNase-seq, RNA-seq and ChIP-seq \ndata were also downloaded from ENCODE project (Additional file  2: Table  S9-S11). \nWe applied the same process to these data as above, and finally we obtained the 8 epig -\nenomic signals of 13,300,000 bins of 128 bp in 28 cell types. The continuous level of chro-\nmatin signals we extracted were “DNase” , “CTCF” , “H3K27ac” , “H3K4me3” , “H3K36me3” , \n“H3K27me3” , “H3K9me3, ” and “H3K4me1, ” which includes crucial epigenetic modifica-\ntions and markers for gene regulation and transcription.\nFor the collected data of human reference genome hg38 (GRCh38), we adopted a data \ncollection strategy that includes missing data. Specifically, within a particular tissue or \ncell type, we ensured the presence of at least one ChIP-seq signal. Then, epigenomic pro-\nfiles of 8 signals for 15,870,000 bins of 128 bp across 104 cell types were obtained (Addi -\ntional file 2: Table S12-S14).\nModel architecture\nSequence module\nAs shown in Fig. 1 and Additional file 1: Fig. S1a, the sequence module receives a one-hot \nmatrix (A = [0,0,0,1], C = [0,1,0,0], G = [0,0,1,0], T = [0,0,0,1]) of size (128,000,4) as input, \nrepresenting a sequence of 128 kilobase pairs (kbps) and contains five 1-dimentional \nPage 18 of 30Gao et al. Genome Biology          (2024) 25:310 \nconvolutional blocks to extract DNA sequence features. Each block includes a convolu -\ntional layer and a maxpooling layer (Additional file 1: Fig. S1b). The first convolutional \nlayer considers the input channels as 4 and performs convolution along the sequence \ndirection. The input sequence features are one-hot embeddings of size L × 4 , where L \ndenotes the length of the input long-range DNA sequence. After 5 maxpooling layers, \nthe output size of sequence feature is L/N × C , where C denotes the hyper-parameter \nfor sequence embedding and N denotes the length of locus to predict. We set C to 256 \nin the pre-training stage of chromatin accessibility prediction experiments. Rectified lin-\near units (ReLU) are used after each convolution operation for keeping positive activa -\ntions and setting negative activation values to zeros. By reducing the input length by 128 \ntimes through pooling operations, this module effectively compresses the input informa-\ntion while retaining essential features. Sequence features were then concatenated with \nTF expression features, and we finally obtained a vector of size L/N × (C + nTF) , where \nnTF denotes the dimension of the TFs features after padding. In our model, after adding \npadding to the 711 TFs, the nTF is set to 712. Therefore, the input token number for the \ntransformer module is 1000, and each token embedding has a dimensionality of 968.\nTransformer module\nWe utilize the transformer module to integrate information from both the sequence \nand TFs, enabling the capturing of long-range interactions between genomic bins. We \napplied N t layers of Transformer encoder with nh different attention heads to the token \nembedding sequence. The input word embedding (X) of the transformer encoder is a \ngenomic bin sequence with dimensions (Sequencelength,embeddingdim)  . Specifically, \nthis dimension is (1000, 968) in EpiGePT, indicating that input genomic bin sequence \nhas a length of 1000, and each genomic bin has an embedded representation that com -\nbines the sequence information with cell-type-specific features with dimension of 968. \nFor position embedding, we employed absolute position embedding to represent the \npositional information of the 1000 genomic bins in the input 128-kbp DNA sequence, \nwith dimensions of (1000, 968). Each Transformer encoder includes a multi-head self-\nattention mechanism and a feed-forward neural network. For self-attention in each \nhead, the calculation is based on the matrix operation.\nFor multi-head attention, Transformer encoder learns parameter matrices \nW Q\ni ∈ Rdmodel×dK , W K\ni ∈ Rdmodel×dK  and W V\ni ∈ Rdmodel×dV  for the ith head and con -\ncatenate the multiple heads to do the projection, then learns parameter matrices \nW O ∈ Rnhdv×dmodel to obtain the output of multi-head attention layer.\nAttention(Q , K , V ) = softmax( QK T\n√\ndk\n)V\nQi= XW Q\ni , Ki= XW K\ni , Vi= XW V\ni\nA i = softmax( Q iK iT\n√\ndk\n)\nPage 19 of 30\nGao et al. Genome Biology          (2024) 25:310 \n \nwhere dmodel denotes the dimension of token embedding X , which is 968 in EpiGePT \nX denotes the embeddings from the sequence module for the first attention layer or \nthe output of previous attention layer. nh denotes the number of head in Transformer \nencoder, which is 8 in EpiGePT, and dK = dV = dmodel/nh = 121 . The matrix A i is called \nthe self-attention matrix for head i . The outputs of nh heads are then concatenated, and \na mapping function represented by W O is applied to obtain the output of the multi-head \nattention. After passing through an add & norm layer, the multi-head attention output \nis used as input to the feed-forward layer, where more comprehensive features of the \ninput sequence are extracted. The above describes the computational workflow of a sin -\ngle Transformer encoder layer. We set N t to 16 for the chromatin accessible prediction \nexperiments, N t to 12 for the chromatin state classification and multiple chromatin sig -\nnals prediction experiments.\nPrediction module\nFor regression model, the output layer uses a linear transformation and use mean square \nerror (MSE) as the loss function. For classification model, the output layer uses a linear \ntransformation combined with a sigmoid function, and use the cross-entropy loss for \nclassification experiments.\nTF module\nFor binding status, we scanned the input bins for potential binding sites for a set of 711 \nhuman TFs from HOCOMOCO database [63] with the tool Homer [64] (Additional \nfile 2: Table S7-S8, S10-S12, S14-S16). We then selected the maximum score of reported \nbinding status for each TF to obtain a vector of 711 dimensions as the motif feature for \neach DNA bin. For gene expression, we focused on log-transformed TPM values of the \n711 TFs and obtained a vector of 711 dimensions after quantile normalization as the \nexpression feature. With these data, we combined the two vectors of motif and expres -\nsion features by taking the element-wise product, and we concatenated the result to the \noutput of sequence module.\nModel evaluation\nTo evaluate our model, we applied five-fold cross-validation in the different experiments \non cell-type level. For chromatin accessible experiments, the 129 cell lines are parti -\ntioned into a training set and a testing set randomly.\nCell-type-wise metrics are defined to evaluate our method in different experi -\nments, which were calculated with the data within a test cell type across all genomic \nlocus. For binary classification design, we used cell-type-wise auPRC and auROC to \nevaluate our EpiGePT. Let YL×K and ˆYL×K be the true and predicted matrix, where \nL denotes the number of locus and K  denotes the number of test cell types. We cal -\nculated the auPRC and auROC for each (y1i,y2i,··· ,yLi) and (ˆy1i,ˆy2i,··· ,ˆyLi) . For \nmultiple classification, we use macro average of the auPRC and auROC to evaluate \nheadi = Attention(Q i, Ki, V i) = A iV i\nMultiHead(Q ,K ,V ) = Concat\n(\nhead1 ,···,headnh\n)\nW O\nPage 20 of 30Gao et al. Genome Biology          (2024) 25:310 \nthe classification performance, which compute the metric independently for each \nclass and then take the average hence treating all classes equally. For regression \ndesign, we used three metrics for model evaluation, which are cell-type-wise PCC, \nSCC, and prediction squared error. Prediction square error (PSR) is calculated as \nPSR = 1 − ∑\nk\n∑\nl\n(\nylk − ˆylk\n)2/\n(\nylk − y∗k\n)2 , where y∗k = ∑\nlylk/L denotes the mean of \nthe true level of the response in the cell type k.\nTo compare the performance of our method with other baseline methods, we con -\nducted hypothesis testing on the metrics based on cell types. Since the metrics on a \ngiven cell type across different methods are paired data and the statistical distribu -\ntion is unknown, we employed both Binomial and Wilcoxon tests, with the alternative \nhypothesis being that EpiGePT outperforms the other methods. If we reject the null \nhypothesis, it provides compelling evidence to support the claim that EpiGePT per -\nforms better than the other methods.\nTo evaluate the computational efficiency, we recorded the running time of a single \nepoch of EpiGePT and baseline methods (Additional file 1: Text S10). Compared to \ntraditional CNN models such as DeepCAGE [18] and ChromDragoNN [17], as well as \nlarger sequence models like Enformer, EpiGePT demonstrates a balance between high \ncomputational efficiency and performance.\nModel training strategy\nAs our proposed model is designed for cross-cell-type prediction of epigenomic signals \nby multi-task learning, some of the target epigenomic signals are missing in the existing \nENCODE database. For instance, there are 104 cellular contexts with both gene expres -\nsion and at least one of the epigenomic data. However, this number will decrease from \n104 to 28 if we consider eight epigenomic signals simultaneously. The proposed model \ntakes each cellular context and genomic region pair as a training instance, which ensures \nthe availability of a very large number of training instances. To utilize the data from the \ncellular contexts where some signals are not available (missing data), we will use a new \ntraining strategy to handle the missing data where the loss function is designed as\nwhere yi,j,k  and ˆyi,j,k  denote the kth true and predicted signal from the jth genomic bin in \nthe ith context, and I (·) is an indicator function and B i denotes the index set that contains \nall available signals in the ith context. We update the parameters in the model through \nstochastic gradient descent based on minibatches. We utilized the Adam optimizer with \na batch size of 10 and a learning rate set to 5 × 10−5. This training strategy provide us \nwith a significantly larger training sample size and allows us to utilize much more avail -\nable data from the public databases, and we enable EpiGePT to learn broader patterns of \nepigenetic states across diverse cell types. The total parameter size of EpiGePT is 71.3M, \nmaking it feasible to train and make inference even on a single GPU. A comprehensive \nbenchmark study of the computational resources used in training EpiGePT is provided \nin Additional file 1: Text S11, Additional file 2: Table S17-S19 and Additional file 1: Fig. \nS33.\nL = 1\nJ\n∑ J\nj=1\n1\n|Bi|\n∑ K\nk=1 ||yi,j,k − ˆyi,j,k||2\n2 ·I(k ∈ B i)\nPage 21 of 30\nGao et al. Genome Biology          (2024) 25:310 \n \nTransferring EpiGePT to mouse data\n The ENCODE project [21] includes a substantial amount of bulk-level epigenomic and \ngene expression experimental data for mouse. We took the DNase-seq and RNA-seq \ndata from ENCODE project as illustrative examples. Specifically, we collected the bulk \ndata from three organ-level datasets for zero-shot experiments and fine-tuning experi -\nments: brain (ENCSR000COE), lung (ENCSR000CNM), and kidney (ENCSR000CNG). \nFor DNase-seq data, we annotated the chromatin openness in genomic regions using \nOpenAnnotate [24, 25]. The foreground openness in these three organs was anno -\ntated on the regions based on the corresponding narrow peak files (ENCFF941CCB, \nENCFF268DLZ, and ENCFF587XGH), from which genomic regions were selected for \nprediction. Then, each peak was extended to a fixed length centered on the original peak \ncenter. After processing, we obtained 247,750 peaks for brain data, 243,900 peaks for \nlung data, and 180,400 peaks for kidney data. For RNA-seq data, we used RNA-seq data \nfrom the same samples (ENCFF455OZW, ENCFF641SMI, and ENCFF876OPZ), with \nTPM values representing the expression levels of corresponding TFs. For TF binding \nstatus, due to the high conservation of TF binding between humans and mouse, we uti -\nlized the same homer tool [64] and motif database with human to scan for TF binding \nstatus on peaks. We identified 688 corresponding TFs in mouse RNA-seq data using the \ngene annotation file (vM25) from the GENCODE project (https://www.gencodegenes.\norg) from the 711 selected TFs of humans, while the expression values of the remaining \nTFs were set to zero. A more detailed description of the necessary conditions based and \ndata preparation is provided in Additional file 1: Text S9.\nIncorporation of 3D chromatin interaction data\n With the emergence of methodologies like Hi-C and HiChIP for genome-wide chro -\nmatin interaction measurement, a substantial volume of 3D chromatin interaction \ndata has been produced across various cellular contexts. Clearly, this data can provide \nhighly valuable information for identifying functional elements in the genome and for \nunderstanding gene regulation, but this information has not been captured by current \ngenomic LLMs such as the Enformer [16] or earlier CNN-based genomic models [5, 17, \n18, 65]. \n We propose here to exploit the self-attention weights of the transformer model to \ndesign a learning strategy that would allow EpiGePT to capture interaction informa -\ntion from Hi-C or HiChIP data. Specifically, we propose to use the ground truth 3D \ngenome interaction to guide the self-attention matrices in the transformer module \nduring the training process. First, we obtained loop information at 5k resolution from \nthe HiChIPdb database [31]. Given potential noise within HiChip data, we selectively \nfiltered potential H3K27ac-based HiChip loops using a stringent q-value threshold \nof 0.001. This curation aimed to utilization of highly confident loops, safeguarding \nthe model’s ability to capture regulatory information without interference from noise. \nIn this way, we acquired corresponding HiChip loop data for 13 out of 104 cell types. \nNext, we mapped these loops onto the genomic bins used for pre-training. Specifically, \nwe employed the normalized count as a metric to gauge the likelihood score for each \nloop. During the mapping process, we aggregated all loops based on this score to each \nPage 22 of 30Gao et al. Genome Biology          (2024) 25:310 \nspecific genomic bin, and then we obtained the HiChIP interaction matrix  H i Based on \nthe self-attention matrix  A i\np,q ∈ R J×J and the HiChIP interaction matrix H i from the ith \ncell type/tissue where p, q are indexes for transformer layer and multi-heads, we apply \na row-wise normalization to H i (row sum to 1) to obtain ˜H i and average the self-atten -\ntion matrices across the heads in the last transformer layers to obtain ˜A i . Since elevated \nattention weights are expected between regions that interacts in 3D, we will compute \na new loss term CSL, which is defined as cosine similarity loss between the rows of ˜H i \nand ˜A i . Through the guidance of 3D genome interaction data, our approach can learn \na more comprehensive model for gene regulation. For example, it will enable predic -\ntion of cell-type-specific enhancer-promoter interaction, which is a task beyond current \nmodels such as the Enformer. Note that the CSL term does not alter the architecture \nof the model. It simply put some soft constraints on the attention weights according to \nthe experimental data on chromatin interactions, so that the optimized model will give \npredictions that are more consistent with the context-specific interaction data. For the \nresults in Fig.  3, the weight α for 3d genome loss during training EpiGePT-3D was cho -\nsen as 2.\nFine‑tuning for predicting E‑P interaction\nFor the fine-tuning process, we kept the parameters of the pre-trained model fixed with-\nout making any updates. For the specific fine-tuning task of chromatin interaction pre -\ndiction based on HiChIP data, the multi-task prediction module was replaced with a \ntwo-layer MLP network, containing 256 hidden nodes for each layer. During the training \nprocess, only the weights in the MLP network in the prediction module were updated. \nNotably, when utilizing HiChIP data at a resolution of 5 k, both the enhancer and pro -\nmoter anchors spanned 5 kbp. Then we use a region extending 128 kbp from the center \nof the anchor of the neighboring gene, as input region for EpiGePT. Consequently, a \n968-dimensional feature vector for each genomic bin was derived from the output of \nthe last transformer encoder layer. These feature vectors from all bins within the two \nanchors were concatenated, resulting in a high-dimensional vector of size 76,472. To \nensure the fairness of validating EpiGePT-finetune in capturing E-P interaction relation-\nships, we fine-tuned the model separately on the HiChIP data of each cell line during \nthe fine-tuning process. The test cell lines K562 and GM12878 were excluded from the \npretrained EpiGePT training cell types.\nBaseline methods\nFour baselines were introduced for epigenetic signals prediction. BIRD [19] is a multiple \nlinear regression model that only takes gene expression data as input and makes predic -\ntions on a fixed locus. ChromDragoNN [17] is a deep neural network that takes gene \nexpression of 1630 TFs and DNA sequence as input. Specifically, ChromDragoNN [17] \nuses a ResNet [66] to extract sequence features and use linear transformation to com -\nbine the TF gene expression feature and sequence feature to make the final prediction. \nDeepCAGE [18] is a deep densely connected convolutional network for predicting chro -\nmatin accessibility. Enformer [16] is a deep neural network that integrates convolutional \nneural network and transformer, and only takes DNA sequence as input. Enformer takes \nDNA sequence of length 196 kbp as input to predict 5313 genomic tracks of human and \nPage 23 of 30\nGao et al. Genome Biology          (2024) 25:310 \n \n1643 tracks of mouse genome simultaneously. Enformer can only model and predict cell \ntypes in the training data and cannot be applied to new cell types. In order to ensure \nfairness in some of the benchmark experiment, we retrained the Enformer model with \nthe same input and output data as EpiGePT with Pytorch-lightning and made modifica -\ntions on the number of encoder layers when reproduce the Enformer model (Supple -\nmentary Text S4). Besides, comparison with the pretrained Enformer model was also \nprovided in Fig.  2d where we strictly used the ENCODE experiment ID to obtain the \nmatched experiments for comparison.\nTwo baseline methods were introduced for predicting HiChIP interaction. DeepTACT \n[35] is a deep learning method for predicting 3D chromatin contacts using both DNA \nsequence and chromatin accessibility. We adopted the structure of DeepTACT [35] and \nkept the anchor length at 5 k. The input to the model consists of two anchor sequences \nrepresented as one-hot matrices and the two openness scores of the two anchors on the \ncorresponding cell type extracted from OpenAnnotate [24]. Regarding the Kmer fea -\ntures [67], K is chosen as 5 to extract sequence features. For each anchor, a vector of \ndimension 45 = 1024 was obtained. Further training was performed using an MLP with \na hidden layer dimension of 256.\nPrediction of 3D genome interaction\nWe collected cis-regulatory elements-gene pairs in K562 cells from other studies and \npublic database to demonstrate the interpretability of self-attention mechanisms in \nthe EpiGePT. Enhancers and silencers are typical cis-regulatory elements known play \nimportant roles in transcriptional control during normal development and disease. For \nenhancers, we downloaded enhancer-gene pairs from two studies: Gasperini et al. [27] \nand Fulco et  al. [28], both of which were tested using a CRISPRi [26] assay perturba -\ntion. Two datasets contain 664 and 5091 element-gene interactions. For silencers, we \nobtained and random sampled 831 validated silencers-gene pairs with distance within 64 \nkbp in K562 cells curated from high-throughput experiments from SilencerDB [29]. As \nthere are no experimentally validated interaction relationships between these silencers \nand genes, we generated silencer-gene pairs by associating the nearest neighbor genes \nfor classification purposes. Similarly, negative samples were generated by construct -\ning DNase-seq, ATAC-seq, and nearest genes using the same approach. Ultimately, we \nobtained a dataset comprising 1662 silencer-gene pairs, encompassing both positive and \nnegative instances.\nTo obtain scores for regulatory element-gene pairs, we first used the region extending \n128 kbp from the TSS of the gene as input and extracted the token where the interacting \nregulatory elements reside, so that we could filter out regulatory element-gene pairs that \nwere located further than 64 kbp apart. Subsequently, we stratified the remaining pairs \nbased on their distance. Since the positive and negative sample ratios varied across data -\nsets, we adopted different stratification strategies for different distance ranges (Fig.  3). \nNext, we averaged the attention matrices of the Transformer encoder across all layers \nand heads. The summed attention scores from other tokens to the key token containing \nthe center of the regulatory element were used as the attention score of this element-\ngene pair. This score represents the attention value that the enhancer receives in the \nregion around the TSS of the gene. We also calculated the attention score from the bin \nPage 24 of 30Gao et al. Genome Biology          (2024) 25:310 \ncontaining the center of the regulatory element to the bin containing the TSS, which \nonly slightly affects the experimental results of regulatory element prioritization.\nWe collected 5  k resolution data from the HiChIPdb (http:// health. tsing  hua. edu. cn/ \nhichi pdb) database, specifically from K562 and GM12878 cell lines. We filtered the data \nto include only loops where at least one anchor falls within a gene region. We stratified \nthe loops based on distance into three categories: 0–20 kbp, 20–40 kbp, and 40–64 kbp. \nFor each distance category, we selected 2000 positive pairs with most significant q-value. \nTo ensure consistency in the distance distribution, we selected negative pairs by fixing a \ngene and choosing anchors at equidistant locations in the opposite direction. These are \nthen used as test data to evaluate the prediction methods.\nGradient importance scores\nEpiGePT possesses the capability to assign priority rankings to transcription factors by \nutilizing GIS, taking into account specific cell types and chromatin regions. The GIS \nwere employed to identify potential functional relationships between specific TFs and \ntarget genes. Specifically, for a given TF-target gene pair, the TSS of genes were used \nas central loci, and the regions spanning 128 kbp upstream and downstream of the \nTSS were selected as input. Next, we selected bins with motif binding scores indicating \npotential binding for the given TF. For these selected bins, we calculated the GIS for the \npredictions of eight epigenomic signals, for each of 711 core TFs.\nwhere i denotes the ith TF in the set of core TFs, j denotes the jth cell type, k denotes the \nkth predicted epigenomic signal, and ζ denotes the set of genomic bins that have binding \nfor the given TF. In the calculation of the gradient, ˆyljk denotes the predicted value of the \nkth epigenomic signal by the model using the expression in the jth cell type at the lth bin. \nOn the other hand, tf ij denotes the product of the expression of ith TF in the jth cell type \nand the corresponding TF binding score.\nIf we consider the GIS for the prediction of all 8 epigenomic signals simultaneously, we \ncan prioritize the TFs by calculating their ranks based on each signal separately. Then, \nwe can calculate an integrated gradient importance score (IGIS) for each TF by averag -\ning the ranks from all 8 signals.\nBoth the GIS and the IGIS are capable of capturing the significance of a transcription \nfactor (TF) in regulating a specific gene within the context of a specific cell type. Conse -\nquently, these scores hold potential value in the discovery of TFs that play crucial roles \nin the regulation of specific genes, thereby contributing to our understanding of essen -\ntial regulatory mechanisms.\nIn the context of validating TF-TG pairs in the GRNdb and TRRUST databases, we \nopted to utilize liver expression data as a representative example due to the unavailabil -\nity of cell type information for TRRUST. Furthermore, in this experimental setup, the tf ij \nGIS ijk = 1\n|ζ|\n∑\nl∈ζ\n|∂ˆyljk\n∂tfij\n|\nIGISij = 1\n8\n∑\nk\nrank (GIS ijk)\nPage 25 of 30\nGao et al. Genome Biology          (2024) 25:310 \n \ndenotes the expression of ith TF in the jth cell type and ζ denotes the set of genomic bins \nthat have binding for the TF of the given TF-target gene pair.\nPotential TF‑target gene pairs from ChIP‑seq data\nIn this study, we utilized three distinct cell types to conduct a comprehensive screening \nof TF-target gene pairs and non-target gene pairs across the human genome. Initially, \nwe obtained the narrow peak files (ENCFF388AJH, ENCFF717IXP , and ENCFF885KLR) \nfrom ChIP-seq experiments across three cell types from the ENCODE project. Subse -\nquently, we examined the number of peaks within a 128-kbp region both upstream and \ndownstream of the TSS for each gene. Different thresholds were applied to the ChIP-seq \ndata of various TFs. Genes lacking any peaks within the defined region were classified \nas non-target genes, while genes surpassing the threshold in terms of peak counts were \ndesignated as target genes. Specifically, for the aforementioned three cell types, thresh -\nold values of 10, 15, and 6 were respectively employed. Finally, the IGIS approach was \nemployed to determine the corresponding ranks of TFs in the TF-target gene pairs.\nPathogenic SNP prioritization\nWe collected single-nucleotide polymorphisms (SNPs) data from the ClinVar and ExAC \ndatabases, which include both potentially pathogenic and benign SNPs. To evaluate the \nability of EpiGePT to predict variant effects, we computed the log-ratio scores (LOS) \nfor multiple chromatin signals using EpiGePT on these SNPs. Subsequently, we utilized \nthese scores to distinguish between pathogenic and benign SNPs. The LOS for each \nchromatin signal was defined by computing a forward pass through the model using the \nreference and alternative alleles.\nwhere Iref  denotes the input DNA sequence based on the reference genome, and Ialt \ndenotes the input DNA sequence containing variants. Each chromatin epigenomic pro -\nfile in each cell line or tissue predicted by EpiGePT can be used to compute a specific \nvariant score. We did not take the absolute value in this calculation, so the resulting LOS \nindicates the direction of change in the model output after the appearance of the vari -\nant. In addition to the predicted chromatin signals output by the eight models, attention \nscore changes based on self-attention are also noteworthy. We computed the log-ratio \nscores for attention by summing the attention scores of the 10 bins upstream and down-\nstream of the locus of the SNP , to evaluate the effect of the variant.\nwhere i represents the index of the neighboring bins relative to the locus of the SNP . \nTo avoid the variant effects of different bins from cancelling each other out during the \nsummation process, we computed the absolute value of the change in attention scores \nfor each bin and then summed the scores of the 10 adjacent bins centered at the SNP \nposition. For the classification of pathogenic SNPs, we calculated these nine LOS for \n�O signal = log( output (Ialt)\noutput\n(\nIref\n) )\n�O attention =\n5∑\ni=−5\n|log\n(\nattn(bini)I(alt)\nattn(bini)I(ref)\n)\n|\nPage 26 of 30Gao et al. Genome Biology          (2024) 25:310 \nattention separately for each of the 28 tissues or cell lines in training data. As a result, \nwe obtained a feature vector of 252 dimensions for each SNP . Then a classifier with 252 \nfeatures computed by EpiGePT and 52 annotations from CADD score as inputs are used \nto predict pathogenic SNPs against benign or likely benign SNPs. Here, we employed \nMLP as classifier to validate the effectiveness of the features we obtained. A five-fold \ncross-validation experiment is employed for validation, and we utilize two different pos -\nitive-to-negative sample ratios, namely 1:1 and 1:2. For each sample ratio, we randomly \nsample 32,000 positive samples. The effectiveness of the variant score in identifying \npathogenic SNPs is evaluated using the area under the auROC and the auPRC. Addition-\nally, we also utilized the logistic regression (LR) as the classifier, consistent with the LR \nclassifier used in CADD, and found a similar improvement when predicting pathogenic \nSNPs.\nCOVID‑19‑associated SNPS prioritization\nWe applied the same method to calculate the LOS of the 8 epigenomic signals for the \nCOVID-19 GWAS data. The absolute values of the scores were summed as the overall \nscore for each SNP . Then, we use the absolute sum as the effect score of the SNP and \nprioritize the COVID-19-associated SNPs based on this score. For each significant SNP \nassociated with COVID-19 severity obtained from the GWAS data, we selected normal \nSNPs within a 128-kb region around the SNP as background to calculate the rank of the \nLOS for the COVID-19 associated SNP in this region. Furthermore, we calculated the \nLOS for all 9484 COVID-19 associated SNPs and ranked them accordingly. The top 10 \nSNPs with the highest LOS were selected, which are considered to have potential genetic \nassociations with COVID-19 severity and complications.\nGTEx classification\nWe collected eQTL data from the supplementary materials of Wang et al. [42]. In their \nstudy, the authors identified causal eQTLs through statistical fine-mapping, using a pos -\nterior inclusion probability (PIP) threshold of > 0.9 for putative causal variants based on \nexpression modifier score (EMS), and a PIP threshold of < 0.9 for putative non-causal \nvariants. To validate the ability of EpiGePT to distinguish potential causal variants, we \nperform a classification task on these variants. For each variation, 128-kbp sequence \nregions near it were selected as the input of the model, and a score of variation was given \nby EpiGePT model. For each variant under each tissue, we can obtain an 8-dimensional \nvector of genomic features including DNase, CTCF, and other ChIP-seq signals. Based \non the LOS, separate random forest classifiers consisting of 10 decision trees are trained \nfor each tissue in order to distinguish between causal and non-causal variants. The mod-\nels are evaluated using fivefold validation on each tissue, with area under the auPRC \nand auROC as metrics for assessing their ability to distinguish between causal and non-\ncausal variants. \nSupplementary Information\nThe online version contains supplementary material available at https:// doi. org/ 10. 1186/ s13059- 024- 03449-7.\nAdditional file 1: Text S1: Data splitting strategy for model training. Text S2: Data processing for ChromHMM annota-\ntion data. Text S3: Details of the comparison matrix in functional chromatin status prediction experiments. Text S4: \nPage 27 of 30\nGao et al. Genome Biology          (2024) 25:310 \n \nImplementation of Enformer model and Enformer+. Text S5: Description and comparison of EpiGePT with different \nsettings. Text S6: Guidance on how to use EpiGePT in two scenarios without tissue-specific TFs data. Text S7: System \ndesign and implementation of the web server. Text S8: Case application of the EpiGePT-online. Text S9: Conditions \nand data preparation for retraining the EpiGePT model on other species. Text S10: Running time of the EpiGePT and \nbaseline methods. Text S11: Computational resources used to train the model. Fig S1: Model architecture of EpiGePT \nfor multiple epigenomic signals prediction. Fig. S2: Three data partitioning strategies for model training and testing. \nFig. S3: EpiGePT’s performance in predicting DNase-seq and other epigenetic signals. Fig. S4: Comparison of cross-\ncell-type chromatin accessibility (DNase-seq profiles) prediction performance between EpiGePT and baseline meth-\nods. Fig. S5: Performance of EpiGePT and baseline methods on chromatin states classification and causal variants \nclassification. Fig. S6: The average predictive performance of the remaining methods when each model serves as the \nground truth. Fig. S7: The performance comparison of retrained Enformer with different numbers of encoder layers \nfor predicting chromatin accessibility. Fig. S8: Performance of EpiGePT in cross-cell-type prediction. Fig. S9: Zero-shot \nlearning of EpiGePT on chromatin accessibility (DNase-seq) prediction on mouse data. Fig. S10: Model fine-tuning \nEpiGePT on chromatin accessibility (DNase-seq) prediction on mouse data. Fig. S11: The cross-chromosome predic-\ntive performance of pretrained EpiGePT and EpiGePT-seq after fine-tuning on mouse data. Fig. S12: The performance \n(auROC) of attention score of EpiGePT in distinguishing regulatory element-gene pairs at different distance ranges. \nFig. S13: Incorporating 3D genomic information from HiChip data enhances the predictive performance of EpiGePT \non E-P regulatory interaction on K562 cell line. Fig. S14: The fine-tuning performance of the EpiGePT model on \npredicting potential enhancer-promoter regulatory networks. Fig. S15: The ROC and PR curves of the EpiGePT model \non predicting potential enhancer-promoter regulatory networks. Fig. S16: Comparison of the performance between \nfine-tuned EpiGePT-3D, EpiGePT and baseline methods in predicting HiChIP loops (ROC curves). Fig. S17: Com-\nparison of the performance between fine-tuned EpiGePT-3D, EpiGePT and baseline methods in predicting HiChIP \nloops (PR curves). Fig. S18: The performance comparison of original Enformer with EpiGePT and EpiGePT-3D on 78 \ngenomic tracks. Fig. S19: The GIS of ChIP-seq overlapped bins versus non-overlapped bins of POU5F1 centered at the \nTSS of ESRRB. Fig. S20: Gene ontology enrichment analysis based on the top 5% TFs with high expression in ESCs. Fig. \nS21: Enrichment result (Cellular component and Molecular function) of the nearest genes of the COVID-19 associ-\nated SNPs with the low LOS. Fig. S22: Ablation analysis of the EpiGePT model. Fig. S23: The simulation evaluated the \nchanges in PCC for cross-cell type predictions under different numbers of missing TF profiles with three replace-\nment strategies. Fig. S24: In three sets of similar cell types, the changes in predictive performance of eight types of \nepigenomic signals were simulated under different replacement strategies (similar, mean, median) when TF profiles \nwere missing. Fig. S25: In the scenario of two TF profiles from the same cell type but different samples, the changes \nin DNase-seq predictive performance are simulated when missing TF profiles are replaced with the TF profile from a \ndifferent sample. Fig. S26: The pie charts illustrate the distribution of RNA-seq data from the ENCODE project. Fig. S27: \nThe pie charts illustrate the distribution of human and mouse single-cell RNA-seq data across various tissues from \nthe CELLxGene database. Fig. S28: The pie charts illustrate the distribution of human and mouse single-cell RNA-seq \ndata across various cell types from the CELLxGene database. Fig. S29: The Pearson correlation coefficient (PCC) for \npredicting chromatin accessibility (DNase-seq) under different numbers of training cell lines/tissues. Fig. S30: The \nSpearman correlation coefficient (SCC) for predicting chromatin accessibility (DNase-seq) under different numbers of \ntraining cell lines/tissues. Fig. S31: Case application of the EpiGePT-online. Fig. S32: The overlap between human and \nplant gene annotations from the Ensembl Plant project in terms of the 711 selected TFs. Fig. S33: The computational \nresource usage, including peak GPU memory and time for training an epoch on an NVIDIA GeForce RTX 4090.\nAdditional file 2: Table S1: Comparison of the performance between fine-tuned EpiGePT and baseline methods in \npredicting HiChIP loops on the K562 cell line (positive-to-negative sample ratio of 1:1). Table S2: Comparison of the \nperformance between fine-tuned EpiGePT and baseline methods in predicting HiChIP loops on the GM12878 cell \nline (positive-to-negative sample ratio of 1:1). Table S3: Comparison of the performance between fine-tuned EpiGePT \nand baseline methods in predicting HiChIP loops on the K562 cell line (positive-to-negative sample ratio of 1:2). \nTable S4: Comparison of the performance between fine-tuned EpiGePT and baseline methods in predicting HiChIP \nloops on the GM12878 cell line (positive-to-negative sample ratio of 1:2). Table S5: Description and comparison of \nEpiGePT with different settings. Table S6: The information of DNase-seq bam file across 129 biosamples from the \nENCODE project. Table S7: The information of RNA-seq tab-separated values (tsv) file across 129 biosamples from the \nENCODE project. Table S8: The preprocessed expression data of 711 human transcription factors from the ENCODE \nproject across 129 biosamples. Table S9: The information of DNase-seq, CTCF and other six Histone markers bam file \nacross 28 cell lines or tissues from the ENCODE project (hg19). Table S10: The information of RNA-seq tab-separated \nvalues (tsv) file across 28 cell lines or tissues from the ENCODE project (hg19). Table S11: The preprocessed expression \ndata of 711 human transcription factors from the ENCODE project across 28 cell lines or tissues (hg19). Table S12: The \ninformation of RNA-seq tab-separated values (tsv) file across 104 cell lines or tissues from the ENCODE project (hg38). \nTable S13: The information of DNase-seq, CTCF and other six Histone markers bam file across 104 cell lines or tissues \nfrom the ENCODE project (hg38). Table S14: The preprocessed expression data of 711 human transcription factors \nfrom the ENCODE project across 104 cell lines or tissues (hg38). Table S15: The order and names of epigenomes of \nthe expression matrices across 56 epigenomes from the ROADMAP project. Table S16: The preprocessed expression \ndata of 642 human transcription factors across 56 epigenomes from the ROADMAP project. Table S17: The com-\nputational resource usage, including peak GPU memory and peak RAM consumption (NVIDIA GeForce RTX 3090). \nTable S18: The computational resource usage, including peak GPU memory and peak RAM consumption (NVIDIA \nGeForce RTX 4090). Table S19: The computational resource usage, including peak GPU memory and peak RAM \nconsumption (NVIDIA RTX A6000).\nAdditional file 3: Review history.\nPage 28 of 30Gao et al. Genome Biology          (2024) 25:310 \nAcknowledgements\nNot applicable.\nReview history\nThe review history is available as Additional file 3.\nPeer review information\nThe Editorial Board Member Nicolae Radu Zabet and Wenjing She were the primary editors of this article and managed \nits editorial process and peer review in collaboration with the rest of the editorial team.\nAuthors’ contributions\nQ.L., R.J., and W.H.W. conceived and supervised the project. Z.G. and Q.L. designed and implemented the method and \nconducted experiments. Z.G. and Q.L. and W.Z. performed data analysis. Z.G. developed and built the webserver. Z.G., \nQ.L., W.Z., R.J., and W.H.W. drafted the manuscript. All authors read and approved the final manuscript.\nFunding\nQ.L. was partially supported by the National Human Genome Research Institute (NHGRI) of the National Institutes of \nHealth (NIH) under Award Number K99HG013661. Q.L., W.Z., and W.H.W. were partially supported by NIH grants R01 \nHG010359, P50 HG007735, and NSF DMS 1952386. Z.G. and R.J. were supported by the National Key Research and Devel-\nopment Program of China [2021YFF1200902; 2023YFF1204802], the Beijing Natural Science Foundation [L242026], and \nthe National Natural Science Foundation of China [62273194].\nData availability\nWe provide the detailed information of multiple chromatin signals of whole genome, motif binding status, and expres-\nsion data of 711 TFs in the corresponding cell lines/tissues, which are used in EpiGePT. Specifically, information on the \nprocessed data related to DNase-seq predictions is provided in Additional file 2: Tables S6–S8. For predictions based \non multiple epigenomic profiles using the hg19 reference genome, the processed data information is provided in \nAdditional file 2: Tables S9–S11. For predictions using the hg38 reference genome, the processed experimental data \ninformation is provided in Additional file 2: Tables S12–S14. The high-throughput validated silencers of K562 cell line \nare download from SilencerDB (http:// health. tsing hua. edu. cn/ silen cerdb) database [29]. The HiChIP data for training \nEpiGePT-3D and E-P interaction prediction are downloaded from HiChIPdb (http:// health. tsing hua. edu. cn/ hichi pdb) \ndatabase (FitHiChIP 5 k loops) [31]. The processed DNase-seq peak and ATAC-seq peak data are obtained from the \nSilencerDB (http:// health. tsing hua. edu. cn/ silen cerdb/ analy sis. php). Enhancer-gene pairs of CRISPRi [28] experiments \nare obtained from the supplementary information of Gasperini et al. [27] and Fulco et al. [28]. The regulatory network \ndata for transcription factors and target genes were obtained from the TRRUST [40] database (https:// www. grnpe dia. \norg/ trrust/) and the GRNdb [39] database (http:// www. grndb. com). The annotated chromatin states for whole genome \nare downloaded from the ROADMAP epigenomics project (https:// egg2. wustl. edu/ roadm ap/ web_ portal/ chr_ state_ \nlearn ing. html) [68]. The RNA-seq read counts matrix for protein coding genes (Additional file 2: Table S15-S16) used for \nthe prediction of the chromatin 15-states annotated by ChromHMM are downloaded from the ROADMAP [68] project \n(https:// egg2. wustl. edu/ roadm ap/ data/ byDat aType/ rna/ expre ssion/ 57epi genom es.N. pc. gz). The eQTL data are collected \nfrom the supplementary data 3 of Wang et al. [42]. The GWAS data of COVID-19 are download from the Release 4 of \nCOVID-19 Host Genetics Initiative [47] (https:// www. covid 19hg. org/). In the section of regulatory relationships between \nTFs and target genes, the DNase-seq data for mouse are obtained from the ENCODE project [21] (ENCSR000COE, \nENCSR000CNM, ENCSR000CNG), the narrow peak files are obtained from the ENCODE project [21] (ENCFF941CCB, \nENCFF268DLZ, ENCFF587XGH), and the RNA-seq data also came from the ENCODE project [21] (ENCFF455OZW, ENCFF-\n641SMI, ENCFF876OPZ). In the ablation experiments addressing missing TFs, the expression data from different samples \nwere sourced from the ENCODE project [21] (ENCSR029FTY, ENCSR410DUZ, ENCSR899SWV, ENCSR436ZKE). We also \nprovide the processed data for model training and pretrained models at the download page of EpiGePT-online (http:// \nhealth. tsing hua. edu. cn/ epige pt/ downl oad. php). The code of EpiGePT is freely available at GitHub (https:// github. com/ \nZjGao thu/ EpiGe PT) [69] and Zenodo [70] under the MIT license.\nDeclarations\nEthics approval and consent to participate\nNot applicable.\nConsent for publication\nNot applicable.\nCompeting interests\nThe authors have declare that they have no competing interests.\nReceived: 27 March 2024   Accepted: 28 November 2024\nReferences\n 1. Preissl S, Gaulton KJ, Ren B. Characterizing cis-regulatory elements using single-cell epigenomics. Nat Rev Genet. \n2023;24:21–43.\n 2. O’Malley RC, Huang S-sC, Song L, Lewsey MG, Bartlett A, Nery JR, Galli M, Gallavotti A, Ecker JR. Cistrome and epicis-\ntrome features shape the regulatory DNA landscape. Cell. 2016;165:1280–92.\nPage 29 of 30\nGao et al. Genome Biology          (2024) 25:310 \n \n 3. Vandereyken K, Sifrim A, Thienpont B, Voet T. Methods and applications for single-cell and spatial multi-omics. Nat \nRev Genet. 2023;24:1–22.\n 4. Wang KC, Chang HY. Epigenomics: technologies and applications. Circ Res. 2018;122:1191–9.\n 5. Zhou J, Troyanskaya OG. Predicting effects of noncoding variants with deep learning–based sequence model. Nat \nMethods. 2015;12:931–4.\n 6. Xu C, Liu Q, Zhou J, Xie M, Feng J, Jiang T. Quantifying functional impact of non-coding variants with multi-task Bayesian \nneural network. Bioinformatics. 2020;36:1397–404.\n 7. Liu Q, Gan M, Jiang R. A sequence-based method to predict the impact of regulatory variants using random forest. BMC \nSyst Biol. 2017;11:7.\n 8. Chen KM, Wong AK, Troyanskaya OG, Zhou J. A sequence-based global map of regulatory activity for deciphering \nhuman genetics. Nat Genet. 2022;54:940–9.\n 9. Sahu B, Hartonen T, Pihlajamaa P , Wei B, Dave K, Zhu F, Kaasinen E, Lidschreiber K, Lidschreiber M, Daub CO, et al. \nSequence determinants of human gene regulatory elements. Nat Genet. 2022;54:283–94.\n 10. Liu Q, Xia F, Yin Q, Jiang R. Chromatin accessibility prediction via a hybrid deep convolutional neural network. Bioinfor-\nmatics. 2018;34:732–8.\n 11. Song S, Cui H, Chen S, Liu Q, Jiang R. EpiFIT: functional interpretation of transcription factors based on combination of \nsequence and epigenetic information. Quant Biol. 2019;7:233–43.\n 12. Wang J, Cheng Z, Yao Q, Liu L, Xu D, Hu G. Bioinformatics and biomedical informatics with ChatGPT: year one review. \nQuant Biol. 2024;12:345–59.\n 13. Zhang S, Fan R, Liu Y, Chen S, Liu Q, Zeng W. Applications of transformer-based language models in bioinformatics: a \nsurvey. Bioinform Adv. 2023;3:vbad001.\n 14. Ji Y, Zhou Z, Liu H, Davuluri RV. DNABERT: pre-trained bidirectional encoder representations from transformers model for \nDNA-language in genome. Bioinformatics. 2021;37:2112–20.\n 15. Zhou Z, Ji Y, Li W, Dutta P , Davuluri R, Liu H. Dnabert-2: efficient foundation model and benchmark for multi-species \ngenome. arXiv preprint arXiv:2306.15006. 2023;2023–06. https:// arxiv. org/ abs/ 2306. 15006.\n 16. Avsec Ž, Agarwal V, Visentin D, Ledsam JR, Grabska-Barwinska A, Taylor KR, Assael Y, Jumper J, Kohli P , Kelley DR. Effective \ngene expression prediction from sequence by integrating long-range interactions. Nat Methods. 2021;18:1196–203.\n 17. Nair S, Kim DS, Perricone J, Kundaje A. Integrating regulatory DNA sequence and gene expression to predict genome-\nwide chromatin accessibility across cellular contexts. Bioinformatics. 2019;35:i108–16.\n 18. Liu Q, Hua K, Zhang X, Wong WH, Jiang R. DeepCAGE: incorporating transcription factors in genome-wide prediction of \nchromatin accessibility. Genomics Proteomics Bioinformatics. 2022;20:496–507.\n 19. Zhou W, Sherwood B, Ji Z, Xue Y, Du F, Bai J, Ying M, Ji H. Genome-wide prediction of DNase I hypersensitivity using gene \nexpression. Nat Commun. 2017;8:1–17.\n 20. Song L, Crawford GE. DNase-seq: a high-resolution technique for mapping active gene regulatory elements across the \ngenome from mammalian cells. Cold Spring Harbor Protocols. 2010;2010:pdb.prot5384.\n 21. Consortium EP . An integrated encyclopedia of DNA elements in the human genome. Nature. 2012;489:57.\n 22. Ernst J, Kellis M. Chromatin-state discovery and genome annotation with ChromHMM. Nat Protoc. 2017;12:2478–92.\n 23. Breschi A, Gingeras TR, Guigó R. Comparative transcriptomics in human and mouse. Nat Rev Genet. 2017;18:425–40.\n 24. Chen S, Liu Q, Cui X, Feng Z, Li C, Wang X, Zhang X, Wang Y, Jiang R. OpenAnnotate: a web server to annotate the chro-\nmatin accessibility of genomic regions. Nucleic Acids Res. 2021;49:W483–90.\n 25. Gao Z, Jiang R, Chen S. OpenAnnotateApi: Python and R packages to efficiently annotate and analyze chromatin acces-\nsibility of genomic regions.Bioinformatics. Advances. 2024;4:vbae055.\n 26. Larson MH, Gilbert LA, Wang X, Lim WA, Weissman JS, Qi LS. CRISPR interference (CRISPRi) for sequence-specific control \nof gene expression. Nat Protoc. 2013;8:2180–96.\n 27. Gasperini M, Hill AJ, McFaline-Figueroa JL, Martin B, Kim S, Zhang MD, Jackson D, Leith A, Schreiber J, Noble WS. A \ngenome-wide framework for mapping gene regulation via cellular genetic screens. Cell. 2019;176(377–390): e319.\n 28. Fulco CP , Nasser J, Jones TR, Munson G, Bergman DT, Subramanian V, Grossman SR, Anyoha R, Doughty BR, Patwardhan \nTA. Activity-by-contact model of enhancer–promoter regulation from thousands of CRISPR perturbations. Nat Genet. \n2019;51:1664–9.\n 29. Zeng W, Chen S, Cui X, Chen X, Gao Z, Jiang R. SilencerDB: a comprehensive database of silencers. Nucleic Acids Res. \n2021;49:D221–8.\n 30. Mumbach MR, Rubin AJ, Flynn RA, Dai C, Khavari PA, Greenleaf WJ, Chang HY. HiChIP: efficient and sensitive analysis of \nprotein-directed genome architecture. Nat Methods. 2016;13:919–22.\n 31. Zeng W, Liu Q, Yin Q, Jiang R, Wong WH. HiChIPdb: a comprehensive database of HiChIP regulatory interactions. Nucleic \nAcids Res. 2023;51:D159–66.\n 32. Fishilevich S, Nudel R, Rappaport N, Hadar R, Plaschkes I, Iny Stein T, Rosen N, Kohn A, Twik M, Safran M. GeneHancer: \ngenome-wide integration of enhancers and target genes in GeneCards. Database. 2017;2017:bax028.\n 33. Radford A, Narasimhan K, Salimans T, Sutskever I. Improving language understanding by generative pre-training. 2018.\n 34. Devlin J, Chang MW, Lee K, Toutanova K. Bert: pre-training of deep bidirectional transformers for language understand-\ning. arXiv preprint arXiv:1810.04805. 2018;2018–10. https:// arxiv. org/ abs/ 1810. 04805.\n 35. Li W, Wong WH, Jiang R. DeepTACT: predicting 3D chromatin contacts via bootstrapping deep learning. Nucleic Acids \nRes. 2019;47:e60–e60.\n 36. van den Berg DL, Snoek T, Mullin NP , Yates A, Bezstarosti K, Demmers J, Chambers I, Poot RA. An Oct4-centered protein \ninteraction network in embryonic stem cells. Cell Stem Cell. 2010;6:369–81.\n 37. Zhang J, Cao H, Xie J, Fan C, Xie Y, He X, Liao M, Zhang S, Wang H. The oncogene Etv5 promotes MET in somatic repro-\ngramming and orchestrates epiblast/primitive endoderm specification during mESCs differentiation. Cell Death Dis. \n2018;9:224.\n 38. Levy SH, Cohen SF, Arnon L, Lahav S, Awawdy M, Alajem A, Bavli D, Sun X, Buganim Y, Ram O. Esrrb is a cell-cycle-\ndependent associated factor balancing pluripotency and XEN differentiation. Stem Cell Reports. 2022;17:1334–50.\n 39. Fang L, Li Y, Ma L, Xu Q, Tan F, Chen G. GRNdb: decoding the gene regulatory networks in diverse human and mouse \nconditions. Nucleic Acids Res. 2021;49:D97–103.\nPage 30 of 30Gao et al. Genome Biology          (2024) 25:310 \n 40. Han H, Cho J-W, Lee S, Yun A, Kim H, Bae D, Yang S, Kim CY, Lee M, Kim E. TRRUST v2: an expanded reference database of \nhuman and mouse transcriptional regulatory interactions. Nucleic Acids Res. 2018;46:D380–6.\n 41. Willett R, Martina JA, Zewe JP , Wills R, Hammond GR, Puertollano R. TFEB regulates lysosomal positioning by modulating \nTMEM55B expression and JIP4 recruitment to lysosomes. Nat Commun. 2017;8:1580.\n 42. Wang QS, Kelley DR, Ulirsch J, Kanai M, Sadhuka S, Cui R, Albors C, Cheng N, Okada Y. Leveraging supervised learning for \nfunctionally informed fine-mapping of cis-eQTLs identifies an additional 20,913 putative causal eQTLs. Nat Commun. \n2021;12:3394.\n 43. Landrum MJ, Lee JM, Benson M, Brown G, Chao C, Chitipiralla S, Gu B, Hart J, Hoffman D, Hoover J. ClinVar: public archive \nof interpretations of clinically relevant variants. Nucleic Acids Res. 2016;44:D862–8.\n 44. Karczewski KJ, Weisburd B, Thomas B, Solomonson M, Ruderfer DM, Kavanagh D, Hamamsy T, Lek M, Samocha KE, \nCummings BB. The ExAC browser: displaying reference data information from over 60 000 exomes. Nucleic Acids Res. \n2017;45:D840–5.\n 45. Rentzsch P , Witten D, Cooper GM, Shendure J, Kircher M. CADD: predicting the deleteriousness of variants throughout \nthe human genome. Nucleic Acids Res. 2019;47:D886–94.\n 46. Li J, Lai S, Gao GF, Shi W. The emergence, genomic diversity and global spread of SARS-CoV-2. Nature. 2021;600:408–18.\n 47. org C-HGIab. The COVID-19 host genetics initiative, a global initiative to elucidate the role of host genetic factors in \nsusceptibility and severity of the SARS-CoV-2 virus pandemic. Eur J Hum Genet. 2020;28:715–8.\n 48. Wang W, Wang C-Y, Wang S-I, Wei JC-C. Long-term cardiovascular outcomes in COVID-19 survivors among non-\nvaccinated population: a retrospective cohort study from the TriNetX US collaborative networks. EClinicalMedicine. \n2022;53:101619.\n 49. Huang C, Wang Y, Li X, Ren L, Zhao J, Hu Y, Zhang L, Fan G, Xu J, Gu X. Clinical features of patients infected with 2019 \nnovel coronavirus in Wuhan China. The lancet. 2020;395:497–506.\n 50. Agius L. Targeting hepatic glucokinase in type 2 diabetes: weighing the benefits and risks. Diabetes. 2009;58:18–20.\n 51. Singh AK, Gupta R, Ghosh A, Misra A. Diabetes in COVID-19: prevalence, pathophysiology, prognosis and practical \nconsiderations. Diabetes Metab Syndr. 2020;14:303–10.\n 52. Pellegrina D, Bahcheli AT, Krassowski M, Reimand J. Human phospho-signaling networks of SARS-CoV-2 infection are \nrewired by population genetic variants. Mol Syst Biol. 2022;18: e10823.\n 53. d Galbraith E, sc Merleau N, mcdonald Smith B. The human cell count and size distribution. Proc Natl Acad Sci U S A. \n2023;120:e2303077120.\n 54. CZI Cell Science Program, Abdulla S, Aevermann B, Assis P , Badajoz S, Bell SM, Bezzi E, Cakir B, Chaffer J, Chambers S. CZ \nCELLxGENE discover: a single-cell data platform for scalable exploration, analysis and modeling of aggregated data. \nNucleic Acids Res. 2024. https:// doi. org/ 10. 1093/ nar/ gkae1 142.\n 55. Loyfer N, Magenheim J, Peretz A, Cann G, Bredno J, Klochendler A, Fox-Fisher I, Shabi-Porat S, Hecht M, Pelet T. A DNA \nmethylation atlas of normal human cell types. Nature. 2023;613:355–64.\n 56. Li S, Zeng W, Ni X, Liu Q, Li W, Stackpole ML, Zhou Y, Gower A, Krysan K, Ahuja P , et al. Comprehensive tissue decon-\nvolution of cell-free DNA by deep learning for disease diagnosis and monitoring. Proc Natl Acad Sci U S A. 2023;120: \ne2305236120.\n 57. Gao Z, Chen X, Li Z, Cui X, Jiang Q, Li K, Chen S, Jiang R. scEpiTools: a database to comprehensively interrogate analytic \ntools for single-cell epigenomic data. J Genet Gen. 2024;51:462–5.\n 58. Liu Q, Lv H, Jiang R. hicGAN infers super resolution Hi-C data with generative adversarial networks. Bioinformatics. \n2019;35:i99–107.\n 59. Liu Q, Zeng W, Zhang W, Wang S, Chen H, Jiang R, Zhou M, Zhang S. Deep generative modeling and clustering of single \ncell Hi-C data. Brief Bioinform. 2023;24:bbac494.\n 60. Yates AD, Allen J, Amode RM, Azov AG, Barba M, Becerra A, Bhai J, Campbell LI, Carbajo Martinez M, Chakiachvili M. \nEnsembl genomes 2022: an expanding genome resource for non-vertebrates. Nucleic Acids Res. 2022;50:D996–1003.\n 61. Basenko EY, Pulman JA, Shanmugasundram A, Harb OS, Crouch K, Starns D, Warrenfeltz S, Aurrecoechea C, Stoeckert CJ \nJr, Kissinger JC. FungiDB: an integrated bioinformatic resource for fungi and oomycetes. Journal of Fungi. 2018;4: 39.\n 62. Alvarez-Jarreta J, Amos B, Aurrecoechea C, Bah S, Barba M, Barreto A, Basenko EY, Belnap R, Blevins A, Böhme U. VEuPathDB: \nthe eukaryotic pathogen, vector and host bioinformatics resource center in 2023. Nucleic Acids Res. 2024;52:D808–16.\n 63. Kulakovskiy IV, Vorontsov IE, Yevshin IS, Sharipov RN, Fedorova AD, Rumynskiy EI, Medvedeva YA, Magana-Mora A, Bajic \nVB, Papatsenko DA. HOCOMOCO: towards a complete collection of transcription factor binding models for human and \nmouse via large-scale ChIP-Seq analysis. Nucleic Acids Res. 2018;46:D252–9.\n 64. Heinz S, Benner C, Spann N, Bertolino E, Lin YC, Laslo P , Cheng JX, Murre C, Singh H, Glass CK. Simple combinations of \nlineage-determining transcription factors prime cis-regulatory elements required for macrophage and B cell identities. \nMol Cell. 2010;38:576–89.\n 65. Kelley DR, Reshef YA, Bileschi M, Belanger D, McLean CY, Snoek J. Sequential regulatory activity prediction across chro-\nmosomes with convolutional neural networks. Genome Res. 2018;28:739–50.\n 66. He K, Zhang X, Ren S, Sun J. Deep residual learning for image recognition. In: Proceedings of the IEEE conference on \ncomputer vision and pattern recognition (CVPR). 2016. p. 770–8. https:// doi. org/ 10. 1186/ s13059- 022- 02799-4.\n 67. Chor B, Horn D, Goldman N, Levy Y, Massingham T. Genomic DNA k-mer spectra: models and modalities. Genome Biol. \n2009;10:1–10.\n 68. Bernstein BE, Stamatoyannopoulos JA, Costello JF, Ren B, Milosavljevic A, Meissner A, Kellis M, Marra MA, Beaudet AL, \nEcker JR. The NIH roadmap epigenomics mapping consortium. Nat Biotechnol. 2010;28:1045–8.\n 69. Gao Z, Liu Q, Zeng W, Jiang R, Wong WH. EpiGePT: a pretrained transformer-based language model for context-specific \nhuman epigenomics. GitHub. 2024. https:// github. com/ ZjGao thu/ EpiGe PT.\n 70. Gao Z, Liu Q, Zeng W, Jiang R, Wong WH. EpiGePT: a pretrained transformer-based language model for context-specific \nhuman epigenomics. Zenodo. 2024. https:// doi. org/ 10. 5281/ zenodo. 14201 753.\nPublisher’s Note\nSpringer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.",
  "topic": "Epigenomics",
  "concepts": [
    {
      "name": "Epigenomics",
      "score": 0.8763718008995056
    },
    {
      "name": "Genomics",
      "score": 0.5284557342529297
    },
    {
      "name": "Biology",
      "score": 0.5279117226600647
    },
    {
      "name": "Computer science",
      "score": 0.5157694816589355
    },
    {
      "name": "Chromatin",
      "score": 0.5157323479652405
    },
    {
      "name": "Computational biology",
      "score": 0.4928140938282013
    },
    {
      "name": "Context (archaeology)",
      "score": 0.4587881565093994
    },
    {
      "name": "Artificial intelligence",
      "score": 0.41356968879699707
    },
    {
      "name": "Machine learning",
      "score": 0.36270463466644287
    },
    {
      "name": "Genome",
      "score": 0.32062458992004395
    },
    {
      "name": "DNA methylation",
      "score": 0.2107788324356079
    },
    {
      "name": "Gene",
      "score": 0.18919962644577026
    },
    {
      "name": "Genetics",
      "score": 0.18260207772254944
    },
    {
      "name": "Gene expression",
      "score": 0.11381915211677551
    },
    {
      "name": "Paleontology",
      "score": 0.0
    }
  ],
  "institutions": [
    {
      "id": "https://openalex.org/I99065089",
      "name": "Tsinghua University",
      "country": "CN"
    },
    {
      "id": "https://openalex.org/I97018004",
      "name": "Stanford University",
      "country": "US"
    }
  ]
}