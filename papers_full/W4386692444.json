{
  "title": "SiGra: single-cell spatial elucidation through an image-augmented graph transformer",
  "url": "https://openalex.org/W4386692444",
  "year": 2023,
  "authors": [
    {
      "id": "https://openalex.org/A2824693967",
      "name": "Tang Ziyang",
      "affiliations": []
    },
    {
      "id": null,
      "name": "Li, Zuotian",
      "affiliations": [
        "Indiana University School of Medicine",
        "Indiana University"
      ]
    },
    {
      "id": "https://openalex.org/A2267236750",
      "name": "Hou TieYing",
      "affiliations": [
        "Indiana University",
        "Indiana University School of Medicine"
      ]
    },
    {
      "id": "https://openalex.org/A2364357589",
      "name": "Zhang Tong-lin",
      "affiliations": []
    },
    {
      "id": "https://openalex.org/A2645865736",
      "name": "Yang Baijian",
      "affiliations": []
    },
    {
      "id": "https://openalex.org/A2100274854",
      "name": "Su Jing",
      "affiliations": [
        "Indiana University School of Medicine",
        "Indiana University"
      ]
    },
    {
      "id": "https://openalex.org/A2338862789",
      "name": "Song, Qianqian",
      "affiliations": [
        "Florida College",
        "Wake Forest University",
        "University of Florida"
      ]
    }
  ],
  "references": [
    "https://openalex.org/W4286005528",
    "https://openalex.org/W4220765701",
    "https://openalex.org/W4210853280",
    "https://openalex.org/W4302362633",
    "https://openalex.org/W2123273050",
    "https://openalex.org/W4283718372",
    "https://openalex.org/W2612639002",
    "https://openalex.org/W2808465642",
    "https://openalex.org/W2889453805",
    "https://openalex.org/W3164692211",
    "https://openalex.org/W6784195601",
    "https://openalex.org/W3032266082",
    "https://openalex.org/W3165120573",
    "https://openalex.org/W3108118546",
    "https://openalex.org/W4220875172",
    "https://openalex.org/W4311684329",
    "https://openalex.org/W3146366485",
    "https://openalex.org/W3187966659",
    "https://openalex.org/W3173255621",
    "https://openalex.org/W1990194638",
    "https://openalex.org/W1958171619",
    "https://openalex.org/W3005119354",
    "https://openalex.org/W1965263024",
    "https://openalex.org/W4285011607",
    "https://openalex.org/W2148159408",
    "https://openalex.org/W1016059894",
    "https://openalex.org/W80748578",
    "https://openalex.org/W1993112045",
    "https://openalex.org/W1560424863",
    "https://openalex.org/W2609076594",
    "https://openalex.org/W2996106944",
    "https://openalex.org/W2004051408",
    "https://openalex.org/W1523219874",
    "https://openalex.org/W2894687190",
    "https://openalex.org/W2773035279",
    "https://openalex.org/W1979283544",
    "https://openalex.org/W1973143344",
    "https://openalex.org/W3173175410",
    "https://openalex.org/W2755615752",
    "https://openalex.org/W1974881805",
    "https://openalex.org/W4212921746",
    "https://openalex.org/W3008188998",
    "https://openalex.org/W3126958162",
    "https://openalex.org/W3125011419",
    "https://openalex.org/W3210155372",
    "https://openalex.org/W4229033508",
    "https://openalex.org/W3167327839",
    "https://openalex.org/W3191029526",
    "https://openalex.org/W3009352878",
    "https://openalex.org/W2912006845",
    "https://openalex.org/W2992853034",
    "https://openalex.org/W6739901393",
    "https://openalex.org/W2897249806",
    "https://openalex.org/W3171488579",
    "https://openalex.org/W4220675433",
    "https://openalex.org/W6969257833",
    "https://openalex.org/W4226192560",
    "https://openalex.org/W3106188259",
    "https://openalex.org/W2800392236"
  ],
  "abstract": null,
  "full_text": "Article https://doi.org/10.1038/s41467-023-41437-w\nSiGra: single-cell spatial elucidation through\nan image-augmented graph transformer\nZiyang Tang 1,Z u o t i a nL i2,3,T i e y i n gH o u4, Tonglin Zhang5, Baijian Yang1 ,\nJing Su 2 & Qianqian Song 6,7\nRecent advances in high-throughput molecular imaging have pushed spatial\ntranscriptomics technologies to subcellular resolution, which surpasses the\nlimitations of both single-cell RNA-seq and array-based spatial proﬁling. The\nmultichannel immunohistochemistry images in such data provide rich infor-\nmation on the cell types, functions, and morphologies of cellular compart-\nments. In this work, we developed a method, single-cell spatial elucidation\nthrough image-augmented Graph transformer (SiGra), to leverage such ima-\nging information for revealing spatialdomains and enhancing substantially\nsparse and noisy transcriptomics data. SiGra applies hybrid graph transfor-\nmers over a single-cell spatial graph. SiGra outperforms state-of-the-art\nm e t h o d so nb o t hs i n g l e - c e l la n ds p o t - l evel spatial transcriptomics data from\ncomplex tissues. The inclusion of immunohistochemistry images improves the\nmodel performance by 37% (95% CI: 27– 50%). SiGra improves the character-\nization of intratumor heterogeneityand intercellular communication and\nrecovers the known microscopic anatomy. Overall, SiGra effectively integrates\ndifferent spatial modality data to gaindeep insights into spatial cellular\necosystems.\nRecent advances in spatial molecular imaging have allowed for the\nexamination of the spatial landscapes and transcriptional proﬁles of\ncomplex tissues at subcellular resolution1– 3. The interrogation of the\nspatial locations and gene expression of individual cells within a tissue\naid in understanding the spatial heterogeneity of cell-to-cell commu-\nnication and cell interactions with the surrounding environment,\nwhich are crucial for understanding disease pathology. Current com-\nmercially available technologies for single-cell spatial proﬁling, such as\nthe NanoString CosMx™ Spatial Molecular Imager (SMI)\n4 and the Viz-\ngen MERSCOPE/MERFISH platforms5,6, are capable of accurately cap-\nturing the locations of targeted transcripts, cell locations, and cell\nboundaries, accompanied by multichannel immunohistochemistry\n(IHC) images. For example, NanoString CosMx™ is capable of simul-\ntaneously assaying up to 1000 genes\n4 and 100 k to 600 k cells per slide,\ndramatically exceeding current single-cell omics technologies. There-\nfore, emerging single-cell spatial transcriptomics (SCST) commercial\nplatforms are revolutionizing current spatial biology research, pro-\nmising to spatially and functionally reveal complex architectures\nwithin tissues and furthering our insights into the mechanisms\nunderlying disease at unprecedented resolution\n7– 9.\nThe emerging SCST multimodal data provide new opportunities\nfor accurately identifying spatial domains, which is crucial for reveal-\ning and functionally annotating the cellular anatomy of complex tis-\nsues. Existing methods for deciphering spatial cell clusters, such as\nSeurat\n10 and the Louvain clustering-based Scanpy11 method, still rely on\nclustering methods for nonspatial single-cell RNA-seq data and only\ntake gene expression data as input. Other methods have been devel-\noped to include spatial information to improve the identiﬁcation of\nReceived: 9 September 2022\nAccepted: 1 September 2023\nCheck for updates\n1Department of Computer and Information Technology, Purdue University, Indiana, USA.2Department of Biostatistics and Health Data Science, Indiana\nUniversity School of Medicine, Indiana, USA.3Department of Computer Graphics Technology, Purdue University, Indiana, USA.4Department of Pathology and\nLaboratory Medicine, Indiana University School of Medicine, Indiana, USA.5Department of Statistics, Purdue University, Indiana, USA.6Department of Cancer\nBiology, Wake Forest University School of Medicine, North Carolina, USA.7Department of Health Outcomes and Biomedical Informatics, College of Medicine,\nUniversity of Florida, Florida, USA.e-mail: byang@purdue.edu; su1@iu.edu; qsong@wakehealth.edu\nNature Communications|         (2023) 14:5618 1\n1234567890():,;\n1234567890():,;\nspatial regions. For example, stLearn12 leverages the gene expression\nof neighbouring spots and tissue image features to identify spatially\ndistributed clusters. BayesSpace\n13 enables spatial clustering through a\nBayesian statistical method with joint analyses of the gene expression\nmatrix and spatial neighbourhood information. SpaGCN14 identiﬁes\nspatial regions using a graph convolutional network, with the spatial\ngraph constructed from gene expression and histology information.\nAlthough these methods show their capability in spatial clustering, the\npower of different modalities within single-molecule spatial imaging\nproﬁles has not been fully unleashed to achieve desirable\nperformance.\nIn addition to domain recognition, the enhancement of spatial\ngene expression data also presents a signiﬁcant challenge. Although\ngreat progress has been made in spatial technologies, major problems\nsuch as missing values, data sparsity, low coverage, and noise\n2,15\nencountered in spatial transcriptomics proﬁles impede the effective\ntesting and elucidation of biological insights. Meanwhile, multichannel\nspatial images in single-cell spatial data consist of high-resolution,\nhigh-content features detected in the tissue, such as cell types, func-\ntions, and morphologies of cellular compartments, as well as the\nspatial distributions of cells. Incorporating such imaging features into\ntranscriptomics data processing will help address the challenges of\nmissing values and data noise. Moreover, as the spatial relations\nbetween an individual cell and its neighbouring cells can be naturally\nrepresented with a spatial adjacency graph, graph-based artiﬁcial\nintelligence is promising for spatial data modelling. Notably, graph-\nbased models enhanced with attention mechanisms\n16, such as the\ngraph attention network (GAT) and graph convolutional transformer\nmodels\n17,18, have demonstrated remarkable advancements and yielded\nsigniﬁcantly improved outcomes.\nIn this study, we developed the SiGra method, i.e., single-cell\nspatial elucidation through an image-augmented graph transformer,\nto decipher spatial domains and enhance spatial signals simulta-\nneously. SiGra can utilize multimodalities, including multichannel\nimages of cells and their niches, address technological limitations and\nachieve augmented spatial proﬁles. SiGra accurately recovers missing\ninformation in spatial gene expression, uncovers cellular dynamics,\nand reveals the spatial architecture of cellular heterogeneity within\ntissues. Through extensive and quantitative benchmarking with\nexisting methods on multiple datasets, including both single-cell level\nand spot-level spatial data generated by different platforms, SiGra\ndemonstrates superior performance in terms of spatial domain iden-\ntiﬁcation, latent embedding, and data denoising. Overall, SiGra will\ncontribute to uncovering the complex spatial architecture within\nheterogeneous tissues and facilitate the acquisition of biological\ninsights. SiGra is open-source software and is available athttps://\ngithub.com/QSong-github/SiGra, with detailed tutorials demonstrat-\ning its applications to different spatial transcriptomics platforms. The\nweb interface of the SiGra Viewer (http://sigra.sulab.io) enables users\nto explore the enhanced data in uniform manifold approximation and\nprojection (UMAP)ﬁgures and spatial domains.\nResults\nOverview of the SiGra method\nThe SiGra method includes (1) the graph representation of the original\nspatial transcriptomics data (Fig.1a) and (2) the hybrid graph trans-\nformer model to elucidate the spatial patterns and enhance the raw\ngene expression data (Fig.1b).\nThe state-of-the-art SCST data consist of: (1) multichannel images\nof biomarkers for cell types (e.g., pancytokeratin or PanCK staining for\ntumour cells, CD3 for T cells, and CD45 for leucocytes) and cell com-\npartments (e.g., DAPI staining for cell nuclei and CD298 staining for\ncell membranes). For each staining channel, a high-content greyscale\nimage is assembled from a series ofﬁeld-of-view (FOV) images; (2) the\nvendor-provided cell segmentation results such as the coordinates of\ncell centroids and the hull of cell boundaries; and (3) the cell-level\nsummarization of gene expression according to the coordinates of\neach detected transcript and the cell boundary identiﬁed from cell\nsegmentation.\nIn SiGra, the single-cell spatial graph is constructed based on the\nspatial centroids of detected cells, with each node representing a cell\nand each edge representing two neighbouring cells (Euclidian distance\nshorter than 14– 16 μm). Each node/cell within the spatial graph is\naccompanied by multimodal data (images and gene expression)\nextracted from the original spatial proﬁles. Speciﬁcally, for each cell,\nan image of 21.6μmb y2 1 . 6μm centred at the cell centroid is cropped\nfrom each immunohistochemistry (IHC) image. For example, as\nNanoString CosMx data consist ofﬁve channels (DAPI, PanCK, CD45,\nCD3, and CD298), each cell is associated withﬁve single-cell images. In\nthis way, SiGra achieves the graphical representation of spatial proﬁles,\ni.e., the single-cell spatial graph with each located cell’s multichannel\nimages and gene expression.\nThe SiGra model comprises three graph transformer-based\nencoder-decoders (imaging, transcriptomics, and hybrid) with an\nattention mechanism (Fig.1b) to incorporate the single-cell multi-\nmodal data for simultaneous data enhancement and spatial domain\nrecognition. Regarding the imaging encoder-decoder, with a celli\nrepresented by node v\ni, an array of single-cell IHC imagesMi is\nconverted to a vectorxi and projected to the latent space aszM,i\nthrough multihead graph transformer layers (Supplementary Fig. 1a,\nMethods). This latent imaging featurezM,i then is used to reconstruct\nthe gene expression proﬁle ^gM,i of cell i. For the transcriptomics\nencoder-decoder, the same architecture is used for the latent\nrepresentation (z\ng,i) and the reconstruction (^gg,i) of the original\nexpression gi in cell i. For the hybrid encoder-decoder, the latent\nimaging features zM,i and the latent expression features zg,i are\nconcatenated and projected as a hybrid featurezh,i, which is used to\nreconstruct the gene expression ^gh,i of cell i. Imaging and gene\nexpression features of neighbouring cells, represented as neighbour\nnodes v\nj 2 N vi\n/C0/C1\nin the spatial graph, are also used as the input for\ngraph transformers so that the spatial cellular information is aggre-\ngated into the model.\nSiGra learns the reconstructed gene expression via a self-\nsupervised loss that combines the mean square error (MSE) from\ngene embedding L\nM,i, image embedding Lg,i and combined\nembedding Lh,i, with the loss function L = PN\ni =1 λ1LM,i + λ2Lg,i + Lh,i,\nwhere the hyperparametersλ1,λ2 ≥ 0, andN is the total cell number.\nAfter training, SiGra outputs the hybrid reconstruction^g = ^gh,i\n/C8/C9\nas the\nﬁnal enhanced expression proﬁle. The latent representation,z = zh,i\n/C8/C9\n,\nof the original SCST data is used for spatial data clustering.\nWith the introduced multihead attention mechanism in graph\ntransformer layers, SiGra adaptively updates the contributions of\nneighbouring cellsfv\njg to cellvi by aggregating and propagating the\nextracted image features and the gene expression features from\nneighbours, eventually updating the latent representation of cells and\nthe ﬁnal reconstructed gene expression proﬁles. Through evaluation\nand benchmarking with current available methods, SiGra demon-\nstrates exceptional performance on multiple spatial transcriptomics\ndatasets from different platforms, especially on single-cell spatial\nproﬁling. Moreover, the enhanced spatial transcriptomics data by\nSiGra facilitate insights into cellular communications and underlying\nbiological discoveries.\nSiGra accurately identiﬁes spatial domains in the single-cell\nspatial proﬁles of NanoString CosMx SMI\nTo evaluate the performance of SiGra in deciphering spatial domains,\nwe compare it withﬁve state-of-the-art clustering methods developed\nspeciﬁcally for spatial transcriptomics: Seurat v410,S c a n p y11,s t L e a r n12,\nSpaGCN14, and BayesSpace13. For comparisons, we use the SCST data-\nset of Lung-9-1 generated by NanoString CosMx SMI. This dataset\nArticle https://doi.org/10.1038/s41467-023-41437-w\nNature Communications|         (2023) 14:5618 2\nconsists of 20 FOVs from lung cancer tumour tissue4,w i t h9 8 2g e n e s\nand 83,621 cells that cover eight major cell types, including lympho-\ncytes, neutrophils, mast cells, endothelial cells,ﬁbroblasts, epithelial\ncells, myeloid cells, and tumours. Details of these experimental data\nare provided in the Data Availability section. The identiﬁed spatial\nclusters of each method are annotated based on the matched overlap\nof spatial clusters and ground truth manually annotated in the original\nstudy\n4.\nAs described in the Methods, cell types areﬁrst identiﬁed and\nthen organized into spatial domains. With the spatially heterogeneous\ncell types identiﬁed by different methods, the spatial organization of\nt h e2 0F O V si ss h o w ni nF i g .2a. Speciﬁcally, SiGra detects the spatial\ndistributions of different cell types that agree well with the original\nstudy, i.e., ground truth, with an overall adjusted Rand index (ARI) of\n0.55, which is higher than that of Seurat (ARI = 0.37) and BayesSpace\n(ARI = 0.23). Seurat and BayesSpace signiﬁcantly mislabelled more\ncells than SiGra across the 20 FOVs. Meanwhile, the other two methods\nshow much lower accuracy (ARIs: 0.25 for Scanpy, 0.22 for SpaGCN,\nand 0.34 for stLearn). Of note, the addition of multichannel images\n(ARI = 0.59) improves the performance by 47.5% compared with using\ngene expression only as input (median ARI = 0.40). These results\ndemonstrate that multimodal spatial information contributes to the\nsuperior performance of SiGra.\nFigure 2b shows the ARI scores of all 20 FOVs. Notably, SiGra is\nshown to identify the most accurate spatial clusters of different cell\ntypes (median ARI = 0.59). Its performance is especially better than\nthat of stLearn (median ARI = 0.22) and Scanpy (mean ARI = 0.25).\nC o m p a r e dw i t hS p a G C N( m e a nA R I=0 . 2 7 ) ,S e u r a t( m e d i a nA R I=0 . 3 8 )\nand BayesSpace (mean ARI = 0.32), SiGra has relatively better perfor-\nmance with identiﬁed clusters more consistent with manual annota-\ntions. These comparison results demonstrate that SiGra improves the\nidentiﬁcation of spatial clusters compared with existing methods for\nsingle-cell spatial proﬁles.\nThe spatial clustering results are further scrutinized at the indi-\nvidual FOV level (Fig.2c). Of note, SiGra shows consistency between its\nidentiﬁed cellular identities and the ground truth, with the continuous\ntumour region inﬁltrated with scattered immune cell clusters. In con-\ntrast, BayesSpace and Seurat misidentify the cellular anatomies as\neither a mixture of fragmental cell regions (FOV-1) or as highly blended\ncell types (FOV-2). For FOV-1, BayesSpace misidentiﬁes the neutrophil\nas lymphocytes; meanwhile, it incorrectly identiﬁes some tumour cells\nas myeloid cells or neutrophils. Seurat fails to disentangle epithelial\nFig. 1 | Schematic overview of the SiGra method. aGraphical representation of\nthe spatial transcriptomics proﬁles. Each cell on the constructed spatial graph is\naccompanied by its multichannel images and gene expression.b SiGra comprises\nthree graph transformer encoder-decoders (imaging, transcriptomics, and hybrid)\nwith an attention mechanism to incorporate the single-cell multimodal data for\nsimultaneous data enhancement and spatial domain recognition.\nArticle https://doi.org/10.1038/s41467-023-41437-w\nNature Communications|         (2023) 14:5618 3\ncells from tumour cells. In FOV-2, BayesSpace misidentiﬁes ﬁbroblasts\nas a mixture of myeloid cells and lymphocytes, while Seurat mixes\nneutrophils with tumour cells without clear dissection of spatial het-\nerogeneity. These results indicate that the compared methods lack the\ncapability of deciphering major spatial regions in SCST data.\nT h ep e r f o r m a n c eo ft h es p a t i a ld o m a i n si d e n t iﬁed by summariz-\ning the detected spatially heterogeneous cell identities is shown in\nSupplementary Fig. 5. The tumour slice is pathologically annotated as\nthe tumour region (green), the desmoplasia region (red), and the\nadjacent normal region (orange). SiGra achieves an ARI of 0.60, better\nthan other methods, including BayesSpace (ARI = 0.25), SpaGCN\n(ARI = 0.10), Seurat (ARI = 0.10), stLearn (ARI = 0.10), and Scanpy\n(ARI = 0.17). These results show that SiGra identiﬁes reliable spatial\ndomains based on its accurately identiﬁed cell identities in SCST data.\nSiGra enhances gene expression patterns that distinguish\nintratumoral spatial heterogeneity\nSiGra enhances the spatial gene expression data and improves down-\nstream analysis for unveiling biological relevance. Herein, we perform\nUMAP on raw data and enhanced data (Fig.3a and Supplementary\nFig. 1b). Apparently, the enhanced data reveal better data topology\nwith different cell types better separated in the UMAP results. More-\nover, the enhanced cell type-speciﬁc gene markers show prevalently\nconsistent expression in their corresponding cell types (Fig.3b). For\nexample, the enhancedﬁbroblast marker geneDCN\n19 demonstrates\nuniform high expression inﬁbroblasts and low expression in other cell\ntypes. In contrast, in raw data,DCN presents sporadic expression in\nﬁbroblasts but is highly expressed in other nonﬁbroblasts. Thus, SiGra\nnot only denoises false-positive expressions (e.g.,DCN expression in\nnonﬁbroblasts) and extreme values but also imputes missing values\n(e.g., missing values ofDCN expression in ﬁbroblasts). Meanwhile,\nSiGra-enhanced data exhibit topological expression of cell type-\nspeciﬁc markers (Fig.3c). For example, after enhancement,CD68\n20\nand MGP21 show elevated expression in myeloid- and endothelial cell-\nenriched regions, respectively. The tumour-speciﬁc genes EPCAM22,\nSOX423,a n dKRT724 show strong and uniform enrichment in tumour\nregions, while these genes are not captured in the raw data of some\ntumour cells (Fig.3d). In addition, the enhanced SCST data are also\nmore comparable to the bulk RNA-seq data than the raw SCST data\n(Supplementary Fig. 2a and Supplementary Note 1). These results\nGround truth SiGra\nBayesSpace Seurat\na\nb c\nLymphocytes\nNeutrophile\nMast\nEndothelial\nFibroblast\nEpithelial\nMyeloid\nTumor\nGround truth BayesSpace SeuratSiGra\nFOV-1FOV-2\nLymphocytes\nNeutrophile\nMast\nEndothelial\nFibroblast\nEpithelial\nMyeloid\nTumor\n0.2\n0.4\n0.6\n0.8 ARI\nstLearn\nscanpy\nspaGCN\nBayesSpace\nSeurat\nSiGra\nscanpy SeuratstLearn spaGCN BayesSpace SiGra\nLymphocytes\nNeutrophile\nMast\nEndothelial\nFibroblast\nEpithelial\nMyeloid\nTumor\nLymphocytes\nNeutrophile\nMast\nEndothelial\nFibroblast\nEpithelial\nMyeloid\nTumor\nGround truth BayesSpace SeuratSiGra\n200um\n400um 400um\n400um 400um\n200um\n200um\n200um\n200um\n200um\n200um\n200um\nFig. 2 | SiGra accurately identiﬁes spatial domains in the single-cell spatial\nproﬁles of NanoString CosMx SMI. aSpatial regions of ground truth and those\ndetected by different methods, including SiGra, BayesSpace, and Seurat.b Boxplot\nof the adjusted Rand index (ARI) scores of six methods in all 20 FOVs of lung cancer\ntissue. In the boxplot, the centreline, box limits and whiskers denote the median,\nupper and lower quartiles, and 1.5× interquartile range, respectively. Source data\nare provided as a Source Dataﬁle. c Spatial regions of two FOVs detected by\ndifferent methods, including SiGra, BayesSpace, and Seurat.\nArticle https://doi.org/10.1038/s41467-023-41437-w\nNature Communications|         (2023) 14:5618 4\nMedian expression\n0     1       2      3\nRaw Enhanced\nUMAP1UMAP2\nUMAP1UMAP2\nLymphocytes\nNeutrophile\nMast\nEndothelial\nFibroblast\nEpithelial\nMyeloid\nRaw\nEnhanced\na b\nc d\n0 1 23\nExpression level\nCD68 MGP DCN KRT7\nCD68 MGP DCN KRT7\nEPCAM in FOV-1EPCAM in FOV-2\n012\nExpression level\nKRT7 in FOV-1KRT7 in FOV-2SOX4 in FOV-1SOX4 in FOV-2\nRaw\nEnhanced\ne\nMyeloid\nEndothelial\nEpithelial\nFibroblast\nLymphocyte\nMast\nNeutrophil\nCD68\nCD163\nMGP\nSERPINA1\nKRT7\nDCN\nCD2\nIL17R\nSRGN\nEPCAM\nRaw Enhanced\nTumors\nCD68\nCD163\nMGP\nSERPINA1\nKRT7\nDCN\nCD2\nIL17R\nSRGN\nEPCAM\nMyeloid\nEndothelial\nEpithelial\nFibroblast\nLymphocyte\nMast\nNeutrophil\nTumors\n-log10(FDR) in raw data\n-log10(FDR) in enhanced data\nFDR > 0.05 Specific Shared 0.0250.05\n0\n1\n2\n012\nFDR = 0.05\nFDR = 0.05\nTumors\nMyeloid\nMast\nNeutrophil\nLymphocyte\nEndothelial\nLymphocyte\nNeutrophil\nMast\nEndothelial\nFibroblast\nEpithelial\nMyeloid Tumors\ng\nEpithelial\nFibroblast\nf\n400um 400um\n400um 400um\n400um\n400um 400um\n400um\n400um 400um\n400um 400um\nFig. 3 | SiGra enhances gene expression patterns that distinguish intratumoral\nspatial heterogeneity. aUMAP visualizations of raw data and the enhanced data of\nthe nontumor cell population.b Violin plots of the raw expression and the\nenhanced expression of marker genes in different cell populations (endothelial:\n4272; epithelial: 3458;ﬁbroblast: 13,368; lymphocyte: 11,664; mast: 287; M-cell:\n7560; neutrophil: 5731; tumors: 37,281).c UMAP visualization of the raw expression\nand the enhanced expression of marker genes (CD68, MGP, DCN, KRT7). d Spatial\nvisualization of the raw expression and the enhanced expression of tumour-related\ngenes (EPCAM, KRT7, SOX4) in two FOVs.e Scatter plot of signiﬁcantly associated\nligand‒receptor (L-R) pairs in the raw data and the enhanced data. Orange- and\nyellow-coloured dots represent the shared and speciﬁc L-R pairs, respectively.\nSource data are provided as a Source Dataﬁle. f Network representation of the\nweighted adjacent cell types. The edge width represents the adjacency between\ntwo cell types.g Adjacent cell communications considering both neighbouring cell\nweights and L-R interaction strength.\nArticle https://doi.org/10.1038/s41467-023-41437-w\nNature Communications|         (2023) 14:5618 5\ndemonstrate the capability of SiGra to improve gene expression data\nfor better spatial cellular characterization.\nTo further prove that the data enhanced by SiGra are useful for\ndownstream analysis, we collect a combined list of candidate ligand‒\nreceptor (L-R) pairs from the International Union of Pharmacology\n(IUPHAR)25, Connectome26,F A N T O M 526,H P R D27,t h eH u m a nP l a s m a\nMembrane Receptome (HPMR)28, and the Database of Ligand‒Receptor\nPartners (DLRP)29, which encompass 815 ligands, 780 receptors, and\n3,398 reliable L-R interaction pairs. Among them, genes of 660 L-R pairs\na r ei n c l u d e di nt h i sN a n o S t r i n gC o sMx dataset. Across the 660 total L-R\ninteractions, 55 L-R pairs of enhanced data and 42 L-R pairs of raw data\nwere signiﬁcantly associated (false discovery rate (FDR) < 0.05), with 28\nL-R pairs shared between enhanced and raw data (Fig.3e). Further\ninterrogation indicated that those raw-speciﬁcL - Rp a i r sw e r em o r e\nlikely to be false positives, which may result from the original data noise\nand the low data quality (Supplementary Fig. 2b and Supplementary\nNote 1). These L-R-associated pairs in the enhanced data have great\nbiological relevance and facilitate the mining of cellular communica-\ntions. Speciﬁcally, we further reveal the adjacencies between different\ncell types (Fig.3f, Methods) as well as the cell‒cell communications\nconsidering both the neighbouring cell weights and the L-R commu-\nnication strength (Fig.3g). Tumour-associatedﬁbroblasts play a central\nrole in the tumour microenvironment and are not only adjacent to\ntumour cells and lymphocytes (Fig.3f) but also demonstrate strong\ncommunication with them (Fig.3g). In contrast, lymphocytes and\nmyeloid cells are close to each other but have less communication.\nCollectively, this evidence demonstrates that the enhanced data con-\ntribute to downstream analysis and are crucial for revealing cellular\ninteractions, which otherwise would be hidden due to data sparsity.\nSiGra enhances the single-cell spatial data of Vizgen MERSCOPE\nSiGra is further evaluated on the other SCST dataset of mouse livers\ncompiled by Vizgen MERSCOPE, which consists of 347 genes and\n395,215 cells. In this dataset, SiGra reveals different spatial cell clusters\n(Supplementary Fig. 2c). For better visualization, we focused on the\nfour major cell clusters (Fig.4a). Cluster 1 (C-1) and cluster 2 (C-2) are\nlocated adjacent to the central and portal veins, respectively, while\ncluster 3 (C-3) and cluster 4 (C-4) are located at blood vessels.\nImportantly, the enhanced data by SiGra reveal histologically mean-\ningful liver-speciﬁc gene expression patterns in different regions\n(Fig. 4b). For example, SiGra remarkably enhances hepatocyte hall-\nmark genesCyp2c38\n30 and Axin231, which are predominantly expressed\nnear blood vessels. The endothelial cell markersCd3432 (Fig. 4b) and\nVwf33 (Supplementary Fig. 2d) were also clearly present in the central\nveins, portal veins, and sinusoids. The raw data, in contrast, show noisy\nexpression of these genes in the nonrelevant anatomic regions. For\nexample, Cd34 and Vwf show scattered false signals in the nonblood-\nvessel regions and missing expression in smaller veins, especially\nsinusoids. Thus, essential cellular anatomical structures in the liver\ntissue, such as central veins, portal veins, and sinusoids, can be clearly\nidentiﬁed by the enhanced expressions ofCd34, Vwf,a n dAxin2,b u t\nnot the noisy raw data, which are further conﬁrmed by the UMAP plots\n(Fig. 4c). From the boxplots of the expression of these hallmark genes\n(Fig. 4d), both C-1 and C-2 are suggested to be hepatocytes (high\nCyp2c38 and Axin2 expression), C-2 is enriched with periportal hepa-\ntocytes (higher Axin2 expression), C-4 contains mainly endothelial\ncells (highCd34 and Vwf expression), and C-3 is likely to be hepatic\nstellate cells. Notably, the enhanced cell-type speciﬁc genes are only\nenriched in their restricted regions but not in irrelevant regions, sug-\ngesting that SiGra does not introduce noticeable artefacts in the\nenhanced data. Further comparison between enhanced data with bulk\nRNA-seq shows the improved spatial data quality by SiGra (Supple-\nmentary Fig. 2e and Supplementary Note 1).\nIn addition, more differentially expressed genes (DEGs) were\nidentiﬁed from the enhanced data than from the raw data (Fig.4e). For\nexample, the enhanced data recovered 59, 42, and 35 DEGs for C-1, C-2,\nand C-3, respectively, while the raw data only identiﬁed 12, 13, and 12\nDEGs, respectively. The identiﬁed DEGs in the enhanced data also\nshowed a higher average log2-fold change (logFC; C-1: 0.8; C-2: 0.89; C-\n3: 0.79) than the raw data. The large overlaps between the DEGs\nrevealed by the enhanced spatial data and the single-cell RNA-seq data\nfurther verify the improved data quality after enhancement (Supple-\nmentary Fig. 2f and Supplementary Note 1). Moreover, the enhanced\ndata reveal meaningful and associated L-R pairs. As shown in Fig.4f,\namong the 64 L-R pairs identiﬁed in this dataset, 13 L-R pairs in the\nenhanced data and 12 L-R pairs in the raw data were signiﬁcantly\nassociated (FDR < 0.05), with 9 of these L-R pairs shared between the\nenhanced and raw data. Further investigation revealed that the\nenhanced-speciﬁc L-R pairs also presented strong associations in the\nbulk RNA-seq data of mouse livers\n34 (Wnt2-Fzd4:0 . 5 8 1 ;Pkm-Cd44:\n0.885; Col1a2-Itga2b: 0.641; Dll1-Notch2: 0.798). However, the raw-\nspeciﬁc L-R pairs have no associations in the bulk data, indicating that\nthose raw-speciﬁc L-R pairs are more likely to be false positives. These\nresults demonstrate that SiGra facilitates the recovery of liver-speciﬁc\ngenes and L-R interactions, which enables better characterization of\nthe spatial architecture of mouse liver tissue.\nS i G r ai m p r o v e st h ei d e n t iﬁc a t i o no fk n o w nl a y e r si nb r a i n\ntissues\nTo show that SiGra not only outperforms existing methods in single-\ncell spatial data but also in spot-based spatial transcriptomics data,\nhere we analyse the 10x Visium datasets from the human dorsolateral\nprefrontal cortex (DLPFC). These datasets consist of 12 tissue slices of\nhuman brains, covering up to six neuronal layers and white matter\nmanually annotated by the original study. To evaluate the bench-\nmarking performance, the identiﬁed spatial clusters are annotated\nbased on the matched overlap of spatial clusters and ground truth.\nFigure 5a shows the ARI scores for all 12 tissue slices (Supplementary\nFigs. 3 and 4), on which SiGra (median ARI: 0.57) outperforms Scanpy\n(median ARI: 0.28), Seurat (median ARI: 0.29), stLearn (median ARI:\n0.39), SpaGCN (median ARI: 0.40), and BayesSpace (median ARI: 0.44).\nWe further examined the DLPFC anatomical structures identiﬁed\nby different methods. For tissue slice 151,507 (Fig.5b), SiGra reveals\nmore accurate spatial regions than the other methods. Seurat identi-\nﬁes Layer 4 scattered in the regions of Layers 3 and 5 without clear\nboundaries. Scanpy, stLearn, and BayesSpace are not able to distin-\nguish the anatomical shape of Layer 4. Figure5c shows the other tissue\nslice 151,676 with spatial regions identiﬁed by different methods. Only\nSiGra deciphers the layer boundaries clearly, reaching good agreement\nwith manual annotations (ARI = 0.62), while other methods can only\nachieve ARIs of less than 0.4. Speciﬁcally, stLearn intermingles Layer 2\nwith Layer 3, with additional mixtures of Layer 4 and white matter.\nBayesSpace mixes Layer 4 with Layer 5 and misidentiﬁes some white\nmatter as Layer 2, which leads to its poor performance. Interestingly,\nalthough stLearn also utilizes histology information from the haema-\ntoxylin and eosin (H&E) images to capture morphological features, its\nperformance is substantially worse than that of SiGra, suggesting that\nSiGra incorporates multimodal spatial features in a more effective way.\nIn addition, based on the latent embeddings of slice 151676 obtained\nby different methods (Fig.5d), SiGra presents much clearer separa-\ntions of different anatomical layers, while Scanpy and SpaGCN only\ndiscern white matter, failing to distinguish other neuronal layers. All\nthese benchmarking results show that SiGra is able to better identify\nsubtle spatial domains than other methods in spot-based spatial\ntranscriptomics data.\nSiGra improves spatial gene expression for better structural\ncharacterization\nTo further validate that SiGra enhances spatial gene expression, we\ndetected the DEGs of each domain in slice 151676. Compared with\nArticle https://doi.org/10.1038/s41467-023-41437-w\nNature Communications|         (2023) 14:5618 6\nC−1\nC−2\nC−3\nC−401 2 34\nGene expression\nb\nd\nc\nf\na\n0\n1\n2\n3\n4\nCyp2c38\n0.00\n0.25\n0.50\n0.75\n1.00Cd34\n0\n1\n2\n3\n4\nAxin2\n0\n20\n40\n60\n80\n0.8\n0.89\n0.79 0.96\n1.92\n0.69 0.85 0.75 0.96\n0.81\ne\nCyp2c38\nCd34\nAxin2\nRaw expression Enhanced expression\nCyp2c38\nCd34\nAxin2\nRaw expression Enhanced expression\n0.0\n0.5\n1.0\n1.5\nC−1 C−2 C−3 C−4 Other\nVwf\nC−1 C−2 C−3 C−4 Other\nC−1 C−2 C−3 C−4 Other\nC−1 C−2 C−3 C−4 Other\nRaw expression\nEnhanced expression\nC−1 C−2 C−3 C−4 Other\nNumber of DEGs\nSelplg−Itgb2Dll4−Notch4\nDll4−Notch1\nEfnb2−Pecam1\nEfnb2−Ephb4\nBmp2−Eng\nVwf−Selp\nJag1−Notch3 Vcam1−Itgb2\nCol1a2−Itga2b\nWnt2−Fzd4\nDll1−Notch2\nPkm−Cd44\nJag1−Notch1 Fgf1−Egfr\nTimp3−Kdr\n0\n1\n2\n0.0 0.5 1.0 1.5 2.0\nFDR\n 0.50 0.75\nFDR > 0.05 Specific Shared\n-log10(FDR) in raw data\n-log10(FDR) in enhanced data\nFDR = 0.05\nFDR = 0.05\n5mm\n5mm\n5mm\n5mm\n5mm 5mm\n5mm\n5mm 5mm\n5mm 5mm\nFig. 4 | SiGra enhances the single-cell spatial data of Vizgen MERSCOPE.\na Spatial visualization of the cell clusters in the single-cell spatial data from mouse\nliver tissue.b Spatial visualization of the raw expression and the enhanced\nexpression of liver-related genes (Cyp2c38, Axin2, Cd34). c UMAP visualization of\nthe raw expression and the enhanced expression of liver-related genes (Cyp2c38,\nAxin2, Cd34). d Boxplots of the raw expression and the enhanced expression of\nliver-speciﬁc genes in different cell clusters (C1: 63,300; C2: 44,173; C3: 39,823; C4:\n29,170; Other: 190,645). In the boxplot, the centreline, box limits and whiskers\ndenote the median, upper and lower quartiles, and 1.5× interquartile range,\nrespectively.e Comparisons of the number of differentially expressed genes (DEGs)\nin cell clusters. The labelled number is the average logFC for that cell cluster.\nf Scatter plot of signiﬁcantly associated ligand‒receptor (L-R) pairs in the raw data\nand the enhanced data. Orange- and yellow-coloured dots represent the shared and\nspeciﬁc L-R pairs, respectively. Source data are provided as a Source Dataﬁle.\nArticle https://doi.org/10.1038/s41467-023-41437-w\nNature Communications|         (2023) 14:5618 7\nthe number of DEGs detected in raw data, SiGra detects more DEGs\nspeciﬁc to individual regions (Supplementary Data 1). For example,\nwith 232 DEGs of Layer 1 detected in raw data, 595 DEGs are found\nspeciﬁc to Layer 1 from enhanced data. Moreover, for each of the\nneuronal layers, region-speciﬁc marker genes can be better identi-\nﬁed after SiGra data enhancement (Fig.6a). For example,MYH11\n35\npresents enriched expression in Layer 1 (logFC = 2.96).C1QL236 and\nCUX236 are overexpressed in Layer 2 and Layer 3, with logFC values of\n1.74 and 1.44, respectively.SYT237 and FEZF238 are enriched in Layer 4\n(logFC = 1.31) and Layer 5 (logFC = 1.42).PAQR639 shows dominantly\nenriched expression (logFC = 2.9) in the white matter area. In con-\ntrast, these marker genes do not show clear expression patterns in\nraw data, indicating the limits that raw data face in distinguishing\nspatial domain boundaries. Violin plots further show the expression\nof marker genes in raw data and enhanced data (Fig.6b). Such\nenhanced gene expression patterns are also observed in other\nDLPFC slices, for example, slice 151507 (Fig.6c and Supplementary\nData 2), whereRELN\n40 (logFC = 3.24) andADCYAP141 (logFC=2.81), i.e.,\nmarkers of Layer 1 and Layer 2 present remarkable enhancement, in\ncontrast to their sporadic expressions in raw data. In addition, we\nexamined the layer-enriched gene markers identi ﬁed in the\nenhanced data, which showed high consistency with those of the\noriginal study\n42 (Supplementary Note 2 and Supplementary Data 3).\nThese results demonstrate the capability of SiGra to reduce noise\nand improve gene expression patterns in spot-based spatial tran-\nscriptomics data.\nDiscussion\nSpatial biology technology has rapidly evolved into the single-cell era2.\nCommercially available in situ hybridization platforms such as Nano-\nString CosMx SMI and Vizgen MERSCOPE have enabled spatial gene\nexpression proﬁling at subcellular resolution (50 nm) for 500– 1000\ntargeted genes. Experimental in situ sequencing technologies such as\nExSeq\n43 expand SCST to the whole transcriptome. Spot-array spatial\ntranscriptomics technologies such as Stereo-seq44 and Seq-Scope45 are\nalso reaching subcellular resolution (500 nm– 600 nm). However, in all\nthese technologies, the resulting SCST data are limited by the low total\ntranscriptions per cell, noisy data, and substantial zeros, which raises\nchallenges in effective downstream analysis\n15. To accurately reveal\nspatial and cellular anatomic structures and to enhance noisy gene\nexpression data, we developed the SiGra method, a graph artiﬁcial\nintelligence model, to incorporate multimodal data, including multi-\nchannel IHC images, spatial adjacency cell graphs, and gene expres-\nsion. The use of graph transformers over a spatially adjacent cell graph\nas well as the imaging-transcriptomics hybrid architecture allows SiGra\nto effectively leverage the rich information from the high-content IHC\nimages as well as the spatial distribution. In SiGra, the multimodal\ninformation from images and original transcriptomics are summarized\nLayer 1\nLayer 2\nLayer 3\nLayer 4\nLayer 5\nLayer 6\nWM\nSiGra (ARI=0.56)\nSiGra (ARI=0.62)\n1\n2\n3\n4\n5\n6\n7\nSeurat (ARI = 0.34)\nSeurat (ARI = 0.26)\nSpaGCN (ARI=0.39)\nSpaGCN (ARI=0.44)\nstLearn (ARI = 0.40)\nstLearn (ARI = 0.49)\nBayesSapce (ARI=0.47)\nBayesSapce (ARI=0.37)\nscanpy (ARI = 0.34)\nscanpy (ARI = 0.27)\n1\n2\n3\n4\n5\n6\n7\nscanpy\nUMAP2\nUMAP1\nUMAP2\nUMAP1\nSiGra\nUMAP2\nUMAP1\nSpaGCN\nUMAP2\nUMAP1\nstLearn\nLayer 1\nLayer 2\nLayer 3\nLayer 4\nLayer 5\nLayer 6\nWM\nSlice 151507\nSlice 151676\nab\ncd\n0.2\n0.4\n0.6\nSeurat scanpystLearn spaGCN BayesSpaceSiGra\nARI\nSeurat\nscanpy\nstLearn\nspaGCN\nBayesSpace\nSiGra\nFig. 5 | SiGra improves the identiﬁcation of known layers in brain tissues.\na Boxplot of the adjusted Rand index (ARI) scores of six methods in all 12 DLPFC\nslices. In the boxplot, the centreline, box limits and whiskers denote the median,\nupper and lower quartiles, and 1.5× interquartile range, respectively. Source data\nare provided as a Source Dataﬁle. b Spatial domains detected by different meth-\nods, including Scanpy, Seurat, stLearn, BayesSpace, SpaGCN, and SiGra, in DLPFC\nslice 151507.c Spatial domains detected by different methods, including Scanpy,\nSeurat, stLearn, BayesSpace, SpaGCN, and SiGra, in DLPFC slice 151676.d UMAP\nvisualizations of latent embeddings generated by Scanpy, stLearn, SpaGCN, and\nSiGra in DLPFC slice 151676. SpaGCN and BayesSpace are not shown because they\ndid not provide latent embeddings for UMAP visualization.\nArticle https://doi.org/10.1038/s41467-023-41437-w\nNature Communications|         (2023) 14:5618 8\nat the single-cell level, with the information from neighbouring cells\nselectively captured by the attention mechanism. With these technical\nadvances, the SiGra model outperforms existing methods and sig-\nniﬁcantly improves downstream data analysis.\nSiGra is designed to utilize multimodalities, including multi-\nchannel images of cells and their niches, to address technological\nlimitations and achieve augmented spatial proﬁles. Designed as a\ngeneral-purpose tool for spatial transcriptomics data enhancement\nand spatial pattern proﬁling, SiGra can be directly used not only for\nSCST but also for spot-based spatial transcriptomics data. SiGra\ndemonstrates superior performance on three different platforms, in\nboth healthy and diseased tissues, and across different species, which\nprovides a general solution for existing spatial transcriptomics data\nanalysis pipelines. Notably, SiGra can identify spatial domains at dif-\nferent resolutions, depending on the data types and the applications.\nFor the spot-level spatial data that have a low spatial resolution and\nconsist of mixed cells/cell types in each spot, SiGra directly and\naccurately identiﬁes the spatial structures (Fig.5), such as the anato-\nm i c a ll a y e r si nt h eb r a i nc o r t e xo nD L P F Cs l i c e s ,b yc l u s t e r i n gt h e\nlatently represented spots. For the SCST with signiﬁcantly high reso-\nlution, SiGra identiﬁes spatial regions at the cellular level (Fig.2).\nMeanwhile, on such high-resolution SCST data, SiGra is also able to\nreveal the regional anatomic spatial structures by further summarizing\nt h eL e i d e nc l u s t e r i n gr e s u l t sw i t had i m e n s i o n a lm o v i n gw i n d o w\napproach (Supplementary Fig. 5 and Supplementary Note 3). The\neffects of autoﬂuorescence on SiGra are also examined in Supple-\nmentary Fig. 6 and Supplementary Note 4.\nIn addition to its superior performance and technical advantages,\nSiGra can be further improved in the future. First, as newer spatial\nomics technologies\n46 continue evolving and new data modalities\ncontinue to emerge, SiGra can be improved by incorporating new\nomics data types, new image types, 3-D spatial information, etc., to\nextend data exploration. The hybrid architecture allows SiGra to adapt\nadditional spatial information and incorporate multiomics data. As an\nadvanced deep learning model, SiGra also faces the limitations of the\nblack-box nature of artiﬁcial intelligence\n47– 49. This can be ameliorated\nthrough downstream analysis, such as cell‒cell interaction analysis.\nFurther development of SiGra will enhance the model interpretability\nthat can address some of the problems and provide insights into the\nunderlying mechanism in tissue ecosystems. As the capacity and efﬁ-\nciency of experimental technologies continue to improve, SiGra is\nanticipated to facilitate biological discoveries and insights into com-\nplex tissues and diseases.\nMethods\nData preprocessing and graph representation\nSpatial transcriptomics data generated by different platforms,\nincluding the NanoString CosMx\nTM SMI lung cancer dataset (Lung-9-\n1)4, Vizgen MERSCOPE mouse liver dataset L1R1 released in January\n202215, and 10x Visium datasets from the human dorsolateral\nCUX2C1QL2 FEZF2MYH11 SYT2 PAQR6\nMYH11\nC1QL2\nCUX2\nSYT2\nFEZF2\nSEMA3E\nPAQR6\nLayer 1\nLayer 2\nLayer 3\nLayer 4\nLayer 5\nLayer 6\nWM\nMYH11\nC1QL2\nCUX2\nSYT2\nFEZF2\nSEMA3E\nPAQR6\nLayer 1\nLayer 2\nLayer 3\nLayer 4\nLayer 5\nLayer 6\nWM\nRELN\nC1QL2\nADCYAP1\nSYT2\nFEZF2\nSEMA3E\nMBP\nLayer 1\nLayer 2\nLayer 3\nLayer 4\nLayer 5\nLayer 6\nWM\nLayer 1\nLayer 2\nLayer 3\nLayer 4\nLayer 5\nLayer 6\nWM\nRELN\nC1QL2\nADCYAP1\nSYT2\nFEZF2\nSEMA3E\nMBP\na\nbc\nMedian expression\n0      0.1   0.2\nMedian expression\n0      0.2   0.4\nMedian expression\n0      0.1   0.2\nMedian expression\n0      0.2   0.4\nHigh\nLow\nRawEnhanced\nRaw Enhanced Raw Enhanced\nFig. 6 | SiGra improves spatial gene expression for better structural char-\nacterization. aSpatial visualization of the raw expression and the enhanced\nexpression of marker genes (MYH11, C1QL2, CUX2, SYT2, FEZF2, PAQR6)i nD L P F C\nslice 151676. Numbers of spots in each layer: Layer 1: 289; Layer 2: 254; Layer 3: 836;\nLayer 4: 254; Layer 5: 649; Layer 6: 616; WM: 533.b Violin plots of the raw expression\nand the enhanced expression of marker genes in DLPFC slice 151676.c Violin plots\nof the raw expression and the enhanced expression of marker genes in DLPFC slice\n151,507. Numbers of spots in each layer: Layer 1: 817; Layer 2: 305; Layer 3: 1,215;\nLayer 4: 369; Layer 5: 675; Layer 6: 486; WM: 354.\nArticle https://doi.org/10.1038/s41467-023-41437-w\nNature Communications|         (2023) 14:5618 9\nprefrontal cortex (DLPFC)42, are preprocessed and represented in\nuniform format (Fig.1) for SiGra. The original spatial proﬁles are\nconverted to single-cell (or spot) images, single-cell (or spot) expres-\nsion, and a spatial graph of adjacent cells (or spots), which serve as the\ninput for SiGra.\nRegarding the NanoString Lung-9-1 dataset, the composite images\nof the DAPI, PanCK, CD45, and CD3 channels from 20 FOVs, the cell\ncentre coordinates (from the cell metadataﬁle), and the single-cell\ngene expressionﬁle of 960 genes are used. For each cell, four 120-by-\n120 pixel (21.6μm-by-21.6μm) images with the cell at the centre are\ncropped from the images. Edges in the spatial adjacency graph are\nconstructed if the cell-to-cell distance (Euclidian distance)≤ 80 pixels\n(14.4μm). NanoString’s annotations of cell types are obtained from\ntheir provided Giotto object. Regarding the Vizgen L1R1 dataset, ima-\nges of the DAPI staining and the three IHC boundary staining, the\nsingle-cell expression data of 347 genes, and the cell centre coordi-\nnates are used. The images in the middle of the z-packs (z3) are used, as\nrecommended by Vizgen. These images are cropped into single-cell\n200-by-200 pixel (21.6μm -by-21.6μm) images. Edges in the spatial\nadjacency graph are constructed if the cell-to-cell distance≤ 150 pixels\n(16.2μm). Regarding the 10x Visium DLPFC dataset, the high-\nresolution H&E images as well as the .h5 ﬁles (“ﬁltered_feature_-\nbc_matrix.h5”) are used as input. For each spot, three spot-speciﬁc\nimages (for the RGB channels) are extracted, with 50-by-50 pixel\n(38.7μm-by-38.7μm) images. The cut-off distance for generating the\nspatial graph between spots is 150 pixels (116μm). The top 3000 highly\nvariable genes were identiﬁed using the Seurat standard pipeline\n10 and\nused for analysis. For all datasets, the raw counts of gene expression\nwere normalized by multiplying by 10,000, followed by log-\ntransformation. The parameters of the size of single-cell images and\nthe cut-off of cell-to-cell distance for constructing the spatial graph are\ndetermined empirically depending on the cellular anatomy of the tis-\nsue. In the spatial adjacency graph, most cells have 5 – 6\nneighbouring cells.\nIn this way, theﬁnal graph representation of the original single-\ncell or spot spatial transcriptomics data is a spatial graphG = V,EðÞ ,\nwith v\ni 2 V representing thei th cell withi =1 ,/C1/C1/C1 ,n representing the\ntotal N cells, eij 2 E representing the spatial proximity between two\ncells vi and vj,a n dA as the adjacency matrix of the graph. Each cellvi\non the spatial graph is accompanied by multichannel images\nMi = Mi,c\n/C8/C9\n,w i t hc =1 ,/C1/C1/C1 ,C representing each imaging channel, and\ngene expressiongi = gi,k\n/C8/C9\n,w i t hk =1 ,/C1/C1/C1 ,K representing genes.\nThe SiGra model\nSiGra is a hybrid multimodal graph transformer framework with three\ntranscriptomics reconstruction modules: the imaging-based encoder-\ndecoder, the transcriptomics-based encoder-decoder, and the hybrid\nencoder-decoder.\n1. Imaging-based encoder-decoder. For a cellv\ni, the multichannel\nimages Mi are transformed to a vector\nxi /C17 vec Mi,1\n/C0/C1\n, /C1/C1/C1 ,vec Mi,c\n/C0/C1/C2/C3 T\n. An encoder with a series of\nmultihead graph transformer layers is used to project the imaging\nvector to the latent space asz\nM,i and then reconstruct the gene\nexpression proﬁle of this cellvi as ^gM,i. The images Mj from\nneighbouring cellvj 2 N vi\n/C0/C1\nare also used as the input, whereN /C1ðÞ\nrepresents the neighbours in the graphG.\n2. Transcriptomics-based encoder-decoder. The original gene\nexpression proﬁle gi for cell vi,w i t hgj for adjacent cellsvj 2\nN vi\n/C0/C1\nalso as the input, is projected to the latent space aszg,i,\nwhich is then used to reconstruct the gene expression of cellvi\nas ^gg,i.\n3. Hybrid encoder-decoder. The latent representation of the\nimaging and transcriptomics features are catenated as½zM,i,zg,i/C138 ,\nfurther projected to hybrid latent featurezh,i, and then used to\nreconstruct the gene expression for cellvi as ^gh,i through graph\ntransformer layers. The latent features zM,j and zg,j from\nneighbouring cellsfvjg are also used by the graph transformers.\nGraph transformer convolutional layer . Multihead graph\ntransformer50 layers with an attention mechanism (Supplementary\nFig. 1) are the main components of the SiGra model. Brieﬂy, for a cell\nvi, the propagation of the graph transformer from thel layer to the\nl +1 l a y e r i s d eﬁned ash l +1ðÞ\ni =R e L UðW lðÞ\n1 h\nlðÞ\ni + P\nvj 2N viðÞ αi,jV lðÞ\nj Þ,w h e r e\nthe rectiﬁed linear unit (ReLU51) is used as the nonlinear gated\nactivation function. The attention module is de ﬁned as\nαi,j =s o f t m a x\n/C0 /C10\nQ lðÞ\ni ,K lðÞ\nj\n/C11\nP\nu2N iðÞ\n/C10\nQ lðÞ\ni ,K lðÞ\nu\n/C11 /C1\n, where:\nquery : QðlÞ\ni = WðlÞ\nQ hðlÞ\ni + bðlÞ\nQ ð1Þ\nkey : KðlÞ\nj = WðlÞ\nK hðlÞ\nj + bðlÞ\nK ð2Þ\nvalue : VðlÞ\nj = WðlÞ\nV hðlÞ\nj + bðlÞ\nV ð3Þ\nand Q, Khi /C17 exp\n/C0\nQT K=\nﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ\ndimðh lðÞ\ni Þ\nq /C1\n. The multihead attention values,\nwhose notation is omitted for simplicity, are concatenated.\nLoss function. SiGra learns the reconstructed gene expression via a\nself-supervised loss of combined MSE from gene embedding, image\nembedding and combined embedding, with the loss function\nL =\nX\nN\ni =1\nλ1LM,i + λ2Lg,i + Lh,i ð4Þ\nwhere LM,i = 1\nN\nPN\ni =1 gi /C0 ^gM,i\n/C13/C13 /C13/C13\n2, Lg,i = 1\nN\nPN\ni =1 gi /C0 ^gg,i\n/C13/C13/C13\n/C13/C13/C13\n2\n,\nLh,i = 1\nN\nPN\ni =1 gi /C0 ^gh,i\n/C13/C13 /C13/C13\n2. In this work, the optimal parameters ofλ1 and\nλ2 were determined through grid-based hyperparameterﬁne turning.\nFor single-cell spatial transcriptomics data, the optimal parameters are\nλ\n1 = 0.1 andλ2 = 0.1. For 10x Visium data, the optimal parameters are\nλ1 =1 a n dλ2 = 1. Details are provided in Supplementary Fig. 7a and\nSupplementary Note 5.\nThe other hyperparameters of SiGra include two graph transfor-\nmer layers for the imaging and the transcriptomics encoders (with\ndimensions of 512 and 30 for the 1\nst and the 2nd layers, respectively),\none graph transformer layer for the hybrid encoder (based on gene\nembeddings and image embeddings from the transcriptomics encoder\nand from the imaging encoder), and two graph transformer layers for\nimaging, transcriptomics, and hybrid decoders (where the dimension\nof theﬁrst layer is 512, and the dimension of the second layer is same as\nthat of the corresponding transcriptomics data). These hyperpara-\nmeters were determined by grid search (Supplementary Fig. 7b and\nSupplementary Note 5). After training, SiGra outputs the hybrid\nreconstruction^g = ^g\nh,i\n/C8/C9\nas theﬁnal enhanced expression proﬁle. The\nlatent representation,z = zh,i\n/C8/C9\n, of the original SCST data is used for\nspatial data clustering with the Leiden algorithm52 from the SCANPY\npackage11.\nSpatial domain detection\nFor the spot-level spatial data that have a low spatial resolution and\nconsist of mixed cells/cell types in each spot, SiGra directly detects the\nspatial domains by clustering the latent-represented spots using Lei-\nden. For single-cell spatial data, SiGraﬁrst identiﬁes the cell types for\neach individual cell by clustering the latent representation using Lei-\nden and then reveals spatial domains via a dimensional moving win-\ndow agglomeration approach\n53.S p e c iﬁcally, the spatially distributed\ncells are summarized by a circular window of diameterd sliding in both\nthe x and y directions across the whole image with a given stride length\ns. At each stopCi,j with the coordinateðxi,yjÞ,av e c t o rci,j /C17½ q1, ... ,qt/C138\nArticle https://doi.org/10.1038/s41467-023-41437-w\nNature Communications|         (2023) 14:5618 10\nrepresenting the proportions of the SiGra-identiﬁed clusters (t)c o v -\nered by the sliding window is calculated. All the stopsfCi:jg are recur-\nsively merged to k groups a1, ... ,ak\n/C8/C9\nby hierarchical clustering\naccording to the cluster proportion vectorsfci:jg. These agglomerated\ngroups are deﬁned as spatial domains. The window radiusd used in\nSupplementary Fig. 5 is 100μm, which is consistent with the 10x Vis-\nium spatial resolution, with a strides of 10μm. For fair comparisons,\nthe same moving window agglomeration approach is used in bench-\nmarking methods (Supplementary Fig. 5). The ground truth of the\nanatomic spatial domains for the DLPFC slices and lung cancer slices\nwas obtained from the original study\n7 and the certiﬁed pathologist at\nIndiana University Health (T.H.).\nBenchmarking methods and comparison measurement\nTo evaluate the performance of SiGra, we compare it withﬁve existing\nmethods: Seurat v410,S c a n p y11,s t L e a r n12,S p a G C N14,a n dB a y e s S p a c e13.\nSeurat and Scanpy are implemented based on their provided vignettes.\nBrieﬂy, for data preprocessing, 3000 highly variable genes were\nselected for log normalization, and the top 30 principal components\n(PCs) were calculated for spatial data clustering. BayesSpace is\nimplemented based on their package vignette. Speciﬁcally, the input is\nthe top 15 PCs of the log-normalized expression of the top 2000 HVGs.\nThe nrep parameter is set to 50,000, and the gamma parameter is set\nto 3. For stLearn, based on its tutorial, the stLearn.SME.SME_norma-\nlized() function is performed on raw counts with parameters use_data\n= “raw” and weights =“physical_distance”. The top 30 PCs of the SME\nnormalized matrix are then used for spatial data clustering and\nvisualization. SpaGCN is applied according to its recommended para-\nmeters in the package vignette. That is, the top 15 PCs of the log-\nnormalized expression of the top 3000 spatial variable genes are used\nfor spatial data clustering. Two hundred epochs are used for identi-\nfying and reﬁning spatial domains. The resolution parameter is selec-\nted to ensure that the number of clusters is equal to the ground truth.\nMoreover, we comprehensively compared SiGra with MUSE\n54 and\nSTAGATE55 based on simulation data, SCST data, and 10x Visium data.\nAdditional ablation studies were also performed to investigate the\ncontributions of different components in the SiGra model. Details of\nbenchmarking and ablation studies are provided in Supplementary\nF i g s .8 ,9 ,a n dS u p p l e m e n t a r yN o t e6 .\nTo evaluate the performance of each method, we use the adjusted\nRand index (ARI) to assess the agreement between the identiﬁed\nspatial clusters and the manual annotation. Suppose ^Y = ^y\ni\n/C8/C9 n\ni =1\nrepresents the spatial clusters andY = yi\n/C8/C9 n\ni =1 represents the ground\ntruth ofn cells divided intok clusters. Then,\nARI =\nP\nls\nnls\n2\n/C18/C19\n/C0\nP\nl\nnl\n2\n/C18/C19 P\ns\nns\n2\n/C18/C19\nn\n2\n/C18/C19\nP\nl\nnl\n2\n/C18/C19\n+\nP\ns\nns\n2\n/C18/C19\n2 /C0\nP\nl\nnl\n2\n/C18/C19 P\ns\nns\n2\n/C18/C19\nn\n2\n/C18/C19\nð5Þ\nwhere l and s denote thek clusters, nl = Pn\ni I ^yi = l\n/C0/C1\n, ns = Pn\ni Iy i = s\n/C0/C1\n,\nnls = Pn\ni,jI ^yi = l\n/C0/C1\nIy i = s\n/C0/C1\n,a n dIx = yðÞ =1w h e nx = y,e l s eIx = yðÞ =0 .T h e\nARI ranges from 0 to 1 for increasing match between the identiﬁed\nclusters with ground truth.\nIdentifying differentially expressed genes and adjacent cell\ncommunications\nTo identify the differentially expressed genes (DEGs), the Wilcoxon\ntest from the Scanpy package11 was used. DEGs of each spatial region\nwere selected with a 5% FDR threshold (Benjamin-Hochberg adjust-\nment) and a log2-fold change greater than 1 (logFC > 1).\nTo reveal the neighbours of each cell type, we aggregate its\nneighbouring cells by cell type and divide the average number to\nreveal its weighted neighbours. These weighted neighbours are further\nused to characterize the adjacent cell communications. Speciﬁcally,\nthe interaction strength of each L-R pair is calculated by multiplying\ntheir association score and their average expression. Then, we aggre-\ngate the interaction strength of each L-R pair by cell type to be the\ncommunication strength of two cell types. The neighbouring weight of\ntwo cell types is further multiplied by the communication strength of\nthese two cell types for theﬁnal adjacent cell communications. In this\nway, the higher the value of the adjacent communications, the stron-\nger the interaction between two neighbouring cell types.\nReporting summary\nFurther information on research design is available in the Nature\nPortfolio Reporting Summary linked to this article.\nData availability\nThe single-cell spatial dataset ofNanoString CosMx SMI contains 20\nFOVs, which is proﬁled by the CosMx SMI on Formalin-Fixed Parafﬁn-\nEmbedded (FFPE) samples of the non-small-cell lung cancer (NSCLC)\ntissue\n4. The dataset (Lung-9-1) and other lung cancer slices are available\nfrom https://nanostring.com/products/cosmx-spatial-molecular-imager/\nnsclc-ffpe-dataset/.W eu s e dt h eV i z g e nM E R F I S HM o u s eL i v e rM a p\ndataset that contains a MERFISH measurement of a 347 gene panel.\nSample L1R1 (liver 1, replicate 1) was used and downloaded fromhttps://\ninfo.vizgen.com/mouse-liver-data?submissionGuid=da03b470-e111-\n425a-b6d2-16d34342f4fe, which includes the list of detected transcripts,\ngene counts per cell matrix, additional spatial cell metadata, cell\nboundary polygons, and DAPI images. The human dorsolateral prefrontal\ncortex (DLPFC) 10x Genomics Visium datasets consists of 12 samples\n42.\nEach of the samples is manually annotated with up to six cortical layers\nand white matter. Transcriptomics data and hematoxylin and eosin (H&E)\nimages of corresponding tissue sections are downloaded fromhttp://\nresearch.libd.org/spatialLIBD/. Source data are provided with this paper.\nCode availability\nSiGra is provided as a Python package available athttps://github.com/\nQSong-github/SiGra56, with detailed tutorials for general applicability\non different SCST platforms. The web interface (SiGra Viewer) is\navailable at http://sigra.sulab.io and enables users to explore the\nenhanced data in UMAPﬁgures and spatial domains.\nReferences\n1. Mof ﬁtt, J. R., Lundberg, E. & Heyn, H. The emerging landscape of\nspatial proﬁling technologies.Nat. Rev. Genet.23,7 4 1– 759 (2022).\n2. Moses, L. & Pachter, L. Museum of spatial transcriptomics.Nat.\nMethods 19,5 3 4– 546 (2022).\n3 . P a l l a ,G . ,F i s c h e r ,D .S . ,R e g e v ,A .&T h e i s ,F .J .S p a t i a lc o m p o n e n t s\nof molecular tissue biology.Nat. Biotechnol.40,3 0 8– 318 (2022).\n4. He, S. et al. High-plex imaging ofRNA and proteins at subcellular\nresolution inﬁxed tissue by spatial molecular imaging.Nat. Bio-\ntechnol.40,1 7 9 4– 1806 (2022).\n5. Crosetto, N., Bienko, M. & van Oudenaarden, A. Spatially resolved\ntranscriptomics and beyond.Nat. Rev. Genet.16,5 7– 66 (2015).\n6. Fang, R. et al. Conservation and divergence of cortical cell orga-\nnization in human and mouse revealed by MERFISH.Science 377,\n56– 62 (2022).\n7. Giacomello, S. et al. Spatially resolved transcriptome proﬁling in\nmodel plant species.Nat. Plants3, 17061 (2017).\n8. Berglund, E. et al. Spatial maps of prostate cancer transcriptomes\nreveal an unexplored landscape of heterogeneity.Nat. Commun.9,\n2419 (2018).\n9. Thrane, K., Eriksson, H., Maaskola, J., Hansson, J. & Lundeberg, J.\nSpatially resolved transcriptomics enables dissection of genetic\nArticle https://doi.org/10.1038/s41467-023-41437-w\nNature Communications|         (2023) 14:5618 11\nheterogeneity in stage III cutaneous malignant melanoma.Cancer\nRes. 78,5 9 7 0– 5979 (2018).\n10. Hao, Y. et al. Integrated analysis of multimodal single-cell data.Cell\n184,3 5 7 3– 3587.e3529 (2021).\n1 1 . W o l f ,F .A . ,A n g e r e r ,P .&T h e i s ,F .J .S C A N P Y :l a r g e - s c a l es i n g l e - c e l l\ngene expression data analysis.Genome Biol.19,1 5( 2 0 1 8 ) .\n12. Pham, D. et al. stLearn: integrating spatial location, tissue mor-\nphology and gene expression toﬁnd cell types, cell-cell interac-\ntions and spatial trajectories within undissociated tissues. BioRxiv.\n2020-05 (2020).\n13. Zhao, E. et al. Spatial transcriptomics at subspot resolution with\nBayesSpace.Nat. Biotechnol.39,1 3 7 5– 1384 (2021).\n14. Hu, J. et al. SpaGCN: Integrating gene expression, spatial location\nand histology to identify spatial domains and spatially variable\ngenes by graph convolutional network.Nat. Methods18,\n1342– 1351 (2021).\n15. Liu, J. et al. Concordance of MERFISH spatial transcriptomics with\nbulk and single-cell RNA sequencing.Life Sci. Alliance6,\ne202201701 (2023).\n16. Niu, Z., Zhong, G. & Yu, H. A review on the attention mechanism of\ndeep learning.Neurocomputing452,4 8– 62 (2021).\n1 7 . Y u n ,S . ,J e o n g ,M . ,K i m ,R . ,K a n g ,J .&K i m ,H .J .G r a p ht r a n s f o r m e r\nnetworks.Adv. Neural Inf. Process. Syst.32, 11983– 11993 (2019).\n18. Shi, Y. et al. Masked label prediction: uniﬁed message passing\nmodel for semi-supervised classiﬁcation. arXiv preprint\narXiv:2009.03509. (2020).\n19. Hutton, C. et al. Single-cell analysis deﬁnes a pancreaticﬁbroblast\nlineage that supports anti-tumor immunity.Cancer Cell39,\n1227– 1244.e1220 (2021).\n2 0 . B e t j e s ,M .G . ,H a k s ,M .C . ,T u k ,C .W .&B e e l e n ,R .H .M o n o c l o n a l\nantibody EBM11 (anti-CD68) discriminates between dendritic cells\nand macrophages after short-term culture.Immunobiology183,\n79– 87 (1991).\n21. Yao, J. et al. Matrix Gla protein regulates differentiation of endo-\nthelial cells derived from mouse embryonic stem cells.Angiogen-\nesis 19,1 – 7( 2 0 1 6 ) .\n22. Mohtar, M. A., Syafruddin, S. E., Nasir, S. N. & Low, T. Y. Revisiting\nthe roles of pro-metastatic EpCAM in cancer.Biomolecules10,\n255 (2020).\n23. Wang, D., Hao, T., Pan, Y., Qian, X. & Zhou, D. Increased expression\nof SOX4 is a biomarker for malignant status and poor prognosis in\npatients with non-small cell lung cancer.Mol. Cell. Biochem.402,\n75– 82 (2015).\n24. Sen, M. et al. Transcriptional proﬁling of single tumour cells from\npleural effusions reveals heterogeneity of epithelial to mesenchy-\nmal transition and extra-cellular matrix marker expression.Clin.\nTransl. Med.12, e888 (2022).\n25. Sharman, J. L. et al. IUPHAR-DB: updated database content and new\nfeatures.Nucleic Acids Res.41,D 1 0 8 3– D1088 (2012).\n26. Ramilowski, J. A. et al. A draft network of ligand-receptor-\nmediated multicellular signalling in human.Nat. Commun.6,\n7866 (2015).\n2 7 . P r a s a d ,T .S . ,K a n d a s a m y ,K .&P a n d e y ,A .H u m a np r o t e i nr e f e r e n c e\ndatabase and human proteinpedia as discovery tools for systems\nbiology.Methods Mol. Biol.577,6 7– 79 (2009).\n28. Ben-Shlomo, I., Yu Hsu, S., Rauch, R., Kowalski, H. W. & Hsueh, A. J.\nSignaling receptome: a genomic and evolutionary perspective of\nplasma membrane receptors involved in signal transduction.Sci.\nSTKE 2003, RE9 (2003).\n29. Graeber, T. G. & Eisenberg, D. Bioinformatic identiﬁcation of\npotential autocrine signaling loops in cancers from gene expression\nproﬁles. Nat. Genet.29,2 9 5– 300 (2001).\n30. Graves, J. P. et al. Characterization of the tissue distribution of the\nmouse Cyp2c subfamily by quantitative PCR analysis.Drug Metab.\nDispos. 45,8 0 7– 816 (2017).\n31. Sun, T. et al. AXIN2(+) pericentral hepatocytes have limited con-\ntributions to liver homeostasis and regeneration.Cell Stem Cell26,\n97– 107.e106 (2020).\n32. de Boer, W. B., Segal, A., Frost, F. A. & Sterrett, G. F. Can CD34\ndiscriminate between benign and malignant hepatocytic lesions in\nﬁne-needle aspirates and thin core biopsies?Cancer 90,\n273– 278 (2000).\n33. Haberichter, S. L. von Willebrand factor propeptide: biology and\nclinical utility.Blood 126,1 7 5 3– 1761 (2015).\n34. Tabula Muris, C. et al. Single-cell transcriptomics of 20 mouse\norgans creates a Tabula Muris.Nature 562,3 6 7– 372 (2018).\n35. Hrvatin, S. et al. Single-cell analysis of experience-dependent\ntranscriptomic states in the mouse visual cortex.Nat. Neurosci.21\n,\n120– 129 (2018).\n36. Zeisel, A. et al. Brain structure. Cell types in the mouse cortex and\nhippocampus revealed by single-cell RNA-seq.Science 347,\n1138– 1142 (2015).\n3 7 . S o m m e i j e r ,J .P .&L e v e l t ,C .N .S y n a p t o t a g m i n - 2i sar e l i a b l em a r k e r\nfor parvalbumin positive inhibitory boutons in the mouse visual\ncortex. PLoS One7,e 3 5 3 2 3( 2 0 1 2 ) .\n38. Tsyporin, J. et al. Transcriptional repression by FEZF2 restricts\nalternative identities of cortical projection neurons.Cell Rep.35,\n109269 (2021).\n39. Lin, H. et al. Whole blood gene expression and white matter\nHyperintensities.Mol. Neurodegener.12,6 7( 2 0 1 7 ) .\n40. Camacho, J., Ejaz, E., Ariza, J., Noctor, S. C. & Martinez-Cerdeno, V.\nRELN-expressing neuron density in layer I of the superior temporal\nlobe is similar in human brains with autism and in age-matched\ncontrols.Neurosci. Lett.579,1 6 3– 167 (2014).\n4 1 . A r n s t e n ,A .F .T . ,W o o ,E . ,Y a n g ,S . ,W a n g ,M .&D a t t a ,D .U n u s u a l\nmolecular regulation of dorsolateral prefrontal cortex layer III\nsynapses increases vulnerability to genetic and environmental\ninsults in schizophrenia.Biol. Psychiatry92,4 8 0– 490 (2022).\n42. Maynard, K. R. et al. Transcriptome-scale spatial gene expression in\nthe human dorsolateral prefrontal cortex.Nat. Neurosci.24,\n425– 436 (2021).\n43. Alon, S. et al. Expansion sequencing: spatially precise in situ tran-\nscriptomics in intact biological systems.Science 371,\neaax2656 (2021).\n44. Chen, A. et al. Spatiotemporal transcriptomic atlas of mouse\norganogenesis using DNA nanoball-patterned arrays.Cell 185,\n1777– 1792.e1721 (2022).\n45. Cho, C. S. et al. Microscopic examination of spatial transcriptome\nusing Seq-Scope.Cell 184, 3559– 3572.e3522 (2021).\n46. Lewis, S. M. et al. Spatial omics and multiplexed imaging to explore\ncancer biology.Nat. Methods18, 997– 1012 (2021).\n47. Ghosh, A. & Kandasamy, D. Interpretable artiﬁcial intelligence: why\nand when.AJR. Am. J. Roentgenol.214, 1137– 1138 (2020).\n48. Moore, J. H. et al. Preparing next-generation scientists for biome-\nd i c a lb i gd a t a :a r t iﬁcial intelligence approaches.Pers. Med.16,\n247–\n257 (2019).\n49. Filipp, F. V. Opportunities for artiﬁcial intelligence in advancing\nprecision medicine.Curr. Genet. Med. Rep.7,2 0 8– 213 (2019).\n50. Vaswani, A. et al. Attention is all you need.Adv. Neural Inf. Process.\nSyst. 30, 5998– 6008 (2017).\n51. Agarap, A. F. Deep learning using rectiﬁed linear units (relu). arXiv\npreprint arXiv:1803.08375. (2018).\n52. Traag, V. A., Waltman, L. & van Eck, N. J. From Louvain to Leiden:\nguaranteeing well-connected communities.Sci. Rep.9,\n5233 (2019).\n53. Park, J. et al. Cell segmentation-free inference of cell types from\nin situ transcriptomics data.Nat. Commun.12, 3545 (2021).\n5 4 . B a o ,F .e ta l .I n t e g r a t i v es p a t ial analysis of cell morphologies and\ntranscriptional states with MUSE.Nat. Biotechnol.40,\n1200– 1209 (2022).\nArticle https://doi.org/10.1038/s41467-023-41437-w\nNature Communications|         (2023) 14:5618 12\n55. Dong, K. & Zhang, S. Deciphering spatial domains from spatially\nresolved transcriptomics with an adaptive graph attention auto-\nencoder.Nat. Commun.13, 1739 (2022).\n56. Tang, Z. et al. SiGra: Single-cell spatial elucidation through an\nimage-augmented graph transformer.https://doi.org/10.5281/\nzenodo.8124962(2023).\nAcknowledgements\nQ.S. is supported by the Bioinformatics Shared Resources under the NCI\nCancer Center Support Grant to the Comprehensive Cancer Center of\nWake Forest University Health Sciences (P30CA012197), and the\nNational Institute of General MedicalSciences of the National Institutes\nof Health (R35GM151089). J.S. is partiallyﬁnancially supported by the\nIndiana University Precision HealthInitiative and by the Indiana Uni-\nversity Melvin and Bren Simon Comprehensive Cancer Center Support\nGrant from the National Cancer Institute (P30CA 082709). J.S. is also\nsupported by R01LM013771.\nAuthor contributions\nQ.S., J.S., and B.Y. developed the structure and arguments and wrote the\nmanuscript. Q.S. and Z.T. implemented the method, applications, and\nvisualization. Z.L. implemented the web interface. T.H. annotated the\npathological spatial domains. T.Z. reviewed and edited the manuscript.\nAll the authors reviewed and approved theﬁnal manuscript.\nCompeting interests\nThe authors declare no competing interests.\nAdditional information\nSupplementary informationThe online version contains\nsupplementary material available at\nhttps://doi.org/10.1038/s41467-023-41437-w.\nCorrespondenceand requests for materials should be addressed to\nBaijian Yang, Jing Su or Qianqian Song.\nPeer review informationNature Communicationsthanks the anon-\nymous reviewer(s) for their contribution to the peer review of this work. A\npeer reviewﬁle is available.\nReprints and permissions informationis available at\nhttp://www.nature.com/reprints\nPublisher’s noteSpringer Nature remains neutral with regard to jur-\nisdictional claims in published maps and institutional afﬁliations.\nOpen AccessThis article is licensed under a Creative Commons\nAttribution 4.0 International License, which permits use, sharing,\nadaptation, distribution and reproduction in any medium or format, as\nlong as you give appropriate credit to the original author(s) and the\nsource, provide a link to the Creative Commons licence, and indicate if\nchanges were made. The images or other third party material in this\narticle are included in the article’s Creative Commons licence, unless\nindicated otherwise in a credit line to the material. If material is not\nincluded in the article’s Creative Commons licence and your intended\nuse is not permitted by statutory regulation or exceeds the permitted\nuse, you will need to obtain permission directly from the copyright\nholder. To view a copy of this licence, visithttp://creativecommons.org/\nlicenses/by/4.0/.\n© The Author(s) 2023\nArticle https://doi.org/10.1038/s41467-023-41437-w\nNature Communications|         (2023) 14:5618 13",
  "topic": "Computer science",
  "concepts": [
    {
      "name": "Computer science",
      "score": 0.7016394138336182
    },
    {
      "name": "Spatial analysis",
      "score": 0.4741382300853729
    },
    {
      "name": "Transcriptome",
      "score": 0.47281041741371155
    },
    {
      "name": "Computational biology",
      "score": 0.4531049132347107
    },
    {
      "name": "Leverage (statistics)",
      "score": 0.4501311182975769
    },
    {
      "name": "Artificial intelligence",
      "score": 0.44118577241897583
    },
    {
      "name": "Pattern recognition (psychology)",
      "score": 0.43526753783226013
    },
    {
      "name": "Image resolution",
      "score": 0.4233977198600769
    },
    {
      "name": "Data mining",
      "score": 0.38961684703826904
    },
    {
      "name": "Biology",
      "score": 0.25735604763031006
    },
    {
      "name": "Gene expression",
      "score": 0.152992844581604
    },
    {
      "name": "Gene",
      "score": 0.1003483235836029
    },
    {
      "name": "Mathematics",
      "score": 0.09420359134674072
    },
    {
      "name": "Biochemistry",
      "score": 0.0
    },
    {
      "name": "Statistics",
      "score": 0.0
    }
  ],
  "institutions": [
    {
      "id": "https://openalex.org/I4394709130",
      "name": "Indiana University School of Medicine",
      "country": null
    },
    {
      "id": "https://openalex.org/I592451",
      "name": "Indiana University",
      "country": "US"
    },
    {
      "id": "https://openalex.org/I47251452",
      "name": "Wake Forest University",
      "country": "US"
    }
  ],
  "cited_by": 58
}