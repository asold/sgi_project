{
  "title": "CDKAM: a taxonomic classification tool using discriminative k-mers and approximate matching strategies",
  "url": "https://openalex.org/W3093759954",
  "year": 2020,
  "authors": [
    {
      "id": "https://openalex.org/A2742405265",
      "name": "Van Kien Bui",
      "affiliations": [
        "Shanghai Jiao Tong University"
      ]
    },
    {
      "id": "https://openalex.org/A2106402330",
      "name": "Chaochun Wei",
      "affiliations": [
        "Shanghai Jiao Tong University"
      ]
    },
    {
      "id": "https://openalex.org/A2742405265",
      "name": "Van Kien Bui",
      "affiliations": []
    },
    {
      "id": "https://openalex.org/A2106402330",
      "name": "Chaochun Wei",
      "affiliations": []
    }
  ],
  "references": [
    "https://openalex.org/W2754579667",
    "https://openalex.org/W2968450569",
    "https://openalex.org/W2055043387",
    "https://openalex.org/W2170551349",
    "https://openalex.org/W2951160681",
    "https://openalex.org/W2003347102",
    "https://openalex.org/W2159954944",
    "https://openalex.org/W2990618091",
    "https://openalex.org/W2590595794",
    "https://openalex.org/W2566242138",
    "https://openalex.org/W2195724570",
    "https://openalex.org/W2958388979",
    "https://openalex.org/W2981019502",
    "https://openalex.org/W2950671516",
    "https://openalex.org/W2789843538",
    "https://openalex.org/W2952615074",
    "https://openalex.org/W2550586733",
    "https://openalex.org/W2611922188"
  ],
  "abstract": null,
  "full_text": "CDKAM: a taxonomic classification tool \nusing discriminative k‑mers and approximate \nmatching strategies\nVan‑Kien Bui1 and Chaochun Wei1,2* \nBackground\nMetagenome sequencing is a powerful approach to study microbial communities in \nnatural environments [1]. In a pipeline for the metagenomics project, taxonomic clas -\nsification aims to accurately assign each fragment to its corresponding host organism \nand is one of the most important initial steps. With the progress of sequencing technol -\nogy, modern metagenomics methods need to deal with vast sequence datasets. Identify -\ning taxa for billions of reads according to a reference database with many thousands of \nmicrobial genomes available today is becoming a time-consuming process. As the data -\nbase from NCBI is continuously growing and being more complete, we have to consider \nthe trade-off between the size of the reference database and the classification accuracy as \nwell as the computational cost.\nAbstract \nBackground: Current taxonomic classification tools use exact string matching \nalgorithms that are effective to tackle the data from the next generation sequencing \ntechnology. However, the unique error patterns in the third generation sequencing \n(TGS) technologies could reduce the accuracy of these programs.\nResults: We developed a Classification tool using Discriminative K‑mers and Approxi‑\nmate Matching algorithm (CDKAM). This approximate matching method was used for \nsearching k‑mers, which included two phases, a quick mapping phase and a dynamic \nprogramming phase. Simulated datasets as well as real TGS datasets have been tested \nto compare the performance of CDKAM with existing methods. We showed that \nCDKAM performed better in many aspects, especially when classifying TGS data with \naverage length 1000–1500 bases.\nConclusions: CDKAM is an effective program with higher accuracy and lower \nmemory requirement for TGS metagenome sequence classification. It produces a high \nspecies‑level accuracy.\nKeywords: Third generation sequencing, Taxonomic classification, Discriminative \nk‑mer, Approximate matching\nOpen Access\n© The Author(s) 2020. Open Access This article is licensed under a Creative Commons Attribution 4.0 International License, which permits \nuse, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original \nauthor(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third \nparty material in this article are included in the article’s Creative Commons licence, unless indicated otherwise in a credit line to the mate‑\nrial. If material is not included in the article’s Creative Commons licence and your intended use is not permitted by statutory regulation or \nexceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit http://\ncreat iveco mmons .org/licen ses/by/4.0/. The Creative Commons Public Domain Dedication waiver (http://creat iveco mmons .org/publi \ncdoma in/zero/1.0/) applies to the data made available in this article, unless otherwise stated in a credit line to the data.\nSOFTWARE\nBui and Wei  BMC Bioinformatics          (2020) 21:468  \nhttps://doi.org/10.1186/s12859‑020‑03777‑y\n*Correspondence:   \nccwei@sjtu.edu.cn \n1 Department \nof Bioinformatics \nand Biostatistics, \nSchool of Life Sciences \nand Biotechnology, Shanghai \nJiao Tong University, \nShanghai 200240, China\nFull list of author information \nis available at the end of the \narticle\nPage 2 of 13Bui and Wei  BMC Bioinformatics          (2020) 21:468 \nCurrently, there have been many methods developed to taxonomically classify \nmetagenomic data. In general, they can be divided into two categories: (1) alignment-\nbased methods and (2) sequence composition based methods, such as k-mer-based \nmethods [2]. Alignment-based classifiers proceed by aligning metagenome sequences to \nall genomes in the reference database to find the genome with the best alignment. The \nmost well-known alignment algorithm is BLAST program [3]. Although its original pur -\npose was not for metagenomic classification, BLAST still works for this problem. Almost \nall classifiers extended from this method are accurate, however suffer from slow speed. \nAnother type of alignment programs is fast for sequence mapping, such as Bowtie2 [4]. \nBy applying a concatenation procedure to remove the shared regions between different \nstrains of a species, Centrifuge [5] creates a highly compressed BWT-indexed reference \ndatabase and achieves a higher speed. In contrast, sequence composition based meth -\nods, such as CLARK [6] and Kraken [7] are fast. The database of CLARK is basically a \nhash table, which contains a reduced set of k-mers and uses separate chaining to resolve \ncollisions. Any k-mer that appears in more than one genome is removed. In Kraken, \neach k-mer is stored as a hash value and mapped to the lowest common ancestor of the \nsource genome. Kraken 2 [8] improves upon Kraken by using a Compact Hash Table, a \nprobabilistic data structure that supports storing only 15% of the database. The speed \nincreases 5 times while maintaining the accuracy as the original version.\nThe advantages of the third-generation sequencing technologies such as long read \nlength make them attractive for many applications including metagenomics study. With \nfurther improvement in throughput and error rate reduction, this platform can be a great \npromise for analyzing the structure of more complex microbial communities [9]. How -\never, due to the noisy outputs (error rate of 10–20%) of TGS platforms such as Nanopore \n[10] or PacBio [11], current taxonomic classification methods for NGS sequencing data \ndo not work well for TGS sequencing data in some situations. For example, under a sim-\nple binomial model on a read length of 1000 and a uniform 15% error rate, only 73 exact \n16-mers matches are found in the comparison with its correct mapping location [12]. \nMetamaps [12] is a hybrid tool that combines mapping strategy based on short k-mer \nand a probabilistic model using Expectation Maximization (EM) algorithm to estimate \nthe sample composition. Simulating on long reads, Metamaps provides a higher accu -\nracy but a hundred times slower than other existing methods.\nIn this project, we present CDKAM, a new taxonomic classification tool for TGS \nsequencing data with high error rate. The efficiency of our method and other bioinfor -\nmatics applications are compared and validated on simulated and real long-read metage-\nnome sequencing data. The results show that CDKAM can classify TGS sequences to \ntheir source genomes accurately and efficiently.\nImplementation\nDesign of k‑mer data structure\nWe designed a data structure of k-mers as demonstrated in Fig.  1. A long k-mer with a \nsize of 32 bases is chosen to increase the accuracy of classification. For each k-mer, the \nstored information includes a PREFIX (the first n bases, n could be equal or less than 16) \nand a SUFFIX (the last 16 bases). The SUFFIX is further divided into two parts: QM and \nDP with the length of m and 16-m, correspondingly. Additionally, the SUFFIX is paired \nPage 3 of 13\nBui and Wei  BMC Bioinformatics          (2020) 21:468 \n \nwith the genus or species taxonomy ID of the k-mer. Here, we introduce an example \nabout the approximate matching string used in CDKAM. GCT  TAA CAA CGT CGT TAA \nGCTCA_ATG TCA TA is approximately matched with GCT  TAA CAA CGT CGT TAA \nACT CAA ATG TAA TA using the pink part, which contains two replacements and one \ndeletion as the green highlighted characters in Fig. 1.\nReference database creation\nThe reference genomes of archaea, bacteria, fungi, virus and human used for the clade \nexclusion experiments are downloaded from NCBI. As reported in May 2020, the total \nsize is 84 GB.\nThe database construction of CDKAM is shown in Algorithm 1 and Fig.  2. The k-mer \ncollision is solved at three stages: species level, genus level and the whole database level. \nAt the first step of collecting the k-mers of all strains that belong to a species, each \nidentified k-mer is stored only once to avoid duplication. Next, the overlapping k-mers \nthat are shared by at least two species of a genus are assigned to the taxonomy of the \ngenus level. A proportion X% of the k-mers at each genus level is chosen (X% is set to \n15% by default). They are selected uniformly over the range of each genome in order to \nmaximize the chance of hits. After combining the k-mers from all the species used to \nconstruct the database, CDKAM removes any common k-mer between all genomes to \nobtain discriminative k-mers, which represent unique genomic regions characterizing \neach species. Finally, the full set is divided into  4n smaller groups by using the integer \nvalue of k-mer’s PREFIX as the group ID. Consequently, CDKAM only need to store the \nsize of each group, the SUFFIX and taxonomy ID of k-mers, which could reduce a large \nportion of memory consumption.\nFig. 1 The structure of k‑mers in CDKAM. A k‑mer contains two parts: PREFIX and SUFFIX. SUFFIX can further \nbe divided into two fragments: QM and DP , where QM stands for “quick mapping” , DP means “dynamic \nprogramming” , which are two fragments used for quick classification based on approximate matching \nstrategies. For k‑mers with the same PREFIX, we can group them by using a groupID converted from PREFIX, \nand save multiple k‑mers (one PREFIX and multiple SUFFIXes) in a compressed way (see Reference database \ncreation for more details)\nPage 4 of 13Bui and Wei  BMC Bioinformatics          (2020) 21:468 \nAlgorithm 1: Description of CDKAM’s database building phase.\nFig. 2 Diagram of reference database construction. Step 1: From the downloaded reference genomes and \ntaxonomy information, CDKAM creates the mapping of sequences IDs and taxonomy IDs. Step 2: collecting \nk‑mers and solving the k‑mer collision to obtain discriminative k‑mers as demonstrated in the Algorithm 1. \nStep 3: compressing the database. In the final step, the whole set of k‑mers is divided into smaller groups. \nThen, for each group, CDKAM stores the number of kmers that shared the same group ID (saved in the Size \nfile), the SUFFIX of k‑mers (saved in the Suffix file) and their taxonomy ID (saved in the Taxonomy_ID file)\nPage 5 of 13\nBui and Wei  BMC Bioinformatics          (2020) 21:468 \n \nClassification based on approximate mapping approach\nAlgorithm 2 presents the searching algorithm of CDKAM. For each k-mer of the querying \nread, the positions in the database that contain k-mers with the same group ID are exam-\nined. CDKAM uses a linear probe over this range, while Kraken and CLARK apply a binary \nsearch. During the searching procedure, an approximation algorithm is utilized to ignore at \nmost 3 errors for a matched k-mer. The QM component with m bases in the SUFFIX of the \nquerying k-mer and those in the database are mapped by a “Quick Matching” technique. \nTheir converted integer values are masked by a seed mask such as 11,111*, 1111*1, … before \ncomparing. The purpose of this step is to guarantee at least m − 1 bases are equal. With no \nmore than one substitution, it can pass and move to the second check. The comparison of \nDP part is done by a banded “Dynamic Programming” algorithm with a width of 4. In this \nmanner, we tolerate 2 errors, which can include insertions and deletions. The final assign-\nment of a read to a taxonomy ID is determined by the highest number of matched k-mers.\nAlgorithm 2: CDKAM searching procedure.\nDatasets for model selection\nWe compare Kraken 2, Centrifuge, CLARK, and CDKAM in different settings involving \nfive simulated datasets and three real datasets.\nEach simulated dataset contains multiple data. In the first scenario, we aim to assess \nthe detection ability of classifiers when all sequencing reads were from genomes avail -\nable in the reference database. For each bacterial genome in the reference database, 20 \nsimulated reads are generated. The first dataset contains 342,360 reads from 17,118 bac -\nterial genomes in the reference database. Next, we simulate a metagenome sample with \n40 prokaryotic genomes as the simulation of Kraken2 [8] (Additional file  1: Table S5). \nFor each genome, we generate 10,000 reads. There are totally 400,000 reads. The read \nlength in both datasets is exactly 1000 bases. For each error rate at 5%, 10%, 15%, or \n20%, sequencing errors are randomly added on the original reads (No. 1), and we call \nPage 6 of 13Bui and Wei  BMC Bioinformatics          (2020) 21:468 \nthe resulted data No. 2, 3, 4, and 5 sample of the dataset respectively. Based on the same \ntesting genomes, the third dataset contains five samples with 15% error rate, but the \nlength of reads varies from 1000, 1500, 2000, 3000, and 4000 bases. The fourth dataset \nis created similarly to the third one with 20% error rate are added. The fifth simulation \nis carried out on a particular database and dataset. 70% of the bacterial genomes (4142 \nspecies) are chosen randomly and used for building the database, while the remaining \npart of the reference genomes is used for generating testing reads. For each strain among \n1752 species in the testing set, 4000-bases long reads with 15% error rate are created.\nThree sets of real metagenomic sequencing data are PRJNA493153 [13], Zymo R10 \n[14], and Zymo R10v2. The first one is a real Nanopore MinION sequencing data from \nthe human microbe project PRJNA493153, which contains 548,721 reads with the aver -\nage length of 1000 bases. There are 10 samples, the total size is 1.2 GB. Zymo R10 data -\nset is a Nanopore GridION sequencing data of the Zymo Community Standards R10 \nsynthetic community, which comprises five Gram-positive bacteria, three Gram-nega -\ntive bacteria, and two yeasts (Additional file  1: Table S6). There are more than 3 million \nreads with a total size of 25  GB. Additional file  1: Figure S1 presents statistics on the \nread lengths of Zymo dataset with the mean of 3860 bases. To generate a species-level \ntrue set, we use Minimap2 [15] with -ax map-ont to map the reads against the refer -\nence genomes provided by Zymo. All reads that cannot be mapped by Minimap2 are \nconsidered as the interference. For a read that can be mapped to multiple genomes by \nMinimap2, if a classifier provides the result matched with one of the possible taxonomy \nIDs, we will count as a true-positive classification. Zymo R10v2 dataset is modified from \nthe Zymo R10 dataset in order to test classifiers against the TGS data sequences that \nhave medium lengths. For each read, we trim 1500 bases in the middle region to create a \nnew dataset.\nEvaluation of accuracy\nTo compare CDKAM with other tools, sensitivity, precision, and F1-scores are used and \nevaluated at genus or species level. The classified reads are grouped into the following \ncategories: true-positive (TP), false-negative (FN), vague-positive (VP), and false-posi -\ntive (FP). TP are those sequences assigned to the right genomes at the same taxonomy \nlevel or lower levels (species level is a lower level compared to genus level). A read \nbelongs to the FN category if the classifier fails to assign the sequence. The concept of \nVP is used for the evaluation at species level only. A read classification is called a VP if it \nis assigned correctly only at genus level and does not have any further information about \nspecies level. Finally, an FP classification is defined as an incorrect classification, that is, \nnot at the true genus nor true species of origin. The unclassified reads would belong to \ntrue-negative (TN) or false-negative (FN).\nFor example, a classification of an Escherichia coli fragment as Escherichia would be \nevaluated as a TP at genus level, but as a VP at species level. Classification of that same \nfragment as Escherichia albertii would be evaluated as FP at species level, but as a TP \nat genus level (because the LCA of Escherichia albertii and Escherichia coli is the genus \ntaxon Escherichia).\nPage 7 of 13\nBui and Wei  BMC Bioinformatics          (2020) 21:468 \n \nThe detection rate is the proportion of the positive classified reads vs the total num -\nber of reads, i.e. D-rate = (TP + FP + VP)/TOTAL. Sensitivity at a certain taxonomy \nlevel is defined as the proportion of the number of true-positive assignments vs the \ntotal number of reads classified, i.e. SEN = TP/(TP + FP + VP + FN). We define pre -\ncision as the proportion of classifications that are true positives among the number of \npositive calls (excluding vague positives when evaluating at species level), i.e. PRE = TP/\n(TP + FP). An F1-score is computed as the harmonic mean of sensitivity and precision, \ni.e. F1 = 2 × SEN × PRE/(SEN + PRE).\nComputation environment\nCDKAM and other taxonomic classifiers (Kraken2 v2.0.9, Centrifuge v1.0.4, CLARK \nv1.2.6.1) are benchmarked on a compute node having 512  GB of memory and Intel \nE5-2630 v4 processors. All experiments are run on single-thread mode. The database of \nall classifiers are updated to May 2020.\nResults and discussion\nParameter settings\nBy selecting the first n bases of k-mers as the PREFIX, the numbers showing the size of \neach group in the database require 4 × 4n bytes. Besides that, the value of m during the \nsearching query also influences the speed and efficiency of the CDKAM. In this part, we \npresent the performance of X = 15% version with the different parameters of n and m \non the sample No. 4 in the first dataset. Figure  3A presents the processing time and the \nextra memory needed for the group IDs when m = 6 and n varies. Meanwhile, Fig.  3B \nshows the processing time and the F1-scores at genus level with different values of m \nand a fixed n = 14. CDKAM tends to decrease the accuracy when m increases, but the \ndifference is slight. Remarkably, the case of m = 6 is the optimal point of two comparison \nalgorithms, quick mapping (QM) and dynamic programming (DP). From these experi -\nments, we choose (n = 14, m = 6) to balance speed, memory usage, and accuracy.\nThe parameter X affects the size of the built database. A version with a greater value of \nX produces a larger database, which could decrease the speed but increase the accuracy. \nThe difference in the accuracy of CDKAM with X = 10%, X = 15% and X = 20% is small, \nwhile that of CDKAM with X = 5% drops dramatically. More specific results are pre -\nsented in Additional file  1: Table S1, Table S2, and Fig. 7. Unlike the collision avoidance \nalgorithm in CLARK, which eliminates all intersections in the k-mer set of each species, \nthe shared k-mers at the genus level in CDAKM are given a high priority and saved in \nthe database. Consequently, it is unneeded to keep all k-mers in the final set. A fraction \nof the total k-mers can provide a good resolution about the true taxonomic origin of the \nsequencing data and also reduce the large computation cost.\nPerformance on simulated data\nWhen dealing with simulated reads without error, most tools give F1-scores greater than \n90% at the genus level (Additional file  1: Table S1, Table S2). However, on the test cases \ncontaining sequencing errors, CDKAM achieves higher accuracy than any other classi -\nfier. For example, the default CDKAM version still exceeded an F1-score of 95.79% and \nPage 8 of 13Bui and Wei  BMC Bioinformatics          (2020) 21:468 \n94.54% when classifying reads with 15% sequencing errors in the first and the second \ndataset. However, the accuracy of CLARK decreases significantly due to a low detec -\ntion rate if a long k-mer (31-mers) is chosen. A shorter k-mer (24-mers) version gives a \nhigher sensitivity, but the false positive would increase (Fig.  4). Similarly, Kraken 2 and \nCentrifuge also correctly classify a smaller amount of reads compared to CDKAM. This \nis caused by the exact string matching algorithm since many k-mers with one base varia-\ntion could not be detected.\nWe use the third and the fourth experiment to assess the effect of read length on clas -\nsification accuracy (Additional file 1: Table S3, Table S4). It is worth noting that the accu-\nracy drops sharply between 15 and 20% error rate for all methods on the shorter reads. \nFor example, on the read length 1000-bases, the F1-score of Kraken2 at genus level \nreduces significantly from 84.60 to 40.41%. By contrast, on the read length 4000-bases, \nthe decrease is less serious. In this case, the gap is only 12.98%, from 97.89 to 84.91%. \nWhen the read length increases, there would be more hits that could provide more spe -\ncific information about their true host organism. As a consequence, all methods perform \nbetter than they do on the shorter reads. Kraken2 and Centrifuge show a significant \nimprovement with the F-1 score at genus level up to more than 97% when classifying the \n4000-bases reads on the third dataset (Additional file  1: Table S3). It is noticeable that \non the fourth dataset with a higher error rate at 20%, they perform worse than CDKAM \n(Additional file  1: Table S4). As opposed to a fall in the accuracy of other classifiers at \nspecies level, CDKAM with X = 20% still has a high F1-score in both simulations, which \nare 90.68% and 88.08%. These results indicate that CDKAM is more robust than other \nmethods in the deal with the sequencing error, in particular for situations in which the \nerror rate becomes higher.\nThe ability to deal with unknown sequences is an important concern in metagenom -\nics, especially for those environmental samples with a high percentage of unknown \nspecies, which have no similar genome with a high sequence identity in the reference \ndatabase. To address this, we include a fifth dataset by dividing the whole reference \ngenomes of bacteria into two sets: 70% species for the reference database construction \nand the remaining 30% for testing, and then evaluating the accuracy at genus level. By \nFig. 3 Performance of CDKAM with the different parameter settings. a m = 6 versus different values of n. b \nn = 14 with different values of m \nPage 9 of 13\nBui and Wei  BMC Bioinformatics          (2020) 21:468 \n \nselecting genomes randomly, the sequencing reads in the testing set could be originated \nfrom strains not represented in the reference database, or from those having siblings at \nfamily or genus level in the database. In this experiment, CDKAM detects 63.83% of the \nreads and then assign them to sibling species with those in the database. 37.7% of species \nhave more than 50% classified reads, while 49.7% of species have more than 25% classi -\nfied reads. In addition, 32.64% of species cannot be found, which means they have very \ndifferent sequences and their k-mer sets do not intersect with those of other species. \nIt is clear from these results that classifying unknown sequences is still a challenge for \nCDKAM.\nPerformance on real data\nCDKAM with X = 15% is selected to perform the evaluation on the real TGS data. On \nthe PRJNA493153 dataset, CDKAM shows the highest consistency (Fig.  5 and Addi -\ntional file 1: Figure S2). The detection rate of CDKAM, Kraken2, Centrifuge, CLARK24 \nand CLARK31 are 59.77%, 55.32%, 57.99%, 62.80% and 44.41%, correspondingly. \nBecause there is no benchmark for this microbe community, we count how many reads \ngetting the same genus-level taxonomy ID between different methods. There are 44.36% \nclassified reads by CDKAM sharing the result with Kraken2 and 42.26% of them sharing \nthe result with Centrifuge.\nThe evaluation at the genus level on the Zymo R10 dataset indicates that the sensitiv -\nity of the CDKAM and Kraken2 assignments is higher than that of the remaining tools, \nwhile CLARK using 31-mers provides the highest precision (Fig.  6). The F1-score of \nCDKAM at genus level is 94.91% and slightly greater than that of CLARK and Kraken2, \nwhich are 92.31% and 92.02%, respectively. Besides, CDKAM performs the best at spe -\ncies level. The compositional estimation by CDKAM is the closet to alignment stats by \nMinimap2 as presented in Additional file  1: Table  S7. Turning to the smaller dataset \nZymo R10v2, almost all classifiers show a trend towards lower classification accuracy by \n2–4% for shorter reads. Meanwhile, CDKAM performs stably and achieves the F1-score \nof 91.19% at the species level.\nFig. 4 Comparison of methods on a data with a high sequencing error rate. Accuracy measurement types \ninclude detection rate, sensitivity, precision, and F1‑score. The data used for the experiment is the sample No. \n4 in the first dataset, which contains an error rate of 15%\nPage 10 of 13Bui and Wei  BMC Bioinformatics          (2020) 21:468 \nRuntime and memory consumption\nWe use the Zymo R10 dataset to measure the actual processing speed of classifiers. As \nshown in Fig. 7, Kraken2 is ultrafast, whereas Centrifuge, CLARK and CDKAM could be \ngrouped together in terms of speed. CDKAM is slower than Centrifuge, but the differ -\nence is negligible. Although the approximation algorithm is slower than the exact match-\ning algorithm in general, a small and sufficient database reinforces CDKAM to speed up. \nIn fact, CDKAM is slightly faster than CLARK in the case of classifying a medium size \ndataset such as PRJNA493153 data. For an experimental dataset of 100,000 TGS reads, \nCDKAM will finish the sequence classification in about 5 min.\nCDKAM supports parallel processing by using thread pools mechanism. Each local \nthread reads a fragment of the input file, save it temporarily in the buffer and then wait \nin the queue. After finishing the reading process of N fragments, N threads carry out the \nclassification parallelly. The classification results from these threads are finally merged \ninto the output file. The wall-clock time of CDKAM (X = 15%) when running with 1, 2, 4, \n8, and 16 threads on the Zymo R10 dataset are 129, 58, 32, 17, and 10 min, respectively.\nNovelty of CDKAM\nThe key novelty of CDKAM is the combination of an effective collision avoidance mech -\nanism for building the database and approximate matching strategies for searching \nk-mers. It can deal with high sequencing error rates in TGS data and maintain a high \nspeed as well. To achieve these purposes, a small portion of the final k-mer set is stored \nin the database of CDKAM, which can decrease the memory consumption and increase \nthe processing speed, while approximate matching strategies with two phases of quick \nmapping and dynamic programming algorithm provide a higher opportunity to detect \nthe alignment of query sequences and the database.\nFig. 5 Comparison between CDKAM and other classification tools on the PRJNA493153 dataset. This figure is \ncreated using upset [16] (https ://caley do.org/tools /upset /) to show the intersection of results from different \nclassification tools\nPage 11 of 13\nBui and Wei  BMC Bioinformatics          (2020) 21:468 \n \nConclusions\nCDKAM is  a new taxonomy classification tool designed for sequencing reads with \nhigh error rates. Compared to existing tools, it has good speed, small memory require -\nment and high accuracy. Especially, it is more accurate than all other existing tools for \nreads with medium lengths, such as 1000–1500 bases. For very long sequencing reads, \nits accuracy performance is comparable to the best existing tools, such as Kraken2 and \nCentrifuge.\nFig. 6 Comparison of the accuracy of classification methods on a real Nanopore (Zymo R10) dataset\nFig. 7 Comparision of speed (million bases per minutes) and memory consumption (GB) of classifiers on the \nZymo R10 dataset\nPage 12 of 13Bui and Wei  BMC Bioinformatics          (2020) 21:468 \nAvailability and requirements\nProject name: CDKAM\nProject home page: https ://githu b.com/SJTU-CGM/CDKAM \nOperating system(s): Linux\nProgramming language: Perl, C++ 11, and Shell\nOther requirements: Perl (5.10.1 or above), G++ (4.8.5 or above)\nLicense: GNU GPL v.3\nAny restrictions to use by non-academics: None\nSupplementary information\nSupplementary information accompanies this paper at https ://doi.org/10.1186/s1285 9‑020‑03777 ‑y.\nAdditional file 1. Supplementary file for Table S1‑7 and Figure S1‑2.\nAbbreviations\nBWT: Burrows–Wheeler transform; NCBI: National Center for Biotechnology Information; NGS: The next generation \nsequencing; TGS: The third generation sequencing.\nAcknowledgements\nWe thank the High Performance Computing Center (HPCC) at Shanghai Jiao Tong University for the computation.\nAuthors’ contributions\nConception of project: CCW. System design: VKB, CCW. Implementation and evaluation of system: VKB. Manuscript writ‑\ning: VKB, CCW. All authors read and approved the final manuscript.\nFunding\nThis work was supported by Grants from the Cross‑Institute Research Fund of Shanghai Jiao Tong University \n(YG2017ZD01), the National Natural Science Foundation of China (61472246) and the National Basic Research Program \nof China (2013CB956103). The funders had no role in study design, data collection and analysis, decision to publish, or \npreparation of the manuscript.\nAvailability of data and materials\nAll simulated data in this paper is available in https ://githu b.com/SJTU‑CGM/CDKAM . The Zymo data are publicly avail‑\nable (https ://githu b.com/Loman Lab/mockc ommun ity)\nEthics approval and consent to participate\nNot applicable.\nConsent for publication\nNot applicable.\nCompeting interests\nThe authors declare that they have no competing interest.\nAuthor details\n1 Department of Bioinformatics and Biostatistics, School of Life Sciences and Biotechnology, Shanghai Jiao Tong Uni‑\nversity, Shanghai 200240, China. 2 Shanghai Center for Systems Biomedicine, Shanghai Jiao Tong University, Shang‑\nhai 200240, China. \nReceived: 19 June 2020   Accepted: 23 September 2020\nReferences\n 1. Quince C, Walker AW, Simpson JT, Loman NJ, Segata N. Shotgun metagenomics, from sampling to analysis. Nat \nBiotechnol. 2017;35:833–44.\n 2. Ye SH, Siddle KJ, Park DJ, Sabeti PC. Benchmarking metagenomics tools for taxonomic classification. Cell. \n2019;178:779–94.\n 3. Altschul SF, Gish W, Miller W, Myers EW, Lipman DJ. Basic local alignment search tool. Mol Biol. 1990;215:403–10.\n 4. Langmead B, Salzberg SL. Fast gapped‑read alignment with bowtie 2. Nat Methods. 2012;9:357–9.\n 5. Kim D, Song L, Breitwieser FP , Salzberg SL. Centrifuge, rapid and sensitive classification of metagenomic sequences. \nGenome Res. 2016;26:1721–9.\n 6. Ounit R, Wanamaker S, Close TJ, Lonardi S. Clark: fast and accurate classification of metagenomic and genomic \nsequences using discriminative k‑mers. BMC Genom. 2015;16:236.\nPage 13 of 13\nBui and Wei  BMC Bioinformatics          (2020) 21:468 \n \n•\n \nfast, convenient online submission\n •\n  \nthorough peer review by experienced researchers in your ﬁeld\n• \n \nrapid publication on acceptance\n• \n \nsupport for research data, including large and complex data types\n•\n  \ngold Open Access which fosters wider collaboration and increased citations \n \nmaximum visibility for your research: over 100M website views per year •\n  At BMC, research is always in progress.\nLearn more biomedcentral.com/submissions\nReady to submit y our researc hReady to submit y our researc h  ?  Choose BMC and benefit fr om: ?  Choose BMC and benefit fr om: \n 7. Wood DE, Salzberg SL. Kraken: ultrafast metagenomic sequence classification using exact alignments. Genome Biol. \n2014;15:46.\n 8. Wood DE, Lu J, Langmead B. Improved metagenomic analysis with kraken 2. Genome Biol. 2019;20:257.\n 9. Brown BL, Watson M, Minot SS, Rivera MC, Franklin B. MinionTM nanopore sequencing of environmental metagen‑\nomes: a synthetic approach. GigaScience. 2017;6:1–10.\n 10. Jain M, Olsen HE, Paten B, Akeson M. The oxford nanopore minion: delivery of nanopore sequencing to the genom‑\nics community. Genome Biol. 2016;17:256.\n 11. Rhoads A, Au KF. Pacbio sequencing and its applications. Genom Proteom Bioinform. 2015;13(5):278–89.\n 12. Dilthey AT, Jain C, Koren S, Phillippy AM. Strain‑level metagenomic assignment and compositional estimation for \nlong reads with metamaps. Nat Commun. 2019;10(1):3066.\n 13. Wongsurawat T, Nakagawa M, Atiq O, Coleman HN, Jenjaroenpun P , Allred JI, Trammel A, Puengrang P , Ussery DW, \nNookaew I. An assessment of oxford nanopore sequencing for human gut metagenome profiling: a pilot study of \nhead and neck cancer patients. J Microbiol Methods. 2019;166:105739.\n 14. Nicholls SM, Quick JC, Tang SQ, Loman NJ. Ultra‑deep, long‑read nanopore sequencing of mock microbial commu‑\nnity standards. GigaScience. 2019;8(5):043.\n 15. Li H. Minimap2: pairwise alignment for nucleotide sequences. Bioinformatics. 2018;34:3094–100.\n 16. Conway JR, Lex A, Gehlenborg N. Upsetr: an R package for the visualization of intersecting sets and their properties. \nBioinformatics. 2017;33:2938–40.\nPublisher’s Note\nSpringer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.",
  "topic": "Discriminative model",
  "concepts": [
    {
      "name": "Discriminative model",
      "score": 0.8429811000823975
    },
    {
      "name": "Matching (statistics)",
      "score": 0.634737491607666
    },
    {
      "name": "DNA microarray",
      "score": 0.5179337859153748
    },
    {
      "name": "Computer science",
      "score": 0.4868128001689911
    },
    {
      "name": "Computational biology",
      "score": 0.4103752374649048
    },
    {
      "name": "Artificial intelligence",
      "score": 0.36126261949539185
    },
    {
      "name": "Pattern recognition (psychology)",
      "score": 0.3507768511772156
    },
    {
      "name": "Data mining",
      "score": 0.3252410888671875
    },
    {
      "name": "Biology",
      "score": 0.2884035110473633
    },
    {
      "name": "Mathematics",
      "score": 0.2181941270828247
    },
    {
      "name": "Genetics",
      "score": 0.15060263872146606
    },
    {
      "name": "Statistics",
      "score": 0.14020559191703796
    },
    {
      "name": "Gene expression",
      "score": 0.0
    },
    {
      "name": "Gene",
      "score": 0.0
    }
  ],
  "institutions": [
    {
      "id": "https://openalex.org/I183067930",
      "name": "Shanghai Jiao Tong University",
      "country": "CN"
    }
  ],
  "cited_by": 15
}