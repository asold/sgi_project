{
  "title": "A comparison of large language model versus manual chart review for extraction of data elements from the electronic health record",
  "url": "https://openalex.org/W4386356152",
  "year": 2023,
  "authors": [
    {
      "id": "https://openalex.org/A2130019586",
      "name": "Jin Ge",
      "affiliations": [
        "University of California, San Francisco"
      ]
    },
    {
      "id": "https://openalex.org/A2120387538",
      "name": "Michael Li",
      "affiliations": [
        "University of California, San Francisco"
      ]
    },
    {
      "id": "https://openalex.org/A5092819876",
      "name": "Molly B. Delk",
      "affiliations": [
        "Tulane University"
      ]
    },
    {
      "id": "https://openalex.org/A2129142352",
      "name": "Jennifer C. Lai",
      "affiliations": [
        "University of California, San Francisco"
      ]
    },
    {
      "id": "https://openalex.org/A2130019586",
      "name": "Jin Ge",
      "affiliations": [
        "University of California, San Francisco"
      ]
    },
    {
      "id": "https://openalex.org/A2120387538",
      "name": "Michael Li",
      "affiliations": [
        "University of California, San Francisco"
      ]
    },
    {
      "id": "https://openalex.org/A5092819876",
      "name": "Molly B. Delk",
      "affiliations": []
    },
    {
      "id": "https://openalex.org/A2129142352",
      "name": "Jennifer C. Lai",
      "affiliations": [
        "University of California, San Francisco"
      ]
    }
  ],
  "references": [
    "https://openalex.org/W4360993412",
    "https://openalex.org/W4384071683",
    "https://openalex.org/W2893608205",
    "https://openalex.org/W2606209221",
    "https://openalex.org/W4367626167",
    "https://openalex.org/W2170505850",
    "https://openalex.org/W3089091231",
    "https://openalex.org/W3122241445"
  ],
  "abstract": "Structured Abstract Importance Large language models (LLMs) have proven useful for extracting data from publicly available sources, but their uses in clinical settings and with clinical data are unknown. Objective To determine the accuracy of data extraction using “Versa Chat,” a chat implementation of the general-purpose OpenAI gpt-35-turbo LLM model, versus manual chart review for hepatocellular carcinoma (HCC) imaging reports. Design We engineered a prompt for the data extraction task of six distinct data elements and input 182 abdominal imaging reports that were also manually tagged. We evaluated performance by calculating accuracy, precision, recall, and F1 scores. Setting/Participants Cross-sectional abdominal imaging reports of patients diagnosed with hepatocellular carcinoma enrolled in the Functional Assessment in Liver Transplantation (FrAILT) study.",
  "full_text": "A comparison of large language model versus manual chart review for extracƟon of data elements \nfrom the electronic health record \n \nJin Ge, MD, MBA1; Michael Li, MD, MPH1; Molly B. Delk, MD2; Jennifer C. Lai, MD, MBA1 \n \n1 Division of Gastroenterology and Hepatology, Department of Medicine, University of California – San \nFrancisco, San Francisco, CA \n2 SecƟon of Gastroenterology and Hepatology, Department of Medicine, Tulane University School of \nMedicine, New Orleans, LA \n \nFinancial/Grant Support: \nThe authors of this study were supported in part by the KL2TR001870 (NaƟonal Center for Advancing \nTranslaƟonal Sciences, Ge), P30DK026743 (UCSF Liver Center Grant, Ge, Li, and Lai), ACG Junior Faculty \nDevelopment Award (American College of Gastroenterology InsƟtute, Li), and \nR01AG059183/K24AG080021 (NaƟonal InsƟtute on Aging, Lai).  The content is solely the responsibility of \nthe authors and does not necessarily represent the oﬃcial views of the NaƟonal InsƟtutes of Health or \nany other funding agencies.  The funding agencies played no role in the analysis of the data or the \npreparaƟon of this manuscript. \n \nAbbreviaƟons: \nCI, conﬁdence interval; FrAILT, FuncƟonal Assessment in Liver TransplantaƟon; GAI, generaƟve arƟﬁcial \nintelligence; HCC, hepatocellular carcinoma; LI-RADS, Liver Imaging ReporƟng and Data System; LLM, \nlarge language model; NLP , natural language processing; PHI, protected health informaƟon; UCSF, \nUniversity of California, San Francisco \n \nCorrespondence:   \nJin Ge, MD, MBA \n513 Parnassus Avenue, S-357 \nSan Francisco, CA 94143   \nE-mail: jin.ge@ucsf.edu  \nFax: 415-476-0659 \n \n . CC-BY-NC-ND 4.0 International licenseIt is made available under a \n is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity. (which was not certified by peer review)\nThe copyright holder for this preprintthis version posted September 1, 2023. ; https://doi.org/10.1101/2023.08.31.23294924doi: medRxiv preprint \nNOTE: This preprint reports new research that has not been certified by peer review and should not be used to guide clinical practice.\nDisclosures:   \nThe authors of this manuscript have the following potenƟal conﬂicts of interest to disclose: \n- Dr. Jin Ge receives research support from Merck and Co; and consults for Astellas \nPharmaceuƟcals/Iota Biosciences. \n- Dr. Jennifer C. Lai receives research support from Lipocene and Vir Biotechnologies; receives an \neducaƟon grant from Nestle NutriƟon Sciences; serves on an advisory board for Novo Nordisk; \nand consults for Genﬁt, Third Rock Ventures, and Boehringer Ingelheim. \n \nWriƟng Assistance:  \nNone. \n \nAuthor ContribuƟons: \nAuthorship was determined using ICMJE recommendaƟons. \nGe: Study concept and design; data extracƟon; analysis and interpretaƟon of data; draŌing of \nmanuscript; criƟcal revision of the manuscript for important intellectual content; staƟsƟcal analysis; \nstudy supervision \nLi: Analysis and interpretaƟon of data; data extracƟon; criƟcal revision of the manuscript for important \nintellectual content \nDelk: Analysis and interpretaƟon of data; data extracƟon; criƟcal revision of the manuscript for \nimportant intellectual content \nLai: Study concept and design; analysis and interpretaƟon of data; criƟcal revision of the manuscript for \nimportant intellectual content; study supervision \n \nData Acknowledgement: \n- The authors thank the UCSF AI Tiger Team, Academic Research Services, Research InformaƟon \nTechnology, and the Chancellor’s Task Force for GeneraƟve AI for their soŌware development, \nanalyƟcal, and technical support related to the use of Versa API gateway (the UCSF secure \nimplementaƟon of large language models and generaƟve AI via API gateway), Versa chat (the \nchat user interface), and related data assets. \n \nWord Count: \n1,185 (without references)  \n . CC-BY-NC-ND 4.0 International licenseIt is made available under a \n is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity. (which was not certified by peer review)\nThe copyright holder for this preprintthis version posted September 1, 2023. ; https://doi.org/10.1101/2023.08.31.23294924doi: medRxiv preprint \nAbstract: \nImportance: Large language models (LLMs) have proven useful for extracƟng data from publicly available \nsources, but their uses in clinical seƫngs and with clinical data are unknown.  \nObjecƟve: To determine the accuracy of data extracƟon using “Versa Chat,” a chat implementaƟon of \nthe general-purpose OpenAI gpt-35-turbo LLM model, versus manual chart review for hepatocellular \ncarcinoma (HCC) imaging reports. \nDesign: We engineered a prompt for the data extracƟon task of six disƟnct data elements and input 192 \nabdominal imaging reports that were also manually tagged.  We evaluated performance by calculaƟng \naccuracy, precision, recall, and F1 scores. \nSeƫng/ParƟcipants:  Cross-secƟonal abdominal imaging reports of paƟents diagnosed with \nhepatocellular carcinoma enrolled in the FuncƟonal Assessment in Liver TransplantaƟon (FrAILT) study. \n \n  \n . CC-BY-NC-ND 4.0 International licenseIt is made available under a \n is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity. (which was not certified by peer review)\nThe copyright holder for this preprintthis version posted September 1, 2023. ; https://doi.org/10.1101/2023.08.31.23294924doi: medRxiv preprint \nLarge language models (LLMs) hold tremendous potenƟal for acceleraƟng clinical research and \naugmenƟng clinical care.1  One of the most promising LLM use cases is natural language processing (NLP) \nand extracƟon of structured elements from unstructured clinical text, such as imaging reports.2  LI-RADS \n(Liver Imaging ReporƟng and Data System) was created by the American College of Radiology and \nprovides standardized and reproducible reporƟng of hepatocellular carcinoma (HCC) imaging for clinical \ncare and research.3  Due to the LI-RADS reporƟng system, HCC imaging provides an ideal test case for \nLLM-enabled NLP extracƟon of structured data from unstructured clinical text.  We sought to assess the \nperformance of a commercially available general-purpose LLM, deployed in an isolated protected \nenvironment and permiƩed to be used with protected health informaƟon (PHI), versus human manual \nchart review in extracƟng six disƟnct data elements from abdominal imaging reports. \n \nWe used “Versa Chat,” the chat user interface of the general purpose MicrosoŌ Azure OpenAI gpt-35-\nturbo LLM model (“Versa”) that is implemented in a protected environment at the University of \nCalifornia, San Francisco (UCSF) to accommodate the use of PHI and intellectual property, for this study.4  \n“Versa,” like other gpt-35-turbo implementaƟons, has a token limit of 4,096 tokens, deﬁned as the unit \nthat OpenAI generaƟve arƟﬁcial intelligence (GAI) models use to compute text length.   One token \napproximates to about four characters or one word.  This 4,096 token limit includes the count from both \nthe user prompt and compleƟon of the task for each session.5  We manually reviewed 182 CT or MRI \nabdomen imaging reports without evidence of locoregional treatments from 169 paƟents diagnosed \nwith HCC enrolled in the FuncƟonal Assessment in Liver TransplantaƟon (FrAILT) study at UCSF.6  The \nimaging reports, therefore, may or may not contain evidence of HCC as a diagnosis could have occurred \nsubsequent to the date of imaging.  We manually tagged the imaging reports for six disƟnct data \nelements: 1. Maximum LI-RADS score for any HCC lesions (deﬁned as 4 or 5), 2. Number of HCC lesions, \n3. Diameter (cm) of the largest lesion, 4. Sum of diameters (cm) of all HCC lesions, 5. Presence or \nabsence of macrovascular invasion, or 6. Presence or absence of extrahepaƟc metastases. \n \nAll 182 imaging reports were trimmed to only include the ﬁndings and impressions secƟons.  Due to the \nlimitaƟon of 4,096 tokens per session in “Versa Chat,” we iteraƟvely developed a “zero-shot” prompt \n(deﬁned as a prompt that does not contain training data) with tesƟng on the ﬁrst ﬁve records (Figure 1).7  \nAs snowballing of data passed per prompt oŌen led to execuƟon failure from exceeding the token limit, \nwe ran 26 sessions of the ﬁnal “zero-shot” extracƟon prompt in “Versa Chat” with approximately seven \nrecords per session for data extracƟon (see Figure 2 for an example exchange using mock data with \n . CC-BY-NC-ND 4.0 International licenseIt is made available under a \n is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity. (which was not certified by peer review)\nThe copyright holder for this preprintthis version posted September 1, 2023. ; https://doi.org/10.1101/2023.08.31.23294924doi: medRxiv preprint \n“Versa Chat”).  If “Versa Chat” produced an output that required minor addiƟonal formaƫng, we made \nthose changes within the chat interface prior to collecƟng and aggregaƟng the data.  The total amount of \nƟme required to process all 182 records was 45 minutes. \n \nWe evaluated the accuracy of “Versa Chat” data extracƟons versus manual chart review with each \nimaging report as a separate record.  We calculated performance metrics, notably accuracy, precision, \nrecall, and F1 score (harmonic mean of precision and recall commonly used to evaluate classiﬁcaƟon in \nmachine learning) for each of the six data elements whenever possible.  For mulƟlevel classiﬁcaƟons \n(maximum LI-RADS score, number of HCC lesions, diameter of the largest lesion, and sum of tumor \ndiameters), we calculated weighted-average precision, recall, and F1 score.  For binary classiﬁcaƟons \n(macrovascular invasion and extrahepaƟc metastases), we deﬁned the presence of these features as a \nposiƟve case for precision, recall, and F1 score.\n8  We esƟmated 95% conﬁdence intervals (CI) for \nperformance metrics whenever possible through bootstrapping with 2,000 iteraƟons.  All staƟsƟcal \nanalyses were conducted in R, version 4.3.1 “Beagle Scouts” (R Core Team, Vienna, Austria),9 and R \npackages boot, version 1.3-28.1,10 and caret, version 6.0-94.11  This study was approved by the UCSF \nInsƟtuƟonal Review Board in Study #11-07513. \n \nThe performance metrics for the six data elements extracted by the gpt-35-turbo “Versa Chat” model \nversus manual chart review are featured in Table 1.  The overall accuracy of “Versa Chat” was 0.889 (95% \nCI 0.869-0.907) versus manual review.  The accuracy rate varied between 0.725 (95% CI 0.643-0.780) for \nsum of tumor diameters to 0.989 (95% CI 0.956-0.995) for macrovascular invasion.  In general, accuracy \nwas higher for simple classiﬁcaƟon tasks (maximum LI-RADS score, macrovascular invasion, and \nextrahepaƟc metastases) compared to those that required comparison (maximum tumor diameter) or \nsummaƟon (number of tumors and sum of tumor diameters).  As macrovascular invasion and \nextrahepaƟc metastases did not have any true posiƟve cases, the precision for these two data elements \nwere both zero.  Similarly, as there were no false negaƟve cases, the recall and F1 score for \nmacrovascular invasion could not be calculated.  As the precision, recall, and F1 score staƟsƟcs for \nmaximum LI-RADS score, number of tumors, maximum tumor diameter, and sum of tumor diameters \nwere calculated as weighted-average values due to mulƟlevel classiﬁcaƟons, these values may be biased \nas accurate predicƟons of absence of an imaging feature (e.g. “Versa Chat” noted zero tumors when \nthere were no tumors by manual chart review) were included in the staƟsƟcs. \n \n . CC-BY-NC-ND 4.0 International licenseIt is made available under a \n is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity. (which was not certified by peer review)\nThe copyright holder for this preprintthis version posted September 1, 2023. ; https://doi.org/10.1101/2023.08.31.23294924doi: medRxiv preprint \nThis is one of the ﬁrst studies that has demonstrated and compared the performance of the chat \ninterface of a general-purpose LLM versus manual chart review for extracƟon of clinical data.  We \ndemonstrated high accuracy for simple extracƟon tasks, which degraded with more complex use cases.  \nOf note, iteraƟve development (“prompt engineering”) of a “zero-shot” prompt to specify the operaƟons \nto be executed by the LLM was necessary to achieve this level of accuracy.7   Our use of a “zero-shot” \nprompt and limiƟng the amount of data processed per session, however, prevented the gpt-35-turbo \nmodel from maintaining a persistent memory to allow in-context “learning” based on previous data.12  \nThese are known limitaƟons of the gpt-35-turbo model, which have been improved upon in gpt-35-\nturbo-16k (which supports up to 16,384 tokens), gpt-4 (up to 8,192 tokens), and gpt-4-32k (up to 32,768 \ntokens).5  Despite these limitaƟons, our study demonstrated two important concepts: 1. Feasibility of \nusing general purpose LLMs to extract structured informaƟon from clinical data with minimal technical \nexperƟse, and 2. Use of a LLM deployed in isolated protected environment that accommodates PHI (as \nopposed to ChatGPT, which is oŌen not permiƩed for use with PHI) for clinical use cases. \n  \n . CC-BY-NC-ND 4.0 International licenseIt is made available under a \n is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity. (which was not certified by peer review)\nThe copyright holder for this preprintthis version posted September 1, 2023. ; https://doi.org/10.1101/2023.08.31.23294924doi: medRxiv preprint \nTable 1 – Performance evaluaƟon staƟsƟcs of “Versa Chat” versus manual chart review \n Accuracy Precision Recall F1 Score\nMax LIRADS 0.945  \n(0.901-0.967) \n0.955 \n(0.921-0.977)* \n0.945 \n(0.907-0.973)* \n0.946 \n(0.906-0.973)* \nNumber of Tumors 0.830  \n(0.764-0.879) \n0.826 \n(0.760-0.878)* \n0.830 \n(0.769-0.879)* \n0.822 \n(0.756-0.872)* \nMax Tumor Diameter 0.868  \n(0.808-0.907) \n0.903 \n(0.853-0.940)* \n0.868 \n(0.808-0.912)* \n0.870 \n(0.816-0.918)* \nSum of Tumor Diameters 0.725  \n(0.643-0.780) \n0.751 \n(0.681-0.825)* \n0.725 \n(0.644-0.786)* \n0.714 \n(0.642-0.781)* \nMacrovascular Invasion 0.989  \n(0.956-0.995) \n0.000 \n(0.000-0.000)# N/A# N /A# \nExtrahepatic Metastases 0.978  \n(0.941-0.989) \n0.000 \n(0.000-0.000)$ \n0.000 \n(0.000-0.000)$ N/A$ \nOverall Accuracy 0.889  \n(0.869-0.907) \n   \n*Due to multilevel classification, these statistics were calculated as weighted-average values. \n# There were no true positives or false negatives for the evaluation of this data element. \n$ There were no true positives for the evaluation of this data element. \n \n \n  \n . CC-BY-NC-ND 4.0 International licenseIt is made available under a \n is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity. (which was not certified by peer review)\nThe copyright holder for this preprintthis version posted September 1, 2023. ; https://doi.org/10.1101/2023.08.31.23294924doi: medRxiv preprint \nFigure 1 – Final prompt used for data extracƟon from “Versa Chat” (gpt-35-turbo) \n \n \n  \n . CC-BY-NC-ND 4.0 International licenseIt is made available under a \n is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity. (which was not certified by peer review)\nThe copyright holder for this preprintthis version posted September 1, 2023. ; https://doi.org/10.1101/2023.08.31.23294924doi: medRxiv preprint \nFigure 2 – Example of an exchange with “Versa Chat” (gpt-35-turbo) using mock data \n . CC-BY-NC-ND 4.0 International licenseIt is made available under a \n is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity. (which was not certified by peer review)\nThe copyright holder for this preprintthis version posted September 1, 2023. ; https://doi.org/10.1101/2023.08.31.23294924doi: medRxiv preprint \nReferences: \n1.  Ge J, Lai JC. ArƟﬁcial intelligence-based text generators i n hepatology: ChatGPT is just the \nbeginning. Hepatol Commun. 2023;7(4). doi:10.1097/HC9.0000000000000097 \n2.  Singhal K, Azizi S, Tu T, et al. Large language models encode clinical knowledge. Nature. \n2023;620(7972):172-180. doi:10.1038/s41586-023-06291-2 \n3.  Chernyak V, Fowler KJ, Kamay a A, et al. Liver Imaging ReporƟng and Data System (LI-RADS) Version \n2018: Imaging of Hepatocellular Carcinoma in At-Risk PaƟents. Radiology. 2018;289(3):816-830. \ndoi:10.1148/radiol.2018181494 \n4.  Azure OpenAI Service – Large Language Models for GeneraƟve AI. hƩps://azure.microsoŌ.com/en-\nus/products/ai-services/openai-service-b. Accessed August 25, 2023. \n5.  Azure OpenAI Service models - Azure OpenAI | MicrosoŌ Learn. hƩps://learn.microsoŌ.com/en-\nus/azure/ai-services/openai/concepts/models. Accessed August 26, 2023. \n6.  Lai JC, Covinsky KE, Dodge J L, et al. Development of a novel frailty index to predict mortality in \npaƟents with end-stage liver disease. Hepatology. 2017;66(2):564-574. doi:10.1002/hep.29219 \n7.  Wang J, Shi E, Yu S, et al. Prompt Engineering for Healthca re: Methodologies and ApplicaƟons. \narXiv. 2023. doi:10.48550/arxiv.2304.14670 \n8.  Sokolova M, Lapalme G. A systemaƟc analysis of performance measures for classiﬁcaƟon tasks. \nInformaƟon Processing & Management. 2009;45(4):427-437. doi:10.1016/j.ipm.2009.03.002 \n9.  Team RC. R: A language and environment for staƟsƟcal compuƟ ng. 2013. \n10.  Bootstrap FuncƟons (Originally by Angelo Canty for S) [R p ackage boot version 1.3-28.1]. \nhƩps://cran.r-project.org/web/packages/boot/index.html. Published November 22, 2022. \nAccessed January 6, 2023. \n11.  Kuhn M. ClassiﬁcaƟon and Regression Training [R package ca ret version 6.0-94]. March 2023. \n12.  Liu J, Shen D, Zhang Y , Dolan B, Carin L, Chen W. [2101.06804] What Makes Good In-Context \nExamples for GPT-$3$? arXiv. January 2021. \n \n . CC-BY-NC-ND 4.0 International licenseIt is made available under a \n is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity. (which was not certified by peer review)\nThe copyright holder for this preprintthis version posted September 1, 2023. ; https://doi.org/10.1101/2023.08.31.23294924doi: medRxiv preprint ",
  "topic": "Chart",
  "concepts": [
    {
      "name": "Chart",
      "score": 0.6815938949584961
    },
    {
      "name": "Electronic health record",
      "score": 0.5799824595451355
    },
    {
      "name": "Computer science",
      "score": 0.5310848951339722
    },
    {
      "name": "Health records",
      "score": 0.5250803232192993
    },
    {
      "name": "Data extraction",
      "score": 0.4469892382621765
    },
    {
      "name": "Extraction (chemistry)",
      "score": 0.419620543718338
    },
    {
      "name": "Data mining",
      "score": 0.39681869745254517
    },
    {
      "name": "Natural language processing",
      "score": 0.37727153301239014
    },
    {
      "name": "Information retrieval",
      "score": 0.3510514199733734
    },
    {
      "name": "Data science",
      "score": 0.32560810446739197
    },
    {
      "name": "Statistics",
      "score": 0.23347198963165283
    },
    {
      "name": "MEDLINE",
      "score": 0.20117491483688354
    },
    {
      "name": "Mathematics",
      "score": 0.1250191628932953
    },
    {
      "name": "Health care",
      "score": 0.1218675971031189
    },
    {
      "name": "Political science",
      "score": 0.09162765741348267
    },
    {
      "name": "Chemistry",
      "score": 0.06485295295715332
    },
    {
      "name": "Chromatography",
      "score": 0.0
    },
    {
      "name": "Law",
      "score": 0.0
    }
  ],
  "institutions": [
    {
      "id": "https://openalex.org/I180670191",
      "name": "University of California, San Francisco",
      "country": "US"
    },
    {
      "id": "https://openalex.org/I114832834",
      "name": "Tulane University",
      "country": "US"
    }
  ]
}