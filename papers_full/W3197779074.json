{
  "title": "Generalized Topp-Leone-Weibull AFT Modelling: A Bayesian Analysis with MCMC Tools using R and Stan",
  "url": "https://openalex.org/W3197779074",
  "year": 2021,
  "authors": [
    {
      "id": "https://openalex.org/A5015734026",
      "name": "Md. Ashraf-Ul-Alam",
      "affiliations": [
        "Aligarh Muslim University"
      ]
    },
    {
      "id": "https://openalex.org/A2157076437",
      "name": "Athar Ali Khan",
      "affiliations": []
    },
    {
      "id": "https://openalex.org/A5015734026",
      "name": "Md. Ashraf-Ul-Alam",
      "affiliations": []
    }
  ],
  "references": [
    "https://openalex.org/W2087824134",
    "https://openalex.org/W632436187",
    "https://openalex.org/W2582743722",
    "https://openalex.org/W2889963245",
    "https://openalex.org/W2203714058",
    "https://openalex.org/W2051734881",
    "https://openalex.org/W2482566988",
    "https://openalex.org/W4289257608",
    "https://openalex.org/W1536497620",
    "https://openalex.org/W4246096141",
    "https://openalex.org/W2512556785",
    "https://openalex.org/W4289253806",
    "https://openalex.org/W2921051283",
    "https://openalex.org/W2065826526",
    "https://openalex.org/W4399650722",
    "https://openalex.org/W2330804378",
    "https://openalex.org/W4293738259",
    "https://openalex.org/W2794274922",
    "https://openalex.org/W402407836",
    "https://openalex.org/W2157230072",
    "https://openalex.org/W4250640807",
    "https://openalex.org/W2525726046",
    "https://openalex.org/W2963977107",
    "https://openalex.org/W2783751658",
    "https://openalex.org/W4299551643",
    "https://openalex.org/W2915100019",
    "https://openalex.org/W4390123385",
    "https://openalex.org/W4248681815",
    "https://openalex.org/W4229723287",
    "https://openalex.org/W2563285174",
    "https://openalex.org/W4399648958",
    "https://openalex.org/W4302341942",
    "https://openalex.org/W4298426643",
    "https://openalex.org/W2151689585"
  ],
  "abstract": "The generalized Topp-Leone-Weibull (GTL-W) distribution is a generalization of Weibull distribution which is obtained by using generalized Topp-Leone (GTL) distribution as a generator and considering Weibull distribution as a baseline distribution. Weibull distribution is a widely used survival model that has monotone- increasing or decreasing hazard. But it cannot accommodate bathtub shaped and unimodal shaped hazards. As a survival model, GTL-W distribution is more flexible than the Weibull distribution to accommodate different types of hazards. The present study aims at fitting GTL-W model as an accelerated failure time (AFT) model to censored survival data under Bayesian setting using R and Stan languages. The GTL-W AFT model is compared with its sub-model and the baseline model. The Bayesian model selection criteria LOOIC and WAIC are applied to select the best model.",
  "full_text": "AJS\nAustrian Journal of Statistics\nJuly 2021, Volume 50, 52–76.\nhttp://www.ajs.or.at/\ndoi:10.17713/ajs.v50i5.1166\nGeneralized Topp-Leone-Weibull AFT Modelling:\nA Bayesian Analysis with MCMC Tools\nUsing R and Stan\nMd. Ashraf-Ul-Alam\nAligarh Muslim University,\nDepartment of Statistics and\nOperations Research\nAthar Ali Khan\nAligarh Muslim University,\nDepartment of Statistics and\nOperations Research\nAbstract\nThe generalized Topp-Leone-Weibull (GTL-W) distribution is a generalization of Weibull\ndistribution which is obtained by using generalized Topp-Leone (GTL) distribution as a\ngenerator and considering Weibull distribution as a baseline distribution. Weibull dis-\ntribution is a widely used survival model that has monotone- increasing or decreasing\nhazard. But it cannot accommodate bathtub shaped and unimodal shaped hazards. As a\nsurvival model, GTL-W distribution is more ﬂexible than the Weibull distribution to ac-\ncommodate diﬀerent types of hazards. The present study aims at ﬁtting GTL-W model as\nan accelerated failure time (AFT) model to censored survival data under Bayesian setting\nusing R and Stan languages. The GTL-W AFT model is compared with its sub-model and\nthe baseline model. The Bayesian model selection criteria LOOIC and WAIC are applied to\nselect the best model.\nKeywords: generalized Topp-Leone-Weibull distribution, baseline distribution, censored data,\nmonotone hazard, accelerated failure time, Stan, LOOIC, WAIC.\n1. Introduction\nTopp and Leone (1955) introduced a new probability distribution having one parameter on\nthe support (0, 1). Nadarajah and Kotz (2003) discussed this distribution and derived many\nrelevant functions and quantities, for instance, characteristic function, moments. The cumu-\nlative distribution function (cdf) and probability density function (pdf) of a random variable\nX having Topp-Leone (TL) distribution with shape parameter a> 0 and 0 <x< 1 are given\nas follows:\nF(x|a) = xa(2 −x)a = {x(2 −x)}a\nf(x|a) = 2a(1 −x)xa−1(2 −x)a−1\nSince the support of TL distribution is (0, 1), so it can not be used in many areas including in\nsurvival analysis. Recently, Sangsanit and Bodhisuwan (2016) and Al-Shomrani, Arif, Shawky,\nHanif, and Shahbaz (2016) extended TL distribution as the Topp-Leone generated (TL-G)\nAustrian Journal of Statistics 53\nfamily of distributions. Suppose, G(x) = G(x|ξ), and g(x) = g(x|ξ) be the baseline cdf and\npdf of a continuous random variable X. If TL distribution is considered as a generator then\nthe TL-G family of distributions is obtained by replacing x with G(x) in the TL distribution\nand is given as below:\nF(x|a,ξ) = G(x)a[2 −G(x)]a = {G(x)[2 −G(x)]}a (1)\nf(x|a,ξ) = 2ag(x)[1 −G(x)]G(x)a−1[2 −G(x)]a−1 (2)\nwhere f(x) = d\ndxF(x), g(x) = d\ndxG(x), support of F(x|a,ξ) is the support of G(x) and ξis the\nvector of parameters of baseline distribution G(x) and we can write X ∼TL-G (a,ξ). Further\ngeneralization of TL-G model is considered in the next section.\n1.1. Generalized Topp-Leone-G model\nRezaei, Sadr, Alizadeh, and Nadarajah (2017) generalized the TL-G( a,ξ) distribution by ex-\nponentiating the baseline cdf G(x) with an additional shape parameter b> 0. Mahdavi (2017)\nmade generalization of TL-G model with diﬀerent consideration. Motivated by Cordeiro and\nde Castro (2011) , in this article, the generalization of TL-G family due to Rezaei et al. (2017)\nis called as the generalized Topp-Leone-G (GTL-G) family of distributions. So the GTL dis-\ntribution is considered as the generator of the new family, GTL-G model. The cdf, survival\nfunction (sf) and pdf of GTL-G model can be written as:\nF(x|a,b,ξ ) = {G(x)b[2 −G(x)b]}a (3)\nS(x|a,b,ξ ) = 1 −{G(x)b[2 −G(x)b]}a (4)\nf(x|a,b,ξ ) = 2abg(x)[1 −G(x)b]G(x)ab−1[2 −G(x)b]a−1 (5)\nwhere, shape1 a> 0, shape2 b> 0, and ξ is the vector of parameters of baseline distribution\nG(x), support of F(x|a,b,ξ ) is the support of G(x) and we can write X ∼TL-G (a,ξ). The\nGTL-G model will be tractable if the baseline cdf G(x) and pdf g(x) have simple analytic\nforms. Considering the cdf of Weibull distribution G(x) as the baseline distribution, the\nGTL-W distribution is derived and discussed as a survival model with Bayesian perspective.\nRandom number generation from GTL-G model:\nSuppose that U ∼Uniform(0, 1). Then\nF(x) = F(x|a,b,ξ ) = u\n{G(x)b[2 −G(x)b]}a = u\nG(x) =\n{\n1 −\n√\n(1 −u1/a)\n}1/b\n(6)\nThis is the general expression for generating random numbers from GTL-G model for any\nbaseline cdf G(x).\n2. Weibull survival model\nSuppose, survival time T follows Weibull distribution with shape α(>0) and scale parameter\nλ(>0). Then the pdf g(t), cdf G(t), survival function (sf) ¯G(t) and hazard function (hf) h(t)\nof Weibull distribution are given as below (Lawless 2003):\ng(t|α,λ) = (α/λ)(t/λ)(α−1)exp[−(t/λ)α], t> 0\nG(t|α,λ) = 1 −exp[−(t/λ)α]\n54 GTL-Weibull AFT Modelling\n¯G(t|α,λ) = exp[−(t/λ)α]\nh(t|α,λ) = (α/λ)(t/λ)(α−1)\nand we write T∼Weibull(α,λ). The Weibull distribution is one of the basic lifetime distri-\nbutions used in survival analysis. The hazard function of Weibull distribution is monotone-\nincreasing or decreasing. Moreover, its survival and hazard functions can be expressed ex-\nplicitly and as such, it can handle censored data easily and eﬀectively. Because of ﬂexibility\nand tractability of hazard and survival functions, Weibull model is widely used in modelling\nreliability and survival data. But the distribution is not suitable for analyzing data having\nbathtub shaped and unimodal shaped hazard rates. So to capture diﬀerent types of hazards,\nmore ﬂexible generalization of the Weibull model is essential in ﬁtting skewed survival data.\n2.1. Weibull AFT model\nThe accelerated failure time (AFT) model considers linear regression of logarithm of survival\ntime T on a number of covariates and is used for studying the eﬀect of a covariate that\naccelerates or decelerates the survival process. The AFT models are parametric models as they\ndepend on the distribution of survival times. The AFT model postulates a direct relationship\nbetween failure time and covariates (Kalbﬂeisch and Prentice 2002). The models are becoming\npopular as they directly explain reduction or prolongation of the time to event. If survival\ntime T depends on a number of covariates x1,x2,...,x p then the AFT model can be written\nas:\nlog(T) = β0 +\np∑\nj=1\nβjxj + σz = x′β+ σZ\nwhere, βj,j = 0,1,2,...,p are the regression coeﬃcients, σ(> 0) is a scale parameter, and\nrandom error Z has a speciﬁed probability distribution. For instance, if Z has an extreme\nvalue distribution then T has Weibull distribution (Lee and Wang 2013; Collett 2015).\nSuppose that a random variable Z has a standard extreme value distribution with den-\nsity function g(z) = exp[z −exp(z)] and survival function S(z) = exp[−exp(z)]. Sub-\nstituting z = ( logt −x′β)/σ in the extreme value distribution, Weibull AFT model, T\n∼Weibull( 1\nσ,exp(x′β)), is obtained as follows:\ng(t|σ,β, x) =\n( σ−1\nexp(x′β)\n)( t\nexp(x′β)\n)( 1\nσ−1)\nexp\n(\n−\n( t\nexp(x′β)\n)1\nσ\n)\n(7)\nG(t|σ,β, x) = 1 −exp\n(\n−\n( t\nexp(x′β)\n)1/σ)\n(8)\n¯G(t|σ,β, x) = 1 −G(t|σ,β, x) = exp\n(\n−\n( t\nexp(x′β)\n)1/σ)\n(9)\nh(t|σ,β, x) = g(t)/¯G(t) =\n( σ−1\nexp(x′β)\n)( t\nexp(x′β)\n)(1/σ−1)\n(10)\nConsidering the Weibull AFT model as the baseline model, GTL-W AFT model is developed.\n2.2. Generalized Topp-Leone-Weibull AFT model\nAryal, Ortega, Hamedani, and Yousof (2017) introduced Topp-Leone generated Weibull dis-\ntribution and illustrated with real data sets using maximum likelihood method of estimation\nand showed that the model ﬁt the data better than the other competitive models. GTL dis-\ntribution is considered as a generator of the new family of models and Weibull AFT model\nis considered as the baseline model G. The generalized Topp-Leone-Weibull (GTL-W) AFT\nAustrian Journal of Statistics 55\nmodel is obtained by substituting Weibull AFT model in the GTL-G model. The cdf, sf, pdf\nand hf of the GTL-W AFT model can be written as follows:\nF(t|θ,x) = {G(t)b[2 −G(t)b]}a (11)\nS(t|θ,x) = 1 −{G(t)b[2 −G(t)b]}a (12)\nf(t|θ,x) = 2ag(t)[1 −G(t)]G(t)a−1[2 −G(t)]a−1 (13)\nh(t|θ,x) = f(t|θ,x)/S(t|θ,x) (14)\nwhere, t >0, g(t) = g(t|σ,β, x) and G(t) = G(t|σ,β, x) are the pdf and cdf of Weibull AFT\nmodel (Equation 7, 8), θ = (a,b,σ,β ), shape1 a >0, shape2 b >0, shape3 α >0, and scale\nparameters λ> 0; moreover, σ= 1/α, λ= exp(x′β) from the AFT model log(T) = x′β+σZ\nand we write T ∼GTL-W(a,b, 1/σ,exp(x′β)). Since the GTL-W distribution has explicit forms\nof survival function and hazard function, so, it can be used properly as a survival model to\nanalyze censored data under Bayesian framework.\nRandom number generation from GTL-W AFT model:\nSuppose, U ∼Uniform(0, 1). Then\nF(x) = F(x|a,b,α,λ ) = u\nG(x) = {1 −\n√\n(1 −u1/a)}1/b\n1 −exp[−(x/λ)α] = {1 −\n√\n(1 −u1/a)}1/b\nx= (exp(x′β))\n{\n−log\n[\n1 −{1 −\n√\n(1 −u1/a)}1/b]}σ\n(15)\nThis is the expression for generating random numbers from GTL-W AFT model, where,\nσ= 1/α and λ= exp(x′β).\n3. Description of data\nSurvival times of 80 patients with diﬀuse histiocytic lymphoma according to stage of tumour-\nstage III and stage IV are given in Table 1. The death times are recorded in days ( ⋆ indicates\ncensored time). Vidakovic (2011) and Armitage, Berry, and Matthews (2002) discussed the\ndata from diﬀerent aspects and the data was ﬁrst reported by McKelvey, Gottlieb, Wilson,\nHaut, Talley, Stephens, Lane, Gamble, Jones, Grozea et al. (1976).\nThe aim of this study is to ﬁt GTL-W AFT model for comparing the survival patterns of\ntwo groups of patients under Bayesian framework and the ﬁtted model is compared with its\nsub-model and baseline Weibull AFT model on the basis of LOOIC and WAIC.\n4. Bayesian analysis of GTL-W AFT model\nThe basic assumption of Bayesian statistics is that parameters θ in a probability model are\nrandom variables having prior distributions π(θ) while the observed data drawn from a sam-\npling density are considered as ﬁxed. Bayes Theorem is the main instrument of Bayesian\nstatistics that establishes the relationship among the prior distributions, likelihood and the\nposterior distribution.\n4.1. Bayes theorem\nSuppose that f(y|θ) be the density of data having parameter θ that may be a vector and\nfrom this density observed data values y = (y1,y2,...,y n) are obtained independently. The\nBayes Theorem states that (Gelman, Stern, Carlin, Dunson, Vehtari, and Rubin 2013),\n56 GTL-Weibull AFT Modelling\nTable 1: Survival times (in days) of patients with diﬀuse histiocytic lymphoma according to\nstage of tumour\nStage III (19 patients)\n6, 19, 32, 42, 42, 43 ⋆, 94, 126⋆, 169⋆, 207, 211⋆,\n227⋆, 253, 255⋆, 270⋆, 310⋆, 316⋆, 335⋆, 346⋆\nStage IV (61 patients)\n4, 6, 10, 11, 11, 11, 13, 17, 20, 20, 21, 22, 24, 24, 29,\n30, 30, 31, 33, 34, 35, 39, 40, 41 ⋆, 43⋆, 45, 46, 50, 56,\n61⋆, 61⋆, 63, 68, 82, 85, 88, 89, 90, 93, 104, 110, 134,\n137, 160⋆, 169, 171, 173, 175, 184, 201, 222, 235 ⋆,\n247⋆, 260⋆, 284⋆, 290⋆, 291⋆, 302⋆, 304⋆, 341⋆, 345⋆\nπ(θ|y) = f (y,θ)\nh(y) = π(θ)f (y|θ)∫\nπ(θ)f (y|θ)dθ = L(θ|y)π(θ)∫\nπ(θ)f (y|θ)dθ (16)\nwhere, π(θ|y) is the posterior distribution of parameter θ given the data y, π(θ) is the prior\ndistribution of θ that is selected independent of the data and the likelihood function is given\nby\nL(θ|y) = f (y|θ) = f (y1 ,y2 ,..., yn|θ) =\nn∏\ni=1\nf (yi |θ)\nh(y) =\n∫\nπ(θ)f (y|θ)dθ is the marginal distribution of y which is independent of θ and con-\nsidered as normalizing constant. So dropping h(y) from Equation (16), we can write\nπ(θ|y) ∝L(θ|y) ×π(θ)\nPosterior ∝Likelihood ×Priors (17)\nEquation (17) is the main essence of Bayes Theorem. That is, the posterior distribution of\nparameters are obtained by combining prior distribution and data. All inferences are based\non the posterior distribution.\n4.2. Likelihood function of GTL-W AFT model\nThe likelihood function of GTL-W AFT model for a right censored sample is derived as\n(Collett 2015; Lawless 2003; Wang, Ryan, and Faraway 2018):\nL(θ|D) =\nn∏\ni=1\nf(ti|a,b,σ,β, x)δiS(ti|a,b,σ,β, x)1−δi\n=\nn∏\ni=1\n(\nf(ti|a,b,σ,β, x)\nS(ti|a,b,σ,β, x)\n)δi\nS(ti|a,b,σ,β, x)\n=\nn∏\ni=1\n(\nh(ti|a,b,σ,β, x)\n)δi\nS(ti|a,b,σ,β, x)\n=\nn∏\ni=1\n(\nh(ti|θ,x)\n)δi\nS(ti|θ,x) (18)\nwhere, S(ti|a,b,σ,β, x), f(ti|a,b,σ,β, x) and h(ti|a,b,σ,β, x) of GTL-W AFT model are given\nin Equation (12, 13, 14), θ = (a,b,σ,β ), D = (t,δ,X), the censoring indicator δ = 0 if the\nobservation is censored and δ= 1 if the observation is failed, and X is the matrix of covariates\nAustrian Journal of Statistics 57\nwhich is known as design matrix or model matrix. The contribution of data to the posterior\ndistribution is ensured through the likelihood.\nTaking logarithm of both sides of likelihood function, the log-likelihood can be written by the\nfollowing two alternative equations,\nl(θ|D) =\nn∑\ni=1\n(\nδi(logf(ti|θ,x) −logS(ti|θ,x)) + logS(ti|θ,x)\n)\nl(θ|D) =\nn∑\ni=1\n(\nδi(logh(ti|θ,x)) + logS(ti|θ,x)\n)\n4.3. Prior distributions of GTL-W AFT model parameters\nSelecting prior distributions of the parameters of a probability model of data is very impor-\ntant as they might have signiﬁcant inﬂuence on the posterior distribution of the parameters.\nGTL-W density has two shape parameter(a,b), a positive scale parameter ( σ) and regression\ncoeﬃcients (β). So prior distributions for the parameters θ = (a,b,σ,β ) are required to be\nselected. For scale parameter σ, half-Cauchy distribution and for the regression coeﬃcients\nβ, normal distribution are considered as weakly informative prior distribution (Gelman et al.\n2006). But Cauchy sampling process may not converge to a stable mean and variance (McEl-\nreath 2015). So in this article we consider half-t distribution (Wiper, Gir´ on, and Pewsey 2008)\nas prior for the scale parameter and for the shape parameters as well. Half-t distribution with\none degrees of freedom is equivalent to half-Cauchy distribution. The hyperparameters of the\nprior distributions are chosen so that priors are almost ﬂat (Figure 1), as such, the data\ndominate the posterior through the likelihood.\nTruncated student’s t distribution restricted to the interval [0, ∞] is called the half- t dis-\ntribution. For the scale parameter, π(σ) =half-t(df, location, scale) = student t(2, 0, 10)\nT[restricted interval] = student t(2, 0, 10) T[0, ], for the shape parameters, π(a) = π(b) =\nstudent t(5, 0, 10) T[0, ] and for the regression coeﬃcients, π(βj) = normal(µ,σ) = normal(0,\n10) are considered as priors. Stan has provision to write truncated distributions. The pa-\nrameters are assumed to be independent and their joint prior density function can be written\nas:\nπ(θ) = p(a,b,σ,β ) = π(a) ×π(b) ×π(σ) ×π(β) (19)\n4.4. Posterior distribution of GTL-W AFT model parameters\nThe joint posterior distribution of the parameters θ = (a,b,σ,β ) =\n(a,b,σ,β 0,β1,...,β p) of GTL-W AFT model given the data can be written following Bayes\nTheorem as:\nπ(θ|D) ∝L(θ|D) ×π(θ)\nπ(θ|D) ∝L(θ|D) ×π(a) ×π(b) ×π(σ) ×π(β) (20)\nwhere the likelihood L(θ|D) is given by Equation (18), parameters are assumed to be inde-\npendent.\nThe normalized joint posterior distribution and the marginal distributions of the parameters\nare diﬃcult to obtain analytically that requires solving high dimensional integration and, as\nsuch, Markov chain Monte Carlo (MCMC) simulation technique is employed to get the esti-\nmates and other relevant results.\n58 GTL-Weibull AFT Modelling\n0 1 2 3 4 5\n0.0 0.2 0.4 0.6 0.8 1.0\nHalf−t Density Functions\n  (df, location, scale) \n(a)\nt\nf(t)\n(2, 0, 1)\n(2, 0, 5)\n(2,0,10)\n(5, 0, 5)\n(5, 0, 10) \n−10 −5 0 5 10\n0.0 0.1 0.2 0.3 0.4 0.5\nNormal Density Functions \n      (mean, sd)\n(b)\nt\nf(t)\n(0, 1)\n(0, 2)\n(0, 5)\n(0, 10)\nFigure 1: Density curves of half-t and normal distribution for diﬀerent values of the parameters\n4.5. Rationale of using Bayesian methods to survival analysis\nBayesian methods are becoming increasingly popular among the survival analysis researchers.\nIbrahim, Chen, and Sinha (2001) and Li and Ma (2013) highlighted some reasons of ap-\nplying Bayesian methods to survival analysis. As the survival time is non-negative, usually\npositively skewed and censored, so the least squares method is not applicable for analyzing\nsurvival data. The likelihood function is the most important way of handling survival data\nthat considers each of the censored and uncensored observations. But the likelihood func-\ntion for censored data is complicated and diﬀerent from likelihood function for a sample of\ncomplete observations. The maximum likelihood method of estimation can be applied and\nsampling distribution can be derived for inference procedures only for simple distributions for\nsome censoring schemes, not for all types of censoring. Large sample asymptotic sampling\ndistribution is diﬃcult to derive for censored data, even that is not applicable for small sized\ncensored sample. Bayesian methods are very useful in survival analysis as it can analyze\ncensored survival data eﬀectively and eﬃciently irrespective of sample size and can handle\ncomplex models with any number of parameters using MCMC algorithms.\n4.6. Stan code for ﬁtting Bayesian GTL-W AFT model\nStan is a probabilistic programming language for Bayesian analysis. It uses no-U-turn sampler\n(NUTS), an adaptive form of Hamiltonian Monte Carlo (HMC) sampling that is more eﬃcient\nthan other Metropolis-Hastings algorithms, specially for high-dimensional models regardless\nof whether the priors are conjugate or not (Carpenter, Gelman, Hoﬀman, Lee, Goodrich,\nBetancourt, Brubaker, Guo, Li, and Riddell 2017; Hoﬀman and Gelman 2014). It is easier to\nspecify the constraints of the parameters in Stan. A prior can be speciﬁed in Stan, but if prior\nis not speciﬁed, Stan uses uniform prior for each parameter. Bayesian softwares BUGS or\nJUGS is ﬂexible enough to specify a large variety of models, but for large data sets and com-\nplex models they might take too long computing time or even may fail to provide solutions.\nStan can handle large data sets and complex models in less computing time than BUGS. The\nnumber of iterations needed to achieve convergence is lower using Stan. Stan does not allow\ndiscrete parameters. As Stan is a recently developed software, not much literature is available\non it. Gelman et al. (2013), Kruschke (2015), Korner-Nievergelt, Roth, Von Felten, Gu´ elat,\nAlmasi, and Korner-Nievergelt (2015) and Turkman, Paulino, and M ¨uller (2019) discussed\nStan to some extent. However, a comprehensive Stan manual is available online. Stan is\nbecoming popular and it is being rapidly developed by the Stan Development Team.\nAustrian Journal of Statistics 59\nA complete Stan program consists of six code blocks. Sequentially, the blocks are: (i) data\nblock (ii) transformed data block, (iii) parameters block, (iv) transformed parameters block\n(v) model block (vi) generated quantities block. A sequence of programming statements sur-\nrounded by curly braces {}form a block. A statement ends with a semi-colon. A comment\nin Stan are indicated by a double slash //. The Stan Development Team (2017) called the\nlanguage as ‘Stan’ in honor of Stanislaw Ulam, one of the creators of the Monte Carlo methods.\nThe six code blocks for implementing Bayesian GTL-W AFT model are shown in the ap-\npendix. The model block is mandatory that contains the model speciﬁcation. Priors and\nlikelihood are mentioned in model block. All other blocks are optional. In generated quanti-\nties block, the pointwise log-likelihood log_lik and posterior prediction y_rep are calculated\nand are stored for future use. Three functions, namely, (i) log survival function, (ii) log hazard\nfunction and (iii) log-likelihood function are deﬁned at the beginning, before starting the code\nblocks. Stan codes are written in the editor RStudio . Stan has interface with R by rstan .\nStan codes are written with comments for ﬁtting the GTL-W AFT model under Bayesian\nframework and are given in the appendix. The whole code block is saved as stancode_gtlw\nthat is used afterwards.\nData structure for Stan to ﬁt GTL-W model:\nStan requires a data list that might include a matrix, vector and values. So, data must\nbe prepared to feed into Stan. An object list is constructed using R and assigned it\nto dat1 (say).\n# survival times in days\ny <- c(6,19,32,42,42,43,94,126,169,207,211,227,\n253,255,270,310,316,335,346,4,6,10,11,11,\n11,13,17,20,20,21,22,24,24,29,30,30,31,33,\n34,35,39,40,41,43,45,46,50,56,61,61,63,68,\n82,85,88,89,90,93,104,110,134,137,160,169,\n171,173,175,184,201,222,235,247,260,284,\n290,291,302,304,341,345)\n# event=1 indicates death and 0 indicates censored\nevent <- c(rep(1,5),0,1,0,0,1,0,0,1,rep(0,6),\nrep(1,23),0,0,rep(1,4),0,0,rep(1,12),0,\nrep(1,7),rep(0,10))\n# x1=0 if disease stage is III and 1 if stage is IV\nx1 <- c(rep(0,19),rep(1,61))\nx = cbind(1,x1) # model matrix\nN = nrow(x)\nM = ncol(x)\ndat1 = list(y=y,event=event,x=x,N=N,M=M)\nModel ﬁtting:\nTo ﬁt the GTL-W AFT model under Bayesian framework and to simulate from the pos-\nterior distribution, the function stan() from the package rstan is called and a Stanﬁt\nobject M1 (say) is created. Stan has default initialization strategy. But initial values\ncan be supplied by the user for avoiding divergent transitions. To decrease divergent\ntransitions, the argument control=list(adapt_delta=0.9995 is also used. In Stan,\ndefault choice for chain and iteration are 4 and 2000 respectively. We have ﬁxed 4\nchains and 4000 iterations for each chain, that is, for each of the 4 chains 4000 sam-\nples are drawn for each of the parameters. Stan uses half of the iterations as warmup\n60 GTL-Weibull AFT Modelling\niterations, so post-warmup draws per chain is 2000. Relevant codes are given in the\nappendix.\nSummarizing output of Stanﬁt GTL-W AFT model:\nUsing print() command, summary results are obtained from the ﬁtted object M1 and\nare reported in Table 2. Trace plots are made for visual convergence checking. For\nposterior plot bayesplot package and for model comparison criteria LOOIC and WAIC,\nloo package are used and they are reported in Table 5. Codes are explained in the\nappendix.\nTable 2: Summary results of ﬁtted GTL-W AFT model\nParameter mean se mean sd 2.5% 50% 97.5% n eﬀ ˆR\nbeta[1] -3.248 0.105 4.379 -12.274 -10.740 4.656 1744 1.001\nbeta[2] -1.046 0.007 0.474 -2.000 -1.843 -0.121 4248 1.000\nshape1 10.418 0.141 8.344 1.283 1.799 31.942 3494 1.001\nshape2 9.607 0.139 7.394 1.037 1.535 28.078 2825 1.001\nsigma 7.524 0.052 2.220 3.291 3.918 11.978 1839 1.001\nConvergence of MCMC algorithm for GTL-W AFT model:\nAn MCMC algorithm simulates samples from the complex posterior distribution. So\nan algorithm is converged to the target posterior distribution means that the Markov\nchain is stationary and adding more samples will not change the location and shape\nof the density of the posterior distribution sensibly and hence will not change the\nestimates and other relevant results. Quantitatively, potential scale reduction factor,\nˆR (Gelman and Rubin 1992), is used for checking convergence of MCMC algorithms\nwhich is deﬁned based on between chain variance and within chain variance. Gelman\net al. (2013) recommended acceptable limit of potential scale reduction factor ˆR< 1.1\nand eﬀective sample size as n eff = 100.\nFrom the summary features (Table 2), it is evident that ˆR is less than 1.1, n eff is\ngreater than 100; moreover, Monte Carlo (MC) error, se mean is less relative to the\nstandard deviations for all of the parameters which is expected, that is, convergence of\nMCMC algorithm to the posterior distribution has been attained.\nGraphically, convergence of an MCMC algorithm can be judged, mainly, by trace plot\n(Gelman et al.2013; Ntzoufras 2009; Hamra, MacLehose, and Richardson 2013). Trace\nplot (Figure 2) shows no periodicity indicating convergence of the MCMC sampling\nprocess to the joint posterior distribution. That is, MCMC algorithm HMC-NUTS\nperforms correctly to explore the target posterior distribution.\nEvaluating Bayesian ﬁtting of GTL-W AFT model:\nA ﬁtted Bayesian model is accepted as adequate if it predicts the future observations\nthat are consistent with the present data. Model ﬁt is assessed visually by posterior\npredictive density (PPD)plots which are made using bayesplot package. From pos-\nterior predictive density plots (Figure 3), it is observed that GTL-W AFT model is\ncompatible with the data.\nInterpretation of results of ﬁtted GTL-W AFT model:\nSummary features of the posterior distribution of the parameters of GTL-W AFT model\nare shown in Table 2. In regression modelling with Stan, intercept is denoted as β[1].\nThe coeﬃcient β[2] of covariatex1, stage of tumour, is negative which means that death\nwill be accelerated for patients with stage IV tumour, consequently, length of lifetime\nAustrian Journal of Statistics 61\nshape2 sigma\nbeta[1] beta[2] shape1\n2000 2500 3000 3500 4000 2000 2500 3000 3500 4000\n2000 2500 3000 3500 4000 2000 2500 3000 3500 4000 2000 2500 3000 3500 4000\n0\n25\n50\n75\n100\n−3\n−2\n−1\n0\n1\n0\n4\n8\n12\n16\n−20\n−10\n0\n10\n0\n20\n40\n60\nchain\n1\n2\n3\n4\nTrace plot (GTL−W AFT model)\nFigure 2: Trace plot of ﬁtted GTL-W AFT model are obtained by plotting parameter val-\nues along the Y-axis against their corresponding iterations along the X-axis and there is no\ntendency of periodicity of the plot indicating convergence of the algorithm\n1000 2000 3000 4000 5000\ny\nyrep\nPPD plot (GTL−W AFT model, y and y_rep are overlayed)\nFigure 3: Posterior predictive density (PPD) plot of GTL-W AFT model is done by plotting\nthe data y and then overlaying the density of the predicted valuesy rep. PPD plot of GTL-W\nAFT model shows that the posterior predictive density ﬁts the data well\n62 GTL-Weibull AFT Modelling\nwill decrease. Estimated value of the coeﬃcient β[2] = −1.046 belongs to the 95%\ncredible interval (−2.000,−0.121) which does not include zero value indicates statistical\nsigniﬁcance. Moreover, it is seen from the caterpillar plot (Figure 4) that zero value is\nnot contained in the 95% credible interval for the coeﬃcient β[2], so the coeﬃcient is\nstatistically signiﬁcant. The acceleration factor is exp(β2) = exp(−1.046) = 0.35(<1)\nfor a patient with stage IV tumour. Therefore, duration of life of a patient with stage\nIV tumour would be 0.35 times shorter than that of a patient having tumour of stage\nIII , that is, survival time would be shorter for the patients with stage IV tumour.\nbeta[1]\nbeta[2]\nsigma\n−10 −5 0 5 10\nCaterpillar plot (GTL−W AFT model)\nFigure 4: Caterpillar plot of GTL-W AFT model shows that the 95% credible interval of the\nparameter β[2] does not include zero value that means the parameter is statistically signiﬁcant\n5. Sub-models of GTL-W AFT model\nIf b= 1 then GTL-W (a,b, 1/σ,exp(x′β)) AFT model reduces to TL-W (a,1/σ,exp(x′β))\nAFT model,\nF(t|a,σ,β, x) = {G(t|σ,β, x)(2 −G(t|σ,β, x))}a (21)\nwhere,\nG(t|σ,β, x) = 1 −exp\n(\n−\n( t\nexp(x′β)\n)1/σ)\nis the cdf of baseline Weibull(1 /σ,exp(x′β)) AFT model. So TL-W AFT model and\nthe baseline Weibull AFT model are analyzed and compared with GTL-W AFT model\nusing Bayesian approach.\n5.1. Bayesian analysis of sub-models of GTL-W AFT model\nUsing the same data and same prior distributions the sub-model TL-W AFT and the\nbaseline Weibull AFT model are ﬁtted with little manipulations of Stan code. Neces-\nsary results and graphs are shown for comparison.\nFitting TL-W AFT model with Stan and summarizing output:\nStanﬁt object M2 (say) is created for TL-W AFT model. The Stan codes for TL-W AFT\nmodel are given in the appendix and the whole code block is saved as stancode_gtlw.\nAustrian Journal of Statistics 63\nSummary results are reported in Table 3. Posterior predictive density plot are shown\nin Figure 5. LOOIC and WAIC are reported in Table 5.\nTable 3: Summary results of ﬁtted TL-W AFT model\nParameter mean se mean sd 2.5% 50% 97.5% n eﬀ ˆR\nbeta[1] 3.846 0.032 1.283 2.984 3.916 6.193 1604 1.002\nbeta[2] -1.132 0.009 0.478 -1.444 -1.124 -0.225 2976 1.001\nshape1 15.365 0.237 9.852 8.401 13.089 39.597 1729 1.001\nsigma 4.097 0.022 0.941 3.453 4.052 6.048 1752 1.002\n400 800 1200 1600\ny\nyrep\nPPD plot(TL−W AFT model,y and y_rep are overlayed)\nFigure 5: The plot shows that the posterior predictive density of TL-W AFT model ﬁts the\ndata well\nFitting Weibull AFT model and summarizing output:\nStanﬁt object M3 is created for Weibull AFT model. The Stan codes for TL-W AFT\nmodel are given in the appendix and the whole code block is saved asstancode_weibull.\nSummary results are reported in Table 4. Posterior predictive density plot are shown\nin Figure 6. LOOIC and WAIC are reported in Table 5.\nTable 4: Summary results of ﬁtted Weibull AFT model\nParameter mean se mean sd 2.5% 50% 97.5% n eﬀ ˆR\nbeta[1] 6.257 0.008 0.468 5.431 6.221 7.277 3205 1.001\nbeta[2] -1.318 0.009 0.510 -2.401 -1.284 -0.406 3304 1.001\nsigma 1.274 0.002 0.149 1.021 1.259 1.604 4041 1.000\n6. Model comparison\nSelecting the best model from among the several competitive models is always crucial\nin Bayesian statistics and in classical statistics as well. Two information criteria Leave-\none-out cross validation (LOO) and Widely Applicable or Watanabe Akaike Information\nCriterion (WAIC) (Vehtari, Gelman, and Gabry 2017; McElreath 2015; Gelman et al.\n2013) are usually used to compare the Bayesian ﬁtted models. Pointwise log-likelihoods\n64 GTL-Weibull AFT Modelling\n1000 2000 3000\ny\nyrep\nPPD plot (Weibull AFT model, y and y_rep are overlayed)\nFigure 6: Posterior predictive density (PPD) plot of Weibull AFT model shows that the\nmodel is not compatible well with the current data\nare calculated in the generated quantities block of Stan program and afterwards ‘loo-\npackage’ (Vehtari, Gelman, Gabry, and Yao 2018) extracts and uses these quantities\nto obtain numerical measures LOOIC (LOO information criterion) or WAIC for model\ncomparison and they are presented in the Table 5. A better ﬁtted model has less LOOIC\nor WAIC than the others. On the basis of LOOIC and WAIC, it is evident that the AFT\nmodels TL-W and GTL-W are better ﬁtted models than the baseline Weibull AFT\nmodel; TL-W and GTL-W AFT models are almost indistinguishable and might be\nequally acceptable for analyzing the tumour stage data. As generalizations, GTL-W\nhas 4 parameters, TL-W model has 3 parameters whereas Weibull distribution has 2\nparameters. The well-known Occam’s principle of parsimony is, “ If two models describe\nthe observations equally well, we should choose the simpler one.” (Lesaﬀre and Lawson\n2012). Accordingly, TL-W AFT model is the most preferred model.\nTable 5: LOOIC and WAIC of the ﬁtted model\nModel LOOIC WAIC\nWeibull 661.7 661.7\nTL-W 655.3 655.3\nGTL-W 655.2 655.1\n7. Conclusion\nThe generalized Topp-Leone-Weibull (GTL-W), Topp-Leone-Weibull (TL-W) and Weibull\nsurvival models are ﬁtted as accelerated failure time models under Bayesian framework\nto the tumour data. For all the models, the coeﬃcient of tumour stage is statistically\nsigniﬁcant. Comparing posterior predictive density plots, LOOIC, WAIC and the number\nof parameters of the models, it can be concluded that the TL-W AFT model is the\nbest suited model for ﬁtting the censored tumour data. The death is accelerated as\nthe acceleration factor is less than one for patients having stage IV tumour, that is,\nsurvival time is shorter for the patients with stage IV tumour than that of the patients\nwith stage III tumour (Figure 7).\nAustrian Journal of Statistics 65\n0 100 200 300 400 500\n0.0 0.2 0.4 0.6 0.8 1.0\nFitted survival curves for TL−W AFT model\nt\nf(t)\nstage III\nstage IV\nFigure 7: Survival curve for patients with stage III tumour is higher than that of the patients\nwith stage IV tumour\nAppendix\nA1. Derivation of equation (2)\nF(x|a,ξ) = G(x)a[2 −G(x)]a = {G(x)[2 −G(x)]}a\nf(x|a,ξ) = d\ndxF(x|a,ξ) = d\ndx{2G(x) −G(x)2}a\nf(x|a,ξ) = a{G(x)[2 −G(x)]}a−1 d\ndx{2G(x) −G(x)2}\nf(x|a,ξ) = a{G(x)[2 −G(x)]}a−1[2g(x) −2G(x)g(x)]\nf(x|a,ξ) = 2ag(x)[1 −G(x)]G(x)a−1[2 −G(x)]a−1\nA2. Derivation of equation (6)\nF(x) = F(x|a,b,ξ ) = u\n{G(x)b[2 −G(x)b]}a = u\n2G(x)b −[G(x)b]2 = u1/a\n1 −2G(x)b + [G(x)b]2 = 1 −u1/a\n[1 −G(x)b]2 = 1 −u1/a\nG(x) =\n{\n1 −\n√\n(1 −u1/a)\n}1/b\n66 GTL-Weibull AFT Modelling\nA3. Stan code for GTL-W AFT model\nlibrary(rstan)\nstancode_gtlw = \"\nfunctions{\n// defines the log survival\nvector log_S (vector t,real shape1,real shape2,\nreal shape3,vector scale){\nvector[num_elements(t)] log_S ;\nfor (i in 1:num_elements(t)){\nlog_S[i] = log(1-(((weibull_cdf(t[i],shape3,\nscale[i]))^(shape1*shape2))*\n((2-(weibull_cdf(t[i],shape3,\nscale[i]))^(shape2))^(shape1))));\n}\nreturn log_S;\n}\n//defines the log hazard\nvector log_h (vector t,real shape1,real shape2,\nreal shape3,vector scale){\nvector[num_elements(t)] log_h ;\nvector[num_elements(t)] ls ;\nls = log_S(t,shape1,shape2,shape3,scale) ;\nfor (i in 1:num_elements(t)){\nlog_h[i] = (log(2)+log(shape1)+log(shape2)+\nweibull_lpdf(t[i]|shape3,scale[i])+\n((shape1*shape2)-1)*weibull_lcdf(t[i]|shape3,scale[i])+\nlog(1-(weibull_cdf(t[i],shape3,scale[i]))^(shape2))+\n(shape1-1)*(log(2-(weibull_cdf(t[i],shape3,\nscale[i]))^(shape2))))- ls[i];\n}\nreturn log_h;\n}\n//defines the log-likelihood for right censored data\nreal surv_gtlw_lpdf(vector t,vector d,real shape1,\nreal shape2,real shape3,vector scale){\nvector[num_elements(t)] log_lik;\nreal prob;\nlog_lik = d .* log_h(t,shape1,shape2,shape3,scale)+\nlog_S(t,shape1,shape2,shape3,scale);\nprob = sum(log_lik);\nreturn prob;\n}\n}\n//data block\ndata{\nint N; // number of observations\nvector <lower=0> [N] y;// observed times\nvector <lower=0,upper=1> [N] event;//censoring(1=obs.,\n// 0=cens.)\nint M; // number of covariates\nmatrix[N,M] x;//model matrix (N rows, M columns)\nAustrian Journal of Statistics 67\n}\n//parameters block\nparameters{\nvector [M] beta;//coef.in the linear predictor\nreal<lower=0> shape1;// shape parameter\nreal<lower=0> shape2;// shape parameter\nreal<lower=0> sigma;//scale parameter sigma=1/shape3\n}\n// transformed parameters block\ntransformed parameters{\nvector[N] linpred;\nvector[N] mu;\nlinpred = x*beta; //linear predictor\nfor (i in 1:N){\nmu[i] = exp(linpred[i]);\n}\n}\n// model block\nmodel{\nshape1 ~ student_t(5,0,10) T[0, ];//prior for shape1\nshape2 ~ student_t(5,0,10) T[0, ];//prior for shape2\nsigma ~ student_t(2,0,10) T[0, ];//prior for sigma\nbeta ~ normal(0,10);//prior for reg. coefficients\ny ~ surv_gtlw(event,shape1,shape2,1/sigma,mu);\n//model for the data\n}\n// generated quantities block\ngenerated quantities{\nvector[N] y_rep;//posterior predictive value\nvector[N] log_lik;//log-likelihood\n{ for(n in 1:N){\nlog_lik[n] = (((log(2)+log(shape1)+log(shape2)+\nweibull_lpdf(y[n]|1/sigma,exp(x[n,]*beta))+\n((shape1*shape2)-1)*weibull_lcdf(y[n]|1/sigma,\nexp(x[n,]*beta))+log(1-(weibull_cdf(y[n],1/sigma,\nexp(x[n,]*beta)))^(shape2))+(shape1-1)*\n(log(2-(weibull_cdf(y[n],1/sigma,exp(x[n,]*beta)))^\n(shape2))))-(log(1-(((weibull_cdf(y[n],1/sigma,\nexp(x[n,]*beta)))^(shape1*shape2))*\n((2-(weibull_cdf(y[n],1/sigma, exp(x[n,]*beta)))^\n(shape2))^(shape1))))))*event[n])+\n(log(1-(((weibull_cdf(y[n],1/sigma,exp(x[n,]*beta)))^\n(shape1*shape2))*((2-(weibull_cdf(y[n],1/sigma,\nexp(x[n,]*beta)))^(shape2))^(shape1)))));}\n}\n{real u;\nu=uniform_rng(0,1);\nfor (n in 1:N){\ny_rep[n] = (exp(x[n,]*beta))*\n((-log(1-(1-(sqrt(1-u^(1/shape1))))^\n(1/shape2)))^(sigma));}\n}\n68 GTL-Weibull AFT Modelling\n}\n\"\nThe whole code block is saved as stancode_gtlw that is used afterwards.\nA3.1. Fitting GTL-W AFT model with Stan\n#selecting initial values\nrequire(survival)\n#regression coefficient of log(y) as initial values\nbeta1 = solve(crossprod(x),crossprod(x,log(y)))\n#convert matrix to a vector\nbeta1 = c(beta1)\n#beta1 is used as initial values for 4 chains\n#fitting with stan\nM1 <- stan(model_code = stancode_gtlw,data=dat1,\ninit=list(list(beta=beta1),list(beta=beta1),\nlist(beta=beta1),list(beta=beta1)),iter=4000,\nchains=4,control=list(adapt_delta=0.9995))\nA3.2. Summarizing output of ﬁtted GTL-W AFT\nprint(M1,c(\"beta\",\"shape1\",\"shape2\",\"sigma\"),\nprobs=c(0.025,0.05,0.975),digits=3)\nrequire(bayesplot)\nrequire(loo)\nstan_trace(M1, pars=c(\"beta\",\"sigma\"))+\nggtitle(\"Trace plot (GTL-W AFT model)\")\n#posterior predictive check\n# posterior predictive value y_rep\ny_rep <- as.matrix(M1, pars=\"y_rep\")\nppc_dens_overlay(y,y_rep[50:70,])+grid_lines()+\nggtitle(\"PPD plot (GTL-W AFT model,\ny and y_rep are overlayed)\")\n#Caterpillar plot for showing credible intervals\nstan_plot(M1,pars=c(\"beta\",\"sigma\"),ci_level=.95)+\ngrid_lines()+\nggtitle(\"Caterpillar plot (GTL-W AFT model)\")\n#calculating looic and waic using loo package\nlog_lik_1 <- extract_log_lik(M1,parameter_name=\"log_lik\",\nmerge_chains = TRUE)\nloo_1 <- loo(log_lik_1,r_eff = NULL,save_psis = FALSE)\nprint(loo_1)\nwaic1 <- waic(log_lik_1)\nprint(waic1)\nAustrian Journal of Statistics 69\nA4. Stan code for TL-W AFT model\nstancode_tlw = \"\nfunctions{\n// defines the log survival\nvector log_S (vector t, real shape1, real shape2,\nvector scale){\nvector[num_elements(t)] log_S ;\nfor (i in 1:num_elements(t)){\nlog_S[i] = log(1-(((weibull_cdf(t[i],shape2,scale[i]))^\n(shape1))*((2-\n(weibull_cdf(t[i],shape2,scale[i])))^(shape1))));\n}\nreturn log_S;\n}\n//defines the log hazard\nvector log_h (vector t,real shape1,real shape2,\nvector scale){\nvector[num_elements(t)] log_h ;\nvector[num_elements(t)] ls ;\nls = log_S(t,shape1,shape2, scale) ;\nfor (i in 1:num_elements(t)){\nlog_h[i] = (log(2)+log(shape1)+weibull_lpdf(t[i]|\nshape2,scale[i])+\nweibull_lccdf(t[i]|shape2,scale[i])+(shape1-1)*\nweibull_lcdf(t[i]|shape2,scale[i])+(shape1-1)*\n(log(2-weibull_cdf(t[i],shape2,scale[i]))))-\nls[i];\n}\nreturn log_h;\n}\n//defines the log-likelihood for right censored data\nreal surv_tlw_lpdf(vector t,vector d,\nreal shape1,real shape2, vector scale){\nvector[num_elements(t)] log_lik;\nreal prob;\nlog_lik = d .* log_h(t, shape1, shape2, scale) +\nlog_S(t, shape1, shape2, scale);\nprob = sum(log_lik);\nreturn prob;\n}\n}\n//data block\ndata{\nint N; // number of observations\nvector <lower=0> [N] y; // observed times\nvector <lower=0,upper=1> [N] event;//censoring(1=obs.,\n// 0=cens.)\nint M; // number of covariates\nmatrix[N, M] x;//model matrix (N rows, M columns)\n}\n//parameters block\n70 GTL-Weibull AFT Modelling\nparameters{\nvector [M] beta;// coeff.in the linear predictor\nreal<lower=0> shape1; // shape parameter\nreal<lower=0> sigma;//scale parameter sigma=1/shape2\n}\n// transformed parameters block\ntransformed parameters{\nvector[N] linpred;\nvector[N] mu;\nlinpred = x*beta;//linear predictor\nfor (i in 1:N){\nmu[i] = exp(linpred[i]);\n}\n}\n// model block\nmodel{\nshape1 ~ student_t(5,0,10) T[0, ];//prior for shape1\nsigma ~ student_t(2,0,10) T[0, ];//prior for sigma\nbeta ~ normal(0,10);//prior for reg. coefficients\ny ~ surv_tlw(event, shape1, 1/sigma, mu);\n//model for the data\n}\n// generated quantities block\ngenerated quantities{\nvector[N] y_rep;//posterior predictive value\nvector[N] log_lik;//log-likelihood\n{ for(n in 1:N){\nlog_lik[n] = (((log(2)+ log(shape1)+\nweibull_lpdf(y[n]|1/sigma, exp(x[n,]*beta))+\nweibull_lccdf(y[n]|1/sigma,exp(x[n,]*beta))+\n(shape1-1)*weibull_lcdf(y[n]|1/sigma,exp(x[n,]*\nbeta))+ (shape1-1)*(log(2-weibull_cdf(y[n],\n1/sigma,exp(x[n,]*beta)))))-(log(1-\n(((weibull_cdf(y[n],1/sigma,exp(x[n,]*beta)))^\n(shape1))*((2-(weibull_cdf(y[n],1/sigma,\nexp(x[n,]*beta))))^(shape1))))))*event[n])+\n(log(1-(((weibull_cdf(y[n],1/sigma,exp(x[n,]*\nbeta)))^(shape1))*((2-(weibull_cdf(y[n],1/sigma,\nexp(x[n,]*beta))))^(shape1)))));}\n}\n{real u;\nu=uniform_rng(0,1);\nfor (n in 1:N){\ny_rep[n] = (exp(x[n,]*beta))*\n((-log(sqrt(1-u^(1/shape1))))^(sigma));}\n}\n}\n\"\nThe whole code block is saved as stancode_tlw.\nAustrian Journal of Statistics 71\nA4.1. Fitting TL-W AFT model with Stan and summarizing output\n#selecting initial values\nrequire(survival)\n#regression coefficient of log(y) as initial values\nbeta1 = solve(crossprod(x),crossprod(x,log(y)))\nbeta1 = c(beta1) #convert matrix to a vector\n#beta1 is used as initial values for 4 chains\n# fitting with stan\nM2 <- stan(model_code=stancode_tlw,data=dat1,\ninit=list(list(beta=beta1),list(beta=beta1),\nlist(beta=beta1),list(beta=beta1)),iter=4000,\nchains=4,control=list(adapt_delta=0.9995))\nprint(M2, c(\"beta\", \"shape1\", \"sigma\"),\nprobs=c(0.25,0.5,0.975),digits=3)\nrequire(bayesplot)\nrequire(loo)\n#posterior predictive check\n#posterior predictive value y_rep\ny_rep <- as.matrix(M2, pars=\"y_rep\")\nppc_dens_overlay(y,y_rep[550:560,])+ grid_lines()+\nggtitle(\"PPD plot(TL-W AFT model,\ny and y_rep are overlayed)\")\n#calculating looic and waic using loo package\nlog_lik_1 <- extract_log_lik(M2,parameter_name=\"log_lik\",\nmerge_chains = TRUE)\nloo_1 <- loo(log_lik_1, r_eff = NULL,save_psis = FALSE)\nprint(loo_1)\nwaic1 <- waic(log_lik_1)\nprint(waic1)\nA5. Stan code for Weibull AFT model\nstancode_weibull = \"\nfunctions{\n// defines the log survival\nvector log_S (vector t,real shape,vector scale){\nvector[num_elements(t)] log_S;\nfor (i in 1:num_elements(t)){\nlog_S[i] = weibull_lccdf(t[i]|shape,scale[i]);\n}\nreturn log_S;\n}\n//defines the log hazard\nvector log_h (vector t,real shape,vector scale){\nvector[num_elements(t)] log_h ;\nvector[num_elements(t)] ls ;\n72 GTL-Weibull AFT Modelling\nls = log_S(t,shape, scale) ;\nfor (i in 1:num_elements(t)){\nlog_h[i] = (weibull_lpdf(t[i]|shape,scale[i]))-ls[i];\n}\nreturn log_h;\n}\n//defines the log-likelihood for right censored data\nreal surv_weibull_lpdf(vector t,vector d,real shape,\nvector scale){\nvector[num_elements(t)] log_lik;\nreal prob;\nlog_lik = d .* log_h(t,shape,scale)+\nlog_S(t,shape,scale);\nprob = sum(log_lik);\nreturn prob;\n}\n}\n//data block\ndata{\nint N; // number of observations\nvector <lower=0> [N] y; // observed times\nvector <lower=0,upper=1> [N] event;//censoring (1=obs.,\n// 0=cens.)\nint M; // number of covariates\nmatrix[N,M] x;//model matrix (N rows, M columns)\n}\n//parameters block\nparameters{\nvector [M] beta; //coeff. in the linear predictor\nreal<lower=0> sigma;//scale parameter sigma=1/shape\n}\n// transformed parameters block\ntransformed parameters{\nvector[N] linpred;\nvector[N] mu;\nlinpred = x*beta;//linear predictor\nfor (i in 1:N){\nmu[i] = exp(linpred[i]);\n}\n}\n// model block\nmodel{\nsigma ~ student_t(2,0,10) T[0,];//prior for sigma\nbeta ~ normal(0,10); //prior for reg. coefficients\ny ~ surv_weibull(event, 1/sigma, mu);\n//model for the data\n}\n// generated quantities block\ngenerated quantities{\nvector[N] y_rep;//posterior predictive value\nvector[N] log_lik;//log-likelihood\n{ for(n in 1:N){\nAustrian Journal of Statistics 73\nlog_lik[n] = (((weibull_lpdf(y[n]|1/sigma,exp(x[n,]*beta)))-\n(weibull_lccdf(y[n]|1/sigma,exp(x[n,]*beta))))*\nevent[n])+(weibull_lccdf(y[n]|1/sigma,\nexp(x[n,]*beta)));}\n}\n{ for (n in 1:N){\ny_rep[n]= weibull_rng( 1/sigma, exp((x[n,]*beta)));}\n}\n}\n\"\nThe whole code block is saved as stancode_weibull.\nA5.1. Fitting Weibull AFT model with Stan and summarizing output\n# fitting with stan\nM3 <- stan(model_code=stancode_weibull,data=dat1,\nchains=4,iter=4000)\nprint(M3,c(\"beta\",\"sigma\"),digits=3,probs=c(0.025,0.50,0.975))\nrequire(bayesplot)\nrequire(loo)\n#posterior predictive check\n#posterior predictive value y_rep\ny_rep <- as.matrix(M3,pars=\"y_rep\")\nppc_dens_overlay(y,y_rep[110:120,])+grid_lines()+\nggtitle(\"PPD plot (Weibull AFT model,\ny and y_rep are overlayed)\")\n#calculating looic and waic using loo package\nlog_lik_1 <- extract_log_lik(M3,parameter_name=\"log_lik\",\nmerge_chains = TRUE)\nloo_1 <- loo(log_lik_1,r_ef=NULL,save_psis=FALSE)\nprint(loo_1)\nwaic1 <- waic(log_lik_1)\nprint(waic1)\nReferences\nAl-Shomrani A, Arif O, Shawky A, Hanif S, Shahbaz MQ (2016). “Topp–Leone Family\nof Distributions: Some Properties and Application.” Pakistan Journal of Statistics\nand Operation Research, 12(3), 443–451.\nArmitage P, Berry G, Matthews JNS (2002). Statistical Methods in Medical Research.\nJohn Wiley & Sons.\nAryal GR, Ortega EM, Hamedani G, Yousof HM (2017). “The Topp-Leone Gener-\nated Weibull Distribution: Regression Model, Characterizations and Applications.”\nInternational Journal of Statistics and Probability, 6(1), 126–141.\n74 GTL-Weibull AFT Modelling\nCarpenter B, Gelman A, Hoﬀman MD, Lee D, Goodrich B, Betancourt M, Brubaker\nM, Guo J, Li P, Riddell A (2017). “Stan: A Probabilistic Programming Language.”\nJournal of Statistical Software, 76(1).\nCollett D (2015). Modelling Survival Data in Medical Research. Chapman and\nHall/CRC.\nCordeiro GM, de Castro M (2011). “A New Family of Generalized Distributions.”\nJournal of Statistical Computation and Simulation, 81(7), 883–898.\nGabry J, Mahr T (2017). “bayesplot: Plotting for Bayesian Models.”R package version,\n1.\nGelman A, Rubin DB (1992). “Using Multiple Sequences.” Statistical Science, 7(4),\n457–472.\nGelman A, Stern HS, Carlin JB, Dunson DB, Vehtari A, Rubin DB (2013). Bayesian\nData Analysis. Chapman and Hall/CRC.\nGelman A, et al. (2006). “Prior Distributions for Variance Parameters in Hierarchical\nModels (Comment on Article by Browne and Draper).” Bayesian analysis, 1(3),\n515–534.\nHamra G, MacLehose R, Richardson D (2013). “Markov Chain Monte Carlo: An\nIntroduction for Epidemiologists.”International Journal of Epidemiology, 42(2), 627–\n634.\nHoﬀman MD, Gelman A (2014). “The No-U-Turn Sampler: Adaptively Setting Path\nLengths in Hamiltonian Monte Carlo.” Journal of Machine Learning Research, 15(1),\n1593–1623.\nIbrahim JG, Chen MH, Sinha D (2001). Bayesian Survival Analysis. Springer Science\n& Business Media.\nKalbﬂeisch JD, Prentice RL (2002). The Statistical Analysis of Failure Time Data,\nvolume 360. John Wiley & Sons.\nKorner-Nievergelt F, Roth T, Von Felten S, Gu´ elat J, Almasi B, Korner-Nievergelt P\n(2015). Bayesian Data Analysis in Ecology Using Linear Models with R, BUGS, and\nStan. Academic Press.\nKruschke J (2015). Doing Bayesian Data Analysis: A Tutorial with R, JAGS, and\nStan. Academic Press.\nLawless JF (2003). Statistical Models and Methods for Lifetime Data, volume 362. John\nWiley & Sons.\nLee ET, Wang J (2013). Statistical Methods for Survival Data Analysis. John Wiley &\nSons.\nLesaﬀre E, Lawson AB (2012). Bayesian Biostatistics. John Wiley & Sons.\nLi J, Ma S (2013). Survival Analysis in Medicine and Genetics. CRC Press.\nMahdavi A (2017). “Generalized Topp-Leone Family of Distributions.” Journal of\nBiostatistics and Epidemiology, 3(2), 65–75.\nMcElreath R (2015). Statistical Rethinking: A Bayesian Course with Examples in R\nand Stan. Chapman and Hall/CRC.\nAustrian Journal of Statistics 75\nMcKelvey EM, Gottlieb JA, Wilson HE, Haut A, Talley RW, Stephens R, Lane M,\nGamble JF, Jones SE, Grozea PN, et al.(1976). “Hydroxyldaunomycin (Adriamycin)\nCombination Chemotherapy in Malignant Lymphoma.” Cancer, 38(4), 1484–1493.\nNadarajah S, Kotz S (2003). “Moments of Some J-shaped Distributions.” Journal of\nApplied Statistics, 30(3), 311–317.\nNtzoufras I (2009). Bayesian Modeling Using WinBUGS, volume 698. John Wiley &\nSons.\nR Core Team (2017). R: A Language and Environment for Statistical Comput-\ning. R Foundation for Statistical Computing, Vienna, Austria. URL https:\n//www.R-project.org/.\nRezaei S, Sadr BB, Alizadeh M, Nadarajah S (2017). “Topp–Leone Generated Family\nof Distributions: Properties and Applications.” Communications in Statistics-Theory\nand Methods, 46(6), 2893–2909.\nRStudio Team (2015). RStudio: Integrated Development Environment for R. RStudio,\nInc., Boston, MA. URL http://www.rstudio.com/.\nSangsanit Y, Bodhisuwan W (2016). “The Topp-Leone Generator of Distributions:\nProperties and Inferences.” Songklanakarin Journal of Science & Technology, 38(5).\nStan Development Team (2017). “Stan Modeling Language Users Guide and Reference\nManual.” Version 2.16.0, URL http://mc-stan.org.\nStan Development Team (2018). “RStan: the R Interface to Stan.” R package version\n2.17.3, URL http://mc-stan.org/.\nTopp CW, Leone FC (1955). “A Family of J-shaped Frequency Functions.” Journal of\nthe American Statistical Association, 50(269), 209–219.\nTurkman MAA, Paulino CD, M¨uller P (2019). Computational Bayesian Statistics: An\nIntroduction, volume 11. Cambridge University Press.\nVehtari A, Gelman A, Gabry J (2017). “Practical Bayesian Model Evaluation Using\nLeave-one-out Cross-validation and WAIC.” Statistics and Computing, 27(5), 1413–\n1432.\nVehtari A, Gelman A, Gabry J, Yao Y (2018). “loo: Eﬃcient Leave-one-out Cross-\nvalidation and WAIC for Bayesian Models. R package version 2.0. 0.”\nVidakovic B (2011). Statistics for Bioengineering Sciences: with MATLAB and Win-\nBUGS Support. Springer Science & Business Media.\nWang X, Ryan YY, Faraway JJ (2018). Bayesian Regression Modeling with INLA.\nChapman and Hall/CRC.\nWiper MP, Gir´ on FJ, Pewsey A (2008). “Objective Bayesian Inference for the Half-\nNormal and Half-t Distributions.” Communications in Statistics—Theory and Meth-\nods, 37(20), 3165–3185.\n76 GTL-Weibull AFT Modelling\nAﬃliation:\nMd. Ashraf-Ul-Alam\nDepartment of Statistics and Operations Research\nAligarh Muslim University\n202002 Aligarh, India\nE-mail: mdashrafulal@gmail.com\nAthar Ali Khan\nDepartment of Statistics and Operations Research\nAligarh Muslim University\n202002 Aligarh, India\nE-mail: atharkhan1962@gmail.com\nAustrian Journal of Statistics http://www.ajs.or.at/\npublished by the Austrian Society of Statistics http://www.osg.or.at/\nVolume 50 Submitted: 2020-05-13\nJuly 2021 Accepted: 2020-10-13",
  "topic": "Weibull distribution",
  "concepts": [
    {
      "name": "Weibull distribution",
      "score": 0.8539321422576904
    },
    {
      "name": "Statistics",
      "score": 0.5774644017219543
    },
    {
      "name": "Exponentiated Weibull distribution",
      "score": 0.47488683462142944
    },
    {
      "name": "Bayesian probability",
      "score": 0.469292014837265
    },
    {
      "name": "Mathematics",
      "score": 0.4570304751396179
    },
    {
      "name": "Markov chain Monte Carlo",
      "score": 0.42456483840942383
    },
    {
      "name": "Econometrics",
      "score": 0.3228955864906311
    }
  ],
  "institutions": [
    {
      "id": "https://openalex.org/I171210897",
      "name": "Aligarh Muslim University",
      "country": "IN"
    }
  ]
}