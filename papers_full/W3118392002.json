{
  "title": "Modeling and control of the modular multilevel converter (MMC) based solid state transformer (SST) with magnetic integration",
  "url": "https://openalex.org/W3118392002",
  "year": 2020,
  "authors": [
    {
      "id": "https://openalex.org/A2987173157",
      "name": "Gengzhe Zheng",
      "affiliations": [
        "Huazhong University of Science and Technology"
      ]
    },
    {
      "id": "https://openalex.org/A2096664151",
      "name": "Yu Chen",
      "affiliations": [
        "Huazhong University of Science and Technology"
      ]
    },
    {
      "id": "https://openalex.org/A2107180159",
      "name": "Yong Kang",
      "affiliations": [
        "Huazhong University of Science and Technology"
      ]
    },
    {
      "id": "https://openalex.org/A2987173157",
      "name": "Gengzhe Zheng",
      "affiliations": []
    },
    {
      "id": "https://openalex.org/A2096664151",
      "name": "Yu Chen",
      "affiliations": [
        "Huazhong University of Science and Technology"
      ]
    },
    {
      "id": "https://openalex.org/A2107180159",
      "name": "Yong Kang",
      "affiliations": []
    }
  ],
  "references": [
    "https://openalex.org/W2442002586",
    "https://openalex.org/W2068334467",
    "https://openalex.org/W6719564226",
    "https://openalex.org/W2519904480",
    "https://openalex.org/W2146790143",
    "https://openalex.org/W2563575737",
    "https://openalex.org/W3022496283",
    "https://openalex.org/W6657836523",
    "https://openalex.org/W2965498094",
    "https://openalex.org/W3047711813",
    "https://openalex.org/W2037239418",
    "https://openalex.org/W2164560052",
    "https://openalex.org/W1928255237",
    "https://openalex.org/W2027503367",
    "https://openalex.org/W2806019514",
    "https://openalex.org/W2809725018",
    "https://openalex.org/W2168149186",
    "https://openalex.org/W2029949212",
    "https://openalex.org/W2466803377"
  ],
  "abstract": "Solid state transformer (SST) can provide more advanced functionalities compared with conventional transformer, and has great potential in smart grid application. Recently, the SST with medium frequency (MF) isolation link and magnetic integration feature has been proposed, which can reduce the system volume and thus increase the power density. However, the magnetic integration also introduces strong coupling between the line frequency (LF) and MF variables, which poses a great challenge on modeling and control issues. This paper proposes a modeling and control method for an SST with magnetic integration and mixed-frequency modulation. A mathematical model based on dual d-q references is deduced, and then a cascaded control system is designed according to the model. Parameters of the controller for the variables at one frequency are properly designed to avoid disturbance from the variables at the other frequency. The simulation and experimental results show good decoupling effect and satisfactory dynamics performance of the proposed control system.",
  "full_text": "CES TRANSACTIONS ON ELECTRICAL MACHINES AND SYSTEMS, VOL. 4, NO. 4, DECEMBER 2020 309 \nAbstract—Solid state transformer (SST) can provide more \nadvanced functionalities compared with conventional \ntransformer, and has great potential in smart grid application. \nRecently, the SST with medium frequency (MF) isolation link and \nmagnetic integration feature has been proposed, which can reduce \nthe system volume and thus increase the power density. However, \nthe magnetic integration also introduces strong coupling between \nthe line frequency (LF) and MF variables, which poses a great \nchallenge on modeling and control issues. This paper proposes a \nmodeling and control method for an SST with magnetic \nintegration and mixed-frequency modulation. A mathematical \nmodel based on dual d-q references is deduced, and then a \ncascaded control system is designed according to the model. \nParameters of the controller for the variables at one frequency are \nproperly designed to avoid disturbance from the variables at the \nother frequency. The simulation and experimental results show \ngood decoupling effect and satisfactory dynamics performance of \nthe proposed control system.  \nIndex Terms —solid state transformer (SST), modular \nmultilevel converter (MMC), control system, mathematical model \nI. I NTRODUCTION\nOMPARED with line frequency (LF) power transformers, \nsolid state transformers (SSTs) have more advanced \nfunctions. It can not only provide galvanic isolation and voltage \nmatching, but also realize port power control, reactive power \ncompensation and fault protection. Therefore, they are \nrecommended to act as the “energy routers” in the future smart \ngrid [1], [2].  \nSince SSTs convert the port voltage and current (usually in \nLF-AC or DC form) into medium frequency (MF) AC form and \napplied it on the isolation transformer, the volume of the \ntransformer can be greatly decreased thanks to the higher \noperation frequency [3]. However, power electronics \nconverters with heatsinks and extra passive components are \nrequired in both the primary and secondary side to realize the  \nManuscript received August 16, 2020; Revised September 26, 2020; \nAccepted November 26, 2020. Date of publication December 25, 2020; Date of \ncurrent version December 18, 2020. \nThis work was supported by the National Natural Science Foundation of \nChina under Grant 51777085. (Corresponding author: Yu Chen).  \nThe authors are with the State Key Laboratory of Advanced \nElectromagnetic Engineering and Technology, School of Electrical and \nElectronic Engineering, Huazhong University of Science and Technology, \nWuhan 430073, China (e-mail: jyzgz@hust.edu.cn, ayu03@hust.edu.cn, \nykang@mail.hust.edu.cn).  \nDigital Object Identifier 10.30941/CESTEMS.2020.00038 \nconversion from LF-AC, or DC, to MF-AC, which takes a lot of \nvolume. Taking the SST tapping from the medium voltage (MV) \nAC grid as an example, modular converters are usually utilized \nto convert the LF-AC grid voltage to DC, then to MF-AC \nvoltage [4]. The objectives of the control system for such a SST \nare to realize active and reactive powers control of the LF and \nMF port, as well as realize inherent energy balancing. Such a \nconfiguration requires a two-stage energy conversion with lots \nof active and passive components, which degrades the power \ndensity.  \nOne of the ways to improve the power density of SST is to \nincrease the integration level of the SST topology, so as to \nrealize LF-AC to MF-AC energy conversion in one conversion \nstage. Although the matrix converter can realize such a \nconversion within one stage, the two frequencies cannot be \nfully decoupled and the reactive power of the port cannot be \nfreely controlled [5-7]. Ref. [8] proposed that the power \ngenerated by different frequency components are orthogonal to \neach other, hence the MMC arm could output active power at \none frequency while absorb the same amount of power at a \ndifferent frequency by using mixed-frequency modulation. \nWith this concept, ref. [8] focused on DC-AC converter by \nregarding the DC value as zero-frequency value. However, it \ncould not be applied to AC-AC conversion directly; Ref. [9] \nproposed an AC-AC MMC to realize directly LF-AC to \nMF-AC conversion. However, resonant capacitor was needed \nto extract the MF component, which was unsuitable for high \nvoltage and high power applications. In Ref. [10], a MMC \nbased SST with magnetic integration was proposed. The arm \ninductors were integrated with the MF transformer winding to \ncreate the MF loop on the basis of conventional MMC structure. \nSuch magnetic integration design could reduce the system \nvolume and increase the power density. However, with the \nincrease of topology integration, coupling between variables at \ndifferent frequencies in such an SST was also strengthened, \nwhich posed a challenge on modeling and high-performance \ncontrolling. Although the control frameworks were mentioned \nin [10], neither the detail modeling method nor the \nhigh-performance controller have been studied. To bridge this \ngap, this paper thus presents the detailed dynamical \nmathematical model deduction, and then designs its decoupled \ncontrol system. The main contributions of this paper are as \nfollows:  \n1. Since the state variables of the integrated SST have two\ndifferent frequencies, a mathematical model of the SST\nModeling and Control of the Modular Multilevel \nConverter (MMC) based Solid State Transformer \n(SST) with Magnetic Integration \nGengzhe Zheng, Student Member, IEEE, Yu Chen, Member, IEEE, and Yong Kang \nC\n2096-3564 © 2020 CES \n310 CES TRANSACTIONS ON ELECTRICAL MACHINES AND SYSTEMS, VOL. 4, NO. 4, DECEMBER 2020 \nbased on dual d-q reference frames is proposed, which \nfacilitates the design of the control system;  \n2. A cascaded control system with energy balancing outer\nloop and current tracking inner loops is presented, which\ncan provide effective power flow control of the LF and\nMF ports, respectively;\n3. A control parameter design method is presented.\nBenefited from the dual d-q references, simple PI\ncontrollers can be applied and they can naturally immune\nto the influence generated by the other frequency\ncomponent. Therefore, decoupled control between the two\nfrequency components can be achieved.\nThe rest of this paper is organized as follows. In Section II, \nthe topology of the SST with integration feature is reviewed. In \nSection III, the mathematical model of the SST based on dual \nd-q reference is deduced and an overview of the control system\nis demonstrated. The design principle of the current and\nenergy-balancing controllers of the control system is given in\nsection IV and V, respectively. The simulation and experiment\nresults are given in Section VI. Besides, some related\nimportance issues about this paper are discussed in Section VII.\nThe conclusion is drawn in Section VIII.\nII. O VERVIEW OF THE SST TOPOLOGY\nA. Topology Introduction\nThe topology of the SST proposed in [10] is shown in Fig. 1,\nwhich is utilized to interconnect MVAC distribution network \nand LVDC microgrid. A three-phase MMC is used in the MV \nside to withstand the high voltage. Each MMC arm contains N \nhalf-bridge submodules (SMs) in series. Different from \ntraditional MMC, the arm inductors of the MMC are replaced \nby the primary windings of three MF transformers T1 – T3. The \nMF value should be properly designed. As the switching \nfrequency increases, the transformer volume could be \ndecreased but the submodule heatsink volume would be \nincreased. In this paper, the MF is selected as 500Hz to \ncompromise the overall system volume. For interested readers, \nmore details can be found in [10], where the compromising \nbetween transformer volume and submodule heatsink volume \nwas well explained. The central taps of primary windings are \nconnected to the MVAC grid through the filter inductors Lg and \nequivalent resistances Rg. The secondary windings are in \nstar-connection, and are connected to the LVDC microgrid \nVLVDC through a three-phase full-bridge converter. Such a \ntopology can reduce the volume of the magnetic components as \nit integrates the arm inductors with the MF transformer. With \ndetailed design procedure given in [10], an optimal design \nresults which compromise voltage and current stress, \nsubmodule volume, transformer volume, transformer losses \nand magnetic saturation can be found. It should be noted that \nusually several secondary windings with rectifiers are utilized \nto divide the current stress in the LVDC side, and they are \nregarded as an equivalent one in this paper for convenience. K \nis the turning ratio of the transformer. Lσ is the leakage \ninductance of the windings, which has all been converted into \nthe primary side. Rarm is the arm equivalent resistances.  \nvUx and vLx (x=A, B, C) are the arm output voltages.  vgx are \nthe phase voltages of the MVAC grid. vsy’ (y=a, b or c) are the \nsecondary winding voltages of the transformers, and are \ncontrolled as symmetrical voltages by the three-phase \nfull-bridge converter. iUx, iLx, igx, icx and isy are the upper arm \ncurrent, lower arm currents, grid currents, arm circulating \ncurrents and secondary currents, respectively. Their \nrelationships are:  \ng L U\nU L\nc\ns c\n2\n=\nx x x\nx x\nx\ny x\ni i i\ni ii\ni Ki\n \n  \n\n\n       (1) \nB. Modulation\nMixed-frequency modulation is applied on the MMC arms to\nhandle the two frequency components [8-10]. The modulation \nreferences are defined as:  \nU LF MF\nL LF MF\n0.5\n0.5\nx x x\nx x x\nm m m\nm m m\n  \n   \n (2) \nwhere mLFx and mMFx are the LF and MF modulation references, \nrespectively. Ignoring the switching frequency components and \nassuming that the SM capacitor voltages are well balanced, the \narm output voltages can be expressed as: \nU U U\nL L L\nx x x\nx x x\nv m v\nv m v\n\n\n  \n (3) \nwhere vΣUx and vΣLx are the SM capacitor voltage summation of \nthe corresponding arms. In the following section, it can be seen \nthat currents can be controlled by adjusting the LF and MF \ncomponents references mLFx and mMFx. Besides, defining the \nvoltage summation and difference of the upper and lower arms \nas:  \nU L\nU L\n+x x x\nx x x\nv v v\nv v v\n  \n  \n   \n        (4) \nwhere vΣx denotes the phase energy, and vΔx denotes the energy \ndifference between the upper and lower arms.  \nFig. 1.  Topology of the SST with magnetic integration \nZHENG et al. : MODELING AND CONTROL OF THE MODULAR MULTILEVEL CONVERTER (MMC) BASED SOLID STATE  \nTRANSFORMER (SST) WITH MAGNETIC INTEGRATION \n311\nIII. MODELING AND CONTROL OF THE SST \nIn [10], a three-phase mathematical model of the SST is \npresented to explain the operation principle. However, it is not \nsuitable for the control system design. In this section, a model \nbased on dual d-q reference is proposed. And based on that, the \ncontrol system for the SST is demonstrated.  \nA. Dual d-q reference model \n1) LF Current Relationship \nThe Kirchhoff voltage equation of the loops P-A-O-B-P and \nP-A-O-C-P can be written as:  \ngAUA\nUA arm UA sa g g gA gA\ngBUB\nUB σ arm UB sb g g gB gB\ndd 1  d 2 d\ndd 1= d 2 d\niiv L R i Kv L R i vt t\niiv L R i Kv L R i vt t\n     \n     \n        (5a) \ngAUA\nUA arm UA sa g g gA gA\ngCUC\nUC σ arm UC sc g g gB gC\ndd 1   d 2 d\ndd 1= d 2 d\niiv L R i Kv L R i vt t\niiv L R i Kv L R i vt t\n     \n     \n        (5b) \nAdding (5a) and (5b) together gives:  \ngAUA\narm UA sa g g gA gA\nUB UC UA\ndd 33 3 3 3 3d 2 d\n= 2\niiL R i Kv L R i vt t\nv v v\n     \n \n          (6a) \ngALA\narm LA sa g g gA gA\nLB LC LA\ndd 33 3 3 3 3d 2 d\n= 2\niiL R i Kv L R i vt t\nv v v\n     \n \n          (6b) \nSubtracting (6a) from (6b) and substituting (1) into it, the \ndynamics of the grid current igA can be expressed as:  \n     \ngA\nLF LB UB LC UC LA UA gA LF gA\nd 1 1 1= d 6 6 3\niL v v v v v v v R it        (7) \nwhere LLF=Lg+0.5Lσ and RLF=Rg+0.5Rarm. Similarly, the grid \ncurrent igB and igC can be calculated, which forms the \nthree-phase state variables equations as:  \n     \n     \n     \ngA\nLF LB UB LC UC LA UA gA LF gA\ngB\nLF LC UC LA UA LB UB gB LF gB\ngC\nLF LA UA LB UB LC UC gC LF gC\nd 1 1 1= d 6 6 3\nd 1 1 1= d 6 6 3\nd 1 1 1= d 6 6 3\niL v v v v v v v R it\niL v v v v v v v R it\niL v v v v v v v R it\n       \n\n       \n\n       \n\n  \n(8) \nDecomposing mLFx, mMFx, igx, vgx v Σx and vΔx into the d-q \nreference synchronizing to the grid voltage vgx (we denote the \nvariables in this reference with a superscript “L”), (8) can be \ntransformed into the LF d-q reference as:  \nL\ngd L L L L\nLF gd LF LF gq LF gd LFd\nL\ngq L L L L\nLF gq LF LF gd LF gq LFq\nd = d\nd = d\niL v L i R i vt\niL v L i R i vt\n\n\n\n  \n   \n                  (9a) \nwhere  \n \n \nL L L L L L\nLFd d MFd 0 LFd 0\nL L L L L L\nLFq q MFq 0 LFq 0\n1 0.52\n1 0.52\nv v m v m v\nv v m v m v\n  \n  \n   \n   \n                    (9b) \nwhich can be used as the design basis of the LF current \ncontroller. Assuming that the d-axis is in phase with the \nsynthesized vector of vgx so that vgd=Vg and vgq=0 can be \nobtained, the relationship between LF power, voltage and \ncurrent can be obtained as:  \nL\nLF g gd\nL\nLF g gq\n3= 2\n3= 2\nP V i\nQ V i\n\n\n\n\n                                         (10) \n2) MF Current Relationship \nSimilarly, adding (6a) and (6b) together gives the dynamics \nof the three-phase circulating current icx as:  \n     \n     \n     \ncA\nMF UB LB UC LC UA LA MF cA sa\ncB\nMF UC LC UA LA UB LB MF cB sb\ncC\nMF UA LA UB LB UC LC MF cC sc\nd 1 1 2= d 3 3 3\nd 1 1 2= d 3 3 3\nd 1 1 2= d 3 3 3\niL v v v v v v R i Kvt\niL v v v v v v R i Kvt\niL v v v v v v R i Kvt\n       \n       \n\n       \n(11) \nwhere LMF=2Lσ and RMF=2Rarm. Decomposing mLFx, mMFx, icx, \nvsy vΣx and vΔx into the d-q reference synchronizing to vsy (and \nthe variables in this reference are denoted with a superscript \n“M”), (11) can be transformed as:  \nM\nM M M Mcd\nMF sd MF MF cq MF cd MFd\nM\ncq M M M M\nMF sq MF MF cd MF cq MFq\nd = d\nd = d\niL Kv L i R i vt\niL Kv L i R i vt\n\n\n    \n    \n           (12a) \nwhere  \n \nFig. 2.  Diagram of the control system.  \n312 CES TRANSACTIONS ON ELECTRICAL MACHINES AND SYSTEMS, VOL. 4, NO. 4, DECEMBER 2020 \n \n \nM M M M M M\nMFd d MFd 0 LFd 0\nM M M M M M\nMFq q MFq 0 LFq 0\n0.5\n0.5\nv v m v m v\nv v m v m v\n  \n  \n      \n                  (12b) \nwhich can be used as the design basis of the MF current \ncontroller. And the active and reactive powers are:  \nM\nMF s cd\nM\nMF s cq\n3= 2\n3= 2\nP KV i\nQ KV i\n\n\n\n\n                                 (13) \n3) Power Balancing  \nTo facilitate the deduction, all the SM capacitor voltage are \nconsidered as stable and well balanced. Taking the phase A as \nan example, the arm voltages vUA and vLA are:   \n \n \nUA UA arm LFA MFA arm\nLA LA arm LFA MFA arm\n0.5\n0.5\nv m V m m V\nv m V m m V\n \n \n   \n   \n\n\n\n         (14) \nwhere VΣarm is the summation of the SM capacitor voltages of \nthe MMC arm. According to (1), the arm currents are:  \nUA gA cA\nLA gA cA\n1\n2\n1\n2\ni i i\ni i i\n  \n \n\n\n\n\n                               (15) \nThe arm active power is defined as the mean value of the \nproduct of the instantaneous values of voltage and current. As \ndiscussed in [8], different frequency components are \northogonal to each other and their products will not contribute \nto the active power (i.e., the periodical integrals of all the cross \nproduct of terms with different frequencies are zero). Since \nmLFA and igA are LF components while mMFA and icA are MF \ncomponents, the active power of the upper and lower arms in \nphase A can be simplified as:  \n   A LFA gA arm MFA cA arm0 0\nLFA MFA\n1 1d 2 d\nT T\nP P\np m i V t m i V t\nT T\n    \n     (16) \nwhere T is the period corresponding to the line frequency, and \nPLFA and PMFA are the active power inputted to the phase A \nduring T. Since all the capacitors are controlled as stable, pA \nshould be zero, (16) can be further simplified as:  \nLFA MFA=P P                                (17) \nPhase B and C can also be analyzed in similar manners as: \n LFB MFB=P P  and LFC MFC=P P                 (18) \nFrom (10) and (13), PLF and PMF are the power inputted from \nthe LF port and the power outputted to the MF port, \nrespectively, which gives:  \n \nLF LFA LFB LFC\nMF MFA MFB MFC\n=\n=\nP P P P\nP P P P\n   \n                     (19) \nTherefore, the total active power of LF and MF satisfies: \nLF MF=P P                                      (20) \nwhich also denotes that the input and output power of the \nconverter are balanced. Since the voltages of capacitors are \ncontrolled as stable, the capacitors operate as the medium to \ndeliver the power from LF to MF. It should also be noted that \nthe harmonics power and conversion losses, which are ignored \nin the deduction, will cause small unbalance between the input \nand output power. Therefore, a controller for energy balancing \nbetween the input and output power should be implemented, \nwhich will be discussed later.   \n \n4) SM Capacitor Voltage Relationship \nAccording to [11], the dynamic relationships between the \nSM capacitor voltage summation and the modulation reference \ncan be expressed as:  \nSM U\nU U\nSM L\nL L\nd\nd\nd\nd\nx\nx x\nx\nx x\nC v m iN t\nC v m iN t\n\n\n \n \n                             (21) \nDefining vΔx as the difference between vΣUx and vΣLx as:  \nL Ux x xv v v                                       (22) \nSubstituting (1), (2) and (22) into (21) gives:  \n \nSM\nMF g LF c\nd 0.5 2d\nx\nx x x x\nC v m i m iN t\n                   (23) \nwhich can be used as the design principle of the energy \nbalancing controller to balancing the voltage between the upper \nand lower arms.  \nB. Control System Overview  \nBased on the above modeling results, a cascaded control \nsystem is adaptively designed. The overall control system is \nshown in Fig. 2. The basic value of the current references \nL*\ngd,qi  \nand M*\ncd,qi  are generated by the power order according to (10) and \n(13). Nevertheless, they are also fine-tuned by the energy \nbalancing controller. The modulation references m\nL \nLFd, m\nL \nLFq, m\nM \nMFd \nand m\nM \nMFq are generated by the current controller based on the \ndynamic equations in (9) and (12). They are converted to \nthree-phase reference mLFx and mMFx and then combined as the \narm voltage modulation indexes mUx and mLx according to (2). \n Both pulse width modulation (PWM) and nearest level \nmodulation (NLM) can be used to realize the mixed-frequency \nmodulation. Whether NLM or PWM should be used depends \non the SM number of the MMC arm. In applications when the \nSM number is large, NLM is usually selected to reduce the total \nswitching times, and thus reduce the switching loss. When the \nSM number is small, PWM is used to improve the waveforms \nquality. No matter which modulation method is used, the arm \nvoltage can still be simplified as (3) by ignoring the switching \nfrequency component and the above deduction is held.  \nIV. CURRENT LOOP CONTROLLERS DESIGN \nA. LF Current loop controller \nAccording to (9), it is proposed to adjust mLFd,q to control the \nMMC LF output voltage vLFd,q, and hence, to control the grid \ncurrent igd,q. Relationships among them can be obtained \naccording to (9) as:  \n \n \nL L L L L L L\nLFd LF LF gd gd LF LF gq d MFd 0L\n0\nL L L L L L L\nLFq LF LF gq gq LF LF gd q MFq 0L\n0\n2 1 1= 4 2\n2 1 1=  4 2\nm sL R i v L i v m vv\nm sL R i v L i v m vv\n\n\n \n\n \n\n                     \n(24)\n \nZHENG et al. : MODELING AND CONTROL OF THE MODULAR MULTILEVEL CONVERTER (MMC) BASED SOLID STATE  \nTRANSFORMER (SST) WITH MAGNETIC INTEGRATION \n313\nwhich is the design basis of the LF current controller. Therefore, \nthe LF current controller is designed as (25) and the control \ndiagram has also been illustrated in Fig. 3(a).  \n (25) \nwhere the PI controller with proportional and integral \nparameters KLFi and KLFp is utilized to eliminate the tracking \nerror between L*\ngd,qi  and L\ngd,qi . The feedforward compensation \nitem is used to eliminate the coupling and improve the \ndynamics performance. It is worth mentioning that the terms \nL L\nMFd 0m v   and L L\nMFq 0m v  , which are near 500Hz under the LF d-q \nreference frame, are not considered in (25). This is because our \ncontrol bandwidth will be properly set later to immune from \n500Hz component.  \nSubstituting (25) into (9), relationship between \nL*\ngd,qi  and L\ngd,qi  \ncan be calculated as:  \n          (26) \nIt can be found that L\ngd,qi  tracks L*\ngd,qi  and the frequency \nresponse is determined by the transfer function G LF(s). And a \ndisturbance is introduced by the terms L L\nMFd 0m v   and L L\nMFq 0m v   \n(as mentioned, this is because the feedforward terms for \nL L\nMFd 0m v   and L L\nMFq 0m v   are not considered) and the frequency \nresponse is determined by the transfer function GLD(s). And the \nimpact of this disturbance item can be minimized by properly \nsetting the bandwidth of the controller (i.e., the parameter KLFp \nand KLFi). In our case, the PI controller parameters KLFp and KLFi \nare set as:  \nF\nLFp\nL\nLF\nLK  , and \nF\nLFi\nL\nLF\nRK                             (27) \nwhere τLF is the time constant of the controller. Hence the \ntransfer function GLF(s) simplified as a first-order element as:  \nLF\nLF\n1( ) 1G s s                                 (28) \nHere, τLF=2.5ms is selected so that the current can tracks the \nreference within 10ms – 13ms (usually the step response of a \nfirst-order system reaches 98% of the step value in 4 τLF). \nConsidering the discretization process with 200μs sampling \ntime and using bilinear transform method, G LF(s) and G LD(s) \ncan be converted into discretization form as G LF(z) and GLD(z), \nrespectively. Their bode diagrams are drawn in Fig. 3(b). It can \nbe found that the cut-off frequency fc_LF of GLF(z) is about 65Hz. \nIt is noted that mMF is the MF reference (500Hz in our case), and \nsince\nL L\nMFd 0m v   and L L\nMFq 0m v   are decomposing into the LF \nreference frame (50Hz), their frequencies in the LF reference \nframe is near 500Hz. And from the Bode diagrams, it can be \nfound that G LD(z) provides a −40dB decay (i.e. 0.0001 \nmagnitude) for the 500Hz component and as the frequency goes \nhigher, the decay will become larger. Supposing mMF≈0.5 and \nvΔ0≈1000, it will be attenuated to 0.05, whose impact on the LF \ncurrent can be negligible.  \nB. MF Current Loop Controller \nSimilar to the LF current loop controller, the MF current \ncontroller can be designed as (29) with control diagram shown \nin Fig. 4(a).  \n (29) \nAnd the relationship between M*\ncd,qi  and M\ncd,qi can be obtained \nas:  \n          (30) \nIt can be found that M\ncd,qi  tracks M*\ncd,qi  and the frequency \nresponse is determined by the transfer function G MF(s). Similar \nto that in (26), a disturbance is introduced by terms M M\nLFd 0m v  \nFig. 3.  Details of the LF Controller. (a) control diagram; (b) Bode diagrams.  \nFig. 4.  Details of the MF Controller. (a) control diagram; (b) Bode diagrams.  \n \nFig. 5. Energy balancing controller diagrams (a) vol tage balancing between \nupper and lower arms in the same leg; (b) total energy balancing controller \n \n314 CES TRANSACTIONS ON ELECTRICAL MACHINES AND SYSTEMS, VOL. 4, NO. 4, DECEMBER 2020 \nand M M\nLFq 0m v , and the frequency response is determined by the \ntransfer function GMD(s).  \nThe PI parameter design method is similar to that in the LF \ncurrent loop controller design and the time constant is also set \nas 2.5ms. When M M\nLFd 0m v  and M M\nLFq 0m v are decomposing into the \nMF reference frame (500Hz), their frequencies in the MF \nreference frame are near 500Hz. Similar to the LF controller, \nthe Bode diagrams of the transfer functions after discretizing is \nshown in Fig. 4(b), it can be found that G MD(z) also provides a \n−42dB decay (i.e., about 0.0001 magnitude) for the 500Hz \ncomponent, which makes the controller immune to the \ndisturbance terms \nM M\nLFd 0m v  and M M\nLFq 0m v .  \nV. ENERGY BALANCING CONTROLLER DESIGN \nEnergy balancing between the MMC arms is required for the \nnormal operation of the MMC. The energy balancing controller \nin this paper is designed as the outer loop controller to adjust \nthe current references, which has two aspects: the energy \nbalancing between the upper and lower arms in the same leg, \nand the total energy balancing.  \nA. Energy Balancing Between the Upper and Lower Arms \nThe energy balancing controller can be applied to either MF \nor LF channel. However, if it is applied to the MF channel, a \nMF component (corresponding to the MF d-q reference) needs \nto be injected, which challenges the PI controller bandwidth \ndesign. Instead, applying the energy balancing controller on the \nLF channel is much more convenient, and the design is given as \nfollow.  \nThe arm energy is represented as the SM capacitor voltage \nsummation. From (23), the DC value of the vΔx can be \ncontrolled by injecting a DC bias of igx:  \n_dcSM\ng _dc\nd 0.5d\nx\nx\nvC iN t\n\n                              (31) \nTherefore, the controller is designed as:  \n \n* *i\ng _dc p _dc _dcx x x\nKi K v vs\n\n  \n     \n                (32) \nThe injected DC component igx_dc will be converted to LF \ncomponent in the LF d-q reference, which is within the LF \ncontroller’s bandwidth. This is the reason that we applied this \ncontroller to the LF channel. Design of the parameters KΔi and \nKΔp are similar with those in the previous section, and thus, are \nnot repeated here. The outputs of the PI controllers ( *\ng _dcxi , x=A, \nB, C) are decomposing into the LF d-q reference as shown in \nFig. 5(a), and compensated to the current reference L*\ngd,qi  as \nshown in Fig. 2.  \nB. Total Energy Balancing \nIn the control system, although the active power order P\n* \nLF \nand P\n* \nMF for the LF and MF port are designed as the same, the \nport power may still be different in practical due to two reasons: \n1) the non-ideal factors, such as harmonics and conversion \nlosses, lead to difference between the input and output power; 2) \nthe terms *\ng _dcxi  for energy balancing also impact the reactive \npower of the LF loop. And the active power difference between \nLF and MF loop will charge or discharge the SM capacitors. \nHence the total SM capacitor energy Wsum can be treated as the \nindicator for total energy balancing control. The dynamic of \nWsum can be expressed as:  \nL Msum\nLF MF g gd s cd\nd 3 3\nd 2 2\nW P P V i KV it                        (33) \nAnd the dynamic of Wsum can also be expressed by the SM \n \nFig. 6.  Simulation waveforms of the port voltage and current of the SST during load switching \n \nZHENG et al. : MODELING AND CONTROL OF THE MODULAR MULTILEVEL CONVERTER (MMC) BASED SOLID STATE  \nTRANSFORMER (SST) WITH MAGNETIC INTEGRATION \n315\ncapacitor energy summation:  \n2sum\nSM SM SM SM SM\nd d 1 d\nd d 2 d\ni\nW C v C V vt t t\n\n              (34) \nwhere vSMΣ is the summation of all the SM capacitor voltages. \nA current compensation to M*\ncdi  is introduced to realize total \nenergy balancing of the SST as (35) and the control diagram is \nshown in Fig. 5(b):  \n \n*\nM* *W1\ncd W1p SMΣ SMΣ\ns1.5\niK Pi K v vs KV\n       \n         (35) \nAssuming that M* M\ncd cdi i  and substituting (34) and (35) into \n(33), the transfer function of vSMΣ can be expressed as:  \n \ns W1i s W1p *\nSMΣ SMΣ2\nSM SM s W1i s W1p\nL *\ng gd\n2\nSM SM s W1i s W1p\n1.5 1.5\n1.5 1.5\n1.5\n                1.5 1.5\nKV K s KV Kv vC V s KV K s KV K\nV i P s\nC V s KV K s KV K\n  \n\n  \n     (36) \nSince the energy balancing controller is serve as the outer \nloop of the control system, the cut-off frequency is set as 5Hz. \nThe detailed design process is not repeated here since it is \nsimilar to those in Section IV.  \nVI. VERIFICATION \nA. Simulation \nThe model of the SST with the proposed control system \nshown in Fig. 2 is built in PLECS. The circuit parameters of the \nSST is shown in TABLE I.  \n1) Inner Current Loop Control \nThe transient performance of the inner LF and MF current \nloop controller is shown in Fig. 6, 7 and 8. Fig. 6 shows the \nthree-phase voltage and current waveforms. The reference L*\ngdi  \nis stepped down from 81.63A to 40.82A and M*\ncdi  are stepped \ndown from 83.33A to 41.67A, which is equivalent to the \nsituation that the active power of the SST switches from rated \npower to half rated power condition. And the reference L*\ngqi  and \nM*\ncqi  are all set as zero. vUA and iUA is demonstrated as an \nexample of the arm voltages and currents. Since \nmixed-frequency modulations are used, vUA and iUA contains \nboth LF and MF components as described in (1) – (3). The \nfrequency spectrum of the arm current in rated load condition is \nalso illustrated in Fig. 7. It can be found that the arm currents \nare dominated by the LF and MF components. The amplitude of \nTABLE I \nSIMULATION PARAMETERS SETTING \nParameters Values Parameters  Values \nPN/MW 1.0 fLF, fMF /Hz 50, 500 \nvg(RMS), vLVDC /kV 10, 0.4 CSM/mF 1.0 \nLg, Lσ/mH 10, 2 N 26 \nRg, Rarm /Ω 0.1, 0.1 K 40 \n \n \nFig. 7 Frequency spectrum of the arm current.  \n \nFig. 8.  Performance of the current loop controllers \n \nFig. 9.  Simulation waveforms with the dual loop control system \n316 CES TRANSACTIONS ON ELECTRICAL MACHINES AND SYSTEMS, VOL. 4, NO. 4, DECEMBER 2020 \nthe LF component (41A) is about half of the amplitude of igA \n(82A, see Fig. 6), while the amplitude of the MF component \n(83A) equals to the amplitude of icA. These all match with the \narm current expression in (15). The voltage and current of the \nLF and MF ports are also demonstrated. The port currents and \nvoltages are in phase, indicating that both ports were controlled \nto operate in unit power factor condition. When the current \nreferences changed, the current switched smoothly without \novershoot.  \nThe d-axis and q-axis current components when the power is \nswitching from rated load to half load are illustrated in Fig. 8(a). \nIt can be found that the proposed control method can provide \ngood tracking performance of \nL\ngdi  and M\ncdi . At the same time, the \nimpacts on the q-axis components, i.e., L\ngqi  and M\ncqi , is \nnegligible, which implies good decoupling effect between the \nd- and q- channels. The tracking time of the current is 10ms – \n15ms, which matches with the controller design in Section IV \nwith 2.5ms time constants. Also, small ripples at medium \nfrequency can be found in the d-axis and q-axis current, which \nis introduced by the disturbance terms as discussed in (26) and \n(30). And their amplitudes are small enough thanks to the decay \nfor MF components provided by the controller as shown in the \nbode diagrams in Fig. 3(b) and Fig. 4(b).  \nFig. 8(b) shows the situation that the active power is stepped \nup from half rated power to rated power condition. Similar \nconclusion can be made that the controllers provides good \ntracking performance and effective decoupling.  \n2) Dual Loop control \nThe outer energy balancing control is enabled to balance the \nvoltage of the upper and lower arms, as well as balance the \ninput and output voltage. And the simulation results are shown \nin Fig. 9 when the active power reference is stepped up from \nhalf rated power to rated power condition. It can be seen that \nthe active and reactive power tracks the reference well. And the \nSM capacitor summation is stabilize as the given value with \nonly a little oscillation when the load switches. This is because \nthe tracking process of the active power in the two ports are not \nexactly the same during transient process. This power \ndifference, as well as the differences that introduced by other \nnon-ideal factors, will be compensated by the total energy \ncontroller. And it is seen that the waveforms of vΔx have no DC \nbias, indicating that the energy of the upper and lower arm are \nwell balanced.  \nB. Experiment \nTo further verify the proposed control strategy, a scale-down \nprototype is built in the laboratory. The parameters are shown \nin TABLE II.  \nFig. 10 shows the key waveforms of the prototype. The grid \nvoltage vgA, vgB and current igA, igB is shown in Fig. 10(a). It can \nbe found that vgA and vgB are in phase with igA and igB, \nrespectively, which denotes that the grid port is operating in \nunit power factor condition. And the peak value of the grid \ncurrent is controlled as 5A. Fig. 10(b) shows the transformer \nsecondary voltage vsa and the circulating current icA. It can be \nfound that icA is in phase with the fundamental component of vsa, \nindicating unit power factor operation of the MF port. Fig. 10(c) \nshows the arm current iLA. It can be found that iLA contains the \nLF and MF components, matching with the expression in (15).  \nFig. 11 shows the step response waveforms when the \nrequired active power steps up from 100W to 500W. Good \ntracking performance can still be found in igx and icx. The \ntracking time is within 20ms, which is very close to the \ncontroller design target. And the energy of the upper and lower \narms, which are represented as the summation of SM capacitor \nvoltages vΣUA and vΣLA, are balanced well.  \nTABLE II \nPROTOTYPE PARAMETERS \nParameters Values Parameters  Values \nPN/W 500 fLF, fMF /Hz 50, 500 \nvg(RMS), vLVDC /V 110, 160 CSM/mF 5.0 \nLg, Lσ/mH 2, 0.2 N 4 \nRg, Rarm /Ω 0.1, 0.1 K 2 \n \n \nFig. 10.  Key waveforms of the prototype.  \n \nFig. 11.  Dynamic waveforms of the prototype \nZHENG et al. : MODELING AND CONTROL OF THE MODULAR MULTILEVEL CONVERTER (MMC) BASED SOLID STATE  \nTRANSFORMER (SST) WITH MAGNETIC INTEGRATION \n317\nVII. FURTHER DISCUSSION \nSome important issues are briefly discussed in this section.  \nA. Mixed-frequency Feature Comparison \nThe MMC-based SST in this paper and the MMC-based APF \nboth use the submodule as the buffer to exchange the active \npower at different frequencies. However, they have distinct \ndifferences as follows:  \n1. The MMC-based APF absorbs active power at LF and \noutputs it in harmonics forms near LF. Such process is \ncarried out within the same and only port of the converter, \nand the APF is used for improving the electric quality, not \nfor energy conversion;  \n2. As for the MMC-based SST in this paper, it is designed to \nrealize isolated energy conversion. It absorbs active \npower at LF and outputs it in MF form to the isolation \ntransformer, vice versa. And the topology of such a SST is \ndifferent from the traditional MMC, hence the modeling \nand controller design need to be reconsidered.  \nB. Controller Comparison \nActually, apart from the PI controller based on d-q \ntransformation used in this paper, resonant controller can also \nbe utilized as the current loop controller. Both of them have \ntheir pros and cons. Resonant controller has high gain to \nspecific frequency component and thus, has good tracking \nperformance at the selected frequency. However, resonant \ncontroller has high requirement on the discretization process \nand requires higher sampling frequency [12]. Using PI \ncontroller is much simple, but it should be associated with d-q \ntransformation when applying on three-phase system. \nFor three-phase application, d-q transformation is inevitable \nto realize instantaneous powers monitoring and feedback. \nTherefore, using PI controller is much more simple and \nstraightforward. In many literatures, d-q transformation plus PI \ncontroller is preferred for instantaneous power control while \nresonant controller can be applied for circulating current \nsuppression [13, 14]. Since the goals of our application is to \ncontrol the power of LF and MF ports, applying dual d-q \ntransformation plus PI controller for different control channels \nis more convenient.  \nVIII. CONCLUSION \nA mathematical model for the SST with high integration \nlevel is proposed in this paper to describe the dynamics of the \nstate variables at different frequencies. Based on the model, a \ncontrol system with inner current loop controllers and outer \nenergy balancing controllers is designed. The current loop \ncontrollers are designed based on the dual d-q reference model \nto provide good tracking performance of the LF and MF \ncurrents. The controller parameters are properly set to makes \nthe controller immune to the disturbance at the other frequency. \nAnd the energy balancing is achieved by the outer controllers to \nchange the current references.   \nSimulations and experiments are performed to verify the \nproposed control system. The results show good decoupling \nbetween d and q channels with the proposed control method. \nAnd the dynamics response of each channel is fast without \novershoot.  \nThe controllers designed in this paper do not consider the \nfault conditions yet. To enhance fault ride-through ability, extra \nimplementations should be added. For example, when the \nLVDC short-circuit occurs, the secondary voltages vsy (y=a, b \nor c) would be clamped to zero. In this case, the MF voltages \nvMFx should be reduced to match with vsy, so as to limit the fault \ncurrent; and when the DC bus of MMC is short-circuit, the SM \nshould be protected by extra protection circuit such as thyristors \n[15]-[17]. The detail analysis and design will be done as the \nfuture work.  \nREFERENCES \n[1] M. Liserre, G. Buticchi, M. Andresen, G. De Carne, L. F. Costa and Z. \nZou, \"The Smart Transformer: Impact on the Electric Grid and \nTechnology Challenges,\" in IEEE Industrial Electronics Magazine , vol. \n10, no. 2, pp. 46-58, June 2016.  \n[2]  X. She, R. Burgos, G. Wang, F. Wang and A. Q. Huang, \"Review of solid \nstate transformer in the distribution system: From components to field \napplication,\" 2012 IEEE Energy Conversion Congress and Exposition \n(ECCE), Raleigh, NC, 2012, pp. 4077-4084.  \n[3] D. Wang et al., \"A 10-kV/400-V 500-kVA Electronic Power \nTransformer,\" in IEEE Transactions on Industrial Electronics, vol. 63, no. \n11, pp. 6653-6663, Nov. 2016.  \n[4] J. Zhang, Z. Wang and S. Shao, \"A Three-Phase Modular Multilevel \nDC–DC Converter for Power Electronic Transformer Applications,\" in \nIEEE Journal of Emerging and Selected Topics in Power Electronics, vol. \n5, no. 1, pp. 140-150, March 2017.  \n[5] M. Glinka and R. Marquardt, \"A new AC/AC multilevel converter \nfamily,\" in IEEE Transactions on Industrial Electronics, vol. 52, no. 3, pp. \n662-669, June 2005. \n[6] S. Liu, X. Wang, Y. Meng, P. Sun, H. Luo and B. Wang, \"A Decoupled \nControl Strategy of Modular Multilevel Matrix Converter for Fractional \nFrequency Transmission System,\" in IEEE Transactions on Power \nDelivery, vol. 32, no. 4, pp. 2111-2121, Aug. 2017 \n[7] J. Liu, S. Yue, W. Yao, W. Li and Z. Lu, \"DC Voltage Ripple \nOptimization of a Single-Stage Solid-State Transformer Based on the \nModular Multilevel Matrix Converter,\" in IEEE Transactions on Power \nElectronics, vol. 35, no. 12, pp. 12801-12815, Dec. 2020 \n[8] J. A. Ferreira, \"The Multilevel Modular DC Converter,\" in IEEE \nTransactions on Power Electronics, vol. 28, no. 10, pp. 4460-4465, Oct. \n2013.  \n[9] D. Ma, W. Chen, L. Shu, X. Qu, X. Zhan and Z. Liu, \"A Multiport Power \nElectronic Transformer Based on Modular Multilevel Converter and \nMixed-Frequency Modulation,\" in IEEE Transactions on Circuits and \nSystems II: Express Briefs, vol. 67, no. 7, pp. 1284-1288, July 2020.  \n[10] G. Zheng, Y. Chen and Y. Kang, \"A Modular Multilevel Converter \n(MMC) based Solid State Transformer (SST) Topology with Simplified \nEnergy Conversion Process and Magnetic Integration,\" in IEEE \nTransactions on Industrial Electronics, doi: 10.1109/TIE.2020.3013493.  \n[11] L. Harnefors, A. Antonopoulos, S. Norrga, L. Angquist and H. Nee, \n\"Dynamic Analysis of Modular Multilevel Converters,\" in IEEE \nTransactions on Industrial Electronics, vol. 60, no. 7, pp. 2526-2537, July \n2013.  \n[12] A. G. Yepes, F. D. Freijedo, J. Doval-Gandoy, Ó. López, J. Malvar and P. \nFernandez-Comesaña, \"Effects of Discretization Methods on the \nPerformance of Resonant Controllers,\" in IEEE Transactions on Power \nElectronics, vol. 25, no. 7, pp. 1692-1712, July 2010.  \n[13] V. Najmi, J. Wang, R. Burgos and D. Boroyevich, \"Reliability-oriented \nswitching frequency analysis for Modular Multilevel Converter (MMC),\" \n2015 IEEE Energy Conversion Congress and Exposition (ECCE).  \n[14] X. She, A. Huang, X. Ni and R. Burgos, \"AC circulating currents \nsuppression in modular multilevel converter,\" IECON 2012 - 38th Annual \nConference on IEEE Industrial Electronics Society, Montreal, QC, 2012, \npp. 191-196.  \n[15] P. D. Judge, M. M. C. Merlin, T. C. Green, D. R. Trainer, and K. Vershinin, \n318 CES TRANSACTIONS ON ELECTRICAL MACHINES AND SYSTEMS, VOL. 4, NO. 4, DECEMBER 2020 \n\"Thyristor/Diode-Bypassed Submodule Power Groups for Improved \nEfficiency in Modular Multilevel Converters,\" IEEE Transactions on \nPower Delivery, vol. 34, no. 1, pp. 84-94, 2019. \n[16] F. Shen, Y. Hu, X. Wang, D. Chen, and Y. Teng, \"A DC fault protection \nscheme for half-bridge sub-module based MMC-HVDC,\" in 2017 China \nInternational Electrical and Energy Conference (CIEEC) , 25-27 Oct. \n2017 2017, pp. 564-570.  \n[17]  S. Cui, S. Kim, J. Jung, and S. Sul, \"Principle, control and comparison of \nmodular multilevel converters (MMCs) with DC short circuit fault \nride-through capability,\" in 2014 IEEE Applied Power Electronics \nConference and Exposition - APEC 2014 , 16-20 March 2014 2014, pp. \n610-616. \n \n \n \nGengzhe Zheng  received his B.Eng. and \nM.Eng. degree in electrical engineering \nfrom the School of Electrical and Electronic \nEngineering, Huazhong University of \nScience and Technology (HUST), Wuhan, \nChina, in 2015 and 2018, respectively. \nHe is currently working toward the Ph.D. \ndegree in Electrical Engineering in the \nDepartment of Applied Electronics, School \nof Electrical and Electronic Engineering, HUST, Wuhan, China. \nHis research interests include topology, modulation and control \nof modular multilevel converters. \n \n \n \nYu Chen (S’09–M’11) received the B.E. in \nelectrical engineering and automation, and \nPh.D. degrees in power electronics and \npower drives from the School of Electrical \nand Electronic Engineering, Huazhong \nUniversity of Science and Technology \n(HUST), Wuhan, China, in 2006 and 2011, \nrespectively.  \nFrom March 2008 to March 2009, he was \nan Intern with GE Global Research Center, Shanghai, China. In \nSeptember 2011, he joined HUST as a Lecturer. In December \n2014, he was promoted to associate professor. His research \ninterests include power electronic converter topologies and \ntheir intelligent control. \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \nYong Kang  was born in Hubei Province, \nChina, in 1965. He received the B.E. in \nelectrical engineering and automation, M.E, \nand Ph.D. degrees in power electronics \nfrom the School of Electrical and Electronic \nEngineering, Huazhong University of \nScience and Technology (HUST), in 1988, \n1991, and 1994, respectively.  \nIn 1994, he joined the School of \nElectrical and Electronic Engineering, HUST and became a \nProfessor in 1998. He is the author or coauthor of more than \n200 technical papers published in journals and conferences. His \nresearch interests include power electronic converter, ac drivers, \nelectromagnetic compatibility, and renewable energy \ngeneration system.  \nDr. Kang received the Delta Scholar Award from the Delta \nEnvironmental and Educational Foundation in 2005, and \nsupported by the Program for New Century Excellent Talents in \nUniversity from the Chinese Ministry of Education in 2004.  \n \n \n \n \n",
  "topic": "Modular design",
  "concepts": [
    {
      "name": "Modular design",
      "score": 0.6490179300308228
    },
    {
      "name": "Transformer",
      "score": 0.5854067206382751
    },
    {
      "name": "Decoupling (probability)",
      "score": 0.5424400568008423
    },
    {
      "name": "Control theory (sociology)",
      "score": 0.5353679060935974
    },
    {
      "name": "Computer science",
      "score": 0.46758365631103516
    },
    {
      "name": "Automatic frequency control",
      "score": 0.46491914987564087
    },
    {
      "name": "State variable",
      "score": 0.4460436701774597
    },
    {
      "name": "Electronic engineering",
      "score": 0.42976611852645874
    },
    {
      "name": "Electric power system",
      "score": 0.4292270243167877
    },
    {
      "name": "Control engineering",
      "score": 0.3974856436252594
    },
    {
      "name": "Engineering",
      "score": 0.35716867446899414
    },
    {
      "name": "Control (management)",
      "score": 0.1965944468975067
    },
    {
      "name": "Power (physics)",
      "score": 0.17814722657203674
    },
    {
      "name": "Electrical engineering",
      "score": 0.12894850969314575
    },
    {
      "name": "Physics",
      "score": 0.11050546169281006
    },
    {
      "name": "Voltage",
      "score": 0.10501214861869812
    },
    {
      "name": "Telecommunications",
      "score": 0.075898677110672
    },
    {
      "name": "Artificial intelligence",
      "score": 0.0
    },
    {
      "name": "Operating system",
      "score": 0.0
    },
    {
      "name": "Quantum mechanics",
      "score": 0.0
    },
    {
      "name": "Thermodynamics",
      "score": 0.0
    }
  ]
}