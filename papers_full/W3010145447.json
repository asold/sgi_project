{
  "title": "Predicting retrosynthetic pathways using transformer-based models and a hyper-graph exploration strategy",
  "url": "https://openalex.org/W3010145447",
  "year": 2020,
  "authors": [
    {
      "id": "https://openalex.org/A2769065378",
      "name": "Philippe Schwaller",
      "affiliations": []
    },
    {
      "id": "https://openalex.org/A2046352569",
      "name": "Riccardo Petraglia",
      "affiliations": []
    },
    {
      "id": "https://openalex.org/A2900563755",
      "name": "Valerio Zullo",
      "affiliations": [
        "University of Pisa"
      ]
    },
    {
      "id": "https://openalex.org/A2980790287",
      "name": "Vishnu H Nair",
      "affiliations": []
    },
    {
      "id": "https://openalex.org/A2981013526",
      "name": "Rico Andreas Haeuselmann",
      "affiliations": []
    },
    {
      "id": "https://openalex.org/A2411522835",
      "name": "Riccardo Pisoni",
      "affiliations": []
    },
    {
      "id": "https://openalex.org/A1990181748",
      "name": "Costas Bekas",
      "affiliations": []
    },
    {
      "id": "https://openalex.org/A2031623173",
      "name": "Anna Iuliano",
      "affiliations": [
        "University of Pisa"
      ]
    },
    {
      "id": "https://openalex.org/A2209038682",
      "name": "Teodoro Laino",
      "affiliations": []
    },
    {
      "id": "https://openalex.org/A2769065378",
      "name": "Philippe Schwaller",
      "affiliations": []
    },
    {
      "id": "https://openalex.org/A2046352569",
      "name": "Riccardo Petraglia",
      "affiliations": []
    },
    {
      "id": "https://openalex.org/A2900563755",
      "name": "Valerio Zullo",
      "affiliations": [
        "University of Pisa"
      ]
    },
    {
      "id": "https://openalex.org/A2980790287",
      "name": "Vishnu H Nair",
      "affiliations": []
    },
    {
      "id": "https://openalex.org/A2981013526",
      "name": "Rico Andreas Haeuselmann",
      "affiliations": []
    },
    {
      "id": "https://openalex.org/A2411522835",
      "name": "Riccardo Pisoni",
      "affiliations": []
    },
    {
      "id": "https://openalex.org/A1990181748",
      "name": "Costas Bekas",
      "affiliations": []
    },
    {
      "id": "https://openalex.org/A2031623173",
      "name": "Anna Iuliano",
      "affiliations": [
        "University of Pisa"
      ]
    },
    {
      "id": "https://openalex.org/A2209038682",
      "name": "Teodoro Laino",
      "affiliations": []
    }
  ],
  "references": [
    "https://openalex.org/W2143856302",
    "https://openalex.org/W2912454675",
    "https://openalex.org/W2314934597",
    "https://openalex.org/W2041548070",
    "https://openalex.org/W2324964582",
    "https://openalex.org/W2769756736",
    "https://openalex.org/W2947835681",
    "https://openalex.org/W2907657781",
    "https://openalex.org/W2799620402",
    "https://openalex.org/W2799891377",
    "https://openalex.org/W2794700984",
    "https://openalex.org/W2747592475",
    "https://openalex.org/W2804364726",
    "https://openalex.org/W2580919858",
    "https://openalex.org/W2621742623",
    "https://openalex.org/W2064535969",
    "https://openalex.org/W2328708083",
    "https://openalex.org/W2968071222",
    "https://openalex.org/W2769423117",
    "https://openalex.org/W2947423323",
    "https://openalex.org/W2066412916",
    "https://openalex.org/W2512660405",
    "https://openalex.org/W2606363443",
    "https://openalex.org/W2903262661",
    "https://openalex.org/W2901942917",
    "https://openalex.org/W1981939086",
    "https://openalex.org/W2789615344",
    "https://openalex.org/W2970764640",
    "https://openalex.org/W2987091515",
    "https://openalex.org/W1964981516",
    "https://openalex.org/W1975147762",
    "https://openalex.org/W2325811289",
    "https://openalex.org/W3157889448",
    "https://openalex.org/W2783658781",
    "https://openalex.org/W2046747992",
    "https://openalex.org/W3210078089",
    "https://openalex.org/W2909063104",
    "https://openalex.org/W4210863801",
    "https://openalex.org/W2146950091",
    "https://openalex.org/W1508604947",
    "https://openalex.org/W2622236128",
    "https://openalex.org/W2024708363",
    "https://openalex.org/W3004726564",
    "https://openalex.org/W2015314070",
    "https://openalex.org/W1896268345",
    "https://openalex.org/W2085126686",
    "https://openalex.org/W2745591971",
    "https://openalex.org/W2728532854",
    "https://openalex.org/W3103092523",
    "https://openalex.org/W2559655401",
    "https://openalex.org/W4234441127",
    "https://openalex.org/W388296777",
    "https://openalex.org/W2040166913",
    "https://openalex.org/W4206174637",
    "https://openalex.org/W3100545487",
    "https://openalex.org/W2502577508"
  ],
  "abstract": "We present an extension of our Molecular Transformer model combined with a hyper-graph exploration strategy for automatic retrosynthesis route planning without human intervention.",
  "full_text": "Predicting retrosynthetic pathways using\ntransformer-based models and a hyper-graph\nexploration strategy†\nPhilippe Schwaller, *a Riccardo Petraglia,a Valerio Zullo,b Vishnu H. Nair,a\nRico Andreas Haeuselmann,a Riccardo Pisoni,a Costas Bekas,a Anna Iuliano b\nand Teodoro Lainoa\nWe present an extension of our Molecular Transformer model combined with a hyper-graph exploration\nstrategy for automatic retrosynthesis route planning without human intervention. The single-step\nretrosynthetic model sets a new state of the art for predicting reactants as well as reagents, solvents and\ncatalysts for each retrosynthetic step. We introduce four metrics (coverage, class diversity, round-trip\naccuracy and Jensen– Shannon divergence) to evaluate the single-step retrosynthetic models, using the\nforward prediction and a reaction classiﬁcation model always based on the transformer architecture. The\nhypergraph is constructed on the ﬂy, and the nodes are ﬁltered and further expanded based on\na Bayesian-like probability. We critically assessed the end-to-end framework with several retrosynthesis\nexamples from literature and academic exams. Overall, the frameworks have an excellent performance\nwith few weaknesses related to the training data. The use of the introduced metrics opens up the\npossibility to optimize entire retrosynthetic frameworks by focusing on the performance of the single-\nstep model only.\n1 Introduction\nThe eld of organic chemistry has been continuously evolving,\nmoving its attention from the synthesis of complex natural\nproducts to the understanding of molecular functions and\nactivities.\n1–3 These advancements were made possible thanks to\nthe vast chemical knowledge and intuition of human experts,\nacquired over several decades of practice. Among the diﬀerent\ntasks involved, the design of eﬃcient synthetic routes for a given\ntarget (retrosynthesis) is arguably one of the most complex\nproblems. Key reasons include the need to identify a cascade of\ndisconnections schemes, suitable building blocks and func-\ntional group protection strategies. Therefore, it is not surprising\nthat computers have been employed since the 1960s,\n4 giving rise\nto several computer-aided retrosynthetic tools.\nRule-based or similarity-based methods have been the most\nsuccessful approach implemented in computer programs for\nmany years. While they suggest very eﬀective\n5,6 pathways to\nmolecules of interest, these methods do not strictly learn\nchemistry from data but rather encode synthon generation\nrules. The main drawback of rule-based systems is the need for\nlaborious manual encoding, which prevents scaling with\nincreasing data set sizes. Moreover, the complexity in assessing\nthe logical consistency among all existing rules and the new\nones increases with the number of codied rules and may\nsooner or later reach a level where the problem becomes\nintractable.\n1.1 The dawn of AI-driven chemistry\nWhile human chemical knowledge will keep fueling the organic\nchemistry research in the years to come, a careful analysis of\ncurrent trends\n5,7–20 and the application of basic extrapolation\nprinciples undeniably shows that there are growing expecta-\ntions on the use of Articial Intelligence (AI) architectures to\nmimic human chemical intuition and to provide research\nassistant services to all bench chemists worldwide.\nConcurrently to rule-based systems, a wide range of AI\napproaches have been reported for retrosynthetic analysis,\n9,12\nprediction of reaction outcomes21–26 and optimization of reaction\nconditions.27 All these AI models superseded rule-based methods\nin their potential of mimicking the human brain by learning\nchemistry from large data sets without human intervention.\nThis extensive production of AI models for organic chemistry\nwas made possible by the availability of public data.\n28,29\nHowever, the noise contained in this data generated by the text-\nmining extraction process heavily holds back their potential. In\nfact, while rule-based systems\n30 demonstrated, through wet-lab\naIBM Research GmbH, Zurich, Switzerland. E-mail: phs@zurich.ibm.com\nbDepartment of Chemistry and Industrial Chemistry, University of Pisa, Pisa, Italy\n† Electronic supplementary information (ESI) available: Model and data\ndescription, detailed hyper-graph expansion algorithm, predicted retrosynthetic\npathways. See DOI: 10.1039/c9sc05704h\nCite this:Chem. Sci., 2020,11, 3316\nAll publication charges for this article\nhave been paid for by the Royal Society\nof Chemistry\nReceived 11th November 2019\nAccepted 2nd March 2020\nDOI: 10.1039/c9sc05704h\nrsc.li/chemical-science\n3316 | Chem. Sci.,2 0 2 0 ,11,3 3 1 6–3325 This journal is © The Royal Society of Chemistry 2020\nChemical\nScience\nEDGE ARTICLE\nOpen Access Article. Published on 03 March 2020. Downloaded on 11/5/2025 2:05:34 PM. \n This article is licensed under a \nCreative Commons Attribution-NonCommercial 3.0 Unported Licence.\nView Article Online\nView Journal\n | View Issue\nexperiments, the capability to design target molecules with less\npurication steps and hence, leading to savings in time and\ncost,31 the AI approaches6,9,12,16,32–38 still have a long way to go.\nAmong the diﬀerent AI approaches39 those treating chemical\nreaction prediction as natural language (NL) problems40 are\nbecoming increasingly popular. They are currently state of the\nart in the forward reaction prediction realm, scoring an unde-\nfeated accuracy of more than 90%.\n22 In the NL framework,\nchemical reactions are encoded as sentences using reaction\nSMILES41 and the forward- or retro-reaction prediction is cast as\na translation problem, using diﬀerent types of neural machine\ntranslation architectures. One of the most signicant advan-\ntages of representing synthetic chemistry as a language is the\ninherent scalability for larger data sets, as it avoids important\ncaveats such as the need for humans to assign reaction\ncenters.\n6,30 The Molecular Transformer architecture 42 is\ncurrently the most popular approach to treat chemistry as\na language. Its trained models fuel the cloud-based IBM RXN43\nfor Chemistry platform.\n1.2 Transformer-based retrosynthesis: current status\nInspired by the success of the Molecular Transformer22,42,43 for\nforward reaction prediction, a few retrosynthetic models based\non the same architecture were reported shortly aer.\n32,33,35–37\nZheng et al.32 proposed a template-free self-corrected retrosyn-\nthesis predictor built on the Transformer architecture. The\nmodel achieves 43.7% top-1 accuracy on a small standardized\n(50k reactions) data set.\n44 They were able to reduce the initial\nnumber of invalid candidate precursors from 12.1% to 0.7%\nusing a coupled neural network-based syntax checker. Previous\nwork reported less than 0.5% of invalid candidates in forward\nreaction prediction,\n22 without the need of any additional syntax\nchecker. Karpov et al.33 described a Transformer model for\nretrosynthetic reaction predictions trained on the same data\nset.\n44 They were able to successfully predict the reactants with\na top-1 accuracy of 42.7%. Linet al.35 combined a Monte-Carlo\ntree search, previously introduced for retrosynthesis in the\nground-breaking work by Segler et al.,12 with a single retro-\nsynthetic step Transformer architecture for predicting multi-\nstep reactions. In a single-step setting, the model described by\nLin et al.\n35 achieved a top-1 prediction accuracy of over 43.1%\nand 54.1% when trained on the same small data set44 and a ten\ntimes larger collection, respectively. Duanet al.37 increased the\nbatch size and the training time for their Transformer model\nand were able to achieve a top-1 accuracy of 54.1% on the 50k\nUSPTO data set.44 Later on, the same architecture was reported\nto have a top-1 accuracy of 43.8%,36 in line with the three\nprevious transformer-based approaches32,33,35 but signicantly\nlower than the accuracy previously reported by Duanet al.37\nInterestingly, the transformer model was also trained on\na proprietary data set, 36 including only reactions with two\nreactants with a Tanimoto similarity distribution peaked at\n0.75, characteristic of an excessive degree of similarity (roughly\ntwo times higher than the USPTO). Despite the high reported\ntop-1 accuracy using the proprietary training and testing set, it\nis questionable how a model that overts a particular ensemble\nof identical chemical transformations could be used in practice.\nRecently, a graph enhanced transformer model\n45 and a mixture\nmodel46 were proposed, achieving a top-1 accuracy of 44.9% and\nmore diverse reactant suggestions, respectively, with no\nsubstantial improvements over previous works.\nExcept for the work of Lin et al.,\n35 all transformer-based\nretrosynthetic approaches were limited to a single step only.\nNone of the previously reported works attempts the concurrent\npredictions of reagents, catalysts and solvent conditions but\nonly reactants.\nIn this work, we present an extension of our Molecular\nTransformer architecture combined with a hyper-graph explo-\nration strategy to design retrosynthetic pathways without\nhuman intervention. Compared to all other existing works\nusing AI, we predict reactants as well as reagents for each ret-\nrosynthetic step, which signicantly increases the diﬃculty of\nprediction.\n47 Throughout the article, we will refer to reactants\nand reagents (e.g. solvents and catalysts) as precursors (see\nFig. 1). We criticize the use of the condence level intrinsic to\nthe retrosynthetic model (top-N accuracy) and introduce new\nmetrics (coverage, class diversity, round-trip accuracy and Jen-\nsen–Shannon divergence) to evaluate the single-step retro-\nsynthetic model, using the corresponding forward prediction\nand a reaction classication model. This provides a general\nassessment of each retrosynthetic step capturing the essential\naspects a model should have to perform similarly to human\nexperts in retrosynthetic analysis.\nThe optimal synthetic pathway is found through a beam\nsearch on the hyper-graph of the possible disconnection strat-\negies. The hyper-graph is constructed on they, and the nodes\nare ltered and subject to further expansion based on\na Bayesian-like probability that makes use of the forward\nprediction likelihood and the SCScore\n48 to prioritize synthetic\nsteps. This strategy allows circumventing potential selectivity\ntraps, penalizing non-selective reactions and precursors with\nhigher complexity than the targets and leads to termination\nwhen commercially available building blocks are identied. We\nrelate the quality of the retrosynthetic tree to the likelihood\ndistributions of the forward prediction model and suggest the\nuse of the Jensen –Shannon divergence to characterize the\nsimilarity of the distributions. This holistic analysis provides\nrst the time a way to improve the quality of multi-step retro-\nsynthetic tools systematically.\nFinally, we critically assessed the entire AI framework by\nreviewing several retrosynthetic problems, some of them from\nliterature data and others from academic exams. We show that\nreaching high performance on a subset of metrics for single-\nstep retrosynthetic prediction is not benecial in a multi-step\nframework. We also demonstrate that the use of all newly\ndened metrics provides an evaluation of end-to-end solutions,\nthereby focusing only on the quality of the single-step predic-\ntion model. The trained models and the entire architecture is\nfreely available online.\n43 The potential of the presented tech-\nnology is high, augmenting the skills of less experienced\nchemists but also enabling chemists to design and protect the\nintellectual property of non-obvious synthetic routes for given\ntargets.\nThis journal is © The Royal Society of Chemistry 2020 Chem. Sci.,2 0 2 0 ,11,3 3 1 6–3325 | 3317\nEdge Article Chemical Science\nOpen Access Article. Published on 03 March 2020. Downloaded on 11/5/2025 2:05:34 PM. \n This article is licensed under a \nCreative Commons Attribution-NonCommercial 3.0 Unported Licence.\nView Article Online\n2 Methods\n2.1 Evaluation metrics for single-step retrosynthetic models\nThe evaluation of retrosynthetic routes is a task for human\nexperts. Unfortunately, every evaluation is tedious and diﬃcult\nto scale to a large number of examples. Therefore, it is chal-\nlenging to generate statistically relevant results for more than\na few diﬀerent model settings. By using an analogy with human\nexperts, we propose to use a forward prediction model\n12,49 and\na reaction classication model to assess the quality50 of the\nretrosynthetic predictions. The forward prediction model esti-\nmates the likelihood of the forward reaction of a single-step\nretrosynthesis and the classication model provides its corre-\nsponding class. Model scores have already been used as an\nalternative to human annotators to evaluate generative adver-\nsarial networks.\n51 In our context, we dene a retrosynthetic\nprediction as valid if the suggested set of precursors leads to the\noriginal product when processed by the forward chemical\nreaction prediction model (see Fig. 2). More detail about the\nforward prediction and the reaction classication model can be\nfound in the ESI.† Here we introduce four new metrics (round-\ntrip accuracy, coverage, class diversity and the Jensen–Shannon\ndivergence) to thoroughly evaluate retrosynthetic models.\nThe round-trip accuracy quanties what percentage of the\nretrosynthetic suggestions is valid. This metric is an crucial\nevaluation as it is desirable to have as many valid suggestions as\npossible. This metric is highly dependent on the number of\nbeams, as generating more outcomes through the use of a beam\nsearch might lead to a smaller percentage of valid suggestions\ndue to lower quality suggestions in case of a higher number of\nbeams.\nThe coverage quanties the number of target molecules for\nwhich the retrosynthetic model produces at least one valid\nprecursors suggestion. With this metric, one wants to prevent\nrewarding models that produce many valid precursors for only\na few reactions. Such a behavior could result in a relatively high\nround trip accuracy but would result in a small coverage. A\nretrosynthetic model should be able to produce valid sugges-\ntions for a wide variety of target molecules.\nThe class diversity is complementary to the coverage,a s\ninstead of relating to targets it counts the number of diverse\nreaction superclasses predicted by the retrosynthetic model,\nFig. 1 Retrosynthesis step suggestion for 13-(1,10-phenanthrolin-2-yl)-10-(9-phenyl-9H-carbazol-3-yl)-10H-phenanthro[9,10-b]carbazole\nusing a chloro-Suzuki coupling reaction. In (a) only the reactants are predicted. In (b) all the precursors are predicted, which increases the overall\ndiﬃculty of the single-step prediction task. While for (a) two molecules consisting of a total of 68 atoms are predicted, the target of (b) are six\nmolecules consisting of 157 atoms.\nFig. 2 Overview of single-step retrosynthesis evaluation metrics.\n3318 | Chem. Sci.,2 0 2 0 ,11, 3316–3325 This journal is © The Royal Society of Chemistry 2020\nChemical Science Edge Article\nOpen Access Article. Published on 03 March 2020. Downloaded on 11/5/2025 2:05:34 PM. \n This article is licensed under a \nCreative Commons Attribution-NonCommercial 3.0 Unported Licence.\nView Article Online\nupon classication. A single-step retrosynthetic model should\npredict a wide diversity of disconnection strategies, which\nmeans generating precursors leading to the same product, with\nthe corresponding reactions belonging to diﬀerent reaction\nclasses. Allowing a multitude of diﬀerent disconnection strate-\ngies is benecial for an optimal route search and essential,\nprecisely when the target molecule contains multiple functional\ngroups.\nFinally, the Jensen–Shannon divergence, which is used to\nmeasure the similarity between the likelihood distributions of\nthe suggested reactions belonging to the 12 diﬀerent reaction\nsuperclasses i above a threshold of 0.5, is calculated as follows:\nJSDðP\n0; P1; .; P11Þ¼ H\n X11\ni¼0\n1\n12Pi\n!\n/C0 1\n12\nX11\ni¼0\nHðPiÞ; (1)\nwhere Pi denote the probability distributions and H(P) the\nShannon entropy for the distributionP.\nTo compute the Jensen–Shannon divergence, we split the\nsingle-step retrosynthetic reactions into superclasses and use\nthe likelihoods predicted by the forward model to build a like-\nlihood density function for each class, which are then normal-\nized by the entropy function in the Jensen–Shannon divergence\nequation. This metric is crucial to assess the quality of\na sequence of retrosynthetic steps. Having a model with\na dissimilar likelihood distribution would be equivalent to\nhaving a human expert favor a few specic reaction classes over\nothers. This would result in an introduction of bias favoring\nthose classes with dominant likelihood distributions. While it is\ndesirable to have a peaked distribution, as this is an evident\nsign of the model learning from the data, it is also desirable to\nhave all the likelihood distributions equally peaked, with none\nof them exercising more inuence than the others during the\nconstruction of a large number of retrosynthetic trees. The\ninverse of the Jensen–Shannon divergence (1/JSD) is a measure\nof the similarity of the likelihood distributions among the\ndiﬀerent superclasses and we use this parameter as an eﬀective\nmetric to guarantee uniform likelihood distributions among all\npossible predicted reaction classes. Uneven distributions are\ndirectly connected to the nature of the training data set. All\nthese four metrics have been critically designed and assessed\nwith the help of human domain experts. Their combined use\npaves the way for a systematic improvement of entire retro-\nsynthetic frameworks, by adequately tuning data sets that\noptimize the diﬀerent single-step performance indicators in\na multi-objective fashion. An example of the metrics is made\navailable online.\n52\nAdditionally, we use the open-source chemoinformatics\nsoware RDKit53 to evaluate the percentage of syntactically valid\npredicted molecules (grammatically correct SMILES).\n2.2 Hyper-graph exploration\nA retrosynthetic tree is equivalent to a directed acyclic hyper-\ngraph, a mathematical object composed of hyper-arcs (A) that\nlink nodes (N). The main diﬀerence compared to a typical graph\nis that a hyper-arc can link multiple nodes, similar to what\nhappens in a retrosynthesis: if a node represents a target\nmolecule, the hyper-arcs connecting to diﬀerent nodes repre-\nsent all possible reactions involving those corresponding\nmolecules. Hyper-arcs have an intrinsic direction de ning\nwhether the reaction is forward or retro (see Fig. 3).\nA retrosynthetic route needs to be free of any loops, i.e.\nacyclic. This requirement renders the retrosynthetic route\na hyper-tree,\n54 in which the root is the target molecule and the\nleaves are the commercially available starting materials (see\nFig. 4). We use the database provided by eMolecules\n55 to\ndetermine if a molecule is available or not.\nIn cases where the hyper-graph of the entire chemical space\nis available, an exhaustive search may reveal all the possible\nsynthetic pathways leading to a target molecule from dened\nstarting materials. Instead, here we build the hyper-tree on the\ny: only the nodes and arcs expanding in the direction of the\nmost meaningful retrosynthesis are calculated and added to the\nexisting tree. The retrosynthesis exploration uses a SCScore\n48-\nbased Bayesian-like probability to decide the direction along\nwhich the graph is expanded, driving the tree towards more\nsimple precursors. In Fig. 5, we show a schematic representa-\ntion of the multi-step retrosynthetic workow. Given a target\nmolecule, we use a single-step retrosynthetic model to generate\na certain number of possible disconnections (i.e. precursors\nset). We canonicalize the predicted reaction smiles and deter-\nmine their reaction class. We compute the SCScore as well as\nthe reaction likelihood with the forward prediction model on\nthe corresponding inchied entry. In order to discourage the\nuse of non-selective reactions, we lter the single-step retro-\nsynthetic predictions by using a threshold on the reaction\nlikelihood returned by the forward model. The likelihood and\nSCScore of the ltered predictions are combined to compute\na probability score to rank all the options. In case all the pre-\ndicted precursors are commercially available the retrosynthetic\nanalysis provides that option as a possible solution and the\nexploration of that tree branch is considered complete. If not,\nwe repeat the entire cycle using the precursors as initial target\nmolecules until we reach either commercially available\nFig. 3 A generic reaction (top of the picture) can be represented as\na hyper-graph. Each molecule involved in the reaction becomes\na node in the hyper-graph while the hyper-arc, connecting the\nreactants and reagents to the product, represents the reaction arrow.\nThis journal is © The Royal Society of Chemistry 2020 Chem. Sci.,2 0 2 0 ,11,3 3 1 6–3325 | 3319\nEdge Article Chemical Science\nOpen Access Article. Published on 03 March 2020. Downloaded on 11/5/2025 2:05:34 PM. \n This article is licensed under a \nCreative Commons Attribution-NonCommercial 3.0 Unported Licence.\nView Article Online\nmolecules or the maximum number of specied retrosynthesis\nsteps. The single-step forward and retrosynthetic predictive\nmodels, as well as the multi-step framework, do not contain\nexplicitly encoded chemical knowledge: the only chemical\nknowledge embedded is the one learned from the data during\nthe training processes. The algorithmic details and the path\nscoring function are detailed in the ESI.†\n3 Results and discussion\n3.1 Single-step retrosynthesis\nThe top-N accuracy score is the preferred method to evaluate the\nquality of single-step predictive models. While this is entirely\njustied for the evaluation of forward reaction prediction, its\nusage in the context of single-step retrosynthetic models is\nmisleading, as recently suggested also by Thakkaret al.\n38 Top-N\naccuracy means that the ground truth precursors were found\nwithin the rst N suggestions of the retrosynthetic model. In\ncontrast to forward prediction models, a target molecule rarely\noriginates from one set of precursors only. Oen the presence of\ndiﬀerent functional groups allows a multitude of possible\ndisconnection strategies to exist, leading to diﬀerent sets of\nreactants, as well as possible solvents and catalysts.\nThe analysis of the USPTO stereo data set, derived from the\ntext-mined open-source reaction data set by Lowe,\n28,29 and of the\nPistachio data set,56 shows that 6% of the products, and 14%\nrespectively, have at least two diﬀerent sets of precursors. While\nthese numbers only reect the organic chemistry represented in\neach data set, the total number of possible disconnections is\nundoubtedly larger. Considering the limited size of existing\ndata sets, it is evident that, in the context of retrosynthesis, the\ntop-N accuracy rewards the ability of a model to retrieve ex-\npected answers from a data set more than that to predict\nchemically meaningful precursors. Therefore, a top-N compar-\nison with the ground truth is not an adequate metric for\nassessing retrosynthetic models.\nHere, we dispute the previous use of top-N accuracy in single-\nstep retrosynthetic models\n6,9,12,16,32–37 and propose four new\ndiﬀerent metrics (round-trip accuracy, coverage, class diversity\nand Jensen–Shannon divergence,57 see Section 2.1) for their\nevaluation.\nDuring the development phase, we trained diﬀerent retro-\nsynthetic transformer-based models with two diﬀerent data\nsets, one fully based on open-source data (stereo) and one on\nbased commercially available data from Pistachio (pistachio). In\nsome cases, the data set was inchi ed58 (labelled with _i).\nTable 1 shows the results for the retrosynthetic models, evalu-\nated using axed forward prediction model (pistachio_i) on two\nvalidation sets (stereo and pistachio). The coverage represents\nthe percentage of desired products for which at least one valid\nprecursor set was suggested. It was slightly better forstereo but\nabove 90% for all the model combinations, which is an\nimportant requirement to guarantee the possibility to always\noﬀer at least one disconnection strategy. Likewise, the class\ndiversity, which is an average of how many diﬀerent reaction\nclasses are predicted in a single retrosynthetic step, was\ncomparable for both models with slightly better performance\nfor the pistachio model. The round-trip accuracy, which is the\npercentage of precursor sets leading to the initial target when\nevaluated with the forward model, was better forstereo than for\npistachio. Despite the stereo retrosynthetic model performed\nbetter than thepistachio model in terms of round-trip accuracy\nand coverage, the synthesis routes generated with this model\nwere of lower quality and oen characterized by a sequence of\nillogical protection/deprotection steps as determined by the\nhuman expert assessment (last column in Table 1). This\napparent paradox became clear when we analyzed in detail how\nhumans approach the problem of retrosynthesis.\nSolving retrosynthetic problems requires a careful analysis of\nwhich ones among multiple precursors could lead to the\ndesired product more eﬃciently, as seen in Fig. 6 for 5-bromo-2-\nFig. 4 Example of hyper-graph complexity. The molecule H is the\ntarget (purple label). The red lines represent the synthetic path from\ncommercially available precursors (highlighted in green) to the target\nmolecule. The yellow line, does not aﬀect the retrosynthesis of H,\nneither does the last reaction with black lines.\nFig. 5 Schematic of the multi-step retrosynthetic workﬂow.\n3320 | Chem. Sci.,2 0 2 0 ,11, 3316–3325 This journal is © The Royal Society of Chemistry 2020\nChemical Science Edge Article\nOpen Access Article. Published on 03 March 2020. Downloaded on 11/5/2025 2:05:34 PM. \n This article is licensed under a \nCreative Commons Attribution-NonCommercial 3.0 Unported Licence.\nView Article Online\nmethoxypyridine. Humans address this issue by mentally\nlisting and analyzing all possible disconnection sites and\nretaining only the options, for which the corresponding\nprecursors are thought to produce the target molecule most\nselectively.\nFor an expert, it is not suﬃcient to alwaysnd at least one\ndisconnection site (coverage) and be sure that the correspond-\ning precursors will selectively lead to the original target (round-\ntrip accuracy). It is necessary to generate a diverse sample of\ndisconnection strategies to cope with competitive functional\ngroup reactivity (class diversity). Moreover, most important,\nevery disconnection class needs to have a similar probability\ndistribution to all the other classes (Jensen–Shannon diver-\ngence, JSD). Continuing the parallelism with human experts, if\none was exposed to the same reaction classes for many years,\nthe use of those familiar schemes in the route planning would\nappear more frequently, leading to strongly biased retrosyn-\nthesis. Therefore, it is essential to reduce any bias in single-step\nretrosynthetic models to a minimum.\nTo evaluate the bias of single-step models, we use the JSD of\nthe likelihood distributions for the prediction divided in\ndiﬀerent reaction superclasses, which we report in Table 1 as 1/\nJSD. The larger this number, the more similar the likelihood\ndistributions of the reactions belonging to diﬀerent classes are\nand hence, the less dominant (lower bias) individual reaction\nclasses are in the multi-step synthesis. In Fig. 7, we show the\nlikelihood distributions for the diﬀerent models in Table 1.\nExcept for the resolution class, all of the distributions show\na peak close to 1.0, which clearly shows that the model learned\nhow to predict the reaction in those classes. The resolution class\nis instead relatively at as a consequence of the poor data\nquality/quantity for stereochemical reactions both in thestereo\nand pistachio data set. Interestingly, one can see that for the\nstereo model the likelihood distributions of the deprotection,\nreduction and oxidation reactions are diﬀerent (and generally\nmore peaked) from all other distributions generated with the\nsame model. This statistical imbalance favors those reaction\nclasses and explains the occurrence of illogical loops of\nprotection/deprotection or oxidation/reduction strategies.\nWhile peaked distributions are desirable, as this is a conse-\nquence of the model learning to predict disconnection strate-\ngies in a precise class, the dissimilarity (JSD) between the twelve\nprobability distributions reects an intrinsic bias, likely due to\nunbalanced data sets. Among the few models reported, the\npistachio model was found to have the best similarity (1/JSD)\nscore and is the one analyzed in the subsequent part of the\nmanuscript and made available online.\nThe class diversity and similarity scores require the identi-\ncation of the reaction class for each prediction. We used\nTable 1 Evaluation of single-step retrosynthetic models. The test data set consisted of 10k entries. For every reaction we generated 10\npredictions. The number of resulting precursor suggestions was 100k. Round-trip accuracy (RT), coverage (Cov.), class diversity (CD), the inverse\nof the Jensen– Shannon divergence of the class likelihood distributions (1/JSD), the percentage of invalid SMILES (ismi) and the human expert\nevaluation (hu. ev.) are reported in the table. Models with the“_i” suﬃx were trained on an inchiﬁed data set. Models starting with“ste” were\ntrained with thestereo data set and the ones with“pist” with thepistachio data set\nModel Retro Forw. Test data RT [%] Cov. [%] CD\n1\nJSD ismi [%] hu. ev.\nste_i pist_i ste 81.2 95.1 1.8 16.5 0.5 /C0\nste_i pist_i pist 79.1 93.8 1.8 20.6 1.1 /C0\npist_i pist_i pist 74.9 95.3 2.1 22.0 0.5 +\npist pist_i pist 71.1 92.6 2.1 27.2 0.6 ++\nFig. 6 Highlighting a few of the precursors and reactions leading to 5-\nbromo-2-methoxypyridine that are found in the US Patents data set.\nThe molecules were depicted with CDK.\n59\nFig. 7 The likelihood distributions predicted by a forward model\n(pistachio_i) for the reactions suggested by diﬀerent retro models. We\nshow the likelihood range between 0.5 and 1.0.\nThis journal is © The Royal Society of Chemistry 2020 Chem. Sci.,2 0 2 0 ,11,3 3 1 6–3325 | 3321\nEdge Article Chemical Science\nOpen Access Article. Published on 03 March 2020. Downloaded on 11/5/2025 2:05:34 PM. \n This article is licensed under a \nCreative Commons Attribution-NonCommercial 3.0 Unported Licence.\nView Article Online\na transformer-based reaction classication model, as described\nin.50 In Fig. 8, we report the ground truth classied by the\nNameRXN60 tool, the class distribution predicted by our clas-\nsication model on the ground truth reactions andnally, the\nclass distributions predicted for the reactions suggested by the\nretrosynthesis models (see Table 1). We observe that the clas-\nsications made by our class prediction model are in agreement\nwith the ones of NameRXN\n60 and match them with an accuracy\nof 93.8%. The distributions of the single-step retrosynthetic\nmodels resemble the original one with the number of unrec-\nognized reactions nearly halved. All of the models learned to\npredict more recognizable reactions, even for products, for\nwhich there was an unrecognized reaction in the ground truth.\n3.2 A holistic evaluation of the pathway prediction\nAn evaluation of the model was carried out through performing\nthe retrosynthesis of the compounds reported in Fig. 9. Some of\nthese are known compounds, for which the synthesis is re-\nported in the literature (1, 2, 5, 7, 8), others (3, 4, 6, 9) are\nunknown structures, which are similar to structures reported in\nthe organic synthesis textbooks. The latter are challenging\ntargets for students and useful to test the capability of the\nmodel to solve entirely new synthetic problems. For therst\ngroup, the evaluation of the model could be made by comparing\nthe proposed retrosynthetic analysis with the known synthetic\npathway. For the second group, a critical evaluation of the\nproposed retrosynthesis, which takes into account the level of\nchemo-, regio-, and stereoselectivity for every retrosynthetic step\nwas performed. The parameters used for each retrosynthesis are\nreported in the ESI.† In some cases, the default values were\nchanged to increase the hyper-graph exploration and yield\nbetter results. As an output, the model generates several retro-\nsynthetic sequences for each compound, each one with\nad iﬀerent condence level. Because the model predicts not\nonly reactants but also reagents, solvents and catalysts, there\nare several sequences with similar condence level and iden-\ntical disconnection strategies and diﬀering only by the sug-\ngested reaction solvents in a few steps. Therefore, we report only\none of the similar sequences in the ESI.†\nAll of the retrosynthetic routes generated for compounds1, 2\nand 3 fulll the criteria of chemoselectivity. The highest con-\ndence sequence (called“sequence 0”)o f 1 corresponds to the\nreported synthesis of the product\n61 and starts from the\ncommercially available acrylonitrile. The other two sequences\n(17 and 22) use synthetic equivalents of acrylonitrile and also\nshow its preparation. For compound2, the highest condence\nretrosynthetic sequence (sequence 0) does not correspond to\nthe synthetic pathway reported in the literature, where the key\nstep is the opening of an epoxide ring. Two other sequences (5\nand 23) report this step, and one of them (sequence 5) corre-\nsponds to the literature synthesis.\n62 The retrosynthetic sequence\nfor compound 3 provides a Diels–Alder reaction as the rst\ndisconnection strategy and proposes a correct retrosynthetic\npath for the synthesis of the diene from available precursors. A\nstraightforward retrosynthetic sequence was also found in the\ncase of compound4, where the diene moiety was disconnected\nby two olenation reactions and the sequence uses structurally\nsimple compounds as starting material. It may be debatable\nwhether the two olenations through a Horner–Wadsworth–\nEmmons reaction, can really be stereoselective towards theE-\ncongurated alkenes or whether the reduction of the conjugate\naldehyde by NaBH\n4 can be completely chemoselective towards\nthe formation of the allylic alcohol. Only experimental work can\nsolve this puzzle and give the correct answer.\nThe retrosynthesis of racemic omeprazole 5 returned\na sequence consisting of one step only because the modelnds\nin its library of available compounds the sulde precursor of the\nnal sulfoxide. When repeating the retrosynthesis using\nbenzene as starting molecule in conjunction with a restricted\nset of available compounds, we obtained a more complete ret-\nrosynthetic sequence with some steps in common with the\nFig. 8 Distribution of reaction superclasses for the ground truth,60 the\npredicted superclasses for the ground truth reactions and the pre-\ndicted superclasses for the reactions suggested by the diﬀerent ret-\nrosynthesis models.\nFig. 9 Set of molecules used to assess the quality of retrosynthesis.\n3322 | Chem. Sci.,2 0 2 0 ,11, 3316–3325 This journal is © The Royal Society of Chemistry 2020\nChemical Science Edge Article\nOpen Access Article. Published on 03 March 2020. Downloaded on 11/5/2025 2:05:34 PM. \n This article is licensed under a \nCreative Commons Attribution-NonCommercial 3.0 Unported Licence.\nView Article Online\nreported one.63 However, although all of the steps fulll the\nchemoselectivity requirement, the sequence is characterized by\nsome avoidable protection–deprotection steps. This sequence\nnicely reects the bias present in the likelihood distributions of\nthe diﬀerent superclasses for the chosen model. Although the\nsingle-step retrosynthetic model has the best Jensen–Shannon\ndivergence among all of the trained models, there is still room\nfor improvements that we will explore in the future. A higher\nsimilarity across the likelihood distributions will prevent the\noccurrence of illogical protection–deprotection, esterication/\nsaponication steps.\nBesides, the reported sequence for5 lists a compound not\npresent in the restricted set of available molecules as starting\nmaterial. A “de novo” retrosynthesis of this compound solved\nthe problem. The retrosynthetic sequence of the structurally\ncomplex compound 6 was possible only with wider settings\nallowing a more extensive hyper-graph exploration. The result\nwas a retrosynthetic route starting from simple precursors:\nnotably, the sequence also showed the synthesis of the triazole\nring through a Huisgen cycloaddition. However, we recognized\nthe occurrence of some chemoselectivity problems in step 6,\nwhen the enolate of the ketone is generated in the presence of\nan acetate group, used as protection of the alcohol. This\nproblem could be avoided by using a diﬀerent protecting group\nfor the alcohol. By contrast, the alkylation of the ketone enolate\nby means of a benzyl bromide bearing an enolizable ester group\nin the structure appears less problematic, due to the high\nreactivity of the bromide. The retrosynthesis of the chiral ster-\neodened compound indinavir, 7, completed in one step,\nthrough nding a very complex precursor in the set of available\nmolecules. Sequences of lower condence resulted in more\nretrosynthetic steps, disconnecting the molecule as in the re-\nported synthesis\n64 but stopped at the stereodened epoxide,\nwith no further disconnection paths available. However, when\nthe retrosynthesis was performed on the same racemic mole-\ncule, a chemoselective retrosynthetic pathway was found, dis-\nconnecting the epoxide and starting from simple precursors.\nSimilarly, for the other optically active compound, propranolol,\n8, which was disconnected according to the published synthetic\npathway\n65 only when the retrosynthesis was performed on the\nracemic compound. The problem experienced with stereo-\ndened molecules reects the poor likelihood distribution of\nthe resolution superclass in Fig. 7. Because all current USPTO\nderived data sets (stereo and pistachio) have particularly noisy\nstereochemical data we decided to retain only few entries in\norder to avoid jeopardizing the overall quality. With a limited\nnumber of stereochemical examples available in the training\nset, the model was not able to learn reactions belonging to the\nresolution class, failing to provide disconnection options for\nstereodened centers.\nThe retrosynthesis of the last molecule,9, succeeded only\nwith intensive hypergraph exploration settings. However, the\nretrosynthetic sequence is tediously long, with several avoidable\nesterication–saponication steps. Similar to5, the bias in the\nlikelihood distributions is the one reason for this peculiar\nbehavior. In addition, a non-symmetric allyl bromide was\nchosen as precursor of the corresponding tertiary amine: this\nchoice entails a regioselectivity problem, given that the allyl\nbromide can undergo nucleophilic displacement not only at the\nipso position, giving rise to the correct product, but also at the\nallylic position, resulting in the formation of the regioisomeric\namine. Lastly, the model was unable tond a retrosynthetic\npath for one complex building block, which was not found in\nthe available molecule set. However, a slight modication of the\nstructure of this intermediate enabled a correct retrosynthetic\npath to be found, which could also be easily applied to the\noriginal problem, starting from 1,3-cyclohexanedione instead of\ncyclohexanone. Although the targets in examples1, 5 and 8 are\nfound in the training set of the single-step retrosynthesis\nmodel, the multistep synthesis prediction system selected\nalternative reactions, which are not present in the training data.\nFor the nine compounds, the predicted retrosynthetic paths\nshow for every step the reactants and almost always also reac-\ntion solvents. All the proposed reagents match the ones usually\nreported for similar transformations. We also made a compar-\nison of our retrosynthetic architecture with previous work,\n6,12\nusing the same compounds for the assessments (see ESI†). The\nmodel performed well on the majority of these compounds,\nshowing problems in the case of stereodened compounds as in\nthe previous examples. Retrosynthetic paths were easily ob-\ntained only for their racemic structure. The proposed retro-\nsyntheses in some cases are similar to those reported\n6 while, for\nsome compounds12 they are diﬀerent but still chemoselective.\nOnly in a few cases, the model failed tond a retrosynthesis.\n4 Conclusion\nIn this work, we presented an extension of our Molecular\nTransformer architecture combined with a hyper-graph explo-\nration strategy to design retrosynthesis without human inter-\nvention. We introduce a single-step retrosynthetic model\npredicting reactants as well as reagents for therst time. We\nalso introduce four new metrics (coverage, class diversity,\nround-trip accuracy and Jensen –Shannon divergence) to\nprovide a thorough evaluation of the single-step retrosynthetic\nmodel. The optimal synthetic pathway is found through a beam\nsearch on the hyper-graph of the possible disconnection strat-\negies and allows to circumvent potential selectivity traps. The\nhypergraph is constructed on they, and the nodes areltered,\nand further expanded based on a Bayesian-like probability score\nuntil commercially available building blocks are identied. We\nassessed the entire framework by reviewing several retro-\nsynthetic problems to highlight strengths and weaknesses. As\nconrmed by the statistical analysis, the entire framework\nperforms very well for a broad class of disconnections. An\nintrinsic bias towards a few classes (reduction/oxidation/\nesterication/saponication) may lead, in some cases, to illog-\nical disconnection strategies that are a peculiarngerprint of\nthe current learning process. Also, an insuﬃcient ability to\nhandle stereochemical reactions is the result of the poor quality\ntraining data set that covers only a few examples in the reso-\nlution class. The use of the four new metrics, combined with the\ncritical analysis of the current model, provides a well dened\nstrategy to optimize the retrosynthetic framework by focusing\nThis journal is © The Royal Society of Chemistry 2020 Chem. Sci.,2 0 2 0 ,11,3 3 1 6–3325 | 3323\nEdge Article Chemical Science\nOpen Access Article. Published on 03 March 2020. Downloaded on 11/5/2025 2:05:34 PM. \n This article is licensed under a \nCreative Commons Attribution-NonCommercial 3.0 Unported Licence.\nView Article Online\nexclusively on the performance of the single-step retrosynthetic\nmodel without the need to manually review the quality of entire\nretrosynthetic routes. A key role in this strategy will be the\nconstruction of statistically relevant training data sets to\nimprove the condence of the model in di ﬀerent types of\nreaction classes and disconnections.\nConﬂicts of interest\nThere are no conicts to declare.\nReferences\n1 A. Suzuki,J. Organomet. Chem., 1999,576, 147–168.\n2 Y. Ai, N. Ye, Q. Wang, K. Yahata and Y. Kishi,Angew. Chem.,\n2017, 129, 10931–10935.\n3 X. Liu, X. Li, Y. Chen, Y. Hu and Y. Kishi,J. Am. Chem. Soc.,\n2012, 134, 6136–6139.\n4 E. J. Corey,Angew. Chem., Int. Ed. Engl., 1991,30, 455–465.\n5 S. Szymku´c, E. P. Gajewska, T. Klucznik, K. Molga,\nP. Dittwald, M. Startek, M. Bajczyk and B. A. Grzybowski,\nAngew. Chem., Int. Ed., 2016,55, 5904–5937.\n6 C. W. Coley, L. Rogers, W. H. Green and K. F. Jensen,ACS\nCent. Sci., 2017,3, 1237–1245.\n7 J. S. Schreck, C. W. Coley and K. J. M. Bishop,ACS Cent. Sci.,\n2019, 5, 970–981.\n8 I. A. Watson, J. Wang and C. A. Nicolaou,J. Cheminf., 2019,\n11,1 .\n9 C. W. Coley, W. H. Green and K. F. Jensen,Acc. Chem. Res.,\n2018, 51, 1281–1289.\n10 R. Fagerberg, C. Flamm, R. Kianian, D. Merkle and\nP. F. Stadler,J. Cheminf., 2018,10, 19.\n11 D. Lowe,Nature, 2018,555, 592–593.\n12 M. H. S. Segler, M. Preuss and M. P. Waller,Nature, 2018,\n555, 604–610.\n13 F. Feng, L. Lai and J. Pei,Front. Chem., 2018,6, 199.\n14 J. Savage, A. Kishimoto, B. Buesser, E. Diaz-Aviles and\nC. Alzate, Chemical Reactant Recommendation Using\na Network of Organic Chemistry, ACM, New York, USA, 2017.\n15 M. H. S. Segler and M. P. Waller,Chemistry, 2017,23, 5966–\n5971.\n16 B. Liu, B. Ramsundar, P. Kawthekar, J. Shi, J. Gomes, Q. Luu\nNguyen, S. Ho, J. Sloane, P. Wender and V. Pande,ACS Cent.\nSci., 2017,3, 1103–1113.\n17 A. Masoumi, M. Soutchanski and A. Marrella, th\nInternational Workshop on Semantic Web Applications and\nTools for Life Sciences SWATLS, 2013.\n18 J. Law, Z. Zsoldos, A. Simon, D. Reid, Y. Liu, S. Y. Khew,\nA. P. Johnson, S. Major, R. A. Wade and H. Y. Ando, J.\nChem. Inf. Model., 2009,49, 593–602.\n19 M. H. Todd,Chem. Soc. Rev., 2005,34(3), 247–266.\n20 C. W. Coley, D. A. Thomas, J. A. Lummiss, J. N. Jaworski,\nC. P. Breen, V. Schultz, T. Hart, J. S. Fishman, L. Rogers,\nH. Gao,et al., Science, 2019,365, eaax1566.\n21 P. Schwaller, T. Gaudin, D. L˜Aa˛nyi, C. Bekas and T. Laino,\nChem. Sci., 2018,9, 6091–6098.\n22 P. Schwaller, T. Laino, T. Gaudin, P. Bolgar, C. A. Hunter,\nC. Bekas and A. A. Lee,ACS Cent. Sci., 2019,5(9), 1572–1583.\n23 M. A. Kayala and P. Baldi,J. Chem. Inf. Model., 2012, 52,\n2526–2540.\n24 M. H. S. Segler and M. P. Waller,Chemistry, 2017,23, 6118–\n6128.\n25 C. W. Coley, R. Barzilay, T. S. Jaakkola, W. H. Green and\nK. F. Jensen,ACS Cent. Sci., 2017,3, 434–443.\n26 C. Coley, W. Jin, L. Rogers, T. F. Jamison, T. S. Jaakkola,\nW. H. Green, R. Barzilay and K. F. Jensen,Chem. Sci., 2019,\n10, 370–377.\n27 H. Gao, T. J. Struble, C. W. Coley, Y. Wang, W. H. Green and\nK. F. Jensen,ACS Cent. Sci., 2018,4, 1465–1476.\n28 D. M. Lowe, Ph.D. thesis, University of Cambridge, 2012.\n29 D. Lowe, Chemical reactions from US patents (1976-\nSep2016), 2017, https:// gshare.com/articles/\nChemical_reactions_from_US_patents.\n30 B. A. Grzybowski, K. J. M. Bishop, B. Kowalczyk and\nC. E. Wilmer,Nat. Chem., 2009,1,3 1–36.\n31 T. Klucznik, B. Mikulak-Klucznik, M. P. McCormack,\nH. Lima, S. Szymku¨A˘G, M. Bhowmick, K. Molga, Y. Zhou,\nL. Rickershauser, E. P. Gajewska, A. Toutchkine,\nP. Dittwald, M. P. Startek, G. J. Kirkovits, R. Roszak,\nA. Adamski, B. Sieredzi˚AˇDska, M. Mrksich, S. L. Trice and\nB. A. Grzybowski,Chem, 2018,4, 522–532.\n32 S. Zheng, J. Rao, Z. Zhang, J. Xu and Y. Yang, arXiv preprint\narXiv:1907.01356, 2019.\n33 P. Karpov, G. Godin and I. V. Tetko,International Conference\non Articial Neural Networks, 2019, pp. 817–830.\n34 X. Liu, P. Li and S. Song,bioRxiv, 2019, 677849.\n35 K. Lin, Y. Xu, J. Pei and L. Lai, arXiv preprint\narXiv:1906.02308, 2019.\n36 A. A. Lee, Q. Yang, V. Sresht, P. Bolgar, X. Hou, J. L. Klug-\nMcLeod and C. R. Butler, Chem. Commun. , 2019, 55,\n12152–12155.\n37 H. Duan, L. Wang, C. Zhang and J. Li, arXiv preprint\narXiv:1908.00727, 2019.\n38 A. Thakkar, T. Kogej, J.-L. Reymond, O. Engkvist and\nE. Bjerrum,Chem. Sci., 2020,11, 154–168.\n39 A. F. de Almeida, R. Moreira and T. Rodrigues,Nat. Rev.\nChem., 2019,1,1 –16.\n40 A. Cadeddu, E. K. Wylie, J. Jurczak, M. Wampler-Doty and\nB. A. Grzybowski, Angew. Chem., Int. Ed., 2014, 53, 8108–\n8112.\n41 D. Weininger,J. Chem. Inf. Comput. Sci., 1988,28,3 1–36.\n42 Molecular Transformer , https://github.com/pschwllr/\nMolecularTransformer, accessed Jul 29, 2019.\n43 IBM RXN for Chemistry, https://rxn.res.ibm.com, accessed\nOct 10, 2019.\n44 N. Schneider, D. M. Lowe, R. A. Sayle, M. A. Tarselli and\nG. A. Landrum,J. Med. Chem., 2016,\n59, 4385–4402.\n45 Anonymous, Submitted to International Conference on\nLearning Representations, 2020.\n46 B. Chen, T. Shen, T. S. Jaakkola and R. Barzilay, arXiv\npreprint arXiv:1910.09688, 2019.\n47 R.-R. Griﬃths, P. Schwaller,et al., chemrxiv preprint, DOI:\n10.26434/chemrxiv.7366973.v1, 2018.\n3324 | Chem. Sci.,2 0 2 0 ,11,3 3 1 6–3325 This journal is © The Royal Society of Chemistry 2020\nChemical Science Edge Article\nOpen Access Article. Published on 03 March 2020. Downloaded on 11/5/2025 2:05:34 PM. \n This article is licensed under a \nCreative Commons Attribution-NonCommercial 3.0 Unported Licence.\nView Article Online\n48 C. W. Coley, L. Rogers, W. H. Green and K. F. Jensen,J. Chem.\nInf. Model., 2018,58, 252–261.\n49 H. Satoh and K. Funatsu,J. Chem. Inf. Comput. Sci., 1995,35,\n34–44.\n50 P. Schwaller, A. Vaucher, V. H. Nair and T. Laino, chemrxiv\npreprint, DOI: 10.26434/chemrxiv.9897365.v1, 2019.\n51 T. Salimans, I. Goodfellow, W. Zaremba, V. Cheung,\nA. Radford and X. Chen, Advances in neural information\nprocessing systems, 2016, pp. 2234–2242.\n52 Retrosynthesis metrics example , https://gist.github.com/\npschwllr/795e5384817c8b79089902bf4d0920, accessed\nFeb 03, 2020.\n53 G. Landrum, P. Tosco, B. Kelley, S. Riniker, P. Gedeck,\nN. Schneider, R. Vianello, A. Dalke, R. R. Schmidt, B. Cole,\nA. Savelyev, S. Turk, M. Swain, A. Vaucher,\nD. Nealschneider, M. W˜As¸jcikowski, A. Pahl, J.-P. Ebejer,\nF. Berenger, A. Stretton, J. L. Varjo, N. O'Boyle,\nD. Cosgrove, P. Fuller, J. H. Jensen, G. Sforna, D. Gavid,\nK. Leswing, S. Leung and J. van Santen, rdkit/rdkit:\n2019_03_4 (Q1 2019) Release , 2019, DOI: 10.5281/\nzenodo.3366468.\n54 J. Nieminen and M. Peltola,Appl. Math. Lett., 1999, 12,3 5–\n38.\n55 eMolecules, https://www.emolecules.com, accessed Oct 29,\n2019.\n56 Nextmove So ware Pistachio , http://\nwww.nextmovesoware.com/pistachio.html, accessed Jul\n29, 2019.\n57 J. Lin,IEEE Trans. Inf. Theor., 1991,37, 145–151.\n58 S. R. Heller, A. McNaught, I. Pletnev, S. Stein and\nD. Tchekhovskoi,J. Cheminf., 2015,7, 23.\n59 E. L. Willighagen, J. W. Mayeld, J. Alvarsson, A. Berg,\nL. Carlsson, N. Jeliazkova, S. Kuhn, T. Pluskal, M. Rojas-\nChert´o, O. Spjuth,et al., J. Cheminf., 2017,9, 33.\n60 Nextmove So ware NameRXN , http://\nwww.nextmovesoware.com/namerxn.html, accessed Jul\n29, 2019.\n61 D. Lednicer and L. A. Mitscher,The organic chemistry of drug\nsynthesis, Wiley, New York, 1980, vol. 2.\n62 P. A. Worthington, in Synthesis and Fungicidal Activity of\nTriazole Tertiary Alcohols, 1987, ch. 27, pp. 302–317.\n63 H. Cotton, T. Elebring, M. Larsson, L. Li, H. S˜A}urensen and\nS. von Unge,Tetrahedron: Asymmetry, 2000,11, 3819–3825.\n64 J. F. Larrow, E. Roberts, T. R. Verhoeven, K. M. Ryan,\nC. H. Sennayake, P. J. Reider and E. N. Jacobsen, Org.\nSynth., 1999,76, 46.\n65 A. F. Crowther and L. H. Smith,J. Med. Chem., 1968, 11,\n1009–1013.\nThis journal is © The Royal Society of Chemistry 2020 Chem. Sci.,2 0 2 0 ,11,3 3 1 6–3325 | 3325\nEdge Article Chemical Science\nOpen Access Article. Published on 03 March 2020. Downloaded on 11/5/2025 2:05:34 PM. \n This article is licensed under a \nCreative Commons Attribution-NonCommercial 3.0 Unported Licence.\nView Article Online",
  "topic": "Retrosynthetic analysis",
  "concepts": [
    {
      "name": "Retrosynthetic analysis",
      "score": 0.9699978232383728
    },
    {
      "name": "Transformer",
      "score": 0.6548617482185364
    },
    {
      "name": "Computer science",
      "score": 0.5702420473098755
    },
    {
      "name": "Artificial intelligence",
      "score": 0.5011932849884033
    },
    {
      "name": "Graph",
      "score": 0.47935420274734497
    },
    {
      "name": "Machine learning",
      "score": 0.44751593470573425
    },
    {
      "name": "Data mining",
      "score": 0.33806583285331726
    },
    {
      "name": "Engineering",
      "score": 0.31181907653808594
    },
    {
      "name": "Theoretical computer science",
      "score": 0.18384963274002075
    },
    {
      "name": "Total synthesis",
      "score": 0.0
    },
    {
      "name": "Organic chemistry",
      "score": 0.0
    },
    {
      "name": "Chemistry",
      "score": 0.0
    },
    {
      "name": "Voltage",
      "score": 0.0
    },
    {
      "name": "Electrical engineering",
      "score": 0.0
    }
  ]
}