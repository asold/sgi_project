{
  "title": "Digital FIR Hilbert Transformers: Fundamentals and Efficient Design Methods",
  "url": "https://openalex.org/W1513270018",
  "year": 2012,
  "authors": [
    {
      "id": "https://openalex.org/A2104570616",
      "name": "David Ernesto Troncoso Romero",
      "affiliations": []
    },
    {
      "id": "https://openalex.org/A2132472242",
      "name": "Gordana Jovanovic",
      "affiliations": []
    }
  ],
  "references": [
    "https://openalex.org/W1973540738",
    "https://openalex.org/W2140183719",
    "https://openalex.org/W1971481430",
    "https://openalex.org/W2145823736",
    "https://openalex.org/W4242613073",
    "https://openalex.org/W2544768568",
    "https://openalex.org/W2124136306",
    "https://openalex.org/W1758321711",
    "https://openalex.org/W65620328",
    "https://openalex.org/W2585841545",
    "https://openalex.org/W4211018159",
    "https://openalex.org/W2104647070",
    "https://openalex.org/W1981288746",
    "https://openalex.org/W2154853326",
    "https://openalex.org/W2093647437",
    "https://openalex.org/W2883271082",
    "https://openalex.org/W2183153529",
    "https://openalex.org/W1967479796",
    "https://openalex.org/W2911858876",
    "https://openalex.org/W2116256191",
    "https://openalex.org/W1766888123",
    "https://openalex.org/W3140964447",
    "https://openalex.org/W1976959981",
    "https://openalex.org/W2159610140",
    "https://openalex.org/W2026122614",
    "https://openalex.org/W2160069070",
    "https://openalex.org/W1964951627",
    "https://openalex.org/W4229897592",
    "https://openalex.org/W2111958120",
    "https://openalex.org/W2085092712",
    "https://openalex.org/W1597236814",
    "https://openalex.org/W1972125873",
    "https://openalex.org/W2124712531"
  ],
  "abstract": "© 2012 Troncoso Romero and Jovanovic Dolecek, licensee InTech. This is an open access chapter distributed under the terms of the Creative Commons Attribution License (http://creativecommons.org/licenses/by/3.0), which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited. Digital FIR Hilbert Transformers: Fundamentals and Efficient Design Methods",
  "full_text": "Chapter 19 \n \n \n \n \n© 2012 Troncoso Romero and Jovanovic Dolecek, licensee InTech. This is an open access chapter distributed \nunder the terms of the Creative Commons Attribution License (http://creativecommons.org/licenses/by/3.0), \nwhich permits unrestricted use, distribution, and reproduction in any medium, provided the original work is \nproperly cited. \nDigital FIR Hilbert Transformers:  \nFundamentals and Efficient Design Methods \nDavid Ernesto Troncoso Romero and Gordana Jovanovic Dolecek \nAdditional information is available at the end of the chapter \nhttp://dx.doi.org/10.5772/46451 \n1. Introduction \nDigital Hilbert transformers are a special class of digital filter whose characteristic is to \nintroduce a π/2 radians phase shift of the input sign al. In the ideal Hilbert transformer all \nthe positive frequency components are shifted by – π/2 radians and all the negative \nfrequency components are shifted by π/2 radians. However, these ideal systems cannot be \nrealized since the impulse response is non-caus al. Nevertheless, Hilbert transformers can be \ndesigned either as Finite Impulse Response (FIR) or as Infinite Impulse Response (IIR) \ndigital filters [1], [2], and they are used in a wide number of Digital Signal Processing (DSP) \napplications, such as digital communication systems, radar systems, medical imaging and \nmechanical vibration analysis, among others [3]-[5]. \nIIR Hilbert transformers perform a phase a pproximation. This means that the phase \nresponse of the system is approximated to  the desired values in a given range of \nfrequencies. The magnitude response allows passing all the frequencies, with the magnitude \nobtained around the desired value within a give n tolerance [6], [7]. On the other hand, FIR \nHilbert transformers perform a magnitude a pproximation. In this case the system \nmagnitude response is approximated to the desi red values in a given range of frequencies. \nThe advantage is that their phase response is always maintained in the desired value over \nthe complete range of frequencies [8].  \nWhereas IIR Hilbert transformers can presen t instability and they are sensitive to the \nrounding in their coefficients, FIR filters ca n have exact linear phase and their stability is \nguaranteed. Moreover, FIR filters are less sensit ive to the coefficients rounding and their \nphase response is not affected by this rounding. Because of this, FIR Hilbert transformers are \noften preferred [8]-[15]. Nevertheless, the main drawback of FIR filters is a higher \ncomplexity compared with the corresponding IIR filters. Multipliers, the most costly \n \nMATLAB – A Fundamental Tool for Scientific Computing and Engineering Applications – Volume 1 446 \nelements in DSP implementation s, are required in an amount linearly related with the \nlength of the filter. A linear phase FIR Hilbert transformer, which has an anti-symmetrical \nimpulse response, can be designed with either an odd length (Type III symmetry) or an even \nlength (Type IV symmetry). The number of multipliers m is given in terms of the filter \nlength L as mC L , where C = 0.25 for a filter with Type III symmetry or C = 0.5 for a filter \nwith Type IV symmetry.  \nThe design of optimum equiripple FIR Hilbert transformers is usually performed by Parks-\nMcClellan algorithm. Using the MATLAB Signal Processing Toolbox, this becomes a \nstraightforward procedure through the function firpm. However, for small transition \nbandwidth and small ripples the resulting filter requires a very high length. This complexity \nincreases with more stringent specifications, i.e., narrower transition  bandwidths and also \nsmaller pass-band ripples. Therefore, different te chniques have been developed in the last 2 \ndecades for efficient design of Hilbert transformers, where the highly stringent \nspecifications are met with an as low as  possible required complexity. The most \nrepresentative methods are [9]-[15], which are based in very efficient schemes to reduce \ncomplexity in FIR filters. \nMethods [9] and [10] are based on the Fr equency Response Masking (FRM) technique \nproposed in [16]. In [9], the design is based on reducing the complexity of a half-band filter. \nThen, the Hilbert transformer is derived from this half-band filter. In [10], a frequency \nresponse corrector subfilter is introduced, an d all subfilters are designed simultaneously \nunder the same framework. The method [11] is based on wide bandwidth and linear phase \nFIR filters with Piecewise Polynomial-Sinusoidal (PPS) impulse response. These methods \noffer a very high reduction in the required number of multiplier coefficients compared to \nthe direct design based on Parks-McClellan algo rithm. An important characteristic is that \nthey are fully parallel approaches, which have  the disadvantage of being area consuming \nsince they do not directly take advantage of hardware multiplexing.  \nThe Frequency Transformation (FT) method, proposed first in [17] and extended in [18], was \nmodified to design FIR Hilbert transforme rs in [12] based on a tapped cascaded \ninterconnection of repeated simple basic building blocks constituted by two identical \nsubfilters. Taking advantage of the repetitive us e of identical subfilters, the recent proposal \n[13] gives a simple and efficient method to design multiplierless Hilbert transformers, where \na combination of the FT method with the Pipe lining-Interleaving (PI) technique of [19] \nallows getting a time-multiplexed  architecture which only requir es three subfilters. In [14], \nan optimized design was developed to minimize the overall number of filter coefficients in a \nmodified FT-PI-based structure derived from th e one of [13], where on ly two subfilters are \nneeded. Based on methods [13] and [14], a diffe rent architecture which just requires one \nsubfilter was developed in [15].  \nIn this chapter, fundamentals on digital FIR Hilbert transformers will be covered by \nreviewing the characteristics of analytic si gnals. The main connection existing between \n \nDigital FIR Hilbert Transformers: Fundamentals and Efficient Design Methods 447 \nHilbert transformers and half-b and filters will be highlighted but, at the same time, the \ncomplete introductory explanation will be kept as simple as possible. The methods to design \nlow-complexity FIR filters, namely FRM [16], FT [17] and PPS [11], as well as the PI \narchitecture [19], which are th e cornerstone of the efficient techniques to design Hilbert \ntransformers presented in [9]-[15], will be intr oduced in a simplified and concise way. With \nsuch background we will provide an extensive revision of the methods [9]-[15] to design \nlow-complexity efficient FIR Hilbert transfor mers, including MATLAB routines for these \nmethods.  \n2. Complex signals, analytic signals and Hilbert transformers \nA real signal is a one-dimensional va riation of real values over time. A complex signal is a \ntwo-dimensional signal whose value at some in stant in time can be specified by a single \ncomplex number. The variation of the two parts of the complex numbers, namely the real \npart and the imaginary part, is the reason for re ferring to it as two-dimensional signal [20]. \nA real signal can be represented in a two-di mensional plot by pres enting its variations \nagainst time. Similarly, a complex signal can be represented in a three-dimensional plot by \nconsidering time as a third dimension.  \nReal signals always have positive and negative frequency spectral components, and these \ncomponents are generally real and imaginary. For any real signal, the positive and \nnegative parts of its real spectral component always have even symmetry around the \nzero-frequency point, i.e., they are mirror images of each other. Conversely, the positive \nand negative parts of its imaginary spectral component are always anti-symmetric, i.e., \nthey are always negati ves of each other [1]. This conjugate symmetry is the invariant \nnature of real signals.  \nComplex signals, on the other hand, are not re stricted to these spectral conjugate symmetry \nconditions. The special case of complex signals which do not have a negative part neither in \ntheir real nor in their imaginary spectral components are known as analytic signalsor also as \nquadrature signals [2]. An example of analyt ic signal is the complex exponential signal xc(t), \npresented in Figure 1, and described by \n    0\n00() () () c o s ( ) s i n ( ) .jt\ncr ix te x tj x t tj t  (1)  \nThe real part and the imaginary part of the analytic signal are related trough the Hilbert \ntransform . In simple words, given an analytic si gnal, its imaginary part is the Hilbert \ntransform of its real part. Figure 1 shows the complex signal xc(t), its real part xr(t) and its \nimaginary part, xi(t). Figure 2 presents the frequenc y spectral components of these \nsignals. It can be seen  that the real part xr(t) and the imaginary part xi(t), both real \nsignals, preserve the spectral conjugate symmetry. The complex signal xc(t) does not \nhave negative parts neither in its real spectral component nor in its imaginary spectral \ncomponent. For this reason, analytic signal s are also referred as one-side spectrum \n \nMATLAB – A Fundamental Tool for Scientific Computing and Engineering Applications – Volume 1 448 \nsignals. Finally, Figure 3 shows the Hilbert transform relation between the real and \nimaginary parts of xc(t).   \n \n \nFigure 1. The Hilbert transform and the analytic signal of xr(t) = cos(ω0t), ω0= 2π. \n \n \nFigure 2. From left to right, frequency spectrum of xr(t), xi(t) and xc(t). \n \n \nFigure 3. Hilbert transform relations between xr(t) and xi(t) to generate xc(t). \n-2\n-1\n0\n1\n2\n0\n2\n4\n6\n-2\n-1\n0\n1\n2\nrealtime\nimaginary\nxr(t)\nxc(t)\nxi(t)  ( Hilbert transform of xr(t) )\n ()ix t\n()cx t\n()rx t()rx t Analytic \n signal \n   Hilbert \n0\nFreq\n0\n0\n0.5\n0.5\n()iX \nReal\nImaginary\n0\nFreq\n0\n1\n()cX \nReal\nImaginary\n0\nFreq\n0\n0\n0.5\n()rX \nReal\nImaginary\n \nDigital FIR Hilbert Transformers: Fundamentals and Efficient Design Methods 449 \nThe motivation for creating analytic signals, or  in other words, for eliminating the negative \nparts of the real and imaginary spectral components of real si gnals, is that these negative \nparts have in essence the same information th an the positive parts due to the conjugate \nsymmetry previously mentioned. The eliminat ion of these negative parts reduces the \nrequired bandwidth for the processing. For the case of DSP applications, it is possible to \nform a complex sequence xc(n) given as follows,  \n () () () ,cr ixn xn j xn  (2)  \nwith the special property th at its frequency spectrum Xc(ejω) is equal to that of a given real \nsequence x(n) for the positive Nyquist interval and zero for the negative Nyquist interval, \ni.e.,  \n \n   \n\n  \n\n()   f o r   0 ,()\n    0         for 0.\nj\nj\nc\nXeXe  (3) \nAlthough analyticity has no formal meaning for sequences [2], the same terminology, i.e., \nanalytic sequence, will be applied for complex sequences whose frequency spectrum is one-\nsided, like in (3). \nIf Xr(ejω) and Xi(ejω) respectively denote the frequency spectrums of xr(n) and xi(n), then \n  () () () .jj j\ncr iXe Xe j Xe  (4) \nThe spectrums of xr(n) and xi(n) can be readily deduced as \n \n  *1\n2( ) [ ( ) ( )],jj j\nrc cXe Xe Xe  (5) \n \n  *1\n2() [ () ( ) ] ,jj j\nic cjX e X e X e  (6) \nwhere Xc*(ejω) is the complex conjugate of Xc(ejω). Note that (6) gives an expression for jXi(ejω), \nwhich is the frequency spectr um of the imaginary signal jxi(n). Also, note that Xr(ejω) and \nXi(ejω) are both complex-valued functions in general. However, Xr(ejω) is conjugate \nsymmetric, i.e., Xr(ejω) = Xr*(e–jω). Similarly, jXi(ejω) is conjugate anti-symmetric, i.e., jXi(ejω) =   \n–jXi*(e–jω). These relations are illustrated in Figure 4. \nFrom (5) and (6) we obtain  \n  *() 2 () ( ) ,jj j\ncr cXe Xe Xe  (7) \n   *() 2() ( ) ,jj j\nci cXe j Xe Xe  (8) \nand since Xc*(e–jω) = 0 for 0 <ω<π (see Figure 4b), eqs. (3), (7) and (8) give \n \nMATLAB – A Fundamental Tool for Scientific Computing and Engineering Applications – Volume 1 450 \n \n \nFigure 4. Decomposition of an unilateral spectrum. Solid and dashed lines are, respectively, the real \nand imaginary parts. \nFreq \n\n2\n2\n3\n3\n\n* () j\ncXe \nReal\nImaginary\n\n2\n2\n3\n3\n\n() j\nrX e \nFreq\nReal\nImaginary\n(d) \n(c) \n(b) \n\n\n2\n2\n3\n() j\ncX e \nFreq\nRealImaginary\n3\n2\n3\n\n\n2\n3\n() j\niXe \nFreq\nImaginary\nReal\n(a) \n \nDigital FIR Hilbert Transformers: Fundamentals and Efficient Design Methods 451 \n    \n\n  \n\n2( )   f o r   0 ,()\n    0         for 0.\nj\nj r\nc\nXeXe      (9) \n    \n\n  \n\n2()   f o r   0 ,()\n    0         for 0.\nj\nj i\nc\njX eXe  (10) \nThus  \n    () ()    f o r  0 .j j\nirXe j Xe  (11) \nOn the other hand, from (4), and since Xc(ejω) = 0 for –πω< 0, we have \n   () ()     f o r  0 .j j\nirXe j Xe  (12) \nTherefore, (11) and (12) can be expressed as \n \n  \n \n\n\n\n \n\n()   f o r   0 ,()\n  ( )    for 0,\nj\nj r\ni j\nr\njX eXe\njX e\n (13) \nor \n  () () () ,j jj\nirXe H e Xe  (14) \nwhere \n     \n  \n\n for  0 ,()       for 0.\nj jHe j\n (15) \nAccording to (14), xi(n) can be obtained by processing xr(n) with a linear time-invariant \ndiscrete-time system wh ose frequency response H(ejω) is given in (15). This frequency \nresponse has unity magnitude, a phase angle of – π/2 radians for 0 < ω<π, and a phase angle \nof π/2 radians for – π<ω< 0. A system of this type is commonly referred to as Hilbert \ntransformer or sometimes as 90-degree phase shifter. \nThe impulse response h(n) of a Hilbert transformer is [2]  \n \n    \n \n\n\n22 sin   for  0,() 2\n   0                for 0.\nn nhn n\nn\n (16) \nThis impulse response is not absolutely summable and thus the frequency response of (15) is \nideal. However, approximations to the ideal Hilbert transformer can be obtained with IIR or \nFIR systems. Thus, Hilbert transformers are considered a special class of filter.  \nIIR Hilbert transformers have phase error as well as magnitude erro r in approximating the \nideal frequency response. Basically, these fil ters can be designed by using two all-pass \n \nMATLAB – A Fundamental Tool for Scientific Computing and Engineering Applications – Volume 1 452 \nsystems whose phase responses differ by approximately π/2 over some well-defined portion \nof the band 0 < | ω|<π. By taking the outputs of the tw o all-pass filters as the real and \nimaginary parts of a complex signal it can be found that the spectrum of such signal nearly \nvanishes over much of the negative frequency interval. As such, the outputs of the two all-\npass filters are quite nearly a Hilbert transformer. \nFIR Hilbert transformers with constant group delay can be easily designed. The π/2 phase \nshift is realized exactly, with an additional linear phase component required for a causal FIR \nsystem. By evaluating (16) over some positive and negative values of n, it can be seen that the \nimpulse response is anti-symmetric. Therefore, FIR Hilbert transformers are based on either \nType III (i.e., anti-symmetric impulse response with odd length L) or Type IV (i.e., anti-\nsymmetric impulse response with even length L) symmetry. Filters with Type III symmetry \nhave amplitude equal to zero in ω = 0 and ω = π a n d  f i l t e r s  w i t h  T y p e  I V  s y m m e t r y  h a v e  \namplitude equal to zero only in ω = 0. Thus, the FIR approximation is acceptable over a given \nrange of frequencies (a pass-band region) which does not include these extremes.  \nThe exactness of the phase of Type III and Type IV FIR systems is a compelling motivation \nfor their use in approximating Hilbert tran sformers. Additionally , whereas IIR Hilbert \ntransformers can present instability and they  are sensitive to rounding error in their \ncoefficients, FIR filters have guaranteed stab ility, are less sensitive to the coefficients \nrounding and their phase response is not affe cted by this rounding . Because of this, FIR \nHilbert transformers are often preferred [8]-[15]. The rest of this chapter will be focused on \nthe design of FIR Hilbert transformers. \n2.1. Basic design of FIR Hilbert transformers with MATLAB \nSince the phase requirement in FIR Hilbert transformers is accomplished, the design of a FIR \nHilbert transformer consists on  finding the impulse response h(n), for n = 0 to L–1, which \nsatisfies the following magnitude response specification, \n       (1 ) ( ) (1 )       for  ,j\nLHHe  (17) \nwhere δ is the allowed pass-band ripple, ωL is the lower pass-band edge and ωH is given as \nωH =π– ωL if the desired Hilbert transfor mer is a Type III filter or ωH =π if it is Type IV. The \nvalues ωL and ωH can be made to approach 0 and π, respectively, as closely as desired by \nincreasing the length L of the filter. For Hilber t transformers, the value ωL/2π is considered \nthe transition band.  \nThe design of optimum equiripple Type III and Type IV FIR linear phase Hilbert \ntransformers is usually performed by Parks-McClellan algorithm. With the MATLAB Signal \nProcessing Toolbox this becomes a straig htforward procedure through the function firpm. \nThe order of the filter, L–1, must be estimated in advanc e. A useful formula to estimate L, \npresented in [10], is \n \nDigital FIR Hilbert Transformers: Fundamentals and Efficient Design Methods 453 \n \n   \n \n\n\n   \n\n32\n10 10\n10 2\n( , ) 0.002655 log ( ) 0.031843 log ( ) ...\n                          0.554993log ( ) 0.049788 / ( ) 1. L\nLL\n (18) \nExample 1. The following code example illustrates the design of a Type III Hilbert \ntransformer with δ= 0.01, ωL= 0.1 π and ωH= π– ωL= 0.9 π using the MATLAB Signal \nProcessing Toolbox. From (18), L is estimated as L 24.3266. For convenience, we use L = \n4k+3 with k integer and the closest value for L, higher than the estimated value, is chosen. In \nthis case we use L = 4*6+3 = 27. \n \nd = 0.01; w_L = 0.1*pi; w_H = 0.9*pi; L = 27; \nh = firpm(L-1,[w_L/pi w_H/pi],[1 1],'hilbert'); \n[H w] = freqz(h,1); \nfigure; stem(0:length(h)-1, h,'fill') \nfigure; plot(w/pi, abs(H)) \nFigure 5a shows the impulse response and Figure 5b shows the magnitude response of the \nobtained Hilbert transformer.  \nAs we mentioned earlier, the most expensive elements in digital filters are multipliers. For a \nType III Hilbert transformer, the number of multipliers, m, is (L+1)/4 if L = 4k+3, or (L–1)/4 if L = \n4k+1, with k integer. In this last case the impulse response values h(0) and h(L–1) are zero. For a \nType IV Hilbert transformer, the number of multipliers is L/2. This number can be simplified as  \n   ,mC L  (19) \nwhere C = 0.25 for a Type III Hilbert transformer or C = 0.5 for a Type IV Hilbert \ntransformer. \n \nFigure 5. (a) Impulse response and (b) Magnitude response of a digital FIR Hilbert transformer. \n(a)\n(b)\n0 0.2 0.4 0.6 0.8 10\n0.2\n0.4\n0.6\n0.8\n1\n1.2\n/\n|H(ej)|\n0.2 0.4 0.6 0.8\n0.99\n1\n1.01\n0 5 10 15 20 25-0.8\n-0.6\n-0.4\n-0.2\n0\n0.2\n0.4\n0.6\n0.8\nn\nh(n)\n \nMATLAB – A Fundamental Tool for Scientific Computing and Engineering Applications – Volume 1 454 \nIt is worth highlighting the following point. A Type III Hilbert transformer can be derived \nfrom a Type IV Hilbert transformer by addi ng one zero-valued impulse response sample \nbetween each two impulse response samples of the Type IV Hilbert tr ansformer. This is \nequivalent to replacing each z–1 in the transfer functi on of this filter by z–2. The opposite \nprocedure can be straightforwardly followed to derive a Type IV Hilbert transformer from a \nType III Hilbert transformer. \nFrom (18), it can be seen that the length L increases inversely proportional with the \ntransition band ωL/2π. Hence, for cases with narrow transition band and small ripple the \nimplementation cost becomes very high. As a simple example, the estimated length for a \nHilbert transformer withδ= 0.001 and ωL= 0.001π is L 3661.2. It implies approximately 915.3 \nmultipliers, which is impractical. Therefore, the design of FIR Hilbert transformers with \nstrict specifications requires specialized techniques to reduce the number of multipliers and \nthe computational complexity of the filter. Before  of the revision of these techniques, in the \nnext section we will highlight the relation between Hilbert transformers and half-band \nfilters because this relation is crucial for de veloping the specialized techniques to design \nlow-complexity FIR Hilbert transformers.  \n3. The Hilbert transformer and its relation with the half-band filter \nHalf-band filters have their transfer function given by \n \n\n\n \n2\n0\n() () ,\nM\nn\nHb Hb\nn\nHz hn z  (20) \nwhere hHb(n) is the impulse response, M is an odd integer and 2 Misthe filter order [21]. The \ncoefficients are symmetric with respect to the central coefficient hHb(M), namely, they \naccomplish the following relation, \n  (2 ) ( )     for    0,1,...,2 .Hb HbhM n h n n M  (21) \nThe length of the filter, L, is an odd number given as L = 2M + 1 with M = 1, 3, 5… etc. In a \nlineal phase half-band filter, almost a half of the coefficients are zero. Figure 6 shows the \nprocedure to design a half-band filter. It starts  with the transfer func tion of a Type II lineal \nphase filter, i.e., a filter with symmetric impu lse response whose length is even. For this \nfilter we have, \n \n\n\n \n0\n() ()    f o r    ( ) () .\nM\nn\nn\nQz qnz qM n qn  (22) \nFirst, samples with value zero  are introduced between the q(n) impulse samples (see Figure \n6a and 6c). This generates a transfer functi on with Type I symmetry, whose order is 2 M, \ngiven by \n \nDigital FIR Hilbert Transformers: Fundamentals and Efficient Design Methods 455 \n \nFigure 6. Low-pass half-band filter design. (a) Impulse response of a Type II filter with order M, q(n). \n(b) Zero-phase frequency response of the Type II filter with order M, Q(ω). (c) Impulse response of a \nType I filter with order 2M, f(n). (d) Zero-phase frequency response of the Type I filter with order 2M, \nF(ω). (e) Impulse response of a half-band filter, hHb(n). (f) Zero-phase frequency response of the half-\nband filter, HHb(ω). \n \n \n\n \n2\n22\n00\n() () ( ) () .\nMM\nnn\nnn\nFz fnz Qz qnz  (23) \nThen, the zero-valued sample with index n = M is replaced by the value 1/2 (See Figure 6e). \nThus we obtain \n  \n\n  \n2\n0\n11() () () .22\nM\nM Mn\nHb\nn\nHz z F z z q n z  (24) \n(a) \nhHb(n) \n0 0\n2M\nnM\n½ \nf(n) \n0 \n0 \n2\nM\nn M\n½ \n(c) \n(b) \n½ + δ \n½ - δ \n-½ - δ \n-½  \n-½ + δ \n½  \nF(ω)=Q(2ω) \nω \nπ/2    π  π- ωpωp\n0  \nHHb(ω)=1/2 + F(ω) \nω \n1 + δ\n1 - δ\n  - δ\n 0 \n1 \n½  \n  + δ\nπ/2   π π- ωpωp\nω \n(d) \n(e) (f) \n½ + δ \n½ - δ \n-½ - δ \n-½  \n-½ + δ \n½  \nπ   2π 2π-2ωp 2ωp\n0  \nQ(ω)\nq(n) \n0 \n0 \nM\nn\n½ \n \nMATLAB – A Fundamental Tool for Scientific Computing and Engineering Applications – Volume 1 456 \nThe coefficients of the half-band filter are obtained from (20) and (24) as \n  \n1( ) ,   ( )   for    even,22Hb Hb\nnhM hnq n  (25) \n  ( ) 0, for    odd  and  ,Hbhn n n M  (26) \nand the zero-phase frequency response of HHb(z) is \n   11() ( 2) () .22HbHQ F  (27) \nBased on the previous relations, the design of a half-band low-pass filter with pass-band \nfrequency ωp and pass-band ripple δ can be carried out by designing the Q(z) filter, such that \nits zero-phase frequency response, Q(ω), oscillates within 1/2 ± δ over the range of \nfrequencies [0, 2 ωp] (See Figure 6b). Since Q(z) has a Type II transfer function, it presents a \nfixed zero in z = –1 (ω = π). Note from Figure 6b that Q(ω) oscillates within –1/2 ± δ over the \nrange of frequencies [2π – 2ωp, 2π]. The corresponding zero-phase frequency response of the \nfilter F(z), given as F(ω) = Q(2ω), remains within 1/2 ± δ over the range of frequencies [0, ωp] \nand within –1/2 ± δ over the range of frequencies [ π – ωp, π] (See Figure 6d). Finally, HHb(ω) \noscillates around 1 over th e range of frequencies [0, ωp] with tolerance δ and around 0 over \nthe range of frequencies [ π – ωp, π] with the same tolerance δ (See Figure 6f). Note that, as a \nlow-pass filter, the half-band filter has the relations ωs = π–ωp and δp = δs. \nExample 2. The following code example illustrates th e design of a half-band filter with \nδp=δs= 0.005, ωp= 0.4π and ωs= π– ωp= 0.5π using the MATLAB Filter Design Toolbox. Eq. (18) \ncan be applied to estimate the filter length L, by substituting ωL = (π/2) – ωp and δ= 2δp. The \nlength L is estimated as L 24.3266. Since L must be represented as L = 2M+1 with M odd to \navoid zero-valued impulse response samples in the left and right extremes of the impulse \nresponse, we use L =2*13 + 1 = 27. \n \ndp = 0.005;w_p = 0.4*pi;w_s = 0.5*pi; L = 27; \nh_half = firhalfband(L-1, w_p/pi); \n[H_half w] = freqz(h_half,1); \nfigure; stem(0:length(h_half)-1, h_half,'fill') \nfigure; plot(w/pi, abs(H_half)) \n3.1. Hilbert transformer derived from a half-band filter \nA Hilbert transformer filter can be designed fr om a half-band filter. First,the sample with \nvalue 1/2, located in the index n = M, is replaced by the value 0 (See Figures 7a and 7d). Thus \nwe obtain \n  1() () 2\nM\nHbHz H z z . (28) \n \nDigital FIR Hilbert Transformers: Fundamentals and Efficient Design Methods 457 \nThe subtraction of this coefficient, drawn in  Figure 7d, causes the zero-phase frequency \nresponse of the half-band filter to be shifte d downwardly, as illustrated in Figure 7c. The \nfilter  ()H must be shifted by π/2 on the horizontal direction in the frequency domain. This \nis accomplished by multiplyin g the remaining coefficients, ()hn , by ( j)–n. The effect of this \naction produces a Hilbert transformer with o dd length and a pass-band gain equal to 0.5. \nTherefore, a Hilbert transformer with unitar y gain will be obtained  by scaling all the \ncoefficients by 2. This is illustrated in Fi gure 8. The transfer fu nction of the Hilbert \ntransformer given in terms of the transfer function of a half-band filter is  \n  \n\n\n  \n2\n0\n1() 2 ( ) ( ) 2 () ( ) 2\nM\nM n\nHb Hb\nn\nnM\nHz H j z j z h n j z . (29) \nThe impulse response of the Hilb ert transformer is related with  the impulse response of the \nhalf-band filter through the following expression, \n \n\n  \n1\n0;        2 1,            \n()\n2( 1) ( );     2      with     0,1,2,..., .k\nHb\nnk\nhn\nhn n k k M  \n(30) \nIt was mentioned earlier that the useful bandwi dth in a Hilbert transfor mer is restricted to \nsome range given as 0 < ωL ≤ ω ≤ ωH < π, where ωH= π – ωL. The relation of the low-pass edge \nfrequency ωL with the band-edge frequencies of the half-band filter, ωp and ωs, is given by \n   (/ 2 )Lp ,  (31) \n  (/ 2 )Ls ,  (32) \nwhere ωs = π – ωp. \n \nFigure 7. (a) Ideal zero-phase frequency response of the half-band filter HHb(ω). (b) Impulse response of \nthe half-band filter hHb(n). (c) Ideal zero-phase frequency response resulting of the subtraction of the \ncentral coefficient, located at n = M,   1\n2() () HbHH . (d) Impulse response, ()hn . \n(a) (b) \n(c) (d)\n0\n1\nπ\nω\nHHb(ω) \n-π/2 π/2-π\n0\n0.5 \nπ \nω\nHHb(ω)-½\n-0.5 -π/2 π/2 -π \n½\nM \n2M\nn0 0\nhHb(n) \nM\n2M\nn0 0\n½\n()Hbhn\n \nMATLAB – A Fundamental Tool for Scientific Computing and Engineering Applications – Volume 1 458 \nHilbert transformers designed from half-band filters have odd length. In these cases, there is \na coefficient of value zero between each coeffi cient of its impulse response. Thus, a Hilbert \ntransformer with even length can be obtained by eliminating these zero-valued coefficients. \n \nFigure 8. Hilbert transformer design, (a) Ideal zero-phase frequency response of the Hilbert transformer \nobtained from HHb(ω). (b) Impulse response h(n). \nExample 3. The following code example illustrates a simple way to obtain the impulse \nresponse of a Hilbert transformer from the im pulse response of a half-band filter. If we \nconsider that the code of Example 2 has been  previously run, it can be assumed that h_half \nand L are already defined. The resulting Hilbert transformer coefficients in h are the same as \nthe ones obtained in Example 1, since th e half-band filter generated in Example 2 \naccomplish the relations ωL = ( π/2) – ωp and δ= 2 δpwith regard to the specifications in \nExample 1.   \n \nindex = [1:L]; \nmiddle_sample = [zeros(1,(L-1)/2) 1/2 zeros(1,(L-1)/2)]; \nm = (ones(1,L)*i).^(-(index-1)); \nh = 2*(h_half.*m - middle_sample.*m); \n4. Efficient methods to design FIR filters \nIt is known that the complexity of FIR digital filters increases in an inverse proportion with \nthe transition bandwidth. A simple example in Sub-section 2.1 was given for the case of a \nHilbert transformer with small ripple and bandwidth. Several efficient techniques have been \ndeveloped to efficiently design FIR filters with strict specifications, such that the resulting \nfilter accomplishes the desired specification wi th a lower complexity than the direct design \nobtained with the Parks-McClellan algorithm.  For Hilbert transformers, however, these \nmethods have been specially adapted, sinc e Hilbert transform f iltering has special \ncharacteristics as we saw in Section 2. Prior to  starting the review of the special methods to \ndesign FIR Hilbert transformers with low co mplexity, we will briefly introduce in this \nsection the general techniques which are the or igin of these methods.  These techniques are \nFrequency-Response Masking (FRM), Frequency Transformation (FT) and Piecewise \nPolynomial Sinusoidal (PPS).  \nM 2M \nn \n0 0\n½\nh(n) \n(a) (b) \n0\n1 \nπ \nω \nH(ω)  \n-1 \n-π/2 \nπ/2 \n-π \n \nDigital FIR Hilbert Transformers: Fundamentals and Efficient Design Methods 459 \n4.1. Frequency-Response Masking technique \nThe FRM technique, introduced in [ 16], uses the so-called expanded-by- M filters as basic \nbuilding blocks, where the transf er functions have the form G(zM). In general, a filter G(z) \nbecomes expanded-by-M by replacing every of its elements z–1 by z–M or, in other words, by \ninserting M–1 zero-valued impulse response samples between two of its original impulse \nresponse samples. The periodic frequency response of these filters has M periods in the \nfrequency range [0, 2π].  \nFigures 6a to 6d show how a filter F(z) = Q(z2) has a compressed-by-two frequency response \nin comparison with the original filter Q(z), whose impulse response is depicted in Figure 6a. \nThe zero-phase frequency response of Q(z), presented in Figure 6b, shows a period that \ncovers the frequency range [0, 2 π]. On the other hand, the filter F(z) has a very similar zero-\nphase frequency response, with the only diffe rence that its period covers the frequency \nrange [0, π]. The transition bandwidth of this expanded-by-2 filter F(z)  i s  a  h a l f  o f  t h e  \ntransition bandwidth of the filter Q(z). However, now this expanded filter has a replica of \nthe frequency response of Q(z) (which covers the range of frequency [2π, 4π]) over the range \n[π,2π]. The number of multipliers of F(z) is the same as the one of Q(z). This can be seen in \nFigure 6c, where several impulse response samples are zero-valued.  \nThe main idea of the FRM technique is using an expanded filter G(zM) and its complementary \nfilter, Gc(zM), to form the transition band of a desired filter H(z). Because of that, these filters \nare so-called band-edge shaping filters. The complementary filter is given as \n   (1 ) / 2() () , GL\ncGz z G z  (33) \nwhere LG is the length of the filter G(z). Since the frequency response of these filters is \nperiodical, two non-periodic masking filters, HMa(z) and HMc(z), are respectively cascaded \nwith G(zK) and Gc(zK) to eliminate the unwanted periodic replicas of frequency response. The \noverall filter formed with the FRM technique is given as \n   (1 ) / 2() ( ) () [ ( ) ] () GMLMM\nMa McHz Gz H z z Gz H z . (34) \nExtensive information about the basic FRM method can be found in [16] and [23]. \n4.2. Frequency Transformation technique \nThe FT technique, first studied in [22] and then generalized in [17], is based on the repetitive \nuse of an identical simple subfilter G(z). Let us consider G(ω) as the zero-phase frequency \nresponse of G(z) and an amplitude change function Q(x) given as \n \n\n \n0\n() ()\nM\nk\nk\nQx qkx .  (35) \nThe function Q(x) allows changing the values x = G(ω)to new values y = Q(x). Basically, the \nnew amplitude values y = Q(x) must approximate the desired values d = D(x) for xXp  Xs, \n \nMATLAB – A Fundamental Tool for Scientific Computing and Engineering Applications – Volume 1 460 \nwhere Xp is the range of values [ xp,l, xp,u] and Xs is the range of values [ xs,l, xs,u], such that the \nzero-phase frequency response of the overall filter H(z) achieves the desired values d with a \nmaximum absolute pass-band deviation δp over the pass-band region Ωp, as well as a \nmaximum absolute stop-band deviation δs over the stop-band region Ωs. This characteristic \nis reached if the following conditions are simultaneously met, \n ,,() () () , f o r ,p pp l p uDx Qx Dx x x x      (36) \n , ,() () () ,f o r ,ss s l s uDx Qx Dx x x x      (37) \n ,, () , f o r ,p lp u pxG x      (38) \n , ,() , f o rsl su sxG x      (39) \nUsually, D(x) = 1 for xXp and D(x) = 0 for xXs. Basically, two problems can be solved \nfrom this approach: \nProblem 1. Given M, the number of subfilters, find  the optimal coefficients of Q(x) and the \noptimal coefficients of G(z) to meet the conditions (36) to (39) with the minimum length LG \n(which must be odd). \nProblem 2. Given the subfilter G(z), find the optimal coefficients of Q(x) to meet the \nconditions (36) to (39) with the minimum value M. \nThe overall filter formed with the FT technique is given as \n  \n\n \n() ( 1 ) / 2\n0\n() () () G\nM kMkL\nk\nHz qkz Gz .  (40) \nDetailed information about the FT method can be found in [16] and [23].   \n4.3. Piecewise Polynomial Sinusoidal technique \nIn the PPS technique, introduced in [24] for wi de-band Type I filters, extended in [25] for \nHilbert transformers and detailed in [11] for bo th cases, the idea is to divide the impulse \nresponse of a wideband filter into sub-responses and to generate each sub-response with \npolynomials with a given degree. For wideband  linear-phase filters, the impulse response \nhas a narrow main lobe and the side lobes have very rapid change in sign. Therefore, it is \ntaken advantage of sinusoids in such a wa y that the polynomial pieces follow the \npolynomial-sinusoidal shapes to decrease th e number of polynomial pieces and, as a \nconsequence, to reduce the number of coefficients. \nThe overall transfer function H(z) for a desired Type I filter with length 2 N+1 is constructed \nwith M parallel branches connected and delayed with z–Nm in order to keep the center of \nsymmetry at the same location for all the sub-impulse responses. These sub-responses are \nmodulated with a sinusoidal function and finally an arbitrary number of separately \ngenerated filter coefficients is added as follows, \n \nDigital FIR Hilbert Transformers: Fundamentals and Efficient Design Methods 461 \n  \n\n\nˆ\n1\nˆ() () () m\nM N N\nm\nm\nHz z H z z Hz ,  (41) \nwhere,  \n \n\n    \n\n   \n() 1\n() ( 2 () )\n0\n() ( ) () [ ]\nm\nmm\nNN\nNN NN n n\nmm m m\nn\nHz hNNz hn z z .  (42) \nThe integers Nm in the delay terms z–Nm satisfy N1 = 0 and Nm+1>Nm for m = 1, 2, …, M – 1, and \nthe order of Hm(z) is 2(N – Nm). The impulse response is given as  \n \n\n   ()\n0\n() () s i n [ ( ( ) ) ]\nL\nLr\nmm c m\nr\nhn a r n n NN . (43) \nIn addition,  ˆ ˆ()NzH z is a conventional direct-form transf er function with non-zero impulse \nresponse coefficients ˆ()hn , with n = N–c+1, N–c+2, …, N–c+T, where c =   / 2T  and T is the \nnumber of additional coefficients at th e center of the filter. Given the values Nm for m = 1, 2, \n…, M – 1, M and L, the objective is finding the polynomi al coefficients such that the error \nwith respect to a desired amplitude characteristic is minimized. An extensive explanation on \nthis method can be reviewed in [11].    \n4.4. Pipelining-Interleaving architecture \nThe Pipelining-Interleaving (PI) technique develo ped in [19] provides efficient structures of \nFIR digital filters to avoid the repetitive use of  an identical filter. Suppose that we have two \nsequences of independent signals, x1(n) and x2(n), that are filtered by two identical filters \nH(z). Thus, two corresponding sequ ences of independent outputs, y1(n) and y2(n), are \nobtained. An alternative form for this purp ose is the multirate implementation using H(z2) \nas sh own  in  F i g u re 9. Th is st ru ctu re u ses a single filter to implement two identical filters. \nThe clock rate for this implementation must be twice the data rate [19]. If only one sequence \nof input signal is filtered, it is possible to connect the first output sequence y1(n) to the \nsecond input x2(n). In this way, H(z2) is used to implement H2(z). \n \nFigure 9. Filtering of two independent sequences using one filter.  \nThe PI structure of the Figure 9 can be extended to implement the filtering of K different \nsignals, each one filtered  by an identical filter H(z), with K being an arbitrary positive \ninteger. From this, it is possible to im plement the filtering of one signal with K identical \nfilters in cascade. Figure 10a presents the genera l structure to filter a signal using one filter \nH(zK). Figure 10b shows the equivalent structure, which consists of the filtering of a signal \nby a cascade of K identical filters H(z) [19]. \n1z\n1z\n2\n2\n22()Hz 1()yn\n2 ()yn\n1()xn\n2()xn 2\n \nMATLAB – A Fundamental Tool for Scientific Computing and Engineering Applications – Volume 1 462 \nIn the structure shown in Figure 10a, the clock rate of H(zK) must be K times the data rate. \nClearly, for high data rate applications, K must be chosen as a relatively small integer, \notherwise a very high clock rate will be required. More details on this time-multiplexed \narchitecture can be found in [19]. \n5. Efficient Methods to design FIR Hilbert transformers \nIt has been mentioned earlier that the design  of low-complexity FIR Hilbert transformers \nwith stringent specifications requires specia l efficient methods. In the following we will \nreview the most representative and useful methods, which are based on the techniques \nrevised in the previous section.  \n \nFigure 10. Filtering of a sequence with K identical cascaded filters, (a) PI architecture with only one \nfilter, (b) equivalent single-rate structure. \n5.1. Hilbert transformer design based on Frequency Response Masking \nThis method, proposed in [9], relies on the special case of FRM for the synthesis of a half-\nband filter HHb(z) [26]. Consider a half-band filter Ha(z) as a band-edge shaping filter whose \ntransfer function is given by \n 211\n2() () , K\naHz z A z    (44) \n \n2 1 21 2 1 21\n1\n() ( 2 1 2 1 ) ,\nK\nkK kK\nk\nAz a k K z z     \n\n        (45) \nwhere La= 4K – 1 is the length of Ha(z), with K being an integer greater than zero, and a(n) is \nthe impulse response of Ha(z). Replacing G(z) by Ha(z) in (34) we have \n \n(2 1)() ( ) () [ ( ) ] () .MM K M\nHb a Ma a McHzH zHz z H z Hz    (46) \n()a ()b\n1z 1z\n1z 1z\n1z1z\nK\nK\nK\nK\nK\nK\nK\nK () KHz\n()Ky n\n1()xn 1()y n\n1()Ky n\n2()y n\n2()xn\n3()xn\n()Kxn\n()Hz\n()Hz\n()Hz\n()Hz\n1z\n1z\n1z\n2()yn\n1()xn\n2()xn\n()Kyn\n1()y n\n3 ()xn\n()Kxn\n \nDigital FIR Hilbert Transformers: Fundamentals and Efficient Design Methods 463 \nWe can express the transfer function of the overall half-band filter as \n \n    \n(2 1) (2 1)11\n22() ( ) () ( ) ()MK M MK M\nHb Ma McHz z A z Hz z A z Hz .  (47) \nIf M is odd, then either [  (2 1)1\n2 ()M KMzA z ] or[  (2 1)1\n2 ()M KMzA z ] has a transition band \ncentered at π/2, just as desired for a half-band filter.  \nIf M is given by the form \n  4 1,   with  {0,1,2,...}Mk k , (48) \nthen the pass-band of HMa(z) is greater than the pass-band of HMc(z). With ωp and ωs denoting \nthe band-edge frequencies of HHb(z), these values can be express as [26] \n \n22 , ,ps\nmm\nMM\n       (49) \nwhere m is an integer less than M. The values m, θ and ϕ can be calculated as \n \n,2 , 22\np\nps\nM\nmM m M m\n\n  \n\n   \n\n  (50) \nwhere x represents the integer part of x, whereas θ and ϕ are the pass-band and stop-\nband edges of Ha(z). The pass-band and stop-band edge frequencies of the masking filter \nHMa(z), θMa and ϕMa, as well as the pass-band and stop-band edge frequencies of the masking \nfilter HMc(z), θMc and ϕMc, are given by \n \n22 ( 1 ) 2 2,, ,Ma p Ma Mc Mc s\nmm m m\nMMM M\n                (51) \nIf M is given by the form \n  4 3,   con {0,1,2,...}M kk .   (52) \nthen the passband of HMc(z) is greater than the pass-band of HMa(z). In this case the \nfrequencies ωp and ωs are given by \n 22 , ,ps\nmm\nMM\n      (53) \nTo calculate m, θ and ϕ we use the following relations, \n \n, 2, 2,2\ns\nsp\nMmm M m M \n   \n\n  (54) \n \nMATLAB – A Fundamental Tool for Scientific Computing and Engineering Applications – Volume 1 464 \nwhere x represents the rounding operation to  the closest integer greater than x. The \nvalues, θMa, ϕMa, θMc and ϕMc, are given by \n \n2( 1 ) 2 2 2 , ,, .Ma Ma s Mc p Mc\nmm m m\nMM M M\n                 (55)\n \nIf HMa(z) is a Type I filter with length LMa = 4k + 1, where k is an integer, we can write \n  \n\n  \n\n       \n(1 ) / 2\n(1 ) / 2 (1 ) / 2\n1\n() ( 1 ) / 2 ( 1 ) / 2\nMa\nMa Ma\nL\nkL kL\nMa Ma Ma Ma Ma\nk\nHz h L hk L z z . (56) \nNow we define the transfer functions B(z) and C(z) as  \n \n \n\n  \n  \n    \n    \n1( 1 ) / 2 1( 1 ) / 2\n3( 1 ) / 2 3( 1 ) / 2\n() 1 ( 1 ) / 2\n          3 ( 1) / 2 ...\nMa Ma\nMa Ma\nLL\nMa Ma\nLL\nMa Ma\nBz h L z z\nhL z z\n (57) \n \n \n\n\n  \n  \n \n   \n    \n2 ( 1)/ 2 2 ( 1)/ 2\n4 ( 1)/ 2 4 ( 1)/ 2\n() ( 1 ) / 2\n            2 ( 1) / 2\n           4 ( 1) / 2 ...\nMa Ma\nMa Ma\nMa Ma\nLL\nMa Ma\nLL\nMa Ma\nCz h L\nhL z z\nhL z z\n (58) \nwith hMa(n) as coefficients of the filter HMa(z). Replacing (57) and (58) in (56), we have \n  () () ()MaHzB z C z .   (59) \nIn the half-band filter design, the masking filters are related by \n   (1 ) / 2() ( ) MaL\nMcM aHzz H z .    (60) \nFrom (59) and (60), and noting that B(–z) = –B(z) and that C(–z) = C(z), we have \n   (1 ) / 2() () () MaL\nMcHzz B z C z .    (61) \nOnce known the transfer function of the mask ing filters from (59) and (61), the overall \ntransfer function of the half-band filter can be obtained by subs tituting (59) and (61) in (47). \nFinally, we obtain \n        [ (2 1) ( 1)/ 2] ( 1)/2 (2 1)1\n2() () ( ) [ 2 () ] Ma MaM KL L M KM\nHbHz z z B zA z C zz .  (62) \nThe half-band filter with desired deviation δ and pass-band edge frequency ωp can be \ndesigned with the FRM technique by applying the following steps: \n1. Get the optimal value of M, using the following approximation, \n  \n\n \n12\n2opt\nsp\nM .  (63) \n \nDigital FIR Hilbert Transformers: Fundamentals and Efficient Design Methods 465 \nNote that the obtained value must be rounded to an odd integer. \n2. Find if M can be expressed either as in (48) or (52). Then obtain the pass-band and stop-\nband edge frequencies of the band-edge shaping filter Ha(z), θ and ϕ, as well as the ones \nof the masking filter HMa(z), θMa and ϕMa, using (50) and (51) if M is expressed as in (48), \nor (54) and (55) if M is expressed as in (52).Design these filters with a ripple approx. \n15% less than the desired ripple. \n3. Obtain A(z) from Ha(z) using (44) and (45). Then obtain B(z) and C(z) from HMa(z) using \n(56), (57) and (58). \n4. Synthesize the overall structure of (62) in terms of A(zM), B(z) and C(z). \nA Hilbert transformer can be derived from a unity gain half-band filter by subtracting the \nconstant ½ from its transfer function and then modulating the remaining coefficients by    e–\njπn/2 (see section 3.1). The transfer function of the Hilbert transformer H(z) is given by [9] \n  \n (1 ) / 2(2 1)( ) 2 () ()2 () [ 2 ()() ] MaLMK MHz j z Bj z A j z Cj z j z . (64) \nIt is worth highlighting that the filter in (64) does not need complex-number arithmetic \nprocessing because of the following re asons. First, note that the filter A(jMzM) has only real \ncoefficients since the imag inary unit generated by ( jz)–n with n odd is eliminated by zero-\nvalued coefficients in these indexes n. Second, note that all the coefficients in [2 C(jz) – ( jz)–\n(LMa–1)/2] are real and all the coefficients in B(jz) are imaginary when LMa is expressed as 4 k+1, \nwith k integer. Third, the term ( jz)–M(2K–1) is always imaginary, since its exponent is always \nodd. From these reasons, we have that if B(jz) has imaginary coefficients, the term ( jz)–M(2K–1) \nmakes them real and the overall filter has real coefficients.  \nThe Hilbert transformer from (64) can be seen  as a parallel connection of two branches. In \nthe first branch we have Hb(z) = 2( jz)–M(2K–1)B(jz) and in the second branch we have the \ncascade of H1(zM) and HM(z), where H1(zM) = 2 A(jMzM) and HM(z) = [2 C(jz) – ( jz)–(LMa–1)/2]. This \nstructure is presented in Figure 11. Let us review a different point of view of the FRM \ntechnique, presented in [10].  \nThe filter Hb(z) can be seen as a low-order Hilbert transformer, the filter H1(zM) as a band-\nedge shaping filter and HM(z) as a masking filter. The basic filter Hb(z) provides a low order \napproximation (with wide transition bandwidth)  to the desired specification. The cascaded \nconnection of H1(zM) and HM(z) produces a correction term to the transfer function that \ndecreases the transition bandwidth. The transfer function for the overall filter is given by \n  1() ( ) () () M\nMbHz H z H z H z .   (65) \nLet the lengths of Hb(z), H1(z) and HM(z) be Lb, L1 and LM, respectively. The length of \nH1(zM)HM(z) is ML1 + LM – M. The delay introduced by Hb(z) and the delay introduced by \nH1(zM)HM(z) must be the same; otherwise, pure dela ys must be introduced into the shorter-\ndelay branch to equalize them.  \n \nMATLAB – A Fundamental Tool for Scientific Computing and Engineering Applications – Volume 1 466 \n \nFigure 11. Structure for the synthesis of a Hilbert transformer using the FRM technique. \nIn order to avoid inserting half-sample delay in the implementation, the parities of Lb and of \n(ML1 + LM – M) must be the same. Furthermore, H1(zM)HM(z)must have anti-symmetrical \nimpulse response. \nConsider the magnitude response of Hb(z) as | Hb(ejω)|, as shown in Figure 12a, where Lb is \neven. The computational complexity of Hb(z) is low since its transition band is wide. Now \nconsider the magnitude response of a transition band correction filter, |He(ejω)|, as shown in \nFigure 12b. The Hilbert transformer with sharp transition bandwidth, as shown in Figure \n12c, is obtained from the parallel connection of the correction filter with Hb(z). \nThe objective is designing a correction filter with very low complexity using FRM technique. \nConsider the band-edge shaping filter H1(z) with magnitude response |H1(ejω)|, as shown in \nFigure 12d. The complexity of H1(z) is low because it has a wide  transition band. Replacing \neach delay of H1(z) by M delays, a magnitude response | H1(ejMω)| is obtained, as shown in \nFigure 12e. A masking filter HM(z), with magnitude response |HM(ejω)| shown in Figure 12f, \ni s  u s e d  t o  m a s k  t h e  u n w a n t e d  p a s s - b a n d  o f  |H1(ejMω)|. With this mask ing, the magnitude \nresponse |He(ejω)|, shown in Figure 12b, is produced. HM(z) has low complexity because its \nmagnitude response has a wide transition band. \nSince the length of Hb(z) is even, the length of H1(zM) HM(z), i.e.,MN1 + NM – M, must also be \neven. If M is odd, N1andNMmust have different parities. By considering the gain of |HM(ejω)| \nin the vicinity of ω = 0, it is clear that HM(z) has symmetrical impulse response. Thus, H1(z) \nmust have anti-symmetrical impulse response to satisfy the condition that H1(zM) HM(z) must \nhave anti-symmetrical impulse response. \nThe band-edges of Hb(z) and HM(z) are the same. Let the band-edge of Hb(z) be θb and let the \nband-edge of H1(z) be θ1. It can be seen from Figure 12 that the value θb satisfies θb ≤ (2π – \nθ1)/M. For an arbitrary value θ1, it is possible to obtain θb if the appropriate value of M is \nknown, which is obtained with the object ive of minimizing the overall number of \ncoefficients. Finally, the overall filter is designed with a joint simultaneous optimization of  \nH1(zM), Hb(z) and HM(z). For the examples in [10], the algorithm in [27] was used.  \nIn the following we present a simple example to  design an efficient FIR Hilbert transformer \nwith stringent specifications based on the FR M technique. The approa ch presented in this \nexample follows the procedure based on the four steps to design a half-band filter in terms \nof filter A(z), B(z) and C(z). \nThe Hilbert transformer is derived using (64). Since this approach does not require a \nsimultaneous optimization for all the filters, it is simple and straightforward. Additionally, \nthe sensitivity to the rounded coefficients is less since every filter is designed separately [28].   \n()bH z\n1() MH z ()MH z\n()Yz()Xz\n \nDigital FIR Hilbert Transformers: Fundamentals and Efficient Design Methods 467 \n \nFigure 12. Magnitude responses of the subfilters for even length Hb(z). Note that ωL/2π is the desired \ntransition bandwidth. \nExample 4. The following code example illustrates the design of a Type III Hilbert \ntransformer with δ= 0.0001, ωL= 0.00125 π and ωH= π– ωL= 0.99875 π using the MATLAB \nSignal Processing Toolbox and the Filter Design Toolbox to generate the half-band filter. The \nconversion of filters with argument z into filters with argument jz is performed with the \nsame principle illustrated in the code of example 3. \nwL=0.00125*pi; wH=0.99875*pi; d=0.0001; % Hilbert transformer specification \nwp=pi/2 - wL;  ws=pi/2 + wL;  %find the half-band band-edge frequencies \ndp=d/2;        ds=d/2; %find the half-band ripple specification \n%--------STEP 1. Optimum M---------- \nM = (1/2)*round(sqrt(2*pi/(ws-wp))); if mod(M,2)==0; M = M+1; end \n%----------------------------------- \n%-------STEP 2. Band-edge-Shaping and Masking Filters-------------- \nif mod((M-1)/4,1)==0;  \n    m=floor(wp*M/(2*pi));  theta=(wp*M)-(2*pi*m);   phi=(ws*M)-(2*pi*m);   \n    theta_Ma=wp; phi_Ma=(2*pi*(m+1)-phi)/M; theta_Mc=((2*pi*m)-theta)/M; \n    phi_Mc=ws;   \nelse \n    m=ceil(ws*M/(2*pi));  theta=(2*pi*m)-(ws*M);   phi=(2*pi*m)-(wp*M);   \n    theta_Ma=(2*pi*(m-1)+phi)/M;  phi_Ma=ws;  theta_Mc=wp; \n    phi_Mc=((2*pi*m)+theta)/M; \n|( ) | j\nbHe \n|() | j\neHe \n|( ) | jHe \n1|() | jHe \n1|( ) | jMHe \n|( ) | j\nMHe \n1\n1\n1\n1\n1\n1\n0\n0\n0\n0\n0\n0\nb\n1\n1 / M\nL\n1(2 ) / M\n\n\n\n\n\n\n\n\n\n\n\n(a)\n(b)\n(c)\n(d)\n(e)\n(f)\n\n \nMATLAB – A Fundamental Tool for Scientific Computing and Engineering Applications – Volume 1 468 \nend \nLa=firpmord([theta/pi  phi/pi],[1 0], [0.85*dp 0.85*ds]);  \nif mod(La,2)==0; La=La+1; end \nif mod((La+1)/4,1)~=0; La=La+2; end \nK=(La+1)/4; \n[L_Ma,fo,ao,W]=firpmord([theta_Ma/pi  phi_Ma/pi],[1 0], [0.85*dp 0.85*ds]); \nif mod(L_Ma,2)==0; L_Ma=L_Ma+1; end \nif mod((L_Ma-1)/4,1)~=0; L_Ma=L_Ma+2; end \nha = firhalfband(La-1,theta/pi); \nh_Ma = firpm(L_Ma-1,fo,ao,W); \n%---------------------------------------------------------------- \n%--------STEP 3. Filters A(z), B(z) and C(z)--------------------- \na = ha - [zeros(1,2*K-1) 1/2 zeros(1,2*K-1)];  \nfor i=1:L_Ma; if mod(i-1,2)==0; b(i)=0; c(i)=h_Ma(i); else b(i)=h_Ma(i); \nc(i)=0; end \nend \ndelay_b = [zeros(1,M*(2*K-1)) 1 zeros(1,M*(2*K-1))];  \ndelay_c = [zeros(1,(L_Ma-1)/2) 1 zeros(1,(L_Ma-1)/2)]; \n%--------------------------------------------------------------- \n%--------STEP 4. Form the Hilbert transformer (or half-band filter)------- \na_M = upsample(a,M); a_M = a_M(1:end-(M-1)); \nindex_a_M = [1:length(a_M)]; \nm_a_M = (ones(1,length(a_M))*j).^(-(index_a_M-1)); \nindex_b = [1:length(b)]; \nm_b = (ones(1,length(b))*j).^(-(index_b-1)); \nindex_c = [1:length(c)]; \nm_c = (ones(1,length(c))*j).^(-(index_c-1)); \nindex_delay_b = [1:length(delay_b)]; \nm_delay_b = (ones(1,length(delay_b))*j).^(-(index_delay_b-1)); \nindex_delay_c = [1:length(delay_c)]; \nm_delay_c = (ones(1,length(delay_c))*j).^(-(index_delay_c-1)); \nh = 2*conv(delay_b.*m_delay_b, b.*m_b) +... \n    2*conv(a_M.*m_a_M,(2*c.*m_c - delay_c.*m_delay_c)); \n[H w] = freqz(h,1,10000); \nfigure; plot(w/pi, abs(H)) \n%---------------------------------------------------------- \n \nDigital FIR Hilbert Transformers: Fundamentals and Efficient Design Methods 469 \nFigure 13 shows the magnitude response of th e obtained Hilbert transformer. The overall \nstructure requires 148 coeffici ents in total, i.e., 69 for A(jMzM), 39 for B(jz) and 40 for C(jz). \nClearly, the FRM-based design is a very effici ent method comparing to a direct design, like \nthe one presented in exampl e 1, where the estimated le ngth is 4017 and which would \nrequire approximately 1005 coefficients.   \n5.2. Hilbert transformer Design based on Frequency Transformation \nThe Frequency Transformation (FT) method, developed in [12] to design FIR Hilbert \ntransformers, allows designing FIR Hilber t transformers using a tapped cascaded \ninterconnection of repeated simple basic building blocks constituted by two identical \nsubfilters. To this end, two simple filters are required, namely, a prototype filter and a \nsubfilter. The number of times th at the subfilter is used, as well as the coefficients used \nbetween each cascaded subfilter, depends on th e prototype filter. Both, the prototype filter \nand the subfilter are Hilbert transformers. The former is always a Type IV filter whereas the \nlatter can be a Type III or Type IV filter according to the type of the desired Hilbert \ntransformer [12]. \nThe prototype filter must be a Type IV FI R filter, i.e., with even length given as L\nP = 2N and \nanti-symmetric impulse response of the form p(2N – 1 – n) = –p(n). Its frequency response is \nexpressed as \n      (2 1 ) /2  /2\n() ( )\njNjPe e P ,  (66) \nwhere P(Ω), the zero-phase term, is given by \n  \n\n\n\n   \n1\n2\n0\n() s i n ( ) c o s\nN\nn\nPj d n n ,   (67) \nand Ω denotes the frequency domain of th e prototype filter. The coefficients ()dn can be \nobtained directly from the impulse response p(n) [1]. \nUsing the equivalence cos( Ωn) = Tn{cos(Ω)} [17], where Tn{x}is the nth-degree Chebyshev \npolynomial defined with the following recursive formulas, \n \nFigure 13. Magnitude responses of the FRM-based Hilbert transformer. From left to right: overall \nmagnitude response, transition bandwidth detail and passband ripple detail. \n0 0.2 0.4 0.6 0.8 10\n0.5\n1\n1.5\n/\n|H(e j)|\n0 0.5 1\nx 10\n-3\n0\n0.2\n0.4\n0.6\n0.8\n1\n/\n|H(ej)|\n0.2 0.4 0.6 0.8\n0.9999\n0.9999\n1\n1\n1.0001\n1.0001\n/\n|H(ej)|\n \nMATLAB – A Fundamental Tool for Scientific Computing and Engineering Applications – Volume 1 470 \n 01 1 2{} 1 , {} a n d {} 2 {} {} , nn nTx Tx x Tx x T x T x      (68) \nthe zero-phase term can be rewritten as \n  \n\n\n\n    \n1\n2\n0\n() s i n ( ) c o s\nN n\nn\nPj n ,  (69) \nwhere α(n) are obtained from ()dn using the coefficients of the Chebyshev polynomials. \nBased on the equivalence given as \n       \n22cos 2 1 2sin 1 2 sinxx j x ,    (70) \nthe zero-phase term can be expressed by \n  \n\n\n\n      \n1 2\n22\n0\n() s i n ( ) 12 s i n\nnN\nn\nPj n j .  (71) \nConsider the case of a Type III subfilter with odd length given as LG= 2 M + 1 and anti-\nsymmetric impulse response of the form g(2M – n) = – g(n). Its frequency response is \nexpressed as \n  \n  \n2/ 2\n() ( )\njMjGe e G ,  (72) \nwhere G(ω) is the zero-phase term, given by \n \n\n  \n1\n() ( ) s i n ( )\nM\nn\nGj c n n .  (73) \nThe coefficients c(n) can be obtained directly from g(n) [1]. Note that the term G(ω) can be \nput in (71) by using the following expression, \n \n\n   2\n1\nsin ( )sin( )\nM\nn\nj jc n n ,   (74) \nresulting in \n \n\n \n       \n   \n21\n10 1\n() ( ) s i n ( ) ( ) 1 2 ( ) s i n ( )\nn\nMN M\nnn n\nHj c n n n j c n n ,   (75) \nwhere H(ω) is the zero-phase term of the over all filter. Therefore, the frequency \ntransformation is obtained from (74) and is given by \n \n\n   \n  \n 1\n1\n2sin ( )sin( )\nM\nn\ncn n .     (76) \n \nDigital FIR Hilbert Transformers: Fundamentals and Efficient Design Methods 471 \nEquation (76) implies that the magnitude respon se of the prototype filter is preserved, but \nits frequency domain is changed by the subfilter. \nThe transfer function of the overall Hilbert transformer is given as \n \n1\n2( 1) 2 2\n11\n0\n() () () () , () 2 ()\nN nMN n M\nn\nH z G z z nHz Hz z Gz \n\n  \n\n    (77) \nwith G(z) being the transfer function of the subfilter. \nFor a desired Hilbert transformer specification expressed as in (17), the magnitude response \n|P(Ω)| of the prototype filter must satisfy the following condition, \n        (1 ) ( ) (1 ),     for LP , (78) \nwith ΩL being the lower band-edge frequency of  the prototype filter. The magnitude \nresponse of the subfilter, |G(ω)|, must fulfill simultaneously \n         0( ) 1,     for dG L LvG ,   (79) \n    \n11 11\n22 2 22 2sin , sin .LL\ndGv \n\n    (80) \nThe design procedure proposed in [12] starts with an arbitrary prototype filter, and then the \nsubfilter is designed accordingly.  \nNote that the complexity of the subfilter de pends almost exclusively on its transition \nbandwidth, since its ripple specification is considerably relaxed. Similarly, the prototype \nfilter is a low-complexity filter because, even though its ripple specification is strict, its \ntransition bandwidth is relaxed. The relaxed ripple specification of the subfilter makes it \nsuitable to be implemented as a simple, multiplierless system with rounded coefficients [13]. \nAdditionally, it was observed in [13] that the repeated use of identical subfilters can be \navoided by taking advantage of the PI techniqu e, which has been introduced in sub-section \n4.4. Therefore, a time-multiplexed design with lower area can be obtained.  \nFigure 14 presents the PI-based architectu re proposed in [13]. This structure was \nstraightforwardly derived from [19], where a similar example is given for the sharpening \ntechnique of [22]. Additionally, the design of the Hilbert transformer was made multiplierless \nby applying rounding to the coefficients of the prototype filter and the subfilter.  \nInstead of choosing an arbitrary prototype filter  as in [12], a heuristi c search was employed \nto select the prototype filter and the subfilter, such that th e proposed architecture uses a \nnumber of coefficients less or equal to 0. 25 times the estimated number of multipliers \nrequired in a direct design using the Parks-McClellan algorithm. \n \nMATLAB – A Fundamental Tool for Scientific Computing and Engineering Applications – Volume 1 472 \n \n \nFigure 14. PI-based structure with three subfilters [13]. \n \nFigure 15. PI-based structure with two subfilters [14]. \nIn [14] the authors observed  that the cascaded interconnection of the two subfilters G(z) \nrequired to build H1(z) can be decoupled and also implemented with the PI technique. Thus, \nthe PI-based architecture shown in Figure 15, which only requires two subfilters, was \nobtained. The approach of PI-based architectures for FT designs was further developed in \n+\nG(z) G(zK) + G(zK) \nK = LP/2 – 1  \n+\nz–1\nz–1\nz–1\nz–1\n+\nz–1\nz–1\nz–1\nz–1\n+\n+\n+\n+\nM = LG – 1  \n    K \n    K \n    K \n    K     K \n    K \n    K \n    K \n.\n. \n. \n.\n. \n. \n.\n. \n. .\n. \n. \nα(K) \nα(0) \nα(1) \n2 \nz–KM \nz–M–1 \nz–M–1 \nz–M–1 \n.\n. \n. .\n. \n. \nG(z) +\nK = LP/2 – 1  \nz–1\nz–1\nz–1\nz–1\n+\nz–1\nz–1\nz–1\nz–1\n+\n+\n+\n+\nM = LG – 1  \n    K \n    K \n    K \n    K     K \n    K \n    K \n    K \nG(z2K)     2 +\nz–1\n    2 \n.\n. \n. \n.\n. \n. \n    2 \n    2 \nz–1\n+\n+\nα(K) \nα(0) \nα(1) \n2 \nz–KM–1\nz–M–2\nz–M–2\nz–M–2\n \nDigital FIR Hilbert Transformers: Fundamentals and Efficient Design Methods 473 \n[15], and a simple procedure to derive a PI-b ased structure from a FT-based design with \nidentical subfilters was proposed. With this procedure, the arch itecture presented in Figure \n16 was proposed for Hilbert transformers, where only a simple subfilter is required.  \n \nFigure 16. PI-based structure with one subfilter [15]. \nAn important insight proposed in [14] was avoiding the arbitrary selection of the prototype \nfilter as in [12] through the optimized search of the adequate prototype filter, such that a \ncost metric is minimized. Since multipliers are the most expensive elements in digital filters, \nreducing the overall number of coefficients is the goal. In general terms, this is equivalent to \nimprove the original heuristic search proposed in [13]. From (78), (79) and (80) it can be \nobserved that the prototype filter and the subfilter can be designed if the frequency Ω\nL is \nknown. The problem consists on finding the optimal frequency ΩL. \nConsider a function φ(δ, ωL), which can estimate with an acceptable exactitude the length of \na HT in terms of its ripple δ and its lower passband edge ωL, such as the on e presented in \n(18). We have, for the prototype filter and the subfilter,  \n   L (/,  )GG G d LLv ,   (81) \n   L (,  )PP LL ,  (82) \nwhere LG and LP are the respective approximations to the lengths of the subfilter, LG, and the \nprototype filter, LP, whereas vd and δG are given in (80). Clearly, LG and LP are given as \nfunctions of the ripple and tran sition band of the subfilter and of the prototype filter, \nrespectively. \nα(LP/2–1) \nz-M\nz-M\nz-1\n2 \n2 \nz-M\nz-Mz-M\nα(2) \nα(1) \nα(0) \nz-M\nz-1\nz-1\nz-1\nz-1\nz-1\n z-1\nz-1\nz-1\nz-1\nz-1\nK\nK\nK\nK\nK\nK\nK\nG(zK) \nKK\nK\nK\nK\nK\nK=LP–1 \nM=LG–1 \nK\n2 \n \nMATLAB – A Fundamental Tool for Scientific Computing and Engineering Applications – Volume 1 474 \nFor the previously revised PI-based structures, it is always possible to express the overall \nnumber of multipliers m in terms of the numbers of multipliers of the prototype filter and \nthe subfilter as, \n  (,   )GPmf m m , (83) \n  GGmC L , (84) \n  / 2PPmL , (85) \nwhere mP and mG are taken from (19). \nSubstituting vd and δG from (80) in (81), and using th e approximations (81) and (82) \nrespectively in (84) and (85) we have \n       \n    1s i n ( / 2 ) 1\n21s i n ( / 2 )(,  ,  ) ( ,  ) ,   (,  ) L\nLLL L Lmf C . (86) \nNote that, even though m(δ, ωL, ΩL) is a function of δ, ωL and ΩL, the values δ and ωL are \nknown a priori because they are given by the problem at hand (see (17)). Therefore, since the \nunique unknown is ΩL, the approach consists in finding the optimum value Ω*L for ΩL, with \n0 < ΩL<π, such that m(δ, ωL, ΩL) is minimized. This optimization problem is given as \n \n\n\n\n\n\nmin ( , , )\nsuch that  0 ,\nL\nLL\nL\nm\n (87) \nwhere m(δ, ωL, ΩL)  i s  g i v e n  i n  ( 8 6 ) .  T h e  r e s u l t  o b t a i n e d  f r o m  ( 8 6 )  i s  a n  e s t i m a t i o n  w h i c h  \ndepends on the exactitude of the function φ(δ, ωL).  \nEquation (18) was utilized in [17] as the function φ(δ, ωL). However, this function does not \ngive good length estimation for filters with a huge ripple (like the subfilters in the FT \nm e t h o d ) .  U s i n g  t h e  p r o p o s a l  f r o m  [ 2 9 ]  a s  s t a r t i n g  p o i n t ,  w e  h a v e  r e c e n t l y  d e r i v e d  t h e  \nfollowing more accurate formula, \n \n\n\n\n\n   \n\n\n        \n       \n1.1\n0.44510\n10\n2\n1.39\n2\n2\n1.101 log ( )12( , ) 1 arctan 2.325 0.30103 log ( ) ...23 ()\n11                   ( ) .                           60.5 ( )\nL\nL\nL\nL\n (88) \nThus, the FT method consists on finding the optimum value ΩL by solving (87). With this \nvalue, the prototype filter and the subfilter are designed as given in (78) and (79). Finally, \nthe coefficients α(n) are found from the prototype filter co efficients by relating (67) and (69) \nand the overall filter is synthesized by using an y of the structures existing in literature [13]-\n[15] or [17].  \n \nDigital FIR Hilbert Transformers: Fundamentals and Efficient Design Methods 475 \nExample 5. The following code example illustrates the design of a Type III Hilbert \ntransformer with δ= 0.004, ωL= 0.01 π and ωH= π– ωL= 0.99 π using the MATLAB Signal \nProcessing Toolbox. The optimized value for ΩL is Ω*L = 0.2237 π and the lengths for the \nprototype filter and the subfilter are, respectively, LP = 14 and LG = 31. The value Ω*L has been \noptimized to minimize the number of coefficien ts in the structure of Figure 16. This code \nmakes use of the MATLAB function ChebyshevPoly.m, which is available online [30]. \n%*********** INITIAL DATA **************** \nL_g=31;  wl=0.01*pi;  L_p=14;   Om_L=0.2237*pi; \n%************** SUBFILTER********************** \nwH=pi-wl;    dG = (1/2) - (1/2)*sin(Om_L/2);  \nvd = (( 1 - sin(Om_L/2) )/2) + sin(Om_L/2); \ng = firpm(L_g-1,[wl/pi wH/pi],[vd vd],'hilbert'); \n%*************PROTOTYPE FILTER***************** \n[p]=firpm(L_p-1,[Om_L/pi 1],[1 1],'hilbert'); \n%***************BASIC BUILDING BLOCK H1******************** \nr1=2*conv(g,g); \ndelay=[zeros(1,L_g-1) 1 zeros(1,L_g-1)]; \nh1=r1+delay; \n%**************ALPHA COEFFICIENTS FROM CHEBYSHEV POLYNOMIAL ************** \nN = L_p/2 \nfor mm=1:N;  d(mm)=2*(p((N+1)-mm)); end \nD(N)=2*d(N);   \nfor Mm=fliplr([3:N]);  D(Mm-1)=(2*d(Mm-1))+(D(Mm));  D(1)=d(1)+((1/2)*D(2)); \nend \ntt=0; \nfor nn=fliplr([0:N-1]); tk=ChebyshevPoly(nn); T(nn+1,:)=[zeros(1,tt) tk'] ;  \n  tt=tt+1; \nend \nll=sum((D'*[ones(1,N)]).*T); \nalpha=fliplr(ll); \n%**************OVERALL FILTER ************** \nupper_branch = g;   lower_branch = g*alpha(1);  h = lower_branch; \nfor ii=1:N-1; \nupper_branch = conv(upper_branch,h1); \nlower_branch = conv(h, [zeros(1,L_g-1) 1 zeros(1,L_g-1)]); \nh=lower_branch + alpha(ii+1)*upper_branch;%Overall Hilbert transformer \nend \n[H w]=freqz(h,1,1000); \nfigure \nplot(w/pi,abs(H)) \n \nMATLAB – A Fundamental Tool for Scientific Computing and Engineering Applications – Volume 1 476 \nFigure 17 shows the magnitude response of th e obtained Hilbert transformer. The overall \nstructure requires only 15 coefficients in total, i.e., 7 structural coefficients, α(0) to α(6), and 8 \ncoefficients for the subfilter G(z). Compared to a direct design, where the estimated length is \n287 and which would require approximately 72 co efficients, The FT-based design achieves \nalmost a 75% of reduction in the number of distinct required coefficients.   \n \nFigure 17. Magnitude responses of FT-based Hilbert transformer. From left to right: overall magnitude \nresponse, transition bandwidth detail and passband ripple detail. \n5.3. Hilbert transformer design based on Piecewise Polynomial Sinusoidal \ntechnique \nThis method to synthesize Hilbert transformers , first proposed in [25] and then detailed in \n[11], is based on the previous method [31] and on a modification to the method [32]-[33]. The \nmethod stems from a windowing technique for Ty pe III and Type IV FIR filters of order 2 N \nand 2N-1, respectively. The basic windowing technique for Type III filters is expressed as \n  0() () ()hn wnh n ,   (89) \nwhere \n \n\n\n \n\n\n0\n0                                   for odd\n() 1-co s ( ( - ) )         for n even()\nn\nhn nN\nnN\n  (90) \nis an ideal impulse response, w(n) is the window function and N is odd. Similarly, an ideal \nodd-order impulse response can be expressed as \n   0\n1() (( 2 1 ) / 2 )hn nN\n.   (91) \nThe overall transfer function can be expressed in the following way, \n \n\n\n\n\n\n \n\n\n\n\n\n2\n0\n21\n0\n( )[1 cos(( ) )] , Type III\n()\n( ) ,                               Type IV\nN\nn\nn\nN\nn\nn\nWn n N z\nFz\nWnz\n (92) \nwith \n0 0.5 10\n0.5\n1\n1.5\n/\n|H(ej)|\n0 0.005 0.01 0.0150\n0.2\n0.4\n0.6\n0.8\n1\n/\n|H(ej)|\n0.2 0.4 0.6 0.80.996\n0.998\n1\n1.002\n1.004\n/\n|H(ej)|\n \nDigital FIR Hilbert Transformers: Fundamentals and Efficient Design Methods 477 \n \n   \n\n\n( ) / [ ( )],() ( (2 1 / 2)) / [ ( (2 1 / 2))].\nwn N n NWn wn N n N  (93) \nW(n) is an impulse response satisfying W(2N − n) = −W(n) for n = 0, 1, . . .,N − 1, W(N) = 0, \nand W(2N − 1 − n) = −W(n) for n = 0, 1, . . .,N, for Types III and IV respectively. Additionally, \nw(n) is a positive and symmetric window function for all n. \nA way to generate the piecewise-polynomial-sinusoidal transfer function F(z) is to consider \nthe following transfer function: \n \n \n\n     \n ()\n00\n() () ( ) ()1 ( c o s ( ( )) s i n ( ( )) )\nssNN\njn Nn n\nnn\nGz Wnz e Wn n N j n N z , (94) \nwhere Ns is 2N or 2N − 1 for Types III and IV, respectively. From (92) it follows that F(z) can \nbe expressed as \n \n \n\n                \n\n () 1\n00\n( ) Re ( ) ( ) Re ( ) 1 ( )\nssNN\njn N jnn N n\nnn\nFz Wnz z e Wn z z e .  (95) \nIn [32] a wideband FIR filter is obtained by first generating the envelope filter with W(n) for \nn =0, 1, . . . , 2N [2N − 1] as the impulse-response coefficients. This impulse response is \ndesigned to become piecewise polynomial. The co efficient values of this  envelope filter are \nmodified by multiplying them with [1−cos(n−N)π] for Type III, which gives F(z). From (92) it \ncan be seen that for Type IV the piecew ise-polynomial-sinusoidal impulse response \ncoincides with the piecewise-polynomial impulse response, i.e., the constant part of the real \npart in (95). \nLet us consider the simpler case Type IV filt er. The overall transfer  function, denoted by \nH(z), is constructed as presented previously in su b-section 4.3. We will  repeat the equation \nhere for convenience,  \n \n \n\n\nˆ\n1\nˆ() () () m\nM N N\nm\nm\nHz z H z z Hz .  (96) \nRecall that the integers Nm in the delay terms z–Nm satisfy N1 = 0 and Nm+1>Nm for m = 1, 2, …, \nM – 1, and the order of Hm(z) is 2(N – Nm) – 1. The impulse response is given for n = 0, 1, 2, … \n,N − Nm–1by Lth order polynomials as follows \n \n\n\n()\n0\n() ()\nL\nLr\nmm\nr\nhn a r n .   (97) \nAdditionally,  ˆ ˆ()NzH z is a conventional [2 N − 1]th-order Type IV direct-form transfer \nfunction with the additional im pulse response coefficients at n = N −c, . . . , N −1, where c =\n \nMATLAB – A Fundamental Tool for Scientific Computing and Engineering Applications – Volume 1 478 \n /2T  and T is the n umber of additional coefficients  at the center of the filter. The delay \nterms in (96) are used to shift the center of  the symmetry at the desired location, which \noccurs at n = (2N − 1)/2. \nIn order to indicate that the overall filter has a piecewise-polynomial impulse response the \ntime interval [0,N − 1] is divided into the following M subintervals: \n  1[ , 1]  for 1,2,..., 1Mm mXN N m M   (98) \nand \n [, ]MMXN N . (99) \nFirst, we have that X1 =[0,N2− 1] because N1 = 0, Secondly, the overall impulse response can \nbe studied up to n = N − 1 because of the odd symmetry. The impulse response on Xm can be \nexpressed as \n \n\n \n1\n() ()\nM\nm\nm\nhn h n ,  (100) \nwhere \n \n\n       \n ()\n10\n() () ( )\nmL\nLr\nMk M\nkr\nhn a r n N   (101) \nfor m = 1, 2, …, M – 1 and \n \n\n   \n ()\n10\n() () ( ) ´ ()\nML\nLr\nMk M\nkr\nhn a r n N h n , (102) \nwhich equals the overall im pulse response and where h’(n)is a conventional direct-form \nType IV filter with nonzero coefficients for n = N − c, . . . , N − 1, in which c =   /2T and T is \nthe number of separately generated addi tional center coefficients. The slices Nms should be \nchosen so that |N2−N1| ≠|N3−N2| ≠ … ≠|NM −NM−1|,where N1 = 0 and M is the number of \nsubintervals in the overall impulse response. \nBased on the above equations, in each Xm for m =1, 2, . . ., M , a separate piecewise-\npolynomial impulse response can be generated. In addition, in the XM, there are additional \ncenter coefficients, which are of great importance for fine-tuning the overall filter to meet the \ngiven criteria. \nGiven the filter criteria as well as the design parameters M,N, L, Nm’s, and the number of \ncenter coefficients included in ˆ()Hz , the overall problem is solvable by using linear \nprogramming. \n \nDigital FIR Hilbert Transformers: Fundamentals and Efficient Design Methods 479 \n6. Conclusion \nIn this chapter we have studie d the Hilbert transform relations existing among the real part \nand the imaginary part of complex analytic si gnals. The importance of these signals has \nbeen highlighted in terms of spectral efficiency, i.e., the analytic signals do not have spectral \ncomponents in their negative-frequency side. For discrete-time sequences, this characteristic \nholds for the negative-frequency side in every Nyquist period.  \nThe Hilbert transformer has been introduced as a special type of FIR filter which is the key \nprocessing system to generate analytic signals. The design of such important filter is, of \ncourse, straightforward with the aid of an important filter de sign tool: the MATLAB Signal \nP r o c e s s i n g  T o o l b o x .  H o w e v e r ,  t h i s  d i r e c t  design method, shown as a very simple and \nconvenient MATLAB code, cannot be efficientl y applied for more stringent and realistic \nspecifications. We have presented a concis e explanation of the relation of Hilbert \ntransformers and half-band filters because this relation, as has been observed from \nliterature, is one of the most important characteristics to overcome this problem. \nThe efficient methods to design low-complexi ty FIR Hilbert transformers with strict \nspecifications have been detailed. Three me thods have been analyzed, namely, Frequency-\nResponse Masking (FRM), Frequency Transf ormation (FT) and Pi ecewise-Polynomial \nSinusoidal (PPS). These schemes are based on three different a pproaches to design efficient \nFIR filtering. FRM is a periodical subfilter based method, FT is an identical subfilter based \nmethod and PPS is a piecewise-polynomial based method. Additionally, it has been \nobserved that FRM and PPS are fully parallel a pproaches and do not take direct advantage \nof hardware multiplexing. On the other hand, we have shown that FT allows area-efficient \narchitectures by multiplexing a simple subfilter. \nFinally, the FRM and the time-multiplexed FT approach have been illustrated in \nMATLAB, with the aid of the Signal Processi ng Toolbox. Even though the underlying \ntheory on the efficient techniques to design FIR Hilbert transformers is specialized, the \nMATLAB codes have been preserved in a simple and as clear as possible presentation. \nThe presented codes allow a clearer understandin g on such specialized techniques and, at \nthe same time, can serve as a basis for more elaborated algorithms and further research on \nthis fertile area. \nAuthor details \nDavid Ernesto Troncoso Romero and Gordana Jovanovic Dolecek \nDepartment of Electronics, Institute INAOE, Tonantzintla, Puebla, Mexico \nAcknowledgement \nSpecial thanks to Miriam G. Cruz Jimenez for her valuable assistance in the development of \nthis chapter.  \n \nMATLAB – A Fundamental Tool for Scientific Computing and Engineering Applications – Volume 1 480 \n7. References \n[1] Andreas Antoniou (2006) Digital Signal Processing. McGraw Hill, USA.  \n[2] Alan V. Oppenheim, Ronald W. Schafer (1989) Discrete-Time Signal Processing. \nPrentice Hall, USA. \n[3] R. L. C. Van Spaendonck, F. C. A. Fernandez, R. G. Bara niuk and J.T. Fokkema (2002) \nLocal Hilbert transformation for seismic attributes. EAGE 64th Conference and Technical \nExhibition.  \n[4] J o s e  G .  R .  C .  G o m e s  a n d  A .  P e t r a g l i a  (2002) An analog Sampled-data DSB to SSB \nconverter using recursive Hilbert transforme r for accurate I and Q channel matching. \nIEEE Trans. Circ. Syst. II, vol. 49, no. 3, pp. 177-187. \n[5] Michael Feldman (2011) Hilbert transform in  vibration analysis. Mechanical Systems \nand Signal Processing, no. 25, pp. 735-802. \n[6] R. Ansari (1987) IIR discrete-time Hilbert transformers. IEEE Trans. Acoust. Speech and \nSignal Processing, vol. ASSP-35, no. 8, pp. 1116-1119.  \n[7] Ljiljana D. Milic and Miroslav D. Lutova c (1999) Approximate linear phase Hilbert \ntransformer. IEEE International Conferen ce on Telecommunications in Modern \nSatellite, Cable and Broadcasting Services, TELSIKS´99, pp. 119-124. \n[8] S. Samadi, Y. Igarashi and H. Iwakura (1999) Design and multiplierless realization of \nmaximally flat FIR digital Hilbert transforme rs. IEEE Trans. Signal Processing, vol. 47, \nno. 7, pp. 1946-1953. \n[9] Yong C. Lim and Y. Yu (2005)  Synthesis of Very sharp Hilbert transformer using the \nFrequency-Response Masking technique. IEEE Trans. on Signal Processing, vol. 53, no. \n7, pp. 2595-2597.  \n[10] Yong C. Lim, Y. Yu and T.  Saramaki (2005) Optimum masking levels and coefficient \nsparseness for Hilbert transformers and Half-band filters designed using the \nFrequency-Response Masking technique. I EEE Trans. Circuits and Sistems-I: Reg. \nPapers, vol. 52, no. 11, pp. 2444-2453.  \n[11] R .  L e h t o ,  T .  S a r a m a k i  a n d  O .  V a i n i o  ( 2 0 10) Synthesis of wide-band linear-phase FIR \nfilters with a piecewise-polynomial-sinusoidal impulse response. Circ. Syst. and Signal \nProcess., vol 29, no. 1, pp. 25-50. \n[12] Y. L. Tai and T. P. Lin (1989) Design of Hilbert transf ormers by multiple use of same \nsubfilter, Electronics Letters, vol. 25, no.19, pp. 1288-1290. \n[13] M. G. C. Jimenez, D. E. T. Romero and G. J. Dolecek (2010) On design of a multiplierless \nvery sharp Hilbert transformer by using iden tical subfilters. In Proc. 53rd. IEEE Int. \nMidwest Symp. on Circ. and Syst., MWSCAS’10, pp. 757-760. \n[14] D. E. T. Romero, M. G. C.  Jimenez and G. J. Dolece k (2012) Optimal design of \nmultiplierless Hilbert transformers based on the use of a simple subfilter (in Spanish). \nComputación y Sistemas, vol. 16, no. 1, pp. 111-120. \n[15]\n D. E. T. Romero, M. G. C. Jimenez and G. J. Dolecek (2012) A new Pipelined-Interleaved \nstructure for FIR Hilbert transformers base d on frequency transformation technique. \nIEEE 5 th Int. Symp. on Communications, Cont rol and Signal Process, ISCCSP’12 (In \npress). \n \nDigital FIR Hilbert Transformers: Fundamentals and Efficient Design Methods 481 \n[16] Y. C. Lim (1986) Frequency-Response Masking Approach for the synthesis of Sharp \nLinear Phase Digital filters. IEEE Transactions on Circuits and Systems, vol. CAS-33, no. \n4, pp. 357-364. \n[17]\n T. Saramaki (1987) Design of FIR Filters as a Tapped Cascaded Interconnection of \nIdentical Subfilters. IEEE Tran sactions on Circuits and Systems, vol. CAS-34, no. 9, pp. \n1011-1029. \n[18] S. M. M. Zanjani, S. M. Fakhraie, O. Shoaei and M. E. Salehi (2006) Design of FIR filters \nusing identical subfilters of even length. In Proc. IEEE Int. Conf. on Microelectronics, \nICM’06, pp. 83-86.  \n[19] Z. Jiang and A. N. Wilson  (1997) Efficient digital fi ltering architectures using \nPipelining/Interleaving. IEEE Transactions on Circuits and Syst ems- II: Analog and \nDigital Signal Processing, vol. 44, no. 2, pp. 110-119. \n[20] Richard G. Lyons (2004) Understanding Digital Signal Processing. Prentice Hall. \n[21] H. W. SchüBler and P. Steffen (1998) Halfband filters and Hilbert transformers. Circuits \nand Systems signal Processing, vol. 17, no.2, pp. 137-164. \n[22] J. F. Kaiser and R. W. Ha mming (1977) Sharpening the re sponse of a symmetric non-\nrecursive filter by multiple use of the same  filter. IEEE Transactions Acoustics Speech. \nSignal Processing, ASSP-25, pp. 415-422. \n[23] Sanjit K. Mitra, James F. Kaiser (1993) Ha ndbook for Digital Signal Processing. John \nWiley & Sons, USA. \n[24] R .  L e h t o ,  T .  S a r a m a k i  a n d  O .  V a i n i o  ( 2 0 07) Synthesis of wide-band linear-phase FIR \nfilters with a piecewise-polynomial-sinusoidal impulse response. IEEE International \nSymp. Circuits and Systems ISCAS 2007, pp. 2052-2055. \n[25] R. Lehto and O. Vainio (2008) Hilbert tr ansformers with a pi ecewise-polynomial-\nsinusoidal impulse response, IEEE International Symp. Circuits and Systems ISCAS \n2008, pp. 2450-2453.  \n[26] T. Saramaki, Y. C. Lim and R. Yang (1995) The synthesis of halfband filter using \nfrequency-response masking technhique. IEEE Trans. Circuits Syst., vol. 42, no. 1, pp. \n58-60. \n[27] T. Saramaki, J. Yli-Kaakinen and H. Jo hansson (2003) Optimization of frequency-\nresponse-masking based FIR filters. Circuits, Syst. Signal Processing, vol. 12, no. 5, pp. \n563-590. \n[28] Y. C. Lim, Y. Yu, K. L. Teo and T. Saramaki (2007) FRM-based FIR filters with optimum \nfinite word-length performance. IEEE Trans. Signal Processi ng, vol. 55, no. 6, pp. 2914-\n2924. \n[29] K. Ichige, M. Iwaki and R. Ischii (2000) Accurate estimation of minimum filter length for \noptimum FIR digital filters. Circuits and Systems II: IEEE Tr ans. on Analog and Digital \nsignal process, vol 47, pp. 1008-1016. \n[30] Matlab Chebyshev polynomial function at \n http://www.mathworks.fr/matlabcentral/file exchange/35051-2-dimensional-filter-design-\nusing-mcclellan-transformation/content/Filter%202D%20McClellan/ChebyshevPoly.m  \n (last accessed 7-5-2012) \n \nMATLAB – A Fundamental Tool for Scientific Computing and Engineering Applications – Volume 1 482 \n[31] R. Lehto, T. Saramaki and O. Vainio ( 2007) Synthesis of narrowband linear-phase FIR \nfilters with a piecewise-polynomial impulse re sponse. IEEE Trans. Circuits and Syst. I, \nvol.54, no. 10, pp. 2262-2276. \n[32] S. Chu and S. Burrus (1984) Efficient recursive realizations of FIR filters, Part I: The filter \nstructures. IEEE Circuits, Syst. Signal Process. , vol. 3, no.1, pp. 2-20. \n[33] S. Chu and S. Burrus (1984) Effici ent recursive realizations of FIR filters, Part II: Design \nand applications. IEEE Circuits, Syst. Signal Process. , vol. 3, no.1, pp. 21-57. ",
  "topic": "Transformer",
  "concepts": [
    {
      "name": "Transformer",
      "score": 0.5293273329734802
    },
    {
      "name": "Computer science",
      "score": 0.4226140081882477
    },
    {
      "name": "Mathematics",
      "score": 0.41728007793426514
    },
    {
      "name": "Electronic engineering",
      "score": 0.37480276823043823
    },
    {
      "name": "Electrical engineering",
      "score": 0.2763124108314514
    },
    {
      "name": "Engineering",
      "score": 0.25398945808410645
    },
    {
      "name": "Voltage",
      "score": 0.0
    }
  ],
  "institutions": []
}