{
    "title": "Systems Biology Markup Language (SBML) Level 2: Structures and Facilities for Model Definitions",
    "url": "https://openalex.org/W2124236793",
    "year": 2007,
    "authors": [
        {
            "id": "https://openalex.org/A294664603",
            "name": "Michael Hucka",
            "affiliations": [
                "California Institute of Technology"
            ]
        },
        {
            "id": "https://openalex.org/A2008421542",
            "name": "Andrew Finney",
            "affiliations": [
                "Oxford Computer Consultants (United Kingdom)"
            ]
        },
        {
            "id": "https://openalex.org/A2246255993",
            "name": "Stefan Hoops",
            "affiliations": []
        },
        {
            "id": "https://openalex.org/A2116852892",
            "name": "Sarah Keating",
            "affiliations": [
                "University of Hertfordshire"
            ]
        },
        {
            "id": "https://openalex.org/A90819427",
            "name": "Nicolas Le Novère",
            "affiliations": [
                "European Bioinformatics Institute"
            ]
        },
        {
            "id": "https://openalex.org/A294664603",
            "name": "Michael Hucka",
            "affiliations": []
        },
        {
            "id": "https://openalex.org/A2008421542",
            "name": "Andrew Finney",
            "affiliations": []
        },
        {
            "id": "https://openalex.org/A2246255993",
            "name": "Stefan Hoops",
            "affiliations": []
        },
        {
            "id": "https://openalex.org/A2116852892",
            "name": "Sarah Keating",
            "affiliations": []
        },
        {
            "id": "https://openalex.org/A90819427",
            "name": "Nicolas Le Novère",
            "affiliations": []
        }
    ],
    "references": [
        "https://openalex.org/W1534403901",
        "https://openalex.org/W6658415779",
        "https://openalex.org/W6641506132",
        "https://openalex.org/W7029451798",
        "https://openalex.org/W6630086920",
        "https://openalex.org/W2155418451",
        "https://openalex.org/W6635498272",
        "https://openalex.org/W2157529519",
        "https://openalex.org/W7024902556",
        "https://openalex.org/W2150908245",
        "https://openalex.org/W2020561965",
        "https://openalex.org/W1525863646",
        "https://openalex.org/W6635534358",
        "https://openalex.org/W6665796822",
        "https://openalex.org/W2056090982",
        "https://openalex.org/W6631678790",
        "https://openalex.org/W6629973648",
        "https://openalex.org/W6640408758",
        "https://openalex.org/W7024659363",
        "https://openalex.org/W2914997451",
        "https://openalex.org/W2104416102",
        "https://openalex.org/W1965014786",
        "https://openalex.org/W2070812389",
        "https://openalex.org/W2031701828",
        "https://openalex.org/W2089562567",
        "https://openalex.org/W1676506149",
        "https://openalex.org/W2061364094",
        "https://openalex.org/W1590271040",
        "https://openalex.org/W1964287788",
        "https://openalex.org/W846058890",
        "https://openalex.org/W1595834830",
        "https://openalex.org/W2017727903",
        "https://openalex.org/W1924225422",
        "https://openalex.org/W1571919379",
        "https://openalex.org/W4249852273",
        "https://openalex.org/W2138294949",
        "https://openalex.org/W839809690",
        "https://openalex.org/W2125820659",
        "https://openalex.org/W153719779",
        "https://openalex.org/W2131067724",
        "https://openalex.org/W2109990759",
        "https://openalex.org/W2014118496",
        "https://openalex.org/W2611598995",
        "https://openalex.org/W2000483727",
        "https://openalex.org/W2134923619",
        "https://openalex.org/W1499965417",
        "https://openalex.org/W1527663426",
        "https://openalex.org/W1664954303",
        "https://openalex.org/W2730232141",
        "https://openalex.org/W2142643607",
        "https://openalex.org/W1987129107"
    ],
    "abstract": "Abstract Not applicable",
    "full_text": "Systems Biology Markup Language (SBML) Level 2:\nStructures and Facilities for Model Deﬁnitions\nMichael Hucka California Institute of Technology, USA\nAndrew M. Finney Oxford Computer Consultants Ltd, UK\nStefan Hoops Virginia Bioinformatics Institute, USA\nSarah M. Keating University of Hertfordshire, UK\nNicolas Le Nov` ere EMBL European Bioinformatics Institute, UK\nsbml-editors@sbml.org\nSBML Level 2 Version 3\nRelease 1\n16 June 2007\nCorrections and other changes to this SBML language speciﬁcation may appear over time.\nNotiﬁcations of new releases are broadcast on the mailing list sbml-announce@sbml.org\nThe latest release of the SBML Level 2 Version 3 speciﬁcation is available at\nhttp://sbml.org/specifications/sbml-level-2/version-3/\nThis release of the speciﬁcation is available at\nhttp://sbml.org/specifications/sbml-level-2/version-3/release-1/\nThe list of known issues in all releases of SBML Level 2 Version 3 is available at\nhttp://sbml.org/specifications/sbml-level-2/version-3/errata/\nThe XML Schema for SBML Level 2 Version 3 is available at\nhttp://sbml.org/xml-schemas/\nNature Precedings : hdl:10101/npre.2007.58.1 : Posted 18 Jun 2007\nContents\n1 Introduction 3\n1.1 Developments, discussions, and notiﬁcations of updates . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 3\n1.2 SBML Levels, Versions, and Releases . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 3\n1.3 Language features and backward compatibility . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 4\n1.4 Document conventions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 5\n2 Overview of SBML 9\n3 Preliminary deﬁnitions and principles 11\n3.1 Primitive data types . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 11\n3.2 Type SBase . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 13\n3.3 The id and name attributes on SBML components . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 18\n3.4 Mathematical formulas in SBML Level 2 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 20\n4 SBML components 30\n4.1 The SBML container . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 30\n4.2 Model . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 31\n4.3 Function deﬁnitions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 33\n4.4 Unit deﬁnitions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 35\n4.5 Compartment types . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 42\n4.6 Species types . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 43\n4.7 Compartments . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 44\n4.8 Species . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 47\n4.9 Parameters . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 51\n4.10 Initial assignments . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 53\n4.11 Rules . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 56\n4.12 Constraints . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 61\n4.13 Reactions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 63\n4.14 Events . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 77\n5 The Systems Biology Ontology and the sboTerm attribute 83\n5.1 Principles . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 83\n5.2 Using SBO and sboTerm . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 84\n5.3 Relationships to the SBML annotation element . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 89\n5.4 Discussion . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 89\n6 A standard format for the annotation element 91\n6.1 Motivation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 91\n6.2 XML namespaces in the standard annotation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 91\n6.3 General syntax for the standard annotation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 92\n6.4 Use of URIs . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 93\n6.5 Relation elements . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 94\n6.6 Model history . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 94\n6.7 Examples . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 96\n7 Example models expressed in XML using SBML 102\n7.1 A simple example application of SBML . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 102\n7.2 Example involving units . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 103\n7.3 Example of a discrete version of a simple dimerization reaction . . . . . . . . . . . . . . . . . . . . . . . . . . . 105\n7.4 Example involving assignment rules . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 107\n7.5 Example involving algebraic rules . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 109\n7.6 Example with combinations of boundaryCondition and constant values on Species with RateRule objects . . . . 111\n7.7 Example of translation from a multi-compartmental model to ODEs . . . . . . . . . . . . . . . . . . . . . . . . . . 112\n7.8 Example involving function deﬁnitions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 115\n7.9 Example involving delay functions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 116\n7.10 Example involving events . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 117\n7.11 Example involving two-dimensional compartments . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 119\n8 Discussion 124\n8.1 Future enhancements: SBML Level 3 and beyond . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 124\nAcknowledgments 126\nA XML Schema for SBML 127\nB XML Schema for MathML subset 136\nC Validation rules for SBML 140\nD A method for assessing whether an SBML model is overdetermined 153\nE Mathematical consequences of the fast attribute on Reaction 156\nF Processing and validating SBase notes and Constraint message content 158\nG Major changes between versions of SBML Level 2 and implications for backward compatibility 159\nG.1 Between Version 2 and Version 1 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 159\nG.2 Between Version 3 and Version 2 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 160\nReferences 162\n2\nNature Precedings : hdl:10101/npre.2007.58.1 : Posted 18 Jun 2007\n1 Introduction1\nWe present the Systems Biology Markup Language (SBML) Level 2 Version 3 Release 1 , a model repre-2\nsentation format for systems biology. SBML is oriented towards describing systems of biochemical reactions3\nof the sort common in research on a number of topics, including cell signaling pathways, metabolic path-4\nways, biochemical reactions, gene regulation, and many others. SBML is deﬁned in a neutral fashion with5\nrespect to programming languages and software encoding; however, it is primarily oriented towards allowing6\nmodels to be encoded using XML, the eXtensible Markup Language ( Bosak and Bray , 1999; Bray et al. ,7\n2000). This document contains many examples of SBML models written in XML, as well as the text of an8\nXML Schema ( Biron and Malhotra , 2000; Fallside, 2000; Thompson et al. , 2000) that deﬁnes SBML Level 29\nVersion 3 . A downloadable copy of the XML Schema and other related documents and software are also10\navailable from the SBML project web site, http://sbml.org/.11\nThe SBML project is not an attempt to deﬁne a universal language for representing quantitative models. The12\nrapidly evolving views of biological function, coupled with the vigorous rates at which new computational13\ntechniques and individual tools are being developed today, are incompatible with a one-size-ﬁts-all idea of a14\nuniversal language. A more realistic alternative is to acknowledge the diversity of approaches and methods15\nbeing explored by diﬀerent software tool developers, and seek a common intermediate format—a lingua16\nfranca—enabling communication of the most essential aspects of the models.17\nThe deﬁnition of the model description language presented here does not specify how programs should18\ncommunicate or read/write SBML. We assume that for a simulation program to communicate a model19\nencoded in SBML, the program will have to translate its internal data structures to and from SBML, use a20\nsuitable transmission medium and protocol, etc., but these issues are outside of the scope of this document.21\n1.1 Developments, discussions, and notiﬁcations of updates22\nSBML has been, and continues to be, developed in collaboration with an international community of re-23\nsearchers and software developers. As in many projects, the primary mode of interaction between members24\nis electronic mail. Discussions about SBML take place on the mailing list sbml-discuss@caltech.edu. The25\nmailing list archives and a web browser-based interface to the list are available at http://sbml.org/forums/.26\nA low-volume, broadcast-only mailing list is available where notiﬁcations of revisions to the SBML speci-27\nﬁcation, notices of votes on SBML technical issues, and other critical matters are announced. This list28\nis sbml-announce@caltech.edu and anyone may subscribe to it freely. This list will never be used for29\nadvertising and its membership list will never be disclosed. It is vitally important that all users of SBML30\nstay informed about new releases and other developments by subscribing to this list , even if they do not wish31\nto participate in discussions on the sbml-discuss@caltech.edu list. Please visit the SBML project web site,32\nhttp://sbml.org/, for information about how to subscribe to sbml-announce@caltech.edu as well as for33\naccess to the list archives.34\nIn Section 8.1, we attempt to acknowledge as many contributors to SBML’s development as we can, but as35\nSBML evolves, it becomes increasingly diﬃcult to detail the individual contributions on a project that has36\ntruly become an international community eﬀort.37\n1.2 SBML Levels, Versions, and Releases38\nMajor editions of SBML are termed levels and represent substantial changes to the composition and structure39\nof the language. The edition of SBML deﬁned in this document, SBML Level 2, represents an evolution40\nof the language resulting from the practical experiences of many users and developers working with SBML41\nLevel 1 since since its introduction in the year 2001 ( Hucka et al. , 2001, 2003). All of the constructs of42\nLevel 1 can be mapped to Level 2. In addition, a subset of Level 2 constructs can be mapped to Level 1.43\nHowever, the levels remain distinct; a valid SBML Level 1 document is not a valid SBML Level 2 document,44\nand likewise, a valid SBML Level 2 document is not a valid SBML Level 1 document.45\nMinor revisions of SBML are termed versions and constitute changes within a Level to correct, adjust, and46\nreﬁne language features. The present document deﬁnes SBML Level 2 Version 3. In Section 1.4.1 below47\n3\nNature Precedings : hdl:10101/npre.2007.58.1 : Posted 18 Jun 2007\nexplains how color is used in this document to indicate changes; a separate document provides a detailed1\nlisting of the changes between versions of SBML Level 2 as well as between SBML Level 2 Version 3 and2\nSBML Level 1 Version 2.3\nSpeciﬁcation documents inevitably require minor editorial changes as its users discover errors and ambi-4\nguities. As a practical reality, these discoveries occur over time. In the context of SBML, such problems5\nare formally announced publicly as errata in a given speciﬁcation document. Borrowing concepts from the6\nWorld Wide Web Consortium ( Jacobs, 2004), we deﬁne SBML errata as changes of the following types:7\n(a) formatting changes that do not result in changes to textual content; (b) corrections that do not aﬀect8\nconformance of software implementing support for a given combination of SBML Level and Version; and (c)9\ncorrections that may aﬀect such software conformance, but add no new language features. A change that10\naﬀects conformance is one that either turns conforming data, processors, or other conforming software into11\nnon-conforming software, or turns non-conforming software into conforming software, or clears up an ambi-12\nguity or insuﬃciently documented part of the speciﬁcation in such a way that software whose conformance13\nwas once unclear now becomes clearly conforming or non-conforming ( Jacobs, 2004). In short, errata do not14\nchange the fundamental semantics or syntax of SBML; they clarify and disambiguate the speciﬁcation and15\ncorrect errors. (New syntax and semantics are only introduced in SBML Versions and Levels.) An electronic16\ntracking system for reporting and monitoring such issues is available at http://sbml.org/issue-tracker.17\nSBML errata result in new Releases of the SBML speciﬁcation. Each release is numbered with an integer,18\nwith the ﬁrst release of the speciﬁcation being called release number 1. Subsequent releases of an SBML19\nspeciﬁcation document contain a section listing the accumulated errata reported and corrected since the20\nﬁrst release. A complete list of the errata for SBML Level 2 Version 3 since the publication of Release 121\nis also made publicly available at http://sbml.org/specifications/sbml-level-2/version-3/errata/ .22\nAnnouncements of errata, releases of the SBML speciﬁcation and other major changes are made on the23\nsbml-announce@caltech.edu mailing list.24\n1.3 Language features and backward compatibility25\nSome language features of previous SBML Levels and Versions have been either deprecated or removed26\nentirely in SBML Level 2 Version 3 . For the purposes of SBML speciﬁcations, the following are the deﬁnitions27\nof deprecated feature and removed feature:28\nRemoved language feature : A syntactic construct that was present in previous SBML Levels and/or Versions29\nwithin a Level, and has been removed beginning with a speciﬁc SBML Level and Version. Models30\ncontaining such constructs do not conform to the speciﬁcation of that SBML Level and Version.31\nDeprecated language feature : A syntactic construct that was present in previous SBML Levels and/or32\nVersions within a Level, and while still present in the language deﬁnition, has been identiﬁed as non-33\nessential and planned for future removal. Beginning with the Level and Version in which a given34\nfeature is deprecated, software tools should not generate SBML models containing the deprecated35\nfeature; however, for backward compatibility, software tools reading SBML should support the feature36\nuntil it is actually removed.37\nAs a matter of SBML design philosophy, the preferred approach to removing features is by deprecating them38\nif possible. Immediate removal of SBML features is not done unless serious problems have been discovered39\ninvolving those features, and keeping them would create logical inconsistencies or extremely diﬃcult-to-40\nresolve problems. The deprecation or outright removal of features in a language, whether SBML or other,41\ncan have signiﬁcant impact on backwards compatibility. Such changes are also inevitable over the course42\nof a language’s evolution. SBML must by necessity continue evolving through the experiences of its users43\nand implementors. Eventually, some features will be deemed unhelpful despite the best intentions of the44\nlanguage editors to design a timeless language.45\nThroughout the SBML speciﬁcation, removed and deprecated features are discussed in the text of the sections46\nwhere the features previously appeared. Appendix G lists the changes and describes their motivations in47\nmore detail.48\n4\nNature Precedings : hdl:10101/npre.2007.58.1 : Posted 18 Jun 2007\n1.4 Document conventions1\nIn this section, we describe the conventions we use in this speciﬁcation document in an eﬀort to communicate2\ninformation more eﬀectively and consistently.3\n1.4.1 Color conventions4\nThroughout this document, we use coloring to carry additional information for the beneﬁt of those viewing5\nthe document on media that can display color:6\n• We use red color in text and ﬁgures to indicate changes between this version of the speciﬁcation (Level 27\nVersion 3 Release 1) and the most recent previous version of the speciﬁcation (which, for the present8\ncase, is SBML Level 2 Version 2 Release 1). The changes may be either additions or deletions of text;9\nin the case of deletions, entire sentences, paragraphs or sections are colored to indicate a change has10\noccurred inside them.11\n• We use blue color in text to indicate a hyperlink from one point in this document to another. Clicking12\nyour computer’s pointing device on blue-colored text will cause a jump to the section, ﬁgure, table or13\npage to which the link refers. (Of course, this capability is only available when using electronic formats14\nthat support hyperlinking, such as PDF and HTML.)15\n1.4.2 Typographical conventions for names16\nThe following typographical notations are used in this document to distinguish objects and data types from17\nother kinds of entities:18\nAbstractClass: Abstract classes are classes that are never instantiated directly, but rather serve as parents of19\nother classes. Their names begin with a capital letter and they are printed in a slanted, bold, sans-serif20\ntypeface. In electronic document formats, the class names are also hyperlinked to their deﬁnitions in21\nthe speciﬁcation. For example, in the PDF and HTML versions of this document, clicking on the word22\nSbase will send the reader to the section containing the deﬁnition of this class.23\nClass: Names of ordinary (concrete) classes begin with a capital letter and are printed in an upright,24\nbold, sans-serif typeface. In electronic document formats, the class names are also hyperlinked to their25\ndeﬁnitions in the speciﬁcation. For example, in the PDF and HTML versions of this document, clicking26\non the word Species will send the reader to the section containing the deﬁnition of this class.27\nSomeThing, otherThing: Attributes of classes, data type names, literal XML, and generally all tokens other28\nthan SBML UML class names, are printed in an upright typewriter typeface. Primitive types deﬁned by29\nSBML begin with a capital letter, but unfortunately, XML Schema 1.0 does not follow any convention30\nand primitive XML types may either start with a capital letter (e.g,. ID) or not (e.g., double).31\n1.4.3 UML notation32\nPrevious speciﬁcations of SBML used a notation that was at one time (in the days of SBML Level 1) fairly33\nclose to UML, the Uniﬁed Modeling Language ( Eriksson and Penker , 1998; Oestereich, 1999), though many34\ndetails were omitted from the UML diagrams themselves. Over the years, the notation used in successive35\nspeciﬁcations of SBML grew increasingly less UML-like. Beginning with SBML Level 2 Version 3, we have36\ncompletely overhauled the speciﬁcation’s use of UML and once again deﬁne the XML syntax of SBML using,37\nas much as possible, proper and complete UML 1.0. We then systematically map this UML notation to XML,38\nusing XML Schema 1.0 ( Biron and Malhotra , 2000; Fallside, 2000; Thompson et al. , 2000) to express the39\noverall syntax of SBML. In the rest of this section, we summarize the UML notation used in this document40\nand explain the few embellishments needed to support transformation to XML form. A complete Schema41\nfor SBML is given in Appendix A.42\nWe see three main advantages to using UML as a basis for deﬁning SBML data objects. First, compared43\nto using other notations or a programming language, the UML visual representations are generally easier44\nto grasp by readers who are not computer scientists. Second, the notation is implementation-neutral: the45\n5\nNature Precedings : hdl:10101/npre.2007.58.1 : Posted 18 Jun 2007\nobjects can be encoded in any concrete implementation language—not just XML, but C, Java and other1\nlanguages as well. Third, UML is a de facto industry standard that is documented in many resources.2\nReaders are therefore more likely to be familiar with it than other notations.3\nObject class deﬁnitions4\nObject classes in UML diagrams are drawn as simple tripartite boxes, as shown in Figure 1 (left). UML5\nallows for operations as well as data attributes to be deﬁned, but SBML only uses data attributes, so all6\nSBML class diagrams use only the top two portions of a UML class box (see the right-hand diagram of7\nFigure 1).8\nClass Name\nattributes\noperators\nExampleClass\nattribute: int\nanotherAttribute: double\nFigure 1: (Left) The general form of a UML class diagram. (Right) Example of a class diagram of the sort seen in SBML.\nSBML classes never use operators, so SBML class diagrams only show the top two parts.\nAs mentioned above, the names of ordinary (concrete) classes begin with a capital letter and are printed in9\nan upright, bold, sans-serif typeface. The names of attributes begin with a lower-case letter and generally10\nuse a mixed case (sometimes called “camel case”) style when the name consists of multiple words. Attributes11\nand their data types appear in the part below the class name, with one attribute deﬁned per line. The colon12\ncharacter on each line separates the name of the attribute (on the left) from the type of data that it stores13\n(on the right). The subset of data types permitted for SBML attributes is given in Section 3.1.14\nIn the right-hand diagram of Figure 1, the symbols attribute and anotherAttribute represent attributes of15\nthe object class ExampleClass. The data type of attribute is int, and the data type of anotherAttribute is16\ndouble. In the scheme used by SBML for translating UML to XML, object attributes map directly to XML17\nattributes. Thus, in XML, ExampleClass would yield an element of the form <element attribute=\"42\"18\nanotherAttribute=\"10.0\">.19\nNotice that the element name is not <ExampleClass ...>. Somewhat paradoxically, the name of the element20\nis not the name of the UML class deﬁning its structure. The reason for this may be subtle at ﬁrst, but quickly21\nbecomes obvious: object classes deﬁne the form of an object’s content, but a class deﬁnition by itself does22\nnot deﬁne the label or symbol referring to an instance of that content. It is this label that becomes the name23\nof the XML element. In XML, this symbol is most naturally equated with an element name. This point will24\nhopefully become more clear with additional examples below.25\nSubelements26\nWe use UML composite aggregation to indicate a class object can have other class objects as parts. Such27\ncontainment hierarchies map directly to element-subelement relationships in XML. Figure 2 gives an example.28\nWhole\nA: int\nB: string\nPart\nC: double\ninside\nFigure 2: Example illustrating composite aggregation: the deﬁnition of one class of objects employing another class of\nobjects in a part-whole relationship. In this particular example, an instance of a Whole class object must contain exactly\none instance of a Part class object, and the symbol referring to the Part class object is inside. In XML, this symbol\nbecomes the name of a subelement and the content of the subelement follows the deﬁnition of Part.\nThe line with the black diamond indicates composite aggregation, with the diamond located on the “con-29\ntainer” side and the other end located at the object class being contained. The label on the line is the30\nsymbol used to refer to instances of the contained object, which in XML, maps directly to the name of an31\n6\nNature Precedings : hdl:10101/npre.2007.58.1 : Posted 18 Jun 2007\nXML element. The class pointed to by the aggregation relationship ( Part in Figure 2) deﬁnes the contents1\nof that element. Thus, if we are told that some element named barney is of class Whole, the following is an2\nexample XML fragment consistent with the class deﬁnition of Figure 2:3\n<barney A=\"110\" B=\"some string\">4\n<inside C=\"444.4\">5\n</barney>6\nSometimes numbers are placed above the line near the “contained” side of an aggregation to indicate how7\nmany instances can be contained. The common cases in SBML are the following: [0..*] to signify a list8\ncontaining zero or more; [1..*] to signify a list containing at least one; and [0..1] to signify exactly9\nzero or one. The absence of a numerical label means “exactly 1”. This notation appears throughout this10\nspeciﬁcation document.11\nInheritance12\nParent\nA: int\nB: boolean\nChild\nC: int\nD: string\nFigure 3: Inheritance.\nClasses can inherit properties from other classes. Since SBML only uses13\ndata attributes and not operations, inheritance in SBML simply involves14\ndata attributes from a parent class being inherited by child classes. Inheri-15\ntance is indicated by a line between two classes, with an open triangle next16\nto the parent class; Figure 3 illustrates this. In this example, the instances17\nof object class Child would have not only attributes C and D, but also at-18\ntributes A and B. All of these attributes would be required (not optional)19\non instances of class Child because they are mandatory on both Parent and20\nChild.21\nAdditional notations for XML purposes22\nNot everything is easily expressed in plain UML. For example, it is often necessary to indicate some con-23\nstraints placed on the values of an attribute. In computer programming uses of UML, such constraints are24\noften expressed using Object Constraint Language (OCL), but since we are most interested in the XML ren-25\ndition of SBML, in this speciﬁcation we use XML Schema 1.0 (when possible) as the language for expressing26\nvalue constraints. Constraints on the values of attributes are written as expressions surrounded by braces27\n({ }) after the data type declaration, as in the example of Figure 4.28\nSBase\nSbml\nlevel: positiveInteger { use=”required” ﬁxed=”2”}\nversion: positiveInteger { use=”required” ﬁxed=”3”}\nModelmodel\nFigure 4: A more complex example deﬁnition drawing on the concepts introduced so far in this section. Both Sbml and\nModel are derived from SBase; further, Sbml contains a single Model object named model. Note the constraints on\nthe values of the attributes in Sbml; they are enclosed in braces and written in XML Schema language. The particular\nconstraints here state that both the level and version attributes must be present, and that the values are ﬁxed as\nindicated.\nIn other situations, when something cannot be concisely expressed using a few words of XML Schema, we29\nwrite constraints using English language descriptions surrounded by braces ( { }). To help distinguish these30\nfrom literal XML Schema, we set the English text in a slanted typeface. The text accompanying all SBML31\ncomponent deﬁnitions provides explanations of the constraints and any other conditions applicable to the32\nuse of the components.33\n7\nNature Precedings : hdl:10101/npre.2007.58.1 : Posted 18 Jun 2007\nCompatibility issues and warnings1\nOne important and confusing point that goes against the grain of XML must be highlighted: the order2\nin which subelements appear within SBML elements is signiﬁcant and must follow the order given in the3\ncorresponding object deﬁnition. This ordering is also diﬃcult to express in plain UML, so we resort to4\nusing the approach of stating ordering requirements as constraints written in English and (again) enclosed5\nin braces ( { }). Figure 8 on page 14 gives an example of this.6\nThe ordering restriction also holds true when a subclass inherits attributes and elements from a base class:7\nthe base class attributes and elements must occur before those introduced by the subclass.8\nThis ordering constraint stems from aspects of XML Schema beyond our control (speciﬁcally, the need to9\nuse XML Schema’s sequence construct to deﬁne the object classes). It is an occasional source of software10\ncompatibility problems, because validating XML parsers will generate errors if the ordering within an XML11\nelement does not correspond to the SBML object class deﬁnition.12\n8\nNature Precedings : hdl:10101/npre.2007.58.1 : Posted 18 Jun 2007\n2 Overview of SBML1\nThe following is an example of a simple network of biochemical reactions that can be represented in SBML:2\nS1\nk1[S1]/([S1]+k2)\n− − − − − − − − − − − − →S2\nS2\nk3[S2]\n− − − − − − − − − − − − →S3 + S4\n3\nIn this particular set of chemical equations above, the symbols in square brackets (e.g., “[ S1]”) represent4\nconcentrations of molecular species, the arrows represent reactions, and the formulas above the arrows5\nrepresent the rates at which the reactions take place. (And while this example uses concentrations, it6\ncould equally have used other measures such as molecular counts.) Broken down into its constituents, this7\nmodel contains a number of components: reactant species, product species, reactions, reaction rates, and8\nparameters in the rate expressions. To analyze or simulate this network, additional components must be9\nmade explicit, including compartments for the species, and units on the various quantities.10\nSBML allows models of arbitrary complexity to be represented. Each type of component in a model is11\ndescribed using a speciﬁc type of data object that organizes the relevant information. The top level of an12\nSBML model deﬁnition consists of lists of these components, with every list being optional:13\n14 beginning of model deﬁnition\n15 list of function deﬁnitions (optional) (Section 4.3)\n16 list of unit deﬁnitions (optional) (Section 4.4)\n17 list of compartment types (optional) (Section 4.5)\n18 list of species types (optional) (Section 4.6)\n19 list of compartments (optional) (Section 4.7)\n20 list of species (optional) (Section 4.8)\n21 list of parameters (optional) (Section 4.9)\n22 list of initial assignments (optional) (Section 4.10)\n23 list of rules (optional) (Section 4.11)\n24 list of constraints (optional) (Section 4.12)\n25 list of reactions (optional) (Section 4.13)\n26 list of events (optional) (Section 4.14)\n27 end of model deﬁnition\nThe meaning of each component is as follows:28\nFunction deﬁnition : A named mathematical function that may be used throughout the rest of a model.29\nUnit deﬁnition : A named deﬁnition of a new unit of measurement, or a redeﬁnition of an existing SBML30\ndefault unit. Named units can be used in the expression of quantities in a model.31\nCompartment Type: A type of location where reacting entities such as chemical substances may be located.32\nSpecies type : A type of entity that can participate in reactions. Typical examples of species types include33\nions such as Ca 2+, molecules such as glucose or ATP, and more.34\nCompartment: A well-stirred container of a particular type and ﬁnite size where species may be located. A35\nmodel may contain multiple compartments of the same compartment type. Every species in a model36\nmust be located in a compartment.37\nSpecies: A pool of entities of the same species type located in a speciﬁc compartment.38\nParameter: A quantity with a symbolic name. In SBML, the term parameter is used in a generic sense39\nto refer to named quantities regardless of whether they are constants or variables in a model. SBML40\nLevel 2 provides the ability to deﬁne parameters that are global to a model as well as parameters that41\nare local to a single reaction.42\n9\nNature Precedings : hdl:10101/npre.2007.58.1 : Posted 18 Jun 2007\nInitial Assignment : A mathematical expression used to determine the initial conditions of a model. This1\ntype of object can only be used to deﬁne how the value of a variable can be calculated from other2\nvalues and variables at the start of simulated time.3\nRule: A mathematical expression added to the set of equations constructed based on the reactions deﬁned4\nin a model. Rules can be used to deﬁne how a variable’s value can be calculated from other variables,5\nor used to deﬁne the rate of change of a variable. The set of rules in a model can be used with the6\nreaction rate equations to determine the behavior of the model with respect to time. The set of rules7\nconstrains the model for the entire duration of simulated time.8\nConstraint: A means of detecting out-of-bounds conditions during a dynamical simulation and optionally9\nissuing diagnostic messages. Constraints are deﬁned by an arbitrary mathematical expression comput-10\ning a true/false value from model variables, parameters and constants. An SBML constraint applies at11\nall instants of simulated time; however, the set of constraints in model should not be used to determine12\nthe behavior of the model with respect to time.13\nReaction: A statement describing some transformation, transport or binding process that can change the14\namount of one or more species. For example, a reaction may describe how certain entities (reactants) are15\ntransformed into certain other entities (products). Reactions have associated kinetic rate expressions16\ndescribing how quickly they take place.17\nEvent: A statement describing an instantaneous, discontinuous change in a set of variables of any type18\n(species quantity, compartment size or parameter value) when a triggering condition is satisﬁed.19\nA software package can read an SBML model description and translate it into its own internal format for20\nmodel analysis. For example, a package might provide the ability to simulate the model by constructing21\ndiﬀerential equations representing the network and then perform numerical time integration on the equations22\nto explore the model’s dynamic behavior. By supporting SBML as an input and output format, diﬀerent23\nsoftware tools can all operate on an identical external representation of a model, removing opportunities for24\nerrors in translation and assuring a common starting point for analyses and simulations.25\n10\nNature Precedings : hdl:10101/npre.2007.58.1 : Posted 18 Jun 2007\n3 Preliminary deﬁnitions and principles1\nThis section covers certain concepts and constructs that are used repeatedly in the rest of SBML Level 2.2\n3.1 Primitive data types3\nMost primitive types in SBML are taken from the data types deﬁned in XML Schema 1.0 ( Biron and4\nMalhotra, 2000; Fallside, 2000; Thompson et al. , 2000). A few other primitive types are deﬁned by SBML5\nitself. What follows is a summary of the XML Schema types and the deﬁnitions of the SBML-speciﬁc types.6\nNote that while we have tried to provide accurate and complete summaries of the XML Schema types, the7\nfollowing should not be taken to be normative deﬁnitions of these types. Readers should consult the XML8\nSchema 1.0 speciﬁcation for the normative deﬁnitions of the XML types used by SBML.9\n3.1.1 Type string10\nThe XML Schema 1.0 type string is used to represent ﬁnite-length strings of characters. The characters11\npermitted to appear in XML Schema string include all Unicode characters ( Unicode Consortium , 1996)12\nexcept for two delimiter characters, 0xFFFE and 0xFFFF ( Biron and Malhotra , 2000). In addition, the13\nfollowing quoting rules speciﬁed by XML for character data ( Bray et al. , 2000) must be obeyed:14\n• The ampersand ( &) character must be escaped using the entity &amp;.15\n• The apostrophe ( ’) and quotation mark ( \") characters must be escaped using the entities &apos; and16\n&quot;, respectively, when those characters are used to delimit a string attribute value.17\nOther XML built-in character or entity references, e.g., &lt; and &x1A;, are permitted in strings.18\n3.1.2 Type boolean19\nThe XML Schema 1.0 type boolean is used as the data type for SBML object attributes that represent20\nbinary true/false values. XML Schema 1.0 deﬁnes the possible literal values of boolean as the following:21\n“true”, “ false”, “ 1”, and “ 0”. The value “ 1” maps to “ true” and the value “ 0” maps to “ false”.22\nNote that there is a discrepancy between the value spaces of type boolean as deﬁned by XML Schema 1.023\nand MathML: the latter uses only “ true” and “ false” to represent boolean values and “ 0” and “ 1” are24\ninterpreted as numbers. Software tools should take care to not to use “ 0” and “ 1” as boolean values in25\nMathML expressions. See further discussion in Section 3.4.4.26\n3.1.3 Type int27\nThe XML Schema 1.0 type int is used to represent decimal integer numbers in SBML. The literal represen-28\ntation of an int is a ﬁnite-length sequence of decimal digit characters with an optional leading sign (“ +” or29\n“-”). If the sign is omitted, “ +” is assumed. The value space of int is the same as a standard 32-bit signed30\ninteger in programming languages such as C, i.e., 2147483647 to −2147483648.31\n3.1.4 Type positiveInteger32\nThe XML Schema 1.0 type positiveInteger is used to represent nonzero, nonnegative, decimal integers:33\ni.e., 1, 2, 3, . . . . The literal representation of an integer is a ﬁnite-length sequence of decimal digit characters,34\noptionally preceded by a positive sign (“ +”). There is no restriction on the absolute size of positiveInteger35\nvalues in XML Schema; however, the only situations where this type is used in SBML involve very low-36\nnumbered integers. Consequently, applications may safely treat positiveInteger as unsigned 32-bit integers.37\n3.1.5 Type double38\nThe XML Schema 1.0 type double is the data type of ﬂoating point numerical quantities in SBML . It is39\nrestricted to IEEE double-precision 64-bit ﬂoating point type IEEE 754-1985. The value space of double40\nconsists of (a) the numerical values m × 2x, where m is an integer whose absolute value is less than 2 53,41\n11\nNature Precedings : hdl:10101/npre.2007.58.1 : Posted 18 Jun 2007\nand x is an integer between -1075 and 970, inclusive, (b) the special value positive inﬁnity ( INF), (c) the1\nspecial value negative inﬁnity ( -INF), and (d) the special value not-a-number ( NaN). The order relation on2\nthe values is the following: x < y if and only if y − x is positive for values of x and y in the value space of3\ndouble. Positive inﬁnity is greater than all other values other than NaN. NaN is equal to itself but is neither4\ngreater nor less than any other value in the value space. (Software implementors should consult the XML5\nSchema 1.0 deﬁnition of double for additional details about equality and relationships to IEEE 754-1985.)6\nThe general form of double numbers is “ xey”, where x is a decimal number (the mantissa), “ e” is a separator7\ncharacter, and y is an exponent; the meaning of this is “ x multiplied by 10 raised to the power of y”, i.e.,8\nx × 10y. More precisely, a double value consists of a mantissa with an optional leading sign (“ +” or “ -”),9\noptionally followed by the character E or e followed by an integer (the exponent). The mantissa must be a10\ndecimal number: an integer optionally followed by a period ( .) optionally followed by another integer. If the11\nleading sign is omitted, “ +” is assumed. An omitted E or e and exponent means that a value of 0 is assumed12\nfor the exponent. If the E or e is present, it must be followed by an integer or an error results. The integer13\nacting as an exponent must consist of a decimal number optionally preceded by a leading sign (“ +” or “ -”).14\nIf the sign is omitted, “ +” is assumed. The following are examples of legal literal double values:15\n-1E4, +4, 234.234e3, 6.02E-23, 0.3e+11, 2, 0, -0, INF, -INF, NaN16\nAs described in Section 3.4, SBML uses a subset of the MathML 2.0 standard ( W3C, 2000b) for expressing17\nmathematical formulas in XML. This is done by stipulating that the MathML language be used whenever18\na mathematical formula must be written into an SBML model. Doing this, however, requires facing two19\nproblems: ﬁrst, the syntax of numbers in scientiﬁc notation (“e-notation”) is diﬀerent in MathML from that20\njust described for double, and second, the value space of integers and ﬂoating-point numbers in MathML21\nis not deﬁned in the same way as in XML Schema 1.0. We elaborate on these issues in Section 3.4.2; here22\nwe summarize the solution taken in SBML. First, within MathML, the mantissa and exponent of numbers23\nin “e-notation” format must be separated by one <sep/> element. This leads to numbers of the form <cn24\ntype=\"e-notation\"> 2 <sep/> -5 </cn>. Second, SBML stipulates that the representation of numbers in25\nMathML expressions obey the same restrictions on values as deﬁned for types double and int (Section 3.1.3).26\n3.1.6 Type ID27\nThe XML Schema 1.0 type ID is identical to the XML 1.0 type ID. The literal representation of this type28\nconsists of strings of characters restricted as summarized in Figure 5.29\n30 NCNameChar ::= letter | digit | ’.’ | ’-’ | ’ ’ | ’:’ | CombiningChar | Extender\n31 ID ::= ( letter | ’ ’ | ’:’ ) NCNameChar*\nFigure 5: Type ID expressed in the variant of BNF used by the XML 1.0 speciﬁcation ( Bray et al. , 2004). The characters\n( and ) are used for grouping, the character * indicates “zero or more times”, and the character | indicates “or”. The\nproduction letter consists of the basic upper and lower case alphabetic characters of the Latin alphabet along with a\nlarge number of related characters deﬁned by Unicode 2.0; similarly, the production digit consists of the numerals 0..9\nalong with related Unicode 2.0 characters. The CombiningChar production is a list of characters that add such things\nas accents to the preceding character. (For example, the Unicode character #x030A when combined with ‘a’ produces\n‘˚a’.) The Extender production is a list of characters that extend the shape of the preceding character. Please consult the\nXML 1.0 speciﬁcation ( Bray et al. , 2004) for the complete deﬁnitions of letter, digit, CombiningChar, and Extender.\nIn SBML, type ID is the data type of the metaid attribute on Sbase, described in Section 3.2. An important32\naspect of ID is the XML requirement that a given value of ID must be unique throughout an XML document.33\nAll data values of type ID are considered to reside in a single common global namespace spanning the entire34\nXML document, regardless of the attribute where type ID is used and regardless of the level of nesting of35\nthe objects (or XML elements).36\n3.1.7 Type SId37\nThe type SId is the type of the id attribute found on the majority of SBML components. SId is a data38\ntype derived from the basic XML type string, but with restrictions about the characters permitted and the39\nsequences in which those characters may appear. The deﬁnition is shown in Figure 6 on the next page.40\n12\nNature Precedings : hdl:10101/npre.2007.58.1 : Posted 18 Jun 2007\n1 letter ::= ’a’..’z’,’A’..’Z’\n2 digit ::= ’0’..’9’\n3 idChar ::= letter | digit | ’ ’\n4 SId ::= ( letter | ’ ’ ) idChar*\nFigure 6: The deﬁnition of the type SId. (Please see the caption of Figure 5 for an explanation of the notation.)\nThe equality of SId values is determined by an exact character sequence match; i.e., comparisons of these5\nidentiﬁers must be performed in a case-sensitive manner. This applies to all uses of SId.6\nThe SId is purposefully not derived from the XML ID type (Section 3.1.6). Using XML’s ID would force all7\nSBML identiﬁers to exist in a single global namespace, which would aﬀect not only the form of local parameter8\ndeﬁnitions but also future SBML extensions for supporting model/submodel composition. Further, the use9\nof the ID type for SBML identiﬁers would have limited utility because MathML 2.0 ci elements are not of10\nthe type IDREF (see Section 3.4). Since the IDREF/ID linkage cannot be exploited in MathML constructs, the11\nutility of the XML ID type is greatly reduced. Finally, unlike ID, SId does not include Unicode character12\ncodes; the identiﬁers are plain text.13\n3.1.8 Type UnitSId14\nThe type UnitSId is derived from SId (Section 3.1.7) and has identical syntax. The UnitSId type is used as15\nthe data type for the identiﬁers of units (Section 4.4.1) and for references to unit identiﬁers in SBML objects.16\nThe purpose of having a separate data type for such identiﬁers is enable the space of possible unit identiﬁer17\nvalues to be separated from the space of all other identiﬁer values in SBML. The equality of UnitSId values18\nis determined by an exact character sequence match; i.e., comparisons of these identiﬁers must be performed19\nin a case-sensitive manner.20\nA number of reserved symbols are deﬁned in the space of values of UnitSId. These reserved symbols are the21\nlist of base unit names deﬁned in Table 1 on page 37, and the SBML built-in units “ substance”, “ volume”,22\n“area”, “ length”, and “ time” listed in Table 2 on page 41. These symbols and their use is described in23\nSection 4.4.24\n3.1.9 Type SBOTerm25\nThe type SBOTerm is used as the data type of the attribute sboTerm on Sbase. The type consists of strings26\nof characters matching the restricted pattern described in Figure 7.27\n28 digit ::= ’0’..’9’\n29 SBOTerm ::= ’SBO:’ digit digit digit digit digit digit digit\nFigure 7: The deﬁnition of SBOTerm. The SBOTerm type consists of strings beginning with SBO: and followed by seven\ndecimal digits. (Please see the caption of Figure 5 for an explanation of the notation.)\nExamples of valid string values of type SBOTerm are “ SBO:0000014” and “ SBO:0003204”. These values are30\nmeant to be the identiﬁers of terms from an ontology whose vocabulary describes entities and processes in31\ncomputational models. Section 5 provides more information about the ontology and principles for the use32\nof these terms in SBML models.33\n3.2 Type SBase34\nNearly every object composing an SBML Level 2 model deﬁnition has a speciﬁc data type that is derived35\ndirectly or indirectly from a single abstract type called Sbase. In addition to serving as the parent class for36\nmost other classes of objects in SBML, this base type is designed to allow a modeler or a software package37\nto attach arbitrary information to each major element or list in an SBML model. The deﬁnition of Sbase is38\npresented in Figure 8 on the following page.39\nSbase contains two attributes and two subelements , all of which are optional: metaid, sboTerm, notes and40\nannotation. These are discussed separately in the following subsections.41\n13\nNature Precedings : hdl:10101/npre.2007.58.1 : Posted 18 Jun 2007\nSbase\nmetaid: ID  { use=\"optional\" }\nsboTerm: SBOTerm  { use=\"optional\" }\nNotes\nxmlns: string  { \"http://www.w3.org/1999/xhtml\" }\n{ Almost any well-formed content permitted in XHTML, \nsubject to a few restrictions; see text. }\nAnnotation\n{ Any well-formed XML content, and with each top-level \n element placed in a unique XML namespace; see text. }\nnotes\nannotation\n0..1\n0..1\n{ Order is significant. }\nFigure 8: The deﬁnition of Sbase. Please refer to Section 1.4 for a summary of the UML notation used here. Note that the\norder of appearance of subelements notes and annotation is signiﬁcant in instances of objects derived from SBase:\nnotes must always come before annotation. (This requirement arises from XML Schema 1.0.)\n3.2.1 The metaid attribute1\nThe metaid attribute is present for supporting metadata annotations using RDF (Resource Description2\nFormat; Lassila and Swick , 1999). It has a data type of XML ID (the XML identiﬁer type ; see Section 3.1.6),3\nwhich means each metaid value must be globally unique within an SBML ﬁle. The metaid value serves to4\nidentify a model component for purposes such as referencing that component from metadata placed within5\nannotation elements (see Section 3.2.4). Such metadata can use RDF description elements, in which an6\nRDF attribute called “rdf:about” points to the metaid identiﬁer of an object deﬁned in the SBML model.7\nThis topic is discussed in greater detail in Section 6.8\n3.2.2 The sboTerm attribute9\nThe attribute called sboTerm is provided on Sbase to support the use of the Systems Biology Ontology10\n(SBO; see Section 5). When a value is given to this attribute, it must conform to the data type SBOTerm11\n(Sections 3.1.9). SBO terms are a type of optional annotation, and each diﬀerent class of SBML object12\nderived from Sbase imposes its own requirements about the values permitted for sboTerm. Speciﬁc details13\non the permitted values are provided with the deﬁnitions of SBML classes throughout this speciﬁcation14\ndocument, and a broader discussion is provided in Section 5.15\n3.2.3 The notes element16\nThe element notes in Sbase is a container for XHTML 1.0 ( Pemberton et al. , 2002) content. It is intended17\nto serve as a place for storing optional information intended to be seen by humans. An example use of the18\nnotes element would be to contain formatted user comments about the model element in which the notes19\nelement is enclosed. Every object derived directly or indirectly from type Sbase can have a separate value20\nfor notes, allowing users considerable freedom when adding comments to their models.21\nXHTML 1.0 is simply a formulation of HTML 4 in XML 1.0. This means the full power of HTML formatting22\nis available for use in notes content. The intention behind requiring XHTML (rather than, for example,23\nplain HTML or plain text) for notes content is to balance several conﬂicting goals: (1) choosing a format24\nfor notes that is compatible with the XML form of SBML (plain HTML would not be); (2) supporting25\nan international formatting standard so that users have more control over the appearance of notes and26\ncan predict to some degree how their notes will be displayed in diﬀerent tools and environments (which27\nargues against using plain-text notes); and (3) achieving these goals using an approach that is hopefully easy28\nenough for software developers to support using oﬀ-the-shelf programming libraries. It is worth noting in29\npassing that the requirement for XHTML does not prevent users from entering plain-text content with simple30\nspace/tab/newline formatting: it merely requires using the standard <pre>...</pre> element of (X)HTML.31\n14\nNature Precedings : hdl:10101/npre.2007.58.1 : Posted 18 Jun 2007\nModern libraries for displaying and editing (X)HTML content are commonly available in contemporary1\nsoftware programming environments, and software developers may wish to avail themselves of these facilities2\nrather than implementing their own XHTML support systems.3\nXML namespace requirements for notes4\nThe XML content of notes elements must declare the use of the XHTML XML namespace. This can be5\ndone in multiple ways. One way is to place a namespace declaration for the appropriate namespace URI6\n(which is http://www.w3.org/1999/xhtml) on the top-level Sbml object (see Section 4.1) and then reference7\nthe namespace in the notes content using a preﬁx. The following example illustrates this approach:8\n<sbml xmlns=\"http://www.sbml.org/sbml/level2/version2\" level=\"2\" version=\"3\"9\nxmlns:xhtml=\"http://www.w3.org/1999/xhtml\">10\n...11\n<notes>12\n<xhtml:body>13\n<xhtml:center><xhtml:h2>A Simple Mitotic Oscillator</xhtml:h2></xhtml:center>14\n<xhtml:p>A minimal cascade model for the mitotic oscillator15\ninvolving cyclin and cdc2 kinase</xhtml:p>16\n</xhtml:body>17\n</notes>18\n...19\nAnother approach is to declare the XHTML namespace within the notes content itself, as in the following20\nexample:21\n...22\n<notes>23\n<body xmlns=\"http://www.w3.org/1999/xhtml\">24\n<center><h2>A Simple Mitotic Oscillator</h2></center>25\n<p>A minimal cascade model for the mitotic oscillator26\ninvolving cyclin and cdc2 kinase</p>27\n</body>28\n</notes>29\n...30\nThe xmlns=\"http://www.w3.org/1999/xhtml\" declaration on body as shown above changes the default XML31\nnamespace within it, such that all of its content is by default in the XHTML namespace. This is a particularly32\nconvenient approach because it obviates the need to preﬁx every element with a namespace preﬁx ( i.e., xhtml:33\nin the previous case). Other approaches are also possible.34\nThe content of notes35\nSBML does not require the content of notes to be any particular XHTML element; the content can be36\nalmost any well-formed XHTML content. There are only two simple restrictions. The ﬁrst restriction comes37\nfrom the requirements of XML: the notes element must not contain an XML declaration nor a DOCTYPE38\ndeclaration. That is, notes must not contain39\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>40\nnor (where the following is only one speciﬁc example of a DOCTYPE declaration)41\n<!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Strict//EN\"42\n\"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd\">43\nThe second restriction is intended to balance freedom of content with the complexity of implementing software44\nthat can interpret the content. The content of notes in SBML can consist only of the following possibilities:45\n1. A complete XHTML document (minus the XML and DOCTYPE declarations, of course), that is,46\nXHTML content beginning with the html tag. The following is an example skeleton:47\n15\nNature Precedings : hdl:10101/npre.2007.58.1 : Posted 18 Jun 2007\n<notes>1\n<html xmlns=\"http://www.w3.org/1999/xhtml\">2\n...3\n</html>4\n</notes>5\n2. The body element from an XHTML document. The following is an example skeleton:6\n<notes>7\n<body xmlns=\"http://www.w3.org/1999/xhtml\">8\n...9\n</body>10\n</notes>11\n3. Any XHTML content that would be permitted within a body element. If this consists of multiple12\nelements, each one must declare the XML namespace separately. The following is an example fragment:13\n<notes>14\n<p xmlns=\"http://www.w3.org/1999/xhtml\">15\n...16\n</p>17\n<p xmlns=\"http://www.w3.org/1999/xhtml\">18\n...19\n</p>20\n</notes>21\nAnother way to summarize the restrictions above is simply to say that the content of an SBML notes element22\ncan be only be a complete html element, a body element, or whatever is permitted inside a body element. In23\npractice, this does not limit in any meaningful way what can be placed inside a notes element; for example,24\nif an application or modeler wants to put a complete XHTML page, including a head element, it can be25\ndone by putting in everything starting with the html container. However, the restrictions above do make it26\nsomewhat simpler to write software that can read and write the notes content. Appendix F describes one27\npossible approach to doing just that.28\n3.2.4 The annotation element29\nWhereas the notes element described above is a container for content to be shown directly to humans, the30\nannotation element is a container for optional software-generated content not meant to be shown to humans.31\nEvery object derived from Sbase can have its own value for annotation. The element’s content type is XML32\ntype any, allowing essentially arbitrary well-formed XML data content. SBML places only a few restrictions33\non the organization of the content; these are intended to help software tools read and write the data as well34\nas help reduce conﬂicts between annotations added by diﬀerent tools.35\nThe use of XML namespaces in annotation36\nAt the outset, software developers should keep in mind that multiple software tools may attempt to read37\nand write annotation content. To reduce the potential for collisions between annotations written by diﬀerent38\napplications, SBML Level 2 Version 3 stipulates that tools must use XML namespaces ( Bray et al. , 1999)39\nto specify the intended vocabulary of every annotation. The application’s developers must choose a URI40\n(Universal Resource Identiﬁer ; Harold and Means 2001; W3C 2000a) reference that uniquely identiﬁes the41\nvocabulary the application will use, and a preﬁx string for the annotations. Here is an example. Suppose an42\napplication uses the URI http://www.mysim.org/ns and the preﬁx mysim when writing annotations related43\nto screen layout. The content of an annotation might look like the following:44\n<annotation>45\n<mysim:nodecolors xmlns:mysim=\"http://www.mysim.org/ns\"46\nmysim:bgcolor=\"green\" mysim:fgcolor=\"white\"/>47\n</annotation>48\nIn this particularly simple example, the content consists of a single XML element ( nodecolors) with two49\nattributes ( bgcolor, fgcolor), all of which are preﬁxed by the string mysim. (Presumably this particular50\ncontent would have meaning to the hypothetical application in question.) The content in this particular51\n16\nNature Precedings : hdl:10101/npre.2007.58.1 : Posted 18 Jun 2007\nexample is small, but it should be clear that there could easily have been an arbitrarily large amount of data1\nplaced inside the mysim:nodecolors element.2\nThe key point of the example above is that application-speciﬁc annotation data is entirely contained inside3\na single top-level element within the SBML annotation container. SBML Level 2 Version 3 places the4\nfollowing restrictions on annotations:5\n• Within a given SBML annotation element, there can only be one top-level element using a given6\nnamespace. An annotation element can contain multiple top-level elements but each must be in a7\ndiﬀerent namespace.8\n• No top-level element in an annotation may use an SBML XML namespace, either explicitly by refer-9\nencing one of the SBML XML namespace URIs or implicitly by failing to specify any namespace on10\nthe annotation. As of SBML Level 2 Version 3, the deﬁned SBML namespaces are the following URIs:11\n– http://www.sbml.org/sbml/level112\n– http://www.sbml.org/sbml/level213\n– http://www.sbml.org/sbml/level2/version214\n– http://www.sbml.org/sbml/level2/version315\n• The ordering of top-level elements within a given annotation element is not signiﬁcant. An application16\nshould not expect that its annotation content appears ﬁrst in the annotation element, nor in any17\nother particular location. Moreover, the ordering of top-level annotation elements may be changed by18\ndiﬀerent applications as they read and write the same SBML ﬁle.19\nThe use of XML namespaces in this manner is intended to improve the ability of multiple applications to20\nplace annotations on SBML model elements with reduced risks of interference or name collisions. Annota-21\ntions stored by diﬀerent simulation packages can therefore coexist in the same model deﬁnition. The rules22\ngoverning the content of annotation elements are designed to enable applications to easily add, change,23\nand remove their annotations from SBML elements while simultaneously preserving annotations inserted by24\nother applications when mapping SBML from input to output.25\nAs a further simpliﬁcation for developers of software and to improve software interoperability, applications are26\nonly required to preserve other annotations (i.e., annotations they do not recognize) when those annotations27\nare self-contained entirely within annotation, complete with namespace declarations. The following is an28\nexample:29\n<annotation>30\n<topLevelElement xmlns:\"URI\">31\n... content in the namespace identiﬁed by “URI” ...32\n</topLevelElement>33\n</annotation>34\nSome more examples hopefully will make these points more clear. The next example is invalid because it35\ncontains a top-level element in the SBML XML namespace—this happens because no namespace is declared36\nfor the <cytoplasm> element, which means by default it falls into the enclosing SBML namespace:37\n<annotation>38\n<cytoplasm/>39\n</annotation>40\nThe following example is also invalid, this time because it contains two top-level elements using the same41\nXML namespace. Note that it does not matter that these are two diﬀerent top-level elements ( <nodecolors>42\nand <textcolors>); what matters is that these separate elements are both in the same namespace rather43\nthan having been collected and placed inside one overall container element for that namespace.44\n<annotation>45\n<mysim:nodecolors xmlns:mysim=\"http://www.mysim.org/ns\"46\nmysim:bgcolor=\"green\" mysim:fgcolor=\"white\"/>47\n<mysim:textcolors xmlns:mysim=\"http://www.mysim.org/ns\"48\nmysim:bgcolor=\"green\" mysim:fgcolor=\"white\"/>49\n</annotation>50\n17\nNature Precedings : hdl:10101/npre.2007.58.1 : Posted 18 Jun 2007\nOn the other hand, the following example is valid:1\n<annotation>2\n<mysim:geometry xmlns:mysim=\"http://www.mysim.org/ns\"3\nmysim:bgcolor=\"green\" mysim:fgcolor=\"white\">4\n<graph:node xmlns:graph=\"http://www.graph.org/ns\"5\ngraph:x=\"4\" graph:y=\"5\" />6\n</mysim:geometry>7\n<othersim:icon xmlns:othersim=\"http://www.othersim.com/\">8\nWS20029\n</othersim:icon>10\n</annotation>11\nFor completeness, we note that annotations can legally be empty:12\n<annotation />13\nIt is worth keeping in mind that although XML namespace names must be URIs, they are (like all XML14\nnamespace names) not required to be directly usable in the sense of identifying an actual, retrieval document15\nor resource on the Internet ( Bray et al. , 1999). URIs such as http://www.mysim.org/ may appear as though16\nthey are (e.g.,) Internet addresses, but there are not the same thing. This style of URI strings, using a17\ndomain name and other parts, is only a simple and commonly-used way of creating a unique name string.18\nFinally, note that the namespaces being referred to here are XML namespaces speciﬁcally in the context of19\nthe annotation element on Sbase. The namespace issue here is unrelated to the namespaces discussed in20\nSection 3.3.1 in the context of component identiﬁers in SBML.21\nContent of annotations and implications for software tools22\nThe annotation element in the deﬁnition of Sbase exists in order that software developers may attach23\noptional application-speciﬁc data to the elements in an SBML model. However, it is important that this24\nfacility not be misused. In particular, it is critical that data essential to a model deﬁnition or that can be25\nencoded in existing SBML elements is not stored in annotation. Parameter values, functional dependencies26\nbetween model elements, etc., should not be recorded as annotations. It is crucial to keep in mind the fact27\nthat data placed in annotations can be freely ignored by software applications. If such data aﬀects the28\ninterpretation of a model, then software interoperability is greatly impeded.29\nHere are examples of the kinds of data that may be appropriately stored in annotation: (a) information30\nabout the graphical layout of model components; (b) application-speciﬁc processing instructions that do not31\nchange the essential meaning of a model; (c) identiﬁcation information for cross-referencing components in32\na model with items in a data resource such as a database ; and (d) information about the model that cannot33\nbe readily encoded in existing SBML elements.34\nStandardized format for certain classes of annotations35\nFor case (c) above (i.e., cross-references between model components and data resources, SBML Level 236\nVersion 3 recommends a standard format for use within annotation elements. It should be used in preference37\nto proprietary syntaxes to maximize the likelihood that multiple software tools will converge on the same38\nsyntax for this kind of information. The recommended scheme is described in Section 6.39\n3.3 The id and name attributes on SBML components40\nAs will become apparent below, most objects in SBML include two common attributes: id and name. These41\nattributes are not deﬁned on Sbase (as explained in Section 3.3.3 below), but where they do appear, the42\ncommon rules of usage described below apply.43\n3.3.1 The id attribute and identiﬁer scoping44\nThe id attribute is mandatory on most objects in SBML. It is used to identify a component within the45\nmodel deﬁnition. Other SBML objects can refer to the component using this identiﬁer. The data type of id46\nis always either Sid (Section 3.1.7) or UnitSId (Section 3.1.8), depending on the object in question.47\n18\nNature Precedings : hdl:10101/npre.2007.58.1 : Posted 18 Jun 2007\nA model can contain a large number of components representing diﬀerent parts. This leads to a problem1\nin deciding the scope of an identiﬁer: in what contexts does a given identiﬁer X represent the same thing?2\nThe approaches used in existing simulation packages tend to fall into two categories which we may call3\nglobal and local. The global approach places all identiﬁers into a single global space of identiﬁers, so that an4\nidentiﬁer X represents the same thing wherever it appears in a given model deﬁnition. The local approach5\nplaces symbols in separate identiﬁer namespaces, depending on the context, where the context may be, for6\nexample, individual reaction rate expressions. The latter approach means that a user may use the same7\nidentiﬁer X in diﬀerent rate expressions and have each instance represent a diﬀerent quantity.8\nThe fact that diﬀerent simulation programs may use diﬀerent rules for identiﬁer resolution poses a problem9\nfor the exchange of models between simulation tools. Without careful consideration, a model written out in10\nSBML format by one program may be misinterpreted by another program. SBML Level 2 must therefore11\ninclude a speciﬁc set of rules for treating identiﬁers and their scopes.12\nThe scoping rules in SBML Level 2 are relatively straightforward and are intended to avoid this problem13\nwith a minimum of requirements on the implementation of software tools:14\n• The identiﬁer (i.e., the value of the attribute id) of every FunctionDeﬁnition, CompartmentType, Speci-15\nesType, Compartment, Species, Parameter, Reaction, SpeciesReference, ModiﬁerSpeciesReference, Event,16\nand Model, must be unique across the set of all such identiﬁers in the model. This means, for example,17\nthat a reaction and a species deﬁnition cannot both have the same identiﬁer.18\n• The identiﬁer of every UnitDeﬁnition must be unique across the set of all such identiﬁers in the model.19\nHowever, unit identiﬁers live in a separate space of identiﬁers from other identiﬁers in the model , by20\nvirtue of the fact that the data type of unit identiﬁers is UnitSId (Section 3.1.8) and not SId.21\n• Each Reaction instance (see Section 4.13) establishes a separate private local space for local Parameter22\nidentiﬁers. Within the deﬁnition of that reaction, local parameter identiﬁers override (shadow) identical23\nidentiﬁers outside of that reaction. Of course, the corollary of this is that local parameters inside a24\nReaction object instance are not visible to other objects outside of that reaction.25\nThe set of rules above can enable software packages using either local or global identiﬁer spaces for parame-26\nters to exchange SBML model deﬁnitions. Software systems using local identiﬁers for parameters internally27\nshould, in principle, be able to accept SBML model deﬁnitions without needing to change component iden-28\ntiﬁers. Environments using a common global space of identiﬁers for parameters internally can perform29\nmanipulations of the identiﬁers of local parameters within reaction deﬁnitions to avoid identiﬁer collisions.30\nThe guidelines described here will hopefully provide a clean transition path to future levels of SBML, when31\nsubmodels are introduced (Section 8.1). Submodels will provide the ability to compose one model from32\na collection of other models. This capability will have to be built on top of SBML Level 2’s namespace33\norganization. A straightforward approach to handling namespaces is to make each submodel’s space be34\nprivate. The rules governing identiﬁer scoping within a submodel can simply be the Level 2 namespace rule35\ndescribed here, with each submodel having its own (to itself, global) namespace.36\n3.3.2 The name attribute37\nIn contrast to the id attribute, the name attribute is optional and is not intended to be used for cross-38\nreferencing purposes within a model. Its purpose instead is to provide a human-readable label for the39\ncomponent. The data type of name is the type string deﬁned in XML Schema ( Biron and Malhotra , 2000;40\nThompson et al. , 2000) and discussed further in Section 3.1. SBML imposes no restrictions as to the content41\nof name attributes beyond those restrictions deﬁned by the string type in XML Schema.42\nThe recommended practice for handling name is as follows. If a software tool has the capability for displaying43\nthe content of name attributes, it should display this content to the user as a component’s label instead of44\nthe component’s id. If the user interface does not have this capability (e.g., because it cannot display or use45\nspecial characters in symbol names), or if the name attribute is missing on a given component, then the user46\ninterface should display the value of the id attribute instead. (Script language interpreters are especially47\nlikely to display id instead of name.)48\n19\nNature Precedings : hdl:10101/npre.2007.58.1 : Posted 18 Jun 2007\nAs a consequence of the above, authors of systems that automatically generate the values of id attributes1\nshould be aware some systems may display the id’s to the user. Authors therefore may wish to take some2\ncare to have their software create id values that are: (a) reasonably easy for humans to type and read; and3\n(b) likely to be meaningful, e.g., the id attribute is an abbreviated form of the name attribute value.4\nAn additional point worth mentioning is although there are restrictions on the uniqueness of id values (see5\nSection 3.3.1 above), there are no restrictions on the uniqueness of name values in a model. This allows6\nsoftware packages leeway in assigning component identiﬁers.7\n3.3.3 Why id and name are not deﬁned on SBase8\nAlthough many SBML components feature id and name, these attributes are purposefully not deﬁned on9\nSbase. There are several reasons for this.10\n• The presence of an SBML identiﬁer attribute (id) necessarily requires specifying scoping rules for the11\ncorresponding identiﬁers. However, the Sbase abstract type is used as the basis for deﬁning components12\nwhose scoping rules are in some cases diﬀerent from each other. (See Section 3.3.1 for more details).13\nIf Sbase were to have an id attribute, then the speciﬁcation of Sbase would need a default scoping14\nrule and this would then have to be overloaded on derived classes that needed diﬀerent scoping. This15\nwould make the SBML speciﬁcation even more complex.16\n• Identiﬁer are optional on some SBML components and required on most others. If id were deﬁned as17\noptional on Sbase, most component classes would separately have to redeﬁne id as being mandatory—18\nhardly an improvement over the current arrangement. Conversely, if id were deﬁned as mandatory on19\nSbase, it would prevent it from being optional on components where it is currently optional.20\n• The Sbase abstract type is used as the base type for certain objects such as Sbml, AssignmentRule,21\netc., which do not have identiﬁers because these components do not need to be referenced by other22\ncomponents. If Sbase had a mandatory id attribute, all objects of these other types in a model23\nwould then need to be assigned unique identiﬁers. Similarly, because Sbase is the base type of the24\nlistOf lists, putting id on Sbase would require all of these lists in a model to be given25\nidentiﬁers. This would be a needless burden on software developers, tools, and SBML users, requiring26\nthem to generate and store additional identiﬁers for objects that never need them.27\n• Sbase does not have a name simply because such an attribute is always paired with an id. Without id28\non Sbase, it does not make sense to have name.29\n3.4 Mathematical formulas in SBML Level 230\nMathematical expressions in SBML Level 2 are represented using MathML 2.0 ( W3C, 2000b). MathML is31\nan international standard for encoding mathematical expressions using XML. There are two principal facets32\nof MathML, one for encoding content (i.e., the semantic interpretation of a mathematical expression), and33\nanother for encoding presentation or display characteristics. SBML only makes direct use of a subset of34\nthe content portion of MathML. By borrowing a separately-developed XML standard, we can avoid having35\nto deﬁne a specialized syntax for mathematical expressions in SBML and simultaneously leverage existing36\nintellectual and technological work already done in the MathML community. However, it is not possible37\nto produce a completely smooth and conﬂict-free interface between MathML and other standards used by38\nSBML (in particular, XML Schema). Two speciﬁc issues and their resolutions are discussed in Sections 3.4.2.39\nThe XML namespace URI for all MathML elements is http://www.w3.org/1998/Math/MathML. Everywhere40\nMathML content is allowed in SBML, the MathML elements must be properly placed within the MathML 2.041\nnamespace. In XML, this can be accomplished in a number of ways, and the examples throughout this42\nspeciﬁcation illustrate the use of this namespace and MathML in SBML. Please refer to the W3C document43\nby Bray et al. (1999) for more technical information about using XML namespaces.44\n20\nNature Precedings : hdl:10101/npre.2007.58.1 : Posted 18 Jun 2007\n3.4.1 Subset of MathML used in SBML Level 21\nThe subset of MathML 2.0 elements used in SBML Level 2 is similar to that used by CellML ( Hedley et al. ,2\n2001), another model deﬁnition language with similar goals as SBML. The subset of MathML elements used3\nin SBML is listed below:4\n• token: cn, ci, csymbol, sep5\n• general: apply, piecewise, piece, otherwise, lambda (the last is restricted to use in FunctionDeﬁnition)6\n• relational operators : eq, neq, gt, lt, geq, leq7\n• arithmetic operators : plus, minus, times, divide, power, root, abs, exp, ln, log, floor, ceiling,8\nfactorial9\n• logical operators: and, or, xor, not10\n• qualiﬁers: degree, bvar, logbase11\n• trigonometric operators : sin, cos, tan, sec, csc, cot, sinh, cosh, tanh, sech, csch, coth, arcsin,12\narccos, arctan, arcsec, arccsc, arccot, arcsinh, arccosh, arctanh, arcsech, arccsch, arccoth13\n• constants: true, false, notanumber, pi, infinity, exponentiale14\n• annotation: semantics, annotation, annotation-xml15\nThe inclusion of logical operators, relational operators, piecewise, piece, and otherwise elements facilitates16\nthe encoding of discontinuous expressions. Note that MathML elements for representing partial diﬀerential17\ncalculus are not included. We anticipate that the requirements for partial diﬀerential calculus will be ad-18\ndressed in proposals for future SBML geometry representations (see Section 8.1).19\nAs deﬁned by MathML 2.0, the semantic interpretation of the mathematical functions listed above follows20\nthe deﬁnitions of the functions laid out by Abramowitz and Stegun (1977) and Zwillinger (1996). Readers are21\ndirected to these sources and the MathML speciﬁcation for information about such things as which principal22\nvalues of the inverse trigonometric functions to use.23\nSoftware authors should take particular note of the MathML semantics of the N-ary operators plus, times,24\nand, or and xor, when they are used with diﬀerent numbers of arguments. The MathML speciﬁcation ( W3C,25\n2000b) appendix C.2.3 describes the semantics for these operators with zero, one, and more arguments.26\nThe following are the only attributes permitted on MathML elements in SBML (in addition to the xmlns27\nattribute on math elements):28\n• style, class and id on any element;29\n• encoding and definitionURL on csymbol elements; and30\n• type on cn elements.31\nMissing values for these attributes are to be treated in the same way as deﬁned by MathML. These restrictions32\non attributes are designed to conﬁne the MathML elements to their default semantics and to avoid conﬂicts33\nin the interpretation of the type of token elements.34\n3.4.2 Numbers and cn elements35\nIn MathML, literal numbers are written as the content portion of a particular element called cn. This36\nelement takes an optional attribute, type, used to indicate the type of the number (such as whether it is37\nmeant to be an integer or a ﬂoating-point quantity). Here is an example of its use:38\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\">39\n<apply>40\n<times/> <cn type=\"integer\"> 42 </cn> <cn type=\"real\"> 3.3 </cn>41\n</apply>42\n</math>43\n21\nNature Precedings : hdl:10101/npre.2007.58.1 : Posted 18 Jun 2007\nThe content of a cn element must be a number. The number can be preceded and succeeded by whitespace1\n(see Section 3.4.5). The following are the only permissible values for the type attribute on MathML cn2\nelements: “ e-notation”, “ real”, “ integer”, and “ rational”. The value of the type attribute defaults to3\n“real” if it is not speciﬁed on a given cn element.4\nValue space restrictions on cn content5\nSBML imposes certain restrictions on the value space of numbers allowed in MathML expressions. According6\nto the MathML 2.0 speciﬁcation, the values of the content of cn elements do not necessarily have to conform7\nto any speciﬁc ﬂoating point or integer representations designed for CPU implementation. For example, in8\nstrict MathML, the value of a cn element could exceed the maximum value that can be stored in a IEEE9\n64 bit ﬂoating point number (IEEE 754). This is diﬀerent from the XML Schema type double that is used10\nin the deﬁnition of ﬂoating point attributes of objects in SBML; the XML Schema double is restricted11\nto IEEE double-precision 64-bit ﬂoating point type IEEE 754-1985. To avoid an inconsistency that would12\nresult between numbers elsewhere in SBML and numbers in MathML expressions, SBML Level 2 Version 313\nimposes the following restriction on MathML content appearing in SBML:14\n• Integer values (i.e., the values of cn elements having type=“integer” and both values in cn elements15\nhaving type=“rational”) must conform to the int type used elsewhere in SBML (Section 3.1.3)16\n• Floating-point values (i.e., the content of cn elements having type=“real” or type=“e-notation”)17\nmust conform to the double type used elsewhere in SBML (Section 3.1.5)18\nSyntactic differences in the representation of numbers in scientiﬁc notation19\nIt is important to note that MathML uses a style of scientiﬁc notation that diﬀers from what is deﬁned in XML20\nSchema, and consequently what is used in SBML attribute values. The MathML 2.0 type “ e-notation” (as21\nwell as the type “ rational”) requires the mantissa and exponent to be separated by one <sep/> element. The22\nmantissa must be a real number and the exponent part must be a signed integer. This leads to expressions23\nsuch as24\n<cn type=\"e-notation\"> 2 <sep/> -5 </cn>25\nfor the number 2 × 10−5. It is especially important to note that the expression26\n<cn type=\"e-notation\"> 2e-5 </cn>27\nis not valid in MathML 2.0 and therefore cannot be used in MathML content in SBML. However, elsewhere in28\nSBML, when an attribute value is declared to have the data type double (a type taken from XML Schema),29\nthe compact notation “ 2e-5” is in fact allowed. In other words, within MathML expressions contained in30\nSBML (and only within such MathML expressions), numbers in scientiﬁc notation must take the form <cn31\ntype=\"e-notation\"> 2 <sep/> -5 </cn>, and everywhere else they must take the form “ 2e-5”.32\nThis is a regrettable diﬀerence between two standards that SBML replies upon, but it is not feasible to33\nredeﬁne these types within SBML because the result would be incompatible with parser libraries written to34\nconform with the MathML and XML Schema standards. It is also not possible to use XML Schema to deﬁne35\na data type for SBML attribute values permitting the use of the <sep/> notation, because XML attribute36\nvalues cannot contain XML elements—that is, <sep/> cannot appear in an XML attribute value.37\nUnits of numbers in MathML cn expressions38\nWhat units should be attributed to values appearing inside MathML cn elements? One answer is to assume39\nthat the units should be “whatever units appropriate in the context where the number appears”. This40\nimplies that units can always be assigned unambiguously to any number by inspecting the expression in41\nwhich it appears, and this turns out to be false. Another answer is that numbers should be considered42\n“dimensionless”. Many people argue that this is the correct interpretation, but even if it is, there is an43\noverriding practical reason why it cannot be adopted for SBML’s domain of application: when numbers44\nappear in expressions in SBML, they are rarely intended by the modeler to have the unit “ dimensionless”45\n22\nNature Precedings : hdl:10101/npre.2007.58.1 : Posted 18 Jun 2007\neven if the unit is not declared—the numbers are supposed to have speciﬁc units, but the units are usually1\nundeclared. (Being “dimensionless” is not the same as having undeclared units!) If SBML deﬁned numbers2\nas being by default dimensionless, it would result in many models being technically incorrect without the3\nmodeler being aware of it unless their software tools performed dimensional analysis. Most software tools4\ntoday still do not perform dimensional analysis, and so the inconsistency of units (and potential errors in5\nthe model) would not be detected until other researchers and database curators attempted to use the model6\nin software packages that did check units. We believe the negative impact on interoperability and people’s7\nconﬁdence in SBML as a reliable medium would be too high.8\nAs a result, the current approach in SBML is to leave the default units of literal numbers in MathML9\ncontent undeﬁned. Software packages and modelers are encouraged to explicitly add unit declarations to10\nnumbers. There is a simple mechanism in SBML for associating units with numbers: do not use literal11\nnumbers at all; instead, deﬁne Parameter objects (Section 4.9) for every quantity, declare units for each such12\nparameter value in its deﬁnition, and then insert the parameters in place of numbers in expressions. This13\nleads to mathematical formulas whose units can be fully determined, permitting software tools to perform14\ndimensional analysis and potentially report problems with a model.15\nIn summary: literal numbers appearing within MathML content in SBML have no declared units.16\n3.4.3 Use of ci elements in MathML expressions in SBML17\nThe content of a ci element must be an SBML identiﬁer that is declared elsewhere in the model. The18\nidentiﬁer can be preceded and succeeded by whitespace. The set of possible identiﬁers that can appear in a19\nci element depends on the containing element in which the ci is used:20\n• If a ci element appears in the body of a FunctionDeﬁnition object (Section 4.3), the referenced identiﬁer21\nmust be either (i) one of the declared arguments to that function, or (ii) the identiﬁer of a previously22\ndeﬁned FunctionDeﬁnition object in the model.23\n• Otherwise, the referenced identiﬁer must be that of a Species, Compartment, Parameter, FunctionDeﬁ-24\nnition, or Reaction object deﬁned in the model. The following are the only possible interpretations of25\nusing such an identiﬁer in SBML:26\n– Species identiﬁer : When a Species identiﬁer occurs in a ci element, it represents the quantity of27\nthat species in units of either amount of substance or units of concentration, depending on the28\nspecies’ deﬁnition ; see Section 4.8.5.29\n– Compartment identiﬁer : When a Compartment identiﬁer occurs in a ci element, it represents the30\nsize of the compartment. The units of measurement associated with the size of the compartment31\nare those given by the Compartment instance’s units attribute value; see Section 4.7.5.32\n– Parameter identiﬁer : When a Parameter identiﬁer occurs in a ci element, it represents the nu-33\nmerical value assigned to that parameter. The units associated with the parameter’s value are34\nthose given by the Parameter instance’s units attribute; see Section 4.9.3.35\n– Function identiﬁer : When a FunctionDeﬁnition identiﬁer occurs in a ci element, it represents a36\ncall to that function. Function references in MathML occur in the context of using MathML’s37\napply and often involve supplying arguments to the function; see Section 4.3. The units associated38\nwith the value returned by the function call are the overall units of the mathematical expression39\ncontained in the function deﬁnition.40\n– Reaction identiﬁer : When a Reaction identiﬁer occurs in a ci element, it represents the rate of41\nthat reaction as deﬁned by the math expression in the KineticLaw object within the Reaction. The42\nunits associated with that rate are substance/time, where the substance and time units established43\nby the values of the SBML built-in units “ substance” and “ time”, respectively. These units may44\nbe redeﬁned globally in the model; see Section 4.4.3. If a Reaction instance has no KineticLaw,45\nusing its reaction identiﬁer this way is an error (perhaps indicating that the model is incomplete).46\nThe content of ci elements in MathML formulas outside of a KineticLaw or FunctionDeﬁnition must always47\nrefer to objects declared in the top level global namespace; i.e., SBML uses “early binding” semantics. Inside48\n23\nNature Precedings : hdl:10101/npre.2007.58.1 : Posted 18 Jun 2007\nof KineticLaw, a ci element can additionally refer to local parameters deﬁned within that KineticLaw instance;1\nsee Section 4.13.5 for more information.2\n3.4.4 Interpretation of boolean values3\nAs noted already in Section 3.1.2, there is another unfortunate diﬀerence between the XML Schema 1.0 and4\nMathML 2.0 standards that impacts mathematical expressions in SBML: in XML Schema, the value space5\nof type boolean includes “ true”, “ false”, “ 1”, and “ 0”, whereas in MathML, only “ true” and “ false”6\ncount as boolean values.7\nThe impact of this diﬀerence thankfully is minimal because the XML Schema deﬁnition is only used for8\nattribute values on SBML objects, and those values turn out never to be accessible from MathML content9\nin SBML—values of boolean attributes on SBML objects can never enter into MathML expressions. Never-10\ntheless, software authors and users should be aware of the diﬀerence and in particular that “ 0” and “ 1” are11\ninterpreted as numerical quantities in mathematical expressions. There is no automatic conversion of “ 0” or12\n“1” to boolean values in contexts where booleans are expected. This allows stricter type checking and unit13\nveriﬁcation during the validation of mathematical expressions.14\n3.4.5 Handling of whitespace15\nMathML 2.0 deﬁnes “whitespace” in the same way as XML does, i.e., the space character (Unicode hex-16\nadecimal code 0020), horizontal tab (code 0009), newline or line feed (code 000A), and carriage return (code17\n000D). In MathML, the content of elements such as cn and ci can be surrounded by whitespace characters.18\nPrior to using the content, this whitespace is “trimmed” from both ends: all whitespace at the beginning19\nand end of the content is removed ( Ausbrooks et al. , 2003). For example, in <cn> 42 </cn>, the amount20\nof white space on either side of the “ 42” inside the <cn> . . . </cn> container does not matter. Prior to21\ninterpreting the content, the whitespace is removed altogether.22\n3.4.6 Use of csymbol elements in MathML expressions in SBML23\nSBML Level 2 uses the MathML csymbol element to denote certain built-in mathematical entities without24\nintroducing reserved names into the component identiﬁer namespace. The encoding attribute of csymbol25\nmust be set to “ text”. The definitionURL should be set to one of the following URIs deﬁned by SBML :26\n• http://www.sbml.org/sbml/symbols/time. This represents the current simulation time. See Sec-27\ntion 3.4.7 for more information. The units of the current time entity is determined from the built-in28\ntime of Table 2 on page 41.29\n• http://www.sbml.org/sbml/symbols/delay. This represents a delay function. The delay function has30\nthe form delay(x, d), taking two MathML expressions as arguments. Its value is the value of argument31\nx at d time units before the current time. There are no restrictions on the form of x. The units of the d32\nparameter are determined from the built-in time. The value of the d parameter, when evaluated, must33\nbe numerical (i.e., a number in MathML real, integer, or “e-notation” format) and be greater than or34\nequal to 0. The delay function is useful for representing biological processes having a delayed response,35\nbut where the detail of the processes and delay mechanism is not relevant to the operation of a given36\nmodel. See Section 3.4.7 below for additional considerations surrounding the use of this csymbol.37\nThe following examples demonstrate these concepts. The XML fragment below encodes the formula x + t,38\nwhere t stands for time.39\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\">40\n<apply>41\n<plus/>42\n<ci> x </ci>43\n<csymbol encoding=\"text\" definitionURL=\"http://www.sbml.org/sbml/symbols/time\">44\nt45\n</csymbol>46\n</apply>47\n</math>48\n24\nNature Precedings : hdl:10101/npre.2007.58.1 : Posted 18 Jun 2007\nIn the fragment above, the use of the token t is mostly a convenience for human readers—the string inside1\nthe csymbol could have been almost anything, because it is essentially ignored by MathML parsers and2\nSBML. Some MathML and SBML processors will take note of the token and use it when presenting the3\nmathematical formula to users, but the token used has no impact on the interpretation of the model and it4\ndoes not enter into the SBML component identiﬁer namespace. In other words, the SBML model cannot5\nrefer to t in the example above. The content of the csymbol element is for rendering purposes only and can6\nbe ignored by the parser.7\nAs a further example, the following XML fragment encodes the equation k + delay(x, 0.1) or alternatively8\nkt + xt−0.1:9\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\">10\n<apply>11\n<plus/>12\n<ci> k </ci>13\n<apply>14\n<csymbol encoding=\"text\" definitionURL=\"http://www.sbml.org/sbml/symbols/delay\">15\ndelay16\n</csymbol>17\n<ci> x </ci>18\n<cn> 0.1 </cn>19\n</apply>20\n</apply>21\n</math>22\nNote that the URI in the value of definitionURL, as all URIs, is intended to serve as a unique identiﬁer and23\nis not intended to be dereferenced as an Internet address. There is nothing actually located at the address24\nhttp://www.sbml.org/sbml/symbols/delay.25\n3.4.7 Simulation time26\nThe principal use of SBML is to represent quantitative dynamical models whose behaviors manifest them-27\nselves over time. In deﬁning an SBML model using constructs such as reactions, time is most often implicit28\nand does not need to be referred to in the mathematical expressions themselves. However, sometimes an29\nexplicit time dependency needs to be stated, and for this purpose, the time csymbol (described above in Sec-30\ntion 3.4.6) may be used. This time symbol refers to “instantaneous current time” in a simulation, frequently31\ngiven the literal name t in one’s equations.32\nAn assumption in SBML is that “start time” or “initial time” in a simulation is zero, that is, if t0 is the33\ninitial time in the system, t0 = 0. This corresponds to the most common scenario. Initial conditions in34\nSBML take eﬀect at time t = 0. There is no mechanism in SBML for setting the initial time to a value35\nother than 0. To refer to a diﬀerent time in a model, one approach is to deﬁne a Parameter for a new time36\nvariable and use an AssignmentRule in which the assignment expression subtracts a value from the csymbol37\ntime. For example, if the desired oﬀset is 2 time units, the MathML expression would be38\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\">39\n<apply>40\n<minus/>41\n<csymbol encoding=\"text\" definitionURL=\"http://www.sbml.org/sbml/symbols/time\"> t42\n</csymbol>43\n<cn> 2 </cn>44\n</apply>45\n</math>46\nSBML’s assignment rules (Section 4.11.3) can be used to express mathematical statements that hold true at47\nall moments, so using an assignment rule with the expression above will result in the value being equal to48\nt − 2 at every point in time. A parameter assigned this value could then be used elsewhere in the model, its49\nvalue could be plotted by a simulator, etc.50\n25\nNature Precedings : hdl:10101/npre.2007.58.1 : Posted 18 Jun 2007\n3.4.8 Initial conditions and special considerations1\nThe identiﬁers of Species, Compartment, Parameter, and Reaction object instances in a given SBML model2\nrefer to the main variables in a model. Depending on certain attributes of these objects (e.g., the attribute3\nconstant on species, compartments and parameters—this and other conditions are explained in the relevant4\nsections elsewhere in this document), some of the variables may have constant values throughout a simulation,5\nand others’ values may change. These changes in values over time are determined by the system of equations6\nconstructed from the model’s reactions, initial assignments, rules, and events.7\nAs described in Section 3.4.7, an SBML model’s simulation is assumed to begin at t = 0. The availability8\nof the delay csymbol (Section 3.4.6) introduces the possibility that at t ≥ 0, mathematical expressions in a9\nmodel may draw on values of model components from time prior to t = 0. A simulator may therefore need10\nto compute the values of variables at time points ti ≤ 0 to allow the calculation of values required for the11\nevaluation of delay expressions in the model for t ≥ 0. If there are no delays in the model, then ti = 0.12\nThe following is how the deﬁnitions of the model should be applied:13\n1. At time ti:14\n• Every Species, Compartment, and Parameter whose deﬁnition includes an initial value is assigned15\nthat value. If an element has constant=“false”, its value may be changed by other constructs or16\nreactions in a model according to the steps below; if constant=“true”, only an InitialAssignment17\ncan override the value.18\n• All InitialAssignment deﬁnitions take eﬀect at ti and continue to have eﬀect up to and including t =19\n0, overriding any initial values on Species, Compartment and Parameter. Since InitialAssignments20\ncontain mathematical formulas, diﬀerent values may be computed at each time step t in ti ≤ t ≤ 0.21\n2. For time t ≥ ti:22\n• AssignmentRule and AlgebraicRule deﬁnitions are in eﬀect from this point in time forward and23\nmay inﬂuence the values of Species quantity, Compartment size, and Parameter values. (Note24\nthere cannot be both an AssignmentRule and an InitialAssignment for the same identiﬁer; see25\nSection 4.11.)26\n3. At time t = 0:27\n• The system of equations constructed by combining AssignmentRule equations, AlgebraicRule equa-28\ntions, RateRule equations, and the equations constructed from the Reaction deﬁnitions in the29\nmodel, are used to obtain consistent initial conditions for numerical solver algorithms. (Note30\nthat there cannot be both an AssignmentRule and a RateRule for the same identiﬁer, or both an31\nAssignmentRule and an InitialAssignment for the same identiﬁer; see Section 4.11.3.)32\n• Constraint deﬁnitions begin to take eﬀect (and a constraint violation may result; see Section 4.12).33\n4. For time t > 0:34\n• RateRule deﬁnitions can begin to take eﬀect.35\n• Event deﬁnitions can begin to take eﬀect. (Note that an Event cannot be deﬁned to change the36\nvalue of a variable that is also the subject of an AssignmentRule; see Section 4.14.)37\n• System simulation proceeds.38\nTo reiterate: in modeling situations that do not involve the use of the delay csymbol, ti = 0, but this does39\nnot alter the steps above.40\n3.4.9 MathML expression data types41\nMathML operators in SBML each return results in one of two possible types: boolean and numerical. By42\nnumerical type, we mean either (1) a number in MathML real, integer, rational, or “e-notation” format;43\nor (2) the csymbol for delay or the csymbol for time described in Section 3.4.6. The following guidelines44\nsummarize the diﬀerent possible cases.45\n26\nNature Precedings : hdl:10101/npre.2007.58.1 : Posted 18 Jun 2007\nThe relational operators ( eq, neq, gt, lt, geq, leq), the logical operators ( and, or, xor, not), and the boolean1\nconstants ( false, true) always return boolean values. As noted in Section 3.4.4, the numbers 0 and 1 do2\nnot count as boolean values in MathML contexts in SBML.3\nThe type of an operator referring to a FunctionDeﬁnition is determined by the type of the top-level operator4\nof the expression in the math element of the FunctionDeﬁnition instance, and can be boolean or numerical.5\nAll other operators, values and symbols return numerical results.6\nThe roots of the expression trees used in the following contexts must yield boolean values:7\n• the arguments of the MathML logical operators ( and, or, xor, not);8\n• the second argument of a MathML piece operator;9\n• the trigger element of an SBML Event; and10\n• the math element of an SBML Constraint.11\nThe roots of the expression trees used in the following contexts can optionally yield boolean values:12\n• the arguments to the eq and neq operators;13\n• the ﬁrst arguments of MathML piece and otherwise operators; and14\n• the top level expression of a function deﬁnition.15\nThe roots of expression trees in other contexts must yield numerical values.16\nThe type of expressions should be used consistently. The set of expressions that make up the ﬁrst arguments17\nof the piece and otherwise operators within the same piecewise operator should all return values of the18\nsame type. The arguments of the eq and neq operators should return the same type.19\n3.4.10 Consistency of units in mathematical expressions and treatment of unspeciﬁed units20\nStrictly speaking, physical validity of mathematical formulas requires not only that physical quantities added21\nto or equated with each other have the same fundamental dimensions and units of measurement; it also22\nrequires that the application of operators and functions to quantities produces sensible results. Yet, in23\nreal-life models today, these conditions are often and sometimes legitimately disobeyed. SBML must again24\nbalance the ability of modelers to represent whatever model they desire against the need for the represented25\nmodels to be self-consistent and detailed enough for diﬀerent software tools to be able to manipulate and26\nanalyze them.27\nThe approach taken in SBML is to focus requirements principally on preventing inconsistency of a model.28\nIn a nutshell, the SBML requirement is that what is expressed in a model must be consistent to the extent29\nthat this can be determined using the information available in the model .30\nUnit requirements for mathematical expressions31\nThe SBML requirement for consistency of units is deﬁned in terms of dimensional analysis applied recursively32\nto every operator and function and every argument to them. Some conditions must be true, and others should33\nbe true (but are not absolutely required for model validity). The following conditions must be true in a model:34\n1. All arguments to the following operators must have the same units (regardless of what those units35\nhappen to be): plus, minus, eq, neq gt, lt, geq, leq.36\n2. The units of each argument in a call to a FunctionDeﬁnition must match the units expected by the37\nlambda expression within the math expression of that FunctionDeﬁnition instance.38\n3. All of the possible return values from piece and otherwise subelements of a piecewise expression39\nmust have the same units, regardless of what those units are. (Otherwise, the piecewise expression40\nwould return values having diﬀerent units depending on which case evaluated to true.)41\n4. For the delay csymbol (Section 3.4.6) function, which has the form delay(x, d), the second argument42\nd must match the model’s unit of time (i.e., the “ time” built-in unit).43\n27\nNature Precedings : hdl:10101/npre.2007.58.1 : Posted 18 Jun 2007\nIn addition to the above, the following conditions should hold true (and software developers may wish to1\nconsider having their software warn users if one or more of the following conditions is not true):2\n1. The units of each argument to the following operators should be “ dimensionless”: exp, ln, log,3\nfactorial, sin, cos, tan, sec, csc, cot, sinh, cosh, tanh, sech, csch, coth, arcsin, arccos, arctan,4\narcsec, arccsc, arccot, arcsinh, arccosh, arctanh, arcsech, arccsch, arccoth.5\n2. The two arguments to power, which are of the form power(a, b) with the meaning ab, should be as6\nfollows: (1) if the second argument is an integer, then the ﬁrst argument can have any units; (2) if the7\nsecond argument b is a rational number n/m, it must be possible to derive the m-th root of ( a{units})n,8\nwhere {units} signiﬁes the units associated with a; otherwise, (3) the units of the ﬁrst argument must9\nbe “ dimensionless”. The second argument ( b) should always have units of “ dimensionless”.10\n3. The two arguments to root, which are of the form root(n, a) with the meaning n√a and where the11\ndegree n is optional (defaulting to “ 2”), should be as follows: (1) if the optional degree qualiﬁer n is12\nan integer, then it must be possible to derive the n-th root of a; (2) if the optional degree qualiﬁer n is13\na rational n/m then it must be possible to derive the n-th root of ( a{units})m, where {units} signiﬁes14\nthe units associated with a; otherwise, (3) the units of a must be “ dimensionless”.15\n4. Since the units of literal numbers cannot be speciﬁed directly in SBML (see below), it is possible for the16\nunits of a FunctionDeﬁnition object’s return value to be eﬀectively diﬀerent in diﬀerent contexts where17\nit is called. If a FunctionDeﬁnition’s mathematical formula contains literal constants (i.e., numbers18\nwithin MathML cn elements), the units of the constants should be identical in all contexts the function19\nis called.20\nThe units of other operators such as abs, floor, and ceiling, can be anything.21\nThe ﬁnal bulleted item above, regarding FunctionDeﬁnition, warrants additional elaboration. An example22\nmay help illustrate the problem. Suppose the formula x+ 5 is deﬁned as a function, where x is an argument.23\nThe literal number 5 in SBML has unspeciﬁed units. If this function is called with an argument in moles,24\nthe only possible consistent unit for the return value is mole. If in another context in the same model, the25\nfunction is called with an argument in seconds, the function return value can only be treated as being in26\nseconds. Now suppose that a modeler decides to change all uses of seconds to milliseconds in the model. To27\nmake the function deﬁnition return the same quantity in terms of seconds, the 5 in the formula would need28\nto be changed, but doing so would change the result of the function everywhere it is called—with the wrong29\nconsequences in the context where moles were intended. This illustrates the subtle danger of using numbers30\nwith unspeciﬁed units in function deﬁnitions. There are at least two approaches for avoiding this: (1) deﬁne31\nseparate functions for each case where the units of the constants are supposed to be diﬀerent; or (2) declare32\nthe necessary constants as Parameter objects in the model (with declared units!) and pass those parameters33\nas arguments to the function, avoiding the use of literal numbers in the function’s formula.34\nTreatment of unspeciﬁed units35\nThere are only two ways to introduce numbers with unspeciﬁed units into mathematical formulas in SBML:36\nusing literal numbers (i.e., numbers enclosed in MathML cn elements), and using Parameter objects deﬁned37\nwithout unit declarations. All other quantities, in particular species and compartments, always have unit38\ndeclarations (whether explicit or the defaults).39\nIf an expression contains literal numbers and/or Parameter objects without declared units, the consistency40\nor inconsistency of units may be impossible to determine. In the absence of a veriﬁable inconsistency, an41\nexpression in SBML is accepted as-is; the writer of the model is assumed to have written what they intended.42\nNevertheless, this is not equivalent to assuming the expression does have consistent units.43\nIn some cases, it may be possible to determine that expressions containing unspeciﬁed units are inconsistent44\nregardless of what units would be attributed to the unspeciﬁed quantities. For example, the expression45\ndX\ndt = [Y ] · [Z]n\n[Z]m + 1 · V46\n28\nNature Precedings : hdl:10101/npre.2007.58.1 : Posted 18 Jun 2007\nwith X, Y and Z in units of substance, V in units of volume, and m ̸= n, cannot ever be consistent, no1\nmatter what units the literal 1 takes on. (This also illustrates the need not to stop verifying the units of an2\nexpression immediately upon encountering an unspeciﬁed quantity—the rest of the expression may still be3\nproﬁtably evaluated and checked for inconsistency.)4\nWe advise modelers and software tools to declare the units of all quantities in a model, insofar as this is5\npossible, using the various mechanisms provided for this in SBML. Fully declared units can allow software6\ntools to perform dimensional analysis on the units of mathematical expressions, and such analysis can be7\nvaluable in helping modelers produce correct models. In addition, it can allow model-wide operations such8\nas conversion or rescaling of units. The lack of declared units on quantities in a model does not render it9\ninvalid SBML, but it reduces the types of consistency checks and useful operations (such as conversions and10\ntranslations) that software systems can perform.11\n3.4.11 SBML does not deﬁne implicit unit conversions12\nImplicit unit conversions do not exist in SBML. Consider the following example. Suppose that in some13\nmodel, a species S1 has been declared as having a mass of 1 kg, and a second species S2 has been declared14\nas having a mass of 500 g. What should be the result of evaluating an expression such as S1 > S 2? If the15\nnumbers alone are considered,16\n1 > 50017\nwould evaluate to “ false”, but if the units were implicitly converted by the software tool interpreting the18\nmodel,19\n1 kg > 500 g20\nwould evaluate to “ true”. This is a trivial example, but the problem for SBML is that implicit unit21\nconversions of this kind can lead to controversial situations where even humans do not agree on the answer.22\nConsequently, SBML only requires that mathematical expressions be evaluated numerically. It is up to23\nthe model writer to ensure that the units on both sides of an expression match, by inserting explicit unit24\nconversion factors if necessary.25\nIt is simple enough to avoid expressions with mixed units such as in the example above: a modeler or a26\nsoftware tool can deﬁne a parameter that acts as a conversion factor, and then multiply one of the terms by27\nthis parameter. Thus, a model could include a parameter “ g per kg” with a value of 1000, and the expression28\ncould be written as29\n1 ∗ g per kg > 50030\nwhich will then evaluate to “ true”.31\n29\nNature Precedings : hdl:10101/npre.2007.58.1 : Posted 18 Jun 2007\n4 SBML components1\nIn this section, we deﬁne each of the major components of SBML. We use the UML notation described in2\nSection 1.4.3 for deﬁning classes of objects. We also illustrate the use of SBML components by giving partial3\nmodel deﬁnitions in XML. Section 7 provides many full examples of SBML in XML.4\n4.1 The SBML container5\nAll well-formed XML documents must begin with an XML declaration , which speciﬁes both the version of6\nXML assumed and the document character encoding. The declaration begins with the characters <?xml7\nfollowed by the XML version and encoding attributes. SBML Level 2 uses XML version 1.0 and requires a8\ndocument encoding of UTF-8. Following this XML declaration, the outermost portion of a model expressed9\nin SBML Level 2 Version 3 consists of an object of class Sbml, deﬁned in Figure 9. This class contains two10\nrequired attributes, for the SBML level and version, and one required subelement called model whose class11\nis Model.12\nSBase\nSbml\nxmlns: string { ”http://www.sbml.org/sbml/level2/version3”}\nlevel: positiveInteger { use=”required” ﬁxed=”2”}\nversion: positiveInteger { use=”required” ﬁxed=”3”}\nModelmodel\nFigure 9: The deﬁnition of Sbml for SBML Level 2 Version 3. The class Model is deﬁned in Section 4.2. Note that both\nSbml and Model are subclasses of Sbase, and therefore inherit the attributes of that abstract class.\nThe following is an abbreviated example of these XML elements for an SBML Level 2 Version 3 document:13\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>14\n<sbml xmlns=\"http://www.sbml.org/sbml/level2/version3\" level=\"2\" version=\"3\">15\n...16\n</sbml>17\nThe attribute xmlns declares the default XML namespace used within the sbml element. The URI for SBML18\nLevel 2 Version 3 is http://www.sbml.org/sbml/level2/version3. All elements must be placed in this19\nnamespace either by assigning the default namespace as shown above, or using a tag preﬁx on every element.20\nAn SBML XML document must not contain elements or attributes in the SBML namespace that are not21\ndeﬁned in this SBML Level 2 Version 3 Release 1 speciﬁcation. Documents containing unknown elements or22\nattributes placed in the SBML namespace do not conform to this SBML speciﬁcation.23\nReaders may wonder why the SBML top-level XML element uses both a namespace URI identifying the24\nSBML level and version, as well as separate XML attributes giving the level and version. Why is the25\ninformation duplicated? There are several reasons. First, XML is only one possible serialization of SBML26\n(albeit an extremely popular one at this time). Though most of this document is written with XML in27\nmind, it is the intention behind the design of SBML that its object structure should be implementable in28\nother languages and software systems. Programmatic access is easier if the level and version information29\nare accessible directly as data rather than have to be extracted from a string. Second, generic high-level30\nXML parsers may not give their calling programs access to the value of the xmlns attribute. Providing31\nthe information via separate attributes is a good backup measure. And ﬁnally, earlier in the history of32\nSBML, it was expected that only the level needed to be encoded as part of the namespace URI (e.g.,33\nhttp://www.sbml.org/sbml/level1) because it was hoped that changes within levels would not require34\nXML Schema changes. This has proven to be false, but SBML Level 1 (both versions) and the ﬁrst version35\nof SBML Level 2 still subscribe to this principle. This means that for these variants of SBML, software tools36\nmust look for a version attribute on the top-level element. For backwards compatibility with software that37\nexpects this, it makes more sense to keep the version and level attributes.38\n30\nNature Precedings : hdl:10101/npre.2007.58.1 : Posted 18 Jun 2007\n4.2 Model1\nThe deﬁnition of Model is shown in Figure 10 on the following page. Only one instance of a Model object2\nis allowed per instance of an SBML Level 2 Version 3 Release 1 document or data stream, and it must be3\nlocated inside the <sbml> ... </sbml> element as described in Section 4.1.4\nThe Model object has an optional attribute, id, used to give the model an identiﬁer. The identiﬁer must5\nbe a text string conforming to the syntax permitted by the SId data type described in Section 3.1.7. Model6\nalso has an optional name attribute, of type string. The name and id attributes must be used as described7\nin Section 3.3.8\nModel serves as a container for components of classes FunctionDeﬁnition, UnitDeﬁnition, CompartmentType,9\nSpeciesType, Compartment, Species, Parameter, InitialAssignment, Rule, Constraint, Reaction and Event.10\nInstances of the classes are placed inside instances of classes ListOfFunctionDeﬁnitions, ListOfUnitDeﬁni-11\ntions, ListOfCompartmentTypes, ListOfSpeciesTypes, ListOfCompartments, ListOfSpecies, ListOfParameters,12\nListOfInitialAssignments, ListOfRules, ListOfConstraints, ListOfReactions, and ListOfEvents. The “list” classes13\nare deﬁned in Figure 10. All of the lists are optional, but if a given list container is present within the model,14\nthe list must not be empty; that is, it must have length one or more. The resulting XML data object for a15\nfull model containing every possible list would have the following form:16\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<sbml xmlns=\"http://www.sbml.org/sbml/level2/version3\" level=\"2\" version=\"3\">\n<model id=\"My Model\">\n<listOfFunctionDefinitions>\none or more <functionDefinition> ... </functionDefinition> elements\nﬀ\noptional\n</listOfFunctionDefinitions>\n<listOfUnitDefinitions>\none or more <unitDefinition> ... </unitDefinition> elements\nﬀ\noptional\n</listOfUnitDefinitions>\n<listOfCompartmentTypes>\none or more <compartmentType> ... </compartmentType> elements\nﬀ\noptional\n</listOfCompartmentTypes>\n<listOfSpeciesTypes>\none or more <speciesType> ... </speciesType> elements\nﬀ\noptional\n</listOfSpeciesTypes>\n<listOfCompartments>\none or more <compartment> ... </compartment> elements\nﬀ\noptional\n</listOfCompartments>\n<listOfSpecies>\none or more <species> ... </species> elements\nﬀ\noptional\n</listOfSpecies>\n<listOfParameters>\none or more <parameter> ... </parameter> elements\nﬀ\noptional\n</listOfParameters>\n<listOfInitialAssignments>\none or more <initialAssignment> ... </initialAssignment> elements\nﬀ\noptional\n</listOfInitialAssignments>\n<listOfRules>\none or more elements of subclasses of Rule\nﬀ\noptional\n</listOfRules>\n<listOfConstraints>\none or more <constraint> ... </constraint> elements\nﬀ\noptional\n</listOfConstraints>\n<listOfReactions>\none or more <reaction> ... </reaction> elements\nﬀ\noptional\n</listOfReactions>\n<listOfEvents>\none or more <event> ... </event> elements\nﬀ\noptional\n</listOfEvents>\n</model>\n</sbml>\nAlthough all the lists are optional, there are dependencies between SBML components such that deﬁning some17\ncomponents requires deﬁning others. An example is that deﬁning a species requires deﬁning a compartment,18\nand deﬁning a reaction requires deﬁning a species. The dependencies are explained throughout the text.19\n31\nNature Precedings : hdl:10101/npre.2007.58.1 : Posted 18 Jun 2007\nListOfFunctionDeﬁnitions\nfunctionDeﬁnition\nlistOfFunctionDeﬁnitions\nFunctionDeﬁnition1..*\nListOfUnitDeﬁnitions\nunitdeﬁnition\nlistOfUnitDeﬁnitions\nUnitDeﬁnition1..*\nListOfCompartmentTypes\ncompartmentType\nlistOfCompartmentTypes\nCompartmentType1..*\nListOfSpeciesTypes\nspeciesType\nlistOfSpeciesTypes\nSpeciesType1..*\nListOfCompartments\ncompartment\nlistOfCompartments\nCompartment1..*\nListOfSpecies\nspecies\nlistOfSpecies\nSpecies1..*\nListOfParameters\nparameter\nlistOfParameters\nParameter1..*\nListOfInitialAssignments\ninitialAssignment\nlistOfInitialAssignments\nInitialAssignment1..*\nListOfRuleslistOfRules\nRule1..*\nListOfConstraintslistOfContraints\nConstraint1..*\nListOfReactionslistOfReactions\nReaction1..*\nListOfEventslistOfEvents\nEvent1..*\nconstraint\nreaction\nevent\nSBase\n{ Order is significant. }\nModel\nid: SId  { use=\"optional\" }\nname: string  { use=\"optional\" }\n0..1\n0..1\n0..1\n0..1\n0..1\n0..1\n0..1\n0..1\n0..1\n0..1\n0..1\n0..1\nFigure 10: The deﬁnition of Model and the many helper classes ListOfFunctionDeﬁnitions, ListOfUnitDeﬁni-\ntions, ListOfCompartmentTypes, ListOfSpeciesTypes, ListOfCompartments, ListOfSpecies, ListOfParameters,\nListOfInitialAssignments, ListOfRules, ListOfConstraints, ListOfReactions, and ListOfEvents.\n32\nNature Precedings : hdl:10101/npre.2007.58.1 : Posted 18 Jun 2007\n4.2.1 The ListOf container classes1\nThe various ListOf classes deﬁned in Figure 10 are merely containers used for organizing the main2\ncomponents of an SBML model. All are derived from the abstract class Sbase (Section 3.2), and inherit3\nSbase’s various attributes and subelements such as metaid and annotation, although in SBML Level 24\nVersion 3 Release 1 there are no deﬁned SBO terms for the sboTerm attribute. The ListOf classes do5\nnot add any attributes of their own.6\nReaders may wonder about the motivations for using the ListOf containers. A simpler approach in XML7\nmight be to place the components all directly at the top level. We chose instead to group them within XML8\nelements named after listOfClassNames, in part because we believe this helps organize the components and9\nmakes visual reading of models in XML easier. More importantly, the fact that the container classes are10\nderived from Sbase means that software tools can add information about the lists themselves into each list11\ncontainer’s annotation, a feature that a number of today’s software tools exploit.12\n4.2.2 The sboTerm attribute13\nThe Model object has an optional sboTerm attribute of type SBOTerm (see Sections 3.1.9 and 5). Values14\nof this attribute must be chosen from identiﬁers referring to a modeling framework deﬁned in SBO (i.e.,15\nterms derived from SBO:0000004, “modeling framework”). The SBO term chosen should be the most precise16\n(narrow) term that deﬁnes the mathematical framework assumed by the entire model. An example might17\nbe “non-spatial discrete framework”, which would mean the entire model was created under the assumption18\nit will be simulated in a tool that turns substance quantities into discrete numbers and applies a stochastic19\nsimulation algorithm (e.g., Gillespie, 1977) to the model. Other frameworks are possible.20\nA dependency exists between the SBO term referenced by a Model instance and the SBO labels on individual21\nKineticLaw instances within the model. In SBO, each deﬁnition of a rate expression itself includes an SBO22\nreference to a mathematical framework. When a given KineticLaw element refers to a rate law term in SBO,23\nit therefore simultaneously also identiﬁes a framework. (It is possible for a model to mix frameworks, which24\nis why it is important to enable individual reactions to indicate which one is assumed.) By contrast, if all25\nthe reactions in a given model use the same framework, it makes sense to characterize the model as a whole26\nas assuming this. Thus, the label on Model should apply to the model as a whole , meaning that if Model’s27\nsboTerm attribute has a value, all of that model’s reaction rate expressions are assumed to be expressed28\nusing the same mathematical framework, and the application reading the model may ignore frameworks29\nindicated by the deﬁnitions of the SBO terms referenced by the KineticLaw elements’s sboTerm attributes.30\nAs discussed in Section 5, SBO labels are optional information on a model.31\nThe absence of an sboTerm value on a Model instance means that either the model has not been labeled with32\nSBO terms at all, or no modeling framework term in SBO at the time the model was created was deemed33\nsuitable for characterizing the model as a whole. If a Model instance has no value for its sboTerm attribute,34\nthe deﬁnitions of the SBO terms referenced by individual KineticLaw elements in the model may indicate the35\nframework assumed for each reaction separately.36\n4.3 Function deﬁnitions37\nThe FunctionDeﬁnition object associates an identiﬁer with a function deﬁnition. This identiﬁer can then be38\nused as the function called in subsequent MathML apply elements. FunctionDeﬁnition is shown in Figure 1139\non the next page.40\nFunction deﬁnitions in SBML (also informally known as “user-deﬁned functions”) have purposefully limited41\ncapabilities. As is made more clear below, a function cannot reference parameters or other model quantities42\noutside of itself; values must be passed as parameters to the function. Moreover, recursive and mutually-43\nrecursive functions are not permitted. The purpose of these limitations is to balance power against complexity44\nof implementation. With the restrictions as they are, function deﬁnitions could be implemented as textual45\nsubstitutions—they are simply macros. Software implementations therefore do not need the full function-46\ndeﬁnition machinery typically associated with programming languages.47\n33\nNature Precedings : hdl:10101/npre.2007.58.1 : Posted 18 Jun 2007\nSBase\nFunctionDeﬁnition\nid: SId\nname: string { use=”optional”}\nLambda\nxmlns: string { ”http://www.w3.org/1998/Math/MathML ”}\n{ MathML content restricted to one MathML lambda\nor one semantics element containing a lambda. }\nmath\nFigure 11: The deﬁnition of class FunctionDeﬁnition. The contents of the Lambda class is a single MathML lambda\nexpression (or a lambda surrounded by a semantics element). A function deﬁnition must contain exactly one math\nelement deﬁned by the Lambda class; note also that Lambda is not derived from Sbase, which means that the attributes\ndeﬁned on Sbase are not available on the math element. A sequence of one or more instances of FunctionDeﬁnition\nobjects can be located in an instance of ListOfFunctionDeﬁnitions in Model, as shown in Figure 10.\n4.3.1 The id and name attributes1\nThe id and name attributes have types SId and string, respectively, and operate in the manner described in2\nSection 3.3. MathML ci elements in an SBML model can refer to the function deﬁned by a FunctionDeﬁnition3\nusing the value of its id attribute.4\n4.3.2 The math element5\nThe math element is a container for MathML content that deﬁnes the function. The content of this element6\ncan only be a MathML lambda element or a MathML semantics element containing a lambda element. The7\nlambda element must begin with zero or more bvar elements, followed by any other of the elements in the8\nMathML subset listed in Section 3.4.1 except lambda (i.e., a lambda element cannot contain another lambda9\nelement). This is the only place in SBML where a lambda element can be used. The function deﬁned by10\na FunctionDeﬁnition is only available for use in other MathML elements that follow the FunctionDeﬁnition11\ndeﬁnition in the model. (These restrictions prevent deﬁnition of recursive and mutually-recursive functions .)12\nA further restriction on the content of math is that it cannot contain references to variables other than the13\nvariables declared to the lambda itself. That is, the contents of MathML ci elements inside the body of the14\nlambda can only be the variables declared by its bvar elements, or the identiﬁers of other FunctionDeﬁnitions15\ndeﬁned earlier in the model. This restriction also applies to the csymbol for time. Functions must be written16\nso that all variables or parameters used in the MathML content are passed to them via their function17\nparameters.18\nNote that FunctionDeﬁnition does not have a separate attribute for deﬁning the units of the value returned by19\nthe function. The units associated with the function’s return value, when the function is called from within20\nMathML expressions elsewhere in SBML, are simply the overall units of the expression in FunctionDeﬁnition’s21\nmath when applied to the arguments supplied in the call to the function. Ascertaining these units requires22\nperforming dimensional analysis on the expression. (Readers may wonder why there is no attribute. The23\nreason is that having a separate attribute for declaring the units would not only be redundant, but also lead24\nto the potential for having conﬂicting information. In the case of a conﬂict between the declared units and25\nthose of the value actually returned by the function, the only logical resolution rule would be to assume that26\nthe correct units are those of the expression anyway.)27\n4.3.3 The sboTerm attribute28\nFunctionDeﬁnition inherits an optional sboTerm attribute of type SBOTerm from its parent class Sbase (see29\nSections 3.1.9 and 5). When a value is given to this attribute in a FunctionDeﬁnition instance, it must be an30\nSBO identiﬁer referring to a mathematical expression (i.e., terms derived from SBO:0000064, “mathematical31\nexpression”). The relationship is of the form “the function deﬁnition is a X”, where X is the SBO term. The32\nterm chosen should be the most precise (narrow) one that captures the role of the function in the model.33\nAs discussed in Section 5, SBO labels are optional information on a model. Applications are free to ignore34\nsboTerm values. A model must be interpretable without the beneﬁt of SBO labels.35\n34\nNature Precedings : hdl:10101/npre.2007.58.1 : Posted 18 Jun 2007\n4.3.4 Examples1\nThe following abbreviated SBML example shows a FunctionDeﬁnition object instance deﬁning pow3 as the2\nidentiﬁer of a function computing the mathematical expression x3, and after that, the invocation of that3\nfunction in the mathematical formula of a rate law. Note how the invocation of the function uses its identiﬁer.4\n<model>5\n...6\n<listOfFunctionDefinitions>7\n<functionDefinition id=\"pow3\">8\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\">9\n<lambda>10\n<bvar><ci> x </ci></bvar>11\n<apply>12\n<power/>13\n<ci> x </ci>14\n<cn> 3 </cn>15\n</apply>16\n</lambda>17\n</math>18\n</functionDefinition>19\n</listOfFunctionDefinitions>20\n...21\n<listOfReactions>22\n<reaction id=\"reaction_1\">23\n...24\n<kineticLaw>25\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\">26\n<apply>27\n<ci> pow3 </ci>28\n<ci> S1 </ci>29\n</apply>30\n</math>31\n</kineticLaw>32\n...33\n</reaction>34\n</listOfReactions>35\n...36\n</model>37\n4.4 Unit deﬁnitions38\nUnits of measurement may be supplied in a number of contexts in an SBML model. The units of the39\nfollowing mathematical entities can be speciﬁed explicitly: the size of a Compartment, the initial amount of40\na Species, and the units of constant and variable Parameter values. The overall units of any mathematical41\nformula appearing in SBML are those that arise naturally from the components and mathematical expressions42\ncomprising the formula, or in other words, the units obtained by doing dimensional analysis on the formula.43\nRather than requiring a complete unit deﬁnition on every object, SBML provides a facility for deﬁning units44\nthat can be referenced throughout a model. In addition, every kind of SBML mathematical entity has units45\nassigned to it from a set of built-in defaults (see Section 4.4.3 below, and also Sections 4.7.5, 4.8.5 and 4.13.5).46\nBy redeﬁning these built-in default units, it is possible to change the units used throughout a model in a47\nsimple and consistent manner. The SBML unit deﬁnition facility uses two classes of objects, UnitDeﬁnition48\nand Unit. Their deﬁnitions are shown in Figure 12 on the following page and explained in more detail in49\nSections 4.4.1 and 4.4.2 below.50\nThe approach to deﬁning units in SBML is compositional; for example, meter second −2 is constructed by51\ncombining a Unit object representing meter with another Unit object representing second−2. The combina-52\ntion is wrapped inside a UnitDeﬁnition, which provides for assigning an identiﬁer and optional name to the53\ncombination. The identiﬁer can then be referenced from elsewhere in a model.54\nThe vast majority of modeling situations requiring new SBML unit deﬁnitions involve simple multiplicative55\ncombinations of base units and factors. An example of this might be “moles per litre per second”. What56\ndistinguishes these sorts of simpler unit deﬁnitions from more complex ones is that they may be expressed57\n35\nNature Precedings : hdl:10101/npre.2007.58.1 : Posted 18 Jun 2007\nSBase\nUnitDeﬁnition\nid: UnitSId {Excludes values from Table 1. }\nname: string { use=”optional”}\nListOfUnits\nUnit\nkind: UnitSId {Restricted to values in Table 1. }\nexponent: int { use=”optional” default=”1”}\nscale: int { use=”optional” default=”0”}\nmultiplier: double { use=”optional” default=”1”}\nlistOfUnits unit\n1..*\nFigure 12: The deﬁnition of classes UnitDeﬁnition and Unit. A sequence of one or more instances of UnitDeﬁnition can\nbe located in an instance of ListOfUnitDeﬁnitions in Model (Figure 10). ListOfUnits has no attributes (beyond those\nit inherits from class Sbase); it merely acts as a container for one or more instances of Unit objects. Note that the only\npermitted values of kind on Unit are the reserved words in Table 1 on the following page, but these symbols are excluded\nfrom the permitted values of UnitDeﬁnition’sid because SBML ’s unit system does not allow redeﬁning the base units.\nwithout the use of an additive oﬀset from a zero point. The use of oﬀsets complicates all unit deﬁnition1\nsystems, yet in the domain of SBML the real-life cases requiring oﬀsets are few (and in fact, to the best2\nof our knowledge, only involve temperature). Consequently, the SBML unit system has been consciously3\ndesigned in a way that attempts to simplify implementation of unit support for the most common cases in4\nsystems biology, at the cost of requiring units with oﬀsets to be handled explicitly by the modeler.5\n4.4.1 UnitDeﬁnition6\nA unit deﬁnition in SBML consists of an instance of a UnitDeﬁnition object, shown in Figure 12.7\nThe id and name attributes8\nThe required attribute id and optional attribute name have data types UnitSId and string, respectively.9\nThe id attribute is used to give the deﬁned unit a unique identiﬁer by which other parts of an SBML model10\ndeﬁnition can refer to it. The name attribute is intended to be used for giving the unit deﬁnition an optional11\nhuman-readable name; see Section 3.3.2 for more guidelines about the use of names.12\nThere are two important restrictions and guidelines about the use of unit deﬁnition id values:13\n1. The id of a UnitDeﬁnition must not contain a value from Table 1, the list of reserved base unit names.14\nThis constraint simply prevents the redeﬁnition of base units .15\n2. There is a set of predeﬁned identiﬁers for the built-in default units in SBML; these identiﬁers are16\n“substance”, “ volume”, “ area”, “ length”, and “ time”. Using one of these values for id in a UnitDef-17\ninition has the eﬀect of redeﬁning the model-wide default units for the corresponding quantities. We18\ndiscuss this in more detail in Section 4.4.3.19\nThe list of Units20\nA UnitDeﬁnition object must contain one or more Unit objects inside a ListOfUnits container. Section 4.4.221\nexplains the meaning and use of Unit.22\nExample23\nThe following skeleton of a unit deﬁnition illustrates an example use of UnitDeﬁnition:24\n<model>25\n<listOfUnitDefinitions>26\n<unitDefinition id=\"unit1\">27\n<listOfUnits>28\n...29\n</listOfUnits>30\n36\nNature Precedings : hdl:10101/npre.2007.58.1 : Posted 18 Jun 2007\n</unitDefinition>1\n<unitDefinition id=\"unit2\">2\n<listOfUnits>3\n...4\n</listOfUnits>5\n</unitDefinition>6\n</listOfUnitDefinitions>7\n...8\n</model>9\n4.4.2 Unit10\nA Unit object represents a (possibly transformed) reference to a base unit chosen from the list in Table 1.11\nThe attribute kind indicates the chosen base unit, whereas the attributes exponent, scale, and multiplier12\ndeﬁne how the base unit is being transformed. These various attributes are described in detail below.13\nIn SBML Level 2 Version 1 , Unit had an additional attribute called offset. This attribute has been removed14\nentirely in Level 2 Versions 2 and 3 . Modelers and software authors are instead directed to use other methods15\nof encoding units requiring oﬀsets. The reasons for this change, and some suggestions for how to achieve16\nequivalent eﬀects of unit oﬀsets, are discussed in more detail below. Another change in Version 3 is the17\nremoval of the enumeration UnitKind and the redeﬁnition of UnitSId to include the previous UnitKind18\nvalues as reserved symbols. This change has no net eﬀect on permissible models or their representation.19\nThe kind attribute20\nThe Unit object class has one required attribute, kind, whose value must be taken from the list of reserved21\nwords given in Table 1. These reserved symbols are in the value space of UnitSId (Section 3.1.8).22\n23 ampere gram katal metre second watt\n24 becquerel gray kelvin mole siemens weber\n25 candela henry kilogram newton sievert\n26 coulomb hertz litre ohm steradian\n27 dimensionless item lumen pascal tesla\n28 farad joule lux radian volt\nTable 1: Base units deﬁned in SBML. These symbols are predeﬁned values of type UnitSId (Section 3.1.8). All are\nnames of base or derived SI units ( Bureau International des Poids et Mesures , 2000), except for “ dimensionless” and\n“item”, which are SBML additions important for handling certain common situations. “ Dimensionless” is intended for\ncases where a quantity is a ratio whose units cancel out , and “ item” for expressing such things as “N items” (e.g., “100\nmolecules”). Also, note that the gram and litre are not strictly part of SI; however, they are frequently used in SBML ’s\nareas of application and therefore are included as predeﬁned unit identiﬁers. (The standard SI unit of mass is in fact the\nkilogram, and volume is deﬁned in terms of cubic metres.) Comparisons of these values , like all values of type UnitSId,\nmust performed in a case-sensitive manner.\nNote that the set of acceptable values for the attribute kind does not include units deﬁned by UnitDeﬁnition29\nobject. This means that the units deﬁnition system in SBML is not hierarchical: user-deﬁned units cannot30\nbe built on top of other user-deﬁned units, only on top of base units. SBML diﬀers from CellML ( Hedley31\net al. , 2001) in this respect; CellML allows the construction of hierarchical unit deﬁnitions.32\nThe exponent, scale and multiplier attributes33\nThe optional exponent attribute on Unit represents an exponent on the unit. Its default value is “ 1” (one).34\nA Unit object also has an optional scale attribute; its value must be an integer exponent for a power-of-35\nten multiplier used to set the scale of the unit. For example, a unit having a kind value of “ gram” and a36\nscale value of “ -3” signiﬁes 10 −3 × gram, or milligrams. The default value of scale is “ 0” (zero), because37\n100 = 1. Lastly, the optional multiplier attribute can be used to multiply the kind unit by a real-numbered38\nfactor; this enables the deﬁnition of units that are not power-of-ten multiples of SI units. For instance, a39\nmultiplier of 0.3048 could be used to deﬁne “ foot” as a measure of length in terms of a metre. The40\nmultiplier attribute has a default value of “ 1” (one).41\n37\nNature Precedings : hdl:10101/npre.2007.58.1 : Posted 18 Jun 2007\nThe unit system allows model quantities to be expressed in units other than the base units of Table 1. For1\nanalyses and computations, the consumer of the model (be it a software tool or a human) will want to convert2\nall model quantities to base SI units for purposes such as verifying the consistency of units throughout the3\nmodel. Suppose we begin with a quantity having numerical value y when expressed in units {u}. The4\nrelationship between y and a quantity yb expressed in base units {ub} is5\nyb {ub} = y {u}\n(w {ub}\n{u}\n)\n(1)6\nThe term in the parentheses on the right-hand side is a factor w for converting a quantity in units {u} to7\nanother quantity in units {ub}. The ratio of units leads to canceling of {u} in the equation above and leaves8\na quantity in units {ub}. It remains to deﬁne this factor. In terms of the SBML unit system, it is:9\n{u} = (multiplier · 10scale {ub})exponent (2)10\nwhere the dot ( ·) represents simple scalar multiplication. The variables multiplier, scale, and exponent in11\nthe equation above correspond to the attributes with the same names in the Unit object deﬁned in Figure 12.12\nThe exponent in the equation above may make it more diﬃcult to grasp the relationship immediately; so let13\nus suppose for the moment that exponent=“1”. Then, it is easy to see that14\n{u} = multiplier · 10scale {ub}15\nDividing both sides by {u} produces the ratio in the parenthesized portion of Equation 1, which means that16\nw = multiplier ·10scale. To take a concrete example, one foot expressed in terms of the metre (a base unit)17\nrequires multiplier=“0.3048”, exponent=“1”, and scale=“0”:18\nfoot = 0 .3048 · 100 · metre19\n20\nleading to a conversion between quantities of21\nyb metres = 0 .3048 · y feet22\n23\nGiven a quantity of, say, y = 2, the conversion results in yb = 0 .6096. To relate this to SBML terms more24\nconcretely, the following fragment of SBML illustrates how this is represented using the Unit and UnitDeﬁnition25\nconstructs:26\n<listOfUnitDefinitions>27\n<unitDefinition id=\"foot\">28\n<listOfUnits>29\n<unit kind=\"metre\" multiplier=\"0.3048\"/>30\n</listOfUnits>31\n</unitDefinition>32\n</listOfUnitDefinitions>33\nThe case above is the simplest possible situation, involving the transformation of quantities from a single34\ndeﬁned unit {u} into a quantity expressed in a single base unit {ub}. If, instead, multiple base units35\n{ub1 }, {ub2 }, . . . , {ubn } are involved, the following equation holds (where the mi terms are the multiplier36\nvalues, the si terms are the scale values, and the xi terms are the exponent values):37\n{u} = (m1 · 10s1 {ub1 })x1 · (m2 · 10s2 {ub2 })x2 · . . . · (mn · 10sn {ubn })xn38\n= mx1\n1 · mx2\n2 · . . . · mxn\nn · 10(s1x1+s2x2+...+snxn){ub1 }x1 {ub2 }x2 . . . {ubn }xn (3)39\n40\nSoftware developers should take care to track the exponents carefully because they can be negative integers.41\nThe overall use of Equation 3 is analogous to that of Equation 2, and leads to the following ﬁnal expression.42\nFirst, to simplify, let43\nm = mx1\n1 · mx2\n2 · . . . · mxn\nn44\np = s1x1 + s2x2 + . . . + snxn45\n46\n38\nNature Precedings : hdl:10101/npre.2007.58.1 : Posted 18 Jun 2007\nthen,1\nyb {ub1 }{ub2 }. . . {ubn } = y {u}\n(m · 10p{ub1 }x1 {ub2 }x2 . . . {ubn }xn\n{u}\n)\n(4)2\n3\nSome additional points are worth discussing about the unit scheme introduced so far. First, and most4\nimportantly, the equations above are formulated with the assumption that the base units do not require5\nan additive oﬀset as part of their deﬁnition. When temperature values in units other than kelvin are being6\nconsidered, then a diﬀerent interpretation must be made , as discussed below.7\nA second point is that care is needed to avoid seemingly-obvious but incorrect translations of units described8\nin textbooks. The scheme above makes it easy to formulate statements such as “1 foot = 0.3048 metres”9\nin the most natural way. However, the most common expression of the relationship between temperature in10\nFahrenheit and kelvin, “ TF ahrenheit= 1 .8 · (Tkelvin − 273.15) + 32” might lead one to believe that deﬁning11\nFahrenheit degrees in terms of kelvin degrees involves using multiplier=“1.8”. Not so, when degree changes12\nare being considered and not temperature values. Converting temperature values is diﬀerent from expressing13\na relationship between degree measurements. The proper value for the multiplier in the latter case is 5 /9,14\ni.e., multiplier=“0.555556” (where we picked an arbitrary decimal precision). If, on the other hand, the15\nactual temperature is relevant to a quantity (e.g., if a model uses a quantity that has particular values at16\nparticular temperatures), then oﬀsets are required in the unit calculations and a formula must be used as17\ndiscussed above.18\nHandling units requiring the use of offsets in SBML Level 2 Version 319\nUnit deﬁnitions and conversions requiring oﬀsets cannot be done using the simple approach above. The20\nmost general case, involving oﬀsets, multipliers and exponents, requires a completely diﬀerent approach to21\ndeﬁning units than what has been presented up to this point.22\nIn previous versions of SBML, not only was the general case incorrectly presented (i.e., in the same terms23\ndescribed above, when in reality a diﬀerent approach is required), but few if any developers even attempted24\nto support oﬀset-based units in their software. In the development of SBML Level 2 Version 2, a consensus25\namong SBML developers emerged that a fully generalized unit scheme is so confusing and complicated that26\nit actually impedes interoperability. Level 2 Version 2 and Version 3 acknowledge this reality by reducing27\nand simplifying the unit system, speciﬁcally by removing the offset attribute on Unit and Celsius as a28\npre-deﬁned unit, and by describing approaches for handling Celsius and other temperature units. This is a29\nbackwards-incompatible change relative to SBML Level 2 Version 1 and SBML Level 1 Version 2, but it is30\nbelieved to have limited real-life impact because so few tools and models appeared to have employed this31\nfeature anyway. By simplifying the unit system to the point that it only involves multiplicative factors as32\ndescribed above, we expect that more software tools will be able to support the SBML unit system from this33\npoint forward, ultimately improving interoperability.34\nWe ﬁrst address the question of how to handle units that do require oﬀsets:35\n• Handling Celsius . A model in which certain quantities are temperatures measured in degrees Celsius36\ncan be converted straightforwardly to a model in which those temperatures are in kelvin. A software37\ntool could do this by performing a straightforward substitution using the following relationship:38\nTkelvin = TCelsius + 273.15 (5)39\nIn every mathematical formula of the model where a quantity (call it x) in degrees Celsius appears,40\nreplace x with xk + 273 .15 where xk is now in kelvin. An alternative approach would be to use a41\nFunctionDeﬁnition to deﬁne a function encapsulating this relationship above and then using that in the42\nrest of the model as needed. Since Celsius is a commonly-used unit, software tools could help users by43\nproviding users with the ability to express temperatures in Celsius in the tools’ interfaces, and making44\nsubstitutions automatically when writing out the SBML.45\n• Handling other units requiring oﬀsets . The only other units requiring oﬀsets in SBML’s domain of46\ncommon applications are other temperature units such as Fahrenheit. Few modern scientists employ47\n39\nNature Precedings : hdl:10101/npre.2007.58.1 : Posted 18 Jun 2007\nFahrenheit degrees; therefore, this is an unusual situation. The complication inherent in converting1\nbetween degrees Fahrenheit and kelvin is that both a multiplier and an oﬀset are required:2\nTkelvin = TF + 459.67\n1.8 (6)3\nOne approach to handling this is to use a FunctionDeﬁnition to deﬁne a function encapsulating the4\nrelationship above, then to substitute a call to this function wherever the original temperature in5\nFahrenheit appears in the model’s mathematical formulas. Here is a candidate deﬁnition as an example:6\n<functionDefinition id=\"Fahrenheit_to_kelvin\">7\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\">8\n<lambda>9\n<bvar><ci> temp_in_fahrenheit </ci></bvar>10\n<apply>11\n<divide/>12\n<apply>13\n<plus/>14\n<ci> temp_in_fahrenheit </ci>15\n<cn> 459.67 </cn>16\n</apply>17\n<cn> 1.8 </cn>18\n</apply>19\n</lambda>20\n</math>21\n</functionDefinition>22\n23\nAn alternative approach not requiring the use of function deﬁnitions is to use an AssignmentRule for24\neach variable in Fahrenheit units. The AssignmentRule could compute the conversion from Fahrenheit25\nto (say) kelvin, assign its value to a variable (in Kelvin units), and then that variable could be used26\nelsewhere in the model. Still another approach is to rewrite the mathematical formulas of a model to27\ndirectly incorporate the conversion Equation 6 wherever the quantity appears.28\nAll of these approaches provide general solutions to the problem of supporting any units requiring oﬀsets29\nin the unit system of SBML Level 2 Version 2 and Version 3 . It can be used for other temperature30\nunits requiring an oﬀset (e.g., degrees Rankine, degrees R´ eaumur), although the likelihood of a real-life31\nmodel requiring such other temperature units seems exceedingly small.32\nIn summary, the removal of offset does not impede the creation of models using alternative units. If conver-33\nsions are needed, then converting between temperature in degrees Celsius and thermodynamic temperature34\ncan be handled rather easily by the simple substitution described above. For the rarer case of Fahrenheit35\nand other units requiring combinations of multipliers and oﬀsets, users are encouraged to employ the power36\nof FunctionDeﬁnition, AssignmentRule, or other constructs in SBML.37\nExamples38\nThe following example illustrates the deﬁnition of an abbreviation “ mmls” for the units mmol l −1 s−1:39\n<listOfUnitDefinitions>40\n<unitDefinition id=\"mmls\">41\n<listOfUnits>42\n<unit kind=\"mole\" scale=\"-3\"/>43\n<unit kind=\"litre\" exponent=\"-1\"/>44\n<unit kind=\"second\" exponent=\"-1\"/>45\n</listOfUnits>46\n</unitDefinition>47\n</listOfUnitDefinitions>48\n4.4.3 Built-in units49\nThere are ﬁve special unit identiﬁers in SBML, listed in Table 2 on the next page, corresponding to the ﬁve50\ntypes of quantities that can play roles in SBML reactions: substance, volume, area, length and time. All51\n40\nNature Precedings : hdl:10101/npre.2007.58.1 : Posted 18 Jun 2007\nSBML mathematical entities apart from parameters have default units drawn from these predeﬁned values.1\nTable 2 lists the default values; all of the defaults have multiplier=“1” and scale=“0”.2\n3 Identiﬁer Possible Scalable Units Default Units\n4 substance mole, item, gram, kilogram, dimensionless mole\n5 volume litre, cubic metre, dimensionless litre\n6 area square metre, dimensionless square metre\n7 length metre, dimensionless metre\n8 time second, dimensionless second\nTable 2: SBML ’s built-in units.The identiﬁers in the left-most column are values of UnitSId (Section 3.1.8).\nRedeﬁnition of built-in units9\nTable 2 also lists alternative base units that are allowed as the basis of redeﬁned values. For example, a10\nredeﬁnition of the built-in unit of time must be based on units of seconds. Within certain limits, a model11\nmay change the built-in units by reassigning the keywords substance, length, area, time, and volume in a12\nUnitDeﬁnition. The limitations on redeﬁnitions of base units are the following:13\n1. The UnitDeﬁnition of a redeﬁned built-in unit can only contain a single Unit object within it.14\n2. The value of the kind attribute in a Unit instance must be drawn from one of the values in the second15\ncolumn of the appropriate row of Table 2.16\nExamples17\nThe following example illustrates how to change the built-in units of volume to be millilitres. If this deﬁnition18\nappeared in a model, the units of volume on all components that did not explicitly specify diﬀerent units19\nwould be changed to millilitres.20\n<model>21\n...22\n<listOfUnitDefinitions>23\n<unitDefinition id=\"volume\">24\n<listOfUnits>25\n<unit kind=\"litre\" scale=\"-3\"/>26\n</listOfUnits>27\n</unitDefinition>28\n</listOfUnitDefinitions>29\n...30\n</model>31\n4.4.4 References to units32\nAn attribute that deﬁnes the units of a mathematical entity (e.g., the attribute units on Parameter) can33\nrefer to a deﬁned unit whose identiﬁer is chosen from among the following:34\n• A new unit identiﬁer deﬁned by a UnitDeﬁnition as described at the start of Section 4.4;35\n• The base units listed in Table 1 on page 37; and36\n• The built-in units deﬁned in Section 4.4.3 and listed in Table 2. (These are “ substance”, “ volume”,37\n“area”, “ length”, and “ time”.)38\nSoftware developers are asked to pay special attention to the units used in an SBML model. Diﬀerent39\nusers and developers sometimes are accustomed to making diﬀerent assumptions about units, and these40\nassumptions may not correspond to what is actually deﬁned in SBML. The numerical values in a model41\nbecome meaningless if the corresponding units are not those being assumed. Sections 3.4.3, 4.8.5 and 4.13.542\nhave particularly important notes about the usage of units in SBML.43\n41\nNature Precedings : hdl:10101/npre.2007.58.1 : Posted 18 Jun 2007\n4.5 Compartment types1\nA compartment type in SBML is a grouping construct used to establish a relationship between multiple2\ncompartments (Section 4.7). A compartment type is represented by the CompartmentType object class ,3\nSBase\nCompartmentType\nid: SId\nname: string { use=”optional”}\nFigure 13: The deﬁnition of class\nCompartmentType. A sequence of\none or more instances of Compart-\nmentType objects can be located in\nan instance of ListOfCompartment-\nTypes in Model, as shown in Fig-\nure 10.\ndeﬁned in Figure 13.4\nIn SBML Level 2 Version 3 , a compartment type only has an5\nidentity, and this identity can only be used to indicate that par-6\nticular compartments belong to this type. This may be useful for7\nconveying a modeling intention, such as when a model contains8\nmany similar compartments, either by their biological function or9\nthe reactions they carry; without a compartment type construct,10\nit would be impossible in the language of SBML to indicate that11\nall of the compartments share an underlying conceptual relation-12\nship because each SBML compartment must be given a unique13\nand separate identity. Compartment types have no mathemati-14\ncal meaning in SBML Level 2 Version 3 —they have no eﬀect on a15\nmodel’s mathematical interpretation. Simulators and other nu-16\nmerical analysis software may ignore CompartmentType objects17\nand references to them in a model.18\nThere is no mechanism in SBML for representing hierarchies of compartment types. One CompartmentType19\nobject instance cannot be the subtype of another CompartmentType object; SBML provides no means of20\ndeﬁning such relationships.21\n4.5.1 The id and name attributes22\nAs with other major class of objects in SBML, CompartmentType has a mandatory attribute, id, used to give23\nthe compartment type an identiﬁer. The identiﬁer must be a text string conforming to the syntax permitted24\nby the SId data type described in Section 3.1.7. CompartmentType also has an optional name attribute, of25\ntype string. The name and id attributes must be used as described in Section 3.3.26\n4.5.2 The sboTerm attribute27\nCompartmentType inherits an optional sboTerm attribute of type SBOTerm from its parent class Sbase (see Sec-28\ntions 3.1.9 and 5). When a value is given to this attribute in a CompartmentType instance, the value must be29\nan SBO identiﬁer referring to a participant physical type (i.e., terms derived from SBO:0000236,“participant30\nphysical type”). The relationship is of the form “the compartment type is a X”, where X is the SBO term.31\nThe term chosen should be the most precise (narrow) one that captures the role of the compartment type32\nin the model.33\n4.5.3 Examples34\nThe following partial SBML example illustrates a compartment type used to relate together many individual35\ncompartments in a hypothetical model.36\n<model>37\n...38\n<listOfCompartmentTypes>39\n<compartmentType id=\"mitochondria\"/>40\n</listOfCompartmentTypes>41\n<listOfCompartments>42\n<compartment id=\"m1\" size=\"0.013\" compartmentType=\"mitochondria\" outside=\"cell\"/>43\n<compartment id=\"m2\" size=\"0.013\" compartmentType=\"mitochondria\" outside=\"cell\"/>44\n<compartment id=\"m3\" size=\"0.013\" compartmentType=\"mitochondria\" outside=\"cell\"/>45\n<compartment id=\"cell\" size=\"190.0\"/>46\n</listOfCompartments>47\n...48\n</model>49\n42\nNature Precedings : hdl:10101/npre.2007.58.1 : Posted 18 Jun 2007\n4.6 Species types1\nThe term species type refers to reacting entities independent of location. These include simple ions (e.g.,2\nprotons, calcium), simple molecules (e.g., glucose, ATP), large molecules (e.g., RNA, polysaccharides, and3\nSBase\nSpeciesType\nid: SId\nname: string { use=”optional”}\nFigure 14: The deﬁnition of class\nSpeciesType. A sequence of one or\nmore instances of SpeciesType ob-\njects can be located in an instance\nof ListOfSpeciesTypes in Model, as\nshown in Figure 10.\nproteins), and others. The SpeciesType object class is intended4\nto represent these entities. Its deﬁnition is shown in Figure 14.5\nSpeciesType objects are included in SBML to enable Species6\n(Section 4.8) of the same type to be related together. It is a7\nconceptual construct; the existence of SpeciesType objects in a8\nmodel has no eﬀect on the model’s numerical interpretation.9\nExcept for the requirement for uniqueness of species/species10\ntype combinations located in compartments (described in Sec-11\ntion 4.8.2), simulators and other numerical analysis software12\nmay ignore SpeciesType structures and references to them in a13\nmodel.14\nThere is no mechanism in SBML for representing hierarchies of15\nspecies types. One SpeciesType object instance cannot be the16\nsubtype of another SpeciesType; SBML provides no means of17\ndeﬁning such relationships.18\n4.6.1 The id and name attributes19\nAs with other major object classes in SBML, SpeciesType has a mandatory attribute, id, used to give the20\nspecies type an identiﬁer. The identiﬁer must be a text string conforming to the syntax permitted by the21\nSId data type described in Section 3.1.7. SpeciesType also has an optional name attribute, of type string.22\nThe name and id attributes must be used as described in Section 3.3.23\n4.6.2 The sboTerm attribute24\nSpeciesType inherits an optional sboTerm attribute of type SBOTerm from its parent class Sbase (see Sec-25\ntions 3.1.9 and 5). When a value is given to this attribute in a SpeciesType instance, the value must be an26\nSBO identiﬁer referring to a participant physical type (i.e., terms derived from SBO:0000236,“participant27\nphysical type”). The relationship is of the form “the species type is a X”, where X is the SBO term. The28\nterm chosen should be the most precise (narrow) one that captures the role of the compartment type in the29\nmodel.30\n4.6.3 Example31\nThe following XML fragment is an example of two SpeciesType objects embedded in an SBML model.32\n<model>33\n...34\n<listOfSpeciesTypes>35\n<speciesType id=\"ATP\"/>36\n</listOfSpeciesTypes>37\n<listOfCompartments>38\n<compartment id=\"cytosol\"/>39\n<compartment id=\"mitochon\"/>40\n</listOfCopartments>41\n<listOfSpecies>42\n<species id=\"ATPc\" speciesType=\"ATP\" compartment=\"cytosol\" initialConcentration=\"1\"/>43\n<species id=\"ATPm\" speciesType=\"ATP\" compartment=\"mitochon\" initialConcentration=\"2\"/>44\n</listOfSpecies>45\n...46\n</model>47\n43\nNature Precedings : hdl:10101/npre.2007.58.1 : Posted 18 Jun 2007\n4.7 Compartments1\nA compartment in SBML represents a bounded space in which species are located. Compartments do not2\nnecessarily have to correspond to actual structures inside or outside of a biological cell, although models are3\noften designed that way. The deﬁnition of Compartment is shown in Figure 15.4\nSBase\nCompartment\nid: SId\nname: string { use=”optional”}\ncompartmentType: SId { use=”optional”}\nspatialDimensions: int { maxInclusive=”3” minInclusive=”0” use=”optional” default=”3”}\nsize: double { use=”optional”}\nunits: UnitSId { use=”optional”}\noutside: SId { use=”optional”}\nconstant: boolean { use=”optional” default=”true”}\nFigure 15: The deﬁnition of class Compartment. A sequence of one or more instances of Compartment objects can be\nlocated in an instance of ListOfCompartments in Model, as shown in Figure 10.\nIt is important to note that although compartments are optional in the overall deﬁnition of Model (see5\nSection 4.2), every species in an SBML model must be located in a compartment. This in turn means that6\nif a model deﬁnes any species, the model must also deﬁne at least one compartment. The reason is simply7\nthat species represent physical things, and therefore must exist somewhere. Compartments represent the8\nsomewhere.9\n4.7.1 The id and name attributes10\nCompartment has one required attribute, id, of type SId, to give the compartment a unique identiﬁer by11\nwhich other parts of an SBML model deﬁnition can refer to it. A compartment can also have an optional12\nname attribute of type string. Identiﬁers and names must be used according to the guidelines described in13\nSection 3.3.14\n4.7.2 The compartmentType attribute15\nEach compartment in a model may optionally be designated as belonging to a particular compartment type.16\nThe optional attribute compartmentType of type SId is used identify the compartment type represented by17\nthe Compartment object. The compartmentType attribute’s value must be the identiﬁer of a CompartmentType18\ninstance deﬁned in the model. If the compartmentType attribute is not present on a particular compartment19\ndeﬁnition, a unique virtual compartment type is assumed for that compartment, and no other compartment20\ncan belong to that compartment type.21\nThe values of compartmentType attributes on compartments have no eﬀect on the numerical interpretation22\nof a model. Simulators and other numerical analysis software may ignore compartmentType attributes.23\n4.7.3 The spatialDimensions attribute24\nA Compartment object has an optional attribute spatialDimensions, whose value must be a positive integer25\nindicating the number of spatial dimensions possessed by the compartment. The maximum value is “ 3”,26\nmeaning a three-dimensional structure (a volume). Other permissible values are “ 2” (for a two-dimensional27\narea), “ 1” (for a one-dimensional curve), and “ 0” (for a point). The default value is “ 3”. Note that the28\nnumber of spatial dimensions possessed by a compartment aﬀects certain aspects of the compartment’s size29\nand units-of-size; see the following two subsections.30\n44\nNature Precedings : hdl:10101/npre.2007.58.1 : Posted 18 Jun 2007\n4.7.4 The size attribute1\nEach compartment has an optional ﬂoating-point attribute named size, representing the initial total size of2\nthe compartment. The size may be a volume (if the compartment is a three-dimensional one), or it may be3\nan area (if the compartment is two-dimensional), or a length (if the compartment is one-dimensional).4\nIt is important to note that in SBML Level 2, a missing size value does not imply that the compartment size5\nis 1 . There is no default value of compartment size. (This is unlike the deﬁnition of compartment volume in6\nSBML Level 1.) When the spatialDimensions attribute does not have a value of “ 0”, a missing value for7\nsize for a given compartment signiﬁes that the value either is unknown, or to be obtained from an external8\nsource, or determined by an initial assignment (Section 4.10) or a rule (Section 4.11) elsewhere in the model.9\nThe size attribute must not be present if the spatialDimensions attribute has a value of “ 0”; otherwise,10\na logical inconsistency would exist because a zero-dimensional object cannot have a physical size.11\nA compartment’s size is set by its size attribute exactly once. If the compartment’s constant attribute12\nvalue is “ true” (the default), then the size is ﬁxed and cannot be changed except by an InitialAssignment in13\nthe model (and if spatialDimensions=“0”, it cannot be changed by any InitialAssignment either). These14\nmethods of setting the size diﬀer in that the size attribute can only be used to set the compartment size to15\na literal scalar value, whereas InitialAssignment allows the value to be set using an arbitrary mathematical16\nexpression. If the compartment’s constant attribute is “ false”, the size value may be overridden by an17\nInitialAssignment or changed by an AssignmentRule or AlgebraicRule, and in addition, for simulation time18\nt > 0, it may also be changed by a RateRule or Events. (However, some constructs are mutually exclusive; see19\nSections 4.11 and 4.14.) It is not an error to deﬁne size on a compartment and also redeﬁne the value using20\nan InitialAssignment, but the size value in that case is ignored. Section 3.4.8 provides additional information21\nabout the semantics of assignments, rules and values for simulation time t ≤ 0.22\nFor the reasons given above, the size attribute on a compartment must be deﬁned as optional; however, it23\nis extremely good practice to specify values for compartment sizes when such values are available. There are24\ntwo major technical reasons for this. First, models ideally should be instantiable in a variety of simulation25\nframeworks. A commonly-used one is the discrete stochastic framework ( Gillespie, 1977; Wilkinson, 2006)26\nin which species are represented as item counts (e.g., molecule counts). If species’ initial quantities are given27\nin terms of concentrations or densities, it is impossible to convert the values to item counts without knowing28\ncompartment sizes. Second, and more importantly, if a model contains multiple compartments whose sizes29\nare not all identical to each other, it is impossible to quantify the reaction rate expressions without knowing30\nthe compartment volumes. The reason for the latter is that reaction rates in SBML are deﬁned in terms31\nof substance/time (see Section 4.13.5), and when species quantities are given in terms of concentrations or32\ndensities, the compartment sizes become factors in the reaction rate expressions.33\n4.7.5 The units attribute34\nThe units associated with the compartment’s size value may be set using the optional attribute units. The35\ndefault units, and the kinds of units allowed as values of the attribute units, interact with the number of36\nspatial dimensions of the compartment. The value of the units attribute of a Compartment object must be37\none of the base units from Table 1, or the built-in units “ volume”, “ area”, “ length” or “ dimensionless”, or38\na new unit deﬁned by a unit deﬁnition in the enclosing model, subject to the restrictions detailed in Table 3.39\n40 Value of attribute size units Default value\n41 spatialDimensions allowed? allowed? Allowable kinds of units of attribute units\n42 “3” yes yes units of volume, or dimensionless “volume”\n43 “2” yes yes units of area, or dimensionless “area”\n44 “1” yes yes units of length, or dimensionless “length”\n45 “0” no no (no units allowed)\nTable 3: The units permitted for compartment sizes. If spatialDimensions=“0”, the compartment’s units attribute\nmust be left unset. Units of volume means litres, cubic metres, or units derived from them; units of area means square\nmetres or units derived from square metres; and units of length means metres or units derived from metres. (See also\nTable 2 on page 41 and Table 1 on page 37.)\n45\nNature Precedings : hdl:10101/npre.2007.58.1 : Posted 18 Jun 2007\nThe units of the compartment size, as deﬁned by the units attribute or (if units is not set) the default1\nvalue listed in Table 3 on the preceding page , are used in the following ways when the compartment has a2\nspatialDimensions value greater than “ 0”:3\n• The value of the units attribute is used as the units of the compartment identiﬁer when the identi-4\nﬁer appears as a numerical quantity in a mathematical formula expressed in MathML (discussed in5\nSection 3.4.3).6\n• The math element of an AssignmentRule or InitialAssignment referring to this compartment must have7\nidentical units (see Sections 4.11.3 and 4.10).8\n• In RateRule objects that set the rate of change of the compartment’s size (Section 4.11.4), the units of9\nthe rule’s math element must be identical to the compartment’s units attribute divided by the default10\ntime units. (In other words, the units for the rate of change of compartment size are compartment11\nsize/time units.)12\n• When a Species is to be treated in terms of concentrations or density, the units of the spatial size13\nportion of the concentration value (i.e., the denominator in the units formula substance/size) are those14\nindicated by the value of the units attribute on the compartment in which the species is located.15\nCompartments with spatialDimensions=“0” require special treatment in this framework. If a compartment16\nhas no size or dimensional units, how should such a compartment’s identiﬁer be interpreted when it appears17\nin mathematical formulas? The answer is that such a compartment’s identiﬁer should not appear in mathe-18\nmatical formulas in the ﬁrst place—it has no value, and its value cannot change (Section 4.7.6). Note also19\nthat a zero-dimensional compartment is a point, and species located at points can only be described in terms20\nof amounts, not spatially-dependent measures such as concentration. Since SBML KineticLaw formulas are21\nalready in terms of substance/time and not (say) concentration/time, volume or other factors in principle22\nare not needed for species located in zero-dimensional compartments.23\n4.7.6 The constant attribute24\nA Compartment also has an optional boolean attribute called constant that indicates whether the com-25\npartment’s size stays constant or can vary during a simulation. A value of “ false” indicates the com-26\npartment’s size can be changed by other constructs in SBML. A value of “ true” indicates the compart-27\nment’s size cannot be changed by any other construct except InitialAssignment. In the special case of28\nspatialDimensions=“0”, the value cannot be changed by InitialAssignment either. The default value for the29\nconstant attribute is “ true” because in the most common modeling scenarios at the time of this writing,30\ncompartment sizes remain constant. The constant attribute must default to or be set to “ true” if the value31\nof the spatialDimensions attribute is “ 0”, because a zero-dimensional compartment cannot ever have a32\nsize.33\n4.7.7 The outside attribute34\nThe optional attribute outside of type SId can be used to express containment relationships between com-35\npartments. If present, the value of outside for a given compartment must be the id attribute value of36\nanother compartment already deﬁned in the model. Doing so means that the other compartment contains37\nit or is “outside” of it. This enables the representation of simple topological relationships between compart-38\nments, for those simulation systems that can make use of the information (e.g., for drawing simple diagrams39\nof compartments).40\nThere are two restrictions on the containment relationships in SBML. First, because a compartment with41\nspatialDimensions of “ 0” has no size, such a compartment cannot act as the container of any other com-42\npartment except compartments that also have spatialDimensions values of “ 0”. Second, the directed graph43\nformed by representing Compartment objects as vertexes and the outside attribute values as edges must be44\nacyclic. The latter condition is imposed to prevent a compartment from being contained inside itself.45\nAlthough containment relationships are partly taken into account by the compartmental localization of46\nreactants and products, it is not always possible to determine purely from the reaction equations whether47\n46\nNature Precedings : hdl:10101/npre.2007.58.1 : Posted 18 Jun 2007\none compartment is meant to be located within another. In the absence of a value for outside, compartment1\ndeﬁnitions in SBML Level 2 do not have any implied spatial relationships between each other. For many2\nmodeling applications, the transfer of substances described by the reactions in a model suﬃciently express the3\nrelationships between the compartments. (As discussed in Section 8.1, SBML Level 3 is expected introduce4\nthe ability to deﬁne geometries and spatial qualities.)5\n4.7.8 The sboTerm attribute6\nCompartment inherits an optional sboTerm attribute of type SBOTerm from its parent class Sbase (see Sec-7\ntions 3.1.9 and 5). When a value is given to this attribute in a Compartment instance, the value must be8\nan SBO identiﬁer referring to a participant physical type (i.e., terms derived from SBO:0000236,“participant9\nphysical type”). The relationship is of the form “the compartment is a X”, where X is the SBO term. The10\nterm chosen should be the most precise (narrow) one that captures the role of the compartment type in the11\nmodel.12\n4.7.9 Examples13\nThe following example illustrates two compartments in an abbreviated SBML example of a model deﬁnition:14\n<model>15\n...16\n<listOfCompartments>17\n<compartment id=\"cytosol\" size=\"2.5\"/>18\n<compartment id=\"mitochondria\" size=\"0.3\"/>19\n</listOfCompartments>20\n...21\n</model>22\nThe following is an example of using outside to model a cell membrane. To express that a compartment23\nwith identiﬁer “ B” has a membrane that is modeled as another compartment “ M”, which in turn is located24\nwithin another compartment “ A”, one would write:25\n<model>26\n...27\n<listOfCompartments>28\n<compartment id=\"A\"/>29\n<compartment id=\"M\" spatialDimensions=\"2\" outside=\"A\"/>30\n<compartment id=\"B\" outside=\"M\"/>31\n</listOfCompartments>32\n...33\n</model>34\n4.8 Species35\nA species refers to a pool of reacting entities of a speciﬁc species type that take part in reactions and are36\nlocated in a speciﬁc compartment. The Species object class is intended to represent these pools. Its deﬁnition37\nis shown in Figure 16 on the next page. Although the exact deﬁnition of Species given here has changed from38\nthe deﬁnition in the speciﬁcation of SBML Level 2 Version 1 (i.e., through the introduction of SpeciesType),39\nthe concept represented by Species remains the same.40\nIn previous versions of SBML Level 2, the class Species included an attribute called spatialSizeUnits,41\nwhich allowed explicitly setting the units of size for initial concentration. SBML Level 2 Version 3 removes42\nthis attribute for two reasons. First, its semantics were confusing and introduced an implicit unit conversion.43\nCompartment has its own size-setting attribute, and a separate attribute on Species meant that a species’44\ninitial concentration could involve spatial size units that are diﬀerent from the units of the compartment45\nin which the species was located. Since (a) the spatialSizeUnits attribute determined the size units of46\na species’ quantity when that species appeared in reaction rate formulas, and (b) the compartment may47\nhave its own diﬀerent spatial units, when both the species and the compartment appeared in reaction rate48\nformulas, one of the quantities would have had to be converted into the same spatial units as the other. In49\nother words, modelers and software tools would have had to insert explicit conversion factors into kinetic50\n47\nNature Precedings : hdl:10101/npre.2007.58.1 : Posted 18 Jun 2007\nSBase\nSpecies\nid: SId\nname: string { use=”optional”}\nspeciesType: SId { use=”optional”}\ncompartment: SId\ninitialAmount: double { use=”optional”}\ninitialConcentration: double { use=”optional”}\nsubstanceUnits: UnitSId { use=”optional”}\nhasOnlySubstanceUnits: boolean { use=”optional” default=”false”}\nboundaryCondition: boolean { use=”optional” default=”false”}\ncharge: int { use=”optional”} deprecated\nconstant: boolean { use=”optional” default=”false”}\nFigure 16: The deﬁnition of class Species. A sequence of one or more instances of Species objects can be located in\nan instance of ListOfSpecies in Model, as shown in Figure 10.\nrate formulas. Such conversions can be be diﬃcult to achieve and prone to errors. Second, although the1\nspatialSizeUnits attribute provided some new functionality, it could also be argued to be redundant: a2\ncompartment’s deﬁnition logically should be the entity controlling its own spatial size information, in the3\nsame way that a species’ deﬁnition controls its quantity. For these reasons, and because few software packages4\nseemed to take account of the implicit unit conversion, it was deemed better to remove the spatialSizeUnits5\nattribute from Species.6\n4.8.1 The id and name attributes7\nAs with other major objects in SBML, Species has a mandatory attribute, id, used to give the species an8\nidentiﬁer. The identiﬁer must be a text string conforming to the syntax permitted by the SId data type9\ndescribed in Section 3.1.7. Species also has an optional name attribute, of type string. The name and id10\nattributes must be used as described in Section 3.3.11\n4.8.2 The speciesType attribute12\nEach species in a model may optionally be designated as belonging to a particular species type. The optional13\nattribute speciesType of type SId is used to identify the species type of the chemical entities that make14\nup the pool represented by the Species object. The attribute’s value must be the identiﬁer of an existing15\nSpeciesType object. If the speciesType attribute is not present on a particular species deﬁnition, it means16\nthe pool contains chemical entities of a type unique to that pool; in eﬀect, a virtual species type is assumed17\nfor that species, and no other species can belong to that species type.18\nThere can be only one species of a given species type in any given compartment of a model. More speciﬁcally,19\nfor all Species objects having a value for the speciesType attribute, the pair20\n(speciesType attribute value, compartment attribute value)21\nmust be unique across the set of all Species objects in a model.22\nThe value of speciesType attributes on species have no eﬀect on the numerical interpretation of a model.23\nSimulators and other numerical analysis software may ignore speciesType attributes.24\n4.8.3 The compartment attribute25\nThe required attribute compartment, also of type SId, is used to identify the compartment in which the26\nspecies is located. The attribute’s value must be the identiﬁer of an existing Compartment object. It is27\nimportant to note that there is no default value for the compartment attribute on Species; every species28\nin an SBML model must be assigned a compartment, and consequently, a model must deﬁne at least one29\ncompartment if that model contains any species.30\n48\nNature Precedings : hdl:10101/npre.2007.58.1 : Posted 18 Jun 2007\n4.8.4 The initialAmount and initialConcentration attributes1\nThe optional attributes initialAmount and initialConcentration, both having a data type of double,2\nare used to set the initial quantity of the species in the compartment where the species is located. These3\nattributes are mutually exclusive; i.e., only one can have a value on any given instance of a Species object.4\nMissing initialAmount and initialConcentration values implies that their values either are unknown, or5\nto be obtained from an external source, or determined by an initial assignment (Section 4.10) or rule (Sec-6\ntion 4.11) elsewhere in the model. In the case where a species’ compartment has a spatialDimensions value7\nof “ 0”, the species cannot have a value for initialConcentration because the concepts of “concentration”8\nand “density” break down when a container has zero dimensions.9\nA species’ initial quantity is set by the initialAmount or initialConcentration attributes exactly once.10\nIf the species’ constant attribute is “ true” (the default), then the size is ﬁxed and cannot be changed ex-11\ncept by an InitialAssignment. These methods diﬀer in that the initialAmount and initialConcentration12\nattributes can only be used to set the species quantity to a literal scalar value, whereas InitialAssignment13\nallows the value to be set using an arbitrary mathematical expression. If the species’ constant attribute14\nis “ false”, the species’ quantity value may be overridden by an InitialAssignment or changed by Assign-15\nmentRule or AlgebraicRule, and in addition, for t > 0, it may also be changed by a RateRule or Events.16\n(However, some constructs are mutually exclusive; see Sections 4.11 and 4.14.) It is not an error to deﬁne17\ninitialAmount or initialConcentration on a species and also redeﬁne the value using an InitialAssignment,18\nbut the initialAmount or initialConcentration setting in that case is ignored. Section 3.4.8 provides ad-19\nditional information about the semantics of assignments, rules and values for simulation time t ≤ 0.20\nThe units of the value in the initialAmount attribute are set by the substanceUnits attribute on Species.21\nThe units of the value in the initialConcentration attribute are substance/size units. The units of sub-22\nstance are those deﬁned in the substanceUnits, and the size units are those given in the deﬁnition of the23\nsize of the Compartment in which the species is located.24\n4.8.5 The substanceUnits and hasOnlySubstanceUnits attributes25\nThe units associated with a species’ quantity, referred to as the units of the species , are determined via the26\noptional attributes substanceUnits and hasOnlySubstanceUnits, in combination with the units of the size27\ndeﬁned for the compartment object in which the species are located.28\nThe attribute hasOnlySubstanceUnits takes on boolean values and defaults to “ false”. This attribute’s29\nrole is to indicate whether the units of the species, when the species identiﬁer appears in mathematical30\nformulas, are intended to be concentration or amount. Although it may seem as though this intention could31\nbe determined based on whether initialConcentration or initialAmount is set, the fact that these two32\nattributes are optional means that a separate ﬂag is needed. (Consider the situation where neither is set,33\nand instead the species’ quantity is established by an InitialAssignment or AssignmentRule.)34\nThe possible values of units of the species are summarized in Table 4. The units of the species are of the form35\nsubstance/size units (i.e., concentration units, using a broad deﬁnition of concentration) if the compartment’s36\nspatialDimensions is non-zero and hasOnlySubstanceUnits has the value “ false”. The units of the species37\nare of the form substance if hasOnlySubstanceUnits has the value “ true” or spatialDimensions is zero.38\n(This dependence is due to the fact that a zero-dimensional compartment cannot support concentrations or39\ndensities.) The units of substance are those deﬁned by the substanceUnits attribute, and the size units are40\nthose of the size of the compartment in which the species is located. This compartment is the one identiﬁed41\nby the species’ compartment attribute.42\n43 value of units of the specieswhen units of the specieswhen\n44 hasOnlySubstanceUnits spatialDimensions is greater than 0 spatialDimensions is 0\n45 false (default) substance/size substance\n46 true substance substance\nTable 4: How to interpret the value the Species hasOnlySubstanceUnits attribute.\n49\nNature Precedings : hdl:10101/npre.2007.58.1 : Posted 18 Jun 2007\nAs an aside, we note that treating species in terms of substance units (i.e., discrete quantities such as1\nmolecule counts) rather than concentrations is common when using discrete stochastic simulation frame-2\nworks ( Gillespie, 1977; Wilkinson, 2006). The appropriate way of accomplishing this in SBML is to set3\nhasOnlySubstanceUnits=“true” in the species’ deﬁnitions.4\nThe value chosen for substanceUnits must be either a base unit from Table 1 on page 37, a built-in unit5\nfrom Table 2 on page 41, or a new unit deﬁned by a unit deﬁnition in the enclosing model. The chosen units6\nfor substanceUnits must be be dimensionless, mole, item, kilogram, gram, or units derived from these.7\nThe substanceUnits attribute defaults to the the built-in unit “ substance” shown in Table 2 on page 41.8\nThe units of the species are used in the following ways:9\n• The species identiﬁer has these units when the identiﬁer appears as a numerical quantity in a mathe-10\nmatical formula expressed in MathML (discussed in Section 3.4.3).11\n• The math element of an AssignmentRule or InitialAssignment referring to this species must have identical12\nunits (see Sections 4.11.3 and 4.10).13\n• In RateRule objects that set the rate of change of the species’ quantity (Section 4.11.4), the units of14\nthe rule’s math element must be identical to the units of the species divided by the model’s time units.15\n4.8.6 The constant and boundaryCondition attributes16\nThe Species object has two optional boolean attributes named constant and boundaryCondition, used to17\nindicate whether and how the quantity of that species can vary during a simulation. Table 5 shows how to18\ninterpret the combined values of the boundaryCondition and constant attributes.19\n20 can have can be\n21 constant boundaryCondition assignment reactant or species’ quantity\n22 value value or rate rule product can be changed by\n23 true true no yes (never changes)\n24 false true yes yes rules and events\n25 true false no no (never changes)\n26 false false yes yes reactions or rules (but not both), and events\nTable 5: How to interpret the values of the constant and boundaryCondition attributes on Species. Note that column\nfour is speciﬁcally about reactants and products and not also about species acting as modiﬁers; the latter are by deﬁnition\nunchanged by reactions.\nBy default, when a species is a product or reactant of one or more reactions, its quantity is determined27\nby those reactions. In SBML, it is possible to indicate that a given species’ quantity is not determined28\nby the set of reactions even when that species occurs as a product or reactant; i.e., the species is on the29\nboundary of the reaction system, and its quantity is not determined by the reactions. The boolean attribute30\nboundaryCondition can be used to indicate this. The value of the attribute defaults to “ false”, indicating31\nthe species is part of the reaction system.32\nThe constant attribute indicates whether the species’ quantity can be changed at all, regardless of whether33\nby reactions, rules, or constructs other than InitialAssignment. The default value is “ false”, indicating that34\nthe species’ quantity can be changed, since the purpose of most simulations is precisely to calculate changes35\nin species quantities. Note that the initial quantity of a species can be set by an InitialAssignment irrespective36\nof the value of the constant attribute.37\nIn practice, a boundaryCondition value of “ true” means a diﬀerential equation derived from the reaction38\ndeﬁnitions should not be generated for the species. However, the species’ quantity may still be changed by39\nAssignmentRule, RateRule, AlgebraicRule, Event, and InitialAssignment constructs if its constant attribute40\nis “ false”. Conversely, if the species’ constant attribute is “ true”, then its value cannot be changed by41\nanything except InitialAssignment.42\n50\nNature Precedings : hdl:10101/npre.2007.58.1 : Posted 18 Jun 2007\nA species having boundaryCondition=“false” and constant=“false” can appear as a product and/or1\nreactant of one or more reactions in the model. If the species is a reactant or product of a reaction, it must2\nnot also appear as the target of any AssignmentRule or RateRule object in the model. If instead the species3\nhas boundaryCondition=“false” and constant=“true”, then it cannot appear as a reactant or product,4\nor as the target of any AssignmentRule, RateRule or EventAssignment object in the model.5\nThe example model in section 7.6 contains all four possible combinations of the boundaryCondition and6\nconstant attributes on species elements. Section 7.7 gives an example of how one can translate into ODEs7\na model that uses boundaryCondition and constant attributes.8\n4.8.7 The charge attribute9\nThe optional attribute charge takes an integer indicating the charge on the species (in terms of electrons,10\nnot the SI unit coulombs). This may be useful when the species is a charged ion such as calcium (Ca 2+).11\nThe charge attribute in SBML has been deprecated since Level 2 Version 2.12\n4.8.8 The sboTerm attribute13\nSpecies inherits an optional sboTerm attribute of type SBOTerm from its parent class Sbase (see Sections 3.1.914\nand 5). When a value is given to this attribute in a Species instance, the value must be an SBO identiﬁer15\nreferring to a participant physical type (i.e., terms derived from SBO:0000236,“participant physical type”).16\nThe relationship is of the form “the species is a X”, where X is the SBO term. The term chosen should be17\nthe most precise (narrow) one that captures the role of the compartment type in the model.18\n4.8.9 Example19\nThe following example shows two species deﬁnitions within an abbreviated SBML model deﬁnition. The20\nexample shows that species are listed under the heading listOfSpecies in the model:21\n<model>22\n...23\n<listOfSpecies>24\n<species id=\"Glucose\" compartment=\"cell\" initialConcentration=\"4\"/>25\n<species id=\"Glucose_6_P\" compartment=\"cell\" initialConcentration=\"0.75\"/>26\n</listOfSpecies>27\n...28\n</model>29\n4.9 Parameters30\nA Parameter is used in SBML to deﬁne a symbol associated with a value; this symbol can then be used31\nin mathematical formulas in a model. By default, parameters have constant value for the duration of a32\nsimulation, and for this reason are called “parameters” instead of “variables” in SBML, although in truth,33\nSBML parameters can be either. The deﬁnition of Parameter is shown in Figure 17.34\nSBase\nParameter\nid: SId\nname: string { use=”optional”}\nvalue: double { use=”optional”}\nunits: UnitSId { use=”optional”}\nconstant: boolean { use=”optional” default=”true”}\nFigure 17: The deﬁnition of class Parameter. A sequence of one or more instances of Parameter objects can be located\nin an instance of ListOfParameters in Model, as shown in Figure 10.\n51\nNature Precedings : hdl:10101/npre.2007.58.1 : Posted 18 Jun 2007\nParameters can be deﬁned in two places in SBML: in lists of parameters deﬁned at the top level in a Model1\ninstance, and within individual reaction deﬁnitions (as described in Section 4.13). Parameters deﬁned at2\nthe top level are global to the whole model; parameters that are deﬁned within a reaction are local to the3\nparticular reaction and (within that reaction) override any global parameters having the same identiﬁers4\n(See Section 3.3.1 for further details).5\nThe use of the term parameter in SBML sometimes leads to confusion among readers who have a particular6\nnotion of what something called “parameter” should be. It has been the source of heated debate, but7\ndespite this, no one has yet found an adequate replacement term that does not have diﬀerent connotations8\nto diﬀerent people and hence leads to confusion among some subset of users. Perhaps it would have been9\nbetter to have two constructs, one called “constants” and the other called “variables”. The current approach10\nin SBML is simply more parsimonious, using a single Parameter construct with the boolean ﬂag constant11\nindicating which ﬂavor it is. In any case, readers are implored to look past their particular deﬁnition of12\na “parameter” and simply view SBML’s Parameter as a single mechanism for deﬁning both constants and13\n(additional) variables in a model. (We write additional because the species in a model are usually considered14\nto be the central variables.) After all, software tools are not required to expose to users the actual names15\nof particular SBML constructs, and thus tools can present to their users whatever terms their designers feel16\nbest matches their target audience.17\n4.9.1 The id and name attributes18\nParameter has one required attribute, id, of type SId, to give the parameter a unique identiﬁer by which other19\nparts of an SBML model deﬁnition can refer to it. A parameter can also have an optional name attribute of20\ntype string. Identiﬁers and names must be used according to the guidelines described in Section 3.3.21\n4.9.2 The value attribute22\nThe optional attribute value determines the value (of type double) assigned to the identiﬁer. A missing23\nvalue implies that the value either is unknown, or to be obtained from an external source, or determined24\nby an initial assignment (Section 4.10) or a rule (Section 4.11) elsewhere in the model.25\nA parameter’s value is set by its value attribute exactly once. If the parameter’s constant attribute has26\nthe value “ true” (the default), then the value is ﬁxed and cannot be changed except by an InitialAssignment.27\nThese two methods of setting the parameter’s value diﬀer in that the value attribute can only be used to set it28\nto a literal scalar value, whereas InitialAssignment allows the value to be set using an arbitrary mathematical29\nexpression. If the parameter’s constant attribute has the value “ false”, the parameter’s value may be30\noverridden by an InitialAssignment or changed by AssignmentRule or AlgebraicRule, and in addition, for31\nsimulation time t > 0, it may also be changed by a RateRule or Events. (However, some of these constructs32\nare mutually exclusive; see Sections 4.11 and 4.14.) It is not an error to deﬁne value on a parameter and also33\nredeﬁne the value using an InitialAssignment, but the value in that case is ignored. Section 3.4.8 provides34\nadditional information about the semantics of assignments, rules and values for simulation time t ≤ 0.35\n4.9.3 The units attribute36\nThe units associated with the value of the parameter are speciﬁed by the attribute units. The value assigned37\nto the parameter’s units attribute must be chosen from one of the following possibilities: one of the base38\nunit identiﬁers from Table 1 on page 37; one of the built-in unit identiﬁers appearing in ﬁrst column of39\nTable 2 on page 41; or the identiﬁer of a new unit deﬁned in the list of unit deﬁnitions in the enclosing Model40\ndeﬁnition. There are no constraints on the units that can be chosen from these sets. There are no default41\nunits for parameters.42\nThe units of the parameter are used in the following ways:43\n• When the parameter identiﬁer appears in mathematical formulas expressed in MathML in a model,44\nthe units associated with the value are those declared by the parameter’s units attribute.45\n• The units of the math element of an AssignmentRule, InitialAssignment or EventAssignment setting the46\nvalue of the parameter must have units identical to those declared by the parameter’s units attribute.47\n52\nNature Precedings : hdl:10101/npre.2007.58.1 : Posted 18 Jun 2007\n• The units of the math element of a RateRule that references the parameter be identical to parameter1\nunits/time, where parameter units are the units declared for the parameter using the units attribute2\nand time is the model-wide time units.3\nThe fact that parameter units are optional, and that no defaults are deﬁned, means that models can deﬁne4\nparameters with undeclared units. If such parameters appear in mathematical expressions elsewhere in a5\nmodel, it may not be possible for a software tool to verify the consistency of units used in the expressions.6\nModelers and software tools should therefore assign units to parameters whenever possible.7\n4.9.4 The constant attribute8\nThe Parameter object has an optional boolean attribute named constant which indicates whether the pa-9\nrameter’s value can vary during a simulation. The attribute’s default value is “ true”. A value of “ false”10\nindicates the parameter’s value can be changed by rules (see Section 4.11) and that the value is actually11\nintended to be the initial value of the parameter.12\nParameters local to a reaction (i.e., those deﬁned within a Reaction’s KineticLaw object, as described in13\nSection 4.13.5) cannot be changed by rules and therefore are implicitly always constant; thus, parameter14\ndeﬁnitions within Reaction objects should not have their constant attribute set to “ false”.15\nWhat if a global parameter has its constant attribute set to “ false”, but the model does not contain any16\nrules, events or other constructs that ever change its value over time? Although the model may be suspect,17\nthis situation is not strictly an error. A value of “ false” for constant only indicates that a parameter can18\nchange value, not that it must.19\n4.9.5 The sboTerm attribute20\nThe Parameter object inherits from Sbase the optional sboTerm attribute of type SBOTerm (see Sections 3.1.921\nand 5). When a value is given to this attribute in a parameter deﬁnition, the value must be an SBO identiﬁer22\nreferring to a quantitative parameter deﬁned in SBO (i.e., terms derived from SBO:0000002, “quantitative23\nparameter”). The relationship is of the form “the SBML parameter is a X”, where X is the SBO term. The24\nterm chosen should be the most precise (narrow) one that captures the role of the parameter in the model.25\nAs discussed in Section 5, SBO labels are optional information on a model. Applications are free to ignore26\nsboTerm values. A model must be interpretable without the beneﬁt of SBO labels.27\n4.9.6 Example28\nThe following is an example of parameters deﬁned at the Model level:29\n<model>30\n...31\n<listOfParameters>32\n<parameter id=\"tau2\" value=\"3e-2\" units=\"second\"/>33\n<parameter id=\"Km1\" value=\"10.7\" units=\"moleperlitre\"/>34\n</listOfParameters>35\n...36\n</model>37\n4.10 Initial assignments38\nSBML Level 2 Version 3 provides two ways of assigning initial values to entities in a model. The simplest39\nand most basic is to set the values of the appropriate attributes in the relevant components; for example,40\nthe initial value of a model parameter (whether it is a constant or a variable) can be assigned by setting its41\nvalue attribute directly in the model deﬁnition (Section 4.9). However, this approach is not suitable when42\nthe value must be calculated, because the initial value attributes on diﬀerent components such as species,43\ncompartments, and parameters are single values and not mathematical expressions. This is the reason for44\nthe introduction of InitialAssignment: to permit the calculation of the value of a constant or the initial value45\nof a variable from the values of other quantities in a model. The deﬁnition of InitialAssignment is shown in46\nFigure 18 on the following page.47\n53\nNature Precedings : hdl:10101/npre.2007.58.1 : Posted 18 Jun 2007\nSBase\nInitialAssignment\nsymbol: SId\nMath\nxmlns: string { ”http://www.w3.org/1998/Math/MathML ”}\n{ MathML content. }\nmath\nFigure 18: The deﬁnition of class InitialAssignment. The contents of the Math class can be any MathML permitted\nin SBML; see Section 3.4.1. A sequence of one or more instances of InitialAssignment objects can be located in an\ninstance of ListOfInitialAssignments in Model, as shown in Figure 10.\nAs explained below, the provision of InitialAssignment does not mean that models necessarily must use this1\nconstruct when deﬁning initial values of quantities. If a value can be set using the relevant attribute of a2\ncomponent in a model, then that approach may be more eﬃcient and more portable to other software tools.3\nInitialAssignment should be used when the other mechanism is insuﬃcient for the needs of a particular model.4\nInitial assignments have some similarities to assignment rules (Section 4.11.3). The main diﬀerences are5\n(a) an InitialAssignment can set the value of a constant whereas an AssignmentRule cannot, and (b) unlike6\nAssignmentRule, an InitialAssignment deﬁnition only applies up to and including the beginning of simulation7\ntime, i.e., t ≤ 0, while an AssignmentRule applies at all times.8\n4.10.1 The symbol attribute9\nInitialAssignment contains the attribute symbol, of type SId. The value of this attribute in an InitialAssignment10\nobject can be the identiﬁer (i.e., the value of the id attribute) of a Compartment, Species or global Parameter11\nelsewhere in the model. The purpose of the InitialAssignment is to deﬁne the initial value of the constant or12\nvariable referred to by the symbol attribute. (The attribute’s name is symbol rather than variable because13\nit may assign values to constants as well as variables in a model; see Section 4.10.4 below.)14\nAn initial assignment cannot be made to reaction identiﬁers, that is, the symbol attribute value of an15\nInitialAssignment cannot be an identiﬁer that is the id attribute value of a Reaction object in the model.16\nThis is identical to a restriction placed on rules (see Section 4.11.5).17\n4.10.2 The math element18\nThe math element contains a MathML expression that is used to calculate the value of the constant or the19\ninitial value of the variable. The units of the value computed by the formula in the math element must be20\nidentical to be the units associated with the identiﬁer given in the symbol attribute. (That is, the units are21\nthe units of the species, compartment, or parameter, as appropriate for the kind of object identiﬁed by the22\nvalue of symbol.)23\n4.10.3 The sboTerm attribute24\nInitialAssignment inherits from Sbase an optional sboTerm attribute of type SBOTerm (see Sections 3.1.925\nand 5). When a value is given to this attribute in an initial assignment deﬁnition, the value must be a valid26\nSBO identiﬁer referring to a mathematical expression (i.e., terms derived from SBO:0000064, “mathematical27\nexpression”). The InitialAssignment object should have a “is a” relationship with the SBO term, and the28\nterm should be the most precise (narrow) term that captures the role of the InitialAssignment in the model.29\nAs discussed in Section 5, SBO labels are optional information on a model. Applications are free to ignore30\nsboTerm values. A model must be interpretable without the beneﬁt of SBO labels.31\n4.10.4 Semantics of initial assignments32\nThe value calculated by an InitialAssignment object overrides the value assigned to the given symbol by the33\nobject deﬁning that symbol. For example, if a Compartment’s size is set in its deﬁnition, and the model also34\ncontains an InitialAssignment having that compartment’s id as its symbol value, then the interpretation is35\nthat the size assigned in the Compartment deﬁnition should be ignored and the value assigned based on the36\n54\nNature Precedings : hdl:10101/npre.2007.58.1 : Posted 18 Jun 2007\ncomputation deﬁned in the InitialAssignment. Initial assignments can take place for Compartment, Species1\nand global Parameter objects regardless of the value of their constant attribute.2\nThis does not mean that a deﬁnition of a symbol can be omitted if there is an InitialAssignment object for3\nthat symbol; the symbols must always be deﬁned even if they are assigned a value separately. For example,4\nthere must be a Parameter deﬁnition for a given parameter if there is an InitialAssignment for that parameter.5\nThe actions of all InitialAssignment objects are in general terms the same, but diﬀer in the precise details6\ndepending on the type of variable being set:7\n• In the case of a species , an InitialAssignment sets the referenced species’ initial quantity ( concentration8\nor amount of substance ) to the value determined by the formula in math. (See Section 4.8.5 for an9\nexplanation of how the units of the species’ quantity are determined.)10\n• In the case of a compartment , an InitialAssignment sets the referenced compartment’s initial size to the11\nsize determined by the formula in math. The overall units of the formula must be the same as the units12\nspeciﬁed for the size of the compartment. (See Section 4.7.5 for an explanation of how the units of the13\ncompartment’s size are determined.)14\n• In the case of a parameter , an InitialAssignment sets the referenced parameter’s initial value to that15\ndetermined by the formula in math. The overall units of the formula must be the same as the units16\ndeﬁned for the parameter. (See Section 4.9.3 for an explanation of how the units of the parameter are17\ndetermined.)18\nIn the context of a simulation, initial assignments establish values that are in eﬀect prior to and including19\nthe start of simulation time, i.e., t ≤ 0. Section 3.4.8 provides information about the interpretation of20\nassignments, rules, and entity values for simulation time up to and including the start time t = 0; this is21\nimportant for establishing the initial conditions of a simulation if the model involves expressions containing22\nthe delay csymbol (Section 3.4.6).23\nThere cannot be two initial assignments for the same symbol in a model; that is, a model must not contain24\ntwo or more InitialAssignment objects that both have the same identiﬁer as their symbol attribute value.25\nA model must also not deﬁne initial assignments and assignment rules for the same entity. That is, there26\ncannot be both an InitialAssignment and an AssignmentRule for the same symbol in a model, because both27\nkinds of constructs apply prior to and at the start of simulated time—allowing both to exist for a given28\nsymbol would result in indeterminism). (See also Section 4.11.5.)29\nThe ordering of InitialAssignment objects is not signiﬁcant. The combined set of InitialAssignment, Assign-30\nmentRule and KineticLaw objects form a set of assignment statements that must be considered as a whole. The31\ncombined set of assignment statements should not contain algebraic loops: a chain of dependency between32\nthese statements should terminate. (More formally, consider the directed graph of assignment statements33\nwhere nodes are a model’s assignment statements and directed arcs exist for each occurrence of a symbol in34\nan assignment statement math attribute. The directed arcs in this graph start from the statement assigning35\nthe symbol and end at the statement that contains the symbol in their math elements. Such a graph must36\nbe acyclic.) Examples of valid and invalid set of assignment statements are given in Section 4.11.5.37\nFinally, it is worth being explicit about the expected behavior in the following situation. Suppose (1) a given38\nsymbol has a value x assigned to it in its deﬁnition, and (2) there is an initial assignment having the identiﬁer39\nas its symbol value and reassigning the value to y, and (3) the identiﬁer is also used in the mathematical40\nformula of a second initial assignment. What value should the second initial assignment use? It is y, the41\nvalue assigned to the symbol by the ﬁrst initial assignment, not whatever value was given in the symbol’s42\ndeﬁnition. This follows directly from the behavior at the deﬁned at the beginning of this section and in43\nSection 3.4.8: if an InitialAssignment object exists for a given symbol, then the symbol’s value is overridden44\nby that initial assignment.45\n4.10.5 Example46\nThe following example shows how the species “ x” can assigned the initial value 2 × y, where “ y” is an47\nidentiﬁer deﬁned elsewhere in the model:48\n55\nNature Precedings : hdl:10101/npre.2007.58.1 : Posted 18 Jun 2007\n<model>1\n...2\n<listOfSpecies>3\n<species id=\"x\" initialConcentration=\"5\"/>4\n</listOfSpecies>5\n...6\n<listOfInitialAssignments>7\n<initialAssignment symbol=\"x\">8\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\">9\n<apply>10\n<times/>11\n<ci> y </ci>12\n<cn> 2 </cn>13\n</apply>14\n</math>15\n</initialAssignment>16\n</listOfInitialAssignments>17\n...18\n</model>19\nThe next example illustrates the more complex behavior discussed above, when a symbol has a value assigned20\nin its deﬁnition but there also exists an InitialAssignment for it and another InitialAssignment uses its value21\nin its mathematical formula.22\n<model>23\n...24\n<listOfSpecies>25\n<species id=\"x\" initialConcentration=\"5\"/>26\n</listOfSpecies>27\n...28\n<listOfInitialAssignments>29\n<initialAssignment symbol=\"x\">30\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\">31\n<cn> 2 </cn>32\n</math>33\n</initialAssignment>34\n<initialAssignment symbol=\"othersymbol\">35\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\">36\n<apply>37\n<times/>38\n<ci> x </ci>39\n<cn> 2 </cn>40\n</apply>41\n</math>42\n</initialAssignment>43\n</listOfInitialAssignments>44\n...45\n</model>46\nThe value of “ othersymbol” in the SBML excerpt above will be “ 4”. The case illustrates the rule of thumb47\nthat if there is an initial assignment for a symbol, the value assigned to the symbol in its deﬁnition must be48\nignored and the value created by the initial assignment used instead.49\n4.11 Rules50\nIn SBML, Rules provide additional ways to deﬁne the values of variables in a model, their relationships,51\nand the dynamical behaviors of those variables. Rules enable the encoding of relationships that cannot be52\nexpressed using reactions alone (Section 4.13) nor by the assignment of an initial value to a variable in a53\nmodel (Section 4.10).54\nSBML separates rules into three subclasses for the beneﬁt of model analysis software. The three subclasses55\nare based on the following three diﬀerent possible functional forms (where x is a variable, f is some arbitrary56\nfunction returning a numerical result, V is a vector of variables that does not include x, and W is a vector57\nof variables that may include x):58\n56\nNature Precedings : hdl:10101/npre.2007.58.1 : Posted 18 Jun 2007\n1 Algebraic left-hand side is zero: 0 = f(W)\n2 Assignment left-hand side is a scalar: x = f(V)\n3 Rate left-hand side is a rate-of-change: dx/dt = f(W)\nIn their general form given above, there is little to distinguish between assignment and algebraic rules. They4\nare treated as separate cases for the following reasons:5\n• Assignment rules can simply be evaluated to calculate intermediate values for use in numerical methods;6\n• SBML needs to place restrictions on assignment rules, for example the restriction that assignment rules7\ncannot contain algebraic loops (discussed further in Section 4.11.5);8\n• Some simulators do not contain numerical solvers capable of solving unconstrained algebraic equations,9\nand providing more direct forms such as assignment rules may enable those simulators to process models10\nthey could not process if the same assignments were put in the form of general algebraic equations;11\n• Those simulators that can solve these algebraic equations make a distinction between the diﬀerent12\ncategories listed above; and13\n• Some specialized numerical analyses of models may only be applicable to models that do not contain14\nalgebraic rules.15\nThe approach taken to covering these cases in SBML is to deﬁne an abstract Rule object class containing an16\nelement, math, to hold the right-hand side expression, then to derive subtypes of Rule that add attributes17\nto distinguish the cases of algebraic, assignment and rate rules. Figure 19 gives the deﬁnitions of Rule and18\nthe subtypes derived from it. The ﬁgure shows there are three subtypes, AlgebraicRule, AssignmentRule19\nand RateRule derived directly from Rule. These correspond to the cases Algebraic, Assignment, and Rate20\ndescribed above respectively.21\nMath\nxmlns: string  { \"http://www.w3.org/1998/Math/MathML\" }\n{ MathML content. }\nRule\nAssignmentRule\nvariable: SId\nRateRule\nvariable: SId\nAlgebraicRule\nmath\nSBase\nFigure 19: The deﬁnition of Rule and derived types AlgebraicRule, AssignmentRule and RateRule.\n4.11.1 Common attributes in Rule22\nThe classes derived from Rule inherit math and the attributes and elements from Sbase, including sboTerm.23\nThe math element24\nA Rule object has a required element called math, containing a MathML expression deﬁning the mathematical25\nformula of the rule. This MathML formula must return a numerical value. The formula can be an arbitrary26\nexpression referencing the variables and other entities in an SBML model. The interpretation of math and27\nthe units of the formula are described in more detail in Sections 4.11.2, 4.11.3 and 4.11.4 below.28\n57\nNature Precedings : hdl:10101/npre.2007.58.1 : Posted 18 Jun 2007\nThe sboTerm attribute1\nThe Rule object class inherits from Sbase the optional sboTerm attribute of type SBOTerm (see Sections 3.1.92\nand 5). When a value is given to this attribute, it must be a valid SBO identiﬁer referring to a mathematical3\nexpression deﬁned in SBO (i.e., terms derived from SBO:0000064, “mathematical expression”). The Alge-4\nbraicRule, AssignmentRule, or RateRule object should have a “is a” relationship with the SBO term, and the5\nterm should be the most precise (narrow) term that captures the role of that rule in the model.6\nAs discussed in Section 5, SBO labels are optional information on a model. Applications are free to ignore7\nsboTerm values. A model must be interpretable without the beneﬁt of SBO labels.8\n4.11.2 AlgebraicRule9\nThe rule type AlgebraicRule is used to express equations that are neither assignments of model variables nor10\nrates of change. AlgebraicRule does not add any attributes to the basic Rule; its role is simply to distinguish11\nthis case from the other cases. An example of the use of AlgebraicRule is given in Section 7.5.12\nIn the context of a simulation, algebraic rules are in eﬀect at all times, t ≥ 0. For purposes of evaluating13\nexpressions that involve the delay csymbol (Section 3.4.6), algebraic rules are considered to apply also at14\nt ≤ 0. Section 3.4.8 provides additional information about the semantics of assignments, rules, and entity15\nvalues for simulation time t ≤ 0.16\nAlgebraicRule is unlike AssignmentRule and RateRule in that there are no speciﬁc deﬁnitions of the meaning17\nof the mathematical expression in the AlgebraicRule. There is only one requirement on the units, which is18\nthat the units of the overall expression must be consistent under dimensional analysis.19\nThe ability to deﬁne arbitrary algebraic expressions in an SBML model introduces the possibility that a20\nmodel is mathematically overdetermined by the overall system of equations constructed from its rules and21\nreactions. An SBML model must not be overdetermined; this is discussed in Section 4.11.5 below.22\n4.11.3 AssignmentRule23\nThe rule type AssignmentRule is used to express equations that set the values of variables. The left-hand24\nside (the variable attribute) of an assignment rule can refer to the identiﬁer of a Species, Compartment,25\nor Parameter object in the model (but not a reaction). The entity identiﬁed must not have its constant26\nattribute set to “ true”. The eﬀects of an AssignmentRule are in general terms the same, but diﬀer in the27\nprecise details depending on the type of variable being set:28\n• In the case of a species , an AssignmentRule sets the referenced species’ quantity ( concentration or29\namount of substance ) to the value determined by the formula in math. The units of the formula in30\nmath must be the same as the units of the species (Section 4.8.5) for the species identiﬁed by the31\nvariable attribute of the AssignmentRule.32\nRestrictions: There must not be both an AssignmentRule variable attribute and a SpeciesReference33\nspecies attribute having the same value, unless that species has its boundaryCondition attribute34\nset to “ true”. In other words, an assignment rule cannot be deﬁned for a species that is created or35\ndestroyed in a reaction unless that species is deﬁned as a boundary condition in the model.36\n• In the case of a compartment , an AssignmentRule sets the referenced compartment’s size to the value37\ndetermined by the formula in math. The overall units of the formula in math must be the same as the38\nunits of the size of the compartment (Section 4.7.5).39\n• In the case of a parameter , an AssignmentRule sets the referenced parameter’s value to that determined40\nby the formula in math. The overall units of the formula in math must be the same as the units deﬁned41\nfor the parameter (Section 4.9.3).42\nIn the context of a simulation, assignment rules are in eﬀect at all times, t ≥ 0. For purposes of evaluating43\nexpressions that involve the delay csymbol (Section 3.4.6), assignment rules are considered to apply also at44\nt ≤ 0. Section 3.4.8 provides additional information about the semantics of assignments, rules, and entity45\nvalues for simulation time t ≤ 0.46\n58\nNature Precedings : hdl:10101/npre.2007.58.1 : Posted 18 Jun 2007\nA model must not contain more than one AssignmentRule or RateRule object having the same value of1\nvariable; in other words, in the set of all assignment rules and rate rules in an SBML model, each variable2\nappearing in the left-hand sides can only appear once. This simply follows from the fact that an indeterminate3\nsystem would result if a model contained more than one assignment rule for the same variable or both an4\nassignment rule and a rate rule for the same variable.5\nSimilarly, a model must also not contain both an AssignmentRule and an InitialAssignment for the same6\nvariable, because both kinds of constructs apply prior to and at the start of simulation time, i.e., t ≤ 0. If a7\nmodel contained both an initial assignment and an assignment rule for the same variable, an indeterminate8\nsystem would result. (See also Section 4.10.4.)9\nThe value calculated by an AssignmentRule object overrides the value assigned to the given symbol by the10\nobject deﬁning that symbol. For example, if a Compartment’s size is set in its deﬁnition, and the model also11\ncontains an AssignmentRule having that compartment’s id as its variable value, then the size assigned12\nin the Compartment deﬁnition is ignored and the value assigned based on the computation deﬁned in the13\nAssignmentRule. This does not mean that a deﬁnition for a given symbol can be omitted if there is an14\nAssignmentRule object for it. For example, there must be a Parameter deﬁnition for a given parameter if15\nthere is an AssignmentRule for that parameter.16\n4.11.4 RateRule17\nThe rule type RateRule is used to express equations that determine the rates of change of variables. The18\nleft-hand side (the variable attribute) can refer to the identiﬁer of a species, compartment, or parameter19\n(but not a reaction). The entity identiﬁed must have its constant attribute set to “ false”. The eﬀects of a20\nRateRule are in general terms the same, but diﬀer in the precise details depending on which variable is being21\nset:22\n• In the case of a species , a RateRule sets the rate of change of the species’ quantity ( concentration or23\namount of substance ) to the value determined by the formula in math. The overall units of the formula24\nin math must be species quantity /time, where the time units are the built-in units of time described in25\nSection 4.4 and the species quantity units are the units of the species as deﬁned in Section 4.8.5.26\nRestrictions: There must not be both a RateRule variable attribute and a SpeciesReference species27\nattribute having the same value, unless that species has its boundaryCondition attribute is set to28\n“true”. This means a rate rule cannot be deﬁned for a species that is created or destroyed in a29\nreaction, unless that species is deﬁned as a boundary condition in the model.30\n• In the case of a compartment , a RateRule sets the rate of change of the compartment’s size to the value31\ndetermined by the formula in math. The overall units of the formula must be size/time, where the time32\nunits are the built-in units of time described in Section 4.4 and the size units are the units of size on33\nthe compartment (Section 4.7.5).34\n• In the case of a parameter , a RateRule sets the rate of change of the parameter’s value to that determined35\nby the formula in math. The overall units of the formula must be x/time, where x are the units of the36\nparameter (Section 4.9.3).37\nIn the context of a simulation, rate rules are in eﬀect for simulation time t > 0. Other types of rules and38\ninitial assignments are in eﬀect at diﬀerent times; Section 3.4.8 describes these conditions.39\nAs mentioned in Section 4.11.3 for AssignmentRule, a model must not contain more than one RateRule or40\nAssignmentRule object having the same value of variable; in other words, in the set of all assignment rules41\nand rate rules in an SBML model, each variable appearing in the left-hand sides can only appear once. This42\nsimply follows from the fact that an indeterminate system would result if a model contained more than one43\nassignment rule for the same variable or both an assignment rule and a rate rule for the same variable.44\n4.11.5 Additional restrictions on rules45\nAn important design goal of SBML rule semantics is to ensure that a model’s simulation and analysis results46\nwill not be dependent on when or how often rules are evaluated. To achieve this, SBML needs to place47\n59\nNature Precedings : hdl:10101/npre.2007.58.1 : Posted 18 Jun 2007\ntwo additional restrictions on rule use in addition to the conditions described above regarding the use of1\nAlgebraicRule, AssignmentRule and RateRule. The ﬁrst concerns algebraic loops in the system of assignments2\nin a model, and the second concerns overdetermined systems.3\nThe model must not contain algebraic loops4\nThe combined set of InitialAssignment, AssignmentRule and KineticLaw objects constitute a set of assignment5\nstatements that should be considered as a whole. (A KineticLaw object is counted as an assignment because6\nit assigns a value to the symbol contained in the id attribute of the Reaction object in which it is deﬁned.)7\nThis combined set of assignment statements must not contain algebraic loops—dependency chains between8\nthese statements must terminate. To put this more formally, consider a directed graph in which nodes9\nare assignment statements and directed arcs exist for each occurrence of an SBML species, compartment10\nor parameter symbol in an assignment statement’s math element. Let the directed arcs point from the11\nstatement assigning the symbol to the statements that contain the symbol in their math element expressions.12\nThis graph must be acyclic.13\nSBML does not specify when or how often rules should be evaluated. Eliminating algebraic loops ensures14\nthat assignment statements can be evaluated any number of times without the result of those evaluations15\nchanging. As an example, consider the following equations:16\nx = x + 1, y = z + 200, z = y + 10017\nIf this set of equations were interpreted as a set of assignment statements, it would be invalid because the18\nrule for x refers to x (exhibiting one type of loop), and the rule for y refers to z while the rule for z refers19\nback to y (exhibiting another type of loop).20\nConversely, the following set of equations would constitute a valid set of assignment statements:21\nx = 10, y = z + 200, z = x + 10022\nThe model must not be overdetermined23\nAn SBML model must not be overdetermined; that is, a model must not deﬁne more equations than there24\nare unknowns in a model. An SBML model that does not contain AlgebraicRule objects cannot be overde-25\ntermined.26\nAssessing whether a given continuous, deterministic, mathematical model is overdetermined does not require27\ndynamic analysis; it can be done by analyzing the system of equations created from the model. One approach28\nis to construct a bipartite graph in which one set of vertices represents the variables and the other the set of29\nvertices represents the equations. Place edges between vertices such that variables in the system are linked30\nto the equations that determine them. For algebraic equations, there will be edges between the equation and31\neach variable occurring in the equation. For ordinary diﬀerential equations (such as those deﬁned by rate32\nrules or implied by the reaction rate deﬁnitions), there will be a single edge between the equation and the33\nvariable determined by that diﬀerential equation. A mathematical model is overdetermined if the maximal34\nmatchings ( Chartrand, 1977) of the bipartite graph contain disconnected vertexes representing equations.35\n(If one maximal matching has this property, then all the maximal matchings will have this property; i.e., it36\nis only necessary to ﬁnd one maximal matching.) Appendix D describes a method of applying this procedure37\nto speciﬁc SBML data objects.38\n4.11.6 Example of rule use39\nThis section contains an example set of rules. Consider the following set of equations:40\nk = k3\nk2\n, s 2 = k · x\n1 + k2\n, A = 0.10 · x41\nThis can be encoded by the following scalar rule set (where the deﬁnitions of x, s, k, k2, k3 and A are42\nassumed to be located elsewhere in the model and not shown in this abbreviated example):43\n60\nNature Precedings : hdl:10101/npre.2007.58.1 : Posted 18 Jun 2007\n<listOfRules>1\n<assignmentRule variable=\"k\">2\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\">3\n<apply> <divide/> <ci> k3 </ci> <ci> k2 </ci> </apply>4\n</math>5\n</assignmentRule>6\n<assignmentRule variable=\"s2\">7\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\">8\n<apply>9\n<divide/>10\n<apply> <times/> <ci> k </ci> <ci> x </ci> </apply>11\n<apply> <plus/> <cn> 1 </cn> <ci> k2 </ci> </apply>12\n</apply>13\n</math>14\n</assignmentRule>15\n<assignmentRule variable=\"A\">16\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\">17\n<apply> <times/> <cn> 0.10 </cn> <ci> x </ci> </apply>18\n</math>19\n</assignmentRule>20\n</listOfRules>21\n4.12 Constraints22\nThe Constraint object is a mechanism for stating the assumptions under which a model is designed to operate.23\nThe constraints are statements about permissible values of diﬀerent quantities in a model. Figure 20 shows24\nthe deﬁnition of the Constraint object class .25\nConstraint\nmath\nSBase\n0..1\nMath\nxmlns: string  { \"http://www.w3.org/1998/Math/MathML\" }\n{ MathML content evaluating to a boolean value. }\nMessage\nxmlns: string  { \"http://www.w3.org/1999/xhtml\" }\n{ Almost any well-formed content permitted in XHTML, \nsubject to a few restrictions; see text.  }\nmessage\n{ Order is significant. }\nFigure 20: The deﬁnition of class Constraint. The contents of the Math class can be any MathML permitted in SBML,\nbut it must return a boolean value. As shown above, an instance of Constraint can also contain zero or one instances\nof Message; this element is simply a wrapper (in the XML form, within <message> ... </message> tags) for XHTML\ncontent. The same guidelines for XHTML content as explained in Section 3.2.3 for notes on Sbase also apply to the\nXHTML within messages in a Constraint. A sequence of one or more instances of Constraint objects can be located in\nan instance of ListOfConstraints in Model, as shown in Figure 10.\nThe essential meaning of a constraint is this: if a dynamical analysis of a model (such as a simulation)26\nreaches a state in which a constraint is no longer satisﬁed, the results of the analysis are deemed invalid27\nbeginning with that point in time. The exact behavior of a software tool, upon encountering a constraint28\nviolation, is left up to the software; however, a software tool must somehow indicate to the user when a29\nmodel’s constraints are no longer satisﬁed. (Otherwise, a user may not realize that the analysis has reached30\nan invalid state and is potentially producing nonsense results.) If a software tool does not have support for31\nconstraints, it should indicate this to the user when encountering a model containing constraints.32\n4.12.1 The math element33\nConstraint has one required subelement, math, containing a MathML formula deﬁning the condition of the34\nconstraint. This formula must return a boolean value of “ true” when the model is in a valid state. The35\nformula can be an arbitrary expression referencing the variables and other entities in an SBML model. The36\nevaluation of math and behavior of constraints are described in more detail in Section 4.12.4 below.37\n61\nNature Precedings : hdl:10101/npre.2007.58.1 : Posted 18 Jun 2007\n4.12.2 The message element1\nA Constraint object has an optional element called message. This can contain a message in XHTML format2\nthat may be displayed to the user when the condition of the constraint in math evaluates to a value of3\n“false”. Software tools are not required to display the message, but it is recommended that they do so as4\na matter of best practice.5\nThe XHTML content within a message element must follow the same restrictions as for the notes element6\non Sbase described in Section 3.2.3. For example, message must not contain an XML declaration or a7\nDOCTYPE declaration, and the permitted content can only take one of the following general forms: (1) a8\ncomplete XHTML document beginning with the element <html> and ending with </html>; (2) the “body”9\nportion of a document beginning with the element <body> and ending with </body>; or (3) XHTML content10\nthat is permitted within a <body> ... </body> elements. Appendix F describes one approach to reading the11\nmessage content.12\n4.12.3 The sboTerm attribute13\nThe Constraint object inherits from Sbase the optional sboTerm attribute of type SBOTerm (see Sections 3.1.914\nand 5). When a value is given to this attribute in a constraint deﬁnition, the value must be a valid SBO15\nidentiﬁer referring to a mathematical expression (i.e., terms derived from SBO:0000064, “mathematical ex-16\npression”). The Constraint should have an “is a” relationship with the SBO term, and the term should be17\nthe most precise (narrow) term that captures the role of the Constraint in the model.18\nAs discussed in Section 5, SBO labels are optional information on a model. Applications are free to ignore19\nsboTerm values. A model must be interpretable without the beneﬁt of SBO labels.20\n4.12.4 Semantics of constraints21\nIn the context of a simulation, a Constraint has eﬀect at all times t ≥ 0. Each Constraint’s math element is22\nﬁrst evaluated after any InitialAssignment deﬁnitions in a model at t = 0 and can conceivably trigger at that23\npoint. (In other words, a simulation could fail a constraint immediately.)24\nConstraint deﬁnitions cannot and should not be used to compute the dynamical behavior of a model as part25\nof, for example, simulation. Constraints may be used as input to non-dynamical analysis, for instance by26\nexpressing ﬂux constraints for ﬂux balance analysis.27\nThe results of a simulation of a model containing a constraint are invalid from any simulation time at and28\nafter a point when the function given by the math returns a value of “ false”. Invalid simulation results do29\nnot make a prediction of the behavior of the biochemical reaction network represented by the model. The30\nprecise behavior of simulation tools is left undeﬁned with respect to constraints. If invalid results are detected31\nwith respect to a given constraint, the message element (Section 4.12.2) may optionally be displayed to the32\nuser. The simulation tool may also halt the simulation or clearly delimit in output data the simulation time33\npoint at which the simulation results become invalid.34\nSBML does not impose restrictions on duplicate Constraint deﬁnitions or the order of evaluation of Constraint35\nobjects in a model. It is possible for a model to deﬁne multiple constraints all with the same math element.36\nSince the failure of any constraint indicates that the model simulation has entered an invalid state, a system is37\nnot required to attempt to detect whether other constraints in the model have failed once any one constraint38\nhas failed.39\n4.12.5 Example40\nAs an example, the following SBML fragment demonstrates the constraint that species S1 should only have41\nvalues between 1 and 100:42\n<model>43\n...44\n<listOfConstraints>45\n<constraint>46\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\">47\n62\nNature Precedings : hdl:10101/npre.2007.58.1 : Posted 18 Jun 2007\n<apply>1\n<and/>2\n<apply> <lt/> <cn> 1 </cn> <ci> S1 </ci> </apply>3\n<apply> <lt/> <ci> S1 </ci> <cn> 100 </cn> </apply>4\n</apply>5\n</math>6\n<message>7\n<p xmlns=\"http://www.w3.org/1999/xhtml\"> Species S1 is out of range. </p>8\n</message>9\n</constraint>10\n</listOfConstraints>11\n...12\n</model>13\n4.13 Reactions14\nA reaction represents any transformation, transport or binding process, typically a chemical reaction, that15\ncan change the quantity of one or more species. In SBML, a reaction is deﬁned primarily in terms of the16\nparticipating reactants and products (and their corresponding stoichiometries), along with optional modiﬁer17\nspecies, an optional rate at which the reaction takes place, and optional parameters. These various parts18\nof a reaction are recorded in the SBML Reaction object class and other supporting data classes, deﬁned in19\nFigure 21 on the next page.20\n4.13.1 Reaction21\nEach reaction in an SBML model is deﬁned using an instance of a Reaction object. As shown in Figure 2122\non the following page, it contains several scalar attributes and several lists of objects.23\nThe id and name attributes24\nAs with most other main kinds of objects in SBML, the Reaction object class includes a mandatory attribute25\ncalled id, of type SId, and an optional attribute name, of type string. The id attribute is used to give the26\nreaction a unique identiﬁer in the model. This identiﬁer can be used in mathematical formulas elsewhere27\nin an SBML model to represent the rate of that reaction; this usage is explained in detail in Section 4.13.728\nbelow. The name attribute can be used to give the reaction a more free-form, descriptive name. The name29\nand id attributes must be used as described in Section 3.3.30\nThe lists of reactants, products and modiﬁers31\nThe species participating as reactants, products, and/or modiﬁers in a reaction are declared using lists of32\nSpeciesReference and/or ModiﬁerSpeciesReference instances stored in listOfReactants, listOfProducts33\nand listOfModifiers. SpeciesReference and ModiﬁerSpeciesReference are described in more detail in Sec-34\ntions 4.13.3 and 4.13.4 below.35\nCertain restrictions are placed on the appearance of species in reaction deﬁnitions:36\n• The ability of a species to appear as a reactant or product of any reaction in a model is governed by37\ncertain ﬂags in that species’ deﬁnition; see Section 4.8.6 for more information.38\n• Any species appearing in the mathematical formula of the kineticLaw of a Reaction instance must be39\ndeclared in at least one of that Reaction’s lists of reactants, products, and/or modiﬁers. Put another40\nway, it is an error for a reaction’s kinetic law formula to refer to species that have not been declared41\nfor that reaction.42\n• A reaction deﬁnition can contain an empty list of reactants or an empty list of products, but it must43\nhave at least one reactant or product; in other words, a reaction without any reactant or product44\nspecies is not permitted. (This restriction does not apply to modiﬁer species, which remain optional45\nin all cases.)46\n63\nNature Precedings : hdl:10101/npre.2007.58.1 : Posted 18 Jun 2007\nReaction\nid: SId\nname: string  { use=\"optional\" }\nreversible: boolean  { use=\"optional\" default=\"true\" }\nfast: boolean  { use=\"optional\" default=\"false\" }\nKineticLaw\nSBase\nListOfParameters\nspeciesReference\nkineticLaw\nmath\nlistOfParameters\n0..1\nMath\nxmlns: string  { \"http://www.w3.org/1998/Math/MathML\" }\n{ MathML content evaluating to a numerical value. }\n1..* Parameterparameter\n0..1\nstoichiometryMath 0..1\nListOfSpeciesReferences\nlistOfReactants\nlistOfProducts\nlistOfModiﬁers\n0..10..1\nmodiﬁerSpeciesReference\n1..*\n0..1\n1..*\nListOfModiﬁerSpeciesReferences\n{ Order is significant. }\nStoichiometryMath\nmath\nMath\nxmlns: string  { \"http://www.w3.org/1998/Math/MathML\" }\n{ MathML content evaluating to a numerical value. }\nModiﬁerSpeciesReferenceSpeciesReference\nstoichiometry: double  { use=\"optional\" default=\"1\" }\nSimpleSpeciesReference\nid: SId  { use=\"optional\" }\nname: string  { use=\"optional\" }\nspecies: SId\n{ stoichiometry and\nstoichiometryMath are\nmutually exclusive. }\n{ Order is significant. }\nFigure 21: The deﬁnitions of classes Reaction, KineticLaw, SpeciesReference, ModiﬁerSpeciesReference, as well\nas the container classes ListOfReactions, ListOfReactions, ListOfReactions, and ListOfParameters. Note that Sim-\npleSpeciesReference is an abstract class used only to provide some common attributes to its derived classes. The class\nParameter is deﬁned in Section 4.9.\nThe kineticLaw element1\nA reaction can contain up to one KineticLaw object in the kineticLaw element of the Reaction. This “kinetic2\nlaw” deﬁnes the speed at which the process deﬁned by the reaction takes place. A detailed description of3\nKineticLaw is left to Section 4.13.5 below.4\n64\nNature Precedings : hdl:10101/npre.2007.58.1 : Posted 18 Jun 2007\nNote that the inclusion of a KineticLaw object in an instance of a Reaction component is optional; however,1\nin general there is no useful default that can be substituted in place of a missing rate expression in a2\nreaction. Moreover, a reaction’s rate cannot be deﬁned in any other way in SBML— InitialAssignment,3\nAssignmentRule, RateRule, AlgebraicRule, Event, and other constructs in SBML cannot be used to set the4\nreaction rate separately. Nevertheless, for some modeling applications, reactions without any deﬁned rate5\ncan be perfectly acceptable.6\nThe reversible attribute7\nThe optional boolean attribute reversible indicates whether the reaction is reversible. The default is8\n“true”.9\nTo say that a reaction is reversible is to say it can proceed in either the forward or the reverse direction.10\nAlthough the reversibility of a reaction can sometimes be deduced by inspecting its rate expression, this is11\nnot always the case, especially for complicated expressions. Having a separate attribute supports the ability12\nto perform some kinds of model analyses in the absence of performing a time-course simulation of the model.13\nMoreover, the need in SBML to allow rate expressions (i.e., KineticLaw) to be optional leads to the need for14\na separate ﬂag indicating reversibility. Information about reversibility in the absence of a KineticLaw in a15\nReaction is useful in certain kinds of structural analyses such as elementary mode analysis.16\nMathematically, the reversible attribute on Reaction has no impact on the construction of the equations17\ngiving the overall rates of change of each species quantity in a model. A concrete explanation may help18\nillustrate this. Suppose a model consists of multiple reactions, of which two particular irreversible reactions19\nRf and Rr are actually the forward and reverse processes of the same underlying reaction. The product20\nspecies of Rf necessarily will be the reactants of Rr, and the reactants of Rf will be the products of Rr.21\nLet ff (X) and fr(X) be the SBML kinetic rate formulas of Rf and Rr, respectively, with X representing22\nthe species, parameters and compartments in the model. For the sake of this example, suppose we are using23\na continuous diﬀerential equation framework to simulate the system of reactions. Then for each species, we24\nneed to construct an expression representing the overall rate of change of that species’ amount in the model.25\nThis overall expression will be a sum of the contributions of all the relevant rate formulas,26\ndS\ndt = . . . − n·ff (X) + n·fr(X) + . . .27\nwhere S is a reactant species of Rf and a product of Rr, n is the eﬀective stoichiometry of S in Rf (which28\nby implication must be the same as its stoichiometry in Rr), and “. . . ” indicates other rate formulas in the29\nmodel involving the particular species S. Now, contrast this to the case of an identical second SBML model,30\nexcept that instead of having separate Reaction deﬁnitions for the forward and reverse reactions, this model31\nhas a single Reaction Rc labeled as reversible and whose reactants and products are the same as those of32\nRf in the ﬁrst model. The rate of this reaction will be a formula fc = ff (X) − fr(X). In constructing an33\nexpression representing the overall rate of change for the species S involved in that reaction, we will have34\ndS\ndt = . . . − n·fc(X) + . . .\n= . . . − n·ff (X) + n·fr(X) + . . .\n35\nIn other words, the result is the same ﬁnal expression for the rate of change of a species. Although in36\nthis simple example we used an expression for fc that had clearly separated terms, in the general case the37\nexpression may have a more complicated form.38\nNote that labeling a reaction as irreversible is an assertion that the reaction always proceeds in the given39\nforward direction. (Why else would it be ﬂagged as irreversible?) This implies the rate expression in the40\nKineticLaw always has a non-negative value during simulations. Software tools could provide a means of41\noptionally testing that this condition holds. The presence of reversibility information in two places (i.e., the42\nrate expression and the reversible ﬂag) leaves open the possibility that a model could contain contradictory43\ninformation, but the creation of such a model would be an error on the part of the software generating it.44\n65\nNature Precedings : hdl:10101/npre.2007.58.1 : Posted 18 Jun 2007\nThe fast attribute1\nThe optional boolean attribute fast is another optional boolean attribute of Reaction. The attribute’s2\ndefault value is “ false”.3\nPrevious deﬁnitions of SBML indicated that software tools could ignore this attribute if they did not im-4\nplement support for the corresponding concept; however, further research has revealed that this is incorrect5\nand fast cannot be ignored if it is set to “ true”. SBML Level 2 Version 3 therefore stipulates that if a6\nmodel has any reactions with fast set to “ true”, a software tool must be able to respect the attribute or7\nelse indicate to the user that it does not have the capacity to do so. Analysis software cannot ignore the8\nvalue of the fast attribute because doing so may lead to diﬀerent results as compared to a software system9\nthat does make use of fast.10\nWhen a model contains true values for fast on any of its reactions, it is an indication that the creator of11\nthe model is distinguishing diﬀerent time scales of reactions in the system. The model’s reaction deﬁnitions12\nare divided into two sets by the values of the fast attributes. The set of reactions having fast=“true”13\n(known as fast reactions ) should be assumed to be operating on a time scale signiﬁcantly faster than the14\nother reactions (the slow reactions ). Fast reactions are considered to be instantaneous relative to the slow15\nreactions.16\nSoftware tools must use a pseudo steady-state approximation for the set of fast reactions when constructing17\nthe system of equations for the model. More speciﬁcally, the set of reactions that have the fast attribute18\nset to “ true” forms a subsystem that should be described by a pseudo steady-state approximation in rela-19\ntionship to all other reactions in the model. Under this description, relaxation from any initial condition or20\nperturbation from any intermediate state of this subsystem would be inﬁnitely fast. Appendix E provides a21\ntechnical explanation of an approach to solving systems with fast reactions.22\nThe correctness of the approximation requires a signiﬁcant separation of time scales between the fast reactions23\nand other processes. This is not trivial to estimate a priori, and may even change over the course of a24\nsimulation, but can reasonably be assessed a posteriori in most cases.25\nThe sboTerm attribute on Reaction26\nThe Reaction object class inherits from Sbase the optional sboTerm attribute of type SBOTerm (see Sec-27\ntions 3.1.9 and 5). When a value is given to this attribute in a reaction deﬁnition, the value must be a28\nvalid SBO identiﬁer referring to an event (i.e., terms derived from SBO:0000231, “event”). The Reaction29\nobject should have an “is a” relationship with the SBO term. The SBO term chosen should be the most30\nprecise (narrow) term that deﬁnes the event represented by the reaction as a whole. For example, a given31\nreaction in a model might represent binding, which has a term in SBO (identiﬁer SBO:0000177, deﬁnition32\n“Interaction between several biochemical entities that results in the formation of a non-covalent complex ”).33\nThe corresponding Reaction instance in SBML would have sboTerm=\"SBO:0000177\".34\nAs mentioned elsewhere, SBO labels are optional information on a model. Applications are free to ignore35\nsboTerm values, and a model must be interpretable without the beneﬁt of SBO labels. Section 5 gives more36\ninformation about this principle and the use of SBO.37\n4.13.2 The SimpleSpeciesReference abstract type38\nAs mentioned above, every species that enters into a given reaction must appear in that reaction’s lists of39\nreactants, products and/or modiﬁers. In an SBML model, all species that may participate in any reaction40\nare listed in the listOfSpecies element of the top-level Model instance (see Section 4.2). Lists of products,41\nreactants and modiﬁers in Reaction objects do not introduce new species, but rather, they refer back to42\nthose listed in the model’s top-level listOfSpecies. For reactants and products, the connection is made43\nusing a SpeciesReference object; for modiﬁers, it is made using a ModiﬁerSpeciesReference object. Simple-44\nSpeciesReference, deﬁned in Figure 21 on page 64, is an abstract type that serves as the parent class of both45\nSpeciesReference and ModiﬁerSpeciesReference. It is used simply to hold the attributes and elements that46\nare common to the latter two objects.47\n66\nNature Precedings : hdl:10101/npre.2007.58.1 : Posted 18 Jun 2007\nThe id and name attributes1\nThe optional identiﬁer stored in the id attribute allows SpeciesReference and ModiﬁerSpeciesReference2\ninstances to be referenced from other object. No SBML object classes currently do this; however, such classes3\nare anticipated in future SBML Levels. The value of id must be a text string conforming to the syntax4\npermitted by the SId data type described in Section 3.1.7. The id value (whether it is in a SpeciesReference5\nor ModiﬁerSpeciesReference object) exists in the global namespace of the model, as described in Section 3.3.6\nThe id and name attributes must be used as described in Section 3.3.7\nThe species attribute8\nThe SimpleSpeciesReference object class has a required attribute , species, of type SId. As with the other9\nattributes, it is inherited by SpeciesReference and ModiﬁerSpeciesReference. The value of species must10\nbe the identiﬁer of a species deﬁned in the enclosing Model. The species is thereby declared as partici-11\npating in the reaction being deﬁned. The precise role of that species as a reactant, product, or modiﬁer12\nin the reaction is determined by the subtype of SimpleSpeciesReference (i.e., either SpeciesReference or13\nModiﬁerSpeciesReference) in which the identiﬁer appears.14\nThe sboTerm attribute15\nThe class SimpleSpeciesReference inherits from Sbase the optional sboTerm attribute of type SBOTerm (see16\nSections 3.1.9 and 5). This means that the object classes derived from SimpleSpeciesReference, namely17\nSpeciesReference and ModiﬁerSpeciesReference, all have sboTerm attributes. When a value is given to this18\nattribute, it must be a valid SBO identiﬁer referring to a participant role. The appropriate SBO term19\ndepends on whether the object is a reactant, product or modiﬁer. If a reactant, then it should be a term20\nin the SBO:0000010, “reactant” hierarchy; if a product, then it should be a term in the SBO:0000011,21\n“product” hierarchy; and if a modiﬁer, then it should be a term in the SBO:0000019, “modiﬁer” hierarchy.22\nThe SpeciesReference and ModiﬁerSpeciesReference instances should have an “is a” relationship to the term23\nidentiﬁed by the SBO identiﬁer.24\nThe SBO terms chosen should be the most precise (narrow) one that deﬁnes the role of the species in the25\nreaction. An SBO reactant term can only be assigned to the sboTerm attribute of a SpeciesReference instance26\nwhen that instance is contained in the list of reactants in the containing Reaction instance. Similarly, an27\nSBO product term can only be assigned to the sboTerm attribute of a SpeciesReference instance when that28\ninstance is contained in the list of products in the containing Reaction instance.29\n4.13.3 SpeciesReference30\nThe Reaction object class provides a way to express which species act as reactants and which species act as31\nproducts in a reaction. In a given reaction, references to those species acting as reactants and/or products32\nare made using instances of SpeciesReference objects in Reaction’s lists of reactants and products. The33\nSpeciesReference structure inherits the mandatory attribute species and optional attributes id, name, and34\nsboTerm, from the parent type SimpleSpeciesReference; see Section 4.13.2 for their deﬁnitions. It also deﬁnes35\nattribute stoichiometry and element stoichiometryMath, described below.36\nThe species attribute value must be the identiﬁer of an existing species deﬁned in the enclosing Model;37\nthe species is thereby designated as a reactant or product in the reaction. Which one it is (i.e., reactant or38\nproduct) is indicated by whether the SpeciesReference appears in the Reaction’s reactant or product lists.39\nThe stoichiometry attribute and stoichiometryMath element40\nProduct and reactant stoichiometries can be speciﬁed using either stoichiometry or stoichiometryMath41\nin a SpeciesReference object. The stoichiometry attribute is of type double and should contain values42\ngreater than zero (0). The stoichiometryMath element is implemented as an element containing a MathML43\nexpression. These two are mutually exclusive; only one of stoichiometry or stoichiometryMath should be44\ndeﬁned in a given SpeciesReference instance. When neither the attribute nor the element is present, the45\nvalue of stoichiometry in the SpeciesReference instance defaults to “ 1”.46\n67\nNature Precedings : hdl:10101/npre.2007.58.1 : Posted 18 Jun 2007\nFor maximum interoperability, SpeciesReference’s stoichiometry attribute should be used in preference to1\nstoichiometryMath when a species’ stoichiometry is a simple scalar number (integer or decimal). When2\nthe stoichiometry is a rational number, or when it is a more complicated formula, stoichiometryMath must3\nbe used. The MathML expression in stoichiometryMath may also refer to identiﬁers of entities in a model4\n(except reaction identiﬁers), as discussed in Section 3.4.3. However, the only species identiﬁers that can be5\nused in stoichiometryMath are those referenced in the Reaction list of reactants, products and modiﬁers.6\nThe stoichiometry attribute and the stoichiometryMath element, when either is used, is each interpreted7\nas a factor applied to the reaction rate to give the rate of change of the species identiﬁed by the species8\nattribute. This is the normal interpretation of a stoichiometry, but in SBML, one additional consideration9\nhas to be taken into account. The reaction rate, which is the result of the KineticLaw math element, is always10\nin the model’s substance per time units. However, the rate of change of the species will involve the species’11\nsubstance units (i.e., the units identiﬁed by the Species object’s substanceUnits attribute), and these units12\nmay be diﬀerent from the model’s default substance units. If the units are diﬀerent, the stoichiometry13\nmust incorporate a conversion factor for converting the model’s substance units to the species’ substance14\nunits. The conversion factor is assumed to be included in the scalar value of the stoichiometry attribute15\nif stoichiometry is used. If instead stoichiometryMath is used, then the product of the model’s substance16\nunits times the stoichiometryMath units must match the substance units of the species. Note that in either17\ncase, if the species’ units and the model’s default substance units are the same, the stoichiometry ends up18\nbeing a dimensionless number and equivalent to the standard chemical stoichiometry found in textbooks.19\nExamples and more explanations of this are given in Section 4.13.6.20\nThe following is a simple example of a species reference for species “ X0”, with stoichiometry “ 2”, in a list of21\nreactants within a reaction having the identiﬁer “ J1”:22\n<model>23\n...24\n<listOfReactions>25\n<reaction id=\"J1\">26\n<listOfReactants>27\n<speciesReference species=\"X0\" stoichiometry=\"2\">28\n</listOfReactants>29\n...30\n</reaction>31\n...32\n</listOfReactions>33\n...34\n</model>35\nThe following is a more complex example of a species reference for species “X0”, with a stoichiometry formula36\nconsisting of a rational number :37\n<model>38\n...39\n<listOfReactions>40\n<reaction id=\"J1\">41\n<listOfReactants>42\n<speciesReference species=\"X0\">43\n<stoichiometryMath>44\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\">45\n<cn type=\"rational\"> 3 <sep/> 2 </cn>46\n</math>47\n</stoichiometryMath>48\n</speciesReference>49\n</listOfReactants>50\n...51\n</reaction>52\n...53\n</listOfReactions>54\n...55\n</model>56\nA species can occur more than once in the lists of reactants and products of a given Reaction instance.57\nThe eﬀective stoichiometry for a species in a reaction is the sum of the stoichiometry values given in the58\n68\nNature Precedings : hdl:10101/npre.2007.58.1 : Posted 18 Jun 2007\nSpeciesReference objects in the list of products minus the sum of stoichiometry values given in the Species-1\nReference objects in the list of reactants. A positive value indicates the species is eﬀectively a product and2\na negative value indicates the species is eﬀectively a reactant. SBML places no restrictions on the eﬀective3\nstoichiometry of a species in a reaction; for example, it can be zero. In the following SBML fragment, the4\ntwo reactions have the same eﬀective stoichiometry for all their species:5\n<reaction id=\"x\">6\n<listOfReactants>7\n<speciesReference species=\"a\"/>8\n<speciesReference species=\"a\"/>9\n<speciesReference species=\"b\"/>10\n</listOfReactants>11\n<listOfProducts>12\n<speciesReference species=\"c\"/>13\n<speciesReference species=\"b\"/>14\n</listProducts>15\n</reaction>16\n<reaction id=\"y\">17\n<listOfReactants>18\n<speciesReference species=\"a\" stoichiometry=\"2\"/>19\n</listOfReactants>20\n<listOfProducts>21\n<speciesReference species=\"c\"/>22\n</listProducts>23\n</reaction>24\n4.13.4 ModiﬁerSpeciesReference25\nSometimes a species appears in the kinetic rate formula of a reaction but is itself neither created nor destroyed26\nin that reaction (for example, because it acts as a catalyst or inhibitor). In SBML, all such species are simply27\ncalled modiﬁers without regard to the detailed role of those species in the model. The Reaction object class28\nprovides a way to express which species act as modiﬁers in a given reaction. This is the purpose of the list29\nof modiﬁers available in Reaction. The list contains instances of ModiﬁerSpeciesReference object.30\nAs shown in Figure 21 on page 64, the ModiﬁerSpeciesReference class inherits the mandatory attribute31\nspecies and optional attributes id and name from the parent class SimpleSpeciesReference; see Section 4.13.232\nfor their precise deﬁnitions.33\nThe value of the species attribute must be the identiﬁer of a species deﬁned in the enclosing Model; this34\nspecies is designated as a modiﬁer for the current reaction. A reaction may have any number of modiﬁers.35\nIt is permissible for a modiﬁer species to appear simultaneously in the list of reactants and products of the36\nsame reaction where it is designated as a modiﬁer, as well as to appear in the list of reactants, products and37\nmodiﬁers of other reactions in the model.38\n4.13.5 KineticLaw39\nThe KineticLaw object class is used to describe the rate at which the process deﬁned by the Reaction takes40\nplace. As shown in Figure 21 on page 64, KineticLaw has elements called math and listOfParameters, in41\naddition to the attributes and elements it inherits from Sbase.42\nPrevious deﬁnitions of SBML included two additional attributes called substanceUnits and timeUnits,43\nwhich allowed the substance/time units of the reaction rate expression to be deﬁned on a per-reaction basis.44\nSBML Level 2 Version 2 and Version 3 removed these attributes for several reasons. First, the introduction45\nin SBML Level 2 Version 2 of mass and dimensionless units as possible units of substance, coupled with46\nthe previous facility for deﬁning the units of each reaction separately and the ability to use non-integer47\nstoichiometries, lead to the possibility of creating a valid model whose reactions nevertheless could not be48\nintegrated into a system of equations without outside knowledge for converting the quantities used. (As49\na simple example, consider if one reaction is deﬁned to be in grams per second and another in moles per50\nsecond, and species are given in moles: converting from mass to moles would require knowing the molecular51\nmass of the species.) Second, the ability to change the units of a reaction provided the potential of creating52\nunintuitive and diﬃcult-to-reconcile systems of equations, yet the feature added little functionality to SBML.53\n69\nNature Precedings : hdl:10101/npre.2007.58.1 : Posted 18 Jun 2007\nThe absence of substanceUnits does not prevent the deﬁnition of any reactions; it only results in requiring1\nthe generator of the model to be explicit about any necessary conversion factors. Third, few if any software2\ntools have ever correctly implemented support for substanceUnits, which made the use of this attribute in3\na model an impediment to interoperability. Fourth, examination of real-life models revealed that a frequent4\nreason for using substanceUnits was to set the units of all reactions to the same set of substance units,5\nwhich is better achieved by setting the model-wide values of “ substance”.6\nThe math element7\nAs shown in Figure 21 on page 64, KineticLaw has a element called math for holding a MathML formula8\ndeﬁning the rate of the reaction. The expression in math may refer to species identiﬁers, as discussed in9\nSection 3.4.3. The only Species identiﬁers that can be used in math are those declared in the lists of10\nreactants, products and modiﬁers in the Reaction object (see Sections 4.13.2, 4.13.3 and 4.13.4). Parameter11\nidentiﬁers may be taken from the KineticLaw’s list of local parameters (see below) or the parameters deﬁned12\nglobally on the Model instance.13\nSection 4.13.6 provides important discussions about the meaning and interpretation of SBML “kinetic laws”.14\nThe list of parameters15\nAn instance of KineticLaw can contain a list of one or more Parameter objects (Section 4.9) which deﬁne16\nnew parameters whose identiﬁers can be used in the math formula. As discussed in Section 3.3.1, reactions17\nintroduce local namespaces for parameter identiﬁers, and within a KineticLaw object, a local parameter whose18\nidentiﬁer is identical to a global parameter deﬁned in the model takes precedence over that global parameter.19\nThe type of object used to deﬁne a parameter inside KineticLaw is the same Parameter object class used to20\ndeﬁne global parameters (Section 4.9). This simpliﬁes the SBML language and reduces the number of unique21\ntypes of data objects. However, there is a diﬀerence between local and global parameters: in the case of22\nparameters deﬁned locally to a KineticLaw, there is no means by which the parameter values can be changed.23\nConsequently, such parameters’ values are always constant, and the constant attribute in their deﬁnitions24\nmust always have a value of “ true” (either explicitly or left to its default value).25\nThe sboTerm attribute26\nKineticLaw inherits from Sbase the optional attribute called sboTerm of type SBOTerm (see Section 5). When a27\nvalue is given to this attribute, the value must be an SBO identiﬁer referring to a term from the SBO:0000001,28\n“rate law” vocabulary deﬁned in SBO. The relationship is of the form “the kinetic law is a X”, where X is29\nthe SBO term. The SBO term chosen should be the most precise (narrow) term that deﬁnes the type of30\nreaction rate expression encoded by the KineticLaw instance.31\nAs explained in Section 4.2.2, there is an interaction between the SBO terms chosen for a model’s KineticLaw32\ninstances and the sboTerm value given to the overall Model instance. The interaction is as follows. In SBO,33\neach deﬁnition of a rate expression itself includes its own SBO reference to a mathematical framework. When34\na given KineticLaw element refers to a rate law deﬁned in SBO, it therefore simultaneously also identiﬁes a35\nframework. If a Model instance has a value for sboTerm, it implies that all reaction kinetics in the model36\nassume the same mathematical framework. In that case, the frameworks referenced in the SBO deﬁnitions37\nof individual reaction rate expressions may be ignored. Consequently, if the mathematical frameworks38\nunderlying the deﬁnitions of diﬀerent reactions in a model should be observed individually (e.g., because the39\nmodel mixes frameworks), then there should not be a value assigned to sboTerm on the enclosing Model.40\nExample41\nThe following is an example of a Reaction object that deﬁnes a reaction with identiﬁer J1, in which X0 → S142\nat a rate given by k · [X0] · [S2], where S2 is a catalyst and k is a parameter, and the square brackets43\nsymbolizes that the species quantities have units of concentration. The example demonstrates the use of44\nspecies references and KineticLaw objects. The units on the species here are the defaults of substance/volume45\n(see Section 4.8), and so the rate expression k ·[X0] ·[S2] needs to be multiplied by the compartment volume46\n(represented by its identiﬁer, “ c1”) to produce the ﬁnal units of substance/time for the rate expression.47\n70\nNature Precedings : hdl:10101/npre.2007.58.1 : Posted 18 Jun 2007\n<model>1\n...2\n<listOfUnitDefinitions>3\n<unitDefinition id=\"per_concent_per_time\">4\n<listOfUnits>5\n<unit kind=\"litre\"/>6\n<unit kind=\"mole\" exponent=\"-1\"/>7\n<unit kind=\"second\" exponent=\"-1\"/>8\n</listOfUnits>9\n</unitDefinition>10\n</listOfUnitDefinitions>11\n...12\n<listOfSpecies>13\n<species id=\"S1\" compartment=\"c1\" initialConcentration=\"2.0\"/>14\n<species id=\"S2\" compartment=\"c1\" initialConcentration=\"0.5\"/>15\n<species id=\"X0\" compartment=\"c1\" initialConcentration=\"1.0\"/>16\n</listOfSpecies>17\n...18\n<listOfReactions>19\n<reaction id=\"J1\">20\n<listOfReactants>21\n<speciesReference species=\"X0\"/>22\n</listOfReactants>23\n<listOfProducts>24\n<speciesReference species=\"S1\"/>25\n</listOfProducts>26\n<listOfModifiers>27\n<modifierSpeciesReference species=\"S2\"/>28\n</listOfModifiers>29\n<kineticLaw>30\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\">31\n<apply>32\n<times/> <ci> k </ci> <ci> S2 </ci> <ci> X0 </ci> <ci> c1 </ci>33\n</apply>34\n</math>35\n<listOfParameters>36\n<parameter id=\"k\" value=\"0.1\" units=\"per_concent_per_time\"/>37\n</listOfParameters>38\n</kineticLaw>39\n</reaction>40\n</listOfReactions>41\n...42\n</model>43\n4.13.6 Traditional rate laws versus SBML “kinetic laws”44\nIt is important to make clear that a “kinetic law” in SBML is not identical to a traditional rate law. The45\nreason is that SBML must support multicompartment models, and the units normally used in traditional46\nrate laws as well as some conventional single-compartment modeling packages are problematic when used47\nfor deﬁning reactions between multiple compartments.48\nWhen modeling species as continuous amounts (e.g., concentrations), the rate laws used are traditionally49\nexpressed in terms of amount of substance concentration per time , embodying a tacit assumption that reac-50\ntants and products are all located in a single, constant volume. Attempting to describe reactions between51\nmultiple volumes using concentration/time (which is to say, substance/volume/time) quickly leads to diﬃ-52\nculties. Here is an illustration of this. Suppose we have two species pools S1 and S2, with S1 located in53\na compartment having volume V1, and S2 located in a compartment having volume V2. Let the volume54\nV2 = 3 V1. Now consider a transport reaction S1 → S2 in which the species S1 is moved from the ﬁrst com-55\npartment to the second. Assume the simplest type of chemical kinetics, in which the rate of the transport56\nreaction is controlled by the activity of S1 and this rate is equal to some constant k times the activity of S1.57\nFor the sake of simplicity, assume S1 is in a diluted solution and thus that the activity of S1 can be taken58\nto be equal to its concentration [ S1]. The rate expression will therefore be k · [S1], with the units of k being59\n1/time. Then:60\n71\nNature Precedings : hdl:10101/npre.2007.58.1 : Posted 18 Jun 2007\n1\nd[S2]\ndt = −d[S1]\ndt = k · [S1]2\nSo far, this looks normal—until we consider the number of molecules of S1 that disappear from the com-3\npartment of volume V1 and appear in the compartment of volume V2. The number of molecules of S1 (call4\nthis nS1 ) is given by [ S1] · V1 and the number of molecules of S2 (call this nS2 ) is given by [ S2] · V2. Since5\nour volumes have the relationship V2/V1 = 3, the relationship above implies that nS1 = k ·[S1] ·V1 molecules6\ndisappear from the ﬁrst compartment per unit of time and nS2 = 3 · k · [S1] · V1 molecules appear in the7\nsecond compartment. In other words, we have created matter out of nothing!8\nThe problem lies in the use of concentrations as the measure of what is transfered by the reaction, be-9\ncause concentrations depend on volumes and the scenario involves multiple unequal volumes. The problem10\nis not limited to using concentrations or volumes; the same problem also exists when using density, i.e.,11\nmass/volume, and dependency on other spatial distributions (i.e., areas or lengths). What must be done12\ninstead is to consider the number of “items” being acted upon by a reaction process irrespective of their13\ndistribution in space (volume, area or length). An “item” in this context may be a molecule, particle, mass,14\nor other “thing”, as long as the substance measurement is independent of the size of the space in which the15\nitems are located.16\nFor the current example, the expressions in terms of nS1 and nS2 are straightforward:17\ndnS2\ndt = −dnS1\ndt = k · [S1] · V118\nGiven numbers of items, it is then easy to recover concentrations by dividing the item counts of each species19\nby the volume of the compartment in which the species is located: [ S1] = nS1 /V1 and [ S2] = nS2 /V2.20\nThe need to support multicompartment models requires that the reaction rates in SBML to be expressed21\nin terms of substance/time, rather than the more typical substance/size/time. As a result, modelers and22\nsoftware tools in general cannot insert textbook rate laws unmodiﬁed as the rate expression in the math23\nelement of a KineticLaw. The unusual term “kinetic law” was chosen to alert users to this diﬀerence. We24\nexplain the general principles of converting rate laws in the following paragraphs.25\nBasic cases26\nLet us expand the simple example above by adding a second reaction, to create the system27\nS1 → S2 → S328\nwith the left-hand reaction’s rate (call this r1) being given as k1 ·[S1] and the rate of the right-hand reaction29\n(call it r2) as k2 · [S2]. Also assume each species is located in a diﬀerent compartment:30\n31 S1 located in compartment C1 with volume V1\n32 S2 located in compartment C2 with volume V2\n33 S3 located in compartment C3 with volume V3\nAs before, converting the rate of the ﬁrst reaction ( S1 → S2) to units of substance/time in this case is a34\nsimple matter of multiplying by the volume of the compartment where the reactants are located, leading to35\nthe following SBML rate formula:36\nR1 = r1 · V1 = −k1 · [S1] · V137\nThe second rate expression becomes38\nR2 = r2 · V2 = −k2 · [S2] · V239\nThe units of k1 and k2 are 1 /time (often 1 /sec, but not necessarily), as is typical for reactions that are ﬁrst-40\norder in one reactant. The expressions R1 and R2 are what would be written in KineticLaw math deﬁnitions41\nfor the two reactions in this system. The formulas give the speed of each reaction in terms of the substance42\nchange over time. The reader of the SBML model needs to combine the individual contributions of each43\n72\nNature Precedings : hdl:10101/npre.2007.58.1 : Posted 18 Jun 2007\nreaction to construct equations for the overall rates of change of each species in the model using these1\nexpressions. In terms of diﬀerential equations, these are:2\ndnS1\ndt =−R1 = −k1 · [S1] · V1\ndnS2\ndt =+R1 − R2 = +k1 · [S1] · V1 − k2 · [S2] · V2\ndnS3\ndt = + R2 = + k2 · [S2] · V2\n3\nTo recover the concentration values, we add the following to the system of equations:4\n[S1] = nS1 /V1\n[S2] = nS2 /V2\n[S3] = nS3 /V3\n5\nNote that this formulation works properly even if the compartment sizes V1, V2 and V3 vary during simulation.6\nExtrapolating from this example, we can now provide a general approach to translating a system of reactions7\ninvolving species located in multiple compartments, for the restricted case where all reactants of any given8\nreaction are in the same compartment (but where the compartments involved may be diﬀerent for each9\nreaction). For a species Si involved in m reactions whose rates are given (in “textbook” form, without10\nvolume adjustments) as r1, r2, . . . , rm, where the reactants of rj are located in the compartment of size Vj,11\ndnSi\ndt = sign 1 · stoich1 · r1 · V1\n+ sign2 · stoich2 · r2 · V2\n+ . . .\n+ signm · stoichm · rm · Vm\n[Si] = nSi /Vi\n(7)12\nIn Equation ( 7), each term sign j is “ −” if Si is a reactant in rj and “+” if it is a product, and each term13\nstoichj is the stoichiometry of Si in reaction rj. Letting Rj = rj ·Vj represent the form of the rate expressions14\nas they would be written in the KineticLaw math elements, then we can equivalently write15\ndnSi\ndt = sign 1 · stoich1 · R1\n+ sign2 · stoich2 · R2\n+ . . .\n+ signm · stoichm · Rm\n[Si] = nSi /Vi\n(8)16\nThis approach preserves the use of concentration terms within the reaction rate expressions so that the core17\nof those rate expressions can be ordinary rate laws. This is important when modeling species as continuous18\nquantities, because most textbook rate expressions are measured in terms of concentrations, and most19\nrate constants have units involving concentration rather than item counts. For example, the second-order20\nrate constant in a mass-action rate law has units of 1/( M · s), which is to say, volume/(substance·time);21\nthis constant is then multiplied by two concentration terms. Reaction deﬁnitions in SBML models can be22\nconstructed by taking such expressions and multiplying them by the volume of the compartment in which23\nthe reactants are located. By contrast, if we were to simply replace concentrations of species by item counts24\nin such rate laws, it would in most cases be incorrect. At the very least, the constants in the equations would25\nneed to be converted in some way to make such expressions valid.26\n73\nNature Precedings : hdl:10101/npre.2007.58.1 : Posted 18 Jun 2007\nThe preceding discussion of problems involving rate laws concerns modeling approaches that use continuous1\nquantities. There is an alternative approach to modeling that instead treats species as discrete popula-2\ntions ( Wilkinson, 2006). In those cases, the rate expressions already use substance or item counts rather3\nthan concentrations and there is no need to convert them.4\nA full SBML example of translating a complete multicompartmental model into ODEs is given in Section 7.7.5\nAn example of translating a discrete model is given in Section 7.3.6\nAdvanced cases7\nThe explanation above applies to reactions where all of the reactants are in the same compartment. What8\nabout cases where two or more reactant species are in separate compartments?9\nThis is a more diﬃcult situation, and the guidelines described above for Equation ( 7) cannot always be10\napplied because there will be more than one compartment size term by which the core rate expression needs11\nto be multiplied. Unfortunately, there is often no straightforward way to mechanically convert such models12\nwithout requiring a more signiﬁcant change to the reaction rate expression. An example will help illustrate13\nthe diﬃculty. Suppose we have a simple reaction system consisting of only14\nS1 + S2 → S315\nwhere S1, S2 and S3 are each located in separate compartments with volumes V1, V2 and V3, and the rate16\nexpression is given as k · [S1] · [S2]. (In reality, one would not use such a rate law in this case, but for the17\nsake of this example, let us ignore the fact that a mass-action rate law would actually involve an assumption18\nthat all reactants are in a well-mixed solution.) A straightforward examination of the possibilities eventually19\nleads to the conclusion that in order to take account of the multiple volumes, the rate expressions in terms20\nof substance/time have to be written as21\ndnSi\ndt = −k′(V1, V2) ·\n(\n[S1] · V1\n)\n·\n(\n[S2] · V2\n)\n22\nThe crux of the problem is that the new factor k′(V1, V2) is not the original k; to make the overall units of23\nthe expression work out, k′(V1, V2) must be a function of the volumes, and its value must change if V1 or V224\nchanges. It is no longer a standard rate constant. In an SBML model, it is easy to deﬁne an AssignmentRule25\nto compute the value of k′ based on k, V1, V2, and possibly other variables in the system as needed, but only26\nthe modeler can determine the proper formula for their particular modeling situation. (For example, the27\nmodeler may know that in their hypothesized physical system, the reaction actually takes place completely28\nin one or the other compartment and therefore the factor should be designed accordingly, or perhaps the29\nreaction takes place on a membrane between compartments and a scaling factor based on the area should30\nbe used.)31\nThus, although these models can be represented in SBML, constructing the correct rate expression in terms32\nof substance/time units depends on problem-speciﬁc knowledge, and we cannot provide a general recipe.33\nMixed species units34\nThe discussion so far has assumed that all of the species appearing in a given reaction’s rate expression35\nhad the same units, whether they be concentration or amounts or other. However, Species objects can each36\ndeclare units separately. What happens then?37\nIt is important to realize that implicit conversions in this situation are not deﬁned in SBML. A species38\nidentiﬁer appearing in a mathematical expression has the units attributed to that species (see Section 4.8.539\nfor a deﬁnition of the the units of the species ). If a reaction contains species each having diﬀerent units, the40\ncreator of the SBML model must explicitly incorporate the necessary conversions to make the units of the41\nrate expression consistent. The most appropriate way is to include the conversion factor as part of the value42\nof stoichiometry or stoichiometryMath in the SpeciesReference for that species.43\n74\nNature Precedings : hdl:10101/npre.2007.58.1 : Posted 18 Jun 2007\nAn example may help illustrate this. Suppose we have a system of two biochemical reactions with mass-action1\nkinetics, written in the traditional form2\nA + 2 B\nk1\n− →C\nC\nk2\n− →3 A\n(9)3\nwith the units of k1 being liter2s2mol−2 and k2’s units being s−1. Assume the reactions take place in a4\nsingle compartment of volume V , but now let us throw a wrench into the problem: suppose that the species5\nin the model are deﬁned with mixed units as follows:6\n7 A is in millimoles per litre\n8 B is in grams per litre\n9 C is in items per litre\nWhen biochemical reaction equations of the form ( 9) above are written, the units of species’ quantities10\nusually are assumed to be the same, and therefore the stoichiometries in the reaction equations ( 9) represent11\nsimple ratios between the quantities of the species in those units. ( “One mole of this and two moles of that12\nreact to produce one mole of that other .”) If instead the quantities of the species are given in mixed units,13\nas in the present example, the quantities not only need to be in proper stoichiometric relationships, the14\nunits also have to be made consistent. In SBML, this is done by appropriately setting the stoichiometry15\nattribute value in the species references of the lists of reactants, products and modiﬁers in a Reaction. This16\nthen permits a properly balanced system of equations to be constructed for each species’ rate of change of17\nquantity.18\nIn the present example, the SBML “kinetic law” formulas for the reaction rates will be written as conventional19\nmass-action reaction rates adjusted for volume as described previously ,20\nR1 = k1\n′ · [A] · [B]2 · V\nR2 = k2\n′ · [C] · V\n21\nwhere k2\n′ = k2 for this particular example but k1\n′ will depend on other units as described in the paragraphs22\nbelow. When these formulas are combined into overall expressions for the rates of change of A, B, and C,23\nthe result is24\ndA/dt = −a1 · R1 + a2 · R2\ndB/dt = −b1 · R1\ndC/dt = +c1 · R1 − c2 · R2\n25\nwhere26\n27 a1 is the SBML stoichiometry of A in reaction 1\n28 a2 is the SBML stoichiometry of A in reaction 2\n29 b1 is the SBML stoichiometry of B in reaction 1\n30 c1 is the SBML stoichiometry of C in reaction 1\n31 c2 is the SBML stoichiometry of C in reaction 2\nWe use the term SBML stoichiometries to highlight the fact that in this example involving mixed-units32\nspecies, the values may not be identical to the biochemical stoichiometries in the reaction equations ( 9).33\nAnd just what are the SBML stoichiometries ? In the kind of mixed-units situation faced in this example,34\nthey must encompass both the biochemical stoichiometries and any necessary unit conversions. Thus, letting35\nmB stand for the molecular mass of B:36\n37 a1 = 1000 (in each reaction event, 1 mole of A is consumed, with A expressed in millimoles)\n38 a2 = 3000 (in each reaction event, 3 moles of A are produced, with A expressed in millimoles)\n39 b1 = 2 · mB (in each reaction event, 2 moles of B are consumed, with B expressed in grams)\n40 c1 = 6 .02 · 1023 (in each reaction event, 1 mole of C is produced, expressed as item counts)\n41 c2 = 6 .02 · 1023 (in each reaction event, 1 mole of C is consumed, expressed as item counts)\nand k1\n′ = k1 · 10−3 · 1/mB2.42\n75\nNature Precedings : hdl:10101/npre.2007.58.1 : Posted 18 Jun 2007\nWhat happens if the deﬁnition of the SBML built-in unit “ substance” is changed in the model to be1\nmillimoles? Then the stoichiometries must be changed to the following:2\n3 a1 = 1 (in each reaction event, 1 millimole of A is consumed, expressed in millimoles)\n4 a2 = 3 (in each reaction event, 3 millimoles of A are produced, expressed in millimoles)\n5 b1 = 2 · 10−3 · mB (in each reaction event, 2 millimoles of B are consumed, expressed in grams)\n6 c1 = 6 .02 · 1020 (in each reaction event, 1 millimole of C is produced, expressed as item counts)\n7 c2 = 6 .02 · 1020 (in each reaction event, 1 millimole of C is consumed, expressed as item counts)\nand k1\n′ = k1 · (103/mB)2.8\nWhat happens if instead the deﬁnition of the SBML built-in unit “ substance” is changed in the model to9\nbe “ item”? Then the stoichiometries must be changed to the following:10\n11 a1 = 1 /(6.02 · 1020) (in each reaction event, 1 item of A is consumed, expressed in millimoles)\n12 a2 = 3 /(6.02 · 1020) (in each reaction event, 3 items of A are produced, expressed in millimoles)\n13 b1 = 2 · 1/(6.02 · 1023) · mB (in each reaction event, 2 items of B are consumed, expressed in grams)\n14 c1 = 1 (in each reaction event, 1 item of C is produced, expressed as item counts)\n15 c2 = 1 (in each reaction event, 1 item of C is consumed, expressed as item counts)\nand k1\n′ = k1 · 6.02 · 1020 ·\n(6.02 · 1023\nmB\n)2\n.16\nAnd ﬁnally, what happens if the deﬁnition of the SBML built-in unit “ substance” is changed in the model17\nto be “ gram”? Then the stoichiometries must be changed again, to the following:18\n19 a1 = 1000 · mA (in each reaction event, 1 gram of A is consumed, expressed in millimoles)\n20 a2 = 3000 · mA (in each reaction event, 3 grams of A are produced, expressed in millimoles)\n21 b1 = 2 (in each reaction event, 2 grams of B are consumed, expressed in grams)\n22 c1 = 6 .02 · 1023 · mC (in each reaction event, 1 gram of C is produced, expressed as item counts)\n23 c2 = 6 .02 · 1023 · mC (in each reaction event, 1 gram of C is consumed, expressed as item counts)\nand k1\n′ = k1·10−3·mA, where mA, mB, and mC are the molecular masses of species A, B, and C, respectively.24\nIn all of these cases, one straightforward approach to computing the value of k1\n′ is to use an InitialAssignment25\nconstruct for setting the value of k1\n′ to the result of a formula such as one of those given in the examples26\nabove. And ﬁnally, note that if the species units were the same throughout (and in most models they are),27\nthe unit conversion aspects of the SBML stoichiometries would become unity, leaving only the expected28\nbiochemical stoichiometry values. Isn’t that nice?29\n4.13.7 Use of reaction identiﬁers in mathematical expressions30\nThe value of the id attribute of a Reaction can be used as the content of a ci element in MathML formulas31\nelsewhere in the model. Such a ci element or symbol represents the rate of the given reaction as given by32\nthe reaction’s KineticLaw object. The symbol has the units of substance/time.33\nA KineticLaw object in eﬀect forms an assignment statement assigning the evaluated value of the math34\nelement to the symbol value contained in the Reaction id attribute. No other object can assign a value35\nto such a reaction symbol; i.e., the variable attributes of InitialAssignment, RateRule, AssignmentRule and36\nEventAssignment objects cannot contain the value of a Reaction id attribute.37\nThe combined set of InitialAssignment, AssignmentRule and KineticLaw objects form a set of assignment38\nstatements that should be considered as a whole. The combined set of assignment rules should not contain39\nalgebraic loops: a chain of dependency between these statements should terminate. (More formally, consider40\nthe directed graph of assignment statements where nodes are statements and directed arcs exist for each41\noccurrence of a symbol in a assignment statement math element. The directed arcs start from the statement42\ndeﬁning the symbol to the statements that contain the symbol in their math elements. Such a graph must43\nbe acyclic.) Examples of valid and invalid set of assignment statements are given in Section 4.11.5.44\n76\nNature Precedings : hdl:10101/npre.2007.58.1 : Posted 18 Jun 2007\n4.14 Events1\nModel has an optional list of Event objects that describe the time and form of explicit instantaneous discon-2\ntinuous state changes in the model. For example, an event may describe that one species quantity is halved3\nwhen another species quantity exceeds a given threshold value.4\nAn Event object deﬁnes when the event can occur, the variables that are aﬀected by the event, and how the5\nvariables are aﬀected. The eﬀect of the event can optionally be delayed after the occurrence of the condition6\nwhich invokes it. The operation of an event is divided into two phases (even when the event is not delayed):7\none when the event is ﬁred and the other when the event is executed. The Event type is deﬁned in Figure 22.8\nThe object classes Event, Trigger, Delay and EventAssignment are derived from Sbase (see Section 3.2). An9\nexample of a model which uses events is given below.10\nTrigger\nMath\nxmlns: string  { \"http://www.w3.org/1998/Math/MathML\" }\n{ MathML content evaluating to a nonnegative number. }\nEventAssignment\nvariable: SId\nmath\neventAssignment\n1..*\nmath\nMath\nxmlns: string  { \"http://www.w3.org/1998/Math/MathML\" }\n{ MathML content evaluating to a boolean value. }\nmath\nSBase\ntrigger\nlistOfEventAssignments\ndelay 0..1\n{ Order is significant. }\nEvent\nid: SId  { use=\"optional\" }\nname: string  { use=\"optional\" }\nListOfEventAssignments\nMath\nxmlns: string  { \"http://www.w3.org/1998/Math/MathML\" }\n{ MathML content. }\nDelay\nFigure 22: The deﬁnitions of Event, Trigger, Delay and EventAssignment, and the container class ListOfEventAs-\nsignment.\n77\nNature Precedings : hdl:10101/npre.2007.58.1 : Posted 18 Jun 2007\n4.14.1 Event1\nAn Event deﬁnition has three required parts: an identiﬁer, a trigger condition and at least one EventAssign-2\nment. In addition, an event can include an optional delay. These features of Event are described below.3\nPrevious deﬁnitions of Event in SBML Level 2 included an additional attribute called timeUnits, which4\nallowed the time units of the Delay to be set explicitly. SBML Level 2 Version 3 removes this attribute for5\nseveral reasons. First, the ability to change the time units of the delay time of an Event to be diﬀerent6\nfrom the units of time for the whole model meant that computing an Event’s time of triggering and its delay7\nmight have to be done using two diﬀerent sets of units—a potential source of overlooked errors. Second, the8\nability to redeﬁne the units of time for the delay of an Event became inconsistent with the lack of such an9\nattribute on other SBML Level 2 Version 3 components involving an element of time, such as RateRule and10\nKineticLaw. On balance, the timeUnits feature was judged to add needless complexity and inconsistency for11\nlittle gain in functionality.12\nThe id and name attributes13\nAs with most components in SBML, an Event has id and name attributes, but in the case of Event, both are14\noptional. These attributes operate in the manner described in Section 3.3.15\nThe optional sboTerm attribute on Event16\nAs with all SBML components derived from Sbase, an Event has an optional attribute sboTerm of type17\nSBOTerm (see Sections 3.1.9 and 5). When a value is given to this attribute, it must be a valid term derived18\nfrom SBO:0000231, “event” in SBO. The Event should have an “is a” relationship with the SBO term, and19\nthe term should be the most precise (narrow) term that captures the meaning of the event in the model.20\nAs discussed in Section 5, SBO labels are optional information on a model. Applications are free to ignore21\nsboTerm values. A model must be interpretable without the beneﬁt of SBO labels.22\n4.14.2 Trigger23\nAs shown in Figure 22, the trigger element of an Event must contain exactly one object of class Trigger.24\nThis object contains one math element containing a MathML expression. The expression must evaluate to25\na value of type boolean. The exact moment at which the expression evaluates to “ true” is the time point26\nwhen the Event is ﬁred.27\nAn event only ﬁres when its Trigger expression makes the transition in value from “ false” to “ true”. The28\nevent will also ﬁre at any future time points when the trigger make this transition; in other words, an29\nevent can ﬁre multiple times during a simulation if its trigger condition makes the transition from “ false”30\nto “ true” more than once.31\nAn important question is whether an event can ﬁre prior to, or at, initial simulation time, i.e., t ≤ 0. The32\nanswer is no: an event can only be triggered immediately after initial simulation time i.e., t > 0.33\nThe optional sboTerm attribute on Trigger34\nAs with all SBML components derived from Sbase, Trigger inherits the optional attribute sboTerm of type35\nSBOTerm (see Sections 3.1.9 and 5). When a value is given to this attribute, it must be a valid term rep-36\nresenting a mathematical expression (i.e., a term chosen from the SBO:0000064, “mathematical expression”37\nhierarchy). The formula in the Trigger’s math expression should have an “is a” relationship with the SBO38\nterm, and the term should capture most precise (narrow) meaning of the mathematical formula of the trigger.39\n4.14.3 Delay40\nAs shown in Figure 22, an Event object can contain an optional delay element of class Delay. The Delay is41\nderived from Sbase and contains a mathematical formula stored in math. The formula is used to compute the42\nlength of time between when the event has ﬁred and when the event’s assignments (see below) are actually43\nexecuted. If no delay is present on a given Event, a time delay of zero is assumed.44\n78\nNature Precedings : hdl:10101/npre.2007.58.1 : Posted 18 Jun 2007\nThe expression in math must be evaluated at the time the rule is ﬁred. The expression must always evaluate1\nto a nonnegative number (otherwise, a nonsensical situation could arise where an event is deﬁned to ﬁre2\nbefore it is triggered!).3\nUnits of delay expressions4\nThe units of the numerical value computed by a Delay instance’s math expression must match the model’s5\nunits of time (meaning the deﬁnition of the “ time” units in the model; see Section 4.4.3). Note that, as6\nin other cases of MathML expressions in SBML, units are not predeﬁned or assumed. As discussed in7\nSection 3.4.10, literal numbers (i.e., numbers enclosed in MathML cn elements) or expressions containing8\nonly literal numbers and/or Parameter objects without declared units, are considered to have unspeciﬁed9\nunits. In such cases, the correspondence between the needed units and the (unknown) units of the Delay10\nmath expression cannot be proven, and while such expressions are not considered inconsistent, all that can11\nbe assumed by model interpreters (whether software or human) is that the units may be consistent.12\nThe following Event example fragment helps illustrate this:13\n<model>14\n...15\n<listOfEvents>16\n<event>17\n...18\n<delay>19\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\">20\n<cn> 10 </cn>21\n</math>22\n</delay>23\n...24\n</event>25\n</listOfEvents>26\n...27\n</model>28\nNote the “ <cn> 10 </cn>” within the mathematical formula has no speciﬁed units. The model is not invalid29\nbecause of this, but a recipient of the model may justiﬁably be concerned about what “ 10” really means. (Ten30\nseconds? What if the global units of time on the model were changed from seconds to milliseconds? Would31\nthe modeler remember to change “ 10” to “ 10 000”?) As discussed elsewhere, leaving units unspeciﬁed may32\nprevent software tools from performing complete validation and other useful operations such as global unit33\nconversions. A better approach is to avoid literal numbers and instead use an approach such as deﬁning a34\nparameter with declared units, as in the following modiﬁed version of the example fragment:35\n<model>36\n...37\n<listOfParameters>38\n<parameter id=\"transcriptionDelay\" value=\"10\" units=\"time\"/>39\n</listOfParameters>40\n...41\n<listOfEvents>42\n<event>43\n...44\n<delay>45\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\">46\n<ci> transcriptionDelay </ci>47\n</math>48\n</delay>49\n...50\n</event>51\n</listOfEvents>52\n...53\n</model>54\n79\nNature Precedings : hdl:10101/npre.2007.58.1 : Posted 18 Jun 2007\nThe optional sboTerm attribute on Delay1\nAs with all SBML components derived from Sbase, Delay inherits an optional sboTerm attribute of type2\nSBOTerm (see Sections 3.1.9 and 5). When a value is given to this attribute, it must be a valid term derived3\nfrom the SBO:0000064, “mathematical expression” hierarchy in SBO. The Delay formula should have an “is4\na” relationship with the chosen SBO term, and the term should be the most precise (narrow) term that5\ncaptures the meaning of the delay expression.6\n4.14.4 EventAssignment7\nEvent contains a mandatory element called listOfEventAssignments, of class ListOfEventAssignment. In8\nevery instance of an event deﬁnition in a model, the object’s listOfEventAssignments element must have9\na non-empty list of one or more eventAssignment elements of class EventAssignment. The object class10\nEventAssignment has one required attribute, variable, and a required element, math. Being derived from11\nSbase, it also has all the usual attributes and elements of its parent class.12\nAn “event assignment” has eﬀect when the event is executed; that is, at the end of any given delay period13\n(if given) following the moment that the Event is triggered. See Section 4.14.6 below for more information14\nabout events and event assignments in SBML.15\nThe variable attribute16\nThe variable attribute is of type SId and can contain the identiﬁer of a Compartment, Species or Parameter17\ninstance deﬁned in the model. When the event ﬁres, the value of the model component identiﬁed by variable18\nis changed by the EventAssignment to the value computed by the math element; that is, a species’ quantity,19\ncompartment’s size or parameter’s value are reset to the value computed by math.20\nCertain restrictions are placed on what can appear in variable:21\n• The object identiﬁed by the value of the variable attribute must not have its constant attribute set22\nto or default to “ true”. (Constants cannot be aﬀected by events.)23\n• The variable attribute must not contain the identiﬁer of a reaction; only species, compartment and24\nparameter values may be set by an Event.25\n• The value of every variable attribute must be unique among the set of EventAssignment objects26\nwithin a given Event instance. In other words, a single event cannot have multiple EventAssignments27\nassigning the same variable. (All of them would be performed at the same time, when that particular28\nEvent triggers, resulting in indeterminacy.) Separate Event instances can refer to the same variable.29\n• A variable cannot be assigned a value in an EventAssignment object instance and also be assigned a30\nvalue by an AssignmentRule, i.e., the value of the variable attribute in an EventAssignment instance31\ncannot be the same as the value of a variable attribute in a AssignmentRule instance. (Assignment32\nrules hold at all times, therefore it would be inconsistent to also deﬁne an event that reassigns the33\nvalue of the same variable.)34\nThe optional sboTerm attribute on EventAssignment35\nEventAssignment has an optional sboTerm attribute of type SBOTerm (see Sections 3.1.9 and 5). When a36\nvalue is given to this attribute, it must be a valid SBO term identiﬁer referring to a mathematical expression37\n(i.e., terms derived from SBO:0000064, “mathematical expression”). The EventAssignment should have an38\n“is a” relationship with the SBO term, and the term should be the most precise (narrow) term that captures39\nthe form of the assignment formula in the model.40\nEventAssignment’smath41\nThe math element contains a MathML expression that deﬁnes the new value of the variable. This expression42\nis evaluated when the Event is ﬁred but the variable only acquires the result or new value when the Event43\nis executed. The order of the EventAssignment objects is not signiﬁcant; the eﬀect of one assignment cannot44\n80\nNature Precedings : hdl:10101/npre.2007.58.1 : Posted 18 Jun 2007\naﬀect the result of another assignment. The identiﬁers occurring in the MathML ci attributes of the1\nEventAssignment object represent the value of the identiﬁer at the point when the Event is ﬁred.2\nUnits of the math formula in EventAssignment3\nIn all cases, as would be expected, the units of the formula contained in the math element of EventAssignment4\nmust be consistent with the units of the object identiﬁed by the variable attribute. More precisely:5\n• In the case of a species , an EventAssignment sets the referenced species’ quantity ( concentration or6\namount of substance ) to the value determined by the formula in math. The units of the math formula7\nmust be identical to the units of the species as deﬁned in Section 4.8.5.8\n• In the case of a compartment , an EventAssignment sets the referenced compartment’s size to the size9\ndetermined by the formula in math. The overall units of the formula must be identical to the units10\nspeciﬁed for the size of the compartment identiﬁed by the value of the EventAssignment’s variable11\nattribute. (See Section 4.7.5 for an explanation of how the units of the compartment’s size are deter-12\nmined.)13\n• In the case of a parameter , an EventAssignment sets the referenced parameter’s value to that determined14\nby the formula in math. The overall units of the formula must be identical to the units deﬁned for the15\nparameter identiﬁed by the value of the EventAssignment’s variable attribute. (See Section 4.9.3 for16\nan explanation of how the units of the parameter are determined.)17\nNote that the formula placed in the math element has no assumed units. The consistency of the units of the18\nformula, and the units of the entity which the assignment aﬀects, must be explicitly established just as in19\nthe case of the value of delay. An approach similar to the one discussed in Section 4.14.3 may be used.20\n4.14.5 Example Event deﬁnitions21\nA example of an Event object follows. This structure makes the assignment k2 = 0 at the point when22\nP1 ≤ P2:23\n<event>24\n...25\n<listOfUnitDefinitions>26\n<unitDefinition id=\"per_second\">27\n<listOfUnits>28\n<unit kind=\"second\" exponent=\"-1\" multiplier=\"1\" offset=\"0\"/>29\n</listOfUnits>30\n</unitDefinition>31\n</listOfUnitDefinitions>32\n...33\n<listOfParameters>34\n...35\n<parameter id=\"k2\" value=\"0.05\" units=\"per_second\"/>36\n<parameter id=\"k2reset\" value=\"0.0\" units=\"per_second\"/>37\n...38\n</listOfParameters>39\n...40\n<listOfEvents>41\n<event>42\n<trigger>43\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\">44\n<apply>45\n<leq/>46\n<ci> P_1 </ci>47\n<ci> P_2 </ci>48\n</apply>49\n</math>50\n</trigger>51\n<listOfEventAssignments>52\n<eventAssignment variable=\"k2\">53\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\">54\n81\nNature Precedings : hdl:10101/npre.2007.58.1 : Posted 18 Jun 2007\n<ci> k2reset </ci>1\n</math>2\n</eventAssignment>3\n<listOfEventAssignments>4\n</event>5\n</listOfEvents>6\n...7\n</model>8\nA complete example of a model using events is given in Section 7.10.9\n4.14.6 Detailed semantics of events10\nThe description of events above describes the action of events in isolation from each other. This section11\ndescribes how events interact.12\nEvents whose trigger expression is true at the start of a simulation do not ﬁre at the start of the simulation13\n(t = 0). Events ﬁre only when the trigger becomes true, i.e., the trigger expression transitions from false to14\ntrue, which cannot happen at t = 0 but can happen at t > 0.15\nAny transition of a trigger expression from “ false” to “ true” will cause an event to ﬁre. Consider an16\nevent E with delay d where the trigger expression makes a transition from false to true at times t1 and t2.17\nThe EventAssignment object will have eﬀect at t1 + d and t2 + d irrespective of the relative times of t1 and18\nt2. For example events can “overlap” so that t1 < t 2 < t 1 + d still causes an event assignments to occur at19\nt1 + d and t2 + d.20\nIt is possible for events to ﬁre other events, i.e., an event assignment can cause an event to ﬁre, therefore it21\nis possible for a model to be entirely encoded in Event objects.22\nIt is entirely possible for two events to be executed simultaneously in simulated time. It is assumed that,23\nalthough the precise time at which these events are executed is not resolved beyond the given point in24\nsimulated time, the order in which the events occur is resolved. This order can be signiﬁcant in determining25\nthe overall outcome of a given simulation. SBML Level 2 does not deﬁne the algorithm for determining26\nthis order (the tie-breaking algorithm). As a result, the outcomes of simulations involving events may vary27\nwhen simultaneous events occur during simulation. It is anticipated that future versions or levels of SBML28\nwill deﬁne a speciﬁc set of tie-breaking algorithms and a mechanism for models to indicate which algorithm29\nshould be applied during simulation.30\nDespite the absence of a speciﬁc tie-breaking algorithm, SBML event simulation is constrained as follows.31\nWhen an event X ﬁres another event Y and event Y has zero delay then event Y is added to the existing32\nset of simultaneous events that are pending execution. Events such as Y do not have a special priority or33\nordering within the tie-breaking algorithm. Events X and Y form a cascade of events at the same point in34\nsimulation time. All events in a model are open to being in a cascade. The position of an event in the event35\nlist does not aﬀect whether it can be in the cascade: Y can be triggered whether it is before or after X in the36\nlist of events. A cascade of events can be inﬁnite (never terminate). When this occurs a simulator should37\nindicate this has occurred; i.e., it is incorrect for the simulator to arbitrarily break the cascade and continue38\nthe simulation without at least indicating the inﬁnite cascade occurred. A variable can change more than39\nonce when processing simultaneous events at simulation time t. The model behavior (output) for such a40\nvariable is the value of the variable at the end of processing all the simultaneous events at time t.41\n82\nNature Precedings : hdl:10101/npre.2007.58.1 : Posted 18 Jun 2007\n5 The Systems Biology Ontology and the sboTerm attribute1\nThe values of id attributes on SBML components allow the components to be cross-referenced within a model.2\nThe values of name attributes on SBML components provide the opportunity to assign them meaningful labels3\nsuitable for display to humans (Section 3.3). The speciﬁc identiﬁers and labels used in a model necessarily4\nmust be unrestricted by SBML, so that software and users are free to pick whatever they need. However,5\nthis freedom makes it more diﬃcult for software tools to determine, without additional human intervention,6\nthe semantics of models more precisely than the semantics provided by the SBML object classes deﬁned in7\nother sections of this document. For example, there is nothing inherent in a parameter with identiﬁer “ k”8\nthat would indicate to a software tool it is a ﬁrst-order rate constant (if that’s what “ k” happened to be9\nin some given model). However, one may need to convert a model between diﬀerent representations (e.g.,10\nHenri-Michaelis-Menten vs. elementary steps), or to use it with diﬀerent modelling approaches (discrete11\nor continuous). One may also need to relate the model components with other description formats, using12\na deeper semantics. Although an advanced software tool might be able to deduce the semantics of some13\nmodel components through detailed analysis of the kinetic rate expressions and other parts of the model,14\nthis quickly becomes infeasible for any but the simplest of models.15\nAn approach to solving this problem is to associate model components with terms from carefully curated16\ncontrolled vocabularies (CVs). This is the purpose of the optional sboTerm attribute provided on the SBML17\nclass Sbase. The sboTerm attribute always refers to terms belonging to the Systems Biology Ontology (SBO,18\nhttp://biomodels.net/SBO/). In this section, we discuss the sboTerm attribute, SBO, the motivations and19\ntheory behind their introduction, and guidelines for their use.20\nSBO is not part of SBML; it is being developed separately, to allow the modeling community to evolve21\nthe ontology independently of SBML. However, the terms in the ontology are being designed with SBML22\ncomponents in mind, and are classiﬁed into subsets that can be directly related with SBML components such23\nas reaction rate expressions, parameters, and a few others. The use of sboTerm attributes is optional, and24\nthe presence of sboTerm on an element does not change the way the model is interpreted. Annotating SBML25\nelements with SBO terms adds additional semantic information that may be used to convert the model into26\nanother model, or another format. Athough SBO support provides an important source of information to27\nunderstand the meaning of a model, software does not need to support sboTerm to be considered SBML-28\ncompliant.29\n5.1 Principles30\nLabeling model components with terms from shared controlled vocabularies allows a software tool to identify31\neach component using identiﬁers that are not tool-speciﬁc. An example of where this is useful is the desire32\nby many software developers to provide users with meaningful names for reaction rate equations. Software33\ntools with editing interfaces frequently provide these names in menus or lists of choices for users. However,34\nwithout a standardized set of names or identiﬁers shared between developers, a given software package cannot35\nreliably interpret the names or identiﬁers of reactions used in models written by other tools.36\nThe ﬁrst solution that might come to mind is to stipulate that certain common reactions always have the37\nsame name (e.g., “Michaelis-Menten”), but this is simply impossible to do: not only do humans often disagree38\non the names themselves, but it would not allow for correction of errors or updates to the list of predeﬁned39\nnames except by issuing new releases of the SBML speciﬁcation—to say nothing of many other limitations40\nwith this approach. Moreover, the parameters and variables that appear in rate expressions also need to be41\nidentiﬁed in a way that software tools can interpret mechanically, implying that the names of these entities42\nwould also need to be regulated.43\nThe Systems Biology Ontology (SBO) provides vocabularies for identifying common reaction rate expressions,44\ncommon participant types and roles in reactions, common parameter types and their roles in rate expres-45\nsions, common modeling frameworks (e.g., “continuous”, “discrete”, etc.), and common types of species and46\nreactions. The relationship implied by an sboTerm value on an SBML model component is “is a”: the thing47\ndeﬁned by that SBML component “is an” instance of the thing deﬁned in SBO by the term having the48\nidentiﬁer given by the sboTerm attribute value. By adding SBO term references on the components of a49\n83\nNature Precedings : hdl:10101/npre.2007.58.1 : Posted 18 Jun 2007\nmodel, a software tool can provide additional details using independent, shared vocabularies that can enable1\nother software tools to recognize precisely what the component is meant to be. Those tools can then act on2\nthat information. For example, if the SBO identiﬁer SBO:0000049 is assigned to the concept of “ﬁrst-order3\nirreversible mass-action kinetics, continuous framework”, and a given KineticLaw object in a model has an4\nsboTerm attribute with this value, then regardless of the identiﬁer and name given to the reaction itself, a5\nsoftware tool could use this to inform users that the reaction is a ﬁrst-order irreversible mass-action reaction.6\nThis kind of reverse engineering of the meaning of reactions in a model would be diﬃcult to do otherwise,7\nespecially for more complex reaction types.8\nThe presence of an SBO label on a compartment, species, or reaction, can help map SBML elements to equiv-9\nalents in other standards, such as (but not limited to) BioPAX ( http://www.biopax.org/) or the Systems10\nBiology Graphical Notation (SBGN, http://www.sbgn.org/). Such mappings can be used in conversion11\nprocedures, or to build interfaces, with SBO becoming a kind of “glue” between standards of representation.12\nThe presence of the label on a kinetic expression can also allow software tools to make more intelligent13\ndecisions about reaction rate expressions. For example, an application could recognize certain types of14\nreaction formulas as being ones it knows how to solve with optimized procedures. The application could15\nthen use internal, optimized code implementing the rate formula indexed by identiﬁers such as SBO:000004916\nappearing in SBML models.17\nAlthough the use of SBO can be beneﬁcial, it is critical to keep in mind that the presence of an sboTerm18\nvalue on an object must not change the fundamental mathematical meaning of the model. An SBML model19\nmust be deﬁned such that it stands on its own and does not depend on additional information added by20\nSBO terms for a correct mathematical interpretation. SBO term deﬁnitions will not imply any alternative21\nmathematical semantics for any SBML object labeled with that term. Two important reasons motivate this22\nprinciple. First, it would be too limiting to require all software tools to be able to understand the SBO23\nvocabularies in addition to understanding SBML Level 2 Version 3 . Supporting SBO is not only additional24\nwork for the software developer; for some kinds of applications, it may not make sense. If SBO terms on25\na model are optional, it follows that the SBML model must remain unambiguous and fully interpretable26\nwithout them, because an application reading the model may ignore the terms. Second, we believe allowing27\nthe use of sboTerm to alter the mathematical meaning of a model would allow too much leeway to shoehorn28\ninconsistent concepts into SBML objects, ultimately reducing the interoperability of the models.29\n5.2 Using SBO and sboTerm30\nThe sboTerm attribute data type is always SBOTerm, deﬁned in Section 3.1.9. When present in a given model31\nobject instance, the attribute’s value must be an identiﬁer taken from the Systems Biology Ontology (SBO;32\nhttp://biomodels.net/SBO/). This identiﬁer must refer to a single SBO term that best deﬁnes the entity33\nencoded by the SBML object in question. An example of the type of relationship intended is: the KineticLaw34\nin reaction R1 is a ﬁrst-order irreversible mass action rate law .35\nNote the careful use of the words “deﬁnes” and “entity encoded by the SBML object” in the paragraph36\nabove. As mentioned, the relationship between the SBML object and the URI is:37\nThe “thing” encoded by this SBML object is an instance of the “thing” represented by the38\nreferenced SBO term.39\n5.2.1 The structure of the Systems Biology Ontology40\nThe goal of SBO labeling for SBML is to clarify to the fullest extent possible the nature of each element in41\na model . The approach taken in SBO begins with a hierarchically-structured set of controlled vocabularies42\nwith ﬁve main divisions: (1) modeling framework, (2) participant type, (3) quantitative parameter, (4)43\nmathematical expression, and (5) event . Figure 23 on the following page illustrates the highest level of SBO.44\nEach of the ﬁve branches of Figure 23 have a hierarchy of terms underneath them. At this time, we45\ncan only begin to list some initial concepts and terms in SBO; what follows is not meant to be com-46\nplete, comprehensive or even necessarily consistent with future versions of SBO. The web site for SBO47\n84\nNature Precedings : hdl:10101/npre.2007.58.1 : Posted 18 Jun 2007\n(http://biomodels.net/SBO/) should be consulted for the current version of the ontology. Section 5.4.11\ndescribes how the impact of SBO changes on software applications is minimized.2\nSBO\nparticipant type quantitative parameter modeling framework mathematical expressionevent\nFigure 23: The ﬁve controlled vocabularies (CVs) that make up the main branches of SBO. (Other CVs in SBO may evolve\nin time, but are not discussed here.)\nFigure 24 shows the structure for the participant type CV which reﬂects the hierarchical conceptual groupings3\nof the concepts. For example, in reaction rate expressions, there are a variety of possible modiﬁers. Some4\nclasses of modiﬁers can be further subdivided and grouped. All of this is easy to capture in the CV. As5\nmore agreement is reached in the modeling community about how to deﬁne and name modiﬁers for diﬀerent6\ncases, the CV can grow to accommodate it.7\nFigure 24: Partial expansion of some of the terms in the participant type CV of SBO.\nSimilar to the above, the controlled vocabulary for quantitative parameters also has a hierarchical structure,8\nas illustrated in Figure 25. Note the separation of kinetic constant into separate terms for unimolecular,9\nbimolecular, etc. reactions, as well as for forward and reverse reactions. The need to have separate terms for10\nforward and reverse rate constants arises in reversible mass-action reactions. This distinction is not always11\nnecessary for all quantitative parameters; for example, there is no comparable concept for the Michaelis con-12\nstant. Another distinction for some quantitative parameters is a decomposition into diﬀerent versions based13\non the modeling framework being assumed. For example, diﬀerent terms for continuous and discrete formu-14\nlations of kinetic constants represent specializations of the constants for particular simulation frameworks.15\nNot all quantitative parameters will need to be distinguished along this dimension.16\nquantitative parameter\nkinetic constant\nbiochemical parameter\nphysical parameter\nunimolecular \nrate-constant\n. . .\nthermodynamic\ntemperature\ntemperature\ndifference\nconductance\n. . .\nforward\nunimolecular \nrate-constant\nreverse\nunimolecular \nrate-constant\nbimolecular \nrate-constan\nt\nequilibrium\ncharacteristic\nequilibrium or steady-\nstate constan\nt\nMichaelis constant\n. . .\n. . .\nFigure 25: Partial expansion of some of the terms in the quantitative parameter CV .\n85\nNature Precedings : hdl:10101/npre.2007.58.1 : Posted 18 Jun 2007\nThe terms of the SBO quantitative parameter vocabulary contain mathematical formulas encoded using1\nMathML 2.0 expressing the parameter using other SBO parameters. The main use of that approach is to2\navoid listing all the variants of a mathematical expression, escaping a combinatorial explosion.3\nFigure 26: Partial expansion of some of the terms in the modeling framework CV .\nThe modeling framework controlled vocabulary is needed to support labeling models and reactions with the4\nframework for which they are designed. Figure 26 illustrates the structure of this CV, which is at this point5\nextremely simple, but we expect that more terms will evolve in the future.6\nThe mathematical expression vocabulary encompasses the various mathematical expressions that constitute7\na model. Figure 27 illustrates a portion of the hierarchy. Rate law formulas are part of the mathematical8\nexpression hierarchy, and subdivided by successively more reﬁned distinctions until the leaf terms represent9\nprecise statements of common reaction types. Other types of mathematical expressions are likely to be10\nincluded in the future in order to be able to characterize other mathematical components of a model,11\nnamely initial assignments, assignment rules, rate rules, algebraic rules, constraints, and event triggers and12\nassignments.13\nFigure 27: Partial expansion of some of the terms in the mathematical expression CV .\nThe leaf terms of the rate law portion of the SBO mathematical expression framework contain the mathe-14\nmatical formulas for the rate laws encoded using MathML 2.0. There are many potential uses for this. One is15\nto allow a software application to obtain the formula and insert it into a model. In eﬀect, the formulas given16\nin the CV act as templates for what to put into an SBML KineticLaw deﬁnition. The MathML deﬁnition17\nalso acts as a precise statement about the rate law in question. Some of the non-leaf terms also contain rate18\nlaws encoded using MathML 2.0. However, those are generic rate-laws, containing MathML constructs not19\nyet supported by SBML and need to be expanded into the MathML subset allowed in SBML before they20\ncan be used in conjunction with SBML models.21\nTo make this discussion concrete, here is an example deﬁnition of an entry in the SBO rate law hierarchy22\nat the time of this writing. This term represents second-order, irreversible, mass-action kinetics with one23\nreactant, formulated for use in a continuous modeling framework:24\nID: SBO:000005225\nName: second-order irreversible mass action kinetics, one reactant, continuous scheme.26\n86\nNature Precedings : hdl:10101/npre.2007.58.1 : Posted 18 Jun 2007\nDeﬁnition: Reaction scheme where the products are created from the reactants and the change1\nof a product quantity is proportional to the product of reactant activities. The reaction2\nscheme does not include any reverse process that creates the reactants from the products.3\nThe change of a product quantity is proportional to the square of one reactant quantity. It4\nis to be used in a reaction modelled using a continuous framework.5\nParent(s):6\n• SBO:0000050 second order irreversible mass action kinetics, one reactant (is a).7\n• SBO:0000163 irreversible mass action kinetics, continuous scheme (is a).8\nMathML:9\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\">10\n<semantics definitionURL=\"http://biomodels.net/SBO/#SBO:0000062\">11\n<lambda>12\n<bvar><ci definitionURL=\"http://biomodels.net/SBO/#SBO:0000036\">k</ci></bvar>13\n<bvar><ci definitionURL=\"http://biomodels.net/SBO/#SBO:0000010\">R</ci></bvar>14\n<apply>15\n<times/>16\n<ci>k</ci>17\n<ci>R</ci>18\n<ci>R</ci>19\n</apply>20\n</lambda>21\n</semantics>22\n</math>23\nIn the MathML deﬁnition of the term shown above, the bound variables in the lambda expression are24\ntagged with references to terms in the SBO quantitative parameter (for k) and SBO participant role (for25\nR) vocabularies. This makes it possible for software applications to interpret the intended meanings of the26\nparameters in the expression.27\nThe event branch of SBO deﬁnes types of biological processes. It lists the types of biochemical reactions, such28\nas binding, conformational transition, or cleavage, and also the diﬀerent controls that modify a biochemical29\nreaction, such as inhibition, catalysis, etc.30\nFigure 28: Partial expansion of some of the terms in the event CV .\nOne of the goals of SBO is to permit a tool to traverse up and down the hierarchy in order to ﬁnd equivalent31\nterms in diﬀerent frameworks. The hope is that when a software tool encounters a given rate formula in a32\nmodel, the formula will be a speciﬁc form (say, “mass-action kinetics, second order, one reactant, for discrete33\nsimulation”), but by virtue of the consistent organization of the reaction rate CV into framework-speciﬁc34\ndeﬁnitions, the tool should in principle be able to determine the deﬁnitions for other frameworks (say, “mass-35\naction kinetics, second order, one reactant for continuous simulation”). If the software tool is designed for36\ncontinuous simulation and it encounters an SBML model with rate laws formulated for discrete simulation, it37\ncould in principle look up the rate laws’ identiﬁers in the CV and search for alternative deﬁnitions intended38\nfor discrete simulation. And of course, the converse is true, for when a tool designed for discrete simulation39\nencounters a model with rate laws formulated for continuous simulation.40\n87\nNature Precedings : hdl:10101/npre.2007.58.1 : Posted 18 Jun 2007\n5.2.2 Relationships between individual SBML components and SBO terms1\nThe sboTerm attribute is deﬁned on the abstract class Sbase and can be used in all derived elements. However,2\nnot all SBO terms can be used to annotate all SBML elements. Table 6 summarizes the relationship between3\nSBML components and the branches within SBO that apply to that component. (There are currently no4\nspeciﬁc SBO term that correspond to the Sbml, UnitDeﬁnition, Unit, and various ListOf list classes).5\n6 SBML Component SBO Vocabulary Parent SBO Identiﬁer\n7 Model modeling framework SBO:0000004\n8 FunctionDeﬁnition mathematical expression SBO:0000064\n9 CompartmentType participant physical type SBO:0000236\n10 SpeciesType participant physical type SBO:0000236\n11 Compartment participant physical type SBO:0000236\n12 Species participant physical type SBO:0000236\n13 Reaction event SBO:0000231\n14 Parameter quantitative parameter SBO:0000002\n15 SpeciesReference participant functional type SBO:0000003\n16 ModiﬁerSpeciesReference participant functional type SBO:0000003\n17 KineticLaw rate law SBO:0000001\n18 InitialAssignment mathematical expression SBO:0000064\n19 AlgebraicRule mathematical expression SBO:0000064\n20 AssignmentRule mathematical expression SBO:0000064\n21 RateRule mathematical expression SBO:0000064\n22 Constraint mathematical expression SBO:0000064\n23 Event event SBO:0000231\n24 Trigger mathematical expression SBO:0000064\n25 Delay mathematical expression SBO:0000064\n26 EventAssignment mathematical expression SBO:0000064\nTable 6: SBML components and the main types of SBO terms that may be assigned to them. The parent identiﬁers are\nprovided for guidance, but actual annotations should use more speciﬁc child terms. See text for explanation.\nThe parent identiﬁers shown in Table 6 are provided for reference. They are the highest-level terms in their27\nrespective vocabularies; however, these are not the terms that would be used to annotate an element in28\nSBML, because there are more speciﬁc terms underneath the parents shown here. A software tool should29\nuse the most speciﬁc SBO term available for a given concept rather than using the top-level identiﬁer acting30\nas the root of that particular vocabulary.31\n5.2.3 Tradeoffs in using SBO terms32\nThe SBO-based approach to annotating SBML components with controlled terms has the following strengths:33\n1. The syntax is minimally intrusive and maximally simple, requiring only one string-valued attribute.34\n2. It supports a signiﬁcant fraction of what SBML users have wanted to do with controlled vocabularies.35\n3. It does not interfere with any other scheme. The more general annotation-based approach described36\nin Section 6 can still be used simultaneously in the same model.37\nThe scheme has the following weaknesses:38\n1. An object can only have one sboTerm attribute, therefore, it can only be related to a single term in39\nSBO. (This also impacts the design of SBO: it must be structured such that a class of SBML elements40\ncan logically only be associated with one class of terms in the ontology.)41\n2. The only relationship that can be expressed by sboTerm is “is a”. It is not possible to represent diﬀerent42\nrelationships (known as verbs in ontology-speak). This limits what can be expressed using SBO.43\n88\nNature Precedings : hdl:10101/npre.2007.58.1 : Posted 18 Jun 2007\nThe weaknesses are not shared by the annotation scheme described in Section 6. If application’s needs1\ncannot be met using SBO terms, software developers should examine the approach described in Section 6.2\n5.3 Relationships to the SBML annotation element3\nAnother means of providing this kind of information would be to place SBO terms inside the annotation4\nelement deﬁned on Sbase (Sections 3.2 and 6). However, in the interest of making the use of SBO in SBML5\nmaximally interoperable between software tools, the best-practice recommendation is to place SBO references6\nin the sboTerm attribute rather than inside the annotation element of an object.7\nAlthough sboTerm is just another kind of optional annotation in SBML, the SBO references are separated out8\ninto their own attribute on SBML components, both to simplify their use for software tools and because they9\nassert a slightly stronger and more focused connection in a more regimented fashion. SBO term references10\nare intended to allow a modeler to make a statement of the form “this object is identical in meaning and11\nintention to the object deﬁned in the term X of SBO”, and do so in a way that a software tool can interpret12\nunambiguously.13\nSome software applications may have their own vocabulary of terms similar in purpose to SBO. For maximal14\nsoftware interoperability, the best-practice recommendation in SBML is nonetheless to use SBO terms in15\npreference to using application-speciﬁc annotation schemes. Software applications should therefore attempt16\nto translate their private terms to and from SBO terms when writing and reading SBML, respectively.17\n5.4 Discussion18\nHere we discuss some additional points about the SBO-based approach.19\n5.4.1 Frequency of change in the ontology20\nThe SBO development approach follows conventional ontology development approaches in bioinformatics.21\nOne of the principles being followed is that identiﬁers and meanings of terms in the CVs never change22\nand the terms are never deleted. Where some terms are deemed obsolete, the introduction of new terms23\nreﬁne or supersede existing terms, but the existing identiﬁers are left in the CV. Thus, references never24\nend up pointing to nonexistent entries. In the case where synonymous terms are merged after agreement25\nthat multiple terms are identical, the term identiﬁers are again left in the CV and they still refer to the26\nsame concept as before. Out-of-date terms cached or hard-coded by an application remain usable in all27\ncases. (Moreover, machine-readable CV encodings and appropriate software design should render possible28\nthe development of API libraries that automatically map older terms to newer terms as the CVs evolve.)29\nTherefore, a model is never in danger of ending up with SBO identiﬁers that cannot be dereferenced. If an30\napplication ﬁnds an old model with a term SBO:0000065, it can be assured that it will be able to ﬁnd this31\nterm in SBO, even if it has been superseded by other, more preferred terms.32\n5.4.2 Consistency of information33\nIf you have a means of linking (say) a reaction rate formula to a term in a CV, it is possible to have an34\ninconsistency between the formula in the SBML model and the one deﬁned for the CV term. However, this35\nis not a new problem; it arises in other situations involving SBML models already. The guideline for these36\nsituations is that the model must be self-contained and stand on its own. Therefore, in cases where they37\ndiﬀer, the deﬁnitions in the SBML model take precedence over the deﬁnitions referenced by the CV. In other38\nwords, the model (and its MathML) is authoritative.39\n5.4.3 Implications for network access40\nA software tool does not need to have the ability to access the network or read the CV every time it encounters41\na model or otherwise works with SBML. Since the SBO will likely stabilize and change infrequently once42\na core set of terms is deﬁned, applications can cache the controlled vocabulary, and not make network43\naccesses to the master SBO copy unless something forces them to (e.g., detecting a reference in a model44\n89\nNature Precedings : hdl:10101/npre.2007.58.1 : Posted 18 Jun 2007\nto an SBO term that the application does not recognize). Applications could have user preference settings1\nindicating how often the CV deﬁnitions should be refreshed (similar to how modern applications provide a2\nsetting dictating how often they should check for new versions of themselves). Simple applications may go3\nfurther and hard code references to terms in SBO that have reached stability and community consensus.4\nSBO is available for download under diﬀerent formats ( http://biomodels.net/SBO/). Web services are also5\navailable to provide programmatic access to the ontology.6\n5.4.4 Implications for software tools7\nIf a software tool does not pay attention to the SBO annotations described here, one is faced with exactly the8\nsituation that exists today: the SBML model must be interpreted as-is, without beneﬁt of the information9\nadded by the SBO terms. The purpose of introducing an ontology scheme and guidelines for its use is to give10\ntools enough information that they could perform added processing, if they were designed to take advantage11\nof that information.12\n90\nNature Precedings : hdl:10101/npre.2007.58.1 : Posted 18 Jun 2007\n6 A standard format for the annotation element1\nThis section describes the recommended non-proprietary format for the content of annotation elements in2\nSBML when (a) referring to controlled vocabulary terms and database identiﬁers which deﬁne and describe3\nbiological and biochemical entities, and (b) describing the creator of a model and its modiﬁcation history.4\nSuch a structured format should facilitate the generation of models compliant with the MIRIAM guidelines5\nfor model curation ( Le Nov` ere et al., 2005).6\nThis format should not be used to refer to SBO terms (Section 5), because SBO deﬁnes terms about7\nmathematical modeling constructs and not the biological and biochemical entities that the mathematics8\nrepresent.9\nThe format described in this section is intended to be the form of one of the top-level elements that could10\nreside in an annotation element attached to an SBML object derived from Sbase. The element is named11\nrdf:RDF. The format described here is compliant with the constraints placed on the form of annotation12\nelements described in Section 3.2.4. We refer readers to Section 3.2.4 for important information on the13\nstructure and organization of application-speciﬁc annotations; these are not described here.14\n6.1 Motivation15\nThe SBML structures described elsewhere in this document do not have any biochemical or biological se-16\nmantics. The format described in this section provides a scheme for linking SBML structures to external17\nresources so that those structures can have such semantics. The motivation for the introduction of this18\nscheme is similar to that given for the introduction of sboTerm; however, this scheme is signiﬁcantly more19\nﬂexible.20\n6.2 XML namespaces in the standard annotation21\nThis format uses a restricted form of Dublin Core ( Dublin Core Metadata Initiative , 2005) and BioModels22\nqualiﬁer elements (see http://www.biomodels.net/index.php?s=Qualifiers) embedded in RDF ( W3C,23\n2004b). It uses a number of external XML standards and associated XML namespaces. Table 7 lists these24\nnamespaces and relevant documentation on those namespaces. The format constrains the order of elements25\nin these namespaces beyond the constraints deﬁned in the standard deﬁnitions for those namespaces. For26\neach standard listed, the format only uses a subset of the possible syntax deﬁned by the given standard. Thus27\nit is possible for an annotation element to include XML that is compliant with those external standards but28\nis not compliant with the format described here. Parsers wishing to support this format should be aware29\nthat a valid annotation element may contain an rdf:RDF element which is not compliant with the format30\ndescribed here. A parser should check that all aspects of the syntax deﬁned here before assuming that the31\ncontained data is encoded in the format.32\n33 Namespace URI Deﬁnition Document\n34 dc http://purl.org/dc/elements/1.1/ Powell and Johnston (2003)\n35 rdf http://www.w3.org/1999/02/22-rdf-syntax-ns# W3C (2004a)\n36 dcterms http://purl.org/dc/terms/ Kokkelink and Schw¨ anzl(2002)\n37 DCMI Usage Board (2005)\n38 vcard http://www.w3.org/2001/vcard-rdf/3.0# Iannella (2001)\n39 bqbiol http://biomodels.net/biology-qualifiers/\n40 bqmodel http://biomodels.net/model-qualifiers/\nTable 7: The XML standards used in the SBML standard format for annotation. The namespace preﬁx are shown to\nindicate only the preﬁx used in the main text.\n91\nNature Precedings : hdl:10101/npre.2007.58.1 : Posted 18 Jun 2007\n6.3 General syntax for the standard annotation1\nAn outline of the format syntax is shown below.2\n<SBML_ELEMENT +++ metaid=\"SBML_META_ID\" +++ >3\n+++4\n<annotation>5\n+++6\n<rdf:RDF7\nxmlns:rdf=\"http://www.w3.org/1999/02/22-rdf-syntax-ns#\"8\nxmlns:dc=\"http://purl.org/dc/elements/1.1/\"9\nxmlns:dcterm=\"http://purl.org/dc/terms/\"10\nxmlns:vcard=\"http://www.w3.org/2001/vcard-rdf/3.0#\"11\nxmlns:bqbiol=\"http://biomodels.net/biology-qualifiers/\"12\nxmlns:bqmodel=\"http://biomodels.net/model-qualifiers/\"13\n>14\n<rdf:Description rdf:about=\"#SBML_META_ID\">15\n[MODEL_HISTORY]16\n<RELATION_ELEMENT>17\n<rdf:Bag>18\n<rdf:li rdf:resource=\"URI\" />19\n...20\n</rdf:Bag>21\n</RELATION_ELEMENT>22\n...23\n</rdf:Description>24\n+++25\n</rdf:RDF>26\n+++27\n</annotation>28\n+++29\n</SBML_ELEMENT>30\nThe above outline shows the order of the elements. The capitalized identiﬁers refer to generic strings31\nof a particular type: SBML ELEMENT refers to any SBML element name that can contain an annotation32\nelement; SBML META ID is a XML ID string; RELATION ELEMENT refers to element names in either the namespace33\nhttp://biomodels.net/biology-qualifiers/ or http://biomodels.net/model-qualifiers/; and URI is34\na URI. [MODEL HISTORY] refers to an optional section described in Section 6.6 which can only be present35\nwithin SBML model elements. ‘ +++’ is a placeholder for either no content or valid XML syntax that is not36\ndeﬁned by the standard annotation scheme but is consistent with the relevant standards for the enclosing37\nelements. ‘ ...’ is a placeholder for zero or more elements of the same form as the immediately preceding38\nelement. The precise form of whitespace and the XML namespace preﬁx deﬁnitions is not constrained;39\nhowever, the elements and attributes must be in the namespaces shown. The rest of this section describes40\nthe format formally in English.41\nIn this format, the annotation of an element is located in a single rdf:RDF element contained within an42\nSBML annotation element. The annotation element can contain other elements in any order as described43\nin Section 3.2.4. The format described in this section only deﬁnes the form of the rdf:RDF element. The44\ncontaining SBML Sbase element must have a metaid attribute value. (As this attribute is of the type ID its45\nvalue must unique to the entire SBML document.)46\nThe ﬁrst element of the rdf:RDF element must be an rdf:Description element with an rdf:about attribute.47\n(This format doesn’t deﬁne the form of subsequent elements of the rdf:RDF element.) The value of the48\nrdf:about attribute must be of the form #<string> where the string component is equal to the value of the49\nmetaid attribute of the containing SBML element.50\nThe rdf:Description element can contain only an optional model history section (see Section 6.6) followed51\nby a sequence of zero or more BioModels relation elements. The optional model history section can only be52\npresent within an SBML Model element. The speciﬁc type of the relation elements will vary depending on53\nthe relationship between the SBML component and referenced information or resource.54\nAlthough Section 6.5 describes the detailed semantics of each of the relation element types, the content of55\nthese elements follows the same form. The BioModels qualiﬁers relation elements must only contain a single56\n92\nNature Precedings : hdl:10101/npre.2007.58.1 : Posted 18 Jun 2007\nrdf:Bag element which in turn must only contain one or more rdf:li elements. The rdf:li elements must1\nonly have a rdf:resource attribute containing a URI referring to an information resource (See Section 6.4).2\nAnnotations in this format can be located at diﬀerent depths within a model component.3\n6.4 Use of URIs4\nThe format represents a set of relationships between the SBML element and the resources referred to by the5\ncontained rdf:resource attribute values. The BioModels relation elements simply deﬁne the type of the6\nrelationship.7\nFor example, a Species element representing a protein could be annotated with a reference to the database8\nUniProt by the http://www.uniprot.org/#P12999 resource identiﬁer, identifying exactly the protein de-9\nscribed by the Species element. This identiﬁer maps to a unique entry in UniProt which is never deleted10\nfrom the database. In the case of UniProt, this is the “accession” of the entry. When the entry is merged11\nwith another one, both “accession” are conserved. Similarly in a controlled vocabulary resource, each term12\nis associated with a perennial identiﬁer. The UniProt entry also possess an “entry name” (the Swiss-Prot13\n“identiﬁer”), a “protein name”, “synonyms” etc. Only the “accession” is perennial and should be used.14\nThe value of a rdf:resource attribute is a URI that both uniquely identiﬁes the resource, and the data in15\nthe resource. In this case the resource constraining the identiﬁer precedes the ’#’ symbol and the term or16\ndatabase identiﬁer follows the ’#’ symbol. In the above example, the resource http://www.uniprot.org/17\nincludes the entry P12999.18\nThe value of the rdf:resource attribute is a URI, not a URL; as such, a URI does not have to reference a19\nphysical web object but simply identiﬁes a controlled vocabulary term or database object (a URI is a label20\nthat, in this case, just happens to look like a URL). For instance, a true URL for an Internet resource such as21\nhttp://www.uniprot.org/entry/P12999 might correspond to the URI http://www.uniprot.org/#P12999.22\nSBML does not specify how a parser is to interpret a URI. In the case of a transformation into a physical23\nURL, there could be several solutions. For example, the URI http://www.geneontology.org/#GO:000726824\ncan be translated into:25\nhttp://www.ebi.ac.uk/ego/DisplayGoTerm?selected=GO:000726826\nhttp://www.godatabase.org/cgi-bin/amigo/go.cgi?view=details&query=GO:000726827\nhttp://www.informatics.jax.org/searches/GO.cgi?id=GO:000726828\nSimilarly the URI http://www.ec-code.org/#3.5.4.4 can refer to:29\nhttp://www.ebi.ac.uk/intenz/query?cmd=SearchEC&ec=3.5.4.430\nhttp://www.expasy.org/cgi-bin/nicezyme.pl?3.5.4.431\nhttp://www.chem.qmul.ac.uk/iubmb/enzyme/EC3/5/4/4.html32\nhttp://www.genome.jp/dbget-bin/www bget?ec:3.5.4.433\netc.34\nTo enable interoperability, the community has agreed on an initial set of standardized valid URI syntax rules35\nwhich may be used within the standard annotation format. This set of rules is not part of the SBML standard36\nbut will grow independently from speciﬁc SBML Levels and Versions. As the set changes a given URI syntax37\nrule will not be modiﬁed although the physical resource associated with the rule may change. These URIs38\nwill always be composed as resource#id. The MIRIAM resources http://www.ebi.ac.uk/compneur-srv/39\nmiriam-main/ lists URI syntaxes and possible physical links to controlled vocabulary and databases. Each40\nentry contains a list of SBML and relation elements in which the given URI can be appropriately embedded.41\nTo enable consistent and thus useful links to external resources, the URI syntax rule set must have a consistent42\nview of the concepts represented by the diﬀerent SBML elements for the purposes of this format. For example43\nas the rule set is designed to link SBML biological and biochemical resources the rule set assumes that a44\nSpecies element represents the concept of a biochemical entity type rather than mathematical symbol. The45\nURI rule list will evolve with the evolution of databases and resources. The annotation format described in46\nthis section does not require a simple parser of this format to access this list.47\n93\nNature Precedings : hdl:10101/npre.2007.58.1 : Posted 18 Jun 2007\n6.5 Relation elements1\nTo enable the format to encode diﬀerent types of relationships between SBML elements and resources,2\ndiﬀerent BioModel qualiﬁer elements are used to enclose a set of rdf:li elements. The relation elements3\nimply a speciﬁc relationship between the enclosing SBML element and the resources referenced by the rdf:li4\nelements.5\nThe detailed semantics (i.e. from the perspective of automatic parser) of the relation elements is deﬁned6\nby the URI list at http://www.ebi.ac.uk/compneur-srv/miriam-main/, and thus is outside the scope of7\nSBML. The URI list generally assumes that the biological entity represented by the element is the concept8\nlinked to the reference resource.9\nSeveral relation elements with a given tag, enclosed in the same SBML element, each represent an alternative10\nannotation to the SBML element. For example two bqbiol:hasPart elements within a Species SBML11\nelement represent two diﬀerent sets of references to the parts making up the the chemical entity represented12\nby the species. (The species is not made up of all the entities represented by all the references combined).13\nThe complete list of the qualiﬁer elements in the Biomodels qualiﬁer namespaces is documented at14\nhttp://www.biomodels.net/index.php?s=Qualifiers. The list is divided into two namespaces one for15\nmodel qualiﬁers http://biomodels.net/biology-qualifiers/ (preﬁx used here bqbiol) and the other for16\nbiological qualiﬁers http://biomodels.net/model-qualifiers/) (preﬁx used here bqmodel. This list will17\nonly grow i.e no element will be removed from the list. The following is the list of elements at the time of18\nwriting:19\n• bqmodel:is The modeling object encoded by the SBML component is the subject of the referenced20\nresource. For instance, this qualiﬁer might be used to link the model to a model database.21\n• bqmodel:isDescribedBy The modeling object encoded by the SBML component is described by the22\nreferenced resource. This relation might be used to link SBML components to the literature that23\ndescribes this model or this kinetic law.24\n• bqbiol:is The biological entity represented by the SBML component is the subject of the referenced25\nresource. This relation might be used to link a reaction to its exact counterpart in (e.g.) KEGG or26\nReactome.27\n• bqbiol:hasPart The biological entity represented by the SBML component includes the subject of the28\nreferenced resource, either physically or logically. This relation might be used to link a complex to the29\ndescription of its components.30\n• bqbiol:isPartOf The biological entity represented by the SBML component is a physical or logical31\npart of the subject of the referenced resource. This relation might be used to link a component to the32\ndescription of the complex is belongs to.33\n• bqbiol:isVersionOf The biological entity represented by the SBML component is a version or an34\ninstance of the subject of the referenced resource.35\n• bqbiol:hasVersion The subject of the referenced resource is a version or an instance of the biological36\nentity represented by the SBML component.37\n• bqbiol:isHomologTo The biological entity represented by the SBML component is homolog, to the38\nsubject of the referenced resource, i.e. they share a common ancestor.39\n• bqbiol:isDescribedBy The biological entity represented by the SBML component is described by the40\nreferenced resource. This relation should be used, for example, to link a species or a parameter to the41\nliterature that describes the quantity of the species or the value of the parameter.42\n6.6 Model history43\nWhen enclosed in an SBML Model element, the format described in previous sections can include additional44\nelements to describe the history of the model. This history data must occur immediately before the ﬁrst45\n94\nNature Precedings : hdl:10101/npre.2007.58.1 : Posted 18 Jun 2007\nBioModels relation elements. These additional elements encode information on the model creator and a1\nsequence of dates recording changes to the model. The syntax for this section is outlined below.2\n<dc:creator rdf:parseType=\"Resource\">3\n<rdf:Bag>4\n<rdf:li rdf:parseType=\"Resource\">5\n[[6\n+++7\n<vCard:N rdf:parseType=\"Resource\">8\n<vCard:Family>FAMILY_NAME</vCard:Family>9\n<vCard:Given>GIVEN_NAME</vCard:Given>10\n</vCard:N>11\n+++12\n[<vCard:EMAIL>EMAIL_ADDRESS</vCard:EMAIL>]13\n+++14\n[<vCard:ORG>15\n<vCard:Orgname>ORGANIZATION_NAME</vCard:Orgname>16\n</vCard:ORG>]17\n+++18\n]]19\n</rdf:li>20\n...21\n</rdf:Bag>22\n</dc:creator>23\n<dcterms:created rdf:parseType=\"Resource\">24\n<dcterms:W3CDTF>DATE</dcterms:W3CDTF>25\n</dcterms:created>26\n<dcterms:modified rdf:parseType=\"Resource\">27\n<dcterms:W3CDTF>DATE</dcterms:W3CDTF>28\n</dcterms:modified>29\nThe order of elements is as shown above except that elements of the format contained between [[ and ]]30\ncan occur in any order. The capitalized identiﬁers refer to generic strings of a particular type: FAMILY NAME31\nis the family name of a person who created the model; GIVEN NAME is the ﬁrst name of the same person32\nwho created the model; EMAIL ADDRESS is the email address of the same person who created the model; and33\nORGANIZATION NAME is the name of the organization with which the same person who created the model is34\naﬃliated DATE is a date in W3C date format ( Wolf and Wicksteed , 1998). W3CDTF, N, ORG and EMAIL are35\nliteral strings. The elements of the format contained between [ and ] are optional. ‘ +++’ is a placeholder36\nfor either no content or valid XML syntax that is not deﬁned by the standard annotation scheme but is37\nconsistent with the relevant standards for the enclosing elements. ‘ ...’ is a placeholder for zero or more38\nelements of the same form as the immediately preceding element. The precise form of whitespace and the39\nXML namespace preﬁx deﬁnitions is not constrained. The remaining text in this section describes the syntax40\nformally in English.41\nThe additional elements of the model history sub-format consist in sequence of a dc:creator element, a42\ndcterms:created element and zero or more dcterms:modified elements. All these elements must have the43\nattribute rdf:parseType set to Resource.44\nThe dc:creator element describes the person who created the SBML encoding of the model and contains45\na single rdf:Bag element. The rdf:Bag element can contain any number of elements; however, the ﬁrst46\nelement must be a rdf:li element. The rdf:li element can contain any number of elements in any order.47\nThe set of elements contained with the rdf:li element can include the following informative elements:48\nvCard:N, vCard:EMAIL and vCard:ORG. The vCard:N contains the name of the creator and must consist of a49\nsequence of two elements: vCard:Family and the vCard:Given whose content is the family (surname) and50\ngiven (ﬁrst) names of the creator respectively. The vCard:N must have the attribute rdf:parseType set to51\nResource. The content of the vCard:EMAIL element must be the email address of the creator. The content52\nof the vCard:ORG element must contain a single vCard:Orgname element. The vCard:Orgname element must53\ncontain the name of an organization to which the creator is aﬃliated.54\nThe dcterms:created and dcterms:modified elements must each contain a single dcterms:W3CDTF element55\nwhose content is a date in W3C date format ( Wolf and Wicksteed , 1998) which is a a proﬁle of (restricted56\nform of) ISO 8601.57\n95\nNature Precedings : hdl:10101/npre.2007.58.1 : Posted 18 Jun 2007\n6.7 Examples1\nThe following shows the annotation of a model with model creation data and links to external resources:2\n<model metaid=\"_180340\" id=\"GMO\" name=\"Goldbeter1991_MinMitOscil\">3\n<annotation>4\n<rdf:RDF5\nxmlns:rdf=\"http://www.w3.org/1999/02/22-rdf-syntax-ns#\"6\nxmlns:dc=\"http://purl.org/dc/elements/1.1/\"7\nxmlns:dcterms=\"http://purl.org/dc/terms/\"8\nxmlns:vCard=\"http://www.w3.org/2001/vcard-rdf/3.0#\"9\nxmlns:bqbiol=\"http://biomodels.net/biology-qualifiers/\"10\nxmlns:bqmodel=\"http://biomodels.net/model-qualifiers/\"11\n>12\n<rdf:Description rdf:about=\"#_180340\">13\n<dc:creator rdf:parseType=\"Resource\">14\n<rdf:Bag>15\n<rdf:li rdf:parseType=\"Resource\">16\n<vCard:N rdf:parseType=\"Resource\">17\n<vCard:Family>Shapiro</vCard:Family>18\n<vCard:Given>Bruce</vCard:Given>19\n</vCard:N>20\n<vCard:EMAIL>bshapiro@jpl.nasa.gov</vCard:EMAIL>21\n<vCard:ORG>22\n<vCard:Orgname>NASA Jet Propulsion Laboratory</vCard:Orgname>23\n</vCard:ORG>24\n</rdf:li>25\n</rdf:Bag>26\n</dc:creator>27\n<dcterms:created rdf:parseType=\"Resource\">28\n<dcterms:W3CDTF>2005-02-06T23:39:40+00:00</dcterms:W3CDTF>29\n</dcterms:created>30\n<dcterms:modified rdf:parseType=\"Resource\">31\n<dcterms:W3CDTF>2005-09-13T13:24:56+00:00</dcterms:W3CDTF>32\n</dcterms:modified>33\n<bqmodel:is>34\n<rdf:Bag>35\n<rdf:li rdf:resource=\"http://www.ebi.ac.uk/biomodels/#BIOMD0000000003\"/>36\n</rdf:Bag>37\n</bqmodel:is>38\n<bqmodel:isDescribedBy>39\n<rdf:Bag>40\n<rdf:li rdf:resource=\"http://www.pubmed.gov/#1833774\"/>41\n</rdf:Bag>42\n</bqmodel:isDescribedBy>43\n<bqbiol:isVersionOf>44\n<rdf:Bag>45\n<rdf:li rdf:resource=\"http://www.genome.jp/kegg/pathway/#hsa04110\"/>46\n<rdf:li rdf:resource=\"http://www.reactome.org/#69278\"/>47\n</rdf:Bag>48\n</bqbiol:isVersionOf>49\n</rdf:Description>50\n</rdf:RDF>51\n</annotation>52\nThe following example shows a Reaction structure annotated with a reference to its exact Reactome coun-53\nterpart.54\n<reaction id=\"cdc2Phospho\" metaid=\"jb007\">55\n<annotation>56\n<rdf:RDF57\nxmlns:bqbiol=\"http://biomodels.net/biology-qualifiers/\"58\nxmlns:rdf=\"http://www.w3.org/1999/02/22-rdf-syntax-ns#\"59\n>60\n<rdf:Description rdf:about=\"#jb007\">61\n<bqbiol:is>62\n<rdf:Bag>63\n<rdf:li rdf:resource=\"http://www.reactome.org/#170156\"/>64\n</rdf:Bag>65\n96\nNature Precedings : hdl:10101/npre.2007.58.1 : Posted 18 Jun 2007\n</bqbiol:is>1\n</rdf:Description>2\n</rdf:RDF>3\n</annotation>4\n<listOfReactants>5\n<speciesReference species=\"cdc2\"/>6\n</listOfReactants>7\n<listOfProducts>8\n<speciesReference species=\"cdc2-Y15P\"/>9\n</listOfProducts>10\n<listOfModifiers>11\n<modifierSpeciesReference species=\"wee1\"/>12\n</listOfModifiers>13\n</reaction>14\nThe following example describes a species that represents a complex between the protein calmodulin and15\ncalcium ions:16\n<species id=\"Ca_calmodulin\" metaid=\"cacam\">17\n<annotation>18\n<rdf:RDF19\nxmlns:rdf=\"http://www.w3.org/1999/02/22-rdf-syntax-ns#\"20\nxmlns:bqbiol=\"http://biomodels.net/biology-qualifiers/\"21\n>22\n<rdf:Description rdf:about=\"#cacam\">23\n<bqbiol:hasPart>24\n<rdf:Bag>25\n<rdf:li rdf:resource=\"http://www.uniprot.org/#P62158\"/>26\n<rdf:li rdf:resource=\"http://www.genome.jp/kegg/compound/#C00076\"/>27\n</rdf:Bag>28\n</bqbiol:hasPart>29\n</rdf:Description>30\n</rdf:RDF>31\n</annotation>32\n</species>33\nThe following example describes a species that represents either “Calcium/calmodulin-dependent protein34\nkinase type II alpha chain” or “Calcium/calmodulin-dependent protein kinase type II beta chain”. This35\nis the case, for example, in the somatic cytoplasm of striatal medium-size spiny neurons, where both are36\npresent but they cannot be functionally diﬀerentiated.37\n<species id=\"calcium_calmodulin\" metaid=\"cacam\">38\n<annotation>39\n<rdf:RDF40\nxmlns:rdf=\"http://www.w3.org/1999/02/22-rdf-syntax-ns#\"41\nxmlns:bqbiol=\"http://biomodels.net/biology-qualifiers/\"42\n>43\n<rdf:Description rdf:about=\"#cacam\">44\n<bqbiol:hasVersion>45\n<rdf:Bag>46\n<rdf:li rdf:resource=\"http://www.uniprot.org/#Q9UQM7\"/>47\n<rdf:li rdf:resource=\"http://www.uniprot.org/#Q13554\"/>48\n</rdf:Bag>49\n</bqbiol:hasVersion>50\n</rdf:Description>51\n</rdf:RDF>52\n</annotation>53\n</species>54\nThe above approach should not be used to describe “any Calcium/calmodulin-dependent protein kinase type55\nII chain”, because such an annotation requires referencing the products of other genes such as gamma or delta.56\nAll the known proteins could be enumerated, but such an approach would almost surely lead to inaccuracies57\nbecause biological knowledge continues to evolve. Instead, the annotation should refer to generic information58\nsuch as Ensembl family ENSF00000000194 “CALCIUM/CALMODULIN DEPENDENT KINASE TYPE II59\nCHAIN” or PIR superfamily PIRSF000594 “Calcium/calmodulin-dependent protein kinase type II”.60\n97\nNature Precedings : hdl:10101/npre.2007.58.1 : Posted 18 Jun 2007\nThe following two examples show how to use the qualiﬁer isVersionOf. The ﬁrst example is the relationship1\nbetween a reaction and an EC code. An EC code describes an enzymatic activity and an enzymatic reaction2\ninvolving a particular enzyme can be seen as an instance of this activity. For example, the following reaction3\nrepresents the phosphorylation of a glutamate receptor by a complex calcium/calmodulin kinase II.4\n<reaction id=\"NMDAR_phosphorylation\" metaid=\"thx1138\">5\n<annotation>6\n<rdf:RDF7\nxmlns:bqbiol=\"http://biomodels.net/biology-qualifiers/\"8\nxmlns:rdf=\"http://www.w3.org/1999/02/22-rdf-syntax-ns#\"9\n>10\n<rdf:Description rdf:about=\"#thx1138\">11\n<bqbiol:isVersionOf>12\n<rdf:Bag>13\n<rdf:li rdf:resource=\"http://www.ec-code.org/#2.7.1.17\"/>14\n</rdf:Bag>15\n</bqbiol:isVersionOf>16\n</rdf:Description>17\n</rdf:RDF>18\n</annotation>19\n<listOfReactants>20\n<speciesReference species=\"NMDAR\"/>21\n</listOfReactants>22\n<listOfProducts>23\n<speciesReference species=\"P-NMDAR\"/>24\n</listOfProducts>25\n<listOfModifiers>26\n<modifierSpeciesReference species=\"CaMKII\"/>27\n</listOfModifiers>28\n<kineticLaw>29\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\">30\n<apply>31\n<times/>32\n<ci>CaMKII</ci>33\n<ci>kcat</ci>34\n<apply>35\n<divide/>36\n<ci>NMDAR</ci>37\n<apply>38\n</times>39\n<ci>NMDAR</ci>40\n<ci>Km</ci>41\n</apply>42\n</apply>43\n</apply>44\n</math>45\n<listOfParameters>46\n<parameter id=\"kcat\" value=\"1\"/>47\n<parameter id=\"Km\" value=\"5e-10\"/>48\n</listOfParameters>49\n</kineticLaw>50\n</reaction>51\nThe second example of the use of isVersionOf is the complex between Calcium/calmodulin-dependent52\nprotein kinase type II alpha chain and Calcium/calmodulin, that is only one of the “calcium- and calmodulin-53\ndependent protein kinase complexes” described by the Gene Ontology term GO:0005954.54\n<species id=\"CaCaMKII\" metaid=\"C8H10N4O2\">55\n<annotation>56\n<rdf:RDF57\nxmlns:rdf=\"http://www.w3.org/1999/02/22-rdf-syntax-ns#\"58\nxmlns:bqbiol=\"http://biomodels.net/biology-qualifiers/\"59\n>60\n<rdf:Description rdf:about=\"#C8H10N4O2\">61\n<bqbiol:isVersionOf>62\n<rdf:Bag>63\n<rdf:li rdf:resource=\"http://www.geneontology.org/#GO:0005954\"/>64\n</rdf:Bag>65\n98\nNature Precedings : hdl:10101/npre.2007.58.1 : Posted 18 Jun 2007\n</bqbiol:isVersionOf>1\n</rdf:Description>2\n</rdf:RDF>3\n</annotation>4\n</species>5\nThe previous case is diﬀerent form the following one, although they could seem similar at ﬁrst sight.6\nThe “Calcium/calmodulin-dependent protein kinase type II alpha chain” is a part of the above mentioned7\n“calcium- and calmodulin-dependent protein kinase complex”.8\n<species id=\"CaMKIIalpha\" metaid=\"C10H14N2\">9\n<annotation>10\n<rdf:RDF11\nxmlns:rdf=\"http://www.w3.org/1999/02/22-rdf-syntax-ns#\"12\nxmlns:bqbiol=\"http://biomodels.net/biology-qualifiers/\"13\n>14\n<rdf:Description rdf:about=\"#C10H14N2\">15\n<bqbiol:isPartOf>16\n<rdf:Bag>17\n<rdf:li rdf:resource=\"http://www.geneontology.org/#GO:0005954\"/>18\n</rdf:Bag>19\n</bqbiol:isPartOf>20\n</rdf:Description>21\n</rdf:RDF>22\n</annotation>23\n</species>24\nIt is possible describe a component with several alternative sets of qualiﬁed annotations. For example, the25\nfollowing species represents a pool of GMP, GDP and GTP. We annotate it with the three corresponding26\nKEGG compound identiﬁers but also with the three corresponding ChEBI identiﬁers. The two alternative27\nannotations are encoded in separate hasVersion qualiﬁer elements.28\n<species id=\"GXP\" metaid=\"GXP\">29\n<annotation>30\n<rdf:RDF31\nxmlns:rdf=\"http://www.w3.org/1999/02/22-rdf-syntax-ns#\"32\nxmlns:bqbiol=\"http://biomodels.net/biology-qualifiers/\"33\n>34\n<rdf:Description rdf:about=\"#GXP\">35\n<bqbiol:hasVersion>36\n<rdf:Bag>37\n<rdf:li rdf:resource=\"http://www.ebi.ac.uk/chebi/#CHEBI:17345\"/>38\n<rdf:li rdf:resource=\"http://www.ebi.ac.uk/chebi/#CHEBI:17552\"/>39\n<rdf:li rdf:resource=\"http://www.ebi.ac.uk/chebi/#CHEBI:17627\"/>40\n</rdf:Bag>41\n</bqbiol:hasVersion>42\n<bqbiol:hasVersion>43\n<rdf:Bag>44\n<rdf:li rdf:resource=\"http://www.genome.jp/kegg/compound/#C00035\"/>45\n<rdf:li rdf:resource=\"http://www.genome.jp/kegg/compound/#C00044\"/>46\n<rdf:li rdf:resource=\"http://www.genome.jp/kegg/compound/#C00144\"/>47\n</rdf:Bag>48\n</bqbiol:hasVersion>49\n</rdf:Description>50\n</rdf:RDF>51\n</annotation>52\n</species>53\nThe following example presents a reaction being actually the combination of three diﬀerent elementary54\nmolecular reactions. We annotate it with the three corresponding KEGG reactions, but also with the three55\ncorresponding enzymatic activities. Again the two hasPart elements represent two alternative annotations.56\nThe process represented by the Reaction structure is composed of three parts, and not six parts.57\n<reaction id=\"adenineProd\" metaid=\"adeprod\">58\n<annotation>59\n<rdf:RDF60\nxmlns:bqbiol=\"http://biomodels.net/biology-qualifiers/\"61\n99\nNature Precedings : hdl:10101/npre.2007.58.1 : Posted 18 Jun 2007\nxmlns:rdf=\"http://www.w3.org/1999/02/22-rdf-syntax-ns#\"1\n>2\n<rdf:Description rdf:about=\"#adeprod\">3\n<bqbiol:hasPart>4\n<rdf:Bag>5\n<rdf:li rdf:resource=\"http://www.ec-code.org/#2.5.1.22\"/>6\n<rdf:li rdf:resource=\"http://www.ec-code.org/#3.2.2.16\"/>7\n<rdf:li rdf:resource=\"http://www.ec-code.org/#4.1.1.50\"/>8\n</rdf:Bag>9\n</bqbiol:hasPart>10\n<bqbiol:hasPart>11\n<rdf:Bag>12\n<rdf:li rdf:resource=\"http://www.genome.jp/kegg/reaction/#R00178\"/>13\n<rdf:li rdf:resource=\"http://www.genome.jp/kegg/reaction/#R01401\"/>14\n<rdf:li rdf:resource=\"http://www.genome.jp/kegg/reaction/#R02869\"/>15\n</rdf:Bag>16\n</bqbiol:hasPart>17\n</rdf:Description>18\n</rdf:RDF>19\n</annotation>20\n</reaction>21\nIt is possible to mix diﬀerent URIs in a given set. The following example presents two alternative annotations22\nof the human hemoglobin, the ﬁrst with ChEBI heme and the second with KEGG heme.23\n<species id=\"heme\" metaid=\"heme\">24\n<annotation>25\n<rdf:RDF26\nxmlns:rdf=\"http://www.w3.org/1999/02/22-rdf-syntax-ns#\"27\nxmlns:bqbiol=\"http://biomodels.net/biology-qualifiers/\"28\n>29\n<rdf:Description rdf:about=\"#heme\">30\n<bqbiol:hasPart>31\n<rdf:Bag>32\n<rdf:li rdf:resource=\"http://www.uniprot.org/#P69905\"/>33\n<rdf:li rdf:resource=\"http://www.uniprot.org/#P68871\"/>34\n<rdf:li rdf:resource=\"http://www.ebi.ac.uk/chebi/#CHEBI:17627\">35\n</rdf:Bag>36\n</bqbiol:hasPart>37\n<bqbiol:hasPart>38\n<rdf:Bag>39\n<rdf:li rdf:resource=\"http://www.uniprot.org/#P69905\"/>40\n<rdf:li rdf:resource=\"http://www.uniprot.org/#P68871\"/>41\n<rdf:li rdf:resource=\"http://www.genome.jp/kegg/compound/#C00032\"/>42\n</rdf:Bag>43\n</bqbiol:hasPart>44\n</rdf:Description>45\n</rdf:RDF>46\n</annotation>47\n</species>48\nAs formally deﬁned above it is possible to use diﬀerent qualiﬁers in the same annotation element. The49\nfollowing phosphorylation is annotated by its exact KEGG counterpart and by the generic GO term “phos-50\nphorylation”.51\n<reaction id=\"phosphorylation\" metaid=\"phosphorylation\">52\n<annotation>53\n<rdf:RDF54\nxmlns:bqbiol=\"http://biomodels.net/biology-qualifiers/\"55\nxmlns:rdf=\"http://www.w3.org/1999/02/22-rdf-syntax-ns#\"56\n>57\n<rdf:Description rdf:about=\"#phosphorylation\">58\n<bqbiol:is>59\n<rdf:Bag>60\n<rdf:li rdf:resource=\"http://www.genome.jp/kegg/reaction/#R03313\" />61\n</rdf:Bag>62\n</bqbiol:is>63\n<bqbiol:isVersionOf>64\n100\nNature Precedings : hdl:10101/npre.2007.58.1 : Posted 18 Jun 2007\n<rdf:Bag>1\n<rdf:li rdf:resource=\"http://www.geneontology.org/#GO:0016310\" />2\n</rdf:Bag>3\n</bqbiol:isVersionOf>4\n</rdf:Description>5\n</rdf:RDF>6\n</annotation>7\n</reaction>8\n101\nNature Precedings : hdl:10101/npre.2007.58.1 : Posted 18 Jun 2007\n7 Example models expressed in XML using SBML1\nIn this section, we present several examples of complete models encoded in XML using SBML Level 2.2\n7.1 A simple example application of SBML3\nConsider the following representation of an enzymatic reaction:4\nE + S\nkon\n−⇀↽−\nkoff\nES\nkcat\n− →E + P5\nThe following is the minimal SBML document encoding the model shown above:6\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>7\n<sbml level=\"2\" version=\"3\" xmlns=\"http://www.sbml.org/sbml/level2/version3\">8\n<model name=\"EnzymaticReaction\">9\n<listOfUnitDefinitions>10\n<unitDefinition id=\"per_second\">11\n<listOfUnits>12\n<unit kind=\"second\" exponent=\"-1\"/>13\n</listOfUnits>14\n</unitDefinition>15\n<unitDefinition id=\"litre_per_mole_per_second\">16\n<listOfUnits>17\n<unit kind=\"mole\" exponent=\"-1\"/>18\n<unit kind=\"litre\" exponent=\"1\"/>19\n<unit kind=\"second\" exponent=\"-1\"/>20\n</listOfUnits>21\n</unitDefinition>22\n</listOfUnitDefinitions>23\n<listOfCompartments>24\n<compartment id=\"cytosol\" size=\"1e-14\"/>25\n</listOfCompartments>26\n<listOfSpecies>27\n<species compartment=\"cytosol\" id=\"ES\" initialAmount=\"0\" name=\"ES\"/>28\n<species compartment=\"cytosol\" id=\"P\" initialAmount=\"0\" name=\"P\"/>29\n<species compartment=\"cytosol\" id=\"S\" initialAmount=\"1e-20\" name=\"S\"/>30\n<species compartment=\"cytosol\" id=\"E\" initialAmount=\"5e-21\" name=\"E\"/>31\n</listOfSpecies>32\n<listOfReactions>33\n<reaction id=\"veq\">34\n<listOfReactants>35\n<speciesReference species=\"E\"/>36\n<speciesReference species=\"S\"/>37\n</listOfReactants>38\n<listOfProducts>39\n<speciesReference species=\"ES\"/>40\n</listOfProducts>41\n<kineticLaw>42\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\">43\n<apply>44\n<times/>45\n<ci>cytosol</ci>46\n<apply>47\n<minus/>48\n<apply>49\n<times/>50\n<ci>kon</ci>51\n<ci>E</ci>52\n<ci>S</ci>53\n</apply>54\n<apply>55\n<times/>56\n<ci>koff</ci>57\n<ci>ES</ci>58\n</apply>59\n</apply>60\n</apply>61\n</math>62\n102\nNature Precedings : hdl:10101/npre.2007.58.1 : Posted 18 Jun 2007\n<listOfParameters>1\n<parameter id=\"kon\" value=\"1000000\" units=\"litre_per_mole_per_second\"/>2\n<parameter id=\"koff\" value=\"0.2\" units=\"per_second\"/>3\n</listOfParameters>4\n</kineticLaw>5\n</reaction>6\n<reaction id=\"vcat\" reversible=\"false\">7\n<listOfReactants>8\n<speciesReference species=\"ES\"/>9\n</listOfReactants>10\n<listOfProducts>11\n<speciesReference species=\"E\"/>12\n<speciesReference species=\"P\"/>13\n</listOfProducts>14\n<kineticLaw>15\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\">16\n<apply>17\n<times/>18\n<ci>cytosol</ci>19\n<ci>kcat</ci>20\n<ci>ES</ci>21\n</apply>22\n</math>23\n<listOfParameters>24\n<parameter id=\"kcat\" value=\"0.1\" units=\"per_second\"/>25\n</listOfParameters>26\n</kineticLaw>27\n</reaction>28\n</listOfReactions>29\n</model>30\n</sbml>31\nIn this example, the model has the identiﬁer “ EnzymaticReaction”. The model contains one compartment32\n(with identiﬁer “ cytosol”), four species (with identiﬁers “ ES”, “ P”, “ S”, and “ E”), and two reactions (“ veq”33\nand “vcat”). The elements in the listOfReactants and listOfProducts in each reaction refer to the names34\nof elements listed in the listOfSpecies. The correspondences between the various elements is explicitly35\nstated by the speciesReference elements.36\nThe model also features local parameter deﬁnitions in each reaction. In this case, the three parameters37\n(“kon”, “ koff”, “ kcat”) all have unique identiﬁers and they could also have just as easily been declared38\nglobal parameters in the model. Local parameters frequently become more useful in larger models, where it39\nmay become tedious to assign unique identiﬁers for all the diﬀerent parameters.40\n7.2 Example involving units41\nThe following model uses the units features of SBML Level 2. In this model, the default value of substance42\nis changed to be mole units with a scale factor of −3, or millimoles. This sets the default substance units43\nin the model. The volume and time built-ins are left to their defaults, meaning volume is in litres and time44\nis in seconds. The result is that, in this model, kinetic law formulas deﬁne rates in millimoles per second45\nand the species identiﬁers in them represent concentration values in millimoles per litres. All the species46\nelements set the initial amount of every given species to 1 millimole. The parameters “ vm” and “ km” are47\ndeﬁned to be in millimoles per litres per second, and millimoles per litres, respectively.48\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>49\n<sbml xmlns=\"http://www.sbml.org/sbml/level2/version3\" level=\"2\" version=\"3\"50\nxmlns:xhtml=\"http://www.w3.org/1999/xhtml\">51\n<model>52\n<listOfUnitDefinitions>53\n<unitDefinition id=\"substance\">54\n<listOfUnits>55\n<unit kind=\"mole\" scale=\"-3\"/>56\n</listOfUnits>57\n</unitDefinition>58\n<unitDefinition id=\"mmls\">59\n<listOfUnits>60\n103\nNature Precedings : hdl:10101/npre.2007.58.1 : Posted 18 Jun 2007\n<unit kind=\"mole\" scale=\"-3\"/>1\n<unit kind=\"litre\" exponent=\"-1\"/>2\n<unit kind=\"second\" exponent=\"-1\"/>3\n</listOfUnits>4\n</unitDefinition>5\n<unitDefinition id=\"mml\">6\n<listOfUnits>7\n<unit kind=\"mole\" scale=\"-3\"/>8\n<unit kind=\"litre\" exponent=\"-1\"/>9\n</listOfUnits>10\n</unitDefinition>11\n</listOfUnitDefinitions>12\n<listOfCompartments>13\n<compartment id=\"cell\" size=\"1\"/>14\n</listOfCompartments>15\n<listOfSpecies>16\n<species id=\"x0\" compartment=\"cell\" initialConcentration=\"1\"/>17\n<species id=\"x1\" compartment=\"cell\" initialConcentration=\"1\"/>18\n<species id=\"s1\" compartment=\"cell\" initialConcentration=\"1\"/>19\n<species id=\"s2\" compartment=\"cell\" initialConcentration=\"1\"/>20\n</listOfSpecies>21\n<listOfParameters>22\n<parameter id=\"vm\" value=\"2\" units=\"mmls\"/>23\n<parameter id=\"km\" value=\"2\" units=\"mml\"/>24\n</listOfParameters>25\n<listOfReactions>26\n<reaction id=\"v1\">27\n<listOfReactants>28\n<speciesReference species=\"x0\"/>29\n</listOfReactants>30\n<listOfProducts>31\n<speciesReference species=\"s1\"/>32\n</listOfProducts>33\n<kineticLaw>34\n<notes>35\n<xhtml:p>((vm * s1)/(km + s1))*cell</xhtml:p>36\n</notes>37\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\">38\n<apply>39\n<times/>40\n<apply>41\n<divide/>42\n<apply>43\n<times/>44\n<ci> vm </ci>45\n<ci> s1 </ci>46\n</apply>47\n<apply>48\n<plus/>49\n<ci> km </ci>50\n<ci> s1 </ci>51\n</apply>52\n</apply>53\n<ci> cell </ci>54\n</apply>55\n</math>56\n</kineticLaw>57\n</reaction>58\n<reaction id=\"v2\">59\n<listOfReactants>60\n<speciesReference species=\"s1\"/>61\n</listOfReactants>62\n<listOfProducts>63\n<speciesReference species=\"s2\"/>64\n</listOfProducts>65\n<kineticLaw>66\n<notes>67\n<xhtml:p>((vm * s2)/(km + s2))*cell</xhtml:p>68\n</notes>69\n104\nNature Precedings : hdl:10101/npre.2007.58.1 : Posted 18 Jun 2007\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\">1\n<apply>2\n<times/>3\n<apply>4\n<divide/>5\n<apply>6\n<times/>7\n<ci> vm </ci>8\n<ci> s2 </ci>9\n</apply>10\n<apply>11\n<plus/>12\n<ci> km </ci>13\n<ci> s2 </ci>14\n</apply>15\n</apply>16\n<ci> cell </ci>17\n</apply>18\n</math>19\n</kineticLaw>20\n</reaction>21\n<reaction id=\"v3\">22\n<listOfReactants>23\n<speciesReference species=\"s2\"/>24\n</listOfReactants>25\n<listOfProducts>26\n<speciesReference species=\"x1\"/>27\n</listOfProducts>28\n<kineticLaw>29\n<notes>30\n<xhtml:p>((vm * x1)/(km + x1))*cell</xhtml:p>31\n</notes>32\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\">33\n<apply>34\n<times/>35\n<apply>36\n<divide/>37\n<apply>38\n<times/>39\n<ci> vm </ci>40\n<ci> x1 </ci>41\n</apply>42\n<apply>43\n<plus/>44\n<ci> km </ci>45\n<ci> x1 </ci>46\n</apply>47\n</apply>48\n<ci> cell </ci>49\n</apply>50\n</math>51\n</kineticLaw>52\n</reaction>53\n</listOfReactions>54\n</model>55\n</sbml>56\n7.3 Example of a discrete version of a simple dimerization reaction57\n(Model contributed by Darren J. Wilkinson, Newcastle University, Newcastle upon Tyne, UK.)58\nThis example illustrates subtle diﬀerences between models formulated for use in a continuous simulation59\nframework (e.g., using diﬀerential equations) and those intended for a discrete simulation framework. The60\nmodel shown here is suitable for use with a discrete stochastic simulation algorithm of the sort developed61\nby Gillespie (1977). In such an approach, species are described in terms of molecular counts and simulation62\nproceeds by computing the probability of the time and identity of the next reaction, then updating the63\nspecies amounts appropriately.64\n105\nNature Precedings : hdl:10101/npre.2007.58.1 : Posted 18 Jun 2007\nThe model involves a simple dimerization reaction for a protein named “ P”:1\n2P ↔ P22\nThe SBML representation is shown below. There are several important points to note. First, the species “ P”3\nand “ P2” declare they are always in discrete amounts by using the ﬂag hasOnlySubstanceUnits=“true”.4\nThis indicates that when the species identiﬁers appear in mathematical formulas, the units are substance, not5\nthe default of substance/size. A second point is that, as a result, the corresponding “kinetic law” formulas6\ndo not need volume corrections. In Gillespie’s approach, the constants in the rate expressions (here, “ c1”7\nand “ c2”) contain a contribution from the kinetic constants of the reaction and the size of the compartment8\nin which the reactions take place. Finally, it is worth noting the rate expression for the forward reaction is a9\nsecond-order mass-action reaction, but it is the discrete formulation of such a reaction rate ( Gillespie, 1977).10\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>11\n<sbml xmlns=\"http://www.sbml.org/sbml/level2/version3\" level=\"2\" version=\"3\">12\n<model id=\"dimerization\">13\n<listOfUnitDefinitions>14\n<unitDefinition id=\"substance\">15\n<listOfUnits>16\n<unit kind=\"item\" multiplier=\"1\"/>17\n</listOfUnits>18\n</unitDefinition>19\n<unitDefinition id=\"per_second\">20\n<listOfUnits>21\n<unit kind=\"second\" exponent=\"-1\"/>22\n</listOfUnits>23\n</unitDefinition>24\n</listOfUnitDefinitions>25\n<listOfCompartments>26\n<compartment id=\"Cell\" size=\"1e-15\"/>27\n</listOfCompartments>28\n<listOfSpecies>29\n<species id=\"P\" compartment=\"Cell\" initialAmount=\"301\"30\nhasOnlySubstanceUnits=\"true\"/>31\n<species id=\"P2\" compartment=\"Cell\" initialAmount=\"0\"32\nhasOnlySubstanceUnits=\"true\"/>33\n</listOfSpecies>34\n<listOfReactions>35\n<reaction id=\"Dimerization\" reversible=\"false\">36\n<listOfReactants>37\n<speciesReference species=\"P\" stoichiometry=\"2\"/>38\n</listOfReactants>39\n<listOfProducts>40\n<speciesReference species=\"P2\"/>41\n</listOfProducts>42\n<kineticLaw>43\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\">44\n<apply>45\n<divide/>46\n<apply>47\n<times/>48\n<ci> c1 </ci>49\n<ci> P </ci>50\n<apply>51\n<minus/>52\n<ci> P </ci>53\n<cn type=\"integer\"> 1 </cn>54\n</apply>55\n</apply>56\n<cn type=\"integer\"> 2 </cn>57\n</apply>58\n</math>59\n<listOfParameters>60\n<parameter id=\"c1\" value=\"0.00166\" units=\"per_second\"/>61\n</listOfParameters>62\n</kineticLaw>63\n</reaction>64\n106\nNature Precedings : hdl:10101/npre.2007.58.1 : Posted 18 Jun 2007\n<reaction id=\"Dissociation\" reversible=\"false\">1\n<listOfReactants>2\n<speciesReference species=\"P2\"/>3\n</listOfReactants>4\n<listOfProducts>5\n<speciesReference species=\"P\" stoichiometry=\"2\"/>6\n</listOfProducts>7\n<kineticLaw>8\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\">9\n<apply>10\n<times/>11\n<ci> c2 </ci>12\n<ci> P </ci>13\n</apply>14\n</math>15\n<listOfParameters>16\n<parameter id=\"c2\" value=\"0.2\" units=\"per_second\"/>17\n</listOfParameters>18\n</kineticLaw>19\n</reaction>20\n</listOfReactions>21\n</model>22\n</sbml>23\nThis example also illustrates the need to provide additional information in a model so that software tools24\nusing diﬀerent mathematical frameworks can properly interpret it. In this case, a simulation tool designed25\nfor continuous ODE-based simulation would likely misinterpret the model (in particular the reaction rate26\nformulas), unless it deduced that a discrete stochastic simulation was intended. One of the purposes of SBO27\nannotations (Section 5) is to enable such interpretation without the need for deduction.28\n7.4 Example involving assignment rules29\nThis section contains a model that simulates a system containing a fast reaction. This model uses rules to30\nexpress the mathematics of the fast reaction explicitly rather than using the fast attribute on a reaction31\nelement. The system modeled is32\nX0\nk1X0− − − → S1\nS1\nkf S1−krS2\n− − − − − − − − →S2\nS2\nk2S2− − − → X1\n33\n34\nk1 = 0.1, k 2 = 0.15, k f = Keq10000, k r = 10000, K eq = 2.5.35\nwhere X0, S1, S1, and S2 are species in concentration units, and k1, k2, kf , kr, and Keq are parameters.36\nThis system of reactions can be approximated with the following new system:37\nX0\nk1X0− − − →T\nT\nk2S2− − − →X1\n38\n39\nS1 = T\n1 + Keq\nS2 = KeqS1\n40\nwhere T is a new species. The following example SBML model encodes the second system.41\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>42\n<sbml xmlns=\"http://www.sbml.org/sbml/level2/version3\" level=\"2\" version=\"3\"43\nxmlns:math=\"http://www.w3.org/1998/Math/MathML\">44\n<model>45\n107\nNature Precedings : hdl:10101/npre.2007.58.1 : Posted 18 Jun 2007\n<listOfUnitDefinitions>1\n<unitDefinition id=\"per_second\">2\n<listOfUnits>3\n<unit kind=\"second\" exponent=\"-1\"/>4\n</listOfUnits>5\n</unitDefinition>6\n</listOfUnitDefinitions>7\n<listOfCompartments>8\n<compartment id=\"cell\" size=\"1\"/>9\n</listOfCompartments>10\n<listOfSpecies>11\n<species id=\"X0\" compartment=\"cell\" initialConcentration=\"1\"/>12\n<species id=\"X1\" compartment=\"cell\" initialConcentration=\"0\"/>13\n<species id=\"T\" compartment=\"cell\" initialConcentration=\"0\"/>14\n<species id=\"S1\" compartment=\"cell\" initialConcentration=\"0\"/>15\n<species id=\"S2\" compartment=\"cell\" initialConcentration=\"0\"/>16\n</listOfSpecies>17\n<listOfParameters>18\n<parameter id=\"Keq\" value=\"2.5\" units=\"dimensionless\"/>19\n</listOfParameters>20\n<listOfRules>21\n<assignmentRule variable=\"S1\">22\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\">23\n<apply>24\n<divide/>25\n<ci> T </ci>26\n<apply>27\n<plus/>28\n<cn> 1 </cn>29\n<ci> Keq </ci>30\n</apply>31\n</apply>32\n</math>33\n</assignmentRule>34\n<assignmentRule variable=\"S2\">35\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\">36\n<apply>37\n<times/>38\n<ci> Keq </ci>39\n<ci> S1 </ci>40\n</apply>41\n</math>42\n</assignmentRule>43\n</listOfRules>44\n<listOfReactions>45\n<reaction id=\"in\">46\n<listOfReactants>47\n<speciesReference species=\"X0\"/>48\n</listOfReactants>49\n<listOfProducts>50\n<speciesReference species=\"T\"/>51\n</listOfProducts>52\n<kineticLaw>53\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\">54\n<apply>55\n<times/>56\n<ci> k1 </ci>57\n<ci> X0 </ci>58\n<ci> cell </ci>59\n</apply>60\n</math>61\n<listOfParameters>62\n<parameter id=\"k1\" value=\"0.1\" units=\"per_second\"/>63\n</listOfParameters>64\n</kineticLaw>65\n</reaction>66\n<reaction id=\"out\">67\n<listOfReactants>68\n<speciesReference species=\"T\"/>69\n108\nNature Precedings : hdl:10101/npre.2007.58.1 : Posted 18 Jun 2007\n</listOfReactants>1\n<listOfProducts>2\n<speciesReference species=\"X1\"/>3\n</listOfProducts>4\n<listOfModifiers>5\n<modifierSpeciesReference species=\"S2\"/>6\n</listOfModifiers>7\n<kineticLaw>8\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\">9\n<apply>10\n<times/>11\n<ci> k2 </ci>12\n<ci> S2 </ci>13\n<ci> cell </ci>14\n</apply>15\n</math>16\n<listOfParameters>17\n<parameter id=\"k2\" value=\"0.15\" units=\"per_second\"/>18\n</listOfParameters>19\n</kineticLaw>20\n</reaction>21\n</listOfReactions>22\n</model>23\n</sbml>24\n7.5 Example involving algebraic rules25\nThis section contains an example model that contains an AlgebraicRule object. The model contains a26\ndiﬀerent formulation of the fast reaction described in Section 7.4. The system described in Section 7.4 can27\nbe approximated with the following system:28\nX0\nk1X0− − − →T\nT\nk2S1− − − →X1\n29\n30\nS2 = KeqS131\nwith the constraint:32\nS1 + S2 − T = 033\nThe following example SBML model encodes this approximate form.34\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>35\n<sbml xmlns=\"http://www.sbml.org/sbml/level2/version3\" level=\"2\" version=\"3\">36\n<model>37\n<listOfUnitDefinitions>38\n<unitDefinition id=\"per_second\">39\n<listOfUnits>40\n<unit kind=\"second\" exponent=\"-1\"/>41\n</listOfUnits>42\n</unitDefinition>43\n</listOfUnitDefinitions>44\n<listOfCompartments>45\n<compartment id=\"cell\" size=\"1\"/>46\n</listOfCompartments>47\n<listOfSpecies>48\n<species id=\"X0\" compartment=\"cell\" initialConcentration=\"1\"/>49\n<species id=\"X1\" compartment=\"cell\" initialConcentration=\"0\"/>50\n<species id=\"T\" compartment=\"cell\" initialConcentration=\"0\"/>51\n<species id=\"S1\" compartment=\"cell\" initialConcentration=\"0\"/>52\n<species id=\"S2\" compartment=\"cell\" initialConcentration=\"0\"/>53\n</listOfSpecies>54\n<listOfParameters>55\n<parameter id=\"Keq\" value=\"2.5\" units=\"dimensionless\"/>56\n</listOfParameters>57\n109\nNature Precedings : hdl:10101/npre.2007.58.1 : Posted 18 Jun 2007\n<listOfRules>1\n<assignmentRule variable=\"S2\">2\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\">3\n<apply>4\n<times/>5\n<ci> Keq </ci>6\n<ci> S1 </ci>7\n</apply>8\n</math>9\n</assignmentRule>10\n<algebraicRule>11\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\">12\n<apply>13\n<minus/>14\n<apply>15\n<plus/>16\n<ci> S2 </ci>17\n<ci> S1 </ci>18\n</apply>19\n<ci> T </ci>20\n</apply>21\n</math>22\n</algebraicRule>23\n</listOfRules>24\n<listOfReactions>25\n<reaction id=\"in\">26\n<listOfReactants>27\n<speciesReference species=\"X0\"/>28\n</listOfReactants>29\n<listOfProducts>30\n<speciesReference species=\"T\"/>31\n</listOfProducts>32\n<kineticLaw>33\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\">34\n<apply>35\n<times/>36\n<ci> k1 </ci>37\n<ci> X0 </ci>38\n<ci> cell </ci>39\n</apply>40\n</math>41\n<listOfParameters>42\n<parameter id=\"k1\" value=\"0.1\" units=\"per_second\"/>43\n</listOfParameters>44\n</kineticLaw>45\n</reaction>46\n<reaction id=\"out\">47\n<listOfReactants>48\n<speciesReference species=\"T\"/>49\n</listOfReactants>50\n<listOfProducts>51\n<speciesReference species=\"X1\"/>52\n</listOfProducts>53\n<listOfModifiers>54\n<modifierSpeciesReference species=\"S2\"/>55\n</listOfModifiers>56\n<kineticLaw>57\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\">58\n<apply>59\n<times/>60\n<ci> k2 </ci>61\n<ci> S2 </ci>62\n<ci> cell </ci>63\n</apply>64\n</math>65\n<listOfParameters>66\n<parameter id=\"k2\" value=\"0.15\" units=\"per_second\"/>67\n</listOfParameters>68\n</kineticLaw>69\n110\nNature Precedings : hdl:10101/npre.2007.58.1 : Posted 18 Jun 2007\n</reaction>1\n</listOfReactions>2\n</model>3\n</sbml>4\n7.6 Example with combinations of boundaryCondition and constant values on Species with5\nRateRule objects6\nIn this section, we discuss a model that includes four species, each with a diﬀerent combination of values for7\ntheir boundaryCondition and constant attributes. The model represents a hypothetical system containing8\none reaction,9\nS1 + S2\nk1S1S2S3− − − − − − − →S410\nwhere S3 is a species that catalyzes the conversion of species S1 and S2 into S4. S1 and S2 are on the11\nboundary of the system (i.e., S1 and S2 are reactants but their values are not determined by a kinetic law).12\nThe value of S1 in the system is determined over time by the rate rule:13\ndS1\ndt = k214\nThe values of constant parameters in the system are:15\nS2 = 1, S 3 = 2, k 1 = 0.5, k 2 = 0.116\nand the initial values of species are:17\nS1 = 0, S 4 = 018\nThe value of S1 varies over time so in SBML S1 has a constant attribute with a default value of “ false”.19\nThe values of S2 and S3 are ﬁxed so in SBML they have a constant attribute values of “ true”. S3 only20\noccurs as a modiﬁer so the value of its boundaryCondition attribute can default to “ false”. S4 is a product21\nwhose value is determined by a kinetic law and therefore in the SBML representation has “ false” (the22\ndefault) for both its boundaryCondition and constant attributes.23\nThe following is the SBML rendition of the model shown above:24\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>25\n<sbml xmlns=\"http://www.sbml.org/sbml/level2/version3\" level=\"2\" version=\"3\">26\n<model id=\"BoundaryCondExampleModel\">27\n<listOfUnitDefinitions>28\n<unitDefinition id=\"mole_per_litre_per_second\">29\n<listOfUnits>30\n<unit kind=\"mole\" />31\n<unit kind=\"litre\" exponent=\"-1\"/>32\n<unit kind=\"second\" exponent=\"-1\"/>33\n</listOfUnits>34\n</unitDefinition>35\n<unitDefinition id=\"litre_sq_per_mole_sq_per_second\">36\n<listOfUnits>37\n<unit kind=\"mole\" exponent=\"-2\"/>38\n<unit kind=\"litre\" exponent=\"2\"/>39\n<unit kind=\"second\" exponent=\"-1\"/>40\n</listOfUnits>41\n</unitDefinition>42\n</listOfUnitDefinitions>43\n<listOfCompartments>44\n<compartment id=\"compartmentOne\" size=\"1\"/>45\n</listOfCompartments>46\n<listOfSpecies>47\n<species id=\"S1\" initialConcentration=\"0\" compartment=\"compartmentOne\"48\nboundaryCondition=\"true\"/>49\n<species id=\"S2\" initialConcentration=\"1\" compartment=\"compartmentOne\"50\nboundaryCondition=\"true\" constant=\"true\"/>51\n<species id=\"S3\" initialConcentration=\"3\" compartment=\"compartmentOne\"52\n111\nNature Precedings : hdl:10101/npre.2007.58.1 : Posted 18 Jun 2007\nconstant=\"true\"/>1\n<species id=\"S4\" initialConcentration=\"0\" compartment=\"compartmentOne\"/>2\n</listOfSpecies>3\n<listOfParameters>4\n<parameter id=\"k1\" value=\"0.5\" units=\"litre_sq_per_mole_sq_per_second\"/>5\n<parameter id=\"k2\" value=\"0.1\" units=\"mole_per_litre_per_second\"/>6\n</listOfParameters>7\n<listOfRules>8\n<rateRule variable=\"S1\">9\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\">10\n<ci> k2 </ci>11\n</math>12\n</rateRule>13\n</listOfRules>14\n<listOfReactions>15\n<reaction id=\"reaction_1\" reversible=\"false\">16\n<listOfReactants>17\n<speciesReference species=\"S1\"/>18\n<speciesReference species=\"S2\"/>19\n</listOfReactants>20\n<listOfProducts>21\n<speciesReference species=\"S4\"/>22\n</listOfProducts>23\n<listOfModifiers>24\n<modifierSpeciesReference species=\"S3\"/>25\n</listOfModifiers>26\n<kineticLaw>27\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\">28\n<apply>29\n<times/>30\n<ci> k1 </ci>31\n<ci> S1 </ci>32\n<ci> S2 </ci>33\n<ci> S3 </ci>34\n<ci> compartmentOne </ci>35\n</apply>36\n</math>37\n</kineticLaw>38\n</reaction>39\n</listOfReactions>40\n</model>41\n</sbml>42\n7.7 Example of translation from a multi-compartmental model to ODEs43\nThis section contains a model with 2 compartments and 4 reactions. The model is derived from Lotka-44\nVolterra, with the addition of a reversible transport step. When observed in a time-course simulation, three45\nof this model’s species display damped oscillations.46\ncytosol\nnucleus\nX + Y1n\nk1\n− →2 Y1n\nKT\n−⇀↽− 2 Y1c + 2 Y2\nk2\n− →4 Y2\nk3\n− → ∅\nFigure 29: A example multi-compartmental model.\nFigure 29 illustrates the arrangement of compartments and reactions in the model LotkaVolterra tranport.47\nThe text of the SBML representation of the model is shown below, and it is followed by its complete48\ntranslation into ordinary diﬀerential equations. In this SBML model, the reaction equations are in substance49\nper time units. The reactions have also been simpliﬁed to reduce common stoichiometric factors. The species50\nvariables are in concentration units; their initial quantities are declared using the attribute initialAmount on51\nthe species deﬁnitions, but since the attribute hasOnlySubstanceUnits is not set to true, the identiﬁers of52\n112\nNature Precedings : hdl:10101/npre.2007.58.1 : Posted 18 Jun 2007\nthe species represent their concentrations when those identiﬁers appear in mathematical expressions elsewhere1\nin the model. Note that the species whose identiﬁer is “ X” is a boundary condition, as indicated by the2\nattribute boundaryCondition=“true” in its deﬁnition. The attribute speciesType=“Y” in the deﬁnitions3\nof “ Y1n” and “ Y1c” indicates that these species are pools of the same participant, but located in diﬀerent4\ncompartments.5\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>6\n<sbml xmlns=\"http://www.sbml.org/sbml/level2/version3\" level=\"2\" version=\"3\">7\n<model name=\"LotkaVolterra_tranport\">8\n<listOfUnitDefinitions>9\n<unitDefinition id=\"per_second\">10\n<listOfUnits>11\n<unit kind=\"second\" exponent=\"-1\"/>12\n</listOfUnits>13\n</unitDefinition>14\n<unitDefinition id=\"litre_per_mole_per_second\">15\n<listOfUnits>16\n<unit kind=\"mole\" exponent=\"-1\"/>17\n<unit kind=\"litre\" exponent=\"1\"/>18\n<unit kind=\"second\" exponent=\"-1\"/>19\n</listOfUnits>20\n</unitDefinition>21\n</listOfUnitDefinitions>22\n<listOfSpeciesTypes>23\n<speciesType id=\"Y1\"/>24\n</listOfSpeciesTypes>25\n<listOfCompartments>26\n<compartment id=\"cytoplasm\" size=\"5\"/>27\n<compartment id=\"nucleus\" outside=\"cytoplasm\" size=\"1\"/>28\n</listOfCompartments>29\n<listOfSpecies>30\n<species id=\"X\" compartment=\"nucleus\" initialAmount=\"1\" constant=\"true\"31\nboundaryCondition=\"true\"/>32\n<species id=\"Y1n\" compartment=\"nucleus\" speciesType=\"Y1\" initialAmount=\"1\"/>33\n<species id=\"Y1c\" compartment=\"cytoplasm\" speciesType=\"Y1\" initialAmount=\"0\"/>34\n<species id=\"Y2\" compartment=\"cytoplasm\" initialAmount=\"1\"/>35\n</listOfSpecies>36\n<listOfParameters>37\n<parameter id=\"k1\" value=\"2500\" units=\"litre_per_mole_per_second\"/>38\n<parameter id=\"k2\" value=\"2500\" units=\"litre_per_mole_per_second\"/>39\n<parameter id=\"KT\" value=\"25000\" units=\"per_second\"/>40\n<parameter id=\"k3\" value=\"2500\" units=\"per_second\"/>41\n</listOfParameters>42\n<listOfReactions>43\n<reaction id=\"production\" reversible=\"false\">44\n<listOfReactants>45\n<speciesReference species=\"X\"/>46\n<speciesReference species=\"Y1n\"/>47\n</listOfReactants>48\n<listOfProducts>49\n<speciesReference species=\"Y1n\"/>50\n<speciesReference species=\"Y1n\"/>51\n</listOfProducts>52\n<kineticLaw>53\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\">54\n<apply>55\n<times/>56\n<ci>nucleus</ci>57\n<ci>k1</ci>58\n<ci>X</ci>59\n<ci>Y1n</ci>60\n</apply>61\n</math>62\n</kineticLaw>63\n</reaction>64\n<reaction id=\"transport\" reversible=\"true\">65\n<listOfReactants>66\n<speciesReference species=\"Y1n\"/>67\n113\nNature Precedings : hdl:10101/npre.2007.58.1 : Posted 18 Jun 2007\n</listOfReactants>1\n<listOfProducts>2\n<speciesReference species=\"Y1c\"/>3\n</listOfProducts>4\n<kineticLaw>5\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\">6\n<apply>7\n<times/>8\n<ci>cytoplasm</ci>9\n<ci>KT</ci>10\n<apply>11\n<minus/>12\n<ci>Y1n</ci>13\n<ci>Y1c</ci>14\n</apply>15\n</apply>16\n</math>17\n</kineticLaw>18\n</reaction>19\n<reaction id=\"transformation\" reversible=\"false\">20\n<listOfReactants>21\n<speciesReference species=\"Y1c\"/>22\n<speciesReference species=\"Y2\"/>23\n</listOfReactants>24\n<listOfProducts>25\n<speciesReference species=\"Y2\" stoichiometry=\"2\"/>26\n</listOfProducts>27\n<kineticLaw>28\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\">29\n<apply>30\n<times/>31\n<ci>cytoplasm</ci>32\n<ci>k2</ci>33\n<ci>Y1c</ci>34\n<ci>Y2</ci>35\n</apply>36\n</math>37\n</kineticLaw>38\n</reaction>39\n<reaction id=\"degradation\" reversible=\"false\">40\n<listOfReactants>41\n<speciesReference species=\"Y2\"/>42\n</listOfReactants>43\n<kineticLaw>44\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\">45\n<apply>46\n<times/>47\n<ci>cytoplasm</ci>48\n<ci>k3</ci>49\n<ci>Y2</ci>50\n</apply>51\n</math>52\n</kineticLaw>53\n</reaction>54\n</listOfReactions>55\n</model>56\n</sbml>57\nThe ODE translation of this model is as follows. First, we give the values of the constant parameters:58\nk1 = 2500, k 2 = 2500, K 3 = 25000, K T = 250059\nNext, here are the initial conditions of the variables. The species variables X, Y1n, Y1c, and Y2 in the following60\nequations are all in terms of concentrations, and we use Vn to represent for the size of compartment “ nucleus”61\nand Vc to represent for the size of compartment “ cytoplasm”:62\nVn = 1, V c = 5, X = 1, Y 1n = 1, Y 1c = 0, Y 2 = 163\n114\nNature Precedings : hdl:10101/npre.2007.58.1 : Posted 18 Jun 2007\nAnd ﬁnally, here are the diﬀerential equations:1\ndX\ndt = 02\nVn\ndY1n\ndt = k1 · X · Y1n · Vn − KT · (Y1n − Y1c) · Vc reactions production and transport3\nVc\ndY1c\ndt = KT · (Y1n − Y1c) · Vc − k2 · Y1c · Y2 · Vc reactions transport and transformation4\nVc\ndY2\ndt = k2 · Y1c · Y2 · Vc − k3 · Y2 · Vc reactions transformation and degradation5\n6\nAs formulated here, this example assumes constant volumes. If the sizes of the compartments “ cytoplasm”7\nor “ nucleus” could change during simulation, then it would be preferable to use a diﬀerent approach to8\nconstructing the diﬀerential equations. In this alternative approach, the ODEs would compute substance9\nchange rather than concentration change, and the concentration values would be computed using separate10\nequations. This approach is used in Section 4.13.6.11\n7.8 Example involving function deﬁnitions12\nThis section contains a model that uses the function deﬁnition feature of SBML. Consider the following13\nhypothetical system:14\nS1\nf(S1)\n− − − →S215\nwhere16\nf(x) = 2 × x17\nThe following is the XML document that encodes the model shown above:18\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>19\n<sbml xmlns=\"http://www.sbml.org/sbml/level2/version3\" level=\"2\" version=\"3\">20\n<model id=\"Example\">21\n<listOfFunctionDefinitions>22\n<functionDefinition id=\"f\">23\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\">24\n<lambda>25\n<bvar>26\n<ci> x </ci>27\n</bvar>28\n<apply>29\n<times/>30\n<ci> x </ci>31\n<cn> 2 </cn>32\n</apply>33\n</lambda>34\n</math>35\n</functionDefinition>36\n</listOfFunctionDefinitions>37\n<listOfCompartments>38\n<compartment id=\"compartmentOne\" size=\"1\"/>39\n</listOfCompartments>40\n<listOfSpecies>41\n<species id=\"S1\" initialConcentration=\"1\" compartment=\"compartmentOne\"/>42\n<species id=\"S2\" initialConcentration=\"0\" compartment=\"compartmentOne\"/>43\n</listOfSpecies>44\n<listOfParameters>45\n<parameter id=\"t\" value = \"1\" units=\"second\"/>46\n</listOfParameters>47\n<listOfReactions>48\n<reaction id=\"reaction_1\" reversible=\"false\">49\n<listOfReactants>50\n115\nNature Precedings : hdl:10101/npre.2007.58.1 : Posted 18 Jun 2007\n<speciesReference species=\"S1\"/>1\n</listOfReactants>2\n<listOfProducts>3\n<speciesReference species=\"S2\"/>4\n</listOfProducts>5\n<kineticLaw>6\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\">7\n<apply>8\n<divide/>9\n<apply>10\n<times/>11\n<apply>12\n<ci> f </ci>13\n<ci> S1 </ci>14\n</apply>15\n<ci> compartmentOne </ci>16\n</apply>17\n<ci> t</ci>18\n</apply>19\n</math>20\n</kineticLaw>21\n</reaction>22\n</listOfReactions>23\n</model>24\n</sbml>25\n7.9 Example involving delay functions26\nThe following is a simple model illustrating the use of delay to represent a gene that suppresses its own27\nexpression. The model can be expressed in a single rule:28\ndP\ndt =\n1\n1 + m(Pdelayed)q − P\nτ\n29\nwhere30\nPdelayed is delay(P, ∆t) or P at t − ∆t\nP is protein concentration\nτ is the response time\nm is a multiplier or equilibrium constant\nq is the Hill coeﬃcient\n31\nand the species quantities are in concentration units. The text of an SBML encoding of this model is given32\nbelow:33\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>34\n<sbml xmlns=\"http://www.sbml.org/sbml/level2/version3\" level=\"2\" version=\"3\">35\n<model>36\n<listOfCompartments>37\n<compartment id=\"cell\" size=\"1\"/>38\n</listOfCompartments>39\n<listOfSpecies>40\n<species id=\"P\" compartment=\"cell\" initialConcentration=\"0\"/>41\n</listOfSpecies>42\n<listOfParameters>43\n<parameter id=\"tau\" value=\"1\" units=\"second\"/>44\n<parameter id=\"m\" value=\"0.5\" units=\"dimensionless\"/>45\n<parameter id=\"q\" value=\"1\" units=\"dimensionless\"/>46\n<parameter id=\"delta_t\" value=\"1\" units=\"second\"/>47\n</listOfParameters>48\n<listOfRules>49\n<rateRule variable=\"P\">50\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\">51\n<apply>52\n<divide/>53\n<apply>54\n116\nNature Precedings : hdl:10101/npre.2007.58.1 : Posted 18 Jun 2007\n<minus/>1\n<apply>2\n<divide/>3\n<cn> 1 </cn>4\n<apply>5\n<plus/>6\n<cn> 1 </cn>7\n<apply>8\n<times/>9\n<ci> m </ci>10\n<apply>11\n<power/>12\n<apply>13\n<csymbol encoding=\"text\"14\ndefinitionURL=\"http://www.sbml.org/sbml/symbols/delay\">15\ndelay16\n</csymbol>17\n<ci> P </ci>18\n<ci> delta_t </ci>19\n</apply>20\n<ci> q </ci>21\n</apply>22\n</apply>23\n</apply>24\n</apply>25\n<ci> P </ci>26\n</apply>27\n<ci> tau </ci>28\n</apply>29\n</math>30\n</rateRule>31\n</listOfRules>32\n</model>33\n</sbml>34\n7.10 Example involving events35\nThis section presents a simple model system that demonstrates the use of events in SBML. Consider a36\nsystem with two genes, G1 and G2. G1 is initially on and G2 is initially oﬀ. When turned on, the two genes37\nlead to the production of two products, P1 and P2, respectively, at a ﬁxed rate. When P1 reaches a given38\nconcentration, G2 switches on. This system can be represented mathematically as follows:39\ndP1\ndt = k1(G1 − P1)40\ndP2\ndt = k2(G2 − P2)41\nG2 =\n{\n0 when P1 ≤ τ,\n1 when P1 > τ.\n42\nThe initial values are:43\nG1 = 1, G 2 = 0, τ = 0.25, P 1 = 0, P 2 = 0, k1 = k2 = 1.44\nThe SBML Level 2 representation of this as follows:45\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>46\n<sbml xmlns=\"http://www.sbml.org/sbml/level2/version3\" level=\"2\" version=\"3\"47\nxmlns:math=\"http://www.w3.org/1998/Math/MathML\">48\n<model>49\n<listOfUnitDefinitions>50\n<unitDefinition id=\"per_second\">51\n<listOfUnits>52\n<unit kind=\"second\" exponent=\"-1\"/>53\n117\nNature Precedings : hdl:10101/npre.2007.58.1 : Posted 18 Jun 2007\n</listOfUnits>1\n</unitDefinition>2\n<unitDefinition id=\"concentration\">3\n<listOfUnits>4\n<unit kind=\"mole\"/>5\n<unit kind=\"litre\" exponent=\"-1\"/>6\n</listOfUnits>7\n</unitDefinition>8\n</listOfUnitDefinitions>9\n<listOfCompartments>10\n<compartment id=\"cell\" size=\"1\"/>11\n</listOfCompartments>12\n<listOfSpecies>13\n<species id=\"P1\" compartment=\"cell\" initialConcentration=\"0\"/>14\n<species id=\"P2\" compartment=\"cell\" initialConcentration=\"0\"/>15\n</listOfSpecies>16\n<listOfParameters>17\n<parameter id=\"k1\" value=\"1\" units=\"per_second\"/>18\n<parameter id=\"k2\" value=\"1\" units=\"per_second\" />19\n<parameter id=\"tau\" value=\"0.25\" units=\"concentration\"/>20\n<parameter id=\"G1\" value=\"1\" units=\"concentration\" constant=\"false\"/>21\n<parameter id=\"G2\" value=\"0\" units=\"concentration\" constant=\"false\"/>22\n</listOfParameters>23\n<listOfRules>24\n<rateRule variable=\"P1\">25\n<math:math>26\n<math:apply>27\n<math:times/>28\n<math:ci> k1 </math:ci>29\n<math:apply>30\n<math:minus/>31\n<math:ci> G1 </math:ci>32\n<math:ci> P1 </math:ci>33\n</math:apply>34\n</math:apply>35\n</math:math>36\n</rateRule>37\n<rateRule variable=\"P2\">38\n<math:math>39\n<math:apply>40\n<math:times/>41\n<math:ci> k2 </math:ci>42\n<math:apply>43\n<math:minus/>44\n<math:ci> G2 </math:ci>45\n<math:ci> P2 </math:ci>46\n</math:apply>47\n</math:apply>48\n</math:math>49\n</rateRule>50\n</listOfRules>51\n<listOfEvents>52\n<event>53\n<trigger>54\n<math:math>55\n<math:apply>56\n<math:gt/>57\n<math:ci> P1 </math:ci>58\n<math:ci> tau </math:ci>59\n</math:apply>60\n</math:math>61\n</trigger>62\n<listOfEventAssignments>63\n<eventAssignment variable=\"G2\">64\n<math:math>65\n<math:apply>66\n<math:cn> 1 </math:cn>67\n</math:apply>68\n</math:math>69\n118\nNature Precedings : hdl:10101/npre.2007.58.1 : Posted 18 Jun 2007\n</eventAssignment>1\n</listOfEventAssignments>2\n</event>3\n<event>4\n<trigger>5\n<math:math>6\n<math:apply>7\n<math:leq/>8\n<math:ci> P1 </math:ci>9\n<math:ci> tau </math:ci>10\n</math:apply>11\n</math:math>12\n</trigger>13\n<listOfEventAssignments>14\n<eventAssignment variable=\"G2\">15\n<math:math>16\n<math:apply>17\n<math:cn> 0 </math:cn>18\n</math:apply>19\n</math:math>20\n</eventAssignment>21\n</listOfEventAssignments>22\n</event>23\n</listOfEvents>24\n</model>25\n</sbml>26\n7.11 Example involving two-dimensional compartments27\nThe following example is a model that uses a two-dimensional compartment. It is a fragment of a larger model28\nof calcium regulation across the plasma membrane of a cell. The model includes a calcium inﬂux channel,29\n“Ca channel”, and a calcium-extruding PMCA pump, “ Ca Pump”. It also includes two cytosolic proteins30\nthat buﬀer calcium via the “ CalciumCalbindin gt BoundCytosol” and “ CalciumBuffer gt BoundCytosol”31\nreactions. Finally, the rate expressions in this model do not include explicit factors of the compartment32\nvolumes; instead, the various rate constants are assume to include any necessary corrections for volume.33\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>34\n<sbml xmlns=\"http://www.sbml.org/sbml/level2/version3\" level=\"2\" version=\"3\">35\n<model id=\"facilitated_ca_diffusion\">36\n<listOfUnitDefinitions>37\n<unitDefinition id=\"substance\">38\n<listOfUnits>39\n<unit kind=\"mole\" scale=\"-6\"/>40\n</listOfUnits>41\n</unitDefinition>42\n<unitDefinition id=\"area\">43\n<listOfUnits>44\n<unit kind=\"metre\" scale=\"-6\" exponent=\"2\"/>45\n</listOfUnits>46\n</unitDefinition>47\n<unitDefinition id=\"per_second\">48\n<listOfUnits>49\n<unit kind=\"second\" exponent=\"-1\"/>50\n</listOfUnits>51\n</unitDefinition>52\n<unitDefinition id=\"litre_per_mole_per_second\">53\n<listOfUnits>54\n<unit kind=\"mole\" exponent=\"-1\" scale=\"-6\"/>55\n<unit kind=\"litre\" exponent=\"1\"/>56\n<unit kind=\"second\" exponent=\"-1\"/>57\n</listOfUnits>58\n</unitDefinition>59\n<unitDefinition id=\"subs_per_vol\">60\n<listOfUnits>61\n<unit kind=\"mole\" exponent=\"1\" scale=\"-6\"/>62\n<unit kind=\"litre\" exponent=\"-1\"/>63\n</listOfUnits>64\n119\nNature Precedings : hdl:10101/npre.2007.58.1 : Posted 18 Jun 2007\n</unitDefinition>1\n</listOfUnitDefinitions>2\n<listOfCompartments>3\n<compartment id=\"Extracellular\"4\nspatialDimensions=\"3\" size=\"1\"/>5\n<compartment id=\"PlasmaMembrane\"6\noutside=\"Extracellular\" spatialDimensions=\"2\" size=\"1\"/>7\n<compartment id=\"Cytosol\"8\noutside=\"PlasmaMembrane\" spatialDimensions=\"3\" size=\"1\"/>9\n</listOfCompartments>10\n<listOfSpecies>11\n<species id=\"CaBPB_C\"12\ncompartment=\"Cytosol\" initialConcentration=\"47.17\"/>13\n<species id=\"B_C\"14\ncompartment=\"Cytosol\" initialConcentration=\"396.04\"/>15\n<species id=\"CaB_C\"16\ncompartment=\"Cytosol\" initialConcentration=\"3.96\"/>17\n<species id=\"Ca_C\"18\nname=\"Ca\" compartment=\"Cytosol\" initialConcentration=\"0.1\"/>19\n<species id=\"Ca_EC\"20\nname=\"Ca\" compartment=\"Extracellular\" initialConcentration=\"1000\"/>21\n<species id=\"CaCh_PM\"22\ncompartment=\"PlasmaMembrane\" initialConcentration=\"1\"/>23\n<species id=\"CaPump_PM\"24\ncompartment=\"PlasmaMembrane\" initialConcentration=\"1\"/>25\n<species id=\"CaBP_C\"26\ncompartment=\"Cytosol\" initialConcentration=\"202.83\"/>27\n</listOfSpecies>28\n<listOfReactions>29\n<reaction id=\"CalciumCalbindin_gt_BoundCytosol\" fast=\"true\">30\n<listOfReactants>31\n<speciesReference species=\"CaBP_C\"/>32\n<speciesReference species=\"Ca_C\"/>33\n</listOfReactants>34\n<listOfProducts>35\n<speciesReference species=\"CaBPB_C\"/>36\n</listOfProducts>37\n<kineticLaw>38\n<notes>39\n<p xmlns=\"http://www.w3.org/1999/xhtml\">40\n(((Kf_CalciumCalbindin_BoundCytosol * CaBP_C) * Ca_C) -41\n(Kr_CalciumCalbindin_BoundCytosol * CaBPB_C))42\n</p>43\n</notes>44\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\">45\n<apply>46\n<times/>47\n<ci> Cytosol </ci>48\n<apply>49\n<minus/>50\n<apply>51\n<times/>52\n<ci> Kf_CalciumCalbindin_BoundCytosol </ci>53\n<ci> CaBP_C </ci>54\n<ci> Ca_C </ci>55\n</apply>56\n<apply>57\n<times/>58\n<ci> Kr_CalciumCalbindin_BoundCytosol </ci>59\n<ci> CaBPB_C </ci>60\n</apply>61\n</apply>62\n</apply>63\n</math>64\n<listOfParameters>65\n<parameter id=\"Kf_CalciumCalbindin_BoundCytosol\" value=\"20.0\"66\nunits=\"litre_per_mole_per_second\"/>67\n<parameter id=\"Kr_CalciumCalbindin_BoundCytosol\" value=\"8.6\"68\nunits=\"per_second\"/>69\n120\nNature Precedings : hdl:10101/npre.2007.58.1 : Posted 18 Jun 2007\n</listOfParameters>1\n</kineticLaw>2\n</reaction>3\n<reaction id=\"CalciumBuffer_gt_BoundCytosol\" fast=\"true\">4\n<listOfReactants>5\n<speciesReference species=\"Ca_C\"/>6\n<speciesReference species=\"B_C\"/>7\n</listOfReactants>8\n<listOfProducts>9\n<speciesReference species=\"CaB_C\"/>10\n</listOfProducts>11\n<kineticLaw>12\n<notes>13\n<p xmlns=\"http://www.w3.org/1999/xhtml\">14\n(((Kf_CalciumBuffer_BoundCytosol * Ca_C) * B_C) -15\n(Kr_CalciumBuffer_BoundCytosol * CaB_C))16\n</p>17\n</notes>18\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\">19\n<apply>20\n<times/>21\n<ci> Cytosol</ci>22\n<apply>23\n<minus/>24\n<apply>25\n<times/>26\n<ci> Kf_CalciumBuffer_BoundCytosol </ci>27\n<ci> Ca_C </ci>28\n<ci> B_C </ci>29\n</apply>30\n<apply>31\n<times/>32\n<ci> Kr_CalciumBuffer_BoundCytosol </ci>33\n<ci> CaB_C </ci>34\n</apply>35\n</apply>36\n</apply>37\n</math>38\n<listOfParameters>39\n<parameter id=\"Kf_CalciumBuffer_BoundCytosol\" value=\"0.1\"40\nunits=\"litre_per_mole_per_second\"/>41\n<parameter id=\"Kr_CalciumBuffer_BoundCytosol\" value=\"1.0\"42\nunits=\"per_second\"/>43\n</listOfParameters>44\n</kineticLaw>45\n</reaction>46\n<reaction id=\"Ca_Pump\">47\n<listOfReactants>48\n<speciesReference species=\"Ca_C\"/>49\n</listOfReactants>50\n<listOfProducts>51\n<speciesReference species=\"Ca_EC\"/>52\n</listOfProducts>53\n<listOfModifiers>54\n<modifierSpeciesReference species=\"CaPump_PM\"/>55\n</listOfModifiers>56\n<kineticLaw>57\n<notes>58\n<p xmlns=\"http://www.w3.org/1999/xhtml\">59\n((Vmax * kP * ((Ca_C - Ca_Rest) / (Ca_C + kP)) /60\n(Ca_Rest + kP)) * CaPump_PM)61\n</p>62\n</notes>63\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\">64\n<apply>65\n<times/>66\n<ci> PlasmaMembrane</ci>67\n<apply>68\n<divide/>69\n121\nNature Precedings : hdl:10101/npre.2007.58.1 : Posted 18 Jun 2007\n<apply>1\n<times/>2\n<ci> Vmax </ci>3\n<ci> kP </ci>4\n<ci> CaPump_PM </ci>5\n<apply>6\n<minus/>7\n<ci> Ca_C </ci>8\n<ci> Ca_Rest </ci>9\n</apply>10\n</apply>11\n<apply>12\n<times/>13\n<apply>14\n<plus/>15\n<ci> Ca_C </ci>16\n<ci> kP </ci>17\n</apply>18\n<apply>19\n<plus/>20\n<ci> Ca_Rest </ci>21\n<ci> kP </ci>22\n</apply>23\n</apply>24\n</apply>25\n</apply>26\n</math>27\n<listOfParameters>28\n<parameter id=\"Vmax\" value=\"4000\" units=\"per_second\"/>29\n<parameter id=\"kP\" value=\"0.25\" units=\"subs_per_vol\"/>30\n<parameter id=\"Ca_Rest\" value=\"0.1\" units=\"subs_per_vol\"/>31\n</listOfParameters>32\n</kineticLaw>33\n</reaction>34\n<reaction id=\"Ca_channel\">35\n<listOfReactants>36\n<speciesReference species=\"Ca_EC\"/>37\n</listOfReactants>38\n<listOfProducts>39\n<speciesReference species=\"Ca_C\"/>40\n</listOfProducts>41\n<listOfModifiers>42\n<modifierSpeciesReference species=\"CaCh_PM\"/>43\n</listOfModifiers>44\n<kineticLaw>45\n<notes>46\n<p xmlns=\"http://www.w3.org/1999/xhtml\">47\n(J0 * Kc * (Ca_EC - Ca_C) / (Kc + Ca_C) * CaCh_PM)48\n</p>49\n</notes>50\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\">51\n<apply>52\n<times/>53\n<ci> PlasmaMembrane </ci>54\n<apply>55\n<divide/>56\n<apply>57\n<times/>58\n<ci> CaCh_PM </ci>59\n<ci> J0 </ci>60\n<ci> Kc </ci>61\n<apply>62\n<minus/>63\n<ci> Ca_EC </ci>64\n<ci> Ca_C </ci>65\n</apply>66\n</apply>67\n<apply>68\n<plus/>69\n122\nNature Precedings : hdl:10101/npre.2007.58.1 : Posted 18 Jun 2007\n<ci> Kc </ci>1\n<ci> Ca_C </ci>2\n</apply>3\n</apply>4\n</apply>5\n</math>6\n<listOfParameters>7\n<parameter id=\"J0\" value=\"0.014\" units=\"litre_per_mole_per_second\"/>8\n<parameter id=\"Kc\" value=\"0.5\" units=\"subs_per_vol\"/>9\n</listOfParameters>10\n</kineticLaw>11\n</reaction>12\n</listOfReactions>13\n</model>14\n</sbml>15\n123\nNature Precedings : hdl:10101/npre.2007.58.1 : Posted 18 Jun 2007\n8 Discussion1\nThe volume of data now emerging from molecular biotechnology leave little doubt that extensive computer-2\nbased modeling, simulation and analysis will be critical to understanding and interpreting the data ( Abbott,3\n1999; Gilman, 2000; Popel and Winslow , 1998; Smaglik, 2000). This has lead to an explosion in the develop-4\nment of computer tools by many research groups across the world. The explosive rate of progress is exciting,5\nbut the rapid growth of the ﬁeld is accompanied by problems and pressing needs.6\nOne problem is that simulation models and results often cannot be directly compared, shared or re-used,7\nbecause the tools developed by diﬀerent groups often are not compatible with each other. As the ﬁeld8\nof systems biology matures, researchers increasingly need to communicate their results as computational9\nmodels rather than box-and-arrow diagrams. They also need to reuse published and curated models as10\nlibrary components in order to succeed with large-scale eﬀorts (e.g., the Alliance for Cellular Signaling;11\nGilman, 2000; Smaglik, 2000). These needs require that models implemented in one software package be12\nportable to other software packages, to maximize public understanding and to allow building up libraries of13\ncurated computational models.14\nWe oﬀer SBML to the systems biology community as a suggested format for exchanging models between15\nsimulation/analysis tools. SBML is an open model representation language oriented speciﬁcally towards16\nrepresenting systems of biochemical reactions.17\nOur vision for SBML is to create an open standard that will enable diﬀerent software tools to exchange18\ncomputational models. SBML is not static; we continue to develop and experiment with it, and we interact19\nwith other groups who seek to develop similar markup languages. We plan on continuing to evolve SBML20\nwith the help of the systems biology community to make SBML increasingly more powerful, ﬂexible and21\nuseful.22\n8.1 Future enhancements: SBML Level 3 and beyond23\nMany people have expressed a desire to see additional capabilities added to SBML. The following summarizes24\nadditional features that are under consideration to be included in SBML Level 3; additional information is25\navailable in the wiki on the SBML project website ( http://sbml.org).26\n• Arrays. This will enable the creation of arrays of components (species, reactions, compartments and27\nsubmodels).28\n• Connections. This will be a mechanism for describing the connections between items in an array.29\n• Geometry. This will enable the encoding of the spatial characteristics of models including the ge-30\nometry of compartments, the diﬀusion properties of species and the speciﬁcation of diﬀerent species31\nconcentrations across diﬀerent regions of a cell.32\n• Model Composition. This will enable a large model to be built up out of instances of other models. It33\nwill also allow the reuse of model components and the creation of several instances of the same model.34\n• Multistate and Complex Species . This will allow the straight-forward construction of models involving35\nspecies with a large number of states or species composed of subcomponents. The representation36\nscheme would be designed to contain the combinatorial explosion of objects that often results from37\nthese types of models.38\n• Diagrams. This feature will allow components to be annotated with data to enable the display of the39\nmodel in a diagram.40\n• Dynamic Structure . This will enable model structure to vary during simulation. One aspect of this41\nallowing rules and reactions to have their eﬀect conditional on the state of the model system. For42\nexample in SBML Level 2 it is possible to create a rule with the eﬀect:43\nds\ndt =\n{\n0 if s > 0\ny otherwise\n44\n124\nNature Precedings : hdl:10101/npre.2007.58.1 : Posted 18 Jun 2007\nDynamic restructuring would enable the expression of the following example:1\nif s > 0 ds\ndt = y2\nwhere s is not determined by the rule when s ≤ 0.3\n• Tie-breaking algorithm. This will include a controlled vocabulary and associated attributes on models4\nto indicate the simultaneous event tie-breaking algorithm required to correctly simulate the model.5\n• Distributions. This will provide a means of specifying random variables and statistical distribution of6\nvalues.7\n125\nNature Precedings : hdl:10101/npre.2007.58.1 : Posted 18 Jun 2007\nAcknowledgments1\nThis document beneﬁted from repeated reviews and feedback by many people. We give special thanks2\nto James Schaﬀ, Martin Ginkel, Sven Sahle, Ralph Gauges, Ion Moraru, Rainer Machn´ e, Robert Phair,3\nBen Bornstein, Bruce Shapiro, Maria Schilstra, and Herbert Sauro for critical discussions of many issues,4\nincluding the implementation of software supporting SBML and the simulation of models.5\nThe development of SBML was originally funded entirely by the Japan Science and Technology Agency6\n(JST) under the ERATO Kitano Symbiotic Systems Project during the years 2000–2003. The principal7\ninvestigators were Hiroaki Kitano and John C. Doyle. The original SBML Team was lead by Hamid Bolouri8\nand consisted of Hamid Bolouri, Andrew Finney, Herbert Sauro, and Michael Hucka.9\nWe gratefully acknowledge sponsorship from many funding agencies. Support for the continued development10\nof SBML and associated software, meetings and activities comes from the following sources: the National11\nInstitute of General Medical Sciences (USA) via grant numbers GM070923 and GM077671; the National12\nHuman Genome Research Institute (USA); the International Joint Research Program of NEDO (Japan);13\nthe JST ERATO-SORST Program (Japan); the Japanese Ministry of Agriculture; the Japanese Ministry14\nof Education, Culture, Sports, Science and Technology; the BBSRC e-Science Initiative (UK); the DARPA15\nIPTO Bio-Computation Program (USA); and the Air Force Oﬃce of Scientiﬁc Research (USA). Additional16\nsupport has been or continues to be provided by the California Institute of Technology (USA), the University17\nof Hertfordshire (UK), the Molecular Sciences Institute (USA), and the Systems Biology Institute (Japan).18\nSBML was ﬁrst conceived at the JST/ERATO-sponsored First Workshop on Software Platforms for Systems19\nBiology, held in April, 2000, at the California Institute of Technology in Pasadena, California, USA. The20\nparticipants collectively decided to begin developing a common XML-based declarative language for repre-21\nsenting models. A draft version of the Systems Biology Markup Language was developed by the Caltech22\nERATO team and delivered to all collaborators in August, 2000. This draft version underwent extensive23\ndiscussion over mailing lists and then again during the Second Workshop on Software Platforms for Systems24\nBiology held in Tokyo, Japan, November 2000. A revised version of SBML was issued by the Caltech ERATO25\nteam in December, 2000, and after further discussions over mailing lists and in meetings, we produced a26\nspeciﬁcation for SBML Level 1 ( Hucka et al. , 2001).27\nSBML Level 2 was conceived at the 5th Workshop on Software Platforms for Systems Biology , held in July28\n2002, at the University of Hertfordshire, UK. The participants collectively decided to revise the form of29\nSBML in SBML Level 2. The ﬁrst draft of the Level 2 Version 1 document was released in August 2002. The30\nﬁnal set of features in SBML Level 2 Version 1 was ﬁnalized in May 2003 at the 7th Workshop on Software31\nPlatforms for Systems Biology in Ft. Lauderdale, Florida. SBML Level 2 Version 2 was largely ﬁnalized32\nafter the 2005 SBML Forum meeting in Boston and a ﬁnal document was issued in September 2006.33\nSBML Level 2 Version 3 was ﬁnalized after the 2006 SBML Forum meeting in Yokohama, Japan, and the 200734\nSBML Hackathon in Newcastle, UK. It was developed with contributions from so many people constituting35\nthe worldwide SBML Forum that we regret it has become infeasible to list individuals by name. We are36\ngrateful to everyone on the sbml-discuss@caltech.edu and libsbml-discuss@caltech.edu mailing lists,37\nthe creators of CellML ( Hedley et al. , 2001), the members of the DARPA Bio-SPICE project, and the au-38\nthors of the following software systems: BALSA, BASIS, BIOCHAM, BioCharon, ByoDyn, BioCyc, BioGrid,39\nBioModels, BioNetGen, BioPathwise, Bio Sketch Pad , BioSens, BioSPICE Dashboard , BioSpreadsheet,40\nBioTapestry, BioUML, BSTLab, CADLIVE, CellDesigner, Cellerator, CellML2SBML, Cellware, CL-SBML,41\nCLEML, COPASI, Cyto-Sim, Cytoscape, DBsolve, Dizzy, E-CELL, ecellJ, ESS, FluxAnalyzer, Fluxor,42\nGepasi, Gillespie2, HSMB, HybridSBML, INSILICO discovery , JACOBIAN, Jarnac, JDesigner, JigCell,43\nJSim, JWS Online , KEGG2SBML, Kineticon, libSBML, MathSBML, MIRIAM, MesoRD, MetaFluxNet,44\nMMT2, Modesto, Moleculizer, Monod, Narrator, NetBuilder, Oscill8, PANTHER Pathway, PathArt,45\nPathway Analyzer, PathwayLab, PathScout, Pathway Tools, PathwayBuilder, PATIKAweb, PaVESy, PET,46\nPNK, PottersWheel, Reactome, ProcessDB, PROTON, pysbml, PySCeS, RSBML, runSBML, SABIO-RK,47\nSBML ODE Solver , SBML-PET, SBMLeditor, SBMLmerge, SBMLR, SBMLSim, SBMLToolbox, SBliD,48\nSBO, SBToolbox, SBW, SCIpath, Sigmoid, SigPath, SigTran, SIMBA, SimBiology, Simpathica, SimPheny,49\nSimWiz, SloppyCell, SmartCell, SRS Pathway Editor , StochSim, StochKit, STOCKS, TERANODE Suite ,50\nTrelis, VANTED, Virtual Cell , WebCell, WinSCAMP, Xholon, and XPPAUT.51\n126\nNature Precedings : hdl:10101/npre.2007.58.1 : Posted 18 Jun 2007\nA XML Schema for SBML1\nThe following is an XML Schema deﬁnition for SBML Level 2 Version 3, using the W3C Recommendation2\nfor XML Schema version 1.0 of 2 May 2001 ( Biron and Malhotra , 2000; Fallside, 2000; Thompson et al. ,3\n2000). This Schema does not deﬁne all aspects of SBML Level 2: an SBML document validated by this4\nschema is not necessarily a valid SBML Level 2 document. Appendix B contains a a schema for the SBML5\nMathML subset. Appendix C contains a list of the remaining checks required to validate a model in addition6\nto making it consistent with these two schemas.7\nNote to implementors: the following schema is self-contained and makes reference to the oﬃcial XML Schema8\nfor MathML hosted at the W3. However, for use in software systems, it is more eﬃcient to store the MathML9\nsubset Schema of Appendix B in a ﬁle on a user’s local disk, and change the schemaLocation value on line10\n27 below to refer to this local copy of the MathML subset Schema. Doing so will avoid requiring a network11\naccess every time this SBML Schema is used.12\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>13\n<xsd:schema targetNamespace=\"http://www.sbml.org/sbml/level2/version3\"14\nxmlns=\"http://www.sbml.org/sbml/level2/version3\"15\nxmlns:mml=\"http://www.w3.org/1998/Math/MathML\"16\nxmlns:xlink=\"http://www.w3.org/1999/xlink\"17\nxmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"18\nxmlns:xsd=\"http://www.w3.org/2001/XMLSchema\"19\nelementFormDefault=\"qualified\"20\nattributeFormDefault=\"unqualified\"21\nversion=\"$ $Id: sbml.xsd,v 1.3 2007/03/14 22:23:43 mhucka Exp $ $\">22\n<xsd:import namespace=\"http://www.w3.org/1998/Math/MathML\"23\nschemaLocation=\"http://www.w3.org/Math/XMLSchema/mathml2/mathml2.xsd\"/>24\n<xsd:annotation>25\n<xsd:documentation>26\n* Filename : sbml.xsd27\n* Description: XML Schema for SBML Level 2 Version 3.28\n* Author(s) : Michael Hucka29\n* Revision : $ $Id: sbml.xsd,v 1.3 2007/03/14 22:23:43 mhucka Exp $ $30\n* $ $Source: /cvsroot/sbml/specifications/sbml-level-2/version-3/schema/sbml.xsd,v $ $31\n*32\n* Copyright 2007 California Institute of Technology.33\n* Copyright 2003-2006 California Institute of Technology, the Japan Science34\n* and Technology Corporation, and the University of Hertfordshire.35\n*36\n* This software is licensed according to the terms described in the file37\n* named \"LICENSE.txt\" included with this distribution and available38\n* online at http://sbml.org/xml-schemas/LICENSE.txt39\n</xsd:documentation>40\n</xsd:annotation>41\n<!--The definition of new primitive types follows.-->42\n<xsd:simpleType name=\"SId\">43\n<xsd:annotation>44\n<xsd:documentation>The type SId is used throughout SBML as the45\ntype of the ’id’ attributes on model elements.</xsd:documentation>46\n</xsd:annotation>47\n<xsd:restriction base=\"xsd:string\">48\n<xsd:pattern value=\"(_|[a-z]|[A-Z])(_|[a-z]|[A-Z]|[0-9])*\"/>49\n</xsd:restriction>50\n</xsd:simpleType>51\n<xsd:simpleType name=\"UnitSId\">52\n<xsd:annotation>53\n<xsd:documentation>The type UnitSId is used to refer to units.</xsd:documentation>54\n</xsd:annotation>55\n<xsd:union>56\n<xsd:simpleType>57\n<xsd:restriction base=\"SId\" />58\n</xsd:simpleType>59\n<xsd:simpleType>60\n<xsd:restriction base=\"SId\">61\n<xsd:enumeration value=\"ampere\"/>62\n<xsd:enumeration value=\"becquerel\"/>63\n<xsd:enumeration value=\"candela\"/>64\n<xsd:enumeration value=\"coulomb\"/>65\n<xsd:enumeration value=\"dimensionless\"/>66\n<xsd:enumeration value=\"farad\"/>67\n<xsd:enumeration value=\"gram\"/>68\n<xsd:enumeration value=\"gray\"/>69\n<xsd:enumeration value=\"henry\"/>70\n<xsd:enumeration value=\"hertz\"/>71\n127\nNature Precedings : hdl:10101/npre.2007.58.1 : Posted 18 Jun 2007\n<xsd:enumeration value=\"item\"/>1\n<xsd:enumeration value=\"joule\"/>2\n<xsd:enumeration value=\"katal\"/>3\n<xsd:enumeration value=\"kelvin\"/>4\n<xsd:enumeration value=\"kilogram\"/>5\n<xsd:enumeration value=\"litre\"/>6\n<xsd:enumeration value=\"lumen\"/>7\n<xsd:enumeration value=\"lux\"/>8\n<xsd:enumeration value=\"metre\"/>9\n<xsd:enumeration value=\"mole\"/>10\n<xsd:enumeration value=\"newton\"/>11\n<xsd:enumeration value=\"ohm\"/>12\n<xsd:enumeration value=\"pascal\"/>13\n<xsd:enumeration value=\"radian\"/>14\n<xsd:enumeration value=\"second\"/>15\n<xsd:enumeration value=\"siemens\"/>16\n<xsd:enumeration value=\"sievert\"/>17\n<xsd:enumeration value=\"steradian\"/>18\n<xsd:enumeration value=\"tesla\"/>19\n<xsd:enumeration value=\"volt\"/>20\n<xsd:enumeration value=\"watt\"/>21\n<xsd:enumeration value=\"weber\"/>22\n</xsd:restriction>23\n</xsd:simpleType>24\n<xsd:simpleType>25\n<xsd:restriction base=\"SId\">26\n<xsd:enumeration value=\"substance\"/>27\n<xsd:enumeration value=\"volume\"/>28\n<xsd:enumeration value=\"area\"/>29\n<xsd:enumeration value=\"length\"/>30\n<xsd:enumeration value=\"time\"/>31\n</xsd:restriction>32\n</xsd:simpleType>33\n</xsd:union>34\n</xsd:simpleType>35\n<xsd:simpleType name=\"SBOTerm\">36\n<xsd:annotation>37\n<xsd:documentation>The data type for sboTerm attribute values.</xsd:documentation>38\n</xsd:annotation>39\n<xsd:restriction base=\"xsd:string\">40\n<xsd:pattern value=\"(SBO:)([0-9]7)\"/>41\n</xsd:restriction>42\n</xsd:simpleType>43\n<!--The definition of SBase follows.-->44\n<xsd:complexType name=\"SBase\" abstract=\"true\">45\n<xsd:annotation>46\n<xsd:documentation>The SBase type is the base type of all main47\ncomponents in SBML. It supports attaching metadata, notes and48\nannotations to components.</xsd:documentation>49\n</xsd:annotation>50\n<xsd:sequence>51\n<xsd:element name=\"notes\" minOccurs=\"0\">52\n<xsd:complexType>53\n<xsd:sequence>54\n<xsd:any namespace=\"http://www.w3.org/1999/xhtml\"55\nprocessContents=\"skip\"56\nminOccurs=\"0\" maxOccurs=\"unbounded\"/>57\n</xsd:sequence>58\n</xsd:complexType>59\n</xsd:element>60\n<xsd:element name=\"annotation\" minOccurs=\"0\">61\n<xsd:complexType>62\n<xsd:sequence>63\n<xsd:any processContents=\"skip\"64\nminOccurs=\"0\" maxOccurs=\"unbounded\"/>65\n</xsd:sequence>66\n</xsd:complexType>67\n</xsd:element>68\n</xsd:sequence>69\n<xsd:attribute name=\"metaid\" type=\"xsd:ID\" use=\"optional\"/>70\n<xsd:attribute name=\"sboTerm\" type=\"SBOTerm\" use=\"optional\"/>71\n</xsd:complexType>72\n<!--The definition of main SBML classes follows.-->73\n<xsd:complexType name=\"FunctionDefinition\">74\n<xsd:complexContent>75\n<xsd:extension base=\"SBase\">76\n<xsd:sequence>77\n<xsd:element ref=\"mml:math\"/>78\n</xsd:sequence>79\n<xsd:attribute name=\"id\" type=\"SId\" use=\"required\"/>80\n128\nNature Precedings : hdl:10101/npre.2007.58.1 : Posted 18 Jun 2007\n<xsd:attribute name=\"name\" type=\"xsd:string\" use=\"optional\"/>1\n</xsd:extension>2\n</xsd:complexContent>3\n</xsd:complexType>4\n<xsd:complexType name=\"Unit\">5\n<xsd:complexContent>6\n<xsd:extension base=\"SBase\">7\n<xsd:attribute name=\"kind\" type=\"UnitSId\" use=\"required\"/>8\n<xsd:attribute name=\"exponent\" type=\"xsd:int\" default=\"1\"/>9\n<xsd:attribute name=\"scale\" type=\"xsd:int\" default=\"0\"/>10\n<xsd:attribute name=\"multiplier\" type=\"xsd:double\" default=\"1\"/>11\n</xsd:extension>12\n</xsd:complexContent>13\n</xsd:complexType>14\n<xsd:complexType name=\"ListOfUnits\">15\n<xsd:complexContent>16\n<xsd:extension base=\"SBase\">17\n<xsd:sequence>18\n<xsd:element name=\"unit\" type=\"Unit\" maxOccurs=\"unbounded\"/>19\n</xsd:sequence>20\n</xsd:extension>21\n</xsd:complexContent>22\n</xsd:complexType>23\n<xsd:complexType name=\"UnitDefinition\">24\n<xsd:complexContent>25\n<xsd:extension base=\"SBase\">26\n<xsd:sequence>27\n<xsd:element name=\"listOfUnits\" type=\"ListOfUnits\"/>28\n</xsd:sequence>29\n<xsd:attribute name=\"id\" type=\"UnitSId\" use=\"required\"/>30\n<xsd:attribute name=\"name\" type=\"xsd:string\" use=\"optional\"/>31\n</xsd:extension>32\n</xsd:complexContent>33\n</xsd:complexType>34\n<xsd:complexType name=\"CompartmentType\">35\n<xsd:complexContent>36\n<xsd:extension base=\"SBase\">37\n<xsd:attribute name=\"id\" type=\"SId\" use=\"required\"/>38\n<xsd:attribute name=\"name\" type=\"xsd:string\" use=\"optional\"/>39\n</xsd:extension>40\n</xsd:complexContent>41\n</xsd:complexType>42\n<xsd:complexType name=\"SpeciesType\">43\n<xsd:complexContent>44\n<xsd:extension base=\"SBase\">45\n<xsd:attribute name=\"id\" type=\"SId\" use=\"required\"/>46\n<xsd:attribute name=\"name\" type=\"xsd:string\" use=\"optional\"/>47\n</xsd:extension>48\n</xsd:complexContent>49\n</xsd:complexType>50\n<xsd:complexType name=\"Compartment\">51\n<xsd:complexContent>52\n<xsd:extension base=\"SBase\">53\n<xsd:attribute name=\"id\" type=\"SId\" use=\"required\"/>54\n<xsd:attribute name=\"name\" type=\"xsd:string\" use=\"optional\"/>55\n<xsd:attribute name=\"compartmentType\" type=\"SId\" use=\"optional\"/>56\n<xsd:attribute name=\"spatialDimensions\" use=\"optional\" default=\"3\">57\n<xsd:simpleType>58\n<xsd:restriction base=\"xsd:int\">59\n<xsd:minInclusive value=\"0\"/>60\n<xsd:maxInclusive value=\"3\"/>61\n</xsd:restriction>62\n</xsd:simpleType>63\n</xsd:attribute>64\n<xsd:attribute name=\"size\" type=\"xsd:double\" use=\"optional\"/>65\n<xsd:attribute name=\"units\" type=\"UnitSId\" use=\"optional\"/>66\n<xsd:attribute name=\"outside\" type=\"SId\" use=\"optional\"/>67\n<xsd:attribute name=\"constant\" type=\"xsd:boolean\"68\nuse=\"optional\" default=\"true\"/>69\n</xsd:extension>70\n</xsd:complexContent>71\n</xsd:complexType>72\n<xsd:complexType name=\"Species\">73\n<xsd:complexContent>74\n<xsd:extension base=\"SBase\">75\n<xsd:attribute name=\"id\" type=\"SId\" use=\"required\"/>76\n<xsd:attribute name=\"name\" type=\"xsd:string\" use=\"optional\"/>77\n<xsd:attribute name=\"speciesType\" type=\"SId\" use=\"optional\"/>78\n<xsd:attribute name=\"compartment\" type=\"SId\" use=\"required\"/>79\n<xsd:attribute name=\"initialAmount\" type=\"xsd:double\" use=\"optional\"/>80\n129\nNature Precedings : hdl:10101/npre.2007.58.1 : Posted 18 Jun 2007\n<xsd:attribute name=\"initialConcentration\" type=\"xsd:double\" use=\"optional\"/>1\n<xsd:attribute name=\"substanceUnits\" type=\"UnitSId\" use=\"optional\"/>2\n<xsd:attribute name=\"hasOnlySubstanceUnits\" type=\"xsd:boolean\"3\nuse=\"optional\" default=\"false\"/>4\n<xsd:attribute name=\"boundaryCondition\" type=\"xsd:boolean\"5\nuse=\"optional\" default=\"false\"/>6\n<xsd:attribute name=\"charge\" type=\"xsd:int\" use=\"optional\"/>7\n<xsd:attribute name=\"constant\" type=\"xsd:boolean\"8\nuse=\"optional\" default=\"false\"/>9\n</xsd:extension>10\n</xsd:complexContent>11\n</xsd:complexType>12\n<xsd:complexType name=\"Parameter\">13\n<xsd:complexContent>14\n<xsd:extension base=\"SBase\">15\n<xsd:attribute name=\"id\" type=\"SId\" use=\"required\"/>16\n<xsd:attribute name=\"name\" type=\"xsd:string\" use=\"optional\"/>17\n<xsd:attribute name=\"value\" type=\"xsd:double\" use=\"optional\"/>18\n<xsd:attribute name=\"units\" type=\"UnitSId\" use=\"optional\"/>19\n<xsd:attribute name=\"constant\" type=\"xsd:boolean\"20\nuse=\"optional\" default=\"true\"/>21\n</xsd:extension>22\n</xsd:complexContent>23\n</xsd:complexType>24\n<xsd:complexType name=\"ListOfParameters\">25\n<xsd:complexContent>26\n<xsd:extension base=\"SBase\">27\n<xsd:sequence>28\n<xsd:element name=\"parameter\" type=\"Parameter\" maxOccurs=\"unbounded\"/>29\n</xsd:sequence>30\n</xsd:extension>31\n</xsd:complexContent>32\n</xsd:complexType>33\n<xsd:complexType name=\"InitialAssignment\">34\n<xsd:complexContent>35\n<xsd:extension base=\"SBase\">36\n<xsd:sequence>37\n<xsd:element ref=\"mml:math\"/>38\n</xsd:sequence>39\n<xsd:attribute name=\"symbol\" type=\"SId\" use=\"required\"/>40\n</xsd:extension>41\n</xsd:complexContent>42\n</xsd:complexType>43\n<xsd:complexType name=\"Rule\" abstract=\"true\">44\n<xsd:complexContent>45\n<xsd:extension base=\"SBase\">46\n<xsd:sequence>47\n<xsd:element ref=\"mml:math\"/>48\n</xsd:sequence>49\n</xsd:extension>50\n</xsd:complexContent>51\n</xsd:complexType>52\n<xsd:complexType name=\"AlgebraicRule\">53\n<xsd:complexContent>54\n<xsd:extension base=\"Rule\"/>55\n</xsd:complexContent>56\n</xsd:complexType>57\n<xsd:complexType name=\"AssignmentRule\">58\n<xsd:complexContent>59\n<xsd:extension base=\"Rule\">60\n<xsd:attribute name=\"variable\" type=\"SId\" use=\"required\"/>61\n</xsd:extension>62\n</xsd:complexContent>63\n</xsd:complexType>64\n<xsd:complexType name=\"RateRule\">65\n<xsd:complexContent>66\n<xsd:extension base=\"Rule\">67\n<xsd:attribute name=\"variable\" type=\"SId\" use=\"required\"/>68\n</xsd:extension>69\n</xsd:complexContent>70\n</xsd:complexType>71\n<xsd:complexType name=\"Constraint\">72\n<xsd:complexContent>73\n<xsd:extension base=\"SBase\">74\n<xsd:sequence>75\n<xsd:element ref=\"mml:math\"/>76\n<xsd:element name=\"message\" minOccurs=\"0\">77\n<xsd:complexType>78\n<xsd:sequence>79\n<xsd:any namespace=\"http://www.w3.org/1999/xhtml\"80\n130\nNature Precedings : hdl:10101/npre.2007.58.1 : Posted 18 Jun 2007\nprocessContents=\"skip\"1\nminOccurs=\"0\" maxOccurs=\"unbounded\"/>2\n</xsd:sequence>3\n</xsd:complexType>4\n</xsd:element>5\n</xsd:sequence>6\n</xsd:extension>7\n</xsd:complexContent>8\n</xsd:complexType>9\n<xsd:complexType name=\"KineticLaw\">10\n<xsd:complexContent>11\n<xsd:extension base=\"SBase\">12\n<xsd:sequence>13\n<xsd:element ref=\"mml:math\"/>14\n<xsd:element name=\"listOfParameters\" type=\"ListOfParameters\" minOccurs=\"0\"/>15\n</xsd:sequence>16\n</xsd:extension>17\n</xsd:complexContent>18\n</xsd:complexType>19\n<xsd:complexType name=\"SimpleSpeciesReference\" abstract=\"true\">20\n<xsd:complexContent>21\n<xsd:extension base=\"SBase\">22\n<xsd:attribute name=\"id\" type=\"SId\" use=\"optional\"/>23\n<xsd:attribute name=\"name\" type=\"xsd:string\" use=\"optional\"/>24\n<xsd:attribute name=\"species\" type=\"SId\" use=\"required\"/>25\n</xsd:extension>26\n</xsd:complexContent>27\n</xsd:complexType>28\n<xsd:complexType name=\"ModifierSpeciesReference\">29\n<xsd:complexContent>30\n<xsd:extension base=\"SimpleSpeciesReference\"/>31\n</xsd:complexContent>32\n</xsd:complexType>33\n<xsd:complexType name=\"ListOfModifierSpeciesReferences\">34\n<xsd:complexContent>35\n<xsd:extension base=\"SBase\">36\n<xsd:sequence>37\n<xsd:element name=\"modifierSpeciesReference\"38\ntype=\"ModifierSpeciesReference\"39\nmaxOccurs=\"unbounded\"/>40\n</xsd:sequence>41\n</xsd:extension>42\n</xsd:complexContent>43\n</xsd:complexType>44\n<xsd:complexType name=\"StoichiometryMath\">45\n<xsd:complexContent>46\n<xsd:extension base=\"SBase\">47\n<xsd:sequence>48\n<xsd:element ref=\"mml:math\"/>49\n</xsd:sequence>50\n</xsd:extension>51\n</xsd:complexContent>52\n</xsd:complexType>53\n<xsd:complexType name=\"SpeciesReference\">54\n<xsd:complexContent>55\n<xsd:extension base=\"SimpleSpeciesReference\">56\n<xsd:sequence>57\n<xsd:element name=\"stoichiometryMath\"58\ntype=\"StoichiometryMath\"59\nminOccurs=\"0\"/>60\n</xsd:sequence>61\n<xsd:attribute name=\"stoichiometry\" type=\"xsd:double\"62\nuse=\"optional\" default=\"1\"/>63\n</xsd:extension>64\n</xsd:complexContent>65\n</xsd:complexType>66\n<xsd:complexType name=\"ListOfSpeciesReferences\">67\n<xsd:complexContent>68\n<xsd:extension base=\"SBase\">69\n<xsd:sequence>70\n<xsd:element name=\"speciesReference\"71\ntype=\"SpeciesReference\"72\nmaxOccurs=\"unbounded\"/>73\n</xsd:sequence>74\n</xsd:extension>75\n</xsd:complexContent>76\n</xsd:complexType>77\n<xsd:complexType name=\"Reaction\">78\n<xsd:complexContent>79\n<xsd:extension base=\"SBase\">80\n131\nNature Precedings : hdl:10101/npre.2007.58.1 : Posted 18 Jun 2007\n<xsd:sequence>1\n<xsd:element name=\"listOfReactants\" type=\"ListOfSpeciesReferences\"2\nminOccurs=\"0\"/>3\n<xsd:element name=\"listOfProducts\" type=\"ListOfSpeciesReferences\"4\nminOccurs=\"0\"/>5\n<xsd:element name=\"listOfModifiers\" type=\"ListOfModifierSpeciesReferences\"6\nminOccurs=\"0\"/>7\n<xsd:element name=\"kineticLaw\" type=\"KineticLaw\"8\nminOccurs=\"0\"/>9\n</xsd:sequence>10\n<xsd:attribute name=\"id\" type=\"SId\" use=\"required\"/>11\n<xsd:attribute name=\"name\" type=\"xsd:string\" use=\"optional\"/>12\n<xsd:attribute name=\"reversible\" type=\"xsd:boolean\"13\nuse=\"optional\" default=\"true\"/>14\n<xsd:attribute name=\"fast\" type=\"xsd:boolean\"15\nuse=\"optional\" default=\"false\"/>16\n</xsd:extension>17\n</xsd:complexContent>18\n</xsd:complexType>19\n<xsd:complexType name=\"EventAssignment\">20\n<xsd:complexContent>21\n<xsd:extension base=\"SBase\">22\n<xsd:sequence>23\n<xsd:element ref=\"mml:math\"/>24\n</xsd:sequence>25\n<xsd:attribute name=\"variable\" type=\"SId\" use=\"required\"/>26\n</xsd:extension>27\n</xsd:complexContent>28\n</xsd:complexType>29\n<xsd:complexType name=\"ListOfEventAssignments\">30\n<xsd:complexContent>31\n<xsd:extension base=\"SBase\">32\n<xsd:sequence>33\n<xsd:element name=\"eventAssignment\"34\ntype=\"EventAssignment\"35\nmaxOccurs=\"unbounded\"/>36\n</xsd:sequence>37\n</xsd:extension>38\n</xsd:complexContent>39\n</xsd:complexType>40\n<xsd:complexType name=\"Trigger\">41\n<xsd:complexContent>42\n<xsd:extension base=\"SBase\">43\n<xsd:sequence>44\n<xsd:element ref=\"mml:math\"/>45\n</xsd:sequence>46\n</xsd:extension>47\n</xsd:complexContent>48\n</xsd:complexType>49\n<xsd:complexType name=\"Delay\">50\n<xsd:complexContent>51\n<xsd:extension base=\"SBase\">52\n<xsd:sequence>53\n<xsd:element ref=\"mml:math\"/>54\n</xsd:sequence>55\n</xsd:extension>56\n</xsd:complexContent>57\n</xsd:complexType>58\n<xsd:complexType name=\"Event\">59\n<xsd:complexContent>60\n<xsd:extension base=\"SBase\">61\n<xsd:sequence>62\n<xsd:element name=\"trigger\" type=\"Trigger\"/>63\n<xsd:element name=\"delay\" type=\"Delay\" minOccurs=\"0\"/>64\n<xsd:element name=\"listOfEventAssignments\" type=\"ListOfEventAssignments\"/>65\n</xsd:sequence>66\n<xsd:attribute name=\"id\" type=\"SId\" use=\"optional\"/>67\n<xsd:attribute name=\"name\" type=\"xsd:string\" use=\"optional\"/>68\n</xsd:extension>69\n</xsd:complexContent>70\n</xsd:complexType>71\n<xsd:complexType name=\"Model\">72\n<xsd:complexContent>73\n<xsd:extension base=\"SBase\">74\n<xsd:sequence>75\n<xsd:element name=\"listOfFunctionDefinitions\" minOccurs=\"0\">76\n<xsd:complexType>77\n<xsd:complexContent>78\n<xsd:extension base=\"SBase\">79\n<xsd:sequence>80\n132\nNature Precedings : hdl:10101/npre.2007.58.1 : Posted 18 Jun 2007\n<xsd:element name=\"functionDefinition\"1\ntype=\"FunctionDefinition\"2\nmaxOccurs=\"unbounded\"/>3\n</xsd:sequence>4\n</xsd:extension>5\n</xsd:complexContent>6\n</xsd:complexType>7\n</xsd:element>8\n<xsd:element name=\"listOfUnitDefinitions\" minOccurs=\"0\">9\n<xsd:complexType>10\n<xsd:complexContent>11\n<xsd:extension base=\"SBase\">12\n<xsd:sequence>13\n<xsd:element name=\"unitDefinition\"14\ntype=\"UnitDefinition\"15\nmaxOccurs=\"unbounded\"/>16\n</xsd:sequence>17\n</xsd:extension>18\n</xsd:complexContent>19\n</xsd:complexType>20\n</xsd:element>21\n<xsd:element name=\"listOfCompartmentTypes\" minOccurs=\"0\">22\n<xsd:complexType>23\n<xsd:complexContent>24\n<xsd:extension base=\"SBase\">25\n<xsd:sequence>26\n<xsd:element name=\"compartmentType\"27\ntype=\"CompartmentType\"28\nmaxOccurs=\"unbounded\"/>29\n</xsd:sequence>30\n</xsd:extension>31\n</xsd:complexContent>32\n</xsd:complexType>33\n</xsd:element>34\n<xsd:element name=\"listOfSpeciesTypes\" minOccurs=\"0\">35\n<xsd:complexType>36\n<xsd:complexContent>37\n<xsd:extension base=\"SBase\">38\n<xsd:sequence>39\n<xsd:element name=\"speciesType\"40\ntype=\"SpeciesType\"41\nmaxOccurs=\"unbounded\"/>42\n</xsd:sequence>43\n</xsd:extension>44\n</xsd:complexContent>45\n</xsd:complexType>46\n</xsd:element>47\n<xsd:element name=\"listOfCompartments\" minOccurs=\"0\">48\n<xsd:complexType>49\n<xsd:complexContent>50\n<xsd:extension base=\"SBase\">51\n<xsd:sequence>52\n<xsd:element name=\"compartment\"53\ntype=\"Compartment\"54\nmaxOccurs=\"unbounded\"/>55\n</xsd:sequence>56\n</xsd:extension>57\n</xsd:complexContent>58\n</xsd:complexType>59\n</xsd:element>60\n<xsd:element name=\"listOfSpecies\" minOccurs=\"0\">61\n<xsd:complexType>62\n<xsd:complexContent>63\n<xsd:extension base=\"SBase\">64\n<xsd:sequence>65\n<xsd:element name=\"species\"66\ntype=\"Species\"67\nmaxOccurs=\"unbounded\"/>68\n</xsd:sequence>69\n</xsd:extension>70\n</xsd:complexContent>71\n</xsd:complexType>72\n</xsd:element>73\n<xsd:element name=\"listOfParameters\" type=\"ListOfParameters\" minOccurs=\"0\"/>74\n<xsd:element name=\"listOfInitialAssignments\" minOccurs=\"0\">75\n<xsd:complexType>76\n<xsd:complexContent>77\n<xsd:extension base=\"SBase\">78\n<xsd:sequence>79\n<xsd:element name=\"initialAssignment\"80\n133\nNature Precedings : hdl:10101/npre.2007.58.1 : Posted 18 Jun 2007\ntype=\"InitialAssignment\"1\nmaxOccurs=\"unbounded\"/>2\n</xsd:sequence>3\n</xsd:extension>4\n</xsd:complexContent>5\n</xsd:complexType>6\n</xsd:element>7\n<xsd:element name=\"listOfRules\" minOccurs=\"0\">8\n<xsd:complexType>9\n<xsd:complexContent>10\n<xsd:extension base=\"SBase\">11\n<xsd:choice maxOccurs=\"unbounded\">12\n<xsd:element name=\"algebraicRule\"13\ntype=\"AlgebraicRule\"14\nminOccurs=\"0\"/>15\n<xsd:element name=\"assignmentRule\"16\ntype=\"AssignmentRule\"17\nminOccurs=\"0\"/>18\n<xsd:element name=\"rateRule\"19\ntype=\"RateRule\"20\nminOccurs=\"0\"/>21\n</xsd:choice>22\n</xsd:extension>23\n</xsd:complexContent>24\n</xsd:complexType>25\n</xsd:element>26\n<xsd:element name=\"listOfConstraints\" minOccurs=\"0\">27\n<xsd:complexType>28\n<xsd:complexContent>29\n<xsd:extension base=\"SBase\">30\n<xsd:sequence>31\n<xsd:element name=\"constraint\"32\ntype=\"Constraint\"33\nmaxOccurs=\"unbounded\"/>34\n</xsd:sequence>35\n</xsd:extension>36\n</xsd:complexContent>37\n</xsd:complexType>38\n</xsd:element>39\n<xsd:element name=\"listOfReactions\" minOccurs=\"0\">40\n<xsd:complexType>41\n<xsd:complexContent>42\n<xsd:extension base=\"SBase\">43\n<xsd:sequence>44\n<xsd:element name=\"reaction\"45\ntype=\"Reaction\"46\nmaxOccurs=\"unbounded\"/>47\n</xsd:sequence>48\n</xsd:extension>49\n</xsd:complexContent>50\n</xsd:complexType>51\n</xsd:element>52\n<xsd:element name=\"listOfEvents\" minOccurs=\"0\">53\n<xsd:complexType>54\n<xsd:complexContent>55\n<xsd:extension base=\"SBase\">56\n<xsd:sequence>57\n<xsd:element name=\"event\"58\ntype=\"Event\"59\nmaxOccurs=\"unbounded\"/>60\n</xsd:sequence>61\n</xsd:extension>62\n</xsd:complexContent>63\n</xsd:complexType>64\n</xsd:element>65\n</xsd:sequence>66\n<xsd:attribute name=\"id\" type=\"SId\" use=\"optional\"/>67\n<xsd:attribute name=\"name\" type=\"xsd:string\" use=\"optional\"/>68\n</xsd:extension>69\n</xsd:complexContent>70\n</xsd:complexType>71\n<!-- The following is the type definition for the top-level element in an SBML document.-->72\n<xsd:complexType name=\"Sbml\">73\n<xsd:complexContent>74\n<xsd:extension base=\"SBase\">75\n<xsd:sequence>76\n<xsd:element name=\"model\" type=\"Model\"/>77\n</xsd:sequence>78\n<xsd:attribute name=\"level\" type=\"xsd:positiveInteger\"79\nuse=\"required\" fixed=\"2\"/>80\n134\nNature Precedings : hdl:10101/npre.2007.58.1 : Posted 18 Jun 2007\n<xsd:attribute name=\"version\" type=\"xsd:positiveInteger\"1\nuse=\"required\" fixed=\"3\"/>2\n</xsd:extension>3\n</xsd:complexContent>4\n</xsd:complexType>5\n<!--The following is the (only) top-level element allowed in an SBML document.-->6\n<xsd:element name=\"sbml\" type=\"Sbml\"/>7\n<!--The end.-->8\n</xsd:schema>9\n135\nNature Precedings : hdl:10101/npre.2007.58.1 : Posted 18 Jun 2007\nB XML Schema for MathML subset1\nThe following XML schema deﬁnes the syntax of the MathML syntax that is used in SBML Level 2 .2\n3\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>4\n<!--5\n* Filename : sbml-mathml.xsd6\n* Description : Schema for the MathML subset used by SBML L2.7\n* Author(s) : Andrew Finney, Michael Hucka8\n* Organization: SBML Team <sbml-team@caltech.edu>9\n* Revision : $ Id: sbml-mathml.xsd,v 1.3 2006/07/20 23:46:31 mhucka Exp $10\n* Source : $ Source: /cvsroot/sbml/specifications/sbml-mathml/sbml-mathml.xsd,v $11\n*12\n* Copyright 2003-2006 California Institute of Technology, the Japan Science13\n* and Technology Corporation, and the University of Hertfordshire.14\n*15\n* This software is licensed according to the terms described in the file16\n* named \"LICENSE.txt\" included with this distribution and available17\n* online at http://sbml.org/xml-schemas/LICENSE.txt18\n*19\n* Summary:20\n*21\n* This is a reduced version of the XML Schema for MathML 2.0. It22\n* corresponds to the subset of MathML 2.0 used in SBML Level 2, and23\n* should be used by validating XML parsers instead of the actual24\n* MathML XML Schema when validating SBML files. To accomplish that,25\n* changed the value of the attribute ’schemaLocation’ in the SBML26\n* XML Schema file (sbml.xsd) to refer to a copy of this Schema file27\n* on your computer’s local hard disk.28\n-->29\n<xs:schema xmlns=\"http://www.w3.org/1998/Math/MathML\"30\nxmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"31\nxmlns:xs=\"http://www.w3.org/2001/XMLSchema\"32\ntargetNamespace=\"http://www.w3.org/1998/Math/MathML\"33\nelementFormDefault=\"qualified\"34\nattributeFormDefault=\"unqualified\">35\n<xs:attributeGroup name=\"MathAttributes\">36\n<xs:attribute name=\"class\" type=\"xs:NMTOKENS\" use=\"optional\"/>37\n<xs:attribute name=\"style\" type=\"xs:string\" use=\"optional\"/>38\n<xs:attribute name=\"id\" type=\"xs:ID\" use=\"optional\"/>39\n</xs:attributeGroup>40\n<xs:complexType name=\"MathBase\">41\n<xs:attributeGroup ref=\"MathAttributes\"/>42\n</xs:complexType>43\n<xs:attributeGroup name=\"CnAttributes\">44\n<xs:attribute name=\"type\">45\n<xs:simpleType>46\n<xs:restriction base=\"xs:NMTOKEN\">47\n<xs:enumeration value=\"e-notation\"/>48\n<xs:enumeration value=\"integer\"/>49\n<xs:enumeration value=\"rational\"/>50\n<xs:enumeration value=\"real\"/>51\n</xs:restriction>52\n</xs:simpleType>53\n</xs:attribute>54\n<xs:attributeGroup ref=\"MathAttributes\"/>55\n</xs:attributeGroup>56\n<xs:complexType name=\"SepType\"/>57\n<xs:complexType name=\"Cn\" mixed=\"true\">58\n<xs:choice minOccurs=\"0\">59\n<xs:element name=\"sep\" type=\"SepType\"/>60\n</xs:choice>61\n<xs:attributeGroup ref=\"CnAttributes\"/>62\n</xs:complexType>63\n<xs:complexType name=\"Ci\">64\n<xs:simpleContent>65\n<xs:extension base=\"xs:string\">66\n<xs:attributeGroup ref=\"MathAttributes\"/>67\n</xs:extension>68\n</xs:simpleContent>69\n</xs:complexType>70\n<xs:simpleType name=\"CsymbolURI\">71\n<xs:restriction base=\"xs:string\">72\n<xs:enumeration value=\"http://www.sbml.org/sbml/symbols/time\"/>73\n<xs:enumeration value=\"http://www.sbml.org/sbml/symbols/delay\"/>74\n</xs:restriction>75\n</xs:simpleType>76\n<xs:complexType name=\"Csymbol\">77\n<xs:simpleContent>78\n136\nNature Precedings : hdl:10101/npre.2007.58.1 : Posted 18 Jun 2007\n<xs:extension base=\"xs:string\">1\n<xs:attribute name=\"encoding\" use=\"required\" fixed=\"text\"/>2\n<xs:attribute name=\"definitionURL\" type=\"CsymbolURI\" use=\"required\"/>3\n<xs:attributeGroup ref=\"MathAttributes\"/>4\n</xs:extension>5\n</xs:simpleContent>6\n</xs:complexType>7\n<xs:complexType name=\"NodeContainer\">8\n<xs:complexContent>9\n<xs:extension base=\"MathBase\">10\n<xs:group ref=\"Node\"/>11\n</xs:extension>12\n</xs:complexContent>13\n</xs:complexType>14\n<xs:complexType name=\"Apply\">15\n<xs:complexContent>16\n<xs:extension base=\"MathBase\">17\n<xs:sequence>18\n<xs:choice>19\n<xs:element name=\"ci\" type=\"Ci\"/>20\n<xs:element name=\"csymbol\" type=\"Csymbol\"/>21\n<xs:element name=\"eq\" type=\"MathBase\"/>22\n<xs:element name=\"neq\" type=\"MathBase\"/>23\n<xs:element name=\"gt\" type=\"MathBase\"/>24\n<xs:element name=\"lt\" type=\"MathBase\"/>25\n<xs:element name=\"geq\" type=\"MathBase\"/>26\n<xs:element name=\"leq\" type=\"MathBase\"/>27\n<xs:element name=\"plus\" type=\"MathBase\"/>28\n<xs:element name=\"minus\" type=\"MathBase\"/>29\n<xs:element name=\"times\" type=\"MathBase\"/>30\n<xs:element name=\"divide\" type=\"MathBase\"/>31\n<xs:element name=\"power\" type=\"MathBase\"/>32\n<xs:sequence>33\n<xs:element name=\"root\" type=\"MathBase\"/>34\n<xs:element name=\"degree\" type=\"NodeContainer\" minOccurs=\"0\"/>35\n</xs:sequence>36\n<xs:element name=\"abs\" type=\"MathBase\"/>37\n<xs:element name=\"exp\" type=\"MathBase\"/>38\n<xs:element name=\"ln\" type=\"MathBase\"/>39\n<xs:sequence>40\n<xs:element name=\"log\" type=\"MathBase\"/>41\n<xs:element name=\"logbase\" type=\"NodeContainer\" minOccurs=\"0\"/>42\n</xs:sequence>43\n<xs:element name=\"floor\" type=\"MathBase\"/>44\n<xs:element name=\"ceiling\" type=\"MathBase\"/>45\n<xs:element name=\"factorial\" type=\"MathBase\"/>46\n<xs:element name=\"and\" type=\"MathBase\"/>47\n<xs:element name=\"or\" type=\"MathBase\"/>48\n<xs:element name=\"xor\" type=\"MathBase\"/>49\n<xs:element name=\"not\" type=\"MathBase\"/>50\n<xs:element name=\"sin\" type=\"MathBase\"/>51\n<xs:element name=\"cos\" type=\"MathBase\"/>52\n<xs:element name=\"tan\" type=\"MathBase\"/>53\n<xs:element name=\"sec\" type=\"MathBase\"/>54\n<xs:element name=\"csc\" type=\"MathBase\"/>55\n<xs:element name=\"cot\" type=\"MathBase\"/>56\n<xs:element name=\"sinh\" type=\"MathBase\"/>57\n<xs:element name=\"cosh\" type=\"MathBase\"/>58\n<xs:element name=\"tanh\" type=\"MathBase\"/>59\n<xs:element name=\"sech\" type=\"MathBase\"/>60\n<xs:element name=\"csch\" type=\"MathBase\"/>61\n<xs:element name=\"coth\" type=\"MathBase\"/>62\n<xs:element name=\"arcsin\" type=\"MathBase\"/>63\n<xs:element name=\"arccos\" type=\"MathBase\"/>64\n<xs:element name=\"arctan\" type=\"MathBase\"/>65\n<xs:element name=\"arcsec\" type=\"MathBase\"/>66\n<xs:element name=\"arccsc\" type=\"MathBase\"/>67\n<xs:element name=\"arccot\" type=\"MathBase\"/>68\n<xs:element name=\"arcsinh\" type=\"MathBase\"/>69\n<xs:element name=\"arccosh\" type=\"MathBase\"/>70\n<xs:element name=\"arctanh\" type=\"MathBase\"/>71\n<xs:element name=\"arcsech\" type=\"MathBase\"/>72\n<xs:element name=\"arccsch\" type=\"MathBase\"/>73\n<xs:element name=\"arccoth\" type=\"MathBase\"/>74\n</xs:choice>75\n<xs:group ref=\"Node\" maxOccurs=\"unbounded\"/>76\n</xs:sequence>77\n</xs:extension>78\n</xs:complexContent>79\n</xs:complexType>80\n137\nNature Precedings : hdl:10101/npre.2007.58.1 : Posted 18 Jun 2007\n<xs:complexType name=\"Piece\">1\n<xs:complexContent>2\n<xs:extension base=\"MathBase\">3\n<xs:group ref=\"Node\" minOccurs=\"2\" maxOccurs=\"2\"/>4\n</xs:extension>5\n</xs:complexContent>6\n</xs:complexType>7\n<xs:complexType name=\"Otherwise\">8\n<xs:complexContent>9\n<xs:extension base=\"MathBase\">10\n<xs:group ref=\"Node\"/>11\n</xs:extension>12\n</xs:complexContent>13\n</xs:complexType>14\n<xs:complexType name=\"Piecewise\">15\n<xs:complexContent>16\n<xs:extension base=\"MathBase\">17\n<xs:sequence>18\n<xs:element name=\"piece\" type=\"Piece\" minOccurs=\"0\" maxOccurs=\"unbounded\"/>19\n<xs:element name=\"otherwise\" type=\"Otherwise\" minOccurs=\"0\" maxOccurs=\"1\"/>20\n</xs:sequence>21\n</xs:extension>22\n</xs:complexContent>23\n</xs:complexType>24\n<xs:attributeGroup name=\"AnnotationAttributes\">25\n<xs:attributeGroup ref=\"MathAttributes\"/>26\n<xs:attribute name=\"encoding\" type=\"xs:string\" use=\"required\"/>27\n</xs:attributeGroup>28\n<xs:complexType name=\"Annotation\">29\n<xs:simpleContent>30\n<xs:extension base=\"xs:string\">31\n<xs:attributeGroup ref=\"AnnotationAttributes\"/>32\n</xs:extension>33\n</xs:simpleContent>34\n</xs:complexType>35\n<xs:complexType name=\"Annotation-xml\">36\n<xs:sequence maxOccurs=\"unbounded\">37\n<xs:any processContents=\"skip\"/>38\n</xs:sequence>39\n<xs:attributeGroup ref=\"AnnotationAttributes\"/>40\n</xs:complexType>41\n<xs:complexType name=\"Semantics\">42\n<xs:complexContent>43\n<xs:extension base=\"MathBase\">44\n<xs:sequence>45\n<xs:group ref=\"Node\"/>46\n<xs:sequence maxOccurs=\"unbounded\">47\n<xs:choice>48\n<xs:element name=\"annotation\" type=\"Annotation\"/>49\n<xs:element name=\"annotation-xml\" type=\"Annotation-xml\"/>50\n</xs:choice>51\n</xs:sequence>52\n</xs:sequence>53\n</xs:extension>54\n</xs:complexContent>55\n</xs:complexType>56\n<xs:group name=\"Node\">57\n<xs:choice>58\n<xs:element name=\"apply\" type=\"Apply\"/>59\n<xs:element name=\"cn\" type=\"Cn\"/>60\n<xs:element name=\"ci\" type=\"Ci\"/>61\n<xs:element name=\"csymbol\" type=\"Csymbol\"/>62\n<xs:element name=\"true\" type=\"MathBase\"/>63\n<xs:element name=\"false\" type=\"MathBase\"/>64\n<xs:element name=\"notanumber\" type=\"MathBase\"/>65\n<xs:element name=\"pi\" type=\"MathBase\"/>66\n<xs:element name=\"infinity\" type=\"MathBase\"/>67\n<xs:element name=\"exponentiale\" type=\"MathBase\"/>68\n<xs:element name=\"semantics\" type=\"Semantics\"/>69\n<xs:element name=\"piecewise\" type=\"Piecewise\"/>70\n</xs:choice>71\n</xs:group>72\n<xs:complexType name=\"Bvar\">73\n<xs:complexContent>74\n<xs:extension base=\"MathBase\">75\n<xs:sequence>76\n<xs:element name=\"ci\" type=\"Ci\"/>77\n</xs:sequence>78\n</xs:extension>79\n</xs:complexContent>80\n138\nNature Precedings : hdl:10101/npre.2007.58.1 : Posted 18 Jun 2007\n</xs:complexType>1\n<xs:complexType name=\"Lambda\">2\n<xs:complexContent>3\n<xs:extension base=\"MathBase\">4\n<xs:sequence>5\n<xs:element name=\"bvar\" type=\"Bvar\" minOccurs=\"0\" maxOccurs=\"unbounded\"/>6\n<xs:group ref=\"Node\"/>7\n</xs:sequence>8\n</xs:extension>9\n</xs:complexContent>10\n</xs:complexType>11\n<xs:complexType name=\"Math\">12\n<xs:complexContent>13\n<xs:extension base=\"MathBase\">14\n<xs:choice>15\n<xs:group ref=\"Node\"/>16\n<xs:element name=\"lambda\" type=\"Lambda\"/>17\n</xs:choice>18\n</xs:extension>19\n</xs:complexContent>20\n</xs:complexType>21\n<xs:element name=\"math\" type=\"Math\">22\n<!--This is the top-level element for a ’math’ container in SBML.-->23\n</xs:element>24\n</xs:schema>25\n139\nNature Precedings : hdl:10101/npre.2007.58.1 : Posted 18 Jun 2007\nC Validation rules for SBML1\nThis section contains a summary of all the conditions that should be true of a model, in addition to consis-2\ntency with the XML Schemas given in Appendixes A and B, for that model to considered valid SBML.3\nGeneral XML validation4\n10101. An SBML XML ﬁle must use UTF-8 as the character encoding. More precisely, the encoding5\nattribute of the XML declaration at the beginning of the XML data stream cannot have a value6\nother than “ UTF-8”. An example valid declaration is <?xml version=\"1.0\" encoding=\"UTF-8\"?>.7\n(References: L2V2 Section 4.1; L2V3 Section 4.1.)8\n10102. An SBML XML document must not contain undeﬁned elements or attributes in the SBML names-9\npace. Documents containing unknown elements or attributes placed in the SBML namespace do not10\nconform to the SBML Level 2 speciﬁcation. (References: L2V2 Section 4.1; L2V3 Section 4.1.)11\n10103. An SBML XML document must conform to the XML Schema for the corresponding SBML Level,12\nVersion and Release. The XML Schema for SBML deﬁnes the basic SBML object structure, the data13\ntypes used by those objects, and the order in which the objects may appear in an SBML document.14\n(References: SBML L2V2 Section 4.1; L2V3 Section 4.1.)15\nGeneral MathML validation16\n10201. All MathML content in SBML must appear within a math element, and the math element must17\nbe either explicitly or implicitly in the XML namespace “ http://www.w3.org/1998/Math/MathML”.18\n(References: L2V2 Section 3.5; L2V3 Section 3.4.)19\n10202. The only permitted MathML 2.0 elements in SBML Level 2 are the following: cn, ci, csymbol, sep,20\napply, piecewise, piece, otherwise, eq, neq, gt, lt, geq, leq, plus, minus, times, divide, power,21\nroot, abs, exp, ln, log, floor, ceiling, factorial, and, or, xor, not, degree, bvar, logbase,22\nsin, cos, tan, sec, csc, cot, sinh, cosh, tanh, sech, csch, coth, arcsin, arccos, arctan, arcsec,23\narccsc, arccot, arcsinh, arccosh, arctanh, arcsech, arccsch, arccoth, true, false, notanumber,24\npi, infinity, exponentiale, semantics, annotation, and annotation-xml. (References: L2V225\nSection 3.5.1; L2V3 Section 3.4.1.)26\n10203. In the SBML subset of MathML 2.0, the MathML attribute encoding is only permitted on csymbol.27\nNo other MathML elements may have the encoding attribute. (References: L2V2 Section 3.5.1;28\nL2V3 Section 3.4.1.)29\n10204. In the SBML subset of MathML 2.0, the MathML attribute definitionURL is only permitted on30\ncsymbol. No other MathML elements may have a definitionURL attribute. (References: L2V231\nSection 3.5.1; L2V3 Section 3.4.1.)32\n10205. In SBML Level 2, the only values permitted for the definitionURL attribute on a csymbol element are33\n“http://www.sbml.org/sbml/symbols/time” and “ http://www.sbml.org/sbml/symbols/delay”.34\n(References: L2V2 Section 3.5.5; L2V3 Section 3.4.6.)35\n10206. In the SBML subset of MathML 2.0, the MathML attribute type is only permitted on the cn36\nconstruct. No other MathML elements may have a type attribute. (References: L2V2 Section 3.5.1;37\nL2V3 Section 3.4.1.)38\n10207. The only permitted values for the type attribute on MathML cn elements are “ e-notation”, “ real”,39\n“integer”, and “ rational”. (References: L2V2 Section 3.5.2; L2V3 Section 3.4.2.)40\n10208. MathML lambda elements are only permitted as the ﬁrst element inside the math element of a41\nFunctionDeﬁnition or as the ﬁrst element of a semantics element immediately inside the math element42\nof a FunctionDeﬁnition; they may not be used elsewhere in an SBML model. (References: L2V243\nSections 3.5.1 and 4.3; L2V3 Sections 3.4.1 and 4.3.2.)44\n140\nNature Precedings : hdl:10101/npre.2007.58.1 : Posted 18 Jun 2007\n10209. The arguments of the MathML logical operators and, or, xor, and not must have boolean values.1\n(References: L2V2 Section 3.5.8; L2V3 Section 3.4.9.)2\n10210. The arguments to the following MathML constructs must evaluate to be numbers (i.e., MathML ,3\nreal, integer, rational, or “e-notation” numbers, or the time or delay csymbol): plus, minus,4\ntimes, divide, power, root, abs, exp, ln, log, floor, ceiling, factorial, sin, cos, tan, sec,5\ncsc, cot, sinh, cosh, tanh, sech, csch, coth, arcsin, arccos, arctan, arcsec, arccsc, arccot,6\narcsinh, arccosh, arctanh, arcsech, arccsch, arccoth. (References: L2V2 Section 3.5.8; L2V37\nSection 3.4.9.)8\n10211. The values of all arguments to eq and neq operators should have the same type (either all boolean9\nor all numerical). (References: L2V2 Section 3.5.8; L2V3 Section 3.4.9.)10\n10212. The types of values within piecewise operators should all be consistent: the set of expressions that11\nmake up the ﬁrst arguments of the piece and otherwise operators within the same piecewise oper-12\nator should all return values of the same type. (References: L2V2 Section 3.5.8; L2V3 Section 3.4.9.)13\n10213. The second argument of a MathML piece operator must have a boolean value. (References: L2V214\nSection 3.5.8; L2V3 Section 3.4.9.)15\n10214. Outside of a FunctionDeﬁnition, if a ci element is the ﬁrst element within a MathML apply, then the16\nci’s value can only be chosen from the set of identiﬁers of FunctionDeﬁnition instances deﬁned in the17\nenclosing SBML Model instance. (References: L2V2 Section 4.3.2; L2V3 Section 4.3.2.)18\n10215. Outside of a FunctionDeﬁnition, if a ci element is not the ﬁrst element within a MathML apply, then19\nthe ci’s value can only be chosen from the set of identiﬁers of Species, Compartment, Parameter or20\nReaction objects deﬁned in the SBML model. (References: L2V2 Section 4.3.2; L2V3 Section 3.4.3.)21\n10216. The id value of a Parameter deﬁned within a KineticLaw can only be used in ci elements within the22\nMathML content of that same KineticLaw; the identiﬁer is not visible to other parts of the model.23\n(References: L2V2 Sections 3.4.1, 3.5.3 and 4.13.5; L2V3 Sections 3.3.1, 3.4.3 and 4.13.5.)24\n10217. The MathML formulas in the following elements must yield numerical values (that is, MathML25\nreal, integer or “e-notation” numbers, or the time or delay csymbol): math in KineticLaw,26\nstoichiometryMath in SpeciesReference, math in InitialAssignment, math in AssignmentRule, math27\nin RateRule, math in AlgebraicRule, math in Event Delay, and math in EventAssignment. (References:28\nL2V2 Section 4.10, 4.11, 4.13 and 4.14; L2V3 Sections 4.10, 4.11, 4.13 and 4.14.)29\n10218. A MathML operator must be supplied the number of arguments appropriate for that operator.30\n(References: L2V2 Section 3.5.1; L2V3 Section 3.4.1.)31\nGeneral identiﬁer validation32\n10301. The value of the id attribute on every instance of the following classes of objects in a model must33\nbe unique across the set of all id values in a model : Model, FunctionDeﬁnition, CompartmentType,34\nSpeciesType, Compartment, Species, Reaction, SpeciesReference, ModiﬁerSpeciesReference, Event,35\nand model-wide Parameters. Exception: the identiﬁers of instances of UnitDeﬁnition, and parameters36\ndeﬁned inside a reaction, are treated separately. (References: L2V1 Section 3.5; L2V2 Section 3.4.1;37\nL2V3 Section 3.3)38\n10302. The value of the id attribute of every UnitDeﬁnition must be unique across the set of all UnitDeﬁnitions39\nin the entire model. (References: L2V1 Section 3.5 and 4.4; L2V2 Sections 3.4.1 and 4.4; L2V340\nSections 3.3 and 4.4.)41\n10303. The value of the id attribute of each parameter deﬁned locally within a KineticLaw must be unique42\nacross the set of all such parameter deﬁnitions in that KineticLaw. (References: L2V1 Sections 3.4.143\nand 4.13.9; L2V2 Sections 3.4.1 and 4.13.5; L2V3 Sections 3.3.1 and 4.13.5.)44\n141\nNature Precedings : hdl:10101/npre.2007.58.1 : Posted 18 Jun 2007\n10304. The value of the variable attribute in all AssignmentRule and RateRule deﬁnitions must be unique1\nacross the set of all such rule deﬁnitions in a model. (References: L2V1 Section 4.8.4; L2V2 Sec-2\ntion 4.11; L2V3 Section 4.11.3.)3\n10305. In each Event, the value of the variable attribute within every EventAssignment deﬁnition must4\nbe unique across the set of all EventAssignments within that Event. In other words, a single Event5\ncannot make more than one assignment to a given identiﬁer. (References: L2V1 erratum 17; L2V26\nSection 4.14.2; L2V3 Section 4.14.4.)7\n10306. An identiﬁer used as the value of variable in an EventAssignment cannot also appear as the value8\nof variable in an AssignmentRule. (References: L2V1 Section 4.10.5; L2V2 Section 4.14.2; L2V39\nSection 4.14.4.)10\n10307. Every metaid attribute value must be unique across the set of all metaid values in a model. (Refer-11\nences: L2V2 Sections 3.1.6 and 3.3.1; L2V3 Sections 3.2.1 and 3.1.6.)12\n10308. The value of a sboTerm attribute must have the data type SBOTerm, which is a string consisting of13\nthe characters ‘S’, ‘B’, ‘O’, ’:’, followed by exactly seven digits. (References: L2V2 Section 3.1.9;14\nL2V3 Section 3.1.9.)15\n10309. The syntax of metaid attribute values must conform to the syntax of the XML type ID. (References:16\nL2V2 Sections 3.1.6 and 3.3.1; L2V3 Sections 3.2.1 and 3.1.6.)17\n10310. The syntax of id attribute values must conform to the syntax of the SBML type SId. (References:18\nL2V2 Section 3.1.7; L2V3 Section 3.1.7.)19\n10311. The syntax of unit identiﬁers (i.e., the values of the id attribute on UnitDeﬁnition, the units attribute20\non Compartment, the units attribute on Parameter, and the substanceUnits attribute on Species)21\nmust conform to the syntax of the SBML type UnitSId. (References: L2V3 Section 3.1.8.)22\nGeneral annotation validation23\n10401. Every top-level element within an annotation element must have a namespace declared. (References:24\nL2V2 Section 3.3.3; L2V3 Section 3.2.4.)25\n10402. There cannot be more than one top-level element using a given namespace inside a given annotation26\nelement. (References: L2V2 Section 3.3.3; L2V3 Section 3.2.4.)27\n10403. Top-level elements within an annotation element cannot use any SBML namespace, whether ex-28\nplicitly (by declaring the namespace to be one of the URIs “ http://www.sbml.org/sbml/level1”,29\n“http://www.sbml.org/sbml/level2”, “ http://www.sbml.org/sbml/level2/version2”, or30\n“http://www.sbml.org/sbml/level2/version3”), or implicitly (by failing to declare any names-31\npace). (References: L2V2 Section 3.3.3; L2V3 Section 3.2.4.)32\nGeneral unit validation33\n10501. The units of the expressions used as arguments to a function call must match the units expected for34\nthe arguments of that function. (References: L2V2 Section 3.5; L2V3 Section 3.4.)35\n10511. When the variable in an AssignmentRule refers to a Compartment, the units of the rule’s right-hand36\nside must be consistent with the units of that compartment’s size. (References: L2V2 Section 4.11.3;37\nL2V3 Section 4.11.3.)38\n10512. When the variable in an AssignmentRule refers to a Species, the units of the rule’s right-hand side39\nmust be consistent with the units of the species’ quantity. (References: L2V2 Section 4.11.3; L2V340\nSection 4.11.3.)41\n142\nNature Precedings : hdl:10101/npre.2007.58.1 : Posted 18 Jun 2007\n10513. When the variable in an AssignmentRule refers to a Parameter, the units of the rule’s right-hand side1\nmust be consistent with the units declared for that parameter. (References: L2V2 Section 4.11.3;2\nL2V3 Section 4.11.3.)3\n10521. When the variable in an InitialAssignment refers to a Compartment, the units of the InitialAssign-4\nment’s math expression must be consistent with the units of that compartment’s size. (References:5\nL2V2 Section 4.10.4; L2V3 Section 4.10.)6\n10522. When the variable in an InitialAssignment refers to a Species, the units of the InitialAssignment’s7\nmath expression must be consistent with the units of that species’ quantity. (References: L2V28\nSection 4.10.4; L2V3 Section 4.11.3.)9\n10523. When the variable in an InitialAssignment refers to a Parameter, the units of the InitialAssignment’s10\nmath expression must be consistent with the units declared for that parameter. (References: L2V211\nSection 4.10.4; L2V3 Section 4.11.3.)12\n10531. When the variable in a RateRule deﬁnition refers to a Compartment, the units of the rule’s right-13\nhand side must be of the form x per time , where x is either the units in that Compartment deﬁnition,14\nor (in the absence of explicit units declared for the compartment size) the default units for that15\ncompartment, and time refers to the units of time for the model. (References: L2V2 Section 4.11.4;16\nL2V3 Section 4.11.4.)17\n10532. When the variable in a RateRule deﬁnition refers to a Species, the units of the rule’s right-hand18\nside must be of the form x per time , where x is the units of that species’ quantity, and time refers to19\nthe units of time for the model. (References: L2V2 Section 4.11.4; L2V3 Section 4.11.4.)20\n10533. When the variable in a RateRule deﬁnition refers to a Parameter, the units of the rule’s right-hand21\nside must be of the form x per time , where x is the units in that Parameter deﬁnition, and time22\nrefers to the units of time for the model. (References: L2V2 Section 4.11.4; L2V3 Section 4.11.4.)23\n10541. The units of the math formula in a KineticLaw deﬁnition must be the equivalent of substance per time .24\n(References: L2V2 Section 4.13.5; L2V3 Section 4.13.5.)25\n10551. The units of the mathematical formula in the delay of an Event must correspond to the model’s26\noverall units of time. ( L2V3 Section 4.14.3.)27\n10561. When the variable attribute of an EventAssignment contains the identiﬁer of a Compartment in28\nthe model, the units of the mathematical expression in the EventAssignment’s math expression must29\nbe consistent with the units of that compartment’s size. (References: L2V2 Section 4.14.2; L2V330\nSection 4.14.4.)31\n10562. When the variable attribute of an EventAssignment contains the identiﬁer of a Species in the model,32\nthe units of the mathematical expression in the EventAssignment’s math expression must be consistent33\nwith the units of that species’ quantity. (References: L2V2 Section 4.14.2; L2V3 Section 4.14.4.)34\n10563. When the variable attribute of an EventAssignment contains the identiﬁer of a Parameter in the35\nmodel, the units of the mathematical expression in the EventAssignment’s math expression must36\nbe consistent with the units declared for that parameter. (References: L2V2 Section 4.14.2; L2V337\nSection 4.14.4.)38\nGeneral model validation39\n10601. A system of equations created from an SBML model must not be overdetermined. (References: L2V240\nSection 4.11.5; L2V3 Section 4.11.5.)41\n143\nNature Precedings : hdl:10101/npre.2007.58.1 : Posted 18 Jun 2007\nGeneral SBO validation1\n10701. The value of the sboTerm attribute on a Model must be an SBO identiﬁer referring to a modeling2\nframework deﬁned in SBO. That is, the value must be a term derived from SBO:0000004, “modeling3\nframework”. (References: L2V2 Section 4.2.1; L2V3 Section 4.2.2.)4\n10702. The value of the sboTerm attribute on a FunctionDeﬁnition must be an SBO identiﬁer referring to a5\nmathematical expression. That is, the value must be a term derived from SBO:0000064, “mathemat-6\nical expression”. (References: L2V2 Section 4.3.3; L2V3 Section 4.3.3.)7\n10703. The value of the sboTerm attribute on a Parameter must be an SBO identiﬁer referring to a quan-8\ntitative parameter. That is, the value must be a term derived from SBO:0000002, “quantitative9\nparameter”. (References: L2V2 Section 4.9.5; L2V3 Section 4.9.5.)10\n10704. The value of the sboTerm attribute on an InitialAssignment must be an SBO identiﬁer referring to a11\nmathematical expression. That is, the value must be a term derived from SBO:0000064, “mathemat-12\nical expression”. (References: L2V2 Section 4.10.3; L2V3 Section 4.10.3.)13\n10705. The value of the sboTerm attribute on a AlgebraicRule, RateRule or AssignmentRule must be an SBO14\nidentiﬁer referring to a mathematical expression. That is, the value must be a term derived from15\nSBO:0000064, “mathematical expression”. (References: L2V2 Section 4.11.1; L2V3 Section 4.11.1.)16\n10706. The value of the sboTerm attribute on a Constraint must be an SBO identiﬁer referring to a math-17\nematical expression. That is, the value must be a term derived from SBO:0000064, “mathematical18\nexpression”. (References: L2V2 Section 4.12.3; L2V3 Section 4.12.3.)19\n10707. The value of the sboTerm attribute on a Reaction must be an SBO identiﬁer referring to a modeling20\nframework. That is, the value must be a term derived from SBO:0000231, “event”. (References:21\nL2V2 Section 4.13.1; L2V3 Section 4.13.1.)22\n10708. The value of the sboTerm attribute on a SpeciesReference or a ModiﬁerSpeciesReference must be23\nan SBO identiﬁer referring to a participant functional role. That is, the value must be a term24\nderived from SBO:0000003, “participant functional type”. The appropriate term depends on whether25\nthe entity is a reactant, product or modiﬁer. If a reactant, the term should be chosen from the26\nSBO:0000010, “reactant” hierarchy; if a product, the term should be chosen from the SBO:0000011,27\n“product” hierarchy; and if a modiﬁer, the term should be chosen from the SBO:0000019, “modiﬁer”28\nhierarchy. (References: L2V2 Section 4.13.2; L2V3 Sections 4.13.1 and 5.)29\n10709. The value of the sboTerm attribute on a KineticLaw must be an SBO identiﬁer referring to a rate30\nlaw. That is, the value must be a term derived from SBO:0000001, “rate law”. (References: L2V231\nSection 4.13.5; L2V3 Section 4.13.1.)32\n10710. The value of the sboTerm attribute on an Event must be an SBO identiﬁer referring to a mathematical33\nexpression. That is, the value must be a term derived from SBO:0000231, “event”. (References: L2V234\nSection 4.14.1; L2V3 Section 4.14.1.)35\n10711. The value of the sboTerm attribute on an EventAssignment must be an SBO identiﬁer referring to a36\nmathematical expression. That is, the value must be a term derived from SBO:0000064, “mathemat-37\nical expression”. (References: L2V2 Section 4.14.2; L2V3 Section 4.14.1.)38\n10712. The value of the sboTerm attribute on a Compartment must be an SBO identiﬁer referring to a39\nparticipant physical type. That is, the value must be a term derived from SBO:0000236,“participant40\nphysical type”. (References: L2V3 Section 5.)41\n10713. The value of the sboTerm attribute on a Species must be an SBO identiﬁer referring to a participant42\nphysical type. That is, the value must be a term derived from SBO:0000236,“participant physical43\ntype”. (References: L2V3 Section 5.)44\n144\nNature Precedings : hdl:10101/npre.2007.58.1 : Posted 18 Jun 2007\n10714. The value of the sboTerm attribute on a CompartmentType must be an SBO identiﬁer referring to a1\nparticipant physical type. That is, the value must be a term derived from SBO:0000236,“participant2\nphysical type”. (References: L2V3 Section 5.)3\n10715. The value of the sboTerm attribute on a SpeciesType must be an SBO identiﬁer referring to a4\nparticipant physical type. That is, the value must be a term derived from SBO:0000236,“participant5\nphysical type”. (References: L2V3 Section 5.)6\n10716. The value of the sboTerm attribute on a Trigger must be an SBO identiﬁer referring to a mathematical7\nexpression. That is, the value must be a term derived from SBO:0000064, “mathematical expression”.8\n(References: L2V3 Section 5.)9\n10717. The value of the sboTerm attribute on a Delay must be an SBO identiﬁer referring to a mathematical10\nexpression. That is, the value must be a term derived from SBO:0000064, “mathematical expression”.11\n(References: L2V3 Section 5.)12\nGeneral notes validation13\n10801. The contents of the notes element must be explicitly placed in the XHTML XML namespace.14\n(References: L2V3 Section 3.2.3.)15\n10802. The contents of the notes element must not contain an XML declaration (i.e., a string of the form16\n“<?xml version=\"1.0\" encoding=\"UTF-8\"?>” or similar). (References: L2V2 Section 3.3.2; L2V317\nSection 3.2.3.)18\n10803. The contents of the notes element must not contain an XML DOCTYPE declaration (i.e., a string19\nbeginning with the characters “ <!DOCTYPE”. (References: L2V2 Section 3.3.2; L2V3 Section 3.2.3.)20\n10804. The XHTML content inside a notes element can only take one of the following general forms: (1)21\na complete XHTML document beginning with the element <html> and ending with </html>; (2)22\nthe “body” portion of a document beginning with the element <body> and ending with </body>; or23\n(3) XHTML content that is permitted within a <body> ... </body> elements. (References: L2V224\nSection 3.3.2; L2V3 Section 3.2.3.)25\nSBML container validation26\n20101. The sbml container element must declare the XML Namespace for SBML, and this declaration must27\nbe consistent with the values of the level and version attributes on the sbml element. (References:28\nL2V2 Section 4.1; L2V3 Section 4.1.)29\n20102. The sbml container element must declare the SBML Level using the attribute level, and this dec-30\nlaration must be consistent with the XML Namespace declared for the sbml element. (References:31\nL2V2 Section 4.1; L2V3 Section 4.1.)32\n20103. The sbml container element must declare the SBML Version using the attribute version, and this33\ndeclaration must be consistent with the XML Namespace declared for the sbml element. (References:34\nL2V2 Section 4.1; L2V3 Section 4.1.)35\nModel validation36\n20201. An SBML document must contain a Model deﬁnition. (References: L2V1, L2V2 and L2V3 Sec-37\ntion 4.1).38\n20202. The order of subelements within a Model object instance must be the following, with each ele-39\nment optional: listOfFunctionDefinitions, listOfUnitDefinitions, listOfCompartmentTypes,40\nlistOfSpeciesTypes, listOfCompartments, listOfSpecies, listOfParameters,41\nlistOfInitialAssignments, listOfRules, listOfConstraints, listOfReactions, listOfEvents.42\n(References: L2V2 Section 4.2; L2V3 Section 4.2.)43\n145\nNature Precedings : hdl:10101/npre.2007.58.1 : Posted 18 Jun 2007\n20203. The listOf container elements in a Model instance are optional, but if present, the elements must1\nnot be empty. Speciﬁcally, if any of the following are present in a Model, they must not be empty:2\nlistOfFunctionDefinitions, listOfUnitDefinitions, listOfCompartmentTypes, listOfSpecies-3\nTypes, listOfCompartments, listOfSpecies, listOfParameters, listOfInitialAssignments,4\nlistOfRules, listOfConstraints, listOfReactions and listOfEvents. (References: This is re-5\nquirement stemming from the XML Schema used for SBML; L2V3 Section 4.2. )6\n20204. If a model deﬁnes any Species, then the model must also deﬁne at least one Compartment. This is7\nan implication of the fact that the compartment attribute on Species is not optional. (References:8\nL2V1 Section 4.5; L2V2 Section 4.8.3; L2V3 Section 4.8.3.)9\nFunctionDeﬁnition validation10\n20301. The top-level element within math in a FunctionDeﬁnition must be one and only one MathML lambda11\nelement or a MathML semantics element containing one and only one lambda element. (References:12\nL2V1 Section 4.3.2; L2V2 Section 4.3.2; L2V3 Section 4.3.2.)13\n20302. Inside the lambda of a FunctionDeﬁnition, if a ci element is the ﬁrst element within a MathML apply,14\nthen the ci’s value can only be chosen from the set of identiﬁers of other SBML FunctionDeﬁnitions15\ndeﬁned prior to that point in the SBML model. In other words, forward references to user -deﬁned16\nfunctions are not permitted. (References: L2V2 Section 3.5.3; L2V3 Section 3.4.3.)17\n20303. Inside the lambda of a FunctionDeﬁnition, the identiﬁer of that FunctionDeﬁnition cannot appear as18\nthe value of a ci element. SBML functions are not permitted to be recursive. (References: L2V219\nL2V2 Section 3.5.3 and 4.3.2; L2V3 Sections 3.4.3 and 4.3.2.)20\n20304. Inside the lambda of a FunctionDeﬁnition, if a ci element is not the ﬁrst element within a MathML21\napply, then the ci’s value can only be an identiﬁer provided as the value of a bvar element declared22\nin that lambda. This restriction also applies to the csymbol for time. In other words, all model23\nquantities and variables referenced inside a function deﬁnition must be passed as arguments to that24\nfunction. (References: L2V2 L2V2 Section 3.5.3 and 4.3.2; L2V3 Sections 3.4.3 and 4.3.2.)25\n20305. The value type returned by a FunctionDeﬁnition’s lambda must be either boolean or numerical. (Ref-26\nerences: L2V2 Section 3.5.8; L2V3 Section 3.4.9.)27\nUnit and UnitDeﬁnition validation28\n20401. The value of the id attribute in a UnitDeﬁnition must be of type UnitSId and not be identical to29\nany unit predeﬁned in SBML. That is, the identiﬁer must not be the same as any of the following30\npredeﬁned units: “ampere”, “ gram”, “ katal”, “ metre”, “ second”, “ watt”, “ becquerel”, “ gray”,31\n“kelvin”, “ mole”, “ siemens”, “ weber”, “ candela”, “ henry”, “ kilogram”, “ newton”, “ sievert”,32\n“coulomb”, “ hertz”, “ litre”, “ ohm”, “ steradian”, “ dimensionless”, “ item”, “ lumen”, “ pascal”,33\n“tesla”, “ farad”, “ joule”, “ lux”, “ radian”, or “ volt”. (References: L2V1 erratum 14; L2V234\nSection 4.4.2; L2V3 Section 4.4.2.)35\n20402. Redeﬁnitions of the built-in unit substance must be based on the unit mole, item, gram, kilogram,36\nor dimensionless. More formally, a UnitDeﬁnition for substance must simplify to a single Unit in37\nwhich either (a) the kind attribute has a value of “ mole”, “ item”, “ gram”, or “ kilogram”, and the38\nexponent attribute has a value of “ 1”, or (b) the kind attribute has a value of “ dimensionless”39\nwith any exponent attribute value. (References: L2V1 Section 4.4.3; L2V2 Section 4.4.3; L2V340\nSection 4.4.3.)41\n20403. Redeﬁnitions of the built-in unit length must be based on the unit metre or dimensionless. More42\nformally, a UnitDeﬁnition for length must simplify to a single Unit in which either (a) the kind43\nattribute has a value of “ metre” and the exponent attribute has a value of “ 1”, or (b) the kind44\nattribute has a value of “ dimensionless” with any exponent value. (References: L2V1 Section45\n4.4.3; L2V2 Section 4.4.3; L2V3 Section 4.4.3.)46\n146\nNature Precedings : hdl:10101/npre.2007.58.1 : Posted 18 Jun 2007\n20404. Redeﬁnitions of the built-in unit area must be based on squared metres or dimensionless. More1\nformally, a UnitDeﬁnition for area must simplify to a single Unit in which either (a) the kind attribute2\nhas a value of “ metre” and the exponent attribute has a value of “ 2”, or (b) the kind attribute3\nhas a value of “ dimensionless” with any exponent value. (References: L2V1 Section 4.4.3; L2V24\nSection 4.4.3; L2V3 Section 4.4.3.)5\n20405. Redeﬁnitions of the built-in unit time must be based on the unit second. More formally, a UnitDef-6\ninition for time must simplify to a single Unit in which either (a) the kind attribute has a value of7\n“second” and the exponent attribute has a value of “ 1”, or (b) the kind attribute has a value of8\n“dimensionless” with any exponent value. (References: L2V1 Section 4.4.3; L2V2 Section 4.4.3;9\nL2V3 Section 4.4.3.)10\n20406. Redeﬁnitions of the built-in unit volume must be based on litre, metre or dimensionless. More11\nformally, a UnitDeﬁnition for volume must simplify to a single Unit in which the kind attribute value12\nis either “ litre”, “ metre”, or “ dimensionless”. Additional constraints apply if the kind is “ litre”13\nor “ metre”. (References: L2V1 Section 4.4.3; L2V2 Section 4.4.3; L2V3 Section 4.4.3.)14\n20407. If a UnitDeﬁnition for volume simpliﬁes to a Unit in which the kind attribute value is “ litre”, then its15\nexponent attribute value must be “ 1”. (References: L2V1 Section 4.4.3; L2V2 Section 4.4.3; L2V316\nSection 4.4.3.)17\n20408. If a UnitDeﬁnition for volume simpliﬁes to a Unit in which the kind attribute value is “ metre”, then its18\nexponent attribute value must be “ 3”. (References: L2V1 Section 4.4.3; L2V2 Section 4.4.3; L2V319\nSection 4.4.3.)20\n20409. The listOfUnits container in a UnitDeﬁnition cannot be empty. (References: L2V2 Section 4.4;21\nL2V3 Section 4.4.)22\n20410. The value of the kind attribute of a Unit can only be one of the predeﬁned base units in SBML; that23\nis, the SBML unit system is not hierarchical and user-deﬁned units cannot be deﬁned using other24\nuser-deﬁned units. (References: L2V2 Section 4.4.1; L2V3 Section 4.4.2.)25\n20411. (Rule does not apply in SBML Level 2 Version 3.)26\n20412. (Rule does not apply in SBML Level 2 Version 3.)27\nCompartment validation28\n20501. The size of a Compartment must not be set if the compartment’s spatialDimensions attribute has29\nvalue 0. (References: L2V1 Section 4.5.3; L2V2 Section 4.7.4; L2V3 Section 4.7.5.)30\n20502. If a Compartment deﬁnition has a spatialDimensions value of “ 0”, then its units attribute must not31\nbe set. If the compartment has no dimensions, then no units can be associated with a non-existent32\nsize. (References: L2V1 Section 4.5.4; L2V2 Section 4.7.5; L2V3 Section 4.7.5.)33\n20503. If a Compartment deﬁnition has a spatialDimensions value of “ 0”, then its constant attribute value34\nmust either default to or be set to “ true”. If the compartment has no dimensions, then its size can35\nnever change. (References: L2V1 Section 4.5.5; L2V2 Section 4.7.4; L2V3 Section 4.7.6.)36\n20504. The outside attribute value of a Compartment must be the identiﬁer of another Compartment deﬁned37\nin the model. (References: L2V1 Section 4.5.6; L2V2 Section 4.7.7; L2V3 Section 4.7.7.)38\n20505. A Compartment may not enclose itself through a chain of references involving the outside attribute.39\nThis means that a compartment cannot have its own identiﬁer as the value of outside, nor can it point40\nto another compartment whose outside attribute points directly or indirectly to the compartment.41\n(References: L2V1 erratum 11; L2V2 Section 4.7.7; L2V3 Section 4.7.7.)42\n147\nNature Precedings : hdl:10101/npre.2007.58.1 : Posted 18 Jun 2007\n20506. The outside attribute value of a given Compartment instance cannot be a compartment having a1\nspatialDimensions value of “ 0”, unless both compartments have spatialDimensions=“0”. Simply2\nput, a zero-dimensional compartment cannot enclose compartments that have anything other than3\nzero dimensions themselves. (References: L2V2 Section 4.7.7; L2V3 Section 4.7.7.)4\n20507. The value of the units attribute on a Compartment having spatialDimensions of “1” must be either5\n“length”, “metre”, “dimensionless”, or the identiﬁer of a UnitDeﬁnition based on either metre (with6\nexponent equal to “ 1”) or dimensionless. (References: L2V1 Section 4.5.4; L2V2 Section 4.7.5;7\nL2V3 Section 4.7.5.)8\n20508. The value of the units attribute on a Compartment having spatialDimensions of “ 2” must be9\neither “ area”, “ dimensionless”, or the identiﬁer of a UnitDeﬁnition based on either metre (with10\nexponent equal to “ 2”) or dimensionless. (References: L2V1 Section 4.5.4; L2V2 Section 4.7.5;11\nL2V3 Section 4.7.5.)12\n20509. The value of the units attribute on a Compartment having spatialDimensions of “ 3” must be13\neither “ volume”, “ litre”, or the identiﬁer of a UnitDeﬁnition based on either litre, metre (with14\nexponent equal to “ 3”), or dimensionless. (References: L2V1 Section 4.5.4; L2V2 Section 4.7.5;15\nL2V3 Section 4.7.5.)16\n20510. If the compartmentType attribute is given a value in a Compartment deﬁnition, it must contain the17\nidentiﬁer of an existing CompartmentType deﬁned in the model. (References: L2V2 Section 4.7.2;18\nL2V3 Section 4.7.2.)19\nSpecies validation20\n20601. The value of compartment in a Species deﬁnition must be the identiﬁer of an existing Compartment21\ndeﬁned in the model. (References: L2V1 Section 4.6.2; L2V2 Section 4.8.3; L2V3 Section 4.8.3.)22\n20602. (Rule does not apply in SBML Level 2 Version 3.)23\n20603. (Rule does not apply in SBML Level 2 Version 3.)24\n20604. If a Species located in a Compartment whose spatialDimensions is set to “ 0”, then that Species25\ndeﬁnition cannot set initialConcentration. (References: L2V1 Section 4.6.3; L2V2 Section 4.8.4;26\nL2V3 Section 4.8.4.)27\n20605. (Rule does not apply in SBML Level 2 Version 3.)28\n20606. (Rule does not apply in SBML Level 2 Version 3.)29\n20607. (Rule does not apply in SBML Level 2 Version 3.)30\n20608. The value of a Species’s substanceUnits attribute can only be one of the following: “ substance”,31\n“mole”, “ item”, “ gram”, “ kilogram”, “ dimensionless”, or the identiﬁer of a UnitDeﬁnition de-32\nrived from “ mole” (with an exponent of “ 1”), “ item” (with an exponent of “ 1”), “ gram” (with33\nan exponent of “ 1”), “ kilogram” (with an exponent of “ 1”), or “ dimensionless”. (References:34\nL2V1 Section 4.6.4; L2V2 Section 4.8.5; L2V3 Section 4.8.5.)35\n20609. A Species cannot set values for both initialConcentration and initialAmount because they are36\nmutually exclusive. (References: L2V1 Section 4.6.3; L2V2 Section 4.8.4; L2V3 Section 4.8.4.)37\n20610. A Species’ quantity cannot be determined simultaneously by both reactions and rules. More formally,38\nif the identiﬁer of a Species deﬁnition having boundaryCondition=“false” and constant=“false”39\nis referenced by a SpeciesReference anywhere in a model, then this identiﬁer cannot also appear as40\nthe value of a variable in an AssignmentRule or a RateRule. (References: L2V1 Section 4.6.5; L2V241\nSection 4.8.6; L2V3 Section 4.8.6.)42\n148\nNature Precedings : hdl:10101/npre.2007.58.1 : Posted 18 Jun 2007\n20611. A Species having boundaryCondition=“false” cannot appear as a reactant or product in any reac-1\ntion if that Species also has constant=“true”. (References: L2V1 Section 4.6.5; L2V2 Section 4.8.6;2\nL2V3 Section 4.8.6.)3\n20612. The value of speciesType in a Species deﬁnition must be the identiﬁer of an existing SpeciesType.4\n(References: L2V2 Section 4.8.2; L2V3 Section 4.8.2.)5\n20613. There cannot be more than one species of a given SpeciesType in the same compartment of a model.6\nMore formally, for any given compartment, there cannot be more than one Species deﬁnition in7\nwhich both of the following hold simultaneously: (i) the Species’ compartment value is set to that8\ncompartment’s identiﬁer and (ii) the Species’ speciesType is set the same value as the speciesType9\nof another Species that also sets its compartment to that compartment identiﬁer. (References: L2V210\nSection 4.8.2; L2V3 Section 4.8.2.)11\n20614. The compartment attribute in a Species is mandatory. A species deﬁnition in a model must include12\na value for this attribute. (References: L2V2 Section 4.8.3; L2V3 Section 4.8.3.)13\nParameter validation14\n20701. The units in a Parameter deﬁnition must be a value chosen from among the following: a built-in15\nunit (e.g., “ substance”, “ time”, etc.), the identiﬁer of a UnitDeﬁnition in the model, or one of the16\npredeﬁned base units in SBML (e.g., “ litre”, “ mole”, “ metre”, etc.). (References: L2V1 Section17\n4.7.3; L2V2 Section 4.9.3; L2V3 Section 4.9.3.)18\nInitialAssignment validation19\n20801. The value of symbol in an InitialAssignment deﬁnition must be the identiﬁer of an existing Com-20\npartment, Species, or Parameter deﬁned in the model. (References: L2V2 Section 4.10.1; L2V321\nSection 4.10.)22\n20802. A given identiﬁer cannot appear as the value of more than one InitialAssignment’s symbol attribute23\nacross the set of all InitialAssignments in a model. (References: L2V2 Section 4.10; L2V3 Section 4.10.)24\n20803. The identiﬁer given as the value of a symbol attribute in any InitialAssignment deﬁnition cannot25\nalso appear as the value of the variable attribute in an AssignmentRule. In other words, a model26\ncannot simultaneously deﬁne both an initial assignment and an assignment rule for the same species,27\ncompartment or parameter in a model. (References: L2V2 Section 4.10.4; L2V3 Section 4.10.)28\nAssignmentRule and RateRule validation29\n20901. The value of an AssignmentRule’s variable must be the identiﬁer of an existing Compartment,30\nSpecies, or globally-deﬁned Parameter. (References: L2V1 Section 4.8.2; L2V2 Section 4.11.3 L2V331\nSection 4.11.3.)32\n20902. The value of a RateRule’s variable must be the identiﬁer of an existing Compartment, Species,33\nor globally-deﬁned Parameter. (References: L2V1 Section 4.8.3; L2V2 Section 4.11.4; L2V3 Sec-34\ntion 4.11.4.)35\n20903. Any Compartment, Species or Parameter whose identiﬁer is the value of a variable attribute in an36\nAssignmentRule, must have a value of “ false” for constant. (References: L2V1 Section 4.8.4; L2V237\nSection 4.11.3; L2V3 Section 4.11.3.)38\n20904. Any Compartment, Species or Parameter whose identiﬁer is the value of a variable attribute in39\na RateRule, must have a value of “ false” for constant. (References: L2V1 Section 4.8.4; L2V240\nSection 4.11.4; L2V3 Section 4.11.4.)41\n20905. (Rule removed because it was eﬀectively a duplicate of 10304.)42\n149\nNature Precedings : hdl:10101/npre.2007.58.1 : Posted 18 Jun 2007\n20906. There must not be circular dependencies in the combined set of InitialAssignment, AssignmentRule1\nand KineticLaw deﬁnitions in a model. Each of these constructs has the eﬀect of assigning a value2\nto an identiﬁer (i.e., the identiﬁer given in the attribute symbol in InitialAssignment, the attribute3\nvariable in AssignmentRule, and the attribute id on the KineticLaw’s enclosing Reaction). Each of4\nthese constructs computes the value using a mathematical formula. The formula for a given identiﬁer5\ncannot make reference to a second identiﬁer whose own deﬁnition depends directly or indirectly on6\nthe ﬁrst identiﬁer. (References: L2V2 Section 4.11.5; L2V3 Section 4.11.5.)7\nConstraint validation8\n21001. A Constraint math expression must evaluate to a value of type boolean. (References: L2V2 Sec-9\ntion 4.12.1; L2V3 Section 4.12.)10\n21002. The order of subelements within Constraint must be the following: math, message. The message11\nelement is optional, but if present, must follow the math element. (References: L2V2 Section 4.12;12\nL2V3 Section 4.12.)13\n21003. The contents of the message element in a Constraint must be explicitly placed in the XHTML XML14\nnamespace. (References: L2V3 Section 4.12.2.)15\n21004. The contents of the message element must not contain an XML declaration (i.e., a string of the form16\n“<?xml version=\"1.0\" encoding=\"UTF-8\"?>” or similar). (References: L2V3 Section 4.12.2.)17\n21005. The contents of the message element must not contain an XML DOCTYPE declaration (i.e., a string18\nbeginning with the characters “ <!DOCTYPE”. (References: L2V3 Section 4.12.2.)19\n21006. The XHTML content inside a Constraint’s message element can only take one of the following general20\nforms: (1) a complete XHTML document beginning with the element <html> and ending with21\n</xhtml>; (2) the “body” portion of a document beginning with the element <body> and ending22\nwith </body>; or (3) XHTML content that is permitted within a <body> ... </body> elements.23\n(References: L2V3 Section 4.12.2.)24\nReaction validation25\n21101. A Reaction deﬁnition must contain at least one SpeciesReference, either in its listOfReactants26\nor its listOfProducts. A reaction without any reactant or product species is not permitted, re-27\ngardless of whether the reaction has any modiﬁer species. (References: L2V2 Section 4.13.1; L2V328\nSection 4.13.3.)29\n21102. The order of subelements within Reaction must be the following (where every one is optional):30\nlistOfReactants, listOfProducts, listOfModifiers, kineticLaw. (References: L2V2 Section 4.13;31\nL2V3 Section 4.13.)32\n21103. The following containers are all optional in a Reaction, but if any present is, it must not be empty:33\nlistOfReactants, listOfProducts, listOfModifiers, kineticLaw. (References: L2V2 Section 4.13;34\nL2V3 Section 4.13.)35\n21104. The list of reactants ( listOfReactants) and list of products ( listOfProducts) in a Reaction can36\nonly contain speciesReference elements. (References: L2V1 Section 4.9; L2V2 Section 4.13; L2V337\nSection 4.13.)38\n21105. The list of modiﬁers ( listOfModifiers) in a Reaction can only contain modifierSpeciesReference39\nelements. (References: L2V1 Section 4.9; L2V2 Section 4.13; L2V3 Section 4.13.)40\nSpeciesReference and ModiﬁerSpeciesReference validation41\n21111. The value of a SpeciesReference species attribute must be the identiﬁer of an existing Species in42\nthe model. (References: L2V1 Section 4.9.5; L2V2 Section 4.13.2; L2V3 Section 4.13.3.)43\n150\nNature Precedings : hdl:10101/npre.2007.58.1 : Posted 18 Jun 2007\n21112. (Rule removed because it was eﬀectively a duplicate of 20611.)1\n21113. A SpeciesReference must not have a value for both stoichiometry and stoichiometryMath; they2\nare mutually exclusive. (References: L2V1 Section 4.9.5; L2V2 Section 4.13.3; L2V3 Section 4.13.3.)3\nKineticLaw validation4\n21121. All species referenced in the KineticLaw formula of a given reaction must ﬁrst be declared using5\nSpeciesReference or ModiﬁerSpeciesReference. More formally, if a Species identiﬁer appears in a6\nci element of a Reaction’s KineticLaw formula, that same identiﬁer must also appear in at least7\none SpeciesReference or ModiﬁerSpeciesReference in the Reaction deﬁnition. (References: L2V28\nSection 4.13.5; L2V3 Section 4.13.5.)9\n21122. The order of subelements within KineticLaw must be the following: math, listOfParameters. The10\nlistOfParameters is optional, but if present, must follow math. (References: L2V2 Section 4.13.5;11\nL2V3 Section 4.13.5.)12\n21123. If present, the listOfParameters in a KineticLaw must not be an empty list. (References: L2V213\nSection 4.13.5; L2V3 Section 4.13.)14\n21124. The constant attribute on a Parameter local to a KineticLaw cannot have a value other than “ true”.15\nThe values of parameters local to KineticLaw deﬁnitions cannot be changed, and therefore they are16\nalways constant. (References: L2V2 Section 4.9.4; L2V3 Section 4.9.4.)17\n21125. (Rule does not apply in SBML Level 2 Version 3.)18\n21126. (Rule does not apply in SBML Level 2 Version 3.)19\nStoichiometryMath validation20\n21131. All species referenced in the StoichiometryMath formula of a given reaction must ﬁrst be declared21\nusing SpeciesReference or ModiﬁerSpeciesReference. More formally, if a Species identiﬁer appears22\nin a ci element of a Reaction’s StoichiometryMath formula, that same identiﬁer must also appear in23\nat least one SpeciesReference or ModiﬁerSpeciesReference in the Reaction deﬁnition. (References:24\nL2V2 Sections 4.13.2 and 4.13.4; L2V3 Sections 4.13.2 and 4.13.4.)25\nEvent validation26\n21201. An Event object must have a trigger. (References: L2V1 Section 4.10.2; L2V2 Section 4.14.1; L2V327\nSection 4.14.2.)28\n21202. An Event trigger expression must evaluate to a value of type boolean. (References: L2V1 Section29\n4.10.2; L2V2 Section 4.14.1; L2V3 Section 4.14.2.)30\n21203. An Event object must have at least one EventAssignment object in its listOfEventAssignments.31\n(References: L2V1 Section 4.10.5; L2V2 Section 4.14; L2V3 Section 4.14.)32\n21204. (Rule does not apply in SBML Level 2 Version 3.)33\n21205. The order of subelements within an Event object instance must be the following: trigger, delay,34\nlistOfEventAssignments. The delay element is optional, but if present, must follow trigger.35\n(References: L2V2 Section 4.14; L2V3 Section 4.14.)36\nEventAssignment validation37\n21211. The value of variable in an EventAssignment can only be the identiﬁer of a Compartment, Species,38\nor model-wide Parameter deﬁnition. (References: L2V1 Section 4.10.5; L2V2 Section 4.14.2; L2V339\nSection 4.14.4.)40\n151\nNature Precedings : hdl:10101/npre.2007.58.1 : Posted 18 Jun 2007\n21212. Any Compartment, Species or Parameter deﬁnition whose identiﬁer is used as the value of variable1\nin an EventAssignment must have a value of “ false” for its constant attribute. (References: L2V12\nSection 4.10.5; L2V2 Section 4.14.2; L2V3 Section 4.14.4.)3\n152\nNature Precedings : hdl:10101/npre.2007.58.1 : Posted 18 Jun 2007\nD A method for assessing whether an SBML model is overdetermined1\nAs explained in Section 4.11.5, an SBML model must not be overdetermined. It is possible to use purely static2\nanalysis to assess this condition for the system of equations implied by a model, by constructing a bipartite3\ngraph of the model’s variables and equations and then searching for a maximal matching ( Chartrand, 1977).4\nA eﬃcient algorithm for ﬁnding a maximal matching is described by Hopcroft and Karp (1973). In this5\nappendix, we provide a concrete application to SBML of the general approach described in Section 4.11.5.6\nThe approach is deﬁned in terms of the ordinary diﬀerential equations (ODEs) implied by an SBML model;7\ndespite our use of a diﬀerential equation framework for this explanation, it should be understood that this8\nuse of ODEs has no implication about the framework actually used to simulate the model.9\nDeﬁnition of the method10\nFirst, we treat both assignment rules and formulas in KineticLaw objects as SBML-style algebraic equa-11\ntions. (Both are essentially assignment statements, and assignment statements can be trivially converted12\nto algebraic equations with zero on the left-hand side.) We also assume that an ODE is constructed for13\neach species determined by one or more Reaction’s KineticLaw math expressions. Finally, we assume that the14\nmodel has already been determined to be valid in all other respects (e.g., there are no undeﬁned variables15\nin the equations), and what remains is to evaluate whether it is overdetermined.16\nWe construct the bipartite graph for a given SBML model as follows:17\n1. For each of the following in the model, create one vertex representing an equation:18\n(a) Every Species object having boundaryCondition=“false”, constant=“false”, and which is19\nreferenced as a reactant or product in one or more Reaction objects containing KineticLaw objects20\n(b) Every AssignmentRule object21\n(c) Every RateRule object22\n(d) Every AlgebraicRule object23\n(e) Every KineticLaw object24\n2. For each of the following in the model, create one vertex representing a variable:25\n(a) Every Species object having constant=“false”26\n(b) Every Compartment object having constant=“false”27\n(c) Every global Parameter having constant=“false”28\n(d) Every Reaction object29\n3. For each of the following, create one edge:30\n(a) Every vertex created in step 2(a) to that species’ equation vertex created in step 1(a)31\n(b) Every vertex created in step 1(b) to the particular vertex created in steps 2(a)–2(d) that represents32\nthe variable referenced by the variable attribute of the rule33\n(c) Every vertex created in step 1(c) to the particular vertex created in steps 2(a)–2(d) that represents34\nthe variable referenced by the variable attribute of the rule35\n(d) Every vertex created in step 1(e) to the particular vertex created in step 2(d) that is the Reaction36\nobject containing that particular KineticLaw object37\n(e) Every vertex created in steps 2(a)–2(d) representing an identiﬁer appearing as the content of a38\nMathML ci element within an expression of an AssignmentRule, to the vertex for that particular39\nAssignmentRule created in step 1(b)40\n(f) Every vertex created in steps 2(a)–2(d) representing an identiﬁer appearing as the content of a41\nMathML ci element within an expression of an AlgebraicRule, to the vertex for that particular42\nAlgebraicRule created in step 1(d)43\n(g) Every vertex created in steps 2(a)–2(c) representing an identiﬁer appearing as the content of44\na MathML ci element within an expression of a KineticLaw, to the vertex for that particular45\nKineticLaw created in step 1(e)46\n153\nNature Precedings : hdl:10101/npre.2007.58.1 : Posted 18 Jun 2007\nExample application of the method1\nWhat follows is an example of applying the method above to the SBML model shown below:2\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>3\n<sbml xmlns=\"http://www.sbml.org/sbml/level2/version3\" level=\"2\" version=\"3\">4\n<model id=\"example\">5\n<listOfUnitDefinitions>6\n<unitDefinition id=\"per_second\">7\n<listOfUnits>8\n<unit kind=\"second\" exponent=\"-1\"/>9\n</listOfUnits>10\n</unitDefinition>11\n</listOfUnitDefinitions>12\n<listOfCompartments>13\n<compartment id=\"C\" size=\"1\"/>14\n</listOfCompartments>15\n<listOfSpecies>16\n<species id=\"S1\" compartment=\"C\" initialConcentration=\"1\"/>17\n<species id=\"S2\" compartment=\"C\" initialConcentration=\"0\"/>18\n</listOfSpecies>19\n<listOfRules>20\n<algebraicRule>21\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\">22\n<apply>23\n<plus/>24\n<ci> S1 </ci>25\n<ci> S2 </ci>26\n</apply>27\n</math>28\n</algebraicRule>29\n</listOfRules>30\n<listOfReactions>31\n<reaction id=\"R\">32\n<listOfReactants>33\n<speciesReference species=\"S1\"/>34\n</listOfReactants>35\n<listOfProducts>36\n<speciesReference species=\"S2\"/>37\n</listOfProducts>38\n<kineticLaw>39\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\">40\n<apply>41\n<times/>42\n<ci> C </ci>43\n<ci> k1 </ci>44\n<ci> S1 </ci>45\n</apply>46\n</math>47\n<listOfParameters>48\n<parameter id=\"k1\" value=\"0.1\" units=\"per_second\"/>49\n</listOfParameters>50\n</kineticLaw>51\n</reaction>52\n</listOfReactions>53\n</model>54\n</sbml>55\nFor the model above, we create equation vertices as follows:56\n1. [Corresponding to step 1(a) in Section D.] Every Species object having boundaryCondition=“ false”,57\nconstant=“ false”, and which is referenced as a reactant or product in one or more Reaction objects58\ncontaining KineticLaw objects. This generates two vertices, for “ S1” and “ S2”.59\n2. [Corresponding to step 1(b) in Section D.] Every AlgebraicRule object. This generates one vertex, for60\nthe model’s lone algebraic rule (call it “ rule”).61\n3. [Corresponding to step 1(e) in Section D.] Every KineticLaw object. This generates one vertex, for the62\nlone kinetic law in the model (call it “ law”).63\n154\nNature Precedings : hdl:10101/npre.2007.58.1 : Posted 18 Jun 2007\nWe create variable vertices for the following:1\n1. [Corresponding to step 2(a) in Section D.] Every Species object having constant=“ false”. This2\ngenerates two vertices, for “ S1” and “ S2”.3\n2. [Corresponding to step 2(b) in Section D.] Every Compartment object having constant=“ false”. This4\ngenerates one vertex, for “ C”.5\n3. [Corresponding to step 2(d) in Section D.] Every Reaction object. This generates one vertex, for “ R”.6\nNote that it is not necessary to include parameters declared within KineticLaw objects because they are local7\nto a particular reaction and cannot be aﬀected by rules. With the steps above, we have the following set of8\ngraph nodes:9\nVertices for equations\nS1 S2 rule law\nS1 S2 C R\nVertices for variables10\nNext, we create edges following the procedure described above. Doing so results in the following graph:11\nVertices for equations\nS1 S2 rule law\nS1\n←←←←←←←←←←←←←←←←←\n←←←←←←←←←←←←←←←←←←←←←←←←←←← S2\n↙↙↙↙↙↙↙↙\nC R\nVertices for variables12\nThe algorithm of Hopcroft and Karp (1973) can now be applied to search for a maximal matching of the13\nbipartite graph. A maximal matching is a graph in which each vertex is connected to at most one other14\nvertex and the maximum possible number of connections have been made. Doing so here results in the15\nfollowing:16\nVertices for equations\nS1 S2 rule law\nS1 S2 C R\nVertices for variables17\nIf the maximal matching of the bipartite graph leaves any equation vertex unconnected, then the model is18\nconsidered overdetermined. That is the case for the example shown here, because the equation vertex for19\n“rule” is unconnected in the maximal matching.20\n155\nNature Precedings : hdl:10101/npre.2007.58.1 : Posted 18 Jun 2007\nE Mathematical consequences of the fast attribute on Reaction1\n(Appendix contributed by James C. Schaﬀ, University of Connecticut Health Center, Connecticut, U.S.A.)2\nSection 4.13.1 described the fast ﬂag available on Reaction. In this appendix, we discuss the principles3\ninvolved in interpreting this attribute in the context of a simple biochemical reaction model. The derivation4\npresented here is not fully rigorous and this section is not considered normative; achieving a higher level of5\nrigor would require considerably more background exposition and a much longer appendix. Nevertheless, we6\nhope this section is suﬃcient to answer unambiguously the question “How should a system of reactions be7\ntreated if some of the reactions have fast=true?”8\nIdentiﬁcation of “fast” reactions9\nFirst, it is worth noting that the identiﬁcation of so-called fast reactions is actually a modeling issue, not an10\nSBML representation issue. The notion of fast reactions is the following. A system may be decomposable11\ninto two sets of reactions, where one set may have characteristic times that are much faster than the other12\ntime scales in the system. An approximation that is sometimes useful is to assume that the fast reactions13\nhave kinetics that settle inﬁnitely fast compared to the other reactions in the system. In other words, the14\nfast reactions are assumed to be always in equilibrium. This is called a pseudo-steady state approximation15\n(PSSA), and is also known as a quasi-steady state approximation (QSSA). Given a case where the time-scale16\nseparation between fast and other reactions in the system is large, an accurate and eﬃcient approach for17\ncomputing the time-course of the system behavior is to treat the fast reactions as being always in equilibrium.18\nThe key to successful application of a PSSA is that there should be a signiﬁcant separation of time scales19\nbetween these fast reactions and other reactions in the system. The determination of which reactions qualify20\nas fast is up to the creator of the model, because there is currently no known general algorithm for doing so.21\nSimple one-compartment biochemical system model22\nTo explain how to solve a system containing fast reactions, we use a simple model of a biochemical reaction23\nnetwork located in a single compartment. Let x∗ represent a vector of all the species in the system, v∗ a24\nvector of the reaction rates, and A∗ the stoichiometry matrix, with the vector dimension being n∗. Then25\nthe system can be described using the following matrix equation:26\ndx∗\ndt = A∗ v∗(x∗)27\nThis system can be optionally reduced by noting that mass conservation usually implies there are linear28\ncombinations of species quantities in the system and the value of these combinations do not change over time.29\nIdentifying these combinations is the topic of structural analysis and is described in the literature ( Reder,30\n1988; Sauro and Ingalls , 2003). Brieﬂy, let N be deﬁned as the left null space of A∗:31\nNA∗ = 032\nNow, premultiply the previous equation by N to get33\nNdx∗\ndt = NA∗v∗(x∗) = 034\nThus, N captures the space of solutions to the equation35\nmT\n(dx∗\ndt\n)\n= 036\nwhere m is a vector representing the coeﬃcients in a mass conservation relationship, that is, combinations37\nof species that are time-invariant. Now, let38\nr = rank(A∗)39\nn = dim(x∗)40\n41\n156\nNature Precedings : hdl:10101/npre.2007.58.1 : Posted 18 Jun 2007\nThen the system has n − r mass conservation relationships, each of which is a linear equation. We can use1\nthese n − r linear equations to solve for n − r dependent variables in terms of r independent variables and2\nthe initial masses of all species. Doing that allows us to decompose x∗ into n − r dependent variables xd3\nand r independent variables xi where L is an ( n − r) × r matrix that is derived from N and represents xd4\nin terms of xi, I is the r × r identity matrix, and T is an n × r matrix:5\nx∗ ≡\n[\nxi\nxd\n]\n=\n[\nI\nL\n]\nxi = Txi6\nUsing this equation, we can deﬁne a new vector of reaction velocities v in terms of xi only:7\nv(xi) ≡ v∗(Txi)8\nWith this v, we can now write a reduced system by substituting terms. First we deﬁne A as the r independent9\nrows of A∗corresponding to xi. Then:10\ndxi\ndt = Av(xi)11\nThis is a set of r independent diﬀerential equations in r unknowns (i.e., an r-dimensional system). To12\nsimplify the notation slightly, let13\nx ≡ xi14\nand, thus,15\ndx\ndt = Av(x)16\nApplication of a PSSA to biochemical systems17\nAssume that we have eliminated redundant variables and equations using the mass conservation analysis18\nabove. Further assume that we have some external means of classifying some reactions in a given system19\nas being fast as discussed earlier. We now need to apply this to the system under study. We begin by20\ndecomposing the vector of reaction velocities v according to fast and slow reactions:21\ndx\ndt = A1vf (x) + A2vs(x)22\nIn the expression above, A1 represents the stoichiometry of the set of reactions operating on the fast time23\nscale, and A2 the stoichiometry of the set of reactions operating on a slower time scale. We ﬁnd the left null24\nspace of A1 (i.e., the space of solutions to mT [dx/dt] = 0 on a fast time scale), and call this matrix B:25\nBA1 = 026\nThe matrix B represents the linear combination of species that do not change on a fast time scale, i.e., the27\nslow species in the system. Now, we premultiply the equation for dx/dt by B:28\nBdx\ndt = BA1vf (x) + BA2vs(x)29\n= BA2vs(x)30\n31\nwhere the second line follows from the fact that BA1 = 0. The above is an ordinary diﬀerential equation in32\nterms of only the slow dynamics. The remaining fast dynamics are handled by applying the pseudo-steady33\nstate approximation, with fast transients assumed to have settled with respect to the slow time scale. This34\nproduces a system of nonlinear algebraic equations:35\nA1vf = 036\nThe last two equations form the system of equations resulting from the application of the PSSA. If r1 =37\nrank(A1) and r = rank( A), then there will be r1 degrees of freedom that will be determined by solving an38\nalgebraic system (the equation A1vf = 0 above), and there will be r − r1 degrees of freedom that will be39\ndetermined by ordinary diﬀerential equations (the equation for Bdx/dt).40\n157\nNature Precedings : hdl:10101/npre.2007.58.1 : Posted 18 Jun 2007\nF Processing and validating SBase notes and Constraint message content1\nIn Section 3.2.3 and Section 4.12.2, we discussed the notes element on Sbase and the message element on2\nConstraint, respectively. These elements can contain a number of possible forms of XHTML content. In3\nthis appendix, we describe a general procedure for how application software can process such content. We4\nconcentrate on the common case of an SBML-reading application that needs to take the contents and pass5\nit to an XHTML display and/or editing function obtained from a third-party API library. The content of6\nthe notes and message may not be a complete XHTML document, so the application will have to perform7\nsome processing before handing it to the XHTML editor or validator. How should this be done?8\nBased on the three forms of Sbase notes content described in Section 3.2.3 and the identical forms for9\nConstraint message described in Section 4.12.2, there are only three cases possible. Here we give an example10\napproach for handling them, although the actual implementation details will diﬀer depending on various11\nfactors such as the requirements of the software libraries being used. This example approach would be12\nperformed for each notes and message to be viewed or edited:13\nStep 1 . If the XHTML viewing/editing function requires a fully compliant XML document, the SBML14\napplication could create a temporary data object containing an appropriate XML declaration and a15\nDOCTYPE declaration; otherwise, the XML data object can be initially blank.16\nStep 2 . The application should look at the ﬁrst element inside the notes or message (or rather, the ﬁrst17\nelement that is not an XML comment), and take action based on the following three possibilities:18\n• If the ﬁrst element begins with <html xhtml=\"http://www.w3.org/1999/xhtml\">, the application19\ncould assume that the content is a complete XHTML document and insert this into the temporary20\ndata object.21\n• Else, if the ﬁrst element is <body>, the application should insert the following into the temporary22\ndata object,23\n<html xhtml=\"http://www.w3.org/1999/xhtml\">24\n<head><title></title></head>25\nthen insert the content of the notes or message, and ﬁnally insert a closing </html>.26\n• Else, if the content begins with neither of the above elements, the application should insert the27\nfollowing into the temporary data object,28\n<html xhtml=\"http://www.w3.org/1999/xhtml\">29\n<head><title></title></head>30\n<body>31\nthen insert the content of the notes or message, and ﬁnally insert </body></html> to close the32\nXHTML document.33\nThe result of the above would be a temporary XML data object that the application could then pass to the34\nXHTML viewing/editing API function.35\n158\nNature Precedings : hdl:10101/npre.2007.58.1 : Posted 18 Jun 2007\nG Major changes between versions of SBML Level 2 and implications for back-1\nward compatibility2\nIn Section 1.3, we summarized the language features removed and deprecated in SBML Level 2 Version 3.3\nHere we describe the changes in more detail. We describe the cumulative changes introduced since SBML4\nLevel 2 Version 1.5\nG.1 Between Version 2 and Version 16\nThe following features were removed between SBML Level 2 Version 1 and Version 2:7\n• The offset attribute on UnitDeﬁnition. (See Section 4.4.2.) The deﬁnition of oﬀsets in SBML Level 28\nVersion 1 was in fact incorrect; moreover, a proper implementation would have required a complete9\nchange in the SBML unit scheme. Few models appeared to use oﬀsets on unit deﬁnitions, so the impact10\nof this change on models is expected to be small.11\n• The “Celsius” predeﬁned unit. (See Section 4.4.2.) The removal of oﬀsets on unit deﬁnitions meant an12\ninconsistency existed if the Celsius predeﬁned unit was left in the system. Removing Celsius removes13\nthe inconsistency. Alternative ways of using Celsius are discussed in Section 4.4.2.14\n• The substanceUnit and timeUnits attributes on KineticLaw. (See Section 4.13.5.) The ability to15\nredeﬁne the substance units on each reaction separately, coupled with other features in SBML Level 216\nVersion 1, created the opportunity for deﬁning a valid system of reactions which potentially could not17\nbe combined into a consistent system of equations without external knowledge.18\nThe following features were deprecated between SBML Level 2 Version 1 and Version 2:19\n• The charge attribute on Species. (See Section 4.8.7.) This attribute does not appear to be supported20\nby any existing software, and moreover, since its value cannot be accessed from mathematical formulas21\nin SBML, the impact of this change is expected to be small.22\nThe following additional changes were made between SBML Level 2 Version 1 and Version 3:23\n• SBML Level 2 Version 1 did not clearly specify the value space of integer and ﬂoating-point numbers24\npermitted in the MathML expressions in SBML; moreover, it used the XML Schema type “ integer”25\ninstead of SBML Level 2 Version 2’s “ int”. Although extremely unlikely, some previously valid SBML26\nLevel 2 Version 1 documents may not be valid in Version 2 and Version 3 as a result of these changes.27\nSee Sections 3.1.3, 3.1.5 and 3.4.2 for more information.28\n• SBML Level 2 Version 1 did not deﬁne a default value for the attribute fast on Reaction. SBML29\nLevel 2 Version 2 introduced a default value, and the value is “ false”. Further, SBML now requires30\nthat software tools must respect the value or indicate to the user that they do not have the capacity31\nto do so. See Section 4.13.1.32\n• As of SBML Level 2 Version 2, SBML is somewhat stricter about how the content of annotation33\nelements must be organized and written.. Previously valid SBML Level 2 Version 1 documents may34\nneed changes to their annotation elements to comply with the speciﬁcation beginning with Version 235\nand Version 3. See Section 3.2.4 for more details.36\n• As of SBML Level 2 Version 2, SBML is slightly stricter about how the content of notes elements must37\nbe organized. Previously valid SBML Level 2 Version 1 documents may need changes to their notes38\nelements to comply with the speciﬁcation beginning with Version 2 and Version 3. See Section 3.2.339\nfor more details.40\n• SBML Level 2 Version 2 corrected numerous errata and ambiguities discovered in SBML Level 241\nVersion 1. These errata are listed on the project web site at http://sbml.org. As a result of changes42\n159\nNature Precedings : hdl:10101/npre.2007.58.1 : Posted 18 Jun 2007\nto SBML Level 2 implied by these errata, some existing SBML Level 2 Version 1 models, even when1\nmodiﬁed as explained above, may still not be compliant with Version 2 or Version 3. The ultimate2\nimpact of the changes depends on the speciﬁc features used by a given model and the assumptions3\nunder which the model was created.4\nG.2 Between Version 3 and Version 25\nThe following features were removed between SBML Level 2 Version 2 and Version 3:6\n• The spatialSizeUnits attribute on Species. (See Section 4.8.5.) This attribute introduced an implicit7\nunit conversion between the spatial units used in deﬁning the quantity of a species and the size of8\nthe compartment in which the species was located. Moreover, the semantics of spatialSizeUnits9\nwere confusing and required complicated unit conversions to be written explicitly into reaction rate10\nexpressions by either the modeler or the software. Although the conversions could be worked out11\nunambiguously, the potential for error was judged to exceed by far the utility of this feature.12\n• The timeUnits attribute Event. (See Section 4.14.) This attribute was judged to add needless com-13\nplexity and inconsistency. For instance, the ability to change the time units of the delay of an Event14\nto be diﬀerent from the units of time for the whole model meant that computing an Event’s time of15\ntriggering and its delay might have to be done using two diﬀerent sets of units. The ability to redeﬁne16\nthe units of time for the delay of an Event was also inconsistent with the lack of such an attribute on17\nother SBML components involving an element of time; for example, RateRule, and now KineticLaw,18\nhave no such attributes.19\nThe following additional changes were made between SBML Level 2 Version 2 and Version 3:20\n• The deﬁnition of the XML type ID was incorrectly given in the SBML Level 2 Version 2 speciﬁcation.21\nThis type is used as the type of the attribute metaid on Sbase. The error in the deﬁnition of ID22\nwas such that the type did not include the colon ( :) character and all Unicode characters actually23\npermitted in XML ID. This change is therefore entirely backward compatible: all models with valid24\nmetaid values valid prior to SBML Level 2 Version 3 are still valid under the new deﬁnition.25\n• The SBML speciﬁcations prior to SBML Level 2 Version 3 did not indicate what units are as-26\nsumed for literal numbers appearing in MathML expressions (i.e., numbers inside MathML’s cn el-27\nements). SBML Level 2 Version 3 stipulates that there are no units associated with numbers (not even28\n“dimensionless”), and provides suggestions for how to associate units with numbers (Section 3.4.2).29\n• The SBML speciﬁcations prior to SBML Level 2 Version 3 did not make clear what units are required30\nby the arguments to various MathML operators and other constructs. SBML Level 2 Version 3 clariﬁes31\nthis (Section 3.4.10).32\n• The UnitKind enumeration previously deﬁned in the context of Unit and UnitDeﬁnition has been elim-33\ninated in favor of simply deﬁning the symbols as reserved words in the value space of UnitSId. This34\nhas no eﬀect on written models and is completely backward compatible. It was done to resolve the35\nproblem that, previously, the values in UnitKind were technically inaccessible from attributes whose36\ndata type was UnitSId.37\n• The SBML speciﬁcation did not point out that the value space of the data type boolean is diﬀer-38\nent in MathML 2.0 and XML Schema 1.0. This means that the permitted values of attributes on39\nSBML objects is diﬀerent from the values permitted in MathML formulas. (Section 3.1.2 explains the40\ndiﬀerence.)41\n• The SBML speciﬁcations were inconsistent about the permitted number of items inside listOf42\nlists: the text portion of the speciﬁcations claimed the lists could have zero length, but the XML Schema43\ndeﬁnition for SBML required one or more items. As of SBML Level 2 Version 3, the speciﬁcation is44\nconsistent on requiring one or more items inside these lists.45\n160\nNature Precedings : hdl:10101/npre.2007.58.1 : Posted 18 Jun 2007\n• The SBO term hierarchy (Section 5) has grown in the time intervening between SBML Level 2 Version 21\nand Version 3, and the mapping of terms between SBO and SBML components was revised as a result2\nof community discussions during the 2006 SBML Forum meeting.3\n• The sboTerm attribute, introduced on many components in SBML Level 2 Version 2, has been moved4\nto Sbase as an optional attribute and removed from the individual components. The result is that5\nall model components may now have SBO terms associated with them. This change is completely6\nbackward compatible.7\n• A number of validation rules in Appendix C have been introduced; some were missing from previous8\nspeciﬁcations, and some were added to cover changes introduced in SBML Level 2 Version 3 (for9\nexample, for validation of SBO terms assigned to various SBML model components).10\n• The SBML speciﬁcations prior to SBML Level 2 Version 3 did not adequately explain the assumptions11\nregarding XML namespace declarations within the annotation element on SBML components. SBML12\nLevel 2 Version 3 makes these assumptions more explicit, including the assumption that applications13\nmay not preserve another applications annotations unless those annotations are self-contained with the14\nXML Namespace declaration. See Section 3.2.4 for more details.15\n161\nNature Precedings : hdl:10101/npre.2007.58.1 : Posted 18 Jun 2007\nReferences1\nAbbott, A. (1999). Alliance of US labs plans to build map of cell signalling pathways. Nature, 402:219–200.2\nAbramowitz, M. and Stegun, I. A., editors (1977). Mathematical Fuctions: With Formulas, Graphs, and3\nMathematical Tables. Dover Publications Inc.4\nAusbrooks, R., Buswell, S., Carlisle, D., Dalmas, S., Devitt, S., Diaz, A., Froumentin, M., Hunter, R., Ion,5\nP., Kohlhase, M., Miner, R., Poppelier, N., Smith, B., Soiﬀer, N., Sutor, R., and Watt, S. (2003). Math-6\nematical Markup Language (MathML) Version 2.0 (second edition): W3C Recommendation 21 October7\n2003. Available via the World Wide Web at http://www.w3.org/TR/2003/REC-MathML2-20031021/.8\nBiron, P. V. and Malhotra, A. (2000). XML Schema part 2: Datatypes (W3C candidate recommendation9\n24 October 2000). Available via the World Wide Web at http://www.w3.org/TR/xmlschema-2/.10\nBosak, J. and Bray, T. (1999). XML and the second-generation Web. Scientiﬁc American , 280(5):89–93.11\nBray, T., D. Hollander, D., and Layman, A. (1999). Namespaces in XML. World Wide Web12\nConsortium 14-January-1999. Available via the World Wide Web at http://www.w3.org/TR/1999/13\nREC-xml-names-19990114/ .14\nBray, T., Paoli, J., Sperberg-McQueen, C. M., and Maler, E. (2000). Extensible markup language (XML)15\n1.0 (second edition), W3C recommendation 6-October-2000. Available via the World Wide Web at http:16\n//www.w3.org/TR/1998/REC-xml-19980210.17\nBray, T., Paoli, J., Sperberg-McQueen, C. M., Maler, E., and Yergeau, F. (2004). Extensible markup18\nlanguage (XML) 1.0 (third edition), W3C recommendation 4-February-2004. Available via the World19\nWide Web at http://www.w3.org/TR/2004/REC-xml-20040204.20\nBureau International des Poids et Mesures (2000). The International System of Units (SI) supplement21\n2000: addenda and corrigenda to the 7th edition (1998). Available via the World Wide Web at http:22\n//www.bipm.fr/pdf/si-supplement2000.pdf.23\nChartrand, G. (1977). Introductory Graph Theory . Dover Publishing, Inc., New York.24\nDCMI Usage Board (2005). DCMI Metadata Terms. Available via the World Wide Web at http://www.25\ndublincore.org/documents/dcmi-terms/.26\nDublin Core Metadata Initiative (2005). Dublin core metadata initiative. Available via the World Wide27\nWeb at http://dublincore.org/.28\nEriksson, H.-E. and Penker, M. (1998). UML Toolkit. John Wiley & Sons, New York.29\nFallside, D. C. (2000). XML Schema part 0: Primer (W3C candidate recommendation 24 October 2000).30\nAvailable via the World Wide Web at http://www.w3.org/TR/xmlschema-0/.31\nGillespie, D. (1977). Exact stochastic simulation of coupled chemical reactions. J. Phys. Chem. , 81:2340–32\n2361.33\nGilman, A. (2000). A letter to the signaling community. Alliance for Cellular Signaling, The University34\nof Texas Southwestern Medical Center. Available via the World Wide Web at http://afcs.swmed.edu/35\nafcs/Letter_to_community.htm.36\nHarold, E. R. and Means, E. S. (2001). XML in a Nutshell . O’Reilly & Associates.37\nHedley, W. J., Nelson, M. R., Bullivant, D., Cuellar, A., Ge, Y., Grehlinger, M., Jim, K., Lett, S., Nickerson,38\nD., Nielsen, P., and Yu, H. (2001). CellML speciﬁcation. Available via the World Wide Web at http:39\n//www.cellml.org/public/specification/20010810/cellml_specification.html.40\nHopcroft, J. E. and Karp, R. M. (1973). An n5/2 algorithm for maximum matchings in bipartite graphs.41\nSIAM Journal on Computing , 2(4):225–231.42\n162\nNature Precedings : hdl:10101/npre.2007.58.1 : Posted 18 Jun 2007\nHucka, M., Finney, A., Sauro, H. M., and Bolouri, H. (2001). Systems Biology Markup Language (SBML)1\nLevel 1: Structures and facilities for basic model deﬁnitions. Available via the World Wide Web at2\nhttp://www.sbml.org.3\nHucka, M., Finney, A., Sauro, H. M., Bolouri, H., Doyle, J. C., Kitano, H., Arkin, A. P., Bornstein, B. J.,4\nBray, D., Cornish-Bowden, A., Cuellar, A. A., Dronov, S., Gilles, E. D., Ginkel, M., Gor, V., Goryanin, I. I.,5\nHedley, W. J., Hodgman, T. C., Hofmeyr, J.-H., Hunter, P. J., Juty, N. S., Kasberger, J. L., Kremling, A.,6\nKummer, U., Le Nov` ere, N., Loew, L. M., Lucio, D., Mendes, P., Minch, E., Mjolsness, E. D., Nakayama,7\nY., Nelson, M. R., Nielsen, P. F., Sakurada, T., Schaﬀ, J. C., Shapiro, B. E., Shimizu, T. S., Spence,8\nH. D., Stelling, J., Takahashi, K., Tomita, M., Wagner, J., and Wang, J. (2003). The Systems Biology9\nMarkup Language (SBML): A medium for representation and exchange of biochemical network models.10\nBioinformatics, 19(4):524–531.11\nIannella, R. (2001). Representing vCard objects in RDF/XML. Available via the World Wide Web at12\nhttp://www.w3.org/TR/vcard-rdf.13\nJacobs, I. (2004). World wide web consortium process document. Available via the World Wide Web at14\nhttp://www.w3.org/2004/02/Process-20040205/.15\nKokkelink, S. and Schw¨ anzl, R. (2002). Expressing qualiﬁed Dublin Core in RDF/XML. Available via the16\nWorld Wide Web at http://dublincore.org/documents/dcq-rdf-xml/index.shtml.17\nLassila, O. and Swick, R. (1999). Resource description framework (RDF) model and syntax speciﬁcation.18\nAvailable via the World Wide Web at http://www.w3.org/TR/REC-rdf-syntax/.19\nLe Nov` ere, N., Finney, A., Hucka, M., Bhalla, U., Campagne, F., Collado-Vides, J., Crampin, E. J., Halstead,20\nM., Klipp, E., Mendes, P., Nielsen, P., Sauro, H., Shapiro, B., Snoep, J. L., Spence, H. D., and Wanner,21\nB. L. (2005). Minimum information requested in the annotation of biochemical models (MIRIAM). Nature22\nBiotechnology, 23:1509–1515.23\nOestereich, B. (1999). Developing Software with UML: Object-Oriented Analysis and Design in Practice .24\nAddison-Wesley Publishing Company.25\nPemberton, S., Austin, D., Axelsson, J., Celik, T., Dominiak, D., Elenbaas, H., Epperson, B., Ishikawa, M.,26\nMatsui, S., McCarron, S., Navarro, Peruvemba, S., Relyea, R., Schnitzenbaumer, S., and Stark, P. (2002).27\nXHTML\nTM\n1.0 the Extensible HyperText Markup Language (second edition): W3C Recommendation 2628\nJanuary 2000, revised 1 August 2002. Available via the World Wide Web at http://www.w3.org/TR/29\nxhtml1/.30\nPopel, A. and Winslow, R. L. (1998). A letter from the directors. . . . Center for Computational Medicine31\n& Biology, Johns Hopkins School of Medicine, Johns Hopkins University. Available via the World Wide32\nWeb at http://www.bme.jhu.edu/ccmb/ccmbletter.html.33\nPowell, A. and Johnston, P. (2003). Guidelines for implementing Dublin Core in XML. Available via the34\nWorld Wide Web at http://dublincore.org/documents/dc-xml-guidelines/index.shtml.35\nReder, C. (1988). Metabolic Control Theory: a structural approach. Journal of Theoretical Biology , 135:175–36\n201.37\nSauro, H. M. and Ingalls, B. (2003). Conservation analysis in biochemical networks: Computational issues38\nfor software writers. Available via the World Wide Web at http://www.math.uwaterloo.ca/˜bingalls/39\nPubs/conservation.pdf.40\nSmaglik, P. (2000). For my next trick. . . . Nature, 407:828–829.41\nThompson, H. S., Beech, D., Maloney, M., and Mendelsohn, N. (2000). XML Schema part 1: Structures42\n(W3C candidate recommendation 24 October 2000). Available via the World Wide Web at http://www.43\nw3.org/TR/xmlschema-1/.44\n163\nNature Precedings : hdl:10101/npre.2007.58.1 : Posted 18 Jun 2007\nUnicode Consortium (1996). The Unicode Standard, Version 2.0 . Addison-Wesley Developers Press, Reading,1\nMassachusetts.2\nW3C (2000a). Naming and addressing: URIs, URLs, . . . . Available via the World Wide Web at http:3\n//www.w3.org/Addressing/.4\nW3C (2000b). W3C’s math home page. Available via the World Wide Web at http://www.w3.org/Math/.5\nW3C (2004a). Rdf/xml syntax speciﬁcation (revised). Available via the World Wide Web at http://www.6\nw3.org/TR/rdf-syntax-grammar/.7\nW3C (2004b). Resource description framework (RDF). Available via the World Wide Web at http://www.8\nw3.org/RDF/.9\nWilkinson, D. J. (2006). Stochastic Modelling for Systems Biology . Chapman & Hall/CRC.10\nWolf, M. and Wicksteed, C. (1998). Date and time formats. Available via the World Wide Web at http:11\n//www.w3.org/TR/NOTE-datetime.12\nZwillinger, D., editor (1996). Standard Mathematical Tables and Formulae . CRC Press LLC, 30th edition.13\n164\nNature Precedings : hdl:10101/npre.2007.58.1 : Posted 18 Jun 2007"
}