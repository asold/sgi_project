{
    "title": "PhageTerm: a tool for fast and accurate determination of phage termini and packaging mechanism using next-generation sequencing data",
    "url": "https://openalex.org/W2745133479",
    "year": 2017,
    "authors": [
        {
            "id": null,
            "name": "Garneau, Julian R.",
            "affiliations": [
                "Institut Pasteur",
                "Université de Sherbrooke"
            ]
        },
        {
            "id": null,
            "name": "Depardieu, Florence",
            "affiliations": [
                "Institut Pasteur"
            ]
        },
        {
            "id": "https://openalex.org/A4303879849",
            "name": "Fortier, Louis-Charles",
            "affiliations": [
                "Université de Sherbrooke"
            ]
        },
        {
            "id": "https://openalex.org/A4293820153",
            "name": "Bikard, David",
            "affiliations": [
                "Institut Pasteur"
            ]
        },
        {
            "id": null,
            "name": "Monot, Marc",
            "affiliations": [
                "Université de Sherbrooke",
                "Délégation Paris 7",
                "Institut Pasteur",
                "Université Paris Cité"
            ]
        }
    ],
    "references": [
        "https://openalex.org/W2020908290",
        "https://openalex.org/W2134955152",
        "https://openalex.org/W2048583902",
        "https://openalex.org/W2104341696",
        "https://openalex.org/W2093464700",
        "https://openalex.org/W2002841189",
        "https://openalex.org/W2034256074",
        "https://openalex.org/W2044275839",
        "https://openalex.org/W2001483955",
        "https://openalex.org/W2002411289",
        "https://openalex.org/W1985117793",
        "https://openalex.org/W2121581815",
        "https://openalex.org/W2040472162",
        "https://openalex.org/W1984959146",
        "https://openalex.org/W1821288009",
        "https://openalex.org/W1632730578",
        "https://openalex.org/W2036021266",
        "https://openalex.org/W2083772502",
        "https://openalex.org/W2035055416",
        "https://openalex.org/W2120902911",
        "https://openalex.org/W2013257494",
        "https://openalex.org/W1490445073",
        "https://openalex.org/W2065956804",
        "https://openalex.org/W2418604616",
        "https://openalex.org/W2552844454",
        "https://openalex.org/W2510938410",
        "https://openalex.org/W2091728028",
        "https://openalex.org/W2611085928",
        "https://openalex.org/W1604966930",
        "https://openalex.org/W1481940056"
    ],
    "abstract": null,
    "full_text": "1\nSCIentIFIC  REPORTS  | 7: 8292  | DOI:10.1038/s41598-017-07910-5\nwww.nature.com/scientificreports\nPhageTerm: a tool for fast and \naccurate determination of phage \ntermini and packaging mechanism \nusing next-generation sequencing \ndata\nJulian R. Garneau  1,2, Florence Depardi eu3, Louis-Charles Fortier 2, David Bikard  3 & \nMarc Monot  1,2,4\nThe worrying rise of antibiotic resistance in pathogenic bacteria is leading to a renewed interest \nin bacteriophages as a treatment option. Novel sequencing technologies enable description of an \nincreasing number of phage genomes, a critical piece of information to understand their life cycle, \nphage-host interactions, and evolution. In this work, we demonstrate how it is possible to recover \nmore information from sequencing data than just the phage genome. We developed a theoretical and \nstatistical framework to determine DNA termini and phage packaging mechanisms using NGS data. Our \nmethod relies on the detection of biases in the number of reads, which are observable at natural DNA \ntermini compared with the rest of the phage genome. We implemented our method with the creation \nof the software PhageTerm and validated it using a set of phages with well-established packaging \nmechanisms representative of the termini diversity, i.e. 5′cos (Lambda), 3′cos (HK97), pac (P1), headful \nwithout a pac site (T4), DTR (T7) and host fragment (Mu). In addition, we determined the termini of \nnine Clostridium difficile phages and six phages whose sequences were retrieved from the Sequence \nRead Archive. PhageTerm is freely available (https://sourceforge.net/projects/phageterm), as a Galaxy \nToolShed and on a Galaxy-based server (https://galaxy.pasteur.fr).\nBacteriophages (phages), the viruses of Bacteria, come in a diversity of shapes and sizes\n1. They all produce \nvirion particles consisting of the genetic material surrounded by a protein shell (capsid), sometimes with the \npresence of an intervening lipid membrane. Their nucleic acid content can be double stranded DNA (dsDNA), \nsingle-stranded DNA, double-stranded RNA or single-stranded RNA. Different conformations of the nucleic \nacid also exist with some phage genomes being encapsidated as single-stranded circular molecules and others \nas double-stranded linear molecules. The vast majority of phages described to date produce capsids containing \nlinear dsDNA, but even when considering these phages only, an impressive diversity of packaging mechanisms \nhas been described, leading to various type of DNA termini\n2.\nTowards the end of their infection cycle, dsDNA phages generally form concatemers that are cut by the terminase \nduring packaging to form the mature chromosome3. There are four main mechanisms used by phages to recognize \ntheir own DNA (rather than their host’s DNA) and initiate and then terminate its packaging: (i) The terminase can \nrecognize a specific site where it introduces a staggered cut (cos site), thereby generating fixed DNA termini with \ncohesive ends that can either have 5′ or 3′ overhangs (e.g. Lambda\n4, HK975). (ii) A fixed position can be recognized \non the phage DNA where direct terminal repeats (DTR) will be generated by extension synthesis at the 3′ ends of \nstaggered nicks. The size of these DTRs can range from just over a hundred bases (e.g. T36, T77) to more than ten \nthousand bases (e.g. T58, Spo19). Phage N4 carries terminal repeats with an accurate terminus on the left end but \n1Département de Microbiologie, Institut Pasteur, Laboratoire Pathogenèse des bactéries anaérobies, Paris, France. \n2Département de Microbiologie et d’infectiologie, Faculté de Médecine et des Sciences de la Santé, Université \nde Sherbrooke, Sherbrooke, QC, Canada. 3Département de Microbiologie, Institut Pasteur, Groupe Biologie de \nSynthèse, Paris, France. 4Université Paris Diderot, Sorbonne Paris Cité, Paris, France. Correspondence and requests \nfor materials should be addressed to D.B. (email: david.bikard@pasteur.fr) or M.M. (email: marc.monot@pasteur.fr)\nReceived: 26 April 2017\nAccepted: 4 July 2017\nPublished: xx xx xxxx\nOPEN\n\nwww.nature.com/scientificreports/\n2\nSCIentIFIC  REPORTS  | 7: 8292  | DOI:10.1038/s41598-017-07910-5\nseveral possible termini on the right end10. (iii) The terminase can initiate packaging on the phage concatemer at \na specific packaging site (pac site), and the subsequent cuts are made at variable positions, when the phage head \nbecomes full (e.g. P111, P2212). This leads to capsids containing circularly permutated genomes with redundant ends \nused to circularize the phage genome through recombination after injection in the host cell. (iv) T4-like phages use \na variant of this headful packaging mechanism in which no pac site is recognized and packaging is rather initiated \nrandomly13. These phages usually degrade the host DNA, ensuring that only viral DNA is packaged.\nThree less-frequent packaging strategies that do not involve the formation of concatemers must also be consid-\nered: (i) Phage P2 carries a cos site, but the packaging substrate is circular dsDNA14. (ii) Phage Mu replicates through \ntransposition in the host genome and carries pieces of the host DNA as its termini15. (iii) The Bacillus phage phi29 \ncarries covalently-bound proteins at its DNA termini16. When considering the small number of phages for which the \ntermini have been precisely studied, it is likely that yet other packaging mechanisms exist in nature.\nIn this study, we investigated how the information gathered by high-throughput sequencing approaches, in \nparticular Illumina technologies, can be used to predict the DNA termini and packaging mechanisms of dsDNA \nphages. The experimental procedures traditionally used for this purpose rely on the identification and cloning \nof restriction fragments containing the termini. This can be delicate and cumbersome, especially in the case of \ncircularly-permutated phages, for which the packaging sites are located within sub-molar fragments after diges-\ntion\n17. For certain types of termini, traditional procedures of identification require additional work to retrieve the \npackaging orientation, the exact position of the termini, and the cohesive sequence.\nMany high-throughput sequencing methods rely on the random fragmentation of DNA, followed by repair \nof DNA ends and adapter ligation. After the fragmentation process, natural DNA termini are normally present \nonce per phage genome, while DNA ends produced by fragmentation are scattered randomly along the genome \n(Fig. 1A). This means that significantly more reads start at the phage termini position than anywhere else in \nthe genome. This observation was made by several groups, and was recently used by Li et al .\n18 to characterize \nthe DNA termini of several phages. The method used in this study, however, did not consider several common \npackaging modes, relied on arbitrary thresholds to classify the phage packaging mechanisms, and was not robust \nenough to handle poor data quality or uneven coverage.\nWe propose here a theoretical and statistical framework to robustly analyze DNA termini and phage packag-\ning mechanisms using randomly-fragmented next-generation sequencing data. Our methods are implemented \nin the PhageTerm software which we have made freely available. A graphical user interface is also available as a \nGalaxy wrapper at https://galaxy.pasteur.fr and can be installed through the Galaxy public ToolShed repository.\nMethods\nPhageTerm Analysis. Sequencing reads were mapped on the reference to determine the starting position \ncoverage (SPC) as well as the coverage (COV) in each orientation. The fragment coverage was computed by \nconsidering that all the bases between a pair of reads were covered. These values were then used to compute \nthe variable tau : τ = SPC/COV. This variable has several interesting properties that were useful to determine \nDNA termini. We recommend inputting paired-end sequencing information when using PhageTerm to enable \nthe computation of fragment coverage, but most analysis can still be performed using single reads. In that case, \nsequence coverage is computed as an approximation of fragment coverage but with the caveat that the value of τ \nbecomes more complex to interpret (see below).\nCos phages. The coverage at position i (COVi) is determined by the number of fragments that start at position i \n(SPCi) plus the number of fragments that start before i and cover i. In the case of a fixed DNA terminus no reads \nshould start before the terminus. Therefore \n=COViS PCi and τ = 1. Note that different outcomes are expected for \ncos phages, depending on the type of termini, i.e. 5′  or 3′ cohesive ends. The end-repair enzymes typically used \nduring sequencing library preparation fill 5′ overhangs and cut 3′ overhangs. A value of τ = 1 is thus expected for \n3′cos phages. However for 5′cos phages, end-repair produced overlapping ends: fragments that ended at the right \nterminus are seen as covering the left terminus and conversely. The expected value of τ was thus 0.5.\nDTR phages. In the case of DTR phages, for N phage particles in a sample that undergo fragmentation, there \nshould be N fragments that start at the terminus, and N fragments that cover the edge of the repeat on the other \nside of the genome. As a result, τ is expected to be 0.5.\nPac phages. In the case of pac phages, for N phages present in the sample, there should be N/C fragments start-\ning at the pac site, where C is the number of phage genome copies per concatemer. In the same sample, N frag-\nments should cover the pac site position. Therefore, at the pac site position, τ is expected to be:\nτ= \n\n\n\n\n\n\n + \n\n\n=+\nN\nC\nN N\nC\nC/1 /(1) (1)\nThe number of phage genome copies per concatemer (C) reported in the literature is typically smaller than 1019 \nand therefore 0.1 < τ < 0.5.\nSingle-read versus paired-end sequencing.  Note that when single reads are used, sequence coverage \nis computed instead of fragment coverage, which can affect the expected value of τ . In the case of cos phages, if \nthe average fragment length is smaller than the read length, then few to no forward reads are obtained that start \nbefore and cover the left terminus. As a consequence, the expected value of τ at the left terminus is 1. The same \nargument holds in the other orientation. In the case of DTR phages, when the read length is smaller than the aver-\nage fragment length minus the DTR size, then few to no forward reads are obtained that start before and cover the \nwww.nature.com/scientificreports/\n3\nSCIentIFIC  REPORTS  | 7: 8292  | DOI:10.1038/s41598-017-07910-5\nedge of right repeat. This will frequently be the case when sequencing phages with short DTR. As a result, a value \nof τ as high as 1 can be obtained. The same argument holds in the other orientation.\nCalling significant termini. Another interesting property of τ is that its average value at positions along the \ngenome that are not termini is expected to be 1/F, where F is the average fragment size, which can be easily com-\nputed from paired-end sequencing data. Indeed, if the average number of reads that start at a random position \nwas \n=SPC R, then the average number of fragments that cover random positions is COV = R * F and τ= F1/ . \nThe average fragment size in Illumina sequencing libraries usually ranges from <<Fb p300 800 , so τ < 3 * 10−3. \nNote that τ should always be much smaller than the expected value of τ at termini position in any of the situations \ndescribed where τ.≤ ≤01 1. Therefore, peaks in the value τ at termini position can be detected easily in most \ncases. Nonetheless, calling the position of pac sites where τ < 0.5 can be made more difficult because of the exper-\nimental noise introduced in the many steps of library preparation.\nFigure 1. Biases in the number of reads starting at DNA termini. (A) After fragmentation, natural termini are \npresent once per phage genome, while DNA ends produced by fragmentation will fall at random positions along \nthe genome. The black line represents the phage genome, the red squares are the phage termini. (B) Starting \nposition coverage for each strand of six reference phages (Lambda, HK97, T7, P1, T4, Mu).\nwww.nature.com/scientificreports/\n4\nSCIentIFIC  REPORTS  | 7: 8292  | DOI:10.1038/s41598-017-07910-5\nTo assess whether the number of reads starting at a given position along the genome can be considered a sig-\nnificant outlier, PhageTerm first segments the genome according to coverage using a regression tree. This allows \na robust analysis to be performed even in the case of incorrect assemblies where the coverage along the reference \nsequence might be variable. A gamma distribution is then fitted to SPC values for each segment and an adjusted \np-value is computed for each position. A significance threshold of 0.01 was chosen to consider that a peak in τ \nrepresents a valid terminus. Finally, if several peaks with an adjusted p-value lower than 1/G  (phage genome \nlength) were detected within a small sequence window (default: 20 bp), the position was deemed significant. This \nallows detecting packaging sites for which the terminase can cleave at several nearby positions. In such cases, the \nnumber of reads starting at nearby peaks was added for subsequent analysis, and the position of the highest peak \nwas reported.\nPhage classification. The following rules were then applied to classify the phages: when significant peaks \nwith τ > 0.1 were found on both strands, the distance between the peaks was used to differentiate cos phages and \nDTR phages. To our knowledge, the largest cohesive ends described are 19 bases long, reported for phage P217, 20, \nand the smallest DTR, 131 bases from phage T3. We therefore placed a threshold at 20 bp. An additional criterion \nto classify a phage as DTR was that the coverage between the peaks should be at least 10% higher than the average \ncoverage. Phages classified as cos were predicted to have 5′ overhangs if the forward terminus was to the left of the \nreverse terminus, and 3′ overhangs otherwise. When a significant peak with τ > 0.1 was found only on one strand, \nthe phage was considered to be a pac phage. PhageTerm also provides the orientation of packaging for pac phages, \nas determined by the strand carrying the significant peak. PhageTerm returns “Multiple” for phages that contain \nmore than one significant peak on the same strand without τ > 0.35.\nPhages for which no significant peaks were found might either use a headful packaging mechanism without a \npreferred packaging site (T4-like), or be Mu-like phages. To differentiate both possibilities, the software computes \nthe number of fragments for which one read matches the host and the other read matches the phage genome for \npaired-ends, or each side of the same read for single-reads sequencing. Phages in the sample were, on average, \nfragmented into G/F pieces where F is the average fragment size and G the size of the phage genome. In the case \nof Mu-like phages, out of G/F phage fragments, two should be hybrid fragments. The proportion of hybrid frag-\nments is thus expected to be 2 * (F/G). For single-ends sequencing, hybrid fragment size is replaced by the read \nlength. Note that these fragments or reads were only detected if the region spanning the host genome and the \nphage genome were both longer than the seed sequence (S) used to align the reads. The theoretical expectation \nof the proportion of hybrid fragments can thus be corrected as 2 * (F − 2 * S)/G. PhageTerm assigned the Mu-like \nclass if the proportion of hybrid fragments or reads was at least half the expected value. The position of hybrid \nreads on the phage genome was then used to estimate the termini positions. Finally, phages for which no hybrid \nfragments or reads were found were classified as unknown.\nLower than expected τ values could indicate that the phage DNA was contaminated with unpackaged DNA. \nIn the case where this can be excluded, τ values that deviate from the expectations might indicate novel packaging \nmechanisms.\nSome additional information can also be extracted depending on phage characteristics: (i) an estimation of \nconcatemer size for pac phages; and (ii) the cos or DTR sequence located between the two termini. The output of \nthe two methods are consolidated in a detailed PDF report produced at the end of the analysis pipeline. Other \noutputs are also provided: a detailed statistics table (csv format), cohesive ends or direct terminal repeats (fasta \nformat), and the phage genome sequence reorganized according to termini positions and completed with extrem-\nity or repeats if needed. Finally, as a comparison with our method, we also implemented the method from Li et \nal.\n18 (Supplementary Data).\nAvailability and implementation. The PhageTerm software is provided as a command line tool (https://source-\nforge.net/projects/phageterm), as a Galaxy Toolshed, and on a Galaxy web server (https://galaxy.pasteur.fr).\nPhage de novo assembly. To determine the termini of an unknown phage, a first step of de novo assembly was \nrequired to obtain a reference sequence. To validate that this assembly step did not alter the result of the software, \nwe assembled the six reference phages (lambda, HK97, T7, P1, T4 and Mu) de novo using SPAdes21 with standard \noptions. When using a reference assembled de novo  one should consider two possible caveats: (i) assemblers \nfrequently introduce mistakes at the edges of contigs due to the presence of low abundance reads that do not \ncorrespond to the actual phage sequence. This usually results in a drop of coverage at the contig ends. In such \ncases PhageTerm should still be able to call the termini correctly, but we recommend correcting the contig ends \nwhen possible. (ii) In the case of phages with terminal repeats, most assemblers will output a contig with a single \ncopy of the repeat, which is the desired input for PhageTerm. Note, however that some assemblers might create \na contig with a repeat at each end. In such a case PhageTerm will incorrectly call multiple termini. We tested this \nhypothesis using the T7 reference genome (NC_001604, Table S1) and the PhageTerm output was “Multiple” on \nboth strands for the two analysis methods.\nNucleotide sequence accession numbers. The complete genome sequences of phiCD24-1, phiCD111, phiCD146, \nphiCD481-1, phiCD505, phiCD506, phiMMP01, and phiMMP03 were deposited in European Nucleotide \nArchive under the accession no. LN681534, LN681535, LN681536, LN681538, LN681539, LN681540, LN681541, \nLN681542. The de novo assemblies performed on reference phage genomes are available at SourceForge (https://\nsourceforge.net/projects/phageterm). Phages used in this study are described in Table S1. The raw reads data of \nall phages were deposited in sequence read archive (SRA) under the accession number SRP093616 (Table S2).\nwww.nature.com/scientificreports/\n5\nSCIentIFIC  REPORTS  | 7: 8292  | DOI:10.1038/s41598-017-07910-5\nResults\nDifferent mechanisms of DNA packaging can lead to a variety of DNA ends (Supplementary Table  S4). When \nDNA ends occur at fixed or preferred positions along the phage genome, we expect to observe more reads starting \nat these positions than elsewhere in the genome (Fig. 1A). We re-sequenced six well-characterized Escherichia coli \nphages that use various packaging mechanisms (Lambda, HK97, P1, T7, T4, Mu) in order to validate our strategy. \nThe PhageTerm analysis aligns the reads to a reference sequence provided by the user and computes the number \nof reads starting at each position (SPC), the sequence coverage (COV) and a variable tau: \nτ= SPCC OV/ which \ndisplays several useful properties that allows classification of the phages (see materials and methods).\nFixed DNA ends. COS. Cos phages are expected to display a single peak in each orientation with a value \nof 0.5 < τ < 1 (see materials and methods). These phages thus provide a very strong signal and can be easily iden-\ntified. If the phage DNA sample was not contaminated with unpackaged DNA, no reads overlapping the cos site \nshould be detected. As a result, de novo assemblers should naturally place the DNA ends at the contig limits. Note \nthat different results are expected for cos phages with a 5′ overhang and those with a 3′ overhang (Supplementary \nFig. S1). The enzyme typically used during the step of DNA end repair fills 5′  overhangs but degrades 3′  over-\nhangs. As a result, phages with 5′ overhangs are expected to share the same terminal sequence over the length of \nthe cohesive end, while phages with 3′ overhangs will have different terminal sequences. In practice, reads that \ncross the cos  site are frequently recovered from contaminating DNA (prophage or circular forms), which can \nlead the assembler to place the cos site at a random position along the contig. In this case the peak positions will \nfall in close proximity to each other. On the one hand, cos phages with 5′ overhangs will have the forward peak \npositioned to the left of the reverse peak with the region in between showing twice the average sequence coverage \n(Fig. 2A). On the other hand, cos phages with 3′ overhangs are expected to have the forward peak to the right of \nthe reverse peak, and the sequence in between is expected to have a very small coverage (Fig. 2B).\nAs an example of a 5′cos phage, we re-sequenced the well-characterized Siphoviridae coliphage Lambda\n22. The \ntermini are known to consist of 5′  single-stranded cohesive overhangs of 12 bases. As a model for 3′ cos phage, \nwe re-sequenced HK975. The PhageTerm software was able to determine the exact characteristics of Lambda and \nHK97: the nature of the termini (Fig. 1B), the cos mode of packaging and the length of their cohesive sequence \n(Table 1). PhageTerm was also able to accurately recognize phage Efm1 from Enterococcus as a 3′ cos phage23. \nAmong the Clostridium  phages that we sequenced, phiCD481-1 and phiCD506 also matched the theoretical \ndescription of cos phages with 3′ overhangs (Table 2; Fig. 2B).\nDTR. Phages with direct terminal repeats are expected to have one significant peak in each orientation, and the \nforward peak should be to the left of the reverse peak. The region between the peaks should show twice the aver-\nage sequence coverage (Fig. 2C). Because of their terminal redundancy, DNA assemblers typically attribute the \nfirst base of DTR phages randomly. A typical example of this is phage T7, a Podoviridae that has exact short direct \nterminal repeats of 160 bases20. The PhageTerm software was able to determine the exact characteristics of T7: the \nnature of its termini (Fig. 1B), the termini positions, and the exact length of its direct terminal repeats (Table 1).\nFigure 2. Sequence coverage at termini position. The sequence coverage around the termini identified by \nPhageTerm was plotted for the following phages: Lambda, HK97, T7 and P1. Exact termini positions are \nrepresented by dotted red line (Red: left; Green: right). Note the higher coverage obtained for phage P1 after the \npackaging site.\nwww.nature.com/scientificreports/\n6\nSCIentIFIC  REPORTS  | 7: 8292  | DOI:10.1038/s41598-017-07910-5\nHeadful packaging. Phages using a headful packaging mechanism typically generate a concatemer contain-\ning several copies of their genome. During packaging a first cut is made at the packaging site (pac  site), but the \nfollowing cuts are made when the phage head is full, leading to variable positions. The expected value of τ \n(SPC COV/) can be computed as +C1/( 1), where C is the number of phage genome copies per concatemer (see \nmaterial and methods). Because packaging is directional and no precise cut is made upon termination of packag-\ning, a peak is expected only in a single orientation, which also informs us about the direction of packaging. In the \nregion after this peak, where the second cut is made, a slight increase in coverage is expected, as part of this region \nwill be present twice in many phage particles. Note that the signal obtained to determine the position of the pac \nsite is C + 1 times weaker than that for cos phages (Fig. S3). This phenomenon is amplified by the fact that the \ncleavage position of the terminase at pac sites can be imprecise, leading to several possible termini. As an example \nof this packaging mechanism we re-sequenced phage P1, a promiscuous myophage. PhageTerm was able to deter-\nmine the exact characteristics of P1: the nature of the termini (Figs 1B and 2D), the pac mode of packaging and \nan estimation of the average number of genome per concatemer (Tables 1 and 2).\nOther phages have been determined to package their genome through a headful packaging mechanism but \nwith no preferred packaging signal. The packaged phage genomes are circularly permuted with random termini. \nNo signal can be recovered for this type of phage. As expected, PhageTerm wasn’t able to detect any termini when \nanalysing T4, a Myoviridae phage of E. coli (Fig. 1B; Tables 1 and 2).\nMu-like phages. Mu-like phages are temperate phages that amplify their genome through replicative \ntransposition. During packaging, a first cut is made at a given distance from the phage end in the host genome. \nPackaging then proceeds through a headful mechanism with the second cut being made on the other side \nPhage Name Genome Left Right\nClass T/R\nFragment size\nPhages references (G) (τ) (τ) (F)\nLambda 48 kb 0.59 0.41 COS (5′) 126 421\nHK97 39 kb 0.51 0.60 COS (3′) 115 353\nT7 39 kb 0.47 0.51 DTR (short) 594 468\nP1 94 kb 0.20 — Headful (pac) 101 494\nT4 168 kb — — − — 463\nMu 36 kb — — Mu-like — 485\nTable 1. Characteristics of reference phages.\nPhage Name Ends Left Right Class Type\nReference phages\nLambda Non Redundant 10868 10879 COS (5′) Lambda\nHK97 Non Redundant 2047 2036 COS (3′) HK97\nT7 Redundant 7740 7899 DTR (short) T7\nP1 Redundant 54885 Distributed Headful (pac) P1\nT4 Redundant Random Random Headful —\nMu Non Redundant 32031 Random Mu-like Mu\nPhages of C. difficile\nphiCD481-1 Non Redundant 67 55 COS (3′) HK97\nphiCD506 Non Redundant 44 32 COS (3′) HK97\nphiMMP01 Redundant 44435 Distributed Headful (pac) P1\nphiMMP03 Redundant 52254 Distributed Headful (pac) P1\nphiCD211 Redundant 122595 122972 DTR (short) T7\nphiCD146 Redundant 40603 Distributed Headful (pac) P1\nphiCD505 Redundant Multiple Multiple — —\nphiCD111 Redundant Multiple Multiple — —\nphiCD24-1 Redundant Random Random — —\nPhages from SRA\nT3 Redundant 38209 231 DTR (short) T7\nT7 Redundant 7740 7899 DTR (short) —\nEfm1 Non Redundant 1 42597 COS (3′) HK97\nPBES-2 Redundant 200 642 DTR (short) —\nHP1 (nextera) Redundant Multiple Multiple — —\nSlur09 (nextera) Redundant Multiple Multiple — —\nTable 2. Summary of PhageTerm results.\nwww.nature.com/scientificreports/\n7\nSCIentIFIC  REPORTS  | 7: 8292  | DOI:10.1038/s41598-017-07910-5\nof the phage in the host DNA. The packaged DNA termini thus correspond to various fragments of the host \nDNA (Fig. S4). A specific analysis is performed to discover this type of packaging mechanism which relies on \npaired-end sequence information. We looked for hybrid fragments, i.e. pairs of reads where one read matched to \nthe phage genome and the other read matched to the host genome. The expected theoretical proportion of hybrid \nfragments can be computed (see material and methods) and if at least half the expected number of such fragment \nare found, PhageTerm will determine the phage to belong to this class.\nWe re-sequenced phage Mu as the type-phage of this category. PhageTerm results were in line with those \nexpected: no significant peak in the value of τ were found (Fig. 1B), and 2% of hybrid fragments were detected, \nin agreement with a theoretical expectation of 2.5% (Fig.  3). The host termini of Mu are asymmetric, with a \nshort fragment on one side (~50 bp) and a long one on the other side (~2000bp). Unfortunately, the short read \nlength provided by Illumina sequencing does not allow the determination of these fragment sizes easily and \nsystematically.\nPeak size. Another interesting variable to consider when analyzing phage sequencing data is the number of \nreads starting at the termini (T) divided by the average number of reads starting at random positions (R). For \nphages with fixed termini, the size of the signal defined as T /R (R1 in Li et al .\n18) is expected to be equal to the \naverage fragment size (F). Deviations from this expectation might indicate inefficient ligation of the sequencing \nadapters to the phage DNA termini, or the presence of other possible DNA termini. Sequencing results for phage \nT7 were in agreement with this prediction. However, T/R was markedly smaller than expected for phages Lambda \nand HK97 (Table 1). This was presumably due to an inefficient repair of the cohesive ends during our sequencing \nlibrary preparation.\nIn the case of pac phages, an interesting observation is that knowing T/R and F , it is possible to estimate the \nnumber of phage copies per concatemer:\nτ\n=− =∗ −CF R\nT\n1 11 (2)\nFor phage P1 we can estimate the number of phage copies per concatemer to be ~4, in agreement with previ-\nous estimates11.\nAnother aspect to be taken into account is the presence of secondary termini. These features appear when the \nsite of cleavage by the terminase at the pac site is not precise17, which is the case for most headful phages analyzed \nto date17. By default, PhageTerm merges significant peaks close to each other into a single peak at position 54885 \nfor phage P1 (Fig. 4A). However without merging (option «-d» was set to 0), two significant secondary termini \ncould be found at positions 54885 and 54891 (Fig. 4B). Most significantly, the two main pac cleavage sites found \nfor P1 were identical to the one determined by Sternberg and Coulby24 in 1986 (Fig. 4C).\nPhageTerm results. The PhageTerm software produces a detailed report containing several useful plots \n(coverage, SPC), a data table, information about termini types, and packaging mode. A sequence file beginning \nwith the identified terminus is also generated and output. Some additional information is also extracted depend-\ning on phage characteristics: (i) an estimation of the phage concatemers size (pac phages); (ii) the sequence \nlocated between the two termini (cos and DTR).\nClostridium difficile Phages. C. difficile is currently the principal cause of antibiotic-induced infectious diarrhoea \nin humans\n25. Most C. difficile isolates analyzed to date carry one or several prophages; however, only a few of the \nprophages have been fully characterized. The packaging modes of four phages included in this study have been \ndetermined experimentally in our laboratory using the ligation-digestion method and were compared with the \npackaging modes predicted by PhageTerm. PhageTerm determined that phiCD481-1 and phiCD506 were cos  \nFigure 3. Detection of Mu-like phages. Hybrid fragments with one read on the phage genome and one read on \nthe host genome are detected. (A) The sequence coverage of reads belonging to hybrid fragments of phage Mu \nis plotted along the phage genome. (B) Zoom in around the right terminus of phage Mu. The dotted red line \nrepresents the terminus position.\nwww.nature.com/scientificreports/\n8\nSCIentIFIC  REPORTS  | 7: 8292  | DOI:10.1038/s41598-017-07910-5\nphages, and found 13-nt 3′ overhangs for both phages (Table S1). These phages also showed the expected decrease \nin coverage between the termini of 3′cos phages (Fig. 2B). PhiCD146, phiMMP01 and phiMMP03 were found to \nbe pac phages. PhiCD211 was found to have direct terminal repeats of 378 bp. No termini could be detected for \nphiCD505 and phiCD24-1, which could indicate a T4-like packaging mechanism. Finally, phiCD111 showed an \natypical coverage plot, with decreasing coverage after a significant peak at the end of the genome, and another \nsignificant peak at another distant position. No packaging mechanism could be assigned to this phage.\nSRA Phages. To test the versatility and robustness of the PhageTerm software on data generated by others, we have \ndownloaded the raw sequencing data of six phages (T3, T7, HP1, Efm1, Slur09, and PBES-2) from the sequence \nread archive (SRA). Among these phages, four have known termini and packaging modes (T7, T3, HP1, and Efm1; \ndetailed in supplementary table S1). PhageTerm was able to identify the correct termini and packaging modes for T3 \nand T7, along with exact short DTRs of 160 and 231 bases, respectively. For phage Efm1 and PBES-2, the PhageTerm \nsoftware found a 3′ cohesive sequence of nine bases and direct terminal repeats of 443 bases, respectively.\nUser Phages. In the SourceForge deposit (https://sourceforge.net/projects/phageterm), we will also add inter-\nesting reports with user’s consent. One such example of an interesting report is that of Phi85, due to its long DTR.\nAll PhageTerm results are detailed in Table 2 and reports for all phages mentioned in this paper are available \nin the SourceForge deposit.\nImportant note on sequencing library preparation methods. The methods described here rely on \nthe random fragmentation of phage DNA and the availability of DNA termini to adapter ligation. As a conse -\nquence, methods that rely on transposases to ligate the adapters, such as Nextera, should not produce suitable \ndata for PhageTerm and similar strategies\n26. We confirmed this by analyzing the data of phage HP1 and Slur09 \nthat we retrieved from SRA. These phages were sequenced using Illumina Nextera kits, which led to the loss of the \ntermini sequence. As expected no termini could be detected when using the data generated for these two phages.\nTransduction. Bacteriophages can also mediate horizontal gene transfer through transduction. During gen-\neralized transduction, a small number of viral particles can contain random fragments of host DNA, while during \nspecialized transduction, only host DNA near the site of integration of the phage DNA can be transduced.\nFigure 4. Bacteriophage P1 presence of secondary termini. Scatter plot of τ around the termini positions (A) \nwith default surrounding option (20): one significant peak at location 54885 and (B) with surrounding option \nto 0: two close significant peaks appear. (C) Bacteriophage P1 DNA terminus region, arrows above represent the \ntwo main cleavage sites defined by Sternberg and Coulby in 1986, red boxes represent the significant termini \nfound by PhageTerm.\nwww.nature.com/scientificreports/\n9\nSCIentIFIC  REPORTS  | 7: 8292  | DOI:10.1038/s41598-017-07910-5\nTo test if phage capsids contained fragments of the host genome, the reads that did not match the phages \nwere mapped to the host sequence, if provided. Note that the abundance of these reads only reflect transduction \nfrequencies if the phage capsids were purified in a manner that excludes possible contaminations by host DNA. \nPhages P1 and Lambda were carefully purified to avoid such contaminations (Supplementary Data). P1 is known \nto cause generalized transduction while Lambda is not. As expected 3.8% of the reads obtained for P1 matched its \nhost genome while only 0.01% of the reads obtained for Lambda did.\nSpecialized transduction. To test if phage capsids contained host DNA fused with phage DNA, we located the \nsection of the hybrid fragments belonging to the host on the chromosome of the host. Peaks could be detected for \nall lysogenic phages at their attachment site in the host genome. The fragments detected could either come from \nspecialized transduction or from host DNA contamination in the sample.\nDiscussion\nPhageTerm provides a simple interface for biologists to decipher phage termini and mode of packaging using \nNGS data. Our strategy relies on the analysis of the number of reads starting at each position along the genome \ndivided by sequence coverage. This value, that we termed τ, has several informative properties that allow for the \neasy classification of phage types. This value is expected to be \nτ.≤ ≤05 1 for cos and DTR phages, and \n+~ C1/(1 ) for pac phages where C is the number of phage copies per concatemer. Depending on the number of \nsignificant peaks that are detected, their size and orientation, it is possible to classify phages according to 6 types: \n3′cos, 5′cos, short DTR, long DTR, headful with no pac detected, and headful with a pac site. An additional anal-\nysis of hybrid fragments carrying both phage and host DNA allows the identification of phages that amplify \nthrough replicative transposition (Mu-like phages). When no termini are detected and the phage cannot be clas-\nsified as Mu-like, PhageTerm currently does not make any prediction of the packaging mechanism. In such cases, \nif the user is confident that the phage genome provided is complete, it can likely be classified as a T4-like phage. \nHowever, we cannot exclude other possible mechanisms such as a phi29-like packaging strategy\n16, which involves \nproteins covalently bound to the DNA termini. If proteins are not removed before adapter ligation during the \nsequencing library preparation, then we do not expect to obtain a signal with our strategy.\nTo compare our strategy with previous work, we also implemented the approach described by Li et al.\n18. In this \nwork, the authors analysed the number of reads starting at each position along the genome and classified the phages \naccording to the number and orientation of peaks, their size and the ratio of the first peak to the second peak. In \nmost cases, both methods gave identical results, although PhageTerm performed a more fine-grained classification. \nA few cases highlight the benefits of using our method instead of the crude number of reads starting at the termini. \nClostridium phage phiCD146 has a duplicated region that was collapsed during the de novo assembly. This can be seen \nas a sudden increase of coverage in this region. Li’s method assigned a wrong terminus in this high-coverage region, \nwhile PhageTerm was able to classify the packaging strategy of this phage. In another example, the Clostridium phage \nphiCD481-1 was correctly identified as a 3′cos phage by PhageTerm, whereas Li’s method mistakenly classified it as a \npac phage, missing a peak in the reverse orientation where the coverage was unexpectedly low.\nIn previous work, other strategies have been developed to identify packaging mechanisms. In a recent publi-\ncation by Rashid, J. et al.\n27 analyzing termini and packaging of C. difficile phages, researchers inferred packaging \nmechanism by looking at homologies between the terminase of newly-sequenced phages and that of phages with \nknown packaging mechanisms. This strategy only provides partial and uncertain information about packaging \nmode and no information on termini type and sequences. Recently, another study made available a procedure \nto analyze whole genomes, physical ends and packaging strategies of phages using a pre-existing software\n28. This \nprocedure can be very time-consuming and contains numerous steps requiring bioinformatic skills, including \nthe installation of the Phamerator program\n29 and the management of the related SQL databases. Finally, a con-\ncomitant study30 predicted genome terminus by calculating two criteria, read edge frequencies and neighboring \ncoverage ratio. Finding these procedures heavy and unwieldy for most phage scientists was that motivated us to \ndevelop PhageTerm as an easy-to-use program that consolidates into a single straightforward analysis numerous \nhighly-valuable pieces of information about phage termini and packaging mode.\nPhageTerm provides a rapid and reliable analysis of NGS data to determine phage termini and packaging \nmode, as long as sequencing data is generated following two simple rules: (i) random fragmentation should \nalways be used when preparing sequencing libraries, and (ii) paired-end sequencing should be used to obtain \na more complete characterization of the termini. Based on our data, PhageTerm outperformed other available \nphage analysis software by the accuracy of its analyses, its simplicity of its use, and the detailed reports it generates.\nIncreasing the availability of information on phage termini will shed light on the diversity of packaging mechanisms \nin nature. PhageTerm will assign termini regardless of whether it corresponds to a known phage packaging mechanism. \nAs such, the software might help in the identification of novel packaging strategies. We encourage scientist community \nto contact us in the case of such discovery and we will be happy to update the software to better take into account any \nnovel class. Finally, similar approaches should be possible to determine the termini of Archaea and eukaryotic viruses.\nReferences\n 1. King, M. Q., Lefkowitz, E., Adams, M. J. & Carstens, E. B. Virus Taxonomy: Ninth Report of the International Committee on \nTaxonomy of Viruses. Vol. 978 (2011).\n 2. Roos, W . H., Ivanovska, I. L., Evilevitch, A. & Wuite, G. J. Viral capsids: mechanical characteristics, genome packaging and delivery \nmechanisms. Cell Mol Life Sci 64, 1484–1497, doi:10.1007/s00018-007-6451-1 (2007).\n 3. Black, L. W . DNA packaging in dsDNA bacteriophages. Annu Rev Microbiol 43, 267–292, doi:10.1146/annurev.mi.43.100189.001411 \n(1989).\n 4. Feiss, M., Widner, W ., Miller, G., Johnson, G. & Christiansen, S. Structure of the bacteriophage lambda cohesive end site: location of \nthe sites of terminase binding (cosB) and nicking (cosN). Gene 24, 207–218 (1983).\nwww.nature.com/scientificreports/\n10\nSCIentIFIC  REPORTS  | 7: 8292  | DOI:10.1038/s41598-017-07910-5\n 5. Juhala, R. J. et al . Genomic sequences of bacteriophages HK97 and HK022: pervasive genetic mosaicism in the lambdoid \nbacteriophages. J Mol Biol 299, 27–51, doi:10.1006/jmbi.2000.3729 (2000).\n 6. Pajunen, M. I., Elizondo, M. R., Skurnik, M., Kieleczawa, J. & Molineux, I. J. Complete nucleotide sequence and likely \nrecombinatorial origin of bacteriophage T3. J Mol Biol 319, 1115–1132, doi:10.1016/S0022-2836(02)00384-4 (2002).\n 7. Dunn, J. J. & Studier, F . W . Complete nucleotide sequence of bacteriophage T7 DNA and the locations of T7 genetic elements. J Mol \nBiol 166, 477–535 (1983).\n 8. Wang, J. et al. Complete genome sequence of bacteriophage T5. Virology 332, 45–65, doi:10.1016/j.virol.2004.10.049 (2005).\n 9. Stewart, C. R. et al . The genome of Bacillus subtilis bacteriophage SPO1. J Mol Biol  388, 48–70, doi:10.1016/j.jmb.2009.03.009  \n(2009).\n 10. Ohmori, H., Haynes, L. L. & Rothman-Denes, L. B. Structure of the ends of the coliphage N4 genome. J Mol Biol 202, 1–10 (1988).\n 11. Bachi, B. & Arber, W . Physical mapping of BglII, BamHI, EcoRI, HindIII and PstI restriction fragments of bacteriophage P1 DNA. \nMol Gen Genet 153, 311–324 (1977).\n 12. Tye, B. K., Huberman, J. A. & Botstein, D. Non-random circular permutation of phage P22 DNA. J Mol Biol 85, 501–528 (1974).\n 13. Kalinski, A. & Black, L. W . End structure and mechanism of packaging of bacteriophage T4 DNA. J Virol 58, 951–954 (1986).\n 14. Pruss, G. J. & Calendar, R. Maturation of bacteriophage P2 DNA. Virology 86, 454–467 (1978).\n 15. George, M. & Bukhari, A. I. Heterogeneous host DNA attached to the left end of mature bacteriophage Mu DNA. Nature  292, \n175–176 (1981).\n 16. Bjornsti, M. A., Reilly, B. E. & Anderson, D. L. Morphogenesis of bacteriophage phi 29 of Bacillus subtilis: oriented and quantized in \nvitro packaging of DNA protein gp3. J Virol 45, 383–396 (1983).\n 17. Casjens, S. R. & Gilcrease, E. B. Determining DNA packaging strategy by analysis of the termini of the chromosomes in tailed-\nbacteriophage virions. Methods Mol Biol 502, 91–111, doi:10.1007/978-1-60327-565-1_7 (2009).\n 18. Li, S. et al . Scrutinizing virus genome termini by high-throughput sequencing. PLoS One 9, e85806, doi: 10.1371/journal.\npone.0085806 (2014).\n 19. Skorupski, K., Pierce, J. C., Sauer, B. & Sternberg, N. Bacteriophage P1 genes involved in the recognition and cleavage of the phage \npackaging site (pac). J Mol Biol 223, 977–989 (1992).\n 20. Fujisawa, H. & Morita, M. Phage DNA packaging. Genes Cells 2, 537–545 (1997).\n 21. Bankevich, A. et al. SPAdes: a new genome assembly algorithm and its applications to single-cell sequencing. J Comput Biol  19, \n455–477, doi:10.1089/cmb.2012.0021 (2012).\n 22. Catalano, C. E., Cue, D. & Feiss, M. Virus DNA packaging: the strategy used by phage lambda. Mol Microbiol 16, 1075–1086 (1995).\n 23. Zhang, X. et al. A novel termini analysis theory using HTS data alone for the identification of Enterococcus phage EF4-like genome \ntermini. BMC Genomics 16, 414, doi:10.1186/s12864-015-1612-3 (2015).\n 24. Sternberg, N. & Coulby, J. Recognition and cleavage of the bacteriophage P1 packaging site (pac). II. Functional limits of pac and \nlocation of pac cleavage termini. J Mol Biol 194, 469–479 (1987).\n 25. Valiente, E., Cairns, M. D. & Wren, B. W . The Clostridium difficile PCR ribotype 027 lineage: a pathogen on the move. Clin Microbiol \nInfect 20, 396–404, doi:10.1111/1469-0691.12619 (2014).\n 26. Rihtman, B., Meaden, S., Clokie, M. R., Koskella, B. & Millard, A. D. Assessing Illumina technology for the high-throughput \nsequencing of bacteriophage genomes. PeerJ 4, e2055, doi:10.7717/peerj.2055 (2016).\n 27. Rashid, S. J. et al . Two Novel Myoviruses from the North of Iraq Reveal Insights into Clostridium difficile Phage Diversity and \nBiology. Viruses 8, doi:10.3390/v8110310 (2016).\n 28. Merrill, B. D., Ward, A. T., Grose, J. H. & Hope, S. Software-based analysis of bacteriophage genomes, physical ends, and packaging \nstrategies. BMC Genomics 17, 679, doi:10.1186/s12864-016-3018-2 (2016).\n 29. Cresawn, S. G. et al . Phamerator: a bioinformatic tool for comparative bacteriophage genomics. BMC Bioinformatics  12, 395, \ndoi:10.1186/1471-2105-12-395 (2011).\n 30. Chung, C. H. et al. Predicting genome terminus sequences of Bacillus cereus-group bacteriophage using next generation sequencing \ndata. BMC Genomics 18, 350, doi:10.1186/s12864-017-3744-0 (2017).\nAcknowledgements\nThe authors would like to thank Laurence Van Melderen and Ariane Toussaint for providing strain RH8816, Erica \nLieberman from Eligo Bioscience for providing the sequencing data for phage HK97 and Laurent Debarbieux for \nproviding phage T4 as well as useful discussions. We also acknowledge the Genomics Platform and the center of \ninformatics for Biology, especially Christiane Bouchier, Laurence Ma, Eric Deveau, Fabien Mareuil and Olivia \nDoppelt-Azeroual for their help and support with sequencing and Galaxy integration. This work was supported \nby a discovery grant from the Natural Sciences and Engineering Research Council of Canada (NSERC #341450-\n2010) to LCF and the French Government’s program Investissement d’ Avenir program; Laboratoire d’Excellence \n‘Integrative Biology of Emerging Infectious Diseases’ [ANR-10-LABX-62-IBEID].\nAuthor Contributions\nJ.G., M.M. and D.B. wrote the PhageTerm code. F .D. sequenced the E. coli phages. M.M., L.C.F . and D.B. designed \nthe study. J.G., M.M. and D.B. wrote the manuscript. All authors have contributed to it and have read and accepted \nthe final version.\nAdditional Information\nSupplementary information accompanies this paper at doi:10.1038/s41598-017-07910-5\nCompeting Interests: The authors declare that they have no competing interests.\nPublisher's note: Springer Nature remains neutral with regard to jurisdictional claims in published maps and \ninstitutional affiliations.\nOpen Access This article is licensed under a Creative Commons Attribution 4.0 International \nLicense, which permits use, sharing, adaptation, distribution and reproduction in any medium or \nformat, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Cre-\native Commons license, and indicate if changes were made. The images or other third party material in this \narticle are included in the article’s Creative Commons license, unless indicated otherwise in a credit line to the \nmaterial. If material is not included in the article’s Creative Commons license and your intended use is not per-\nmitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the \ncopyright holder. To view a copy of this license, visit http://creativecommons.org/licenses/by/4.0/.\n \n© The Author(s) 2017"
}