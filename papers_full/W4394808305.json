{
  "title": "Benchmarking bioinformatic virus identification tools using real-world metagenomic data across biomes",
  "url": "https://openalex.org/W4394808305",
  "year": 2024,
  "authors": [
    {
      "id": "https://openalex.org/A2241939830",
      "name": "Ling Yi Wu",
      "affiliations": [
        "Utrecht University"
      ]
    },
    {
      "id": "https://openalex.org/A4367463268",
      "name": "Yasas Wijesekara",
      "affiliations": [
        "Universitätsmedizin Greifswald"
      ]
    },
    {
      "id": "https://openalex.org/A2902787767",
      "name": "Gonçalo J. Piedade",
      "affiliations": [
        "University of Amsterdam",
        "Royal Netherlands Institute for Sea Research"
      ]
    },
    {
      "id": "https://openalex.org/A2125829533",
      "name": "Nikolaos Pappas",
      "affiliations": [
        "Utrecht University"
      ]
    },
    {
      "id": "https://openalex.org/A2034112317",
      "name": "Corina P. D. Brussaard",
      "affiliations": [
        "University of Amsterdam",
        "Royal Netherlands Institute for Sea Research"
      ]
    },
    {
      "id": "https://openalex.org/A2031851314",
      "name": "Bas E. Dutilh",
      "affiliations": [
        "Utrecht University",
        "Friedrich Schiller University Jena"
      ]
    },
    {
      "id": "https://openalex.org/A2241939830",
      "name": "Ling Yi Wu",
      "affiliations": []
    },
    {
      "id": "https://openalex.org/A4367463268",
      "name": "Yasas Wijesekara",
      "affiliations": []
    },
    {
      "id": "https://openalex.org/A2902787767",
      "name": "Gonçalo J. Piedade",
      "affiliations": []
    },
    {
      "id": "https://openalex.org/A2125829533",
      "name": "Nikolaos Pappas",
      "affiliations": []
    },
    {
      "id": "https://openalex.org/A2034112317",
      "name": "Corina P. D. Brussaard",
      "affiliations": []
    },
    {
      "id": "https://openalex.org/A2031851314",
      "name": "Bas E. Dutilh",
      "affiliations": []
    }
  ],
  "references": [
    "https://openalex.org/W3138347261",
    "https://openalex.org/W2523201192",
    "https://openalex.org/W2342508939",
    "https://openalex.org/W2023652460",
    "https://openalex.org/W2126317009",
    "https://openalex.org/W2141193948",
    "https://openalex.org/W2613232244",
    "https://openalex.org/W2995511111",
    "https://openalex.org/W2008733625",
    "https://openalex.org/W1998834458",
    "https://openalex.org/W2808646128",
    "https://openalex.org/W2460813857",
    "https://openalex.org/W2525115459",
    "https://openalex.org/W2076792045",
    "https://openalex.org/W2521169042",
    "https://openalex.org/W2128210528",
    "https://openalex.org/W2527868360",
    "https://openalex.org/W3096288242",
    "https://openalex.org/W2785587412",
    "https://openalex.org/W2921286915",
    "https://openalex.org/W2801273097",
    "https://openalex.org/W2913799778",
    "https://openalex.org/W2050991254",
    "https://openalex.org/W2903934518",
    "https://openalex.org/W4224078476",
    "https://openalex.org/W4221049439",
    "https://openalex.org/W3042336030",
    "https://openalex.org/W4387299493",
    "https://openalex.org/W2013544175",
    "https://openalex.org/W4239871258",
    "https://openalex.org/W3133451990",
    "https://openalex.org/W2950868848",
    "https://openalex.org/W1966912927",
    "https://openalex.org/W1978006472",
    "https://openalex.org/W2404265797",
    "https://openalex.org/W2904384071",
    "https://openalex.org/W2119859604",
    "https://openalex.org/W2526038422",
    "https://openalex.org/W2955167895",
    "https://openalex.org/W2732139758",
    "https://openalex.org/W3003110834",
    "https://openalex.org/W2949831026",
    "https://openalex.org/W3033129278",
    "https://openalex.org/W3127656915",
    "https://openalex.org/W2173732482",
    "https://openalex.org/W2735641148",
    "https://openalex.org/W3017386511",
    "https://openalex.org/W2801905545",
    "https://openalex.org/W3137491981",
    "https://openalex.org/W3167996047",
    "https://openalex.org/W3162965417",
    "https://openalex.org/W4318756379",
    "https://openalex.org/W4366742305",
    "https://openalex.org/W4390883648",
    "https://openalex.org/W4362522194",
    "https://openalex.org/W1974846245",
    "https://openalex.org/W3166016899",
    "https://openalex.org/W2883705104",
    "https://openalex.org/W4386889235",
    "https://openalex.org/W4311213897",
    "https://openalex.org/W2950635704",
    "https://openalex.org/W4387130650",
    "https://openalex.org/W2658246793",
    "https://openalex.org/W2118341464",
    "https://openalex.org/W3196361330",
    "https://openalex.org/W4200440847",
    "https://openalex.org/W2145370398",
    "https://openalex.org/W4366134578",
    "https://openalex.org/W2742240076",
    "https://openalex.org/W4294817504",
    "https://openalex.org/W4386225360",
    "https://openalex.org/W4310665630",
    "https://openalex.org/W2940459311",
    "https://openalex.org/W1976313814",
    "https://openalex.org/W2118129812",
    "https://openalex.org/W2990215402",
    "https://openalex.org/W2951912016",
    "https://openalex.org/W2432815617",
    "https://openalex.org/W2599417231",
    "https://openalex.org/W2529838505",
    "https://openalex.org/W2103441770",
    "https://openalex.org/W2150131459",
    "https://openalex.org/W2789843538",
    "https://openalex.org/W4309669576",
    "https://openalex.org/W3091956242",
    "https://openalex.org/W3118048495",
    "https://openalex.org/W2981413553",
    "https://openalex.org/W2045204781",
    "https://openalex.org/W1996423252",
    "https://openalex.org/W3147254695",
    "https://openalex.org/W3189053267",
    "https://openalex.org/W2972411752",
    "https://openalex.org/W2145126338",
    "https://openalex.org/W2952615074",
    "https://openalex.org/W2406250479",
    "https://openalex.org/W2110417468",
    "https://openalex.org/W3215102050",
    "https://openalex.org/W4394808305"
  ],
  "abstract": null,
  "full_text": "Open Access\n© The Author(s) 2024. Open Access  This article is licensed under a Creative Commons Attribution 4.0 International License, which permits \nuse, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original \nauthor(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third \nparty material in this article are included in the article’s Creative Commons licence, unless indicated otherwise in a credit line to the mate‑\nrial. If material is not included in the article’s Creative Commons licence and your intended use is not permitted by statutory regulation or \nexceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit http:// \ncreat iveco mmons. org/ licen ses/ by/4. 0/. The Creative Commons Public Domain Dedication waiver (http:// creat iveco mmons. org/ publi \ncdoma in/ zero/1. 0/) applies to the data made available in this article, unless otherwise stated in a credit line to the data.\nRESEARCH\nWu et al. Genome Biology  (2024) 25:97 \nhttps://doi.org/10.1186/s13059-024-03236-4\nGenome Biology\nBenchmarking bioinformatic virus \nidentification tools using real-world \nmetagenomic data across biomes\nLing‑Yi Wu1, Yasas Wijesekara2, Gonçalo J. Piedade3,4, Nikolaos Pappas1, Corina P . D. Brussaard3,4 and \nBas E. Dutilh1,5*   \nAbstract \nBackground: As most viruses remain uncultivated, metagenomics is currently \nthe main method for virus discovery. Detecting viruses in metagenomic data is not triv‑\nial. In the past few years, many bioinformatic virus identification tools have been \ndeveloped for this task, making it challenging to choose the right tools, parameters, \nand cutoffs. As all these tools measure different biological signals, and use different \nalgorithms and training and reference databases, it is imperative to conduct an inde‑\npendent benchmarking to give users objective guidance.\nResults: We compare the performance of nine state‑of‑the‑art virus identification \ntools in thirteen modes on eight paired viral and microbial datasets from three distinct \nbiomes, including a new complex dataset from Antarctic coastal waters. The tools have \nhighly variable true positive rates (0–97%) and false positive rates (0–30%). PPR‑Meta \nbest distinguishes viral from microbial contigs, followed by DeepVirFinder, VirSorter2, \nand VIBRANT. Different tools identify different subsets of the benchmarking data and all \ntools, except for Sourmash, find unique viral contigs. Performance of tools improved \nwith adjusted parameter cutoffs, indicating that adjustment of parameter cutoffs \nbefore usage should be considered.\nConclusions: Together, our independent benchmarking facilitates selecting choices \nof bioinformatic virus identification tools and gives suggestions for parameter adjust‑\nments to viromics researchers.\nBackground\nViruses of microbes (VoMs) are the most abundant life entities on Earth [1–3], infect -\ning many microbes at any given time [4]. The interactions between VoMs and their \nmicrobial hosts can change microbial host community composition [5] and their physi -\nology [6], affecting not only the health of higher organisms (including plants, animals, \nand humans) [7–9] but also the global biogeochemical processes [10, 11]. Besides the \ndirect (killing host) and indirect (e.g., recycling of limiting nutrients) ecological effects \n*Correspondence:   \nbedutilh@gmail.com\n1 Theoretical Biology \nand Bioinformatics, Science4Life, \nUtrecht University, Padualaan \n8, Utrecht 3584 CH, The \nNetherlands\n2 Institute of Bioinformatics, \nUniversity Medicine Greifswald, \nFelix Hausdorff Str. 8, \n17475 Greifswald, Germany\n3 Department \nMarine Microbiology \nand Biogeochemistry, NIOZ Royal \nNetherlands Institute for Sea \nResearch, Den Burg, PO Box 59, \nTexel 1790 AB, The Netherlands\n4 Institute for Biodiversity \nand Ecosystem Dynamics, \nUniversity of Amsterdam, \nAmsterdam, The Netherlands\n5 Institute of Biodiversity, \nFaculty of Biological Sciences, \nCluster of Excellence Balance \nof the Microverse, Friedrich \nSchiller University Jena, \n07743 Jena, Germany\nPage 2 of 23Wu et al. Genome Biology  (2024) 25:97\nof viral lysis, VoMs can influence microbial hosts’ physiology by altering metabolic path-\nways through horizontal gene transfer or through the expression of metabolic genes car-\nried within viral genomes during viral infection [6, 12, 13]. Understanding the complex \ninteractions between VoMs and their microbial hosts and the ecological roles of VoMs \ncould contribute insights on solving crucial global problems, such as infectious diseases, \nclimate change, and food crisis [14–16]. Still, improved knowledge on the genetic diver -\nsity of VoMs is warranted [17–19]. Acknowledging the genetic diversity of VoMs and \ntheir high potential for application, there is considerable interest in “mining” these viral \nsequences to discover new candidates for antimicrobial drugs, enzymes for biotechnol -\nogy, and bioremediation purposes [20–22].\nOriginally, the discovery of most viruses depended primarily on the observation of \ntheir effect on a host. Nowadays, (meta)genomics has become a major method for virus \ndiscovery. Despite the fact that there is no universal marker gene carried by all viruses, \nstudies of specific hallmark genes have revealed large-scale viral diversity of certain \nviral groups from marine and host associated biomes [23–28]. For example, Sakowski \net al. 2014 and Wu et al. 2023 found great novel dsDNA bacteriophage diversity from \nmarine samples using ribonucleotide reductase [23, 28], while Wolf et al. 2020, Zayed \net al. 2022, and Edgar et al. 2022 expanded the known RNA viruses using RNA-depend -\nent RNA polymerase as a marker [25–27]. Complementary to marker gene approaches, \nshotgun metagenomic sequencing is suitable for discovering viruses without targeted \nmarker genes [29, 30]. Through the shotgun metagenomic approach, total genetic mate -\nrial is extracted from environmental samples, either from an enriched viral fraction \n(virome) or from a fraction representing both viruses and their hosts (total metagen -\nome). This is then sequenced randomly. It is common for viral reads to comprise less \nthan 5% of metagenomic sequences from a total metagenome sample [29]. Viromic \ndatasets are derived from samples that were enriched for viruses by, e.g., size filtration, \ndensity gradient centrifugation, and/or chemical concentration [15, 31, 32]. Notwith -\nstanding advances in virus filtration techniques [29, 31, 33], it can still be challenging to \ndistinguish viruses in metagenomic/viromic datasets due to (1) the lack of viral marker \ngenes [23], (2) limited availability of viral reference genomes [15], (3) the possible high \nsequence similarity between viral and microbial genomes [34], and (4) the presence of \nprophages in microbial genomes. Therefore, it has become of great interest to determine \nwhich sequences within whole microbial communities are derived from viruses. These \nsequences can occur as free virions, active intracellular infections, particle or host-\nattached virions [35], and host-integrated or episomal viral genomes (i.e., proviruses) \n[29, 30, 36].\nIn the past years, many bioinformatic virus identification tools have been developed \nfor the task of identifying viral sequences in mixed metagenomic datasets (Additional \nfile 2: Table S1). Some of the tools rely strongly on comparing candidate sequences to the \nsequences in reference databases. For example, VirSorter [37] uses information on the \nenrichment in viral-like genes, depletion in Pfam-affiliated genes, enrichment in short \ngenes, and depletion in strand switching. MetaPhinder [38] uses BLASTn and average \nnucleotide identity thresholds to classify viral contigs in metagenomes. Sourmash [39] \nemploys MinHash-based algorithms to quickly compare large sets of sequences and esti-\nmate their similarity to viruses. Some of the tools used machine learning techniques that \nPage 3 of 23\nWu et al. Genome Biology  (2024) 25:97\n \nalso detect other genomic features based on positive and negative training sets. Seeker \nemploys long short-term memory (LSTM) models that can identify distant dependencies \nwithin sequences, to distinguish phages from bacteria. VirFinder [40] is a logistic regres -\nsion classifier using nucleotide sequence 8-mers as features to identify viral sequences. \nSome of the machine learning based tools use convolutional neural networks (CNNs). \nDeepVirFinder [41] and PPR-Meta [42] use CNNs that encode long- and short-range \nfeatures of viral genomes. Some of the machine learning tools use hybrid approaches to \ncombine the advantage of homology search and machine learning. VIBRANT [43] uses \nviral nucleotide domain abundances in a neural network framework to classify contigs \nhaving more than four proteins. VirSorter2 [44] integrates the biological signals of Vir -\nSorter in a tree-based machine learning framework. In addition, the training/reference \ndatabases used in virus discovery are diverse, including sequence databases such as Ref -\nSeq [45], virome datasets in specific studies [37, 41, 44], and HMMs [46] of pVOGs [43, \n47]. The number and diversity of virus identification tools make it challenging to choose \nthe right tool(s), parameters, and cutoffs.\nSeveral benchmarking studies have compared the performance of various virus \nidentification tools [48–53] (Additional file  2: Table S2). Most of them used simulated \nsequencing data or sequencing data from mock community as testing datasets. The \nknown fraction of the viral sequence space is limited because most viruses remain \nuncharacterized. To perform reliable benchmarking, one would have to set aside a \nfraction of the small collection of known virus sequences before using the remainder \nas training or reference data for the tools. As many virus identification tools included \nRefSeq data in their training/reference databases, using RefSeq to generate a mock sam -\nple may be expected to bias the results (more true positives). Besides, to avoid overlap \nbetween training and testing data, one would have to address the redundancy in the Ref-\nSeq database which contains many similar cultivated and isolated viral genomes while \nviruses in environmental samples are diverse and remain under-characterized. Finally, \nboth the macro- and micro-diversity of viruses in natural samples is usually a lot greater \nthan the diversity of viruses in the database, further obscuring the benchmarking results. \nHo et al. [53] benchmarked tools on a previously sequenced mock community contain -\ning five phage strains, which is low compared to real environmental samples. The newest \nbenchmarking from Schackart et al. [52] included two real-world metagenomic datasets \nbut did not define a ground truth dataset.\nTo avoid biases in our comparison and reach the complexity level of microbial/\nviral communities in real-world metagenomic datasets, we used simulated and real-\nworld metagenomic data as testing datasets. We benchmarked nine state-of-the-art \nbioinformatic virus identification tools on paired viral and microbial samples across \nthree vastly distinct biomes, including seawater (this study) [54], agricultural soil [31], \nand human gut [55] (Additional file  2: Table S3 and S4). These three representative \nbiomes were distinct in microbial community compositions and diversity [56], and we \nanticipate that viral community would follow similar. The selected viral and micro -\nbial samples were obtained through physical size fractionation, where samples went \nthrough filters with pore size of 0.22 μm to obtain viral (< 0.22 μm) and microbial \n(> 0.22 μm) fractions [57]. To ensure the quality of the fractioned real-world testing \ndatasets, we (1) selected studies that treated their virome with DNase, (2) assessed \nPage 4 of 23Wu et al. Genome Biology  (2024) 25:97\nthe virome quality using ViromeQC, (3) removed the homologous contigs present in \nboth viral and microbial datasets, and (4) validated the viral and microbial fraction \ncontigs using robust bioinformatic tools (Fig. 1  and Additional file 1 : Fig. S1).\nWe collected Illumina sequencing datasets of eight paired viral and microbial sam -\nples from each of the three biomes. First, we benchmarked the performance of tools \non their default cutoffs. Second, we tested the effect of different parameters and cut -\noffs on the annotations. Third, we further validated our benchmarking results with \nextra bioinformatics tools. Our comprehensive analysis of virus identification tools \nin diverse biomes highlights the trade-off between specificity and sensitivity and pro -\nvides valuable insights for researchers looking to identify viruses in metagenomic \ndata (Fig. 1  and Additional file 1 : Fig. S1).\nFig. 1 Real‑world metagenomic data benchmarking pipeline. A Samples from three different biomes were \nsize fraction filtered through 0.22 μm filters to obtain microbial‑ (> 0.22 μm) and viral‑enriched fractions \n(< 0.22 μm). B DNase treatment was performed in viral‑enriched fractions to remove free DNA before viral \nlysis. C DNA was separately extracted, purified, and sequenced from microbial‑ and viral‑enriched fractions \nto obtain viral and microbial datasets. D Sequenced DNA reads were quality‑controlled and assembled \ninto longer contigs. Contigs with lengths shorter than 1500 bp were excluded from downstream analysis. \nE Homologous contigs between viral and microbial datasets were found using minimap2 and removed. \nUnique viral fraction contigs and unique microbial fraction contigs were used as ground truth positives and \nnegatives, respectively. F Nine bioinformatic virus identification tools were applied to these datasets. Tool \nnames are colored based on algorithms: convolutional neural network tools (red), other machine learning \ntools (green), and homology‑only tools (blue). Viral contigs that are identified as viral and non‑viral are \nconsidered as true positives and false negatives, respectively. Microbial contigs that are identified as viral and \nnon‑viral are false positives and true negatives, respectively\nPage 5 of 23\nWu et al. Genome Biology  (2024) 25:97\n \nResults\nWe benchmarked nine virus identification tools in thirteen modes using simulated and \nreal-world metagenomic datasets. For the simulated datasets, we generated mock con -\ntigs from reference genomes of viruses and bacteria deposited in the RefSeq database \nafter the last tool training database was created. For the real-world metagenomic data -\nsets, we used eight dataset pairs from each of three distinct biomes: seawater, soil, and \nhuman gut. Ground truth positives and negatives were defined as metagenomic contigs \nfrom viral (< 0.22 μm) and microbial (> 0.22 μm) size filters; overlapping sequences were \nexcluded (Fig. 1 and Additional file 1: Fig. S1).\nQuality and composition of the real‑world testing datasets from three biomes\nTo assess the viral enrichment and microbial contamination level of the viral datasets, \nwe applied ViromeQC. The total enrichment score of the seawater dataset was 65 times \nhigher than the soil dataset and 160 times higher than the gut dataset (Additional file  2: \nTable S5).\nRaw sequencing reads were quality-controlled and assembled into contigs. The assem -\nbly statistics, including the contig number and length distributions, are summarized in \nFig. 2, Additional file  1: Fig. S2, and Additional file  2: Table S6. In total, seawater data -\nsets contained the greatest number of contigs while gut datasets contained the smallest \nnumber of contigs. Seawater and gut datasets contained more microbial contigs than \nviral contigs while soil datasets contained more viral contigs than microbial contigs and \nwith a greater total length. The soil datasets had the lowest percentage of homologous \ncontigs between the viral and microbial datasets. As overlapping viral and microbial \nsequences might represent active and integrated temperate viruses, respectively, we \nhypothesize that there might be more lytic viruses in soil than in seawater and gut, in \nline with previous findings that lysogeny genes are scarce in soil viromes [11, 58–61]. \nThese overlapping sequences were removed from our benchmarking analysis. Detailed \ninformation about the homologous contigs is deposited into the Zenodo repository \nFig. 2 The number of contigs assembled from eight paired samples from seawater (A), soil (B), and gut (C) \nbiomes and their cumulative lengths (D, E, F). X and Y axes of panels (A, B, C and D, E, F) are scaled to the \nsame maximum values, so the numbers are comparable between biomes\nPage 6 of 23Wu et al. Genome Biology  (2024) 25:97\n(seawater_minimap_wtp_output.txt, soil_minimap_wtp_output.txt, and gut_minimap_\nwtp_output.txt).\nAssembly coverage and quality were assessed by re-mapping sequencing reads to the \nlength-filtered assembled contigs per dataset (Additional file  2: Table S7). The percent -\nage of properly paired reads from bwa mem mapping ranged from 11% (gut microbial \ndataset SRR5665119) to 94% (gut viral dataset SRR5665153) with an average of 52% \n(23.69%) for all datasets. Viral datasets usually had a greater percentage of properly \npaired reads than microbial datasets across the three biomes. This might be due to fac -\ntors such as (1) the larger genomes of microbes, (2) the higher local microbial commu -\nnity complexity, and (3) the persistence of DNA in dead microbial matter [62, 63], which \nshould be removed during the DNase step in the virome preparation but may persist in \nthe microbiomes. Seawater datasets had the best assembly quality with mean percent -\nages of properly paired reads of 79% and 45% for viral and microbial datasets, respec -\ntively. The DNA sequences of assembled scaffolds with lengths of at least 1500 bp are \ndeposited into the Zenodo repository (seawater_scaffolds_gt1500.fasta, soil_scaffolds_\ngt1500.fasta, and gut_scaffolds_gt1500.fasta). We propose that these datasets may be \nused in future benchmarking studies and that the results may be compared with those \npresented below.\nMachine learning tools outperformed homology‑only tools\nTo compare the ability of the tools to detect viral sequences, the true positive rate (TPR, \nalso known as sensitivity) and false positive rate (FPR) were measured based on the \npercentage of contigs from the viral and microbial size fractions that were identified \nwith default thresholds (Fig.  3A, B, C and Additional file  2: Table S8). Detailed results \nper contig are available in the Zenodo repository (seawater_minimap_wtp_output.txt, \nsoil_minimap_wtp_output.txt, and gut_minimap_wtp_output.txt). All tools, except for \nSourmash, detected viral contigs. Most tools ranked consistently high or low in each of \nthe three biomes. Not many virome contigs were detected in the human gut samples by \nany tool. This was probably due to the contamination of microbes in the virome data -\nsets (Additional file 2: Table S5). Thus, optimization of experimental protocols to obtain \nvirome from gut/fecal samples is suggested.\nThe choices of the algorithms and the parameters, the detected biological signals, \nand the compositions of the training databases all play a role in the ability of the tools \nto distinguish viral and microbial sequences. CNN tools outperformed other machine \nlearning tools, while the homology-only tools performed the worst. Top performing \ntools, PPR-Meta (TPR or sensitivity: 68% ± 28%; FPR: 13% ± 8%) and DeepVirFinder \n(TPR or sensitivity: 45% ± 18%; FPR: 6% ± 5%), use convolutional neural network \n(CNN) algorithms that can capture short- and long-range signals on viral and micro -\nbial genomes. PPR-Meta’s CNN contains two paths—a “base path” and a “codon path” \nwhile DeepVirFinder only contains the “base path. ” The “base path” is beneficial to \nextracting the sequence features of coding or non-coding regions while the “codon \npath” is specifically designed to capture the properties of coding regions. The thor -\nough detection of biological signals encoded in both DNA and codon sequences \nmight contribute to the good performance of PPR-Meta. PPR-Meta also detected \nmany sequences among the microbial contigs, especially from the seawater biome. \nPage 7 of 23\nWu et al. Genome Biology  (2024) 25:97\n \nThese could include microbial sequences that were spuriously detected as viral, \nreflecting a tradeoff between sensitivity and specificity, but it could also be that the \nmicrobial fraction still contained viral elements, such as integrated prophages and \nintracellular viruses in a successful or unsuccessful infection cycle and thus present \nin the microbial fraction. There were relatively many such matching contigs in sea -\nwater samples (Fig.  2), possibly indicating the prevalence of actively infecting viruses \nin that biome. The viral signals found in the microbial fraction also confirmed the \npresence of possible viral elements in the microbial fraction (Fig.  5B). We will discuss \nthis further in the below section of “ Validation of predicted viral contigs in the real-\nworld testing dataset . ” Both PPR-Meta and DeepVirFinder used RefSeq viral genomes \nas training databases, and DeepVirFinder additionally included virome datasets from \nspecific studies in the training database. Still, DeepVirFinder did not perform better \nthan PPR-Meta in our benchmark.\nVirSorter2 and VIBRANT performed similarly, identifying just under half of the \nviral contigs in seawater and soil metagenomes with few false positives (Fig.  3A, B, \nC). The two tools use similar biological signals but different algorithms. Both Vir -\nSorter2 and VIBRANT use viral domain abundance information as biological signals \nfor identifying viral contigs. VIBRANT uses a neural network multi-layer perception \nFig. 3 Percentage of contigs identified as viral in the viral (true positive rate, blue) and microbial (false \npositive rate, orange) datasets, sorted by the average difference in detection rate between eight viral and \nmicrobial paired datasets in seawater (A), soil (B), and gut (C) biomes. Colors of the tool names as in Fig. 1. \nConvolutional neural network tools outperformed other machine learning tools, while the homology‑only \ntools performed the worst. Receiver operating characteristic (ROC) curves of seven methods based on their \nvirus identification scores in seawater (D), soil (E), and gut biomes (F). The dashed diagonal line represents \nclassification according to random chance. The area under the ROC curve (AUC) of each tool is listed in \nAdditional file 2: Table S9\nPage 8 of 23Wu et al. Genome Biology  (2024) 25:97\nclassifier while VirSorter2 uses a random forest machine learning framework. Besides \nsequences from NCBI RefSeq, VirSorter2 includes viral sequences of giant viruses \nmined from public databases, viral sequences from seawater biomes, and novel ssDNA \nviruses from animals in its training database. Focusing on the differences, VirSorter2 \noutperformed VIBRANT on seawater and gut biomes while VIBRANT outperformed \nVirsorter2 on soil biome. The inclusion of uncultivated viral sequences from seawater \nbiomes and human/animal tissues by VirSorter2 might contribute to its better perfor -\nmance on the seawater and gut samples than VIBRANT (Fig. 3 A, B, C).\nSeeker was the only machine learning tool that did not perform well. Seeker uses \nmuch fewer parameters (~  102) than PPR-Meta and DeepVirFinder (~  106). The low com-\nplexity of the model reflected in the low number of parameters might inhibit the model \nto capture the nuanced but important patterns in the viral sequences. Besides, like most \nother tools, Seeker trains on viral and bacterial sequences from NCBI RefSeq, but, dif -\nferently, Seeker includes many more viral than bacterial genomes in the training data -\nbases (2232:75 and 7375:240 viral: bacterial genomes for the first and second training \ndatabases, respectively), while the other tools include more bacterial than viral genomes \n(Additional file 2: Table S1). This class imbalance might lead to loss of important signals \nand bias the tool.\nWe further evaluated the true negative rate (TNR, also known as specificity), precision, \nand F1 score of each tool (Additional file  1: Fig. S3 and Additional file  2: Table S8). The \ntwo CNN tools, PPR-Meta and DeepVirFinder, have higher F1 scores than the homol -\nogy-only tools and other machine learning tools, mostly because of their high sensitiv -\nity, but they have lower specificity and lower precision. Homology-only tools tend to be \nhighly specific, but they are not very sensitive and have many false negatives (undetected \nviral sequences). These properties should be considered when choosing a suitable tool \nfor a specific study. For example, VirSorter2 and VIBRANT were highly specific and rel -\natively sensitive, while PPR-Meta and DeepVirFinder were highly sensitive but less spe -\ncific than the other tools. The F1 score attempts to capture both these statistics, as the \nharmonic mean of precision and sensitivity. It is important to note that most machine \nlearning tools were developed more recently than the homology-only tools and therefore \nincluded more updated and complete reference databases. All tools can be expected to \nimprove over time as newly discovered viral genomes are added to the training/reference \ndatabases. In summary, the classification algorithms, biological signals, and training/\nreference databases are all crucial factors in determining the performance of the tools. \nBoth PPR-Meta and DeepVirFinder exploited CNNs, indicating the promising potential \nof CNN algorithms for sequence analysis.\nTo investigate influence of the quality of viral contigs on virus discovery, we assessed \nthe quality of the viral contigs using CheckV (Fig.  4). Generally, higher quality viral \nsequences were easier to detect. CNN and other machine learning tools had higher \nsensitivity than homology-only tools on all contig quality categories. Compared to \nhomology-only tools, machine learning tools had highly improved virus detecting abil -\nity on contigs of medium to complete quality and among which, CNN tools had highly \nimproved virus detecting ability on contigs of low and not determined quality. PPR-Meta \nhad high sensitivity for almost all categories of contig quality. DeepVirFinder had about \nPage 9 of 23\nWu et al. Genome Biology  (2024) 25:97\n \nhalf the sensitivity of PPR-Meta in all categories. VirSorter2 and VIBRANT had high \nsensitivity in high-quality viruses (medium to complete), like PPR-Meta, while most low-\nquality viruses were missed. Detailed information of the CheckV quality results of each \ncontig is deposited into the Zenodo repository (seawater_checkv_quality_summary.tsv, \nsoil_checkv_quality_summary.tsv, and gut_checkv_quality_summary.tsv).\nThe effect of adjusting score thresholds\nTo further investigate the distinguishing ability of each tool, we performed receiver oper-\nating characteristics (ROC) analysis. Only tools that provided a virus score were ana -\nlyzed. We first grouped ROC curves by biome (Fig.  3D, E, F). For the seawater and soil \nbiomes, PPR-Meta had the best virus discovery performance, followed by DeepVirFinder \nand VirSorter2. For the gut biome, VirSorter2 had the best performance, followed by \nDeepVirFinder and VirFinder. The results of high performance of PPR-Meta on soil \ndatasets (AUC 0.95, Additional file  2: Table S9) were from both the good distinguishing \nability of the tool and the quality of the testing datasets. Technically, the slightly lower \nperformance on seawater datasets (AUC 0.90) could be a result of the tradeoff between \nFig. 4 The association of the viral discovery rate with viral contig quality. Percentage of viral contigs detected \nby each tool from the viral fraction (true positive rate, as known as sensitivity) for viral contigs of different \nquality from seawater (A), soil (B), and gut (C) biomes, using default cutoffs. The order of the tools on the \nx‑axis and the color of the tool names as in Fig. 3\nPage 10 of 23Wu et al. Genome Biology  (2024) 25:97\nsensitivity and specificity of the tool. Biologically, it could be a result of the prevalence \nof inactive prophages in the microbial fraction, which could have led to the detection of \ncontigs from the microbial fraction which are counted as false positives in our bench -\nmark (see Figs.  2 and 3A, B, C). The homology-only tool MetaPhinder performed no \nbetter than chance level based on the ROC curves.\nWe also grouped ROC curves by tool and colored the curves based on the cutoff score \nto investigate the optimal cutoff for different tools on different biomes (Additional file  1: \nFig. S4). The results show that adjusting virus score thresholds could enhance the virus \ndiscovery rate by some of the tools. For example, based on default thresholds, PPR-Meta \nand DeepVirFinder had high TPR and relatively low FPR when applied to soil datasets. \nTheir thresholds could be decreased with a relatively low risk of false discovery so that \nmore divergent viruses can be found. The choices of tools and thresholds depend on \nthe goals of the study. Researchers who want to detect more novel viruses can use more \nsensitive tools and decrease the thresholds from the defaults, such as PPR-Meta, Deep -\nVirFinder, and VirFinder. Researchers who have more conservative goals can use more \nspecific tools and increase the thresholds from the defaults, such as VirSorter2.\nAgreement and disagreement between tools\nTo investigate the agreement and disagreement between tools, we used UpSet plots \nto show the intersections of identified contigs from the two size fractions of seawater \n(Fig. 5), soil (Additional file  1: Fig. S5), and gut (Additional file  1: Fig. S6). Tools using \nsimilar algorithms clustered together and had more linkages in the UpSet matrices, \nindicating that the annotations of these tools tend to agree with each other. CNN tools \nidentified the most viral contigs from the viral fractions and agreed with each other as \nthey clustered on the bottom of the UpSet matrices. As expected, most microbial contigs \nwere not identified as viral by any tool (the left-most stacked bars are the tallest among \nall bars in the B panels). More consistency of predictions (more linkages in the UpSet \nmatrices) was seen in the viral fractions (A panels) than in the microbial fractions (B \npanels), indicating that tools tend to agree with each other more on viral than on micro -\nbial contigs. For seawater and soil biomes, most viral contigs were identified by at least \none tool, but this was not the case for the gut biome (the left-most stacked bar is the \ntallest among all bars in the A panel in Fig. S6), again suggesting that possible microbial \ncontamination in the gut viral datasets introduced negative (microbial) sequences into \nthe positives (viral) contig set.\nValidation of predicted viral contigs in the real‑world testing dataset\nTo assess the purity of the microbial and viral fractions from each biome, we further \ncharacterized the contigs using taxonomic and functional annotation tools with CAT \nand hmmsearch, respectively (Fig.  5 (seawater), Additional file  1: Fig. S5 (soil), and S6 \n(gut)). CAT is a tool to predict open reading frames from assembled contigs and search \ntheir homology to the NCBI non-redundant protein database to assign taxonomy to \ncontigs. Hmmsearch searches viral and microbial profile HMMs from assembled con -\ntigs. Both tools gave an overall trend of viral and bacterial protein signals found from \nthe contigs. Generally, more viral signals were found in the viral fraction than in the \nmicrobial fraction; more microbial signals were found in the microbial fraction than in \nPage 11 of 23\nWu et al. Genome Biology  (2024) 25:97\n \nthe viral fraction. The stacked bars above and left of the UpSet matrices visualized the \nCAT classification on the contig subsets. More contigs in viral fraction than in micro -\nbial fraction were classified as viral by CAT (more blue color bar in the viral fraction), \nconfirming an enrichment of viral sequences in the viral fraction. The heatmaps below \nand right of the upset plots show to what extent the contig subsets contained viral or \nmicrobial marker gene HMM profiles. Viral markers were found in both the viral and \nmicrobial fractions but more in viral fraction (the intensity of blue color is stronger in \nthe viral fraction than in the microbial fraction), again confirming an enrichment of viral \nsequences in the viral fraction. Microbial markers were mostly found in the microbial \nfraction (the intensity of orange color is stronger in the microbial fraction than in the \nviral fraction), except for gut biome that contained a lot of microbial markers in the viral \nfraction (Additional file 1: Fig. S6).\nFig. 5 UpSet plots summarizing the overlap in predictions between tools for the viral (A) and microbial \n(B) contigs from the seawater samples. The total number of identified viral contigs per tool is shown in the \nstacked bar plots on the left. Stacked bars above the upset plots visualize the number of viral contigs that \nwere exclusively identified by each tool or tool combination. The left‑most stacked bars show the number of \ncontigs that were not identified as viruses by any of the tools. The CAT classification of the contigs is indicated \nas colors in the bar plots: blue represents contigs classified as viruses, orange represents contigs classified as \n“Bacteria,” “Archaea,” or “Eukaryota,” and gray represents “no support” or “nan” classifications. Heatmaps below \nand right of the upset plots visualize the frequency of viral (blue) or microbial (orange) hallmark genes \n(logarithmic arbitrary units, see the “Methods” section). The intensity of hallmark gene HMM profiles was \ndetermined by dividing the length sum of all the HMM hits by the contig length. Color of the tool names as \nin Fig. 1. For similar plots based on the soil and gut datasets, see Additional file 1: Figs. S5 and S6, respectively\nPage 12 of 23Wu et al. Genome Biology  (2024) 25:97\nViral contigs that were identified by many tools showed great CAT viral protein sig -\nnals and/or viral marker gene HMM profile signals, such as column 5 and 15 in Fig.  5A. \nThe coincide of strong viral signals and contigs identified by many tools indicated \nthat tools agreed with each other more when the conventional viral signals are strong. \nA strong viral signal was also found in some microbial contigs, such as column 28 in \nFig. 5B which contains contigs predicted as viral by nine different methods. This viral \nsignal from microbial fraction contigs could indicate prophages, free virions, or other \nviral elements that could not be removed by prior experimental and bioinformatic pro -\ncesses. A summary of viral and microbial signals on contig subsets can be found in Addi-\ntional file 2: Table S10 and S11. Detailed CAT classification and hmmsearch results can \nbe found in the Zenodo repository (seawater_cat_taxonomy_official.txt, soil_cat_tax -\nonomy_official.txt, gut_cat_taxonomy_official.txt, seawater_hmmsearch_domtblout.txt, \nsoil_hmmsearch_domtblout.txt, and gut_hmmsearch_domtblout.txt).\nTo further investigate whether the identified contigs represent real viral sequences, \nthe longest viral contigs that were exclusively identified by each tool in each biome were \nextracted, classified, and annotated. PhaGCN2 placed 6/31 of these contigs into the viral \ntaxonomy (Additional file  2: Table  S12). Although the remaining 25 contigs were not \ntaxonomically classified, they did contain viral hallmark genes, such as genes encoding \nfor portal proteins, head scaffolding proteins, and tail related proteins (Fig.  6 (seawater), \nAdditional file  1: Figs. S7 (soil) and S8 (gut)), suggesting that these contigs are derived \nfrom real novel viruses. This analysis indicates that all tools have their strengths and \nweakness. Some tools may not be able to predict a wide range of viruses, but almost all \ntools, except for Sourmash, still identified certain viral sequences that the other tools \nmissed.\nBenchmarking tools on the simulated testing datasets derived from the RefSeq database\nWe constructed a simulated dataset with the viral (6,155 sequences) and bacterial \ngenomes (22,552 sequences) deposited into the RefSeq database after the last tool (Vir -\nSorter2) training database was created. We calculated similarity scores of these viruses \n(new viruses) based on their similarity compared to the viruses (old viruses) deposited \nbefore the last tool training database was created (Additional file  2: Table S13). We cut \nsimulated contigs from the viral and bacterial genome sequences and input them for \nvirus identification using the nine tools. As above, CNN tools outperformed homology-\nonly tools (Additional file  1: Fig. S9A, B and Additional file  2: Table  S14). This strong \nperformance did not depend on the degree of similarity of the new virus genome to the \nolder ones (Additional file  1: Fig. S9C and Additional file  2: Table S15). CNN tools even \noutperformed homology-only tools on the viruses with relatively high similarity with \nknown viruses. This could be because the CNN tools were built after homology-only \ntools and thus contained more and more diverse reference viruses in their training data -\nsets. PPR-Meta performed the best among all tools on the simulated data, but with a \nlower discovery rate than in the real-world metagenomic data (Fig.  3A, B, C). This could \nbe due to the short sequence lengths of the mock contigs (mean: 2000 bp) compared to \nthe real-world contigs (Additional file  1: Fig. S2). Seeker performed better on the sim -\nulated contigs than on the real-world contigs. Detailed results per contig are available \nPage 13 of 23\nWu et al. Genome Biology  (2024) 25:97\n \nin the Zenodo repository (simulated_bacterial_fragments_wtp_output.txt, simulated_\nviral_fragments_wtp_output.txt).\nComputational resources used for each tool\nThis study was performed on a shared high performance computing cluster. We bench -\nmarked the computational resources used for each tool on the smallest dataset from the \nseawater biome (188,159 contigs, 164 MB) in a high-performance cluster of 48 Gold-\n6240R CPUs and 503.5 GB RAM or 48 Gold-6240R CPUs and 1510.5 GB RAM. We cap-\ntured the CPU usage, physical memory usage and execution time in Additional file  2: \nTable  S16. DeepVirFinder and VirFinder had the largest and smallest computational \nfootprints, respectively. Two tools with the best performance, PPR-Meta and VirSorter2, \nused intermediate computational resources. PPR-Meta is fast but relatively memory- \nand CPU-intensive, while VirSorter2 is relatively slow but requires less memory.\nFig. 6 Genomic maps of the longest contigs that were exclusively identified by individual tools in the \nseawater virome dataset. For similar plots based on the soil and gut datasets, see Additional file 1: Figs. S7 and \nS8, respectively\nPage 14 of 23Wu et al. Genome Biology  (2024) 25:97\nDiscussion\nPrior benchmarking studies\nSeveral studies have compared the performance of bioinformatic virus identification \ntools. All studies benchmarked different sets of tools with some of them having over -\nlaps on tested tools. One of them evaluated tools only by describing the methods of the \nworkflows without quantification analysis [48]. Another one benchmarked tools that \nspecialize in identifying viruses from clinical samples [51]. Four benchmarking works \n[49, 50, 52, 53] mainly used simulated viral and non-viral testing datasets that were sam -\npled from publicly available complete viral and microbial genomes (e.g., NCBI RefSeq). \nA summary of the tested tools and testing datasets of each study can be found in Addi -\ntional file 2: Table S2.\nAll these studies gave insights about tool performance and which tools to choose for \nvirus identification. Ho et  al. 2021 found that machine learning-based tools outper -\nformed homology-only tools on the simulated dataset, which was consistent with our \nbenchmarking results [53]. Besides a simulated dataset, they benchmarked tools on a \nmock community dataset consisting of five phage strains. Most tools performed signif -\nicantly worse on the mock community dataset than on the simulated dataset derived \nfrom reference genomes, illustrating how simulated data sampled from RefSeq could \noverestimate tools’ performance. Pratama et al. 2021 found that viral identification effi -\nciency increases with fragment length, and almost all tools can correctly identify viral \ncontigs of 10 kb or longer [50]. “Gene content based” tools (VirSorter) can maximize \nthe true positive rate and minimize the false positive rate at length > 3 kb. K-mer-based \ntools (DeepVirFinder) and BLAST-based tools (MetaPhinder) were good at identifying \nviruses from short (< 3 kb) viral genome fragments. Complementary to their results, we \nfound that the viral identification sensitivity increases with the quality of contigs (Fig. 4). \nHigh-quality contigs were better identified by machine learning tools than by homol -\nogy-only tools. CNN tools were better at identifying low-quality contigs than other \nmachine learning tools. The most recent benchmarking work by Schackart et  al. 2023 \nused simulated datasets as well as a real-world gut metagenome dataset [52]. Their main \nfindings agreed with us—that homology tools (VirSorter, VIBRANT, and VirSorter2) \ndemonstrate low false positive rates and robustness to eukaryotic contamination, while \nmachine learning tools (VirFinder and DeepVirFinder) have high sensitivity, allowing \nthem to identify phages that are distinct from those in the reference databases.\nFor benchmarking studies that simulated testing datasets, while an effort was made to \nbenchmark the tools on data that was not part of the reference/training dataset, there \nstill might be instances of overlap. For example, Glickman et al. 2021 used VirSorter to \nperform prophage identification during testing dataset preparation, which might provide \nVirSorter with an advantage over other tools in prophage identification in this bench -\nmarking work [49]. And indeed, VirSorter performed the best on identifying phages \nbased on F1 score in this study.\nThe advantages and limitations of using real‑world metagenomic data\nThe usage of newly generated metagenomic data as testing datasets in our bench -\nmark, including a marine Antarctic dataset from an understudied region, allowed us \nPage 15 of 23\nWu et al. Genome Biology  (2024) 25:97\n \nto avoid overlap between testing and training/reference datasets. Besides, the usage of \nreal-world metagenomic testing datasets gives our study the perspective of metagen -\nomic virus discovery. The main limitation of our benchmarking study is that we are \nnot completely certain about the purity of our ground truth viral (< 0.22 μm) and \nmicrobial (> 0.22 μm) datasets.\nTo address this, we carefully selected metagenomic data from the studies with \nappropriate standard operation procedures to separate viruses from microbes. Both \nour dataset [64] and the publicly available datasets [65, 66] used in this benchmark \nperformed a DNase treatment in the viral fraction before DNA extraction from viri -\nons, minimizing free microbial DNA contamination [62, 67]. The DNase treatment \neffectively removes free microbial DNA in the viral fraction and is commonly used \nin virome studies [68– 73]. We also assessed the contamination of microbial DNA in \nthe viral size fraction by using ViromeQC (Additional file  2: Table S5). The microbial \nsize fraction could contain viral sequences, including integrated prophages or viruses \nthat are attached to cells or large debris or particles. This was illustrated by the viral \nsignals found by CAT and hmmsearch in the microbial datasets (Fig.  5, Additional \nfile  1: Fig. S5 and S6). However, more viral signals were found in the viral fraction \nthan in the microbial fraction, confirming the enrichment of viruses in the viral frac -\ntion and the depletion of viruses in the microbial fraction. We recognize that inte -\ngrated prophages that are not active as free virions might still be identified as viruses \nin the microbial fraction (spurious false positives).\nBesides viruses, mobile genetic elements (MGEs) such as plasmids, insertion \nsequence elements, integrative and conjugative elements, and integrons are also \nprevalent in the environment, but it can be difficult to distinguish these MGEs, even \nwhen using specialized bioinformatic tools [74]. This does not necessarily mean that \nthe tools perform poorly but also suggests that recombination between MGEs is ram -\npant. While our benchmarking work did not target other MGEs such as plasmids or \nprophages specifically, we minimized their influence by identifying and removing \nany homologous contigs shared between the viral and microbial fractions (Fig.  1). \nWe attempted to taxonomically classify some of the identified viral contigs using \nPhaGCN2 [75], but most of them remained unclassified.\nWhile other benchmarking studies that used simulated data had more purified data, \nthis was at the expense of vastly reduced viral/microbial community complexity, since \nsequences were only sampled from a fixed set of genomes. Strain-level microdiver -\nsity, which is an important parameter in viral ecology [76], is not represented in such \nsimulated data. In summary, our benchmarking is complementary to the benchmark -\ning work done by others. The usage of real-world metagenomic data from different \nbiomes ensured the high complexity and reality of the testing datasets and avoided \nthe problems of overlap between training and testing datasets, albeit with the com -\npromise of not knowing the exact compositions of the testing datasets.\nWe benchmarked tools on three distinct biomes, seawater, soil, and human gut. \nWe chose these three biomes because they differed greatly on microbial community \ncompositions and diversity and represent very different microbial compositions when \nviewed in the context of global microbiome datasets [56]. While arguably, samples \nfrom three individual studies cannot be assumed to represent all microbiomes, the \nPage 16 of 23Wu et al. Genome Biology  (2024) 25:97\ndifferent tools have similar performance in the different biomes, indicating that our \nresults are generalizable.\nConclusions\nThis study benchmarks the performance of nine state-of-the-art bioinformatic virus \nidentification tools using real-world metagenomic data. To evaluate how the tools per -\nform on datasets from different biomes, we used datasets from three distinct biomes, i.e., \nseawater, soil, and gut. As CNN tools outperformed homology-only tools, especially on \ncontigs of low quality, this seems to be a very promising avenue for virus mining, and \nmore advances are expected as this field matures. PPR-Meta, DeepVirFinder, VirSorter2, \nand VIBRANT performed the best among all benchmarked tools with relatively high \ntrue positive rates and relatively low false positive rates. No tool is perfect; every tool has \nits own strengths and weaknesses. However, it is not recommended to use union of all \ntools as some of the tools identified many false positives. The selection of a tool/tools may \ndepend upon the desired application as well. PPR-Meta and DeepVirFinder were found to \nbe sensitive but not as precise as some other tools. Thus, they can be used when detection \nof novel viruses is important and false positives are perhaps less of an issue. VirSorter2 \nand VIBRANT were more precise (fewer false positives) but also less sensitive compared \nto PPR-Meta and DeepVirFinder. Thus, they can be applied to studies when precision is \nmore important than sensitivity. The adjustment of the cutoff virus scores also plays a \nrole in the distinguishing ability of tools. If possible, in the experimental setup, we suggest \nusing a small dataset of pairs of viral and microbial datasets for at least some samples to \nexplore the optimal thresholds of virus detection tools using a setup as we followed in our \nstudy. For this, we have made our full Snakemake pipeline [77, 78] available. Besides, the \nexperimental flow of obtaining viromes and the quality of assembled contigs would influ-\nence the discovery performance of virus identification tools.\nOur comprehensive analysis of viral identification tools to assess their performance in \na variety of biomes provides valuable insights to viromics researchers looking to mine \nviral elements from novel metagenomic data across biomes. We hope that the results of \nthis benchmarking work will provide researchers with a guide to selecting the appropri -\nate tool and adjusting parameters for their own viral identification research.\nMethods\nConstruction of testing datasets from real‑world metagenomic data across biomes\nTo investigate how the tools perform on datasets from different biomes, we selected \ndatasets from Antarctic seawater (this study) [54], tomato soil [31], and human gut [55] \n(Additional file 2: Table S3). We collected a total of 48 metagenome datasets, including \neight paired viral and microbial datasets from each biome (Additional file  2: Table S4). \nThe viral datasets were obtained by size fractionation through a 0.22 μm membrane fol -\nlowed by DNase treatment to remove free DNA, reducing the likelihood of contaminat -\ning the viruses with sequences derived from cellular organisms. To further reduce biases \nin the detected viruses, we selected datasets where the DNA was not amplified prior to \nlibrary preparation and sequencing [79, 80]. In all studies, total DNA for the microbial \nfraction was extracted with the PowerSoil kit. Paired-end sequencing was performed on \nPage 17 of 23\nWu et al. Genome Biology  (2024) 25:97\n \nthe Illumina platform [31, 54, 55]. As these microbial samples might still contain some \nviral sequences and the viral samples might contain some microbial sequences, any \noverlapping sequences between viral and microbial datasets will be removed below. The \nquality of each viral dataset was assessed by ViromeQC (v1.0.1) [81], which quantifies \nviral enrichment in viral samples by calculating three enrichment scores based on reads \nmapping to the small and large subunit rRNA, and single-copy bacterial markers. Raw \nreads were assessed and quality-controlled using fastp (v0.22.0) [55, 82] and MultiQC \n(v1.11) [83] and assembled using metaSPAdes (v3.15.3) [84] with k-mer sizes of 21, 33, \n55, 77, 99, and 127. Contigs < 1500 bp were removed before downstream analysis using \nseqtk (v1.3) [85]. Raw sequencing reads were mapped back to assembled contigs with \nlengths of at least 1500 bp using bwa mem (v0.7.17) [86], and the mapping statistics were \nsummarized using samtools stats (v1.14) [87].\nOverlapping sequences between viral and microbial fractions were identified by map -\nping the viral to the microbial contigs using Minimap2 (v2.22) [88] with arguments -x \nava-ont for contigs. Minimap2 does not have a specific identity cutoff but is designed for \nmapping long reads with 5–15% mismatches. Contigs with Minimap2 hits covering at \nleast 80% of the microbial contig length were removed from either size fraction.\nWe used unique contigs with lengths of at least 1500 bp from the viral and micro -\nbial size fractions as ground truth positives and negatives, respectively. Viral contigs that \nwere identified as viral and non-viral by the tools were regarded as true positives and \nfalse negatives, respectively. Microbial contigs that were identified as viral and non-viral \nwere regarded as false positives and true negatives, respectively (Fig. 1).\nConstruction of the simulated testing datasets from the RefSeq database\nTo investigate how the tools perform on mock data with known composition, we down -\nloaded 6495 viral and 52,046 bacterial reference genomes deposited in the RefSeq \ndatabase after 12 January 2020, when the last tool training database, VirSorter2, down -\nloaded their training dataset (latest date: 13 November 2023). We removed plasmids and \ngenomes shorter than 1500 bp, resulting in 6155 viral and 22,552 bacterial genomes. To \nassess the similarity of the viruses deposited after 12 January 2020 to the ones depos -\nited before that date, we performed an mmseqs2 easy search with the translated type (–\nsearch-type 2). Based on this search, we grouped the viruses into three categories, with \nlow (< = 20% similarity, n = 41,970), medium (> 20% and < = 40% similarity, n = 15,580), \nand high (> 40% and < = 100% similarity, n = 4,000) identity to older RefSeq viruses. We \ncut 52,406 fragments (mock contigs) with lengths according to a normal distribution \nwith mean 2000 bp, standard deviation 500 bp, and minimum 1500 bp from both the \nviral and bacterial datasets.\nBenchmarked tools\nWe predicted viral contigs using the What-the-Phage pipeline (v1.0.2) [89], which is a \nwrapper of ten virus identification tools. VirNet was not run successfully. The nine \nremaining tools included CNN tools—DeepVirFinder v1.0 [41] and PPR-Meta v1.1 [42], \nother machine learning tools—Seeker with no release version [90], VIBRANT v1.2.1 \n(with and without virome mode) [43], VirFinder v1.1 [40], andVirSorter2 v2.0 [44], and \nhomology-only tools—MetaPhinder [38] with no release version (with and without own \nPage 18 of 23Wu et al. Genome Biology  (2024) 25:97\ndatabase), Sourmash v2.0.1 [39], and VirSorter v1.0.6 (with and without virome mode) \n[37] (Additional file 2: Table S1). The predicted classes were binarized with 0 and 1 cor -\nresponding to predicted microbial and viral origin, respectively. Our benchmarking \nwork used contigs with lengths of at least 1500 bp because this is the minimum length of \nthe input sequence that can be handled by all tools. Some tools had additional require -\nments. For example, VIBRANT requires input sequences of at least four open reading \nframes. Thus, not all contigs were given a prediction result. Contigs that were not given \nany prediction were assigned to NAs.\nTool performance analysis\nNAs of the identification results by each tool were replaced by zero (i.e., not predicted \nas viral) before calculating performance measures. Performance measures, including \ntrue positive rate (TPR, also known as sensitivity, Eq.  1), false positive rate (FPR, Eq.  2), \ntrue negative rate (TNR, also known as specificity, Eq.  3), precision (Eq. 4), and F1 score \n(Eq. 5) were calculated and plotted in box plots. Receiver operation curves and UpSet \nplots were created using the summarized statistics.\nIn addition, we assessed to what extent the contigs from the viral fraction represented \n(in-)complete genomes using CheckV (v1.0.1) [91] and plotted the detected viral ratio in \neach quality rank in box plots.\nAdditional contigs validation\nWe taxonomically classified the contigs in all testing datasets using CAT (v5.2.3) [92] \nwith Diamond (v2.0.9) [93] and the CAT_database.2021–04-30 database. CAT add_\nnames with the –only_official argument and CAT summarize were used to process the \noutput. Only classifications at the superkingdom rank were used, including “Bacteria, ” \n“ Archaea, ” “Eukaryota, ” “Viruses, ” “no support, ” and “NA. ” “No support” in CAT means \nthat the ORFs in the contigs had no hit in the database. Since viruses are relatively \nunexplored, these contigs might be derived from novel viruses [29]. “NA” means that \nthe ORFs had hits in the database, but these have conflicting taxonomic annotations, \nfor example if different ORFs on a given contig map to viruses and bacteria, potentially \n(1)TPR or sensitivity= TP\nTP + FN\n(2)FPR= FP\nFP+ TN\n(3)TNR or speciﬁcity = TN\nTN + FP\n(4)precision= TP\nTP + FP\n(5)F1 score = 2 ∗precision∗sensitivity\nprecision+ sensitivity\nPage 19 of 23\nWu et al. Genome Biology  (2024) 25:97\n \nreflecting prophages on microbial contigs. We interpreted the contigs with CAT classifi-\ncations “Viruses” as potentially viral, “Bacteria, ” “ Archaea, ” and “Eukaryota, ” as microbial, \nand “no support” and “NA” as unknown. The distributions of viral and microbial contigs \nidentified by CAT in each dataset collection of contigs exclusively identified by tools or \ntool combinations were shown by bar plots.\nTo further validate the contigs in the testing datasets, we queried them for viral and \nmicrobial signals using 8773 viral and 7185 microbial HMMs from CheckV (v1.4) [91]. \nWe translated the nucleotide contigs into amino acid sequences in six frames using \ntranseq from EMBOSS (v6.6.0) [94] and searched the sequences for the 15,958 marker \nHMMs using hmmsearch (v3.2.1) [46, 95]. To quantify the overall viral/microbial signal \nin each subset of contigs, we calculated the fraction of the contig lengths that was cov -\nered by the HMM hits, converted the fraction to log ratios, and visualized the results in \nheatmap.\nTo further investigate specific sequences that were exclusively predicted by different \ntools, we taxonomically classified them using PhaGCN2.0 (v2.0) [75]. Gene annotation \nplots were created by a custom python script, after searching the translated amino acid \nsequences against the PHROG (v4) [96] HMM profile database using hhsearch from the \nHH-suite (v.3.3.0) [97].\nAll statistics were calculated and plotted using custom python and R (v4.1.0) scripts \nand using R packages dplyr (v1.0.8), tidyverse (v1.3.1), scales (v0.6.0), ggplot2 (v3.3.5), \nggbeeswarm (v1.1.1), ROCR (v1.0.11) [98], UpSetR (v1.4.0) [99], ComplexHeatmap \n(v2.8.0) [100], and ggpattern (v0.4.2).\nSupplementary Information\nThe online version contains supplementary material available at https:// doi. org/ 10. 1186/ s13059‑ 024‑ 03236‑4.\nAdditional file 1: Fig. S1. Snakemake workflow of the pipeline. Fig. S2. Real‑world metagenomic assembled contigs \nnumber and length distribution. Fig. S3. True negative rate, precision, and f1 score of tools. Fig. S4. Receiver operat‑\ning characteristiccurves per tool. Fig. S5. UpSet plots summarizing the overlap in predictions between tools from the \nsoil samples. Fig. S6. UpSet plots summarizing the overlap in predictions between tools from the gut samples. Fig. \nS7. Genomic maps of the exclusively identified, longest contigs in the soil virome dataset. Fig. S8. Genomic maps of \nthe exclusively identified, longest contigs in the gut virome dataset. Fig. S9. Performance of tools on simulated data.\nAdditional file 2: Table S1. Summary of virus identification tools. Table S2. Summary of existing benchmarking \nwork. Table S3. Summary of generation methodologies of selected real‑world metagenomic datasets. Table S4. \nSample metadata and data availability of selected real‑world metagenomic datasets. Table S5. ViromeQC results of \nselected real‑world metagenomic datasets. Table S6. Summary of real‑world metagenomic assembled contigs num‑\nbers. Table S7. Reads mapping summary. Table S8. Confusion matrix of real‑world metagenomic testing datasets. \nTable S9. AUC of tools per biome. Table S10. CAT classification summary per biome. Table S11. HMM coverage per \nbiome. Table S12. PhaGCN2 results of the exclusively identified, longest contigs. Table S13. Virus similarity scores \nbased on their similarity compared to previously deposited viral genomes. Table S14. Confusion matrix of simulated \ntesting datasets. Table S15. Number of detected viruses from each similarity category by tools. Table S16. Computa‑\ntional resources used per tool. \nAdditional file 3. Review history.\nAcknowledgements\nWe wish to thank Jan Kees van Amerongen and Dr Swapnil Prakash Doijad for their assistance on using high‑throughput \ncomputing clusters and Dr Berend Snel and Dr Ronnie de Jonge for their valuable remarks on preparing the manuscript. \nSpecial thanks to all present and past members of the Theoretical Biology and Bioinformatics group at Utrecht University \nand the Viral Ecology and Omics Group at Friedrich Schiller University Jena. We acknowledge OpenAI/ChatGPT for help \nin proofreading our manuscript.\nPeer review information\nKevin Pang was the primary editor of this article and managed its editorial process and peer review in collaboration with \nthe rest of the editorial team.\nPage 20 of 23Wu et al. Genome Biology  (2024) 25:97\nReview history\nThe review history is available as Additional file 3.\nAuthors’ contributions\nL.W. designed the study, collected the data, did the analysis, built the automatic pipeline, and wrote the manuscript. N.P . \nand Y.W. assisted with the analysis and automation of the pipeline. G.P . and C.P .D.B. contributed data. B.E.D. conceived the \nstudy and contributed to the study design, data interpretation, and manuscript preparation. All authors read, edited, and \napproved the final manuscript.\nFunding\nOpen Access funding enabled and organized by Projekt DEAL. L.W. is funded by the Utrecht University One Health \nInitiative. Y.W. is funded by the European Union’s Horizon 2020 research and innovation program, under the Marie \nSkłodowska‑Curie Actions Innovative Training Networks grant agreement no. 955974 (VIROINF). N.P . is funded by the \nEuropean Research Council (ERC) Consolidator grant 865694. G.P . and C.P .D.B. are funded by the Dutch Research Council \nNWO (grant ALWPP .2016.019). B.E.D. is funded by the European Research Council (ERC) Consolidator grant 865694: \nDiversiPHI, the Deutsche Forschungsgemeinschaft (DFG, German Research Foundation) under Germany’s Excellence \nStrategy—EXC 2051—Project‑ID 390713860, and the Alexander von Humboldt Foundation in the context of an Alexan‑\nder von Humboldt‑Professorship founded by German Federal Ministry of Education and Research.\nAvailability of data and materials\nThe raw sequences from Antarctic seawater are available at National Center for Biotechnology Information under acces‑\nsion number PRJEB71789 (https:// www. ebi. ac. uk/ ena/ brows er/ view/ PRJEB 71789) [64].\nThe raw sequences from the soil biome are available at National Center for Biotechnology Information under accession \nnumber PRJNA646773 (https:// www. ncbi. nlm. nih. gov/ biopr oject/ PRJNA 646773) [65].\nThe raw sequences from the gut biome are available at National Center for Biotechnology Information under accession \nnumber PRJNA389927 (https:// www. ncbi. nlm. nih. gov/ biopr oject/ PRJNA 389927) [66].\nMore information about the SRA accession numbers is available in Additional file 2: Table S4.\nAssembled contigs from the eight pairs of viral and microbial samples of the three biomes, simulated contigs derived \nfrom the RefSeq database, and other supporting files can be found in the Zenodo repository: https:// doi. org/ 10. 5281/ \nzenodo. 10886 947.\nOur full pipeline is integrated into a Snakemake (v6.5.1) [101] workflow [77, 78] (Additional file 1: Fig. S1). All scripts can \nbe found in GitHub repository https:// github. com/ MGXlab/ virus_ ident ifica tion_ tools_ bench marki ng.\nDeclarations\nEthics approval and consent to participate\nNot applicable.\nConsent for publication\nNot applicable.\nCompeting interests\nThe authors declare that they have no competing interests.\nReceived: 6 June 2023   Accepted: 1 April 2024\nPublished: 15 April 2024\nReferences\n 1. Correa AMS, Howard‑Varona C, Coy SR, Buchan A, Sullivan MB, Weitz JS. Revisiting the rules of life for viruses of \nmicroorganisms. Nat Rev Microbiol. 2021;19:501–13.\n 2. Wigington CH, Sonderegger D, Brussaard CPD, Buchan A, Finke JF, Fuhrman JA, et al. Re‑examination of the rela‑\ntionship between marine virus and microbial cell abundances. Nat Microbiol. 2016;1:1–9.\n 3. Parikka KJ, Le Romancer M, Wauters N, Jacquet S. Deciphering the virus‑to‑prokaryote ratio (VPR): insights into \nvirus–host relationships in a variety of ecosystems. Biol Rev. 2017;92:1081–100.\n 4. Labonté JM, Swan BK, Poulos B, Luo H, Koren S, Hallam SJ, et al. Single‑cell genomics‑based analysis of virus–host \ninteractions in marine surface bacterioplankton. ISME J. 2015;9:2386–99.\n 5. Fuhrman JA. Marine viruses and their biogeochemical and ecological effects. Nature. 1999;399:541–8.\n 6. Thompson LR, Zeng Q, Kelly L, Huang KH, Singer AU, Stubbe J, et al. Phage auxiliary metabolic genes and the \nredirection of cyanobacterial host carbon metabolism. Proc Natl Acad Sci. 2011;108:E757–64.\n 7. Williamson KE, Fuhrmann JJ, Wommack KE, Radosevich M. Viruses in soil ecosystems: an unknown quantity within \nan unexplored territory. Annu Rev Virol Annual Reviews. 2017;4(1):201–19.\n 8. Gigante A, Atterbury RJ. Veterinary use of bacteriophage therapy in intensively‑reared livestock. Virol J. \n2019;16:155.\n 9. Barr JJ, Auro R, Furlan M, Whiteson KL, Erb ML, Pogliano J, et al. Bacteriophage adhering to mucus provide a non–\nhost‑derived immunity. Proc Natl Acad Sci. 2013;110:10771.\n 10. Karthik A, Melissa BD, John AB, Kathleen AW, Brandy MT, Gregory JD. Sulfur oxidation genes in diverse deep‑sea \nviruses. Science. 2014;344(6185):757–60.\n 11. Trubl G, Jang HB, Roux S, Emerson JB, Solonenko N, Vik DR, et al. Soil viruses are underexplored players in ecosys‑\ntem carbon processing. mSystems. 2018;3:e00076‑18.\nPage 21 of 23\nWu et al. Genome Biology  (2024) 25:97\n \n 12. Rosenwasser S, Ziv C, van Creveld SG, Vardi A. Virocell metabolism: metabolic innovations during host‑virus inter‑\nactions in the ocean. Trends Microbiol. 2016;24:821–32.\n 13. Crummett LT, Puxty RJ, Weihe C, Marston MF, Martiny JBH. The genomic content and context of auxiliary meta‑\nbolic genes in marine cyanomyoviruses. Virology. 2016;499:219–29.\n 14. Mullen LM, Nair SP , Ward JM, Rycroft AN, Henderson B. Phage display in the study of infectious diseases. Trends \nMicrobiol. 2006;14:141–7.\n 15. Roux S, Brum JR, Dutilh BE, Sunagawa S, Duhaime MB, Loy A, et al. Ecogenomics and potential biogeochemical \nimpacts of globally abundant ocean viruses. Nature. 2016;537:689–93.\n 16. Cof fey B, Mills S, Coffey A, McAuliffe O, Ross RP . Phage and their lysins as biocontrol agents for food safety applica‑\ntions. Annu Rev Food Sci Technol. 2010;1:449–68.\n 17. Jurczak‑Kurek A, Gąsior T, Nejman‑Faleńczyk B, Bloch S, Dydecka A, Topka G, et al. Biodiversity of bacteriophages: \nmorphological and biological properties of a large group of phages isolated from urban sewage. Sci Rep. \n2016;6:34338.\n 18. Rohde C, Wittmann J. Phage diversity for research and application. Antibiotics. 2020;9:734.\n 19. Braga LPP , Soucy SM, Amgarten DE, da Silva AM, Setubal JC. Bacterial diversification in the light of the interactions \nwith phages: the genetic symbionts and their role in ecological speciation. Front Ecol Evol. 2018 6. Available from: \nhttps:// www. front iersin. org/ artic les/ 10. 3389/ fevo. 2018. 00006 Cited 2023 Mar. 10\n 20. Kim B‑O, Kim ES, Yoo Y‑J, Bae H‑W, Chung I‑Y, Cho Y‑H. Phage‑derived antibacterials: harnessing the simplicity, \nplasticity, and diversity of phages. Viruses. 2019;11:268.\n 21. Harada LK, Silva EC, Campos WF, Del Fiol FS, Vila M, Dąbrowska K, et al. Biotechnological applications of bacterio‑\nphages: state of the art. Microbiol Res. 2018;212–213:38–58.\n 22. Sharma RS, Karmakar S, Kumar P , Mishra V. Application of filamentous phages in environment: a tectonic shift in \nthe science and practice of ecorestoration. Ecol Evol. 2019;9(4):2263–304.\n 23. Sakowski EG, Munsell EV, Hyatt M, Kress W, Williamson SJ, Nasko DJ, et al. Ribonucleotide reductases reveal novel \nviral diversity and predict biological and ecological features of unknown marine viruses. Proc Natl Acad Sci. \n2014;111:15786.\n 24. Nasko DJ, Chopyk J, Sakowski EG, Ferrell BD, Polson SW, Wommack KE. Family A DNA polymerase phylogeny \nuncovers diversity and replication gene organization in the virioplankton. Front Microbiol. 2018 9. Available from: \nhttps:// www. front iersin. org/ artic les/ 10. 3389/ fmicb. 2018. 03053 Cited 2022 Dec. 23\n 25. Zayed AA, Wainaina JM, Dominguez‑Huerta G, Pelletier E, Guo J, Mohssen M, et al. Cryptic and abundant marine \nviruses at the evolutionary origins of Earth’s RNA virome. Science. 2022;376:156–62.\n 26. Edgar RC, Taylor J, Lin V, Altman T, Barbera P , Meleshko D, et al. Petabase‑scale sequence alignment catalyses viral \ndiscovery. Nature. 2022;602:142–7.\n 27. Wolf YI, Silas S, Wang Y, Wu S, Bocek M, Kazlauskas D, et al. Doubling of the known set of RNA viruses by metagen‑\nomic analysis of an aquatic virome. Nat Microbiol. 2020;5:1262–70.\n 28. Wu L, Piedade GJ, Moore RM, Harrison AO, Martins AM, Bidle KD, et al. Ubiquitous, B12‑dependent virioplankton \nutilizing ribonucleotide‑triphosphate reductase demonstrate interseasonal dynamics and associate with a diverse \nrange of bacterial hosts in the pelagic ocean. ISME Commun. 2023;3(1):1–17.\n 29. Mokili JL, Rohwer F, Dutilh BE. Metagenomics and future perspectives in virus discovery. Curr Opin Virol. \n2012;2:63–77.\n 30. Edwards RA, Rohwer F. Viral metagenomics. Nat Rev Microbiol. 2005;3:504–10.\n 31. Santos‑Medellin C, Zinke LA, ter Horst AM, Gelardi DL, Parikh SJ, Emerson JB. Viromes outperform total metagen‑\nomes in revealing the spatiotemporal patterns of agricultural soil viral communities. ISME J. 2021;15:1956–70.\n 32. Hannigan GD, Duhaime MB, Ruffin MT, Koumpouras CC, Schloss PD. Diagnostic potential and interactive dynamics \nof the colorectal cancer virome. mBio. 2018;9:e02248‑18.\n 33. Dutilh BE, Cassman N, McNair K, Sanchez SE, Silva GGZ, Boling L, et al. A highly abundant bacteriophage discov‑\nered in the unknown sequences of human faecal metagenomes. Nat Commun. 2014;5:4498.\n 34. Lobo FP , Mota BEF, Pena SDJ, Azevedo V, Macedo AM, Tauch A, et al. Virus‑host coevolution common patterns of \nnucleotide motif usage in Flaviviridae and their hosts. PLoS ONE. 2009;4(7):e6282.\n 35. Trubl G, Solonenko N, Chittick L, Solonenko SA, Rich VI, Sullivan MB. Optimization of viral resuspension methods \nfor carbon‑rich soils along a permafrost thaw gradient. PeerJ. 2016;4:e1999.\n 36. Roux S, Adriaenssens EM, Dutilh BE, Koonin EV, Kropinski AM, Krupovic M, et al. Minimum information about an \nuncultivated virus genome (MIUViG). Nat Biotechnol. 2019;37:29–37.\n 37. Roux S, Enault F, Hurwitz BL, Sullivan MB. VirSorter: mining viral signal from microbial genomic data. PeerJ. \n2015;3:e985.\n 38. Jurtz VI, Villarroel J, Lund O, Voldby Larsen M, Nielsen M. MetaPhinder—identifying bacteriophage sequences in \nmetagenomic data sets. PLoS ONE. 2016;11:1–14.\n 39. Pierce NT, Irber L, Reiter T, Brooks P , Brown CT. Large‑scale sequence comparisons with sourmash. F1000Research. \n2019;8:1006–1006.\n 40. Ren J, Ahlgren NA, Lu YY, Fuhrman JA, Sun F. VirFinder: a novel k‑mer based tool for identifying viral sequences \nfrom assembled metagenomic data. Microbiome. 2017;5:69.\n 41. Ren J, Song K, Deng C, Ahlgren NA, Fuhrman JA, Li Y, et al. Identifying viruses from metagenomic data using deep \nlearning. Quant Biol. 2020;8:64–77.\n 42. Fang Z, Tan J, Wu S, Li M, Xu C, Xie Z, et al. PPR‑Meta: a tool for identifying phages and plasmids from metagen‑\nomic fragments using deep learning. GigaScience. 2019;8. Available from: https:// doi. org/ 10. 1093/ gigas cience/ \ngiz066\n 43. Kieft K, Zhou Z, Anantharaman K. VIBRANT: automated recovery, annotation and curation of microbial viruses, and \nevaluation of viral community function from genomic sequences. Microbiome. 2020;8:90.\n 44. Guo J, Bolduc B, Zayed AA, Varsani A, Dominguez‑Huerta G, Delmont TO, et al. VirSorter2: a multi‑classifier, expert‑\nguided approach to detect diverse DNA and RNA viruses. Microbiome. 2021;9:37.\nPage 22 of 23Wu et al. Genome Biology  (2024) 25:97\n 45. O’Leary NA, Wright MW, Brister JR, Ciufo S, Haddad D, McVeigh R, et al. Reference sequence (RefSeq) database at \nNCBI: current status, taxonomic expansion, and functional annotation. Nucleic Acids Res. 2016;44:D733‑745.\n 46. Reyes A, Alves J, Durham A, Gruber A. Use of profile hidden Markov models in viral discovery: current insights. Adv \nGenomics Genet. 2017;7:29.\n 47. Starikova EV, Tikhonova PO, Prianichnikov NA, Rands CM, Zdobnov EM, Ilina EN, et al. Phigaro: high‑throughput \nprophage sequence annotation. Bioinformatics. 2020;36:3882–4.\n 48. Nooij S, Schmitz D, Vennema H, Kroneman A, Koopmans MPG. Overview of virus metagenomic classification \nmethods and their biological applications. Front Microbiol. 2018 9. Available from: https:// www. front iersin. org/ \nartic les/ 10. 3389/ fmicb. 2018. 00749 Cited 2023 Jan. 13\n 49. Glickman C, Hendrix J, Strong M. Simulation study and comparative evaluation of viral contiguous sequence \nidentification tools. BMC Bioinformatics. 2021;22:329.\n 50. Pratama AA, Bolduc B, Zayed AA, Zhong Z‑P , Guo J, Vik DR, et al. Expanding standards in viromics: in silico \nevaluation of dsDNA viral genome identification, classification, and auxiliary metabolic gene curation. PeerJ. \n2021;9:e11447.\n 51. de Vries JJC, Brown JR, Fischer N, Sidorov IA, Morfopoulou S, Huang J, et al. Benchmark of thirteen bioinformatic \npipelines for metagenomic virus diagnostics using datasets from clinical samples. J Clin Virol. 2021;141:104908.\n 52. Schackart KE, Graham JB, Ponsero AJ, Hurwitz BL. Evaluation of computational phage detection tools for \nmetagenomic datasets. Front Microbiol. 2023 14. Available from: https:// www. front iersin. org/ artic les/ 10. 3389/ \nfmicb. 2023. 10787 60 Cited 2023 Feb. 15\n 53. Ho SFS, Wheeler NE, Millard AD, van Schaik W. Gauge your phage: benchmarking of bacteriophage identification \ntools in metagenomic sequencing data. Microbiome. 2023;11:84.\n 54. Piedade GJ, Schön ME, Lood C, Fofanov MV, Wesdorp EM, Biggs TEG, et al. Seasonal dynamics and diversity of \nAntarctic marine viruses reveal a novel viral seascape. In Review. 2024 Available from: https:// www. resea rchsq uare. \ncom/ artic le/ rs‑ 37788 32/ v1\n 55. Hannigan GD, Duhaime MB, Ruffin 4th MT, Koumpouras CC, Schloss PD. Diagnostic potential and interactive \ndynamics of the colorectal cancer virome. mBio. 2021;9:e02248–18.\n 56. von Meijenfeldt FAB, Hogeweg P , Dutilh BE. A social niche breadth score reveals niche range strategies of general‑\nists and specialists. Nat Ecol Evol. 2023;7:768–81.\n 57. Thurber RV, Haynes M, Breitbart M, Wegley L, Rohwer F. Laboratory procedures to generate viral metagenomes. \nNat Protoc. 2009;4:470–83.\n 58. Silveira CB, Luque A, Rohwer F. The landscape of lysogeny across microbial community density, diversity and \nenergetics. Environ Microbiol. 2021;23:4098–111.\n 59. Emerson JB, Roux S, Brum JR, Bolduc B, Woodcroft BJ, Jang HB, et al. Host‑linked soil viral ecology along a perma‑\nfrost thaw gradient. Nat Microbiol. 2018;3:870–80.\n 60. Nicolas AM, Sieradzki ET, Pett‑Ridge J, Banfield JF, Taga ME, Firestone MK, et al. A subset of viruses thrives fol‑\nlowing microbial resuscitation during rewetting of a seasonally dry California grassland soil. Nat Commun. \n2023;14(1):5835.\n 61. Muscatt G, Cook R, Millard A, Bending GD, Jameson E. Ecological and evolutionary patterns of virus‑host interac‑\ntions throughout a grassland soil depth profile. [Preprint]. 2022. Available from: https:// doi. org/ 10. 1101/ 2022. 12. \n09. 519740.\n 62. Carini P , Marsden PJ, Leff JW, Morgan EE, Strickland MS, Fierer N. Relic DNA is abundant in soil and obscures esti‑\nmates of soil microbial diversity. Nat Microbiol. 2016;2:1–6.\n 63. Santos‑Medellín C, Blazewicz SJ, Pett‑Ridge J, Firestone MK, Emerson JB. Viral but not bacterial community succes‑\nsional patterns reflect extreme turnover shortly after rewetting dry soils. Nat Ecol Evol. 2023;7(11):1809–22.\n 64. Piedade GJ, Schön ME, Lood C, Fofanov MV, Wesdorp EM, Biggs TEG, et al. Metagenomes and Virome Antarctic \ntimeseries. Datasets. ENA. 2024. https:// www. ebi. ac. uk/ ena/ brows er/ view/ PRJEB 71789.\n 65. Santos‑Medellin C, Zinke LA, ter Horst AM, Gelardi DL, Parikh SJ, Emerson JB. Characterization of viral communi‑\nties associated with agricultural soils. Datasets. NCBI SRA. 2021. https:// www. ncbi. nlm. nih. gov/ biopr oject/ PRJNA \n646773.\n 66. Hannigan GD, Duhaime MB, Ruffin 4th MT, Koumpouras CC, Schloss PD. Viral and bacterial communities of colo‑\nrectal cancer. Datasets. NCBI SRA. 2017. https:// www. ncbi. nlm. nih. gov/ biopr oject/ PRJNA 389927.\n 67. Roux S, Krupovic M, Debroas D, Forterre P , Enault F. Assessment of viral community functional potential from viral \nmetagenomes may be hampered by contamination with cellular sequences. Open Biol. 2013;3:130160.\n 68. Sorensen JW, Zinke LA, ter Horst AM, Santos‑Medellín C, Schroeder A, Emerson JB. DNase treatment improves viral \nenrichment in agricultural soil viromes. mSystems. 2021;6:e00614–21.\n 69. ter Horst AM, Santos‑Medellín C, Sorensen JW, Zinke LA, Wilson RM, Johnston ER, et al. Minnesota peat viromes \nreveal terrestrial and aquatic niche partitioning for local and global viral populations. Microbiome. 2021;9:233.\n 70. Emerson JB, Thomas BC, Andrade K, Allen EE, Heidelberg KB, Banfield JF. Dynamic viral populations in hypersaline \nsystems as revealed by metagenomic assembly. Appl Environ Microbiol. 2012;78:6309–20.\n 71. He T, Jin M, Cui P , Sun X, He X, Huang Y, et al. Environmental viromes reveal the global distribution signatures of \ndeep‑sea DNA viruses. J Adv Res. 2023 Available from: https:// www. scien cedir ect. com/ scien ce/ artic le/ pii/ S2090 \n12322 30011 57 Cited 2024 Jan 11\n 72. Corinaldesi C, Tangherlini M, Dell’Anno A. From virus isolation to metagenome generation for investigating viral \ndiversity in deep‑sea sediments. Sci Rep. 2017;7:8355.\n 73. Nishijima S, Nagata N, Kiguchi Y, Kojima Y, Miyoshi‑Akiyama T, Kimura M, et al. Extensive gut virome variation and \nits associations with host and environmental factors in a population‑level cohort. Nat Commun. 2022;13:5252.\n 74. van Dijk B, Buffard P , Farr AD, Giersdorf F, Meijer J, Dutilh BE, et al. Identifying and tracking mobile elements in \nevolving compost communities yields insights into the nanobiome. ISME Commun. 2023;3:1–13.\n 75. Jiang J‑Z, Yuan W‑G, Shang J, Shi Y‑H, Yang L‑L, Liu M, et al. Virus classification for viral genomic fragments using \nPhaGCN2. Brief Bioinform. 2023;24:bbac505.\nPage 23 of 23\nWu et al. Genome Biology  (2024) 25:97\n \n 76. Gregory AC, Zayed AA, Conceição‑Neto N, Temperton B, Bolduc B, Alberti A, et al. Marine DNA viral macro‑ and \nmicrodiversity from pole to pole. Cell. 2019;177:1109‑1123.e14.\n 77. Wu L‑Y, Wijesekara Y, Piedade GJ, Pappas N, Brussaard CPD, Dutilh BE. A pipeline for benchmarking bioinformatic \nvirus identification tools using real‑world metagenomic data across biomes. Zenodo. 2024.https:// doi. org/ 10. \n5072/ zenodo. 42003.\n 78. Wu L‑Y, Wijesekara Y, Piedade GJ, Pappas N, Brussaard CPD, Dutilh BE. A pipeline for benchmarking bioinformatic \nvirus identification tools using real‑world metagenomic data across biomes. GitHub. 2024. https:// doi. org/ 10. \n5072/ zenodo. 42003.\n 79. Kim K‑H, Bae J‑W. Amplification methods bias metagenomic libraries of uncultured single‑stranded and double‑\nstranded DNA viruses. Appl Environ Microbiol. 2011;77:7663–8.\n 80. Duhaime MB, Deng L, Poulos BT, Sullivan MB. Towards quantitative metagenomics of wild viruses and other ultra‑\nlow concentration DNA samples: a rigorous assessment and optimization of the linker amplification method. Env \nMicrobiol. 2012;14:2526–37.\n 81. Zolfo M, Pinto F, Asnicar F, Manghi P , Tett A, Bushman FD, et al. Detecting contamination in viromes using Virom‑\neQC. Nat Biotechnol. 2019;37:1408–12.\n 82. Chen S, Zhou Y, Chen Y, Gu J. fastp: an ultra‑fast all‑in‑one FASTQ preprocessor. Bioinformatics. 2018;34:i884–90.\n 83. Ewels P , Magnusson M, Lundin S, Käller M. MultiQC: summarize analysis results for multiple tools and samples in a \nsingle report. Bioinformatics. 2016;32:3047–8.\n 84. Nurk S, Meleshko D, Korobeynikov A, Pevzner PA. metaSPAdes: a new versatile metagenomic assembler. Genome \nRes. 2017;27:824–34.\n 85. Shen W, Le S, Li Y, Hu F. SeqKit: a cross‑platform and ultrafast toolkit for FASTA/Q file manipulation. PLoS ONE. \n2016;11:1–10.\n 86. Li H, Durbin R. Fast and accurate short read alignment with Burrows‑Wheeler transform. Bioinformatics. \n2009;25:1754–60.\n 87. Li H. A statistical framework for SNP calling, mutation discovery, association mapping and population genetical \nparameter estimation from sequencing data. Bioinformatics. 2011;27:2987–93.\n 88. Li H. Minimap2: pairwise alignment for nucleotide sequences. Bioinformatics. 2018;34:3094–100.\n 89. Marquet M, Hölzer M, Pletz MW, Viehweger A, Makarewicz O, Ehricht R, et al. What the Phage: a scalable workflow \nfor the identification and analysis of phage sequences. GigaScience. 2022;11:giac110.\n 90. Auslander N, Gussow AB, Benler S, Wolf YI, Koonin EV. Seeker: alignment‑free identification of bacteriophage \ngenomes by deep learning. Nucleic Acids Res. 2020;48:e121–e121.\n 91. Nayfach S, Camargo AP , Schulz F, Eloe‑Fadrosh E, Roux S, Kyrpides NC. CheckV assesses the quality and complete‑\nness of metagenome‑assembled viral genomes. Nat Biotechnol. 2021;39:578–85.\n 92. von Meijenfeldt FAB, Arkhipova K, Cambuy DD, Coutinho FH, Dutilh BE. Robust taxonomic classification of \nuncharted microbial sequences and bins with CAT and BAT. Genome Biol. 2019;20:217.\n 93. Buchfink B, Xie C, Huson DH. Fast and sensitive protein alignment using DIAMOND. Nat Methods. 2015;12:59–60.\n 94. Rice P , Longden I, Bleasby A. EMBOSS: the European Molecular Biology Open Software Suite. Trends Genet. \n2000;16:276–7.\n 95. Eddy SR. Hidden Markov models. Curr Opin Struct Biol. 1996;6:361–5.\n 96. Terzian P , Olo Ndela E, Galiez C, Lossouarn J, Pérez Bucio RE, Mom R, et al. PHROG: families of prokaryotic virus \nproteins clustered using remote homology. NAR Genomics Bioinforma. 2021;3. Available from: https:// doi. org/ 10. \n1093/ nargab/ lqab0 67\n 97. Steinegger M, Meier M, Mirdita M, Vöhringer H, Haunsberger SJ, Söding J. HH‑suite3 for fast remote homology \ndetection and deep protein annotation. BMC Bioinformatics. 2019;20:473.\n 98. Sing T, Sander O, Beerenwinkel N, Lengauer T. ROCR: visualizing classifier performance in R. Bioinformatics. \n2005;21:7881.\n 99. Conway JR, Lex A, Gehlenborg N. UpSetR: an R package for the visualization of intersecting sets and their proper‑\nties. Bioinformatics. 2017;33:2938–40.\n 100. Gu Z, Eils R, Schlesner M. Complex heatmaps reveal patterns and correlations in multidimensional genomic data. \nBioinformatics. 2016;32(18):2847–9.\n 101. Köster J, Rahmann S. Snakemake—a scalable bioinformatics workflow engine. Bioinformatics. 2012;28:2520–2.\nPublisher’s Note\nSpringer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.",
  "topic": "Benchmarking",
  "concepts": [
    {
      "name": "Benchmarking",
      "score": 0.9366261959075928
    },
    {
      "name": "Metagenomics",
      "score": 0.9071444272994995
    },
    {
      "name": "Identification (biology)",
      "score": 0.7645173668861389
    },
    {
      "name": "Biome",
      "score": 0.6714539527893066
    },
    {
      "name": "Contig",
      "score": 0.6516562700271606
    },
    {
      "name": "Biology",
      "score": 0.5771842002868652
    },
    {
      "name": "Computational biology",
      "score": 0.5266192555427551
    },
    {
      "name": "Benchmark (surveying)",
      "score": 0.4439636468887329
    },
    {
      "name": "Computer science",
      "score": 0.4097678065299988
    },
    {
      "name": "Data mining",
      "score": 0.3712466061115265
    },
    {
      "name": "Machine learning",
      "score": 0.33916640281677246
    },
    {
      "name": "Data science",
      "score": 0.3200639486312866
    },
    {
      "name": "Genetics",
      "score": 0.1737770140171051
    },
    {
      "name": "Ecology",
      "score": 0.14779332280158997
    },
    {
      "name": "Genome",
      "score": 0.11671727895736694
    },
    {
      "name": "Geography",
      "score": 0.10267496109008789
    },
    {
      "name": "Cartography",
      "score": 0.07499969005584717
    },
    {
      "name": "Gene",
      "score": 0.06445580720901489
    },
    {
      "name": "Ecosystem",
      "score": 0.0
    },
    {
      "name": "Marketing",
      "score": 0.0
    },
    {
      "name": "Business",
      "score": 0.0
    }
  ]
}