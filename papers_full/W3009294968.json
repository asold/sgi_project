{
    "title": "GPU-Based Dynamic Solar Potential Estimation Tool Using 3D Plans",
    "url": "https://openalex.org/W3009294968",
    "year": 2020,
    "authors": [
        {
            "id": "https://openalex.org/A2326740770",
            "name": "Sümeyye Kaynak",
            "affiliations": [
                "Sakarya University"
            ]
        },
        {
            "id": "https://openalex.org/A2313631162",
            "name": "Baran Kaynak",
            "affiliations": [
                "Sakarya University"
            ]
        },
        {
            "id": "https://openalex.org/A2091373707",
            "name": "Ahmet ÖZMEN",
            "affiliations": [
                "Sakarya University"
            ]
        },
        {
            "id": "https://openalex.org/A2326740770",
            "name": "Sümeyye Kaynak",
            "affiliations": [
                "Sakarya University"
            ]
        },
        {
            "id": "https://openalex.org/A2313631162",
            "name": "Baran Kaynak",
            "affiliations": [
                "Sakarya University"
            ]
        },
        {
            "id": "https://openalex.org/A2091373707",
            "name": "Ahmet ÖZMEN",
            "affiliations": []
        }
    ],
    "references": [
        "https://openalex.org/W2000296882",
        "https://openalex.org/W2604236486",
        "https://openalex.org/W2156516396",
        "https://openalex.org/W2167583754",
        "https://openalex.org/W2170268965",
        "https://openalex.org/W6694186371",
        "https://openalex.org/W2037315895",
        "https://openalex.org/W2928433454",
        "https://openalex.org/W1988426418",
        "https://openalex.org/W2126757106",
        "https://openalex.org/W1645481388",
        "https://openalex.org/W2008277054",
        "https://openalex.org/W2218407291",
        "https://openalex.org/W2911803612",
        "https://openalex.org/W2807553124",
        "https://openalex.org/W2510903058",
        "https://openalex.org/W1992610893",
        "https://openalex.org/W1984615142",
        "https://openalex.org/W2089156343",
        "https://openalex.org/W2578049675",
        "https://openalex.org/W2998657661",
        "https://openalex.org/W2777032093",
        "https://openalex.org/W6608333407",
        "https://openalex.org/W2125834435",
        "https://openalex.org/W2083344034",
        "https://openalex.org/W2147675181",
        "https://openalex.org/W2030636659",
        "https://openalex.org/W2067019903",
        "https://openalex.org/W2566227558",
        "https://openalex.org/W2802887123",
        "https://openalex.org/W6609468637",
        "https://openalex.org/W2802177710",
        "https://openalex.org/W1981176609",
        "https://openalex.org/W6682043884",
        "https://openalex.org/W2019135906",
        "https://openalex.org/W2030758903",
        "https://openalex.org/W6756408253",
        "https://openalex.org/W2555822554",
        "https://openalex.org/W2015209649",
        "https://openalex.org/W2508286123",
        "https://openalex.org/W2519051700",
        "https://openalex.org/W1916760571",
        "https://openalex.org/W2570881942",
        "https://openalex.org/W2072904017",
        "https://openalex.org/W2525448601",
        "https://openalex.org/W3213780069",
        "https://openalex.org/W2061632729",
        "https://openalex.org/W2046690454",
        "https://openalex.org/W2007845682",
        "https://openalex.org/W2128022558",
        "https://openalex.org/W2766142123",
        "https://openalex.org/W2492975200",
        "https://openalex.org/W2074253843",
        "https://openalex.org/W2271638383",
        "https://openalex.org/W250314321",
        "https://openalex.org/W2900070758",
        "https://openalex.org/W201374358",
        "https://openalex.org/W2150516886"
    ],
    "abstract": "Estimations of the solar potential from the building design files may affect placement considerations in favor of more sunlight reception that reduces the energy costs and saves the environment. In this study, a GPU based system (GPU-DSRM) is proposed to estimate direct and diffuse solar radiation aggregated on 3D structures at urban or individual scale. In the proposed approach, finite element method, back-face detection and ray-tracing algorithms are customized to run in parallel to reduce the execution time. Thus, real-time shadow analysis with adjustable sampling rate and time scale can be performed without compromising precision and accuracy of the estimations. The most important novel aspect of the study is that it can be used anywhere in the world without the need for meteorological data. Some of the test results obtained from a site with 10 buildings are presented in this paper that shows a speedup value of 45 with the new GPU-based implementation compared to the CPU-based model. The GPU-DSRM tool has also been compared with geometric tools in the literature. Solar energy potential analysis of building designs or existing urban formations can be completed faster and more precisely with this new approach.",
    "full_text": "Received February 18, 2020, accepted February 29, 2020, date of publication March 5, 2020, date of current version March 16, 2020.\nDigital Object Identifier 10.1 109/ACCESS.2020.2978590\nGPU-Based Dynamic Solar Potential\nEstimation Tool Using 3D Plans\nSÜMEYYE KAYNAK\n 1, BARAN KAYNAK\n 2, AND AHMET ÖZMEN\n1\n1Department of Computer Engineering, Sakarya University, 54050 Sakarya, Turkey\n2Computer Research and Application Center, Sakarya University, 54050 Sakarya, Turkey\nCorresponding author: Ahmet Özmen (ozmen@sakarya.edu.tr)\nABSTRACT Estimations of the solar potential from the building design ﬁles may affect placement\nconsiderations in favor of more sunlight reception that reduces the energy costs and saves the environment.\nIn this study, a GPU based system (GPU-DSRM) is proposed to estimate direct and diffuse solar radiation\naggregated on 3D structures at urban or individual scale. In the proposed approach, ﬁnite element method,\nback-face detection and ray-tracing algorithms are customized to run in parallel to reduce the execution time.\nThus, real-time shadow analysis with adjustable sampling rate and time scale can be performed without\ncompromising precision and accuracy of the estimations. The most important novel aspect of the study is\nthat it can be used anywhere in the world without the need for meteorological data. Some of the test results\nobtained from a site with 10 buildings are presented in this paper that shows a speedup value of 45 with\nthe new GPU-based implementation compared to the CPU-based model. The GPU-DSRM tool has also\nbeen compared with geometric tools in the literature. Solar energy potential analysis of building designs or\nexisting urban formations can be completed faster and more precisely with this new approach.\nINDEX TERMS Solar potential analysis, GPU, 3D City Model.\nNOMENCLATURE\nα Hourly elevation angle\nβ Slope\nδ Declination angle\nω Hour angle\nθ The angle between the normal of the sloped surface\nand the direction of the sun. The angle of the sun to\nthe surface\nε Elevation angle constant\nϕ Latitude angle\nHb Direct solar radiation on a horizontal surface\nHd Diffuse solar radiation on a horizontal surface\nHtd Diffuse solar radiation on a sloped surface\nS Daily duration of daylight\nθz The zenith angle of the sun\nH0 Extraterrestrial irradiation\nH Global solar radiation value for horizontal surfaces\nKt H\nH0\n,clearness index\nRd Conversion factor of diffuse radiation\nS0 Maximum duration of daylight possible\nThe associate editor coordinating the review of this manuscript and\napproving it for publication was Sungroh Yoon\n .\nI. INTRODUCTION\nOne of the most important indicators of development is the\nstate of cities. Hence, the provision of quality housing and\nthe formation of sustainable cities are necessary in order to\nimprove living standards. The design of long-lasting, resilient\nhousing against future global climate changes and the abil-\nity to work together with climate play central roles in the\nformation of sustainable cities. Many parameters should be\nanalyzed in detail for a qualiﬁed housing design such as\nselection of land, location of the building facades, building\ngeometry, lighting etc. Consideration of these parameters\nduring the design phase will enable to achieve better perfor-\nmance from the active systems installed homes. Aside from\nthis, retroﬁtting changes which is made to sustain an existing\nbuilding or cities change the physical, social structure and\nsolar potential of the building [1].\nSolar energy is one of the renewable sources where active\nand passive systems are widely used to utilize in a sustainable\ncity. The installation of buildings that optimally exploit solar\nenergy potential provides the power to meet both thermal\nand electrical energy requirements [2]. In order to increase\nthe utilization of solar energy in houses and cities, radia-\ntion analysis on 3D structures should be done in the most\n45432 This work is licensed under a Creative Commons Attribution 4.0 License. For more information, see https://creativecommons.org/licenses/by/4.0/VOLUME 8, 2020\nS. Kaynaket al.: GPU-Based Dynamic Solar Potential Estimation Tool Using 3D Plans\naccurate way to obtain better planning of energy resources\nand energy distribution systems [3]–[5]. The accuracy of the\nanalysis depends on the holistic analysis of the 3D structures\nin complex urban environments and the effectiveness of the\nmodel.\nThere are many studies in the literature to estimate solar\npotential of buildings. As a result of these studies, two types\nof solar potential calculation software tool have been devel-\noped: rendering and geometric. Rendering tools are difﬁ-\ncult to use and less preferable for general solar potential\nanalysis since they require meteorological data and detailed\nmaterial information of the structures. DIV A-for-Rhino and\nHoneybee/Ladybug are examples of rendering tools. On the\nother hand, geometric tools are less complex to use because\nthey only use geometric relationships between the sun and\nthe sky. Geometric tools consider only direct reﬂection, and\nusually don’t rely on climate data and building material prop-\nerties. ArcGIS and GRASS GIS are examples of geometric\ntools.\nWhen geometric tools are examined, it is seen that there\nare few studies that perform radiation analysis of buildings\nin the design stage, consider the shadow effect [6], [7].\nHowever, only the roofs of the buildings were focused and\ntheir facades were not taken into consideration in solar\nestimations. In these pixel-based studies, roof shadows are\nobtained by using the shading maps which is taken only a\nfew times in a day. Hence, a dynamic shadow analysis is not\npossible in the pixel based systems.\nSolar potential estimation becomes an iterative process\nwhen optimal position and facade forms are searched for a\nbuilding. This may require many trials to obtain the best home\ndesign parameters, and when the problem becomes urban\nsize, radiation analysis may take weeks to get the results [8].\nHence, high performance computers and appropriate algo-\nrithms are needed to obtain the results in shorter time.\nBased on these shortcomings, a geometric based solar\npotential analysis tool development study was carried out in\naccordance with the following objectives: 1) The tool must\nbe able to analyze solar potential for any part of the world\n(no meteorological data is needed), 2) it must take into\naccount all building surfaces either in design phase or com-\npleted, 3) it must do dynamic shading analysis, 4) it must\nproduce high precision and accurate results (by dividing sur-\nfaces into smaller pieces and dynamic sampling), 5) it must\ncomplete the analysis in a reasonable time.\nDuring the study, it was understood that the conventional\nmethods are not be suitable for this task; hence, a new\nGraphical Processing Unit (GPU) based high-performance\nparallel algorithm has been developed. Solar analysis can be\ncarried out at any location in the world within a reasonable\ntime using this new approach, including shadow analysis\nwith roofs and facades using 3D building plans provided in\nCityGML format. The tool developed in this study is targeting\nurban planners, architects, civil engineers, energy investors\nand even individuals.\nII. RELATED WORK\nIn literature, many models have been developed for solar\nradiation analysis, some of which are linear and the others\nnonlinear mathematical models, there are also artiﬁcial intel-\nligence techniques and hybrid models [9], [10]. Solar geom-\netry information (solar incidence angle, azimuth, latitude,\nlongitude and hour angle etc.), atmospheric conditions, phys-\nical properties of the area to be analyzed (albedo value etc.)\nplay important roles in determining the amount of radiation\non horizontal and inclined surfaces.\nSome models have been used for the radiation analysis\nof 3D buildings in an urban environment but these models\nalone are not sufﬁcient. For example, shadows caused by\nstructures or other objects in the environment must be taken\ninto account. However, this require a detailed 3D informa-\ntion about the area and/or structure to obtain more accurate\nresults. The detailed information is usually obtained using air-\nborne and satellite images, Airborne Laser Scanning (ALS),\nTerrestrial Laser Scanning (TLS) techniques or Light Detec-\ntion and Ranging (LIDAR) systems [11]–[13]. These tech-\nnologies are used in many studies, such as analysis of solar\nradiation of building roofs in urban areas [14], [15], estima-\ntion of PV potential of solar radiation on roofs [16]–[18],\ndetermination of optimum position of PV panels on roof [19],\nevaluating solar radiation over facades [20], [21], and analysis\nof solar energy potential of buildings [22]–[24].\nThese technologies are costly and not suitable for newly\ndesigned buildings or living areas. Hence, a pixel-based\napproach is proposed to estimate solar potential on ﬂat\nroofs which doesn’t rely on technologies such as LiDAR,\nALS, MLS [6]. In this study, buildings with ﬂat roofs in a\nnewly planned construction area are chosen as a case study.\nIn another study, researchers are focused on estimating the\nsolar potential of pitched roofs based on the pretext archi-\ntectural design drawings which use a pixel based approach\nwithout technologies such as LIDAR, ALS, MLS [7]. A typi-\ncal Australian house with nine roofs is chosen for case study.\nIn this study, shadows are also considered by using shading\nmaps.\nShadows have large impact on solar potential, therefore\nshading analysis should be done continuously for high accu-\nracy estimates. A dynamic solar radiation model (DSRM) is\npresented at another work to evaluate the solar potential on\n3D structures (facades, roofs) which can be either in planning\nstage or completed at the urban or individual scale [25].\nA real-time shadow analysis in the desired sensitivity and\ntime scale can be achieved using the proposed approach\nwhere the analysis takes approximately 11 hours. To reduce\nthe response time, a new geometric method has been devel-\noped by another group to estimate the solar radiation of\nbuildings using rooftop by 3D models [26].\nThe response time becomes an important factor when large\nscale solar radiation applications are considered including\nthe dynamic shading analysis. High performance computer\nclusters and software techniques such as parallel computing\nVOLUME 8, 2020 45433\nS. Kaynaket al.: GPU-Based Dynamic Solar Potential Estimation Tool Using 3D Plans\nenvironments or specialized hardware devices are preferred\nfor solar potential analysis or weather forecasting [27], [28].\nAlthough cluster computing provides more ﬂexible comput-\ning environment, multi-core systems are more preferred in\nexisting studies due to their ease of programming and better\nprice-performance ratio within smaller size [29].\nUse of Graphical Processing Unit (GPU) architecture to\nmeet high performance computing demand has been a fre-\nquently used approach in last decade. GPU architecture\nimplements the Single Instruction Multiple Data (SIMD)\nmodel with a large number of cores [30]. The scientiﬁc\ncommunity takes advantage of this technology to accelerate\ntheir applications by performing concurrent computation on\nGPU cores. This is usually referred as General Purpose Com-\nputation on GPU (GPGPU). Parallelization of serial code\nis a tedious task; however, it becomes more complex when\nGPU is considered due to its unique architecture [31]. If an\nalgorithm was originally coded for a traditional computer,\nthen the best is to redesign the algorithm for a target GPU\narchitecture, then code it from scratch to obtain well perform-\ning concurrent execution.\nCompute Uniﬁed Device Algorithm (CUDA) is a parallel\ncomputing platform and software programming model devel-\noped by NVIDIA to utilize GPU architecture for high perfor-\nmance problems. With the support of CUDA programming\nmodel, NVIDIA becomes dominant GPU architecture for\nmany applications as well as geographic information systems\napplications [32].\nA software developer with basic parallel programming\nknowledge and high-level programming skills can develop\napplications using with the NVIDIA-CUDA programming\nplatform. In this study, CUDA programming model is pre-\nferred because it is more mature and has extensive docu-\nmental support that allow coding in high-level languages.\nIn order to beneﬁt from the capabilities of the GPU archi-\ntecture, applications running on the CPU can be moved onto\nthe GPU; however, the correctness and performance analysis\nof the work must carefully be carried out.\nMany high performance methods have been developed for\nfaster solar radiation applications. Parallelization are the most\npreferred approach in order to meet high performance needs.\nThere are many studies that beneﬁt from the GPU-based\nparallelism in order to meet the objectives such as faster\nﬁltering of data used in solar radiation analysis studies\n[33]–[36], reducing the response time of the solar radiation\nanalysis application [29], [37]–[39] and existing radiation\nanalysis tools [40]. GPU method that can perform solar\npotential analysis of 3D building(s) which can either be in\ndesign stage or completed hasn’t been encountered in the\nliterature. The developed method uses 3D input ﬁles of the\ntarget building(s) at any scale. The better response time of\nthe application allows examining alternative building designs\nand placement layouts within shorter time in solar poten-\ntial perspective. The proposed method is described in detail\nin section IV.\nIII. PARALLELISM FOR PERFORMANCE AND\nCUDA ARCHITECTURE\nMulti-core CPU architectures implement limited amount of\nparallelism via multi-threaded programming model and they\nare still far away to meet the increasing demand for high\nperformance. The successive execution of the commands\nmakes the performance of the CPUs inadequate for high\ncomputational requirements. Parallelism is a solution for this\ndemand and can be achieved with several hardware models:\ndistributed memory, shared memory or hybrid models.\nIn distributed memory model, a parallel system can be\norganized by connecting many computers using high speed\nnetwork infrastructure, and parallelism can be obtained in the\ntask level granularity. Distributed nature of the system causes\nsigniﬁcant communication and synchronization overheads\nwhile passing data between processes at separate computers.\nThis type of systems is scalable, ﬂexible; but they are hard to\nprogram.\nThere are several shared memory parallel architecture\napproaches in use. One of them is very well known multi-core\nCPU system. The other approach is to use multiple separate\nCPUs on the same board that share the main memory. This\ntype of computers is usually implemented as workstation or\nserver systems. Multiple-CPU systems are expensive, have\nﬁxed structure in nature and do not scale well with the prob-\nlem size. However, they are comparatively easy to program,\nbecause compiler does all the tedious complex part of the task\ndistribution between CPUs.\nFIGURE 1. General purpose CPU-GPU architecture for high performance\ncomputing.\nLike other systems, GPU architecture also implements a\nshared memory model with thousands of processing elements\n(GPU cores) connected to a uniﬁed memory. However, GPU\ncomputing differs from above parallel approaches because\nit comes as an attachment to a main system (see Figure 1).\nMoreover, the programmer must know internal details of the\ninterested GPU architecture to develop application. Inter-\nestingly, GPU architecture allows data level parallelism\nwhich makes it superior for some applications [41]. As a\nsolution to high performance requirements, GPU-supported\nhigh-performance computing systems are widely preferred\nbecause of their ease of use and price-performance advantage.\n45434 VOLUME 8, 2020\nS. Kaynaket al.: GPU-Based Dynamic Solar Potential Estimation Tool Using 3D Plans\nMultiple GPU boards can be installed into one case, and\nmultiple GPU servers can be interconnected via a high speed\nnetwork to form a hybrid parallel system.\nNVIDIA created a model called Compute Uniﬁed Device\nArchitecture (CUDA) to enable graphic cards to be used\nfor high performance calculations [42]. CUDA allows code\ndevelopers to program NVIDIA brand graphic cards in ordi-\nnary computers for their high performance workloads. CUDA\narchitecture has a hierarchical layout in each device: grids,\nblocks and threads. A programmer can address the concurrent\nexecutions (threads) by using 3D arrays. CUDA source code\nrunning on the CPU is called ‘‘host code’’, and the code\nrunning on GPU is called the ‘‘device code’’. The functions\nrequired to run on the GPU are called ‘‘kernel functions’’.\nDuring the run, a new grid is created logically for each kernel\ncall and the kernel function is divided into thread blocks [43].\nThe number of blocks and threads varies depending on the\napplication, the most appropriate thread and block counts are\nobtained from the experiences. All blocks of the GPU must\nbe in use for optimum performance.\nIV. GPU-BASED SOLAR POTENTIAL ESTIMATION\nIn this study, a software tool that implements real-time shad-\ning analysis with GPU accelerated DSRM model have been\ndeveloped to estimate solar energy potential more quickly and\nprecisely. Detailed information on the dynamic solar radia-\ntion model is given in section IV-A. Section IV-B describes\nGPU based DSRM model in detail.\nA. RESEARCH METHODOLOGY\nDynamic global solar radiation model has been developed\nto predict solar radiation potential of 3D structures at the\nindividual/urban scale (see Figure 2). The model takes 3D\nplans and sun information such as altitude, azimuth, hour\nangles of the sun as input. The sun information such as\ndeclination and zenith angles are calculated using the equa-\ntions introduced in a book by Dufﬁe and Beckman [44]. The\nback-face detection algorithm is used to detect sun-facing\nsurfaces. In the algorithm, all surfaces of interested buildings\nare divided into small triangles at the desired scale by using\nthe ﬁnite element method. Each triangle on the front surface\nis subjected to ray-triangle-intersection test with the others,\nand this test determines the triangles that the sunlight directly\nreach. For the shadow-less triangles, global radiation amount\nequals the sum of direct and diffuse radiation. For shaded\nareas, the global solar radiation amount is taken as only the\ndiffusion radiation value.\nIn this study, Angstrom–Prescot model is used to\nobtain the global solar radiation amount on horizontal\nsurfaces [45], [46].\nH\nH0\n=a +b ∗\n(S\nSo\n)\n(1)\nThe coefﬁcients a and b in Equation 1 are called Angstrom\ncoefﬁcients. The coefﬁcient values a = 0.25, b = 0.50\nproposed in [47] are used. The performance of the Angstrom-\nFIGURE 2. Basic steps of the DSRM model.\nPrescot model with these suggested coefﬁcient values has\nbeen evaluated for Kastamonu, Sakarya, Adıyaman, Afyon,\nDiyarbakır and İzmir. The model outputs are compared with\nglobal solar radiation data measured by the ‘‘General Direc-\ntorate of Renewable Energy/Turkey’’ (http://www.eie.gov.tr).\nThe model was tested for the cities mentioned in the previous\nwork and veriﬁed that it produces acceptable results [25].\nThe direct radiation value on the horizontal surface is cal-\nculated on the basis of Elevation Angle Constant\n(EAC) method recommended by [48]. The general formulas\nof the EAC method are given in Equation 2 and Equation 3.\nHb =(H −Hd )/ε (2)\nε =\n\n\n\n∑sunrise\nsunset sin α\n12 for (S0 ≤12)\n∑sunrise\nsunset sin α\nday length for (S0 >12)\n(3)\nThe diffuse radiation value on the horizontal surface is\ncalculated on the basis of quadratic model recommended\nby [49]. The general formulas of the quadratic method are\ngiven in Equation 4.\nHd\nH =0.9885 −1.4276Kt +0.5679Kt 2 (4)\nThe direct radiation value on a sloped surface depends on\nthe permeability of the atmosphere and the direct radiation\nparameters on the horizontal surface. The permeability of the\nVOLUME 8, 2020 45435\nS. Kaynaket al.: GPU-Based Dynamic Solar Potential Estimation Tool Using 3D Plans\natmosphere can be calculated by Equation 5.\nRb =max(0, cos θ\ncos θZ\n)\n=max(0,sin δsin (ϕ−β)+cos δcos (ϕ−β)\nsin δsin ϕ+cos δcos ϕcos ω ) (5)\nThe diffusion radiation value on a sloped surface is calcu-\nlated on the basis of Liu-Jordan model [50]. The Liu-Jordan\nmodel is obtained by multiplying the skewness of the oblique\nsurface by the visual ﬁeld value (Rd) with the horizontal\nsurface diffusion radiation value :\nHtd =Hd ∗Rd (6)\nIn Liu-Jordan model, the Rd value is calculated using\nEquation 7.\nRd =(1 +cos β)\n2 (7)\nB. GPU BASED DSRM MODEL\nThe GPU-DSRM model has been developed to make the solar\npotential on 3D structures (facades, roofs) more precise and\nfaster which can be either in planning stage or completed at\nthe urban or individual scale. In some tools presented in the\nliterature, the users had to wait long periods of time (such\nas 6 to 11 hours) to analyze solar potential of 3D plans\nusing deﬁned scenarios [25], [26]. This waiting period is very\nannoying for a user, and it deters the use of valuable solar\nanalysis tools to obtain the best passive design parameters that\nprovide optimum utilization of solar potential.\nFIGURE 3. Flow diagram of GPU-DSRM algorithm.\nGPU-DSRM tool uses the ﬁnite element method to divide\nthe building facades into triangles at the desired scale for\nrealization of the high precision analysis. The subject is\nstudied before; however, the conventional computers with\nlimited computation power cause long delays when the input\nsize scales up [25]. In this context, the use of GPU has been\nAlgorithm 1CUDA Kernel Function for GPU-DSRM\nInput : triangleList, sunInfoList\nOutput: diffuseRad, directRad, globalRad\n1 tList ←triangleList\n2 while time <sunInfoListLength do\n3 sunNormal ←calcSunNormalize(azimuth,altitude)\n4 for x ←threatIdx.x +blockDim.x ∗blockIdx.x;\nx <tListLength; x ←x +blockDim.x ∗gridDim.x\ndo\n5 triangleNormal ←\ncalcNormal(tList[x].v0,tList[x].v1,tList[x].v2)\nseeSun ←sunSee(sunNormal,triangleNormal)\n6 if seeSun then\n7 intersected ←false\n8 midPoint ←tList[x].midPoint\n9 for\ny ←threatIdx.y +blockDim.y ∗blockIdx.y;\ny <tListLength;\ny ←y +blockDim.y ∗gridDim.y do\n10 if !intersected then\n11 intersected ←testIntersection(\nmidPoint,sunNormal,tList[y])\n12 end\n13 end\n14 diffuseRad[x] ←\ntList[x].diffuseList[time] +diffuseRad\n15 if intersected then\n16 globalRad[x] ←\nglobalRad[x] +diffuseRad[x]\n17 else\n18 directRad[x] ←\ndirectRad[x] +tList[x].directList[time]\n19 globalRad[x] ←globalRad[x] +\ndirectRad[x] +diffuseRad[x]\n20 end\n21 end\n22 end\n23 time ←time +1\n24 end\nfound as a solution to the problem, and the GPU-DSRM\nalgorithm has been developed to work on GPU architecture\n(see Figure 3).\nThe parallel algorithm requires two parameters. The ﬁrst\nparameter is triangle array. These triangles are generated\nfrom 3D plans of interested structures using ﬁnite element\nmethod. The second parameter is sun information array.\nThe sun information is used to calculate solar radiation\namount of surface and to analyze whether a surface is\nshaded.\nThe following operations are performed during the analysis\nof each triangle:\n• Using the back-face detection algorithm, it is determined\nwhether the triangle is exposed to the sun.\n45436 VOLUME 8, 2020\nS. Kaynaket al.: GPU-Based Dynamic Solar Potential Estimation Tool Using 3D Plans\n• Using the ray tracing algorithm, it is determined whether\nthe sunlit triangles are in the shadow of another triangle.\n• If the triangle is exposed to direct sunlight, direct and\ndiffusion solar radiation is calculated for the global solar\nradiation calculation.\n• If the triangle is not exposed to direct sunlight, the\ndiffusion solar radiation is calculated for the global solar\nradiation calculation.\nThe pseudo code of algorithm can be seen in Algorithm 1.\nThe serial version of the algorithm was coded using Visual\nStudio platform in C-Sharp programming language, aimed\nto run on classical multi-core CPU computers. When par-\nallelization study has started, the language and platform\nbecame problem since the CUDA architecture do not support\nC-Sharp language. While searching a solution, a research\nstudy called Hybridizer by Altimesh was came across that\ndevelops converter tools for Visual Studio applications, and\nthe research group was contacted for collaboration [51].\nHybridizer provides tools and libraries to generate source\ncode or binaries from C-Sharp applications optimized for\nmulti-core CPUs and GPUs. As a result, Hybridizer libraries\nare used while transferring some parts of our previous code to\nC++that will run on GPU. The recommendations obtained\nfrom similar work are followed carefully while porting the\napplication into GPU platform [27], [52].\nWhen algorithm is parallelized, both correctness and per-\nformance tests must be performed to get the same output\nin less time with high utilization. Especially proﬁling tools\nbecome more critical since they show idling parts of the\nparallel run, and allows ﬁne-tuning in the code. For this\nreason, the testing and optimization processes of parallel code\nare quite complex from those of serial programming.\nFIGURE 4. Parallel program activities and synchronization barriers.\nAt the left hand side of Figure 4, the input data are trans-\nferred from the host to the device, and this data is used\nthroughout the time periods to be analyzed. The input data\nformed at the CPU side for each of the requested sampling\ntime zones that affect the sensitivity of the analysis. Based on\nthe data transferred, operations are performed on the GPU\nfor the ﬁrst sampling time interval, and immediately after\nall these processes are ﬁnished, the threads are activated for\nthe next sampling time period. For a desired analysis time,\nthe operations are executed repeatedly and the resulting data\nis transferred from the device memory to the host memory.\nWhen proﬁle output is examined, the triangularization pro-\ncess takes 1% and triangle intersection tests correspond to\n99% of total execution time. Hence, the ﬁrst part is decided to\nrun on the CPU and the later part on the GPU (see Figure 4).\nThe data transfer from the CPU to the GPU and reverse\nmay take quite large fraction in total execution time, hence\nthe amount of data to transfer must be minimal. In this study,\nthe following items are transferred to GPU memory before\nparallel execution starts:\n• Coordinate information of triangles and calculated sun\nangle information for simulation time intervals.\n• Lists of the direct and diffusion radiation values of the\nwhole year for each triangle within the speciﬁed time\ninterval.\nThe input and output data take up nearly 140 MB of\nmemory in the GPU for the case studies presented in this\nwork.\nFIGURE 5. Sun seeing facades are divided into small triangular areas for\ncalculation.\nThe Möller-Trumbore ray-triangle intersection algorithm\nused for shading analysis and back-face detection algorithm\nis implemented in a kernel function and executed in par-\nallel [53]. The scenario consisting of 10 buildings with a\nsurface area of 2453 .64 m2 is divided into 5694 triangles with\nan area of 4 .3 m2 (see Figure 5). Based on this scenario,\nwith a half-hour sampling time resolution, the ray-triangle\nintersection algorithm corresponds to about 99 percent of\nthe execution time of the DSRM model. An improvement\nin the ray-triangle intersection algorithm will greatly affect\nthe DSRM model. Therefore, the ray-triangle intersection\nalgorithm was executed in parallel on the GPU (see Figure 4).\nThe CUDA architecture allows a programmer to address\nthe threads in x, y and z dimensions. In this work, the threads\nin x-dimension represent the triangles to be analyzed, and\nthreads in the y-dimension represent the triangles of all\nbuildings in the site in the GPU-DSRM model. The trian-\ngle to be analyzed is subjected to the intersection test in\nparallel manner with all other triangles. If any thread in\nx-dimension returns true in response to the intersection test,\nit is determined that the triangle is in shadow and does not\nreceive direct solar radiation. The results of solar radiation are\ncalculated according to these process outputs. An overview\nof the kernel function of the GPU-DSRM model is given\nin Algorithm 1.\nVOLUME 8, 2020 45437\nS. Kaynaket al.: GPU-Based Dynamic Solar Potential Estimation Tool Using 3D Plans\nEven though threads in x-dimension perform the same\noperations, they may not be able to ﬁnish their operations\nevenly. If a triangle in x-dimension intersects with one of\nthe triangles in the y-dimension, the thread terminates the\noperation immediately and passes to the next job. Idle threads\ntake the jobs in the queue. This procedure is repeated for the\ndesired sampling interval period.\nIn the GPU-DSRM algorithm, threads do not need to com-\nmunicate with each other, and the synchronization of threads\nis ensured by the barriers that are activated at certain intervals.\nThe barriers can be considered to cause inefﬁciency as a\ncommon thought, and they are detrimental when used on all\nthreads to meet the requirements of just a few threads [42].\nHowever, this is not the case in this application. To calcu-\nlate the next time interval, a common variable needs to be\nincreased. To be able to update this variable for the next time\nperiod, we need to make sure that all threads are complete\nwith barriers.\nDuring the test phase, the accuracy analysis was performed\nbefore the performance review and the CPU versus GPU\nbased results were compared for errors that might occur due\nto parallelism or ﬂoating point rounding differences. For this\npurpose, many test scenarios were created and the results\nwere found to be the same. The test scenarios were conducted\nwith different input parameters and comparative performance\nresults are given in detail in the next section. Table 1 shows\nhardware and software components used for computations\nthroughout the study.\nTABLE 1. Test Computer Hardware and Software Components Used\nDuring the Experiments.\nV. RESULT AND DISCUSSION\nA new settlement with 10 buildings in Yazlık region of\nSakarya is selected as testbed to validate the model and mea-\nsure its performance (see Figure 5). The layout of the build-\nings are 2 rows and 5 columns with the distances between\nthe rows and the columns are approximately 10 m and 15 m\nrespectively. The buildings have the same dimensions: 25 m\nheight, 17 m width and 23 m depth. The yellow triangles in the\nﬁgure represent the ones that receive direct sunlight, and the\ngray ones show not receiving. This image is obtained from\nthe GPU-DSRM algorithm for just speciﬁc time; e.g, it was\ncaptured for the January the 1st, at 16:30 when the sun is in the\nwest direction and it is about sunset. Based on the sampling\ninterval, this calculations are repeated several times even in\none day throughout the observation period.\nTest scenarios were created by using different triangle and\nsampling intervals, and then experiments were conducted to\ncompare the performance of the GPU-DSRM model.\nFIGURE 6. Comparison between CPU and GPU based implementation of\nDSRM algorithm: a) Execution time, b) Speedup.\nFigure 6.a shows execution time comparison between CPU\nversus GPU implementation for 1910, 3754 and 5694 triangle\ncounts and 1 hour sampling interval time for 31 days of\ndata. As it can be seen from the ﬁgure, signiﬁcant perfor-\nmance improvement has been achieved, and the execution\ntime dropped down from 213.46 s to 5.13 s. with a speedup\nvalue of 41.29. Figure 6.b shows speedup values, where it\ninitially increases with triangle count input linearly, and then\nbecomes almost steady due to hardware limits of the GPU\ncard is reached.\nTriangle count and sampling interval time for a same target\narea effect the resolution and the accuracy of the output. The\nmore triangle for the same surfaces makes the area smaller\nin the computations ends up higher precision. Similarly,\nthe shorter sampling interval allows the use of more current\nsolar beam angle for each triangle that increases the accuracy\nof the predictions. The goal of this research was to reduce\nthe execution time of the tool without losing precision and\naccuracy at the output. Hence, in the experiments, both trian-\ngle count and sampling interval time are changed to see their\nimpact over the execution time. Figure 7.a shows execution\ntime for CPU and Figure 7.b for GPU with respect to trian-\ngle count and sampling interval time. The tool is executed\n30 times according to different thread counts, and the average\nvalue is reported in the experiments.\nFIGURE 7. DSRM execution time for time interval 30, 60, 90, 120 minute\nversus triangle count 1910, 3754, 5694, a) CPU-DSRM, b) GPU-DSRM.\nDuring the development of the GPU-DSRM model, it is\nobserved that multiple triangle assignments to each thread\nincreases the average waiting time and irregularity of threads.\nConsidering the study model shown in Algorithm 1, it can\nbe said that the algorithm can be scaled depending on the\nhardware, and the average waiting times of the threads are\nminimized. Aside from concurrent execution in multiple\nthreads, some other improvements also employed in this new\nimplementation, some of them are itemized as follows:\n45438 VOLUME 8, 2020\nS. Kaynaket al.: GPU-Based Dynamic Solar Potential Estimation Tool Using 3D Plans\n• Since the execution time of the serial version is very\nlong, the results of the analysis for a desired time interval\ncould be obtained at the end of long periods. Therefore,\nthe radiation calculations for each triangle had to be\nperformed at each time interval and these calculations\nwere kept in a database. In the CPU-DSRM model,\nradiation calculations for any time interval could only\nbe achieved quickly in this way. Due to the fact that the\ncalculations made in the GPU are too short, and it is now\nunnecessary to keep the individual radiation values for\neach triangle separately. Instead, the average values of\nthe radiation data for each triangle are calculated, and\nthey kept in the memory rather than on the disk. In this\nway, the requested intermediate values can be retrieved\nin a very short time.\n• In GPU-DSRM, primarily all surfaces are divided into\ntriangles and all triangles are subjected to back-face\ndetection algorithm. Then, the sun exposed triangles are\nsubjected to the intersection test with all other triangles\nand the radiation calculations are made according to the\nresults of this test. If this algorithm was applied to the\nsurfaces ﬁrst and the triangles were split, then it would\nbe necessary to keep the information on which surface\neach triangle belongs to in GPU memory. This calcu-\nlation is easily accomplished by scalar multiplication of\nthe surface normal and the solar normal data. In this way,\na search process and extra GPU memory data transfer\nis eliminated. This results in both accuracy and perfor-\nmance improvement. Therefore, the back-face detection\nalgorithm is performed on a triangular scale on the\nGPU. Then, intersection testing and shading analysis are\nperformed. While the calculations in the CPU-DSRM\nmodel last for several hours, the GPU-DSRM model\nis completed in seconds and there is no need to keep\nthe temporal data generated in a database during the\ncalculations.\nAs the problem size (i.e. triangle count) increases,\nthe thread count also increases without affecting the exe-\ncution time of the application till the hardware limits are\nreached. In fact, it has been observed that if the number\nof threads increased too much, this causes a negative effect\non execution time. Therefore, it is necessary to take the\noptimum number of threads to meet the requirements and\nin order to massively exploit GPU capabilities [54]. As a\nresult of the analysis, 4096 threads are found suitable for this\napplication.\nIt is seen that different block-thread combinations in GPU\ndo not change the execution time when the total thread count\nis kept constant. For this reason, we primarily focused on the\ntotal number of threads and it is set always as 4096. Then,\nthe number of threads per block is set as 128.\nFurther experiments have also been conducted to see how\ntriangle count affects the execution time while sampling inter-\nval is kept constant, and how sampling interval time affect\nthe execution time while the triangle county kept constant.\nFigure 8.a and Figure 8.b show the effect of the number of\nFIGURE 8. The effects of triangle count and sampling interval time on\nexecution time: a) The triangle count is changing while the sampling\ninterval time is constant, b) The sampling interval is changing and while\nthe triangle count is constant.\ntriangles and the sampling interval on the execution time,\nrespectively.\nAs shown in Figure 8.a the whole year-round analysis\nprocess takes an average of 46 .86 second with the triangles\nhaving a surface area of 2 .71 m2 each (makes 9024 trian-\ngles total) with constant 30-min time intervals. When the\nsurface area of the triangles is increased to 4 .3 m2 (makes\n5694 triangles), the execution time reduces to 27 .38 second.\nSome more experiments are conducted in a similar way with\nthe surface area of 12 .84, 10 .35, 6 .53 and 6 .26 m2 (1919,\n2370, 3754 and 3920 triangles respectively), it is observed\nthat the execution time decreases linearly with the number of\ntriangles when the sampling interval time is constant.\nAnother parameter that affects the accuracy and execution\ntime of the tool is the sampling interval. Sampling interval\ntells how often the calculations should be done considering\nchanging sun position. In order to see the effect of sampling\ninterval on execution time, initially sampling interval with\ntriangles having an area of 2.71 m2 is set to 30 min. Figure 8.b\nshows when the sampling interval is taken for 30 minutes,\nthe radiation analysis of the whole year takes place at an\naverage of 46.863 seconds. It is obvious that the execution\ntime decreases as sampling interval increases, and after a\ncertain point of sampling interval increase, there is not much\nreduction in execution time because of the hardware limits of\nthe GPU card.\nAs a result, the number of triangles and the sampling period\naffect the execution time, precision and accuracy. With the\nearlier version of the serial DSRM model run for annual\nanalysis on the CPU, it took about 11 hours to complete the\njob. When the serial version of the algorithm was improved\nby eliminating the disk accesses, the execution time was\nreduced to 6 hours. Although this is a successful performance\nimprovement, it is still far from an acceptable value for a\ntool that is supposed to work interactively on the design ﬁles.\nHowever, in the GPU based implementation, the same job\ntakes approximately 47 seconds for the same input parame-\nters. In this example, the working area is divided into 2.71 m2\ntriangles and 30-minute time slices are taken for sampling\ninterval time for both runs. As it can be seen from this com-\nparative study, the GPU-DSRM model runs about 842 times\nfaster than the earlier DSRM model for the same parameters.\nIt is expected that this acceleration will be much better when\nVOLUME 8, 2020 45439\nS. Kaynaket al.: GPU-Based Dynamic Solar Potential Estimation Tool Using 3D Plans\nGPU cards are used with more cores. Therefore, the results\nobtained in this study will lead to new researches for different\nGPU cards.\nThe GPU-DSRM has been compared with other software\ntools such as ArcGIS and ‘‘skymapping’’ in terms of perfor-\nmance, easiness of usage, input data type and precision [26].\nThe common characteristics of these tools are that they all\nbelong to geometric tools and neglect the reﬂected radiation.\nAlthough ArcGIS is used for mapping purposes in general,\nit is also a widely preferred software tool that performs solar\npotential analysis. However, ArcGIS cannot read 3D data as\ninput [55]; hence, the input image must be annotated with\nauxiliary data by the user to compensate for missing infor-\nmation before performing the solar analysis. Nevertheless,\nthe annotated input of structures does not provide as much\ninformation as 3D plans have. The GPU-DSRM tool accepts\n3D plans and performs radiation analysis using more com-\nprehensive knowledge such as width, length, height, slope,\netc. about the buildings under consideration. As a result,\nGPU-DSRM tool produces higher accuracy and resolution\nresults in solar estimations.\nOn the other end, the skymapping tool performs radiation\nanalysis using only the rooftops of buildings extracted from\n3D plans. For example, the performance of our early DSRM\nmodel was compared with the skymapping tool using the\nsame test bed in [26]. The GPU-DSRM developed in this\nstudy is over performed the skymapping tool by employing\nnovel approaches in the algorithm. Since both applications\nused the same test bed in their studies, comparative execution\ntimes can be given as follows: the skymapping tool completed\nthe task using 69726 triangles in approximately 3 hours, while\nthe GPU-DSRM tool did the same task in approximately\n6 minutes. As it can be seen from the results, the performance\nof the DSRM algorithm is greatly improved by implementing\nthe algorithm in parallel using the GPU hardware with con-\nsiderably less cost.\nLimitations: The tool developed in this study has the fol-\nlowing limitations when compared with other tools in the\nliterature:\n• In this study, the analysis covers only solar radiation\nfalling on the exterior of a building.\n• The reﬂected radiation is neglected because it generally\nconstitutes only a small proportion of total radiation.\n• The software tool is implemented using CUDA archi-\ntecture because it is a widely used model, hence the tool\nruns only on NVIDIA Graphics cards.\n• The input ﬁles can be only in CityGML format because\nit is a standard for 3D representation of structures.\n• Covering material types over the facades was not\nconsidered in this research because our goal was to\nﬁnd the maximum solar potential that a building may\nreceive.\nVI. CONCLUSION AND FUTURE WORK\nUtilizing solar energy at buildings saves energy and reduce\nthe environmental pollution, hence the solar analysis is an\nimportant task to explore the potential before or after the\nconstruction. On the other hand, the demand for high preci-\nsion and accurate predictions enforce algorithm developers\ninvolve more parameters into their algorithm which causes\nlonger time to produce the expected results. As a result,\nthe existing solar analysis tools either produce limited out-\nputs or they are not practical to use due to long running\ntimes.\nIn this paper, a new geometric-based solar radiation esti-\nmation tool (GPU-DSRM) development study is presented.\nThe tool analyzes buildings holistically using 3D building\nplans in CityGML format. It also takes into account dynamic\nshadow analysis and can be used anywhere in the world to\nperform solar analysis. It is observed that it can take hours\nor even days to complete a solar analysis task for sites with\nmultiple buildings when used similar tools in the literature\n[8], [25], [26]. The long execution time had a deterrent effect\non the examination of alternative designs. Hence, the software\ntool has been developed using up-to-date parallel GPU tech-\nnologies which provides parallelism at the data level, ease of\nuse and price-performance advantage.\nThe algorithm has been implemented using NVIDIA\nGTX950M GPU hardware and its performance measured\nand compared against existing tools in the literature such\nas ‘skymapping’ and ‘DSRM’. The measured speedups are\naverage of 30, 45 and 842 fold against the skymapping,\nimproved-DSRM and initial version of DSRM respectively.\nIt can be concluded that high resolution solar potential\nanalysis in 3D plans can be done in an acceptable time period\nby using better GPU hardware which have more cores or by\nusing several GPU servers that contain multiple GPU boards.\nIn this way, architects and urban planners will be able to\nexamine alternative home designs in terms of solar potential\nin shorter time.\nIn future studies, it is aimed that users will be able to\nupload 3D building plans to the system with a web interface\nand make all calculations on a remote server located in a\ncloud. In this way, users who do not have high performance\nhardware will be able to use this software remotely. The\ncalculations can be further accelerated by installing multiple\nGPUs on the server(s) in the cloud.\nREFERENCES\n[1] B. Ozarisoy and H. Altan, ‘‘Low energy design strategies for retroﬁtting\nexisting residential buildings in cyprus,’’ Proc. Inst. Civil Engineers Eng.\nSustainability, vol. 172, pp. 241–255, Jul. 2018.\n[2] B. Ozarisoy and H. Elsharkawy, ‘‘Assessing overheating risk and\nthermal comfort in state-of-the-art prototype houses that combat\nexacerbated climate change in UK,’’ Energy Buildings , vol. 187,\npp. 201–217, Mar. 2019. [Online]. Available: http://www.sciencedirect.\ncom/science/article/pii/S0378778818331839\n[3] A. S. B. M. Shah, H. Yokoyama, and N. Kakimoto, ‘‘High-precision fore-\ncasting model of solar irradiance based on grid point value data analysis\nfor an efﬁcient photovoltaic system,’’ IEEE Trans. Sustain. Energy , vol. 6,\nno. 2, pp. 474–481, Apr. 2015.\n[4] A. Shakya, S. Michael, C. Saunders, D. Armstrong, P. Pandey, S. Chalise,\nand R. Tonkoski, ‘‘Using Markov switching model for solar irradiance\nforecasting in remote microgrids,’’ Proc. IEEE Energy Convers. Congr.\nExpo. (ECCE), Sep. 2017, vol. 8, no. 3, pp. 895–905.\n45440 VOLUME 8, 2020\nS. Kaynaket al.: GPU-Based Dynamic Solar Potential Estimation Tool Using 3D Plans\n[5] A. Bracale, G. Carpinelli, and P. De Falco, ‘‘A probabilistic competitive\nensemble method for short-term photovoltaic power forecasting,’’ IEEE\nTrans. Sustain. Energy , vol. 8, no. 2, pp. 551–560, Apr. 2017. [Online].\nAvailable: http://ieeexplore.ieee.org/document/7570246/\n[6] Y . Li, D. Ding, C. Liu, and C. Wang, ‘‘A pixel-based approach\nto estimation of solar energy potential on building roofs,’’ Energy\nBuildings, vol. 129, pp. 563–573, Oct. 2016. [Online]. Available:\nhttp://linkinghub.elsevier.com/retrieve/pii/S0378778816307101\n[7] Y . Li and C. Liu, ‘‘Estimating solar energy potentials on pitched roofs,’’\nEnergy Buildings, vol. 139, pp. 101–107, Mar. 2017.\n[8] M. Bayrakci, K. Calvert, and J. Brownson, ‘‘An automated model for\nrooftop PV systems assessment in Arcgis using lidar,’’ AIMS Energy, vol. 3,\npp. 401–420, Sep. 2015.\n[9] A. Asrari, T. X. Wu, and B. Ramos, ‘‘A hybrid algorithm for short-\nterm solar power prediction—Sunshine state case study,’’ IEEE Trans.\nSustain. Energy, vol. 8, no. 2, pp. 582–591, Apr. 2017. [Online]. Available:\nhttp://ieeexplore.ieee.org/document/7577881/\n[10] R. H. Inman, H. T. C. Pedro, and C. F. M. Coimbra, ‘‘Solar fore-\ncasting methods for renewable energy integration,’’ Progr. Energy Com-\nbustion Sci. , vol. 39, no. 6, pp. 535–576, Dec. 2013, doi: 10.1016/\nj.pecs.2013.06.002.\n[11] M. Boulifa, A. Adane, A. Mefti, S. Ameur, and Z. Ameur, ‘‘The\nsolar radiation evaluation by satellite images processing,’’ in Proc. Int.\nConf. Renew. Energies Power Qual. (ICREPQ) , 2010, pp. 1–4. [Online].\nAvailable: http://www.icrepq.com/icrepq’10/324-Boulifa.pdf\n[12] A. W. Azhari, K. Sopian, A. Zaharim, and M. Al Ghoul, ‘‘A new\napproach for predicting solar radiation in tropical environment using satel-\nlite images-case study of Malaysia,’’ WSEAS Trans. Environ. Develop. ,\nvol. 4, no. 4, pp. 373–378, 2008.\n[13] A. Olpenda, K. Stereńczak, and K. Be ¸dkowski, ‘‘Modeling solar radiation\nin the forest using remote sensing data: A review of approaches and\nopportunities,’’ Remote Sens. , vol. 10, no. 5, p. 694, May 2018. [Online].\nAvailable: http://www.mdpi.com/2072-4292/10/5/694\n[14] N. Lukac, D. Zlaus, S. Seme, B. Zalik, and G. Stumberger, ‘‘Rating\nof roofs’ surfaces regarding their solar potential and suitability for PV\nsystems, based on LiDAR data,’’ Appl. Energy , vol. 102, pp. 803–812,\nFeb. 2013.\n[15] M. Brumen, N. Lukac, and B. Zalik, ‘‘Gis application for solar potential\nestimation on buildings roofs,’’ Int. Acad., Res., Ind. Assoc., Chamonix,\nFrance, Tech. Rep., 2014.\n[16] C. Carl, ‘‘Calculating solar photovoltaic potential on residential rooftops\nin Kailua Kona, Hawaii,’’ Ph.D. dissertation, USC Graduate School,\nUniv. Southern California, Angeles, CA, USA, 2014. [Online]. Available:\nhttps://search.proquest.com/docview/1560671278?accountid=13654\n[17] M. C. Brito, N. Gomes, T. Santos, and J. A. Tenedório, ‘‘Photovoltaic\npotential in a lisbon suburb using LiDAR data,’’ Sol. Energy, vol. 86, no. 1,\npp. 283–288, Jan. 2012.\n[18] T. Santos, N. Gomes, S. Freire, M. C. Brito, L. Santos, and J. A. Tenedório,\n‘‘Applications of solar mapping in the urban environment,’’ Appl. Geogra-\nphy, vol. 51, pp. 48–57, Jul. 2014.\n[19] C. D. Brandt, ‘‘Rooftop solar capacity modeling using GIS within\nthe city of Stillwater, MN,’’ Ph.D. dissertation, Univ. Wisconsin-\nRiver Falls, River Falls, WI, USA, 2014. [Online]. Available:\nhttp://digital.library.wisc.edu/1793/68317\n[20] A. Martínez-Rubio, F. Sanz-Adan, J. Santamaría-Peña, and A. Martínez,\n‘‘Evaluating solar irradiance over facades in high building cities, based on\nLiDAR technology,’’Appl. Energy, vol. 183, pp. 133–147, Dec. 2016.\n[21] A. Jochem, B. Höﬂe, and M. Rutzinger, ‘‘Extraction of vertical walls from\nmobile laser scanning data for solar potential assessment,’’ Remote Sens. ,\nvol. 3, no. 4, pp. 650–667, Mar. 2011.\n[22] P. Redweik, C. Catita, and M. Brito, ‘‘Solar energy potential on roofs\nand facades in an urban landscape,’’ Sol. Energy , vol. 97, pp. 332–341,\nNov. 2013.\n[23] P. Huang, M. Cheng, Y . Chen, D. Zai, C. Wang, and J. Li, ‘‘Solar potential\nanalysis method using terrestrial laser scanning point clouds,’’ IEEE J. Sel.\nTopics Appl. Earth Observ. Remote Sens. , vol. 10, no. 3, pp. 1221–1233,\nMar. 2017.\n[24] C. Catita, P. Redweik, J. Pereira, and M. C. Brito, ‘‘Extending solar poten-\ntial analysis in buildings to vertical facades,’’ Comput. Geosci. , vol. 66,\npp. 1–12, May 2014.\n[25] S. Kaynak, B. Kaynak, and A. Özmen, ‘‘A software tool development\nstudy for solar energy potential analysis,’’ Energy Buildings , vol. 162,\npp. 134–143, Mar. 2018.\n[26] M. U. Yousuf and S. M. Shere, ‘‘A novel computational methodology\nto estimate solar energy on building rooftops,’’ Environ. Progr. Sustain.\nEnergy, Jan. 2020. [Online]. Available: https://aiche.onlinelibrary.wiley.\ncom/doi/abs/10.1002/ep.13385, doi: 10.1002/ep.13385.\n[27] J. P. Silva, J. Hagopian, M. Burdiat, E. Dufrechou, M. Pedemonte,\nA. Gutiérrez, G. Cazes, and P. Ezzatti, ‘‘Another step to the full GPU\nimplementation of the weather research and forecasting model,’’ J. Super-\ncomput., vol. 70, no. 2, pp. 746–755, Apr. 2014. [Online]. Available:\nhttp://link.springer.com/10.1007/s11227-014-1193-y\n[28] R. M. Gualan-Saavedra, L. D. Solano-Quinde, and B. M. Bode, ‘‘GPU\nacceleration of the horizontal diffusion method in the weather research\nand forecasting (WRF) model,’’ in Proc. Asia–Paciﬁc Conf. Com-\nput. Aided Syst. Eng. , Jul. 2015, pp. 284–289. [Online]. Available:\nhttp://ieeexplore.ieee.org/document/7287033/\n[29] Y . Huang, Z. Chen, B. Wu, L. Chen, W. Mao, F. Zhao, J. Wu, J. Wu,\nand B. Yu, ‘‘Estimating roof solar energy potential in the downtown area\nusing a GPU-accelerated solar radiation model and airborne LiDAR data,’’\nRemote Sens., vol. 7, no. 12, pp. 17212–17233, Dec. 2015.\n[30] J. Salvador, O. Sofía, F. Orte, E. D. Santos, H. Oyama, T. Nagahama,\nA. Mizuno, and R. Uribe Paredes, ‘‘Performance improvements of an\natmospheric radiative transfer model on GPU-based platform using\nCUDA,’’ in Proc. 12th Congreso Argentino Ciencias Comput. , Jun. 2015.\n[31] K. Thouti and S. Sathe, ‘‘Comparison of Openmp & Opencl parallel\nprocessing technologies,’’Int. J. Adv. Comput. Sci. Appl. , vol. 3, pp. 56–61,\nNov. 2012.\n[32] C. A. Lee, S. D. Gasster, A. Plaza, C.-I. Chang, and B. Huang,\n‘‘Recent developments in high performance computing for remote sensing:\nA review,’’ IEEE J. Sel. Topics Appl. Earth Observ. Remote Sens. , vol. 4,\nno. 3, pp. 508–527, Sep. 2011.\n[33] X. Hu, X. Li, and Y . Zhang, ‘‘Fast ﬁltering of LiDAR point cloud in\nurban areas based on scan line segmentation and GPU acceleration,’’ IEEE\nGeosci. Remote Sens. Lett. , vol. 10, no. 2, pp. 308–312, Mar. 2013.\n[34] S. Pečnik and B. Žalik, ‘‘Real-time visualization using GPU-accelerated\nﬁltering of lidar data,’’ World Acad. Sci., Eng. Technol., Int. J. Comput.,\nElect., Automat., Control Inf. Eng. , vol. 8, no. 12, pp. 2108–2112, 2014.\n[35] R. Sugumaran, O. Dossay, and P. Gray, ‘‘GPU-based cloud performance\nfor LiDAR data processing,’’ in Proc. Int. Conf. Comput. Geospatial Res.\nAppl., May 2011, p. 48.\n[36] J. Li, Y . Xu, H. Macrander, L. Atkinson, T. Thomas, and M. A. Lopez,\n‘‘GPU-based lightweight parallel processing toolset for LiDAR data for\nterrain analysis,’’ Environ. Model. Softw., vol. 117, pp. 55–68, Jul. 2019.\n[37] S. Tabik, A. Villegas, E. L. Zapata, and L. F. Romero, ‘‘A fast GIS-tool\nto compute the maximum solar energy on very large terrains,’’ Procedia\nComput. Sci., vol. 9, pp. 364–372, 2012, doi: 10.1016/j.procs.2012.04.039.\n[38] Z. Yanjie, Y . Guoqing, and D. Yanqing, ‘‘Parallel computation of ground\nradiation simulation based on GPU,’’ Procedia Comput. Sci. , vol. 107,\npp. 9–14, 2017, doi: 10.1016/j.procs.2017.03.049.\n[39] N. Lukač and B. Žalik, ‘‘GPU-based roofs’ solar potential estimation using\nLiDAR data,’’ Comput. Geosci., vol. 52, pp. 34–41, Mar. 2013.\n[40] T. V . Russkova, ‘‘Monte Carlo simulation of the solar radiation transfer in a\ncloudy atmosphere with the use of graphic processor and NVIDIA CUDA\ntechnology,’’Atmos. Ocean. Opt. , vol. 31, no. 2, pp. 119–130, Apr. 2018.\n[41] M. A. Rahman and R. C. Muniyandi, ‘‘Review of GPU implementation to\nprocess of RNA sequence on cancer,’’ Informat. Med. Unlocked , vol. 10,\npp. 17–26, 2018, doi: 10.1016/j.imu.2017.10.008.\n[42] S. Che, M. Boyer, J. Meng, D. Tarjan, J. W. Sheaffer, and K. Skadron,\n‘‘A performance study of general-purpose applications on graphics pro-\ncessors using CUDA,’’ J. Parallel Distrib. Comput. , vol. 68, no. 10,\npp. 1370–1380, Oct. 2008.\n[43] M. Gebremedhin, A. H. Moghadam, P. Fritzson, and K. Stavåker,\n‘‘A data-parallel algorithmic modelica extension for efﬁcient execu-\ntion on multi-core platforms,’’ in Proc. 9th Int. MODELICA Conf. ,\nMunich, Germany Sep./Nov. 2012, pp. 393–404. [Online]. Available:\nhttp://www.ep.liu.se/ecp/article.asp?issue=076%26article=41\n[44] J. A. Dufﬁe and W. A. Beckman, Solar Engineering of Thermal Processes .\nHoboken, NJ, USA: Wiley, 2013.\n[45] A. Angstrom, ‘‘Solar and terrestrial radiation,’’ Quart. J. Roy. Meteorol.\nSoc., vol. 50, pp. 121–126, Apr. 1924.\n[46] J. Prescot, ‘‘Evaporation from a water surface in relation to solar radiation,’’\nTrans. Roy. Soc. South Aust. , vol. 64, pp. 114–118, 1940.\n[47] B. Delgado, M. Paredes, and M. Martínez, ‘‘Software application for\ncalculating solar radiation and equivalent evaporation in mobile devices,’’\nAgricult. Water Manage., vol. 151, pp. 30–36, Mar. 2015.\nVOLUME 8, 2020 45441\nS. Kaynaket al.: GPU-Based Dynamic Solar Potential Estimation Tool Using 3D Plans\n[48] C. S. Solanki and C. S. Sangani, ‘‘Estimation of monthly averaged direct\nnormal solar radiation using elevation angle for any location,’’ Sol. Energy\nMater. Sol. Cells, vol. 92, no. 1, pp. 38–44, Jan. 2008. [Online]. Available:\nhttp://www.sciencedirect.com/science/article/pii/S0927024807003121\n[49] S. Tarhan and A. Sari, ‘‘Model selection for global and diffuse radiation\nover the central black sea (CBS) region of turkey,’’ Energy Convers.\nManage., vol. 46, no. 4, pp. 605–613, Mar. 2005.\n[50] B. Liu and R. Jordan, ‘‘Daily insolation on surfaces tilted towards equator,’’\nASHRAE Trans., vol. 10, Oct. 1962.\n[51] Altimesh. (2017). Hybridizer. Accessed: Apr. 10, 2019. [Online].\nAvailable: http://www.altimesh.com/\n[52] J. Delgado, ‘‘A case study on porting scientiﬁc applications to\nGPU/CUDA,’’J. Comput. Interdiscipl. Sci. , vol. 2, no. 1, pp. 3–11, 2011.\n[53] T. Möller and B. Trumbore, ‘‘Fast, minimum storage ray/triangle inter-\nsection,’’ in Proc. ACM SIGGRAPH Courses , 2005, p. 7-es, doi: 10.1145/\n1198555.1198746.\n[54] M. Chiesi, L. Vanzolini, E. Franchi Scarselli, and R. Guerrieri, ‘‘Accurate\noptical model for design and analysis of solar ﬁelds based on heteroge-\nneous multicore systems,’’ Renew. Energy, vol. 55, pp. 241–251, Jul. 2013.\n[55] A. Chow, A. Fung, and S. Li, ‘‘GIS modeling of solar neighborhood\npotential at a ﬁne spatiotemporal resolution,’’ Buildings, vol. 4, no. 2,\npp. 195–206, May 2014.\nSÜMEYYE KAYNAK received the B.S., M.S.,\nand Ph.D. degrees in computer engineering from\nSakarya University, Sakarya, Turkey, in 2012,\n2014, and 2019, respectively.\nSince 2012, she has been a Research Assistant\nwith the Department of Computer Engineering,\nSakarya University. Her research interests include\nenergy, software system development, blockchain,\nand artiﬁcial intelligence.\nBARAN KAYNAK received the B.S. and M.S.\ndegrees in industrial engineering from Sakarya\nUniversity, Sakarya, Turkey, in 2011 and 2013,\nrespectively, where he is currently pursuing the\nPh.D. degree in industrial engineering.\nHe joined the Computer Research and Appli-\ncation Center, Sakarya University, in 2011. His\ncurrent research interests include software sys-\ntem development, cloud manufacturing, and\nblockchain.\nAHMET ÖZMEN received the B.S. degree in\nelectronics and communication engineering from\nthe Department of Istanbul Technical University,\nIstanbul, Turkey, in 1987, and the M.S. and Ph.D.\ndegrees from the Electrical Engineering Depart-\nment, University of Kentucky, Lexington, KY ,\nUSA, in 1996 and 2000, respectively. He is cur-\nrently with the Department of Computer Engineer-\ning, Sakarya University. His main research activity\nis related to data analysis and software system\ndevelopment.\n45442 VOLUME 8, 2020"
}