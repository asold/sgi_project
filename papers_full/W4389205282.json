{
  "title": "Zero-shot interpretable phenotyping of postpartum hemorrhage using large language models",
  "url": "https://openalex.org/W4389205282",
  "year": 2023,
  "authors": [
    {
      "id": "https://openalex.org/A2889180838",
      "name": "Emily Alsentzer",
      "affiliations": [
        "Brigham and Women's Hospital"
      ]
    },
    {
      "id": "https://openalex.org/A2565753041",
      "name": "Matthew J. Rasmussen",
      "affiliations": [
        "Brigham and Women's Hospital"
      ]
    },
    {
      "id": "https://openalex.org/A2531894670",
      "name": "Romy Fontoura",
      "affiliations": [
        "Brigham and Women's Hospital"
      ]
    },
    {
      "id": "https://openalex.org/A4378990179",
      "name": "Alexis L. Cull",
      "affiliations": [
        "Brigham and Women's Hospital"
      ]
    },
    {
      "id": "https://openalex.org/A4226755506",
      "name": "Brett Beaulieu-Jones",
      "affiliations": [
        "University of Chicago"
      ]
    },
    {
      "id": "https://openalex.org/A2099799017",
      "name": "Kathryn J Gray",
      "affiliations": [
        "Massachusetts General Hospital",
        "Brigham and Women's Hospital"
      ]
    },
    {
      "id": "https://openalex.org/A2116978417",
      "name": "David W Bates",
      "affiliations": [
        "Harvard University",
        "Brigham and Women's Hospital"
      ]
    },
    {
      "id": "https://openalex.org/A1354848730",
      "name": "Vesela P. Kovacheva",
      "affiliations": [
        "Brigham and Women's Hospital"
      ]
    },
    {
      "id": "https://openalex.org/A2889180838",
      "name": "Emily Alsentzer",
      "affiliations": []
    },
    {
      "id": "https://openalex.org/A2565753041",
      "name": "Matthew J. Rasmussen",
      "affiliations": [
        "Brigham and Women's Hospital"
      ]
    },
    {
      "id": "https://openalex.org/A2531894670",
      "name": "Romy Fontoura",
      "affiliations": [
        "Brigham and Women's Hospital"
      ]
    },
    {
      "id": "https://openalex.org/A4378990179",
      "name": "Alexis L. Cull",
      "affiliations": [
        "Brigham and Women's Hospital"
      ]
    },
    {
      "id": "https://openalex.org/A4226755506",
      "name": "Brett Beaulieu-Jones",
      "affiliations": [
        "University of Chicago"
      ]
    },
    {
      "id": "https://openalex.org/A2099799017",
      "name": "Kathryn J Gray",
      "affiliations": [
        "Brigham and Women's Hospital",
        "Massachusetts General Hospital"
      ]
    },
    {
      "id": "https://openalex.org/A2116978417",
      "name": "David W Bates",
      "affiliations": [
        "Harvard University"
      ]
    },
    {
      "id": "https://openalex.org/A1354848730",
      "name": "Vesela P. Kovacheva",
      "affiliations": [
        "Brigham and Women's Hospital"
      ]
    }
  ],
  "references": [
    "https://openalex.org/W2105637130",
    "https://openalex.org/W4318025694",
    "https://openalex.org/W3149192496",
    "https://openalex.org/W2131668595",
    "https://openalex.org/W1969208427",
    "https://openalex.org/W2799271499",
    "https://openalex.org/W3135072344",
    "https://openalex.org/W2317648909",
    "https://openalex.org/W2138162199",
    "https://openalex.org/W2808129629",
    "https://openalex.org/W2883657435",
    "https://openalex.org/W2593739814",
    "https://openalex.org/W1995972830",
    "https://openalex.org/W4309650827",
    "https://openalex.org/W2614771905",
    "https://openalex.org/W2789244308",
    "https://openalex.org/W6778883912",
    "https://openalex.org/W138083078",
    "https://openalex.org/W4226278401",
    "https://openalex.org/W6847076894",
    "https://openalex.org/W4385573087",
    "https://openalex.org/W4389520444",
    "https://openalex.org/W2786382895",
    "https://openalex.org/W1504813440",
    "https://openalex.org/W4311897989",
    "https://openalex.org/W3127014827",
    "https://openalex.org/W4250116679",
    "https://openalex.org/W3009514415",
    "https://openalex.org/W4224266443",
    "https://openalex.org/W2057529206",
    "https://openalex.org/W2989208149",
    "https://openalex.org/W4221150520",
    "https://openalex.org/W2529846601",
    "https://openalex.org/W4296413502"
  ],
  "abstract": null,
  "full_text": "ARTICLE OPEN\nZero-shot interpretable phenotyping of postpartum\nhemorrhage using large language models\nEmily Alsentzer 1, Matthew J. Rasmussen2, Romy Fontoura2, Alexis L. Cull2, Brett Beaulieu-Jones3, Kathryn J. Gray 4,5,\nDavid W. Bates 1,6 and Vesela P . Kovacheva2 ✉\nMany areas of medicine would beneﬁt from deeper, more accurate phenotyping, but there are limited approaches for phenotyping\nusing clinical notes without substantial annotated data. Large language models (LLMs) have demonstrated immense potential to\nadapt to novel tasks with no additional training by specifying task-speciﬁc instructions. Here we report the performance of a\npublicly available LLM, Flan-T5, in phenotyping patients with postpartum hemorrhage (PPH) using discharge notes from electronic\nhealth records (n = 271,081). The language model achieves strong performance in extracting 24 granular concepts associated with\nPPH. Identifying these granular concepts accurately allows the development of interpretable, complex phenotypes and subtypes.\nThe Flan-T5 model achieves highﬁdelity in phenotyping PPH (positive predictive value of 0.95), identifying 47% more patients with\nthis complication compared to the current standard of using claims codes. This LLM pipeline can be used reliably for subtyping PPH\nand outperforms a claims-based approach on the three most common PPH subtypes associated with uterine atony, abnormal\nplacentation, and obstetric trauma. The advantage of this approach to subtyping is its interpretability, as each concept contributing\nto the subtype determination can be evaluated. Moreover, as deﬁnitions may change over time due to new guidelines, using\ngranular concepts to create complex phenotypes enables prompt and efﬁcient updating of the algorithm. Using this language\nmodelling approach enables rapid phenotyping without the need for any manually annotated training data across multiple clinical\nuse cases.\nnpj Digital Medicine          (2023) 6:212 ; https://doi.org/10.1038/s41746-023-00957-x\nINTRODUCTION\nRobust phenotyping is essential to multiple clinical and research\nworkﬂows, such as clinical diagnosis\n1, novel phenotype discovery2,\nclinical trial screening 3, comparative effectiveness research 4,\nquality improvement 5, and genome-wide and phenome-wide\nassociation studies 6. The wide adoption of electronic health\nrecords (EHR) has enabled the development of digital phenotyp-\ning approaches, which seek to leverage the large amounts of\nelectronic patient data, stored as structured data (e.g. diagnosis\ncodes, medications, and laboratory results) and unstructured\nclinical notes, to characterize a patient ’s clinical presentation.\nCurrently, many phenotyping approaches utilize diagnosis codes\nsuch as the International Classiﬁcation of Diseases (ICD)\n7 or a\ncombination of rules based on structured data8,9. While structured\ndata is readily available and easily computable, structured data\noften reﬂect billing processes rather than disease course and do\nnot capture the nuanced clinical narrative found in the EHR\nnotes\n10,11.\nNatural language processing (NLP) methods have increas-\ningly been used to enable more precise, multi-modal pheno-\ntyping by automating data extraction from unstructured clinical\nnotes. Most approaches are rule-based, relying on keywords12,\nregular expressions 13,a n d / o re x i s t i n gN L Pt o o l st h a te x t r a c t\nmedical ontology concepts14,15 to identify relevant information\nfrom notes. These approaches pr oduce interpretable pheno-\ntypes, but often have low recall due to the use of hand-crafted\nfeatures. In contrast, supervi sed machine learning based\nphenotyping approaches allow f or learning useful features\nand may produce less brittle models\n11,16,17. However, super-\nvised machine learning models have been dif ﬁcult to imple-\nment because they require substantial clinician-annotated data\nfor training robust models.\nRecent advances in training large language models (LLMs)\noffer an opportunity to develop generalizable phenotypes\nwithout substantial annotated data. A common paradigm in\nNLP has been to ﬁrst pretrain a model via a self-supervised\nlearning objective on large amounts of unlabeled text and then\nﬁne-tune the model on a speciﬁc downstream task of interest\nusing labeled training data. However, more recent work has\ndemonstrated the ability of LLMs to adapt to new tasks without\nany gradient updates or ﬁne-tuning, simply by specifying task\ninstructions via text interaction with the model\n18– 22.F o r\nexample, Agrawal et al. found that GPT-3 can perform few-shot\ninformation extraction on several clinical tasks, including\nacronym disambiguation, co-reference resolution, and medica-\ntion extraction 23. Contemporaneous to this work, McInerney\net al. show that Flan-T5 can perform feature extraction from\nclinical notes to enable training of risk prediction models24.T h e\nzero- and few-shot capabilities of these models (i.e., their ability\nto generalize to novel tasks with zero or limited examples) can\nenable rapid development of models for diverse clinical\napplications where labeled data is sparse or expensive to\nacquire. The zero shot capabilities of LLMs provide an\nopportunity to perform phenotyping of complex clinical condi-\ntions, such as postpartum hemorrhage (PPH), using clinical notes.\nPPH is the leading cause of severe maternal morbidity and\n1Division of General Internal Medicine and Primary Care, Brigham and Women’s Hospital, Boston, MA, USA.2Department of Anesthesiology, Perioperative and Pain Medicine,\nBrigham and Women’s Hospital, Boston, MA, USA.3Section of Biomedical Data Science, Department of Medicine, University of Chicago, Chicago, IL, USA.4Center for Genomic\nMedicine, Massachusetts General Hospital, Boston, MA, USA.5Division of Maternal-Fetal Medicine, Brigham and Women’s Hospital, Boston, MA, USA.6Department of Health Care\nPolicy and Management, Harvard T. H. Chan School of Public Health, Boston, MA, USA.✉email: vkovacheva@bwh.harvard.edu\nwww.nature.com/npjdigitalmed\nPublished in partnership with Seoul National University Bundang Hospital\n1234567890():,;\nmortality. Globally, PPH complicates 2-3% of all pregnancies and\naccounts for 140,000 maternal deaths annually 25. The current\nPPH deﬁnition is based on the documentation of estimated\nblood loss of at least 1000 mL following delivery 26.P P Hi s\ntypically identi ﬁed in large epidemiological studies using\ndiagnosis codes7,27; however, such codes have limited accuracy7.\nMore comprehensive PPH phenotype de ﬁnitions have been\ndeveloped8, but there is limited work in incorporating clinical\nnotes into PPH phenotype de ﬁnitions28. Furthermore, several\nsubtypes of PPH exist, each of which is associated with different\netiologies, management, and outcomes. Clinical guidelines\nrecommend prompt identiﬁcation of the PPH subtype in order\nto initiate appropriate interventions\n26. However, to the best of\nour knowledge, there are no digital phenotyping algorithms for\nPPH subtypes.\nThe goal of this study is to develop a robust and interpretable\napproach for rapid phenotyping and subtyping of postpartum\nhemorrhage (PPH) patients. We leverage Flan-T5, an open-source\nLLM, to perform zero-shot extraction of PPH-related concepts from\nobstetric discharge summaries, and we use the extracted concepts\nto perform interpretable PPH phenotyping and subtyping. We\nvalidate the extracted concepts using manual expert chart review\nand ﬁnd that Flan-T5 can extract PPH-related concepts with strong\nperformance and can identify PPH patients and subtypes of PPH\nthat are missed by common structured data approaches. This two-\nstep extract-then-phenotype approach allows for greater inter-\npretability compared to end-to-end supervised machine learning\nmodels and better recall compared to more brittle keyword or\nregex rules-based models. Furthermore, the open-source Flan-T5\nLLMs can be run locally behind a hospital ﬁrewall, limiting\nconcerns regarding the security, privacy, and run-time costs of the\nmodels. Ourﬁndings highlight the potential for LLMs to annotate\nclinical notes and facilitate rapid and accurate phenotyping for\ndiverse clinical outcomes.\nRESULTS\nStudy cohort\nWe identi ﬁed 138,648 unique individuals with an obstetric\nencounter resulting in birth after 20 gestational weeks at the\nMass General Brigham (MGB) hospitals in Boston, MA, from\n1998– 2015. There were a total of 503,991 discharge summaries for\npatients in this initial cohort. We leveraged discharge summaries\nfor NLP-based phenotyping, as postpartum hemorrhage (PPH)\ntypically develops within 24 hours after delivery, and patients are\nnot discharged until at least 24 hours post-delivery. As not every\ndischarge note described a delivery encounter, we developed a\ncombination of terms to identify delivery-related discharge notes\nwith high recall (See Methods). Afterﬁltering discharge summaries\nthat did not describe a delivery encounter, ourﬁnal study cohort\nwas comprised of 131,284 unique patients with 271,081 discharge\nsummaries (Fig. 1a). Each patient had an average of 2.1 obstetric\ndischarge summary notes (SD= 1.4), consisting of 807.6 words on\naverage (SD= 923.1). The cohort characteristics are summarized in\nFig. 1b– e.\nZero-shot extraction of PPH-related concepts with NLP\nWe developed a list of 24 PPH-related concepts based on an\nextensive literature review and discussion with expert physicians\n(V.K. and K.G.; full list and deﬁnitions in Supplementary Table 1).\nWe identiﬁed the PPH-related concepts in all discharge summaries\nby prompting the 11 billion parameter Flan-T5 model (Flan-T5-\nXXL), to either answer a yes/no question regarding the presence of\na condition, medication, or procedure (e.g., uterine atony) or to\nextract a speciﬁc measurement (e.g., estimated blood loss; Fig.2a).\nWe used a set of 50 annotated notes to develop the LLM prompts.\nThis approach allows for extraction of concepts from unstructured\ntext without requiring data to further train the model. Only a small\nnumber of annotated notes are needed for prompt development.\nFig. 1 Obstetric delivery cohort. aInclusion criteria for identifying delivery-related discharge summaries. Theﬁnal cohort consists of 271,081\ndischarge notes for 131,284 women with an obstetric encounter at Mass General Brigham hospitals from 1998– 2015. b– e Characteristics of the\ncohort based on (b) delivery hospital and (c) patient age at delivery, (d) patient race, and (e) patient ethnicity. ER emergency room, MGH\nMassachusetts General Hospital, BWH Brigham and Women’s Hospital, NSM North Shore Medical Center, NWH Newton Wellesley Hospital.\nE. Alsentzer et al.\n2\nnpj Digital Medicine (2023)   212 Published in partnership with Seoul National University Bundang Hospital\n1234567890():,;\nWe evaluated the Flan-T5 model performance on a random\nsample of 1175 manually annotated discharge summaries with\nPPH ICD diagnosis codes. Discharge summaries with PPH\ndiagnosis codes were used to enrich for obstetric discharge\nsummaries more likely to contain PPH-related concepts. The Flan-\nT5 performance is summarized in Table1.\nWe compared the Flan-T5 NLP models to regular expressions\nconstructed for each PPH-related concept (Fig.3; Supplementary\nTable 2). Regular expressions were selected as the baseline\napproach because they can similarly be constructed with minimal\n“training\" data. Our primary evaluation metric for the classiﬁcation\ntasks was binary F1 score, which is useful for imbalanced datasets\nwith rare labels where performance on the positive class is most\nimportant. The Flan-T5 model achieved a binary F1 score of 0.75 or\nhigher on 21 of 23 binary concepts, exceeding a 0.9 binary\nF1 score on 12 of the PPH concepts. Flan-T5 signi ﬁcantly\noutperformed the corresponding regular expression for nine\nbinary PPH-related concepts (all p-values < 0.05, McNemar test).\nFurthermore, the model extracted estimated blood loss values\nwith a recall of 0.745, precision of 0.905, and note level accuracy of\n95.1%. While regular expressions achieved similar performance on\nsimpler extraction tasks, such as identiﬁcation of medication use,\nthe Flan-T5 model outperformed regular expressions on concepts\nthat are expressed in clinical notes in variable formats, such as\ncoagulation disorders. Flan-T5 ’s false positives were largely in\nnotes with polysemy or semantically related concepts.\nFor example, the notes that contained postpartum‘dilation and\ncurettage’ were also often predicted to be positive for‘manual\nremoval of placenta’; the latter procedure commonly precedes\ncurettage. The majority of false positives for the concept’uterine\nrupture’ were in notes in which there was a mention of’rupture’.\nHowever, in those cases, the annotators inferred that’rupture’ was\nrelated to the artiﬁcial or spontaneous rupture of membranes,\nwhich is part of normal labor, rather than’uterine rupture’. The\nfalse negatives were commonly due to unusual abbreviations or\nconcepts with multiple misspellings. For example, in one of the\nnotes containing the following text ‘500ccf/b d&c for retained\nPOC’, the model correctly identi ﬁed the concept ‘retained\nproducts of conception’ but was unable to extract the blood loss,\nin this case‘500’ or identify ‘dilation and curettage’.\nWhile prompts were developed solely on notes from a single\nhospital site, we found that the model generalized well to notes\nfrom other MGB hospitals. There was no substantial difference in\nperformance across hospital sites (Supplementary Table 3). We\nfurther evaluated Flan-T5 on a sample of 100 notes from\n2015– 2022 to assess generalizability over time and across\nelectronic health records. The Flan-T5 model achieved a binary\nF1 score of 0.75 or higher on 14 of the 20 binary concepts with\nannotated examples (Supplementary Table 4). The model\nperformed comparably in both settings for most concepts, but\nthere were six concepts with fewer positive examples that had\nlarger differences in binary F1 score over time.\nNLP-based identiﬁ\ncation of PPH cases\nWe leveraged the extracted concepts to identify deliveries with\npostpartum hemorrhage (Fig. 2b). The Flan-T5 model extracted\nthe estimated blood loss values and delivery type (cesarean or\nvaginal) from all notes in the cohort ( n = 271,081). Subse-\nquently, we classiﬁed notes as describing PPH if patients had\nblood loss greater than 500 mL for vaginal deliveries or greater\nthan 1000 mL for cesarean deliveries. This matched the PPH\ndeﬁnition used in the hospitals during the study period (See\nFig. 2 Overview of zero-shot NLP pipeline for accurate and interpretable postpartum hemorrhage (PPH) phenotyping. aZero-shot\nextraction of PPH concepts using Flan-T5. We constructed either yes/no or extraction prompts for each PPH concept, concatenated the\ndischarge summary of interest, and fed the combined input into Flan-T5. This process enabled the rapid extraction of PPH-related information\nfrom notes with no training data.b We leveraged the extracted concepts to perform interpretable phenotyping of PPH deﬁned as cesarean\ndeliveries with at least 1L or vaginal deliveries with at least 500mL of estimated blood loss.c We used the extracted concepts to perform\ninterpretable subtyping of PPH based on the underlying etiology. We assigned a delivery note to the“tone\", “tissue\", “trauma\", or“thrombin\"\nsubtype if any of the concepts associated with the subtype are present. PPH postpartum hemorrhage, EBL estimated blood loss, image:\nFlaticon.com.\nE. Alsentzer et al.\n3\nPublished in partnership with Seoul National University Bundang Hospital npj Digital Medicine (2023)   212 \nTable 1. Performance of the zero-shot Flan-T5 model in identifying postpartum hemorrhage (PPH) concepts in discharge summaries.\nConcept (n) Sensitivity Speci ﬁcity PPV Binary F1 Accuracy\nLaceration (n =421) 0.976 0.996 0.993 0.984 0.989\nBakri balloon (n = 46) 0.957 1.000 1.000 0.978 0.998\nCesarean delivery (n = 470) 0.983 0.970 0.957 0.970 0.975\nMethylergonovine (n = 104) 0.952 0.996 0.961 0.957 0.992\nPlacenta previa (n =170) 0.982 0.986 0.923 0.952 0.986\nFresh frozen plasma (n = 79) 0.962 0.995 0.938 0.950 0.993\nCarboprost (n = 49) 0.898 0.999 0.978 0.936 0.995\nMisoprostol as a uterotonic (n =112) 0.938 0.991 0.913 0.925 0.986\nHysterectomy (n =55) 0.982 0.993 0.871 0.923 0.992\nO’Leary sutures (n = 12) 0.917 0.999 0.917 0.917 0.998\nUterine atony (n = 107) 0.850 0.999 0.989 0.915 0.986\nRetained products of conception (n = 102) 0.892 0.993 0.929 0.910 0.985\nDirect mention of PPH (n =362) 0.881 0.963 0.914 0.897 0.938\nPacked red blood cells (n =165) 0.945 0.971 0.843 0.891 0.968\nAbruption of the placenta (n = 47) 0.915 0.994 0.860 0.887 0.991\nCoagulation disorders (n = 44) 0.795 0.996 0.897 0.843 0.989\nCryoprecipitate (n = 29) 1.000 0.990 0.725 0.841 0.991\nDilation and curettage (n = 122) 0.762 0.990 0.894 0.823 0.966\nPlatelets (n = 29) 1.000 0.986 0.644 0.784 0.986\nPlacenta accreta spectrum (n = 45) 0.822 0.987 0.712 0.763 0.980\nManual extraction of placenta (n = 110) 0.782 0.972 0.741 0.761 0.954\nPPH due to surgical causes (n = 27) 0.741 0.983 0.513 0.606 0.978\nUterine rupture (n = 5) 1.000 0.992 0.357 0.526 0.992\nConcept (n) Sensitivity PPV Note Acc.\nEstimated blood loss (n = 212) 0.745 0.905 0.951\nWe assessed model performance on 1175 manually annotated notes with PPH ICD diagnostic codes. We report the prevalence of each concept in the\nannotated test set. We report model sensitivity, speciﬁcity, positive predictive value (PPV), binary F1 score, and accuracy for binary concepts, and we report\nsensitivity, PPV, and note-level accuracy in extracting the correct estimated blood loss values.\nPPH postpartum hemorrhage.\nFig. 3 Comparison of the Flan-T5 language model and regular expression approaches for zero-shot extraction of postpartum\nhemorrhage (PPH)-related concepts.The prevalence of each concept in the annotated test set is reported and compared to the model\nperformance according to binary F1 score. The stars (*) denote that there is a signiﬁcant difference (p < 0.05, McNemar test) between the regex\nand language model performance. PPH postpartum hemorrhage.\nE. Alsentzer et al.\n4\nnpj Digital Medicine (2023)   212 Published in partnership with Seoul National University Bundang Hospital\nMethods). There were 2598 discharge summary notes for 2270\ndeliveries in our study cohort with PPH, according to the model.\nThe prevalence of each PPH-related concept in the deliveries\nwith PPH identiﬁed based on model-extracted blood loss can be\nfound in Table 2.\nWe evaluated the PPH phenotyping algorithm by comparing\nthe model performance on a random sample of 300 expert-\nannotated discharge summary notes predicted by Flan-T5 to\ndescribe deliveries with PPH. The gold-standard discharge\nsummaries were annotated via manual medical record review.\nThe positive predictive value of the NLP-based PPH phenotyping\nalgorithm is 0.95. The NLP-based approach allows identiﬁcation of\nPPH cases that lack any PPH International Classiﬁcation of Diseases\n(ICD) diagnosis codes associated with the delivery. Of the 285\ndischarge summaries with conﬁrmed PPH, 148 and 136 did not\nhave an associated PPH ICD code according to the deﬁnitions in\nButwick et al.\n7 and Zheutlin et al.8, respectively. Over 47% of the\ndischarge summaries with PPH would not have been identiﬁed\nusing PPH ICD codes alone.\nWe further examined the relationship between model-\nextracted estimated blood loss and presence of PPH ICD codes\non the entire notes cohort ( n = 271,081). As the blood loss\namount increases, there is more likely to be a PPH ICD code\nassociated with the admission, as expected (Fig.4, Supplemen-\ntary Fig. 2). When no estimated blood loss is extracted, the\nprevalence of PPH ICD codes is less than 5%. When the extracted\nblood loss values are between 1000 and 1500 mL, criteria which\nmeet both historical and current de ﬁnitions of PPH, less than\n50% of notes have an associated PPH ICD code.\nNLP-based classiﬁcation of PPH subtypes\nFinally, we leverage the extracted PPH concepts to classify\ndeliveries with PPH into four subtypes corresponding to distinct\ncauses of PPH: uterine atony (\"tone\"), retained products of\nconception and placenta accreta spectrum (\"tissue ”), birth or\nsurgical trauma, (‘trauma’) and coagulation abnormalities (\"throm-\nbin”; Fig. 2c). We constructed composite phenotypes for each\nsubtype based on the presence of one or more NLP-extracted PPH\nterms (See Methods). Using these NLP-based subtyping algo-\nrithms, we estimate that 29.9% of predicted PPH deliveries in our\nstudy cohort are due to uterine atony, 26.8% are due to retained\nproducts of conception, 24.0% are due to trauma, and 5.7% are\ndue to coagulation abnormalities.\nWe validated the subtyping algorithm via an expert manual\nmedical record review of the 285 conﬁrmed PPH deliveries. The\nPPH subtype could be determined via manual review of the\ndischarge summary in 73% of notes. We found that the NLP-based\napproach can achieve strong performance in subtype classiﬁca-\ntion of those notes across three of the four subtypes, signiﬁcantly\noutperforming an ICD-based approach to PPH subtyping for the\n“tone”, “tissue”, and “trauma” subtypes with binary F1 score by\n50.6%, 66.5%, and 17.8%, respectively (p-value < 0.01, McNemar\ntest; Table 3).\nDISCUSSION\nLarge language models (LLMs) hold immense potential to improve\nthe administration and practice of medicine. In this study, we\nreport the evaluation of a large language model for zero-shot\nphenotyping using clinical notes. As a proof-of-concept, we\nfocused on postpartum hemorrhage, the leading cause of\nmaternal morbidity and mortality. We developed a set of 24\npostpartum-hemorrhage-related concepts, which included binary\nidentiﬁcation of a concept or value extraction of a speci ﬁc\nmeasurement. We found that the Flan-T5 model extracted most\nconcepts with high precision and recall, enabling the creation of\nan interpretable postpartum hemorrhage phenotype that identi-\nﬁed signiﬁcantly more deliveries with postpartum hemorrhage\nthan would be identiﬁed by using diagnosis codes alone.\nTable 2. Prevalence of each postpartum hemorrhage (PPH)-related\nconcept in the deliveries with predicted PPH.\nConcept Prevalence (%)\nCesarean delivery 1002 (44.14)\nDirect mention of PPH 915 (40.31)\nLaceration 735 (32.38)\nPacked red blood cells 681 (30.00)\nManual extraction of placenta 532 (23.44)\nMisoprostol as a uterotonic 361 (15.90)\nDilation and curettage 339 (14.93)\nMethylergonovine 325 (14.32)\nFresh frozen plasma 319 (14.05)\nRetained products of conception 302 (13.30)\nUterine atony 261 (11.50)\nPlacenta previa 201 (8.85)\nHysterectomy 185 (8.15)\nCarboprost 159 (7.00)\nPlatelets 147 (6.48)\nPlacenta accreta spectrum 141 (6.21)\nPPH due to surgical causes 135 (5.95)\nBakri balloon 132 (5.82)\nCoagulation disorders 129 (5.68)\nAbruption of the placenta 129 (5.68)\nCryoprecipitate 113 (4.98)\nUterine rupture 106 (4.67)\nO’Leary sutures 40 (1.76)\nBoth the count and percentage of each concept are reported. The prevalence\nis reported in the 2270 deliveries that the natural language processing (NLP)-\nbased model labelled as describing postpartum hemorrhage.\nPPH postpartum hemorrhage.\nFig. 4 Prevalence of postpartum hemorrhage (PPH) international\nclassiﬁcation of diseases (ICD) codes in notes with varying\nestimated blood loss (EBL). The y-axis depicts the range of\nestimated blood loss (EBL) values extracted from the delivery note\nby Flan-T5 (if any), and thex-axis denotes the proportion of notes in\neach EBL category with a postpartum hemorrhage ICD diagnostic\ncode. PPH ICD codes are deﬁned according to the deﬁnition in\nZheutlin et al.\n8. Refer to Supplementary Fig. 2 for a similar plot using\nthe PPH ICD de ﬁnition from Butwick et al. 7. PPH postpartum\nhemorrhage, ICD international classi ﬁcation of diseases, EBL\nestimated blood loss.\nE. Alsentzer et al.\n5\nPublished in partnership with Seoul National University Bundang Hospital npj Digital Medicine (2023)   212 \nFurthermore, these granular concepts can be used for the\nprecise and interpretable identi ﬁcation of the subtypes of\npostpartum hemorrhage based on the underlying etiology.\nInterestingly, we found that the Flan-T5 model can achieve\nstrong performance despite not being speci ﬁcally trained on\nspecialized EHR data or medical information. This is consistent\nwith prior work that has investigated the utility of GPT-3 in\nperforming few-shot extraction from clinical text\n23. The Flan-T5\nperformance was best for concrete concepts where the prompt\ncould sufﬁciently describe how the concept might be described in\na clinical note. The model was resilient to misspellings and\nmedical abbreviations. Flan-T5 provided the greatest beneﬁt over\nregular expressions on more complex concepts, such as coagula-\ntion disorders and retained products of conception, which vary in\nhow they are documented. However, the model had lower\nperformance when differentiating closely related concepts, such\nas manual extraction of the placenta and dilation and curettage,\nsuggesting that clinical instruction-tuning or the use of few-shot\nexemplars may be beneﬁcial to improve performance. The model\ndemonstrated temporal generalizability across EHR systems for\nmost concepts, and additional prompt-tuning on more recent\nnotes may further improve performance.\nOur proposed approach demonstrates how complex large\nlanguage models can be leveraged to create downstream\ninterpretable models. The “extract-then-phenotype” approach\nenables easy validation of extracted concepts and rapid updating\nof phenotype deﬁnitions. In this work, we chose a postpartum\nhemorrhage deﬁnition that was valid at the time of clinical care\n29.\nSince 2018, the deﬁnition of PPH has changed to include only\nthose cases with blood loss of more than 1000 ml, regardless of\nthe type of delivery\n26. The advantage of our approach is that in\nsuch cases, the algorithm can quickly be adapted to remain\nrelevant.\nThe challenges in identifying patients with PPH are well\nrecognized. Currently, most epidemiological studies rely on ICD\ndiagnostic codes to develop the PPH phenotype. While ICD codes\nare available as structured data in EHR and many large datasets,\nthe studies using ICD codes demonstrate an underestimation of\nthe incidence of PPH compared to EBL\n7 or manual chart review30.\nIn addition, studies have demonstrated positive predictive power\nof 74.5% and only 9% overall prevalence of PPH ICD codes in all\npatients resenting for cesarean delivery\n7. Zero-shot phenotyping\nwith LLMs enabled us to rapidly identify delivery encounters with\npostpartum hemorrhage using clinical notes, enabling identiﬁca-\ntion of PPH cases that would have been missed by PPH ICD codes.\nOur analysis of PPH ICD code prevalence by extracted estimated\nblood loss (EBL) revealed that there are many clinical notes with\nEBL values that meet our PPH de ﬁnition, yet do not have\nassociated PPH ICD codes. There are several possible explanations\nfor this, including preemption of additional blood loss with\nappropriate medication, inaccurate EBL measurements that do not\nclinically correlate with the severity of the patient’s presentation,\nand incorrect extraction of EBL. Nevertheless, these ﬁndings\nunderscore the limitations of traditional PPH phenotyping\napproaches based on claims data alone.\nWe also created interpretable algorithms to classify different\netiology-based subtypes of PPH. This type of analysis is rarely\ndone in other studies as all subtypes are rarely documented\n28.\nMost studies have focused on atonic PPH, which is identi ﬁed\nbased on the use of uterotonic medications, sometimes available\nas structured data\n31. In this work, drug administration was not part\nof the historical medical record and could not be easily retrieved.\nOur approach using granular concepts from clinical notes allowed\nfor improved classiﬁcation based on the presence of inadequate\nuterine tone even when speciﬁc medications were not mentioned.\nFurthermore, this approach is easily portable across institutions as\nevidenced by the stable performance across two different\nhospitals in our cohort.\nThe NLP model outperformed an ICD-based approach for three\nof the four subtypes, only underperforming on the “thrombin\"\nsubtype, which had a substantially lower prevalence of 6.3%\ncompared to the other subtypes in our evaluation cohort. These\napproaches for subtyping PPH create new opportunities for the\ninvestigation of different PPH etiologies and allow for the creation\nof better gold-standard phenotype labels, which can be used to\ntrain models to predict future occurrence of PPH subtypes. Future\nwork is needed to investigate the utility and feasibility of models\nfor PPH subtype prediction.\nOur work has some limitations. By focusing on discharge notes\nduring the delivery admission, we may have missed cases of\ndelayed or recurrent postpartum hemorrhage, which may have\nhappened later in the postpartum period. Future work could\nmodify the pipeline to analyze later postpartum events. The\ndischarge notes may also re ﬂect institution-speci ﬁc clinical\npractices, e.g., the notes may not include some relevant elements\nsuch as estimated blood loss and the clinician ’s subjective\ndecision to administer medication or perform a procedure. To\nmitigate this, we selected a long study period and analyzed notes\nfrom several hospitals.\nAnother limitation of using Flan-T5 for phenotyping is the size\nof the model, which, while signiﬁcantly smaller than many other\nLLMs, still incurs substantial computational cost. While Flan-T5 can\nTable 3. Comparison of NLP and ICD approaches for PPH subtyping.\nSubtype Prevalence (%) Method Sensitivity PPV Binary F1 Acc. P-value\nTone 41.8 NLP 0.931 0.964 0.947 0.957 <0.001\nICD 0.644 0.667 0.655 0.716\nTissue 38.9 NLP 0.827 0.957 0.887 0.918 <0.001\nICD 0.370 0.909 0.526 0.740\nTrauma 40.9 NLP 0.671 0.826 0.740 0.808 0.018\nICD 0.576 0.690 0.628 0.721\nThrombin 6.3 NLP 0.385 0.714 0.500 0.952 1.0\nICD 0.462 0.600 0.522 0.947\nThe true prevalence of each subtype and the NLP and ICD model performance are shown. Note that a single episode of postpartum hemorrhage can be\nclassiﬁed with multiple subtypes. The model evaluation was performed on 285 notes with conﬁrmed PPH via manual annotation. In 27.0% of the notes, the\nannotators were unable to determine a PPH subtype from the discharge summary alone (not shown). These notes were excluded to avoid inﬂation of false\npositives in the ICD model in cases where subtype information was captured elsewhere in the medical record.\nNLP natural language processing,PPH postpartum hemorrhage, ICD international classiﬁcation of diseases.\nBold values indicates the highest value of the NLP and ICD approaches for PPH subtyping.\nE. Alsentzer et al.\n6\nnpj Digital Medicine (2023)   212 Published in partnership with Seoul National University Bundang Hospital\nrun on a CPU, graphic processing unit (GPU) resources are needed\nfor efﬁcient inference. The Flan-T5-XXL model is approximately 20\ngigabytes in size. In contrast, a regular expression requires trivial\ncomputational resources. A hybrid approach that leverages\nregular expressions and LLMs may offer the bene ﬁts of both\nmethods. Future work could also train a clinical instruction-tuned\nmodel, which we expect can achieve comparable performance\nwith fewer parameters\n32. We also did not train Flan-T5 on our\nphenotyping task or consider recent LLMs such as ChatGPT and\nGPT-4 in this work. While these models have demonstrated\noutstanding performance, they are closed models that can require\nsubstantial costs when run over lengthy clinical notes. We opt for\nevaluation of an open-sourced language model which limits\nsecurity, privacy, and cost concerns. Additional studies are needed\nto assess whether other LLMs can further improve phenotyping\nperformance.\nFurthermore, LLMs have limitations such as hallucinations and\nbias. Our “extract-then-phenotype” approach allows for better\ninterpretability, but careful attention is needed to evaluate and\nmitigate these limitations. Finally, we performed an initial\nassessment of the model’s temporal generalizability, but further\nvalidation is needed to assess performance over time and across\nother medical conditions.\nWe investigated the utility of an open-source large language\nmodel in performing interpretable, zero-shot clinical phenotyping\nand subtyping. This approach offers a major advantage compared\nto existing methods for phenotyping from clinical notes, which\nrely on manually annotated training data. Zero-shot phenotyping\napproaches have the potential to accelerate research and improve\nclinical operations and medicine by enabling the rapid identiﬁca-\ntion of patient cohorts. These capabilities are critical for precise\ndisease investigations and, in the future, could lead to the\ndevelopment of personalized medicine tools.\nMETHODS\nCohort construction\nMass General Brigham (MGB) is an integrated healthcare system of\ntertiary and community hospitals and associated outpatient\npractices across New England. We leveraged MGB ’s Research\nPatient Data Repository (RPDR)\n33 to retrieve the data for all MGB\npatients with a pregnancy related ICD (International Classiﬁcation\nof Diseases) or DRG (Diagnoses Related Groups) code according to\nthe enhanced delivery identiﬁcation method34. The available data\nincludes self-reported race and ethnicity, date of birth, insurance\ninformation, ICD and DRG codes, and EHR notes. We restricted the\ncohort to patients with delivery prior to 5/1/2015, when MGB\ntransitioned to using EPIC’s electronic health record system, to\nenrich for delivery notes with longer narrative sections and less\nstructured data collection.\nThe discharge summaries were ﬁltered to remove duplicates,\ndraft notes, and any notes from the emergency department. The\npatient’s race, ethnicity, delivery hospital, and age at delivery were\nextracted from Mass General Brigham ’s RPDR. This study was\napproved by the Mass General Brigham Institutional Review Board,\nprotocol #2020P002859, with a waiver of patient consent.\nAnnotation method\nWe extended PRAnCER (Platform Enabling Rapid Annotation for\nClinical Entity Recognition)\n35, an annotation tool for clinical text, to\ncollect annotations for the PPH-related concepts. During the\nannotation process, the annotator highlights a span of text in the\nnote and assigns it to the corresponding label. Regular expres-\nsions are used initially to highlight potential annotations, and the\nannotator can conﬁrm or reject the regex “pre-annotation\". We\nfound that this pre-annotation process can accelerate the\nannotation workﬂow and improve annotator recall. However, it\ndoes have the potential to induce over-reliance on the pre-\nannotations. An image of the modiﬁed annotation tool is found in\nSupplementary Fig. 1.\nIdentiﬁcation of delivery discharge summaries\nThe discharge summaries retrieved from RPDR could pertain to\nany hospital admission during the time window. We compared\nthree approaches for identifying the subset of discharge\nsummaries that described an obstetric encounter: a regex\napproach, an ICD code approach, and a language modelling\napproach.\nThe ﬁrst approach involved the development of a regular\nexpression algorithm. We selected all discharge summaries\ncontaining any of the following terms:“labor “, “delivery”, “l&d”,\n“cesarean section”, “c-section”, “estimated edc”,o r “pregnancy”.\nThis approach was designed to optimize for recall, but it may\nproduce false positive examples when there are discharge notes\nfor admissions in the weeks prior and following a delivery. In the\nsecond approach, we retrieved all discharge summaries that had a\npregnancy-related ICD or DRG code (and do not have an excluded\ncode) withinx days of the date of the discharge summary, wherex\nmay be 0, 2, 7, or 14 days. This time-based linking is necessary\nbecause there is no encounter linking between billing data and\nclinical notes in our data repository. In theﬁnal approach, we split\neach note into chunks containing 512 tokens and prompted Flan-\nT5 with the following question: “Answer the following yes/no\nquestion. Does this discharge summary note mention a woman’s\ndelivery? note: <note>”, where <note> corresponds to the text of\neach chunk. If the model responded“yes” for any of the discharge\nsummary sections, we labeled the discharge summary as related\nto a delivery encounter. See below methods for additional details\nabout the Flan-T5 model.\nWe evaluated each of the approaches on 100 randomly\nsampled discharge summaries. We found that the language\nmodelling approach yielded the highest overall performance with\na macro F1 of 0.936 (Supplementary Table 4) but opted to use the\nregex approach for creation of the ﬁnal cohort given its 100%\nrecall.\nZero-shot natural language processing to extract PPH\nconcepts\nWe utilized Flan-T5, an instruction-tuned LLM that can be applied\nto unseen tasks without any additional model training\n20, to extract\nPPH-related concepts from obstetric discharge summaries. Flan-T5\ntakes as input a prompt describing the task and generates a text\noutput. We leverage Flan-T5 for two broad classes of tasks: binary\nclassiﬁcation and text extraction. Identiﬁcation of estimated blood\nloss is framed as a text extraction task, and all other PPH-related\nconcepts are framed as binary classiﬁcation tasks.\nWe developed and evaluated the Flan-T5 models on a set of\n1225 manually labelled discharge summaries with ICD codes\nrelated to PPH, as de ﬁned in Zheutlin et al.\n8. We performed\nstratiﬁed sampling to set aside 50 discharge summaries for a small\ndevelopment cohort to conduct minimal prompt engineering for\neach PPH-related concept, and the remaining 1175 discharge\nsummaries served as our test set. Importantly, there was no\noverlap in patients between the development and test sets.\nFurthermore, we only included discharge summaries from a single\nMGB hospital (Brigham and Women’s Hospital) in the develop-\nment set in order to evaluate the generalizability of the models to\nnotes from other hospitals in the MGB system. We also measure\nthe temporal generalizability of the model by evaluating on a\nseparate sample of 100 manually labelled discharge summaries\nwith PPH ICD codes from 2015– 2022.\nWe performed minimal prompt engineering, constructing one\nto ﬁve prompts for each PPH-related concept. We selected the\noptimal prompt via binary F1 performance on the development\nE. Alsentzer et al.\n7\nPublished in partnership with Seoul National University Bundang Hospital npj Digital Medicine (2023)   212 \nset. Example prompts for PPH-related concepts are in Table4. For\nthe most complex concepts, such as“placenta accreta spectrum”,\n“PPH due to surgical causes ”, “coagulation disorders with\nincreased risk of bleeding”, and“misoprostol (used as uterotonic)”,\nwe chained together several separate prompts to generate more\nnuanced predictions. If any of the prompts labeled a concept as\npresent, we considered the concept present.\nThe length of discharge summaries often exceeded the max\nlength of the input for Flan-T5 models. To address this, we split\neach discharge summary into text chunks of 512 tokens with a\nstride of 128, generated a prediction for each text chunk, and\naggregated the resulting predictions. For binary classi ﬁcation\ntasks, we considered the label as positive if any of the text\nchunks have a positive label. For the text extraction tasks, we\ntook the union of all segments extracted from each text chunk.\nWe also performed post-processing to extract numbers from the\ngenerated text. This post-processing was necessary for text\nextraction tasks because the model can extract random text\nf r o mt h et e x tc h u n ki fap a r t i c u l a rt e x tc h u n kd o e sn o tc o n t a i n\nthe information to extract (e.g., a measurement for estimated\nblood loss).\nWe experimented with Flan-T5 models of varying sizes on our\ndevelopment set and found that the 11 billion parameter Flan-T5-\nXXL model performed substantially better than the smaller models\n(Supplementary Table 5). All analyses in this paper use the Flan-T5-\nXXL model downloaded from the HuggingFace model hub at\nhttps://huggingface.co/google/ﬂan-t5-xxl. Text was generated\nusing greedy decoding with max new tokens set to 5 and\ntemperature of 1.0. We performed inference using a single 16 GB\nRTX A4000. The Hugging Face accelerate library with DeepSpeed\nintegration was used to speed up inference by enabling a batch\nsize of 48 on a single GPU\n36.\nWe performed inference using Flan-T5 on all delivery-related\ndischarge summaries for each PPH-related concept. We compared\nthe Flan-T5 model to regular expressions constructed for each\nconcept. Regular expressions are the most pertinent baseline\nbecause they similarly do not require model training. We\ncompared model performance on the distinct test set of 1175\nmanually annotated discharge summaries.\nCreation of an NLP-based PPH phenotyping algorithm\nDuring the study period, the hospitals used a PPH deﬁnition based\non the estimated blood loss (EBL) > 500 mL during a vaginal\ndelivery or >1000 mL during a cesarean delivery\n29, and we\nleveraged the extracted PPH-related concepts to identify PPH\ndeliveries. We focused on the phenotyping of primary PPH, as\npatients with secondary PPH may develop PPH after discharge\n29.\nConcretely, we identify a PPH delivery if the sum of all extracted\nEBL values is > 500 and the model predicts a vaginal delivery or if\nthe model sum of all extracted EBL values is > 1000 and the model\npredicts a cesarean delivery.\nIn cases where multiple EBL were extracted with the same\nvalue, we assumed that these we re multiple mentions of the\nsame EBL in the note and did not sum the values. In cases where\nt h ee x t r a c t e dE B Lw a sas i n g l ed i g i t ,w ea s s u m e dt h eE B Lw a s\nreported in liters and converted the extracted values to\nmilliliters.\nWe identiﬁed PPH deliveries from our entire cohort of delivery\ndischarge summaries and report characteristics of the identiﬁed\nPPH deliveries. We evaluated the positive predictive value of our\napproach by manually annotating the EBL and cesarean status of a\nrandom sample of 300 discharge summaries that the model\npredicts as describing a PPH delivery. We measured the ability of\nthe NLP-approach to identify PPH cases missed by ICD-based\ndeﬁnitions of PPH\n7,8,37 by calculating the fraction of conﬁrmed\nPPH cases that have PPH-related ICD codes.\nCreation of an NLP-based PPH subtyping algorithm\nWe used the extracted PPH-related concepts to develop four\ncomposite PPH subtyping algorithms corresponding to distinct\ncauses of PPH: uterine atony ( “tone”), retained products of\nconception ( “tissue”), trauma ( “trauma”), and coagulation\nabnormalities ( “thrombin ”)38 (Table 5). We labeled a PPH\ndelivery with the “tone” subtype if the discharge summary\ncontained any of the following : mention of uterine atony,\nadministration of methylergono vine, administration of carbo-\nprost or administration of misoprostol as a uterotonic. We\nlabeled a PPH delivery with the“tissue” subtype if the discharge\nsummary contained any of the following: placenta accreta\nspectrum, retained products o f conception, dilatation and\ncurettage, or manual extraction of the placenta. We labeled a\nPPH delivery with the “trauma” subtype if the discharge\nsummary contained documentation of any of the following:\nuterine rupture, O’Leary stitches, PPH due to surgical causes (e.g.\ndamage to the uterine artery), or laceration with no other PPH\nsubtype mentioned. We label ed a PPH delivery with the\nTable 4. Example prompts provided to Flan-T5 to perform zero-shot extraction of postpartum hemorrhage (PPH)-related concepts.\nConcept Prompt\nDirect mention of PPH Answer the following yes/no question. Does the following discharge summary mention postpartum hemorrhage (PPH)\nduring the current delivery? note:〈note〉\nMethylergonovine Answer the following yes/no question. Does the following discharge summary mention the drug methergine\n(methylergonovine)? note: 〈note〉\nEstimated blood loss Extract the estimated blood loss (EBL) in the following discharge summary. If you cant́ ﬁnd the answer, please respond\n“unanswerable\". note: 〈note〉\nPlacenta accreta spectrum Answer the following yes/no question. Does the following discharge summary mention placenta percreta during the\ncurrent delivery? note:〈note〉\nAnswer the following yes/no question. Does the following discharge summary mention placenta increta during the\ncurrent delivery? note:〈note〉\nAnswer the following yes/no question. Does the following discharge summary mention placenta accreta during the\ncurrent delivery? note:〈note〉\nWe include prompts representative of different types of information retrieval (e.g. presence of a condition, presence of a drug, quantitative valueextraction,\nand multi-prompt concept extraction).“〈note〉\" refers to the full text of the note. If the entire note can notﬁt into a single context window of the model, the\ntext is split into chunks, and the prompt is concatenated to each chunk separately and input into the model. The remaining prompts can be found in our\naccompanying Github repository.\nPPH postpartum hemorrhage, EBL estimated blood loss.\nE. Alsentzer et al.\n8\nnpj Digital Medicine (2023)   212 Published in partnership with Seoul National University Bundang Hospital\n“thrombin ” subtype if the discharge summary contained any of\nthe following: mention of dissemi nated intravascular coagula-\ntion, transfusion of platelets, tr ansfusion of cryoprecipitate, or\ntransfusion of frozen fresh plasma in ratio with red blood cells\nhigher than 1:1:1.\nWe performed subtyping on all deliveries that the NLP-based\nmodel predicted as describing postpartum hemorrhage. We\nvalidated the performance of the classi ﬁcation algorithms via\nmanual chart review of the conﬁrmed PPH deliveries identiﬁed\nabove (See “Identiﬁcation of deliveries with PPH”). We compared\nthe NLP-based approach to a subtyping approach that leveraged\nICD codes. The ICD de ﬁnitions for each subtype based on\nconversion from ICD10 codes\n28 are in Table5.\nValidation of model performance\nWe performed manual annotation of discharge summaries to\nassess the performance of our models for extracting PPH-related\nconcepts, identifying patients with PPH, and classifying subtypes\nof PPH. In each use case, one of four annotators with experience in\nreading obstetrics notes (M.R., R.F., A.G., and V.K.)ﬁrst annotated\nthe notes with the relevant PPH-related concepts or subtypes, and\na clinician (V.K. and K.G.) subsequently reviewed all annotations.\nStatistical analyses\nWe performed a McNemar test to assess whether there is a\nsigniﬁcant difference in performance between our NLP-based\napproach and a regular expression approach for extracting PPH-\nrelated concepts. We similarly used a McNemar test to compare\nthe NLP-based and ICD-based approaches for subtyping PPH\ndeliveries.\nDATA AVAILABILITY\nThe MGB data used in this study contains identiﬁable protected health information\nand therefore cannot be shared publicly. MGB investigators with an appropriate IRB\napproval can contact the authors directly regarding data access.\nCODE AVAILABILITY\nThe code used to run Flan-T5 and reproduce results can be found at https://\ngithub.com/EmilyAlsentzer/PPH-Extract.\nReceived: 2 June 2023; Accepted: 1 November 2023;\nREFERENCES\n1. Yu, S. et al. Toward high-throughput phenotyping: unbiased automated feature\nextraction and selection from knowledge sources. J. Am. Med. Inform. Assoc.:\nJAMIA 22, 993– 1000 (2015).\n2. Nakamaru, R. et al. Phenotyping of elderly patients with heart failure focused\non noncardiac conditions: a latent class analysis from a multicenter registry of\npatients hospitalized with heart failure. J. Am. Heart Assoc. 12, e027689\n(2023).\n3. Bennett, W. L. et al. Patient recruitment into a multicenter clinical cohort linking\nelectronic health records from 5 health systems: cross-sectional analysis.J. Med.\nInternet Res. 23, e24003 (2021).\n4. Richesson, R. L. et al. Electronic health records based phenotyping in next-\ngeneration clinical trials: a perspective from the NIH Health Care Systems Colla-\nboratory. J. Am. Med. Inform. Assoc.: JAMIA20, e226– e231 (2013).\n5. Post, A. R. et al. Temporal abstraction-based clinical phenotyping with Eureka!\nAMIA Ann. Symposium Proc.2013, 1160– 1169 (2013).\n6. Denny, J. C. et al. Systematic comparison of phenome-wide association study of\nelectronic medical record data and genome-wide association study data.Nat.\nBiotechnol. 31, 1102– 1110 (2013).\n7. Butwick, A. J., Walsh, E. M., Kuzniewicz, M., Li, S. X. & Escobar, G. J. Accuracy of\ninternational classiﬁcation of diseases, ninth revision, codes for postpartum\nhemorrhage among women undergoing cesarean delivery. Transfusion 58,\n998– 1005 (2018).\n8. Zheutlin, A. B. et al. A comprehensive digital phenotype for postpartum\nhemorrhage. J. Am. Med. Inform. Assoc.: JAMIA29, 321– 328 (2022).\n9. Kirby, J. C. et al. PheKB: a catalog and workﬂow for creating electronic phenotype\nalgorithms for transportability. J. Am. Med. Inform. Assoc.: JAMIA23, 1046– 1052\n(2016).\n1 0 .L i a o ,K .P .e ta l .D e v e l o p m e n to fp h enotype algorithms using electronic\nmedical records and incorporating natural language processing. BMJ 350,\nh1885 (2015).\n11. Zeng, Z., Deng, Y., Li, X., Naumann, T. & Luo, Y. Natural language processing for\nEHR-based computational phenotyping.IEEE/ACM Trans. Comput. Biol. Bioinform.\n16, 139– 153 (2019).\n12. Aramaki, E., Imai, T., Miyo, K. & Ohe, K. Patient status classiﬁcation by using rule\nbased sentence extraction and bm25 knn-based classiﬁer. In i2b2 Workshop on\nChallenges in Natural Language Processing for Clinical Data (2006).\n13. Sharma, H. et al. Developing a portable natural language processing based\nphenotyping system. BMC Med. Inform. Decis. Making19, 78 (2019).\n14. Chase, H. S., Mitrani, L. R., Lu, G. G. & Fulgieri, D. J. Early recognition of multiple\nsclerosis using natural language processing of the electronic health record.BMC\nMed. Inform. Decis. Making17\n, 24 (2017).\n15. Chapman, W. W., Fizman, M., Chapman, B. E. & Haug, P. J. A comparison of\nclassiﬁcation algorithms to automatically identify chest x-ray reports that support\npneumonia. J. Biomed. Inform.34,4 – 14 (2001).\nTable 5. Postpartum hemorrhage (PPH) subtype deﬁnitions.\nSubtype NLP-based de ﬁnition ICD-based deﬁnition\nTone uterine atony; methergine / methylergonovine; carboprost; misoprostol as a uterotonic 666.1x\nTissue placenta accreta spectrum; retained products of conception; dilatation and curettage; manual extraction of the\nplacenta\n666.0x\nTrauma uterine rupture; PPH due to surgical causes; O’Leary stitches; laceration (if no other subtype is valid) 665.x or (664.x if no\n666.x)\nThrombin coagulation disorders with increased risk of bleeding; administration of platelets, fresh frozen plasma, or\ncryoprecipitate in a ratio with red blood cells higher than 1:1:1\n666.3x\nThe natural language processing (NLP)-based approach that leverages the extracted PPH concepts is on the left. A note is labelled with a given subtypeif any\nof the concepts are present in the note. One exception is the“laceration” concept, which only signiﬁes the“trauma” subtype if no other subtypes have been\nassigned to the note. The baseline international classiﬁcation of diseases (ICD)-based approach is on the right. Similarly, a note is assigned to a subtype if any\nof the ICD codes are present. Herex refers to any number 0−9, meaning that any more speciﬁc ICD code under that in the ICD ontology will sufﬁce. For\nexample, 666.14 is a valid ICD code for the“tone” subtype. 664.x only signiﬁes the “trauma” subtype if no 666.x ICD code is present (i.e. there are no other\nattributable causes of the hemorrhage). These rules for the“laceration” subtype are designed to mitigate false positives due to lacerations during the delivery\nthat do not result in signiﬁcant hemorrhage.\nNLP natural language processing,PPH postpartum hemorrhage, ICD international classiﬁcation of diseases.\nE. Alsentzer et al.\n9\nPublished in partnership with Seoul National University Bundang Hospital npj Digital Medicine (2023)   212 \n16. Yang, S., Varghese, P., Stephenson, E., Tu, K. & Gronsbell, J. Machine learning\napproaches for electronic health records phenotyping: a methodical review.J.\nAm. Med. Inform. Assoc.30, 367– 381 (2023).\n17. Gehrmann, S. et al. Comparing deep learning and concept extraction based meth-\nods for patient phenotyping from clinical narratives.PloS One13, e0192360 (2018).\n18. Brown, T. B. et al. Language models are few-shot learners. InProceedings of the\n34th Annual Conference on Neural Information Processing Systems . 1877– 1901\n(Curran Associates, Inc, 2020).\n19. Ouyang, L. et al. Training language models to follow instructions with human\nfeedback. In: Advances in Neural Information Processing Systems. 27730– 27744\n(Curran Associates, Inc, 2022).\n20. Chung, H. W. et al. Scaling Instruction-Finetuned Language Models. Preprint at:\nhttp://arxiv.org/abs/2210.11416 (2022).\n21. Sivarajkumar, S. & Wang, Y. HealthPrompt: a zero-shot learning paradigm for\nclinical natural language processing.AMIA Ann. Symposium Proc.2022, 972– 981\n(2022).\n22. Yao, Z., Cao, Y., Yang, Z., Deshpande, V. & Yu, H. Extracting biomedical factual\nknowledge using pretrained language model and electronic health record con-\ntext. In AMIA Annual Symposium Proceedings, vol. 2022, 1188 (American Medical\nInformatics Association, 2022).\n2 3 .A g r a w a l ,M . ,H e g s e l m a n n ,S . ,L a n g ,H . ,K i m ,Y .&S o n t a g ,D .L a r g eL a n g u a g e\nModels are Few-Shot Clinical Information Extractors. In:Proceedings of the 2022\nConference on Empirical Methods in Natural Language Processing . 1998– 2022\n(Abu Dhabi, United Arab Emirates. Association for Computational Linguistics,\n2022).\n24. McInerney, D. J., Young, G., van de Meent, J.-W. & Wallace, B. C. CHiLL: Zero-shot\nCustom Interpretable Feature Extraction from Clinical Notes with Large Language\nModels. Preprint at:http://arxiv.org/abs/2302.12343 (2023).\n25. Global Burden of Disease Collaborators. Global, regional, and national levels of\nmaternal mortality, 1990– 2015: a systematic analysis for the Global Burden of\nDisease Study. Lancet388, 1775– 1812 (2016).\n26. American College of Obstetricians and Gynecologists. Practice Bulletin No. 183:\nPostpartum Hemorrhage. Obstetrics and Gynecology 130, e168– e186 (2017).\n27. Corbetta-Rastelli, C. M. et al. Postpartum hemorrhage trends and outcomes in the\nUnited States, 2000– 2019. Obstet. Gynecol. 141, 152– 161 (2023).\n28. Walther, D. et al. Hospital discharge data is not accurate enough to monitor the\nincidence of postpartum hemorrhage.PloS One 16, e0246119 (2021).\n29. American College of Obstetricians and Gynecologists. ACOG Practice Bulletin:\nClinical Management Guidelines for Obstetrician-Gynecologists Number 76,\nOctober 2006: postpartum hemorrhage. Obstetrics and Gynecology 108,\n1039– 1047 (2006).\n30. He, M. et al. Validation of algorithms to identify adverse perinatal outcomes in the\nMedicaid Analytic Extract database.Pharmacoepidemiol. Drug Safety29, 419– 426\n(2020).\n31. Ende, H. B. et al. Development of clinical risk-prediction models for uterine atony\nfollowing vaginal and cesarean delivery.Int. J. Obstet. Anesth.\n51, 103550 (2022).\n32. Lehman, E. et al. Do we still need clinical language models? In:Proceedings of the\nConference on Health, Inference, and Learning, PMLR 209, 578– 597, (2023).\n33. Nalichowski, R., Keogh, D., Chueh, H. C. & Murphy, S. N. Calculating the beneﬁts of\na research patient data repository.AMIA Ann. Symposium Proc.2006, 1044 (2006).\n34. Kuklina, E. V. et al. An enhanced method for identifying obstetric deliveries:\nimplications for estimating maternal morbidity. Maternal Child Health J. 12,\n469– 477 (2008).\n35. Levy, A. & Agrawal, M. PRAnCER, Platform enabling Rapid Annotation for Clinical\nEntity Recognition. Original-date: 2020-10-25. https://github.com/clinicalml/\nprancer (2023).\n36. Sylvain Gugger, T. W. P. S. Z. M. S. M., Lysandre Debut. Accelerate: training and\ninference at scale made simple, ef ﬁcient and adaptable. https://github.com/\nhuggingface/accelerate (2022).\n37. Goffman, D. et al. A framework for improving characterization of obstetric\nhemorrhage using informatics data.Obstet. Gynecol. 134, 1317– 1325 (2019).\n38. Evensen, A., Anderson, J. M. & Fontaine, P. Postpartum hemorrhage: prevention\nand treatment. Am. Fam. Physician95, 442– 449 (2017).\nACKNOWLEDGEMENTS\nK.J.G. reports funding from NIH/NHLBI grants K08 HL146963-02, K08 HL146963-02S1,\nand R03 HL162756. V.P.K. reports funding from the NIH/NHLBI grants 1K08HL161326-\n01A1, Anesthesia Patient Safety Foundation (APSF), and BWH IGNITE Award. The\nfunders played no role in study design, data collection, analysis and interpretation of\ndata, or the writing of this manuscript.\nAUTHOR CONTRIBUTIONS\nE.A. and V.K. conceptualized and designed the study. M.R., R.F., A.C., K.G., and V.K.\nread and annotated all clinical notes. E.A. conducted all analyses, V.K. performed\nvalidation. E.A. and V.K. drafted the manuscript, which was edited and critically\nreviewed by M.R., R.F., A.C., B.B., K.G., and D.B. Mass General Brigham was the source\nof data and location for all analyses. All authors read and approved the ﬁnal\nmanuscript and hadﬁnal responsibility for the decision to submit it for publication.\nCOMPETING INTERESTS\nK.J.G. has served as a consultant to Illumina Inc., Aetion, Roche, and BillionToOne\noutside the scope of the submitted work. D.W.B. reports grants and personal fees\nfrom EarlySense, personal fees from CDI Negev, equity from Valera Health, equity\nfrom CLEW, equity from MDClone, personal fees and equity from AESOP Technology,\npersonal fees and equity from FeelBetter, and grants from IBM Watson Health,\noutside the submitted work. V.P.K. reports consulting fees from Avania CRO unrelated\nto the current work.\nADDITIONAL INFORMATION\nSupplementary information The online version contains supplementary material\navailable at https://doi.org/10.1038/s41746-023-00957-x.\nCorrespondence and requests for materials should be addressed to Vesela P.\nKovacheva.\nReprints and permission information is available at http://www.nature.com/\nreprints\nPublisher’s noteSpringer Nature remains neutral with regard to jurisdictional claims\nin published maps and institutional afﬁliations.\nOpen Access This article is licensed under a Creative Commons\nAttribution 4.0 International License, which permits use, sharing,\nadaptation, distribution and reproduction in any medium or format, as long as you give\nappropriate credit to the original author(s) and the source, provide a link to the Creative\nCommons license, and indicate if changes were made. The images or other third party\nmaterial in this article are included in the article’s Creative Commons license, unless\nindicated otherwise in a credit line to the material. If material is not included in the\narticle’s Creative Commons license and your intended use is not permitted by statutory\nregulation or exceeds the permitted use, you will need to obtain permission directly\nfrom the copyright holder. To view a copy of this license, visit http://\ncreativecommons.org/licenses/by/4.0/.\n© The Author(s) 2023\nE. Alsentzer et al.\n10\nnpj Digital Medicine (2023)   212 Published in partnership with Seoul National University Bundang Hospital",
  "topic": "Interpretability",
  "concepts": [
    {
      "name": "Interpretability",
      "score": 0.8190922737121582
    },
    {
      "name": "Computer science",
      "score": 0.6701731085777283
    },
    {
      "name": "Subtyping",
      "score": 0.5650768280029297
    },
    {
      "name": "Language model",
      "score": 0.5027899742126465
    },
    {
      "name": "Machine learning",
      "score": 0.48620787262916565
    },
    {
      "name": "Artificial intelligence",
      "score": 0.47556084394454956
    },
    {
      "name": "Natural language processing",
      "score": 0.42404720187187195
    },
    {
      "name": "Data mining",
      "score": 0.33301711082458496
    },
    {
      "name": "Programming language",
      "score": 0.16365781426429749
    }
  ]
}