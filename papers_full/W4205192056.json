{
  "title": "SignalP 6.0 predicts all five types of signal peptides using protein language models",
  "url": "https://openalex.org/W4205192056",
  "year": 2022,
  "authors": [
    {
      "id": "https://openalex.org/A4305114007",
      "name": "Teufel, Felix",
      "affiliations": [
        "Technical University of Denmark",
        "ETH Zurich"
      ]
    },
    {
      "id": null,
      "name": "Almagro Armenteros, José Juan",
      "affiliations": [
        "University of Copenhagen",
        "Novo Nordisk Foundation"
      ]
    },
    {
      "id": "https://openalex.org/A4289143909",
      "name": "Johansen, Alexander Rosenberg",
      "affiliations": [
        "Stanford University"
      ]
    },
    {
      "id": null,
      "name": "Gíslason, Magnús Halldór",
      "affiliations": [
        "Copenhagen University Hospital",
        "Rigshospitalet"
      ]
    },
    {
      "id": null,
      "name": "Pihl, Silas Irby",
      "affiliations": [
        "Technical University of Denmark"
      ]
    },
    {
      "id": null,
      "name": "Tsirigos, Konstantinos D.",
      "affiliations": [
        "European Bioinformatics Institute"
      ]
    },
    {
      "id": "https://openalex.org/A2562191932",
      "name": "Winther, Ole",
      "affiliations": [
        "University of Copenhagen",
        "Copenhagen University Hospital",
        "Rigshospitalet",
        "Technical University of Denmark"
      ]
    },
    {
      "id": "https://openalex.org/A4303119459",
      "name": "Brunak, Søren",
      "affiliations": [
        "University of Copenhagen",
        "Novo Nordisk Foundation"
      ]
    },
    {
      "id": "https://openalex.org/A2999028089",
      "name": "Von Heijne Gunnar",
      "affiliations": [
        "Stockholm University",
        "Science for Life Laboratory"
      ]
    },
    {
      "id": "https://openalex.org/A2752122926",
      "name": "Nielsen, Henrik",
      "affiliations": [
        "Technical University of Denmark"
      ]
    }
  ],
  "references": [
    "https://openalex.org/W2946222253",
    "https://openalex.org/W2004406780",
    "https://openalex.org/W2809371850",
    "https://openalex.org/W2912990441",
    "https://openalex.org/W2937378039",
    "https://openalex.org/W3158236124",
    "https://openalex.org/W3177500196",
    "https://openalex.org/W3157437194",
    "https://openalex.org/W2980789587",
    "https://openalex.org/W2943495267",
    "https://openalex.org/W3146944767",
    "https://openalex.org/W2055950101",
    "https://openalex.org/W2104558532",
    "https://openalex.org/W3144239152",
    "https://openalex.org/W2102461176",
    "https://openalex.org/W2776525063",
    "https://openalex.org/W3034021988",
    "https://openalex.org/W2809247618",
    "https://openalex.org/W3042130878",
    "https://openalex.org/W3012522566",
    "https://openalex.org/W3136918052",
    "https://openalex.org/W2107158607",
    "https://openalex.org/W6676179870",
    "https://openalex.org/W2047663485",
    "https://openalex.org/W2125079066",
    "https://openalex.org/W3095583226",
    "https://openalex.org/W6784891704",
    "https://openalex.org/W591376238",
    "https://openalex.org/W3121116873",
    "https://openalex.org/W2074231493",
    "https://openalex.org/W2170747616",
    "https://openalex.org/W1975304761",
    "https://openalex.org/W2038605297",
    "https://openalex.org/W2109553965",
    "https://openalex.org/W2036966741",
    "https://openalex.org/W2059185913"
  ],
  "abstract": "Abstract Signal peptides (SPs) are short amino acid sequences that control protein secretion and translocation in all living organisms. SPs can be predicted from sequence data, but existing algorithms are unable to detect all known types of SPs. We introduce SignalP 6.0, a machine learning model that detects all five SP types and is applicable to metagenomic data.",
  "full_text": "Brief CommuniCation\nhttps:/ / doi.org/10.1038/s41587-021-01156-3\n1Section for Bioinformatics, Department of Health T echnology, T echnical University of Denmark, Kongens Lyngby, Denmark. 2Department of Biosystems \nScience and Engineering, ETH Zurich, Basel, Switzerland. 3Novo Nordisk Foundation Center for Protein Research, Faculty of Health and Medical \nSciences, University of Copenhagen, Copenhagen, Denmark. 4Department of Computer Science, Stanford University, Stanford, CA, USA. 5Center for \nGenomic Medicine, Rigshospitalet (Copenhagen University Hospital), Copenhagen, Denmark. 6EMBL-EBI, Wellcome Genome Campus, Cambridge, \nUK. 7Department of Biology, Bioinformatics Centre, University of Copenhagen, Copenhagen, Denmark. 8Section for Cognitive Systems, Department of \nApplied Mathematics and Computer Science, T echnical University of Denmark, Kongens Lyngby, Denmark. 9Department of Biochemistry and Biophysics, \nStockholm University, Stockholm, Sweden. 10Science for Life Laboratory, Stockholm University, Solna, Sweden. ✉e-mail: henni@dtu.dk\nSignal peptides (SPs) are short amino acid sequences that \ncontrol protein secretion and translocation in all living organ-\nisms. SPs can be predicted from sequence data, but existing \nalgorithms are unable to detect all known types of SPs. We \nintroduce SignalP 6.0, a machine learning model that detects \nall five SP types and is applicable to metagenomic data.\nSPs are short N-terminal amino acid sequences that target pro -\nteins to the secretory (Sec) pathway in eukaryotes and for trans -\nlocation across the plasma (inner) membrane in prokaryotes. As \ncomprehensive experimental identification of SPs is impractical, \ncomputational prediction of SPs has high relevance to research in \ncell biology\n1. SP prediction tools enable identification of proteins \nthat follow the general secretory or twin-arginine translocation \n(Tat) pathway and predict the position in the sequence where a sig-\nnal peptidase (SPase) cleaves the SP 2,3. SignalP 5.0 is able to pre -\ndict Sec substrates cleaved by SPase I (Sec/SPI) or SPase II (Sec/\nSPII, prokaryotic lipoproteins) and Tat substrates cleaved by SPase \nI (Tat/SPI)\n4. However, due to a lack of annotated data, SignalP 5.0 is \nunable to detect Tat substrates cleaved by SPase II or Sec substrates \nprocessed by SPase III (prepilin peptidase, sometimes referred to as \nSPase IV\n2). Such Sec/SPIII SPs control the translocation of type IV \npilin-like proteins, which play a key role in adhesion, motility and \nDNA uptake in prokaryotes5. Furthermore, SignalP 5.0 is agnostic \nregarding the SP structure, as it cannot define the subregions (the \nN-terminal n-region, the hydrophobic h-region, and the C-terminal \nc-region) that underlie the biological function of SPs.\nHere, we present SignalP 6.0, based on protein language models \n(LMs)\n6–9 that use information from millions of unannotated protein \nsequences across all domains of life. LMs create semantic represen-\ntations of proteins that capture their biological properties and struc-\nture. Using these protein representations, SignalP 6.0 can predict \nadditional types of SPs that previous versions have been unable to \ndetect while better extrapolating to both proteins distantly related to \nthose used to create the model and metagenomic data of unknown \norigin. In addition, it is capable of identifying the subregions of SPs.\nWe compiled a comprehensive dataset of protein sequences \nthat are known to harbor SPs, containing 3,352 Sec/SPI, 2,261 \nSec/SPII, 113 Sec/SPIII, 595 Tat/SPI, 36 Tat/SPII, 16,421 intracel\n-\nlular sequences and 2,615 transmembrane sequences (Methods). \nMoreover, we defined region-labeling rules according to known \nproperties of the SP types (Fig. 1a and Methods). We applied \nthreefold nested cross-validation to train and evaluate the model \n(Methods and Supplementary Note 1). In our data-partitioning pro\n-\ncedure, we ensured that homologous sequences were placed in the \nsame partition to accurately measure the model’s performance on \nunseen sequences.\nFor previous predictors, the SP types Sec/SPIII and Tat/SPII were \nomitted due to a lack of annotated samples, which makes learning \ntheir defining features challenging for models\n4. Notably, this lack \ndoes not correspond to prevalence in nature, as these types exist \nthroughout most organisms present in the databases\n10,11. In addi -\ntion, the available annotated sequences do not cover the full diver -\nsity encountered in nature, as they are biased towards well-studied \norganisms. Furthermore, existing predictors require data for which \nthe organism of origin is known, as this allows the predictors to \nexplicitly account for known differences in SP structure among \nEukarya, Archaea and Gram-positive and Gram-negative bacteria.\nProtein LMs have been shown to improve performance on prob\n-\nlems with limited annotated data12. Moreover, LM protein represen-\ntations directly capture the evolutionary context of a sequence6,8. We \nhypothesized that when using an LM, we would (1) obtain better per-\nformance on SP types with limited data availability, (2) achieve bet-\nter generalization to sequences that are distantly related to training \nsequences and (3) enable the prediction of sequences for which the \nspecies of origin is unknown. We opted for the bidirectional encoder \nrepresentations from transformers (BERT) protein LM, which \nis available in ProtTrans\n6,7 and was trained on UniRef100 (ref. 13)  \n(Fig. 1b). The LM was subsequently optimized on our dataset to \npredict SPs. We found that even before optimization, the LM cap -\ntured the presence of SPs in its protein representations (Fig. 1c).  \nWe combined the LM with a conditional random field (CRF) proba-\nbilistic model14 to predict the SP region at each sequence position \ntogether with the SP type, yielding the SignalP 6.0 architecture  \n(Fig. 1d).\nAs the baseline for evaluation, we retrained SignalP 5.0 on our \nnew dataset. We measure performance for each SP type sepa -\nrately per organism group (Archaea, Eukarya, Gram-positive and \nGram-negative bacteria), reporting the Matthews correlation coeffi\n-\ncient (MCC) for correctly detecting the SP type among both non-SP \nand other types of sequences as negative samples. For all categories \nSignalP 6.0 predicts all five types of signal \npeptides using protein language models\nFelix T eufel   1,2, José Juan Almagro Armenteros   3, Alexander Rosenberg Johansen4, \nMagnús Halldór Gíslason5, Silas Irby Pihl1, Konstantinos D. T sirigos   6, Ole Winther   5,7,8, \nSøren Brunak   3, Gunnar von Heijne   9,10 and Henrik Nielsen   1 ✉\nNATuRe BIOTecHNOlOGy | VOL 40 | JULy 2022 | 1023–1025 | www.nature.com/ naturebiotechnology 1023\nBrief CommuniCation Nature BiotechNology\nexcept Tat/SPI in Archaea, SignalP 6.0 showed improved perfor -\nmance. Detection performance improved substantially, especially \nfor the two underrepresented types, Sec/SPIII and Tat/SPII (Fig. \n2a and Supplementary Fig. 1), whereas the performance of SignalP \n5.0 remained too low to make it practically useful. This confirms \nthe importance of LMs for low-data problems, making SignalP 6.0 \nSec/SPI\na\nSec/SPII\nSec/SPIII\nTat/SPI\nTat/SPII\nN C M\nM\nA\nN\nL\n...\nY\nG\nL\nSec\nSPI\nN N N H H H H H H H H H H H H H H H C C C O O O O O OC C C\nSec\nSPII\nTat\nSPII None\nOther\nNone\nSec/SPI\nSec/SPII\nt-SNE 1\nt-SNE 2\nSec/SPIIITat/SPI\nTat/SPII\n1.0\n0.5\n0\nProbability\nSec\nSPIII\nTat\nSPI\nA A S\nBERT language model\nBERT language model\nConditional random field\nSemantic protein representation\nSemantic protein\nrepresentation\nL N – K R A\nA\n0.11 0.23 0.01\nV ...\n...\nR\nC\nUniRef100\nC\nC\nC\nn-Region\nn-Region\nh-Region\nc-Region\nCS\nh-Region c-Region Mature protein\nMature protein\nMature protein\nMature protein\nMature protein\nc-Region\nLipobox\nLipobox\nh-Region\nh-Region\nh-RegionRR\nRR\nn-Region\nn-Region\nn-Region\nBasic region\nN\nN\nN\nN\nb\nd c\nFig. 1 | Modeling SP structure using protein lMs. a, Region structures of the five SP types. T win arginine (RR)-translocated SPs feature a twin-arginine \nmotif, while SPs cleaved by SPase II feature a C-terminal lipobox. Sec/SPIII SPs have no substructure. b, Protein LM training procedure. BERT learns protein \nfeatures by predicting masked amino acids in sequences from UniRef100. c, t-Distributed stochastic neighbor embedding (t-SNE) projection of protein \nrepresentations before prediction training. Different SP types form distinct clusters, separated from sequences without SPs. d, SignalP 6.0 architecture. An \namino acid sequence is passed through the LM, and the resulting representation serves as input for the CRF, which predicts region probabilities at each \nposition and the SP type. CS, cleavage site.\n1.0\na\nArchaea Sec/SPI\nPrecision Recall\nArchaea Sec/SPII\nArchaea Sec/SPIII\nArchaea Tat/SPI\nArchaea Tat/SPII\nEukarya Sec/SPI\nNegative Sec/SPI\nNegative Sec/SPII\nNegative Sec/SPIII\nNegative Tat/SPI\nNegative Tat/SPII\nPositive Sec/SPI\nPositive Sec/SPII\nPositive Sec/SPIII\nPositive Tat/SPI\nPositive Tat/SPII\n1.0 0.5 0 0.5 1.0\n0.8\n0.6\n0.4\nMCC (one versus all)\n0.2\n0\n1.0\n0.9\n20 30 40 50\nMaximum identity to training set (%)\n60 70 80 90\nSignalP 5.0\nSignalP 6.0\nMCC (multiclass)\nARC\nSec/SPI\nARC\nSec/SPII\nARC\nSec/SPIII\nARC\nTat/SPI\nARC\nTat/SPII\nEUK\nSec/SPI\nNEG\nSec/SPI\nNEG\nSec/SPII\nNEG\nSec/SPIII\nNEG\nTat/SPI\nNEG\nTat/SPII\nPOS\nSec/SPII\nPOS\nSec/SPI\nPOS\nSec/SPIII\nPOS\nTat/SPI\nPOS\nTat/SPII\nb\nc\nFig. 2 | SignalP 6.0 shows strong performance on all types and organism groups. a, SP detection performance (ARC, Archaea; EUK, Eukarya; NEG, \nGram-negative bacteria; POS, Gram-positive bacteria). SignalP 6.0 substantially improves performance on underrepresented types. b, CS prediction \nperformance. SignalP 6.0 has improved precision for all categories. c, Dependence of performance on identity to sequences in the training data. At \nsequence identities lower than 60%, SignalP 6.0 outperforms SignalP 5.0.\nNATuRe BIOTecHNOlOGy | VOL 40 | JULy 2022 | 1023–1025 | www.nature.com/ naturebiotechnology1024\nBrief CommuniCationNature BiotechNology\na model capable of simultaneously detecting all five types of SPs. In \naddition, we found substantial precision gains for predicting cleav-\nage sites (CSs) (Fig. 2b).\nWe further benchmarked SignalP 6.0 against other publicly \navailable predictors. In some cases, specialized predictors show \nstronger performance on the specific tasks they were optimized \nfor (Supplementary Figs. 2 and 3 and Supplementary Tables 1–6). \nHowever, none of these predictors are capable of detecting all SP \ntypes, and the results are further biased, as they cannot be evaluated \nin a cross-validated setup.\nWhen predicting a set of test sequences grouped by identity to \nany sequence in the training data, we find that detection perfor\n-\nmance at high sequence identities remained comparable. However, \nat identities lower than 60%, SignalP 6.0 outperformed SignalP 5.0, \nshowing better generalization to proteins distantly related to those \npresent in the training data (Fig. 2c).\nMost SP predictors require knowledge of a sequence’s organism \ngroup of origin for optimal performance\n4,15,16. SignalP 6.0 does not \nshow reduced performance if this information is removed, indicat-\ning that the evolutionary context, as encoded in the LM representa-\ntion, already captures the organism group (Supplementary Fig. 4). \nUltimately, this makes SignalP 6.0 a multiclass SP prediction tool \nthat is applicable to sequences of unknown origin, as is typically the \ncase in metagenomic and metatranscriptomic assemblies. However, \nSignalP 6.0 still relies on start codons being correctly identified \nbefore application. For context, 1.7% of UniProt release 2021_02 \nentries (i.e., 3.5 million sequences) have no organism specified.\nSPs are traditionally described as consisting of three regions. \nWe benchmarked our region identification by comparing the \nproperties of predicted regions to known properties\n17, with pre -\ndictions matching all expected properties (Supplementary Note 2 \nand Supplementary Fig. 5). We additionally predicted a library of \nsynthetic SPs that are either functional or nonfunctional in Bacillus \nsubtilis\n18, revealing significant differences in the two groups’ regions \nthat could not be identified before by traditional sequence analysis \n(Supplementary Fig. 6 and Supplementary Table 7).\nThis study presents SignalP 6.0, a machine learning model \ncovering all five known types of SPs that accurately predicts both \nsequences of unknown origin and evolutionarily distant proteins. \nThrough the use of protein LMs, SignalP 6.0 is able to predict types \nwith very limited training data available. By making the full spec\n-\ntrum of SPs accessible, the model allows us to further improve \nour understanding of protein translocation throughout evolution \n(Supplementary Note 3 and Supplementary Tables 8 and 9). In \naddition, identification of SP regions opens up new avenues into \nresearching the defining properties that govern SP functionality. \nGiven the potential of SPs as drug targets\n19 and their emerging role \nin synthetic biology18, investigating SPs and their properties at scale \nmay lead to further advances in these fields.\nOnline content\nAny methods, additional references, Nature Research report -\ning summaries, source data, extended data, supplementary infor -\nmation, acknowledgements, peer review information; details of \nauthor contributions and competing interests; and statements of \ndata and code availability are available at https://doi.org/10.1038/\ns41587-021-01156-3.\nReceived: 22 June 2021; Accepted: 8 November 2021;  \nPublished online: 3 January 2022\nReferences\n 1. Nielsen, H., Tsirigos, K. D., Brunak, S. & von Heijne, G. A brief history of \nprotein sorting prediction. Protein J. 38, 200–216 (2019).\n 2. Dalbey, R. E., Wang, P . & van Dijl, J. M. Membrane proteases in the bacterial \nprotein secretion and quality control pathway. Microbiol. Mol. Biol. Rev. 76, \n311–330 (2012).\n 3. Pohlschroder, M., Pfeiffer, F ., Schulze, S. & Halim, M. F . A. Archaeal cell \nsurface biogenesis. FEMS Microbiol. Rev. 42, 694–717 (2018).\n 4. Almagro Armenteros, J. J. et al. SignalP 5.0 improves signal peptide \npredictions using deep neural networks. Nat. Biotechnol.  37, 420–423 (2019).\n 5. Craig, L., Forest, K. T. & Maier, B. Type IV pili: dynamics, biophysics and \nfunctional consequences. Nat. Rev. Microbiol. 17, 429–440 (2019).\n 6. Elnaggar, A. et al. ProtTrans: towards cracking the language of life’s code \nthrough self-supervised learning. Trans. Pattern Anal. Mach. Intell.  \nhttps://pubmed.ncbi.nlm.nih.gov/34232869/ (2021).\n 7. Dallago, C. et al. Learned embeddings from deep learning to visualize and \npredict protein sets. Curr. Protoc. 1, e113 (2021).\n 8. Alley, E. C., Khimulya, G., Biswas, S., AlQuraishi, M. & Church, G. M. \nUnified rational protein engineering with sequence-based deep representation \nlearning. Nat. Methods 16, 1315–1322 (2019).\n 9. Rives, A. et al. Biological structure and function emerge from scaling \nunsupervised learning to 250 million protein sequences. Proc. Natl Acad. Sci. \nUSA 118, e2016239118 (2021).\n 10. Storf, S. et al. Mutational and bioinformatic analysis of haloarchaeal \nlipobox-containing proteins. Archaea 2010, 410975 (2010).\n 11. Hutchings, M. I., Palmer, T., Harrington, D. J. & Sutcliffe, I. C. Lipoprotein \nbiogenesis in Gram-positive bacteria: knowing when to hold ‘em, knowing \nwhen to fold ‘em. Trends Microbiol. 17, 13–21 (2009).\n 12. Biswas, S., Khimulya, G., Alley, E. C., Esvelt, K. M. & Church, G. M. Low-N \nprotein engineering with data-efficient deep learning. Nat. Methods  18, \n389–396 (2021).\n 13. Suzek, B. E., Wang, Y ., Huang, H., McGarvey, P . B. & Wu, C. H. UniRef \nclusters: a comprehensive and scalable alternative for improving sequence \nsimilarity searches. Bioinformatics 31, 926–932 (2015).\n 14. Lafferty, J. D., McCallum, A. & Pereira, F . C. N. In Proc. 18th International \nConference on Machine Learning (eds. Brodley, C.E. & Danyluk, A.P .) 282–289 \n(Morgan Kaufmann Publishers, 2001).\n 15. Savojardo, C., Martelli, P . L., Fariselli, P . & Casadio, R. DeepSig: deep  \nlearning improves signal peptide detection in proteins. Bioinformatics  34, \n1690–1696 (2018).\n 16. Zhang, W .-X., Pan, X. & Shen, H.-B. Signal-3L 3.0: improving signal peptide \nprediction through combining attention deep learning with window-based \nscoring. J. Chem. Inf. Model. 60, 3679–3686 (2020).\n 17. Owji, H., Nezafat, N., Negahdaripour, M., Hajiebrahimi, A. & Ghasemi, Y . A \ncomprehensive review of signal peptides: structure, roles, and applications. \nEur. J. Cell Biol. 97, 422–441 (2018).\n 18. Wu, Z. et al. Signal peptides generated by attention-based neural networks. \nACS Synth. Biol. 9, 2154–2161 (2020).\n 19. Lumangtad, L. A. & Bell, T. W . The signal peptide as a new target for drug \ndesign. Bioorg. Med. Chem. Lett. 30, 127115 (2020).\nPublisher’s note Springer Nature remains neutral with regard to jurisdictional claims in \npublished maps and institutional affiliations.\nOpen Access This article is licensed under a Creative Commons \nAttribution 4.0 International License, which permits use, sharing, adap-\ntation, distribution and reproduction in any medium or format, as long \nas you give appropriate credit to the original author(s) and the source, provide a link to \nthe Creative Commons license, and indicate if changes were made. The images or other \nthird party material in this article are included in the article’s Creative Commons license, \nunless indicated otherwise in a credit line to the material. If material is not included in \nthe article’s Creative Commons license and your intended use is not permitted by statu-\ntory regulation or exceeds the permitted use, you will need to obtain permission directly \nfrom the copyright holder. To view a copy of this license, visit http://creativecommons.\norg/licenses/by/4.0/.\n© The Author(s) 2022\nNATuRe BIOTecHNOlOGy | VOL 40 | JULy 2022 | 1023–1025 | www.nature.com/ naturebiotechnology 1025\nBrief CommuniCation Nature BiotechNology\nMethods\nSequence data. The dataset for SignalP 6.0 was obtained by extending the data \npublished with SignalP 5.0 (ref. 4). For all classes that were already part of the \noriginal data (Sec/SPI, Sec/SPII, Tat/SPI and soluble and transmembrane proteins), \nwe added sequences that had become available in the respective source databases \n(UniProt20 and Prosite21 for SPs and UniProt and TOPDB22 for soluble and \ntransmembrane proteins) from 2018 until 7 November 2020, following the original \nselection criteria.\nTat/SPII sequences were identified using the combination of Prosite profiles \nPS51318 (Tat motif) and PS51257 (lipoprotein motif). By default, PS51318 is \nsubject to postprocessing that prevents both profiles from matching the same \nsequence. As there is experimental evidence for the existence of Tat-translocated \nlipoproteins\n10,11, we considered this postprocessing rule to be biologically \nimplausible. We disabled it manually in ScanProsite23 and scanned all prokaryotic \nsequences in Swiss-Prot, yielding a total of 25 sequences in which both profiles \nmatched. Additional Tat/SPII sequences were found by training a simplified \nSignalP 6.0 model to discriminate SPII from non-SP sequences. We used this \nmodel to predict all Tat/SPI sequences in the training data, as we assumed that \nPS51257 is not sensitive enough to find all lipoproteins. We investigated the \nresulting hits in UniProt for supporting evidence that the proteins were true \nlipoproteins, yielding 12 sequences that we relabeled Tat/SPII from Tat/SPI. One \nadditional sequence with manual evidence was found in the TatLipo 1.03 training \ndata\n10. For Sec/SPIII sequences, we used Prosite pattern PS00409 for bacteria and \nPfam24 family PF04021 for Archaea, yielding 103 and 10 sequences, respectively.\nWe improved the organism type classification of sequences by defining \nGram-negative and Gram-positive bacteria more stringently, as we found that for \nedge cases such as Thermotogae, in which both gram stains can be observed25, \nthe classification in SignalP 5.0 was unclear. We redefined Gram positive as \nall bacterial phyla that have a single membrane (monoderm): Actinobacteria, \nFirmicutes, Tenericutes, Thermotogae, Chloroflexi and Saccharibacteria.  \nAll remaining phyla have a double membrane (diderm) and were classified as \nGram negative.\nWe followed the methodology introduced by Gíslason et al.\n26 for homology \npartitioning of the dataset into three partitions at 30% sequence identity. In brief, \nit achieves partitioning by computing the pairwise global sequence identities of all \nsequences using the Needleman–Wunsch algorithm\n27, followed by single-linkage \nclustering. The resulting clusters were grouped together into the desired number of \npartitions. If there were sequences in a partition that had pairwise identities to any \nsequence in another partition that were higher than the defined threshold, then \nthose sequences were iteratively removed until the maximum sequence identity \ncriterion was fulfilled. We performed the partitioning procedure separately for each \nSP type and the negative set, yielding three partitions for each of the six classes. \nThe algorithm was further constrained to ensure that each generated partition \nwas balanced for the four organism groups. We concatenated the resulting 3 × 6 \npartitions to yield the three final partitions for cross-validation, thereby ensuring \nthat both the SP types and the organism groups were equally represented across \npartitions.\nThe CD-HIT clustering method\n28 that was employed in SignalP 5.0 enforces \nthe homology threshold for cluster centers. However, as the training set was not \nhomology reduced but rather homology clustered, other data points can have a \nhomology overlap notably above the chosen threshold of 20% (Supplementary  \nFig. 7). When using the partitioning method of Gíslason et al., which strictly \nenforces the defined threshold, 20% maximum identity was impossible to achieve. \nEven at the relaxed threshold of 30%, the procedure resulted in the removal \nof a substantial part of the dataset to achieve separation in three partitions \n(Supplementary Table 10).\nFor benchmarking, we reused the benchmark set of SignalP 5.0, from which we \nexcluded all sequences that were removed in the homology partitioning procedure \nof the new dataset. For sequences that were reclassified (to Gram positive or Tat/\nSPII), we changed the label accordingly (Supplementary Table 11).\nFor the synthetic SP dataset, we used the data reported by Wu et al.\n18. \nWe gathered all synthetic SP-mature protein pairs that were experimentally \ncharacterized, yielding 57 nonfunctional and 52 functional sequences. For the \nregion analysis, we only considered sequences predicted as Sec/SPI SPs by SignalP \n6.0, reducing the number of nonfunctional sequences to 55.\nReference proteomes and proteins of unknown origin were obtained from \nUniProt release 2021_02. To identify sequences of unknown origin, we used \ntaxonomy identifiers 48479 (environmental samples), 49928 (unclassified bacteria) \nand 2787823 (unclassified entries).\nGeneration of SP region labels. We defined the task of learning SP regions as a \nmultilabel classification problem at each sequence position. Multilabel differs from \nmulticlass in the sense that more than one label can be true at a given position. \nThis approach was motivated by the fact that there is no strict definition of \nregion borders that is commonly agreed upon, making it impossible to establish \nground-truth region labels for models to train on. We thus used the multilabel \nframework as a method for training with weak supervision, allowing us to use \noverlapping region labels during the learning phase that could be generated from \nthe sequence data using rules. For inference, we did not make use of the multilabel \nframework, as we only predicted the single most probable label at each position \nusing Viterbi decoding, yielding a single unambiguous solution.\nWe defined a set of three rules based on known properties of the n-, h-, and \nc-regions. The initial n-region must have a minimum length of two residues and \nthe terminal c-region a minimum length of three residues. The most hydrophobic \nposition, which is identified by sliding a seven-amino-acid window across the SP \nand computing the hydrophobicity using the Kyte–Doolittle scale\n29, belongs to the \nh-region. All positions between these six labeled positions are labeled as either \nboth n and h or h and c, yielding multitag labels.\nThis procedure was adapted for different SP classes, with only Sec/SPI \ncompletely following it. For Tat SPs, the n–h border was identified using the \ntwin-arginine motif. All positions before the motif were labeled n, followed by \ntwo dedicated labels for the motif, again followed by a single position labeled \nn. For SPII SPs, we did not label a c-region, as the C-terminal positions cannot \nbe considered as such30. The last three positions were labeled as the lipobox, all \npositions before that as h only. For SPIII SPs, no region labels were generated \nwithin the SP .\nModeling. SignalP 6.0 uses a pretrained protein LM to encode the amino acid \nsequence and a CRF\n14 decoder to predict the regions, CSs and sequence class labels. \nSpecifically, we used the 30-layer BERT LM 31 that is available in ProtTrans6, which \nwas pretrained on UniRef100 (ref. 13). We removed the last layer of the pretrained \nmodel and extended the pretrained embedding layer by four additional randomly \ninitialized vectors to represent the tokens for the four organism group identifiers. \nWe prepend the organism group identifier to each sequence s of length T and \nencode it. From the resulting sequence of hidden states, we trim the positions \ncorresponding to the organism group token and the special sequence start and end \ntokens used by BERT (CLS and SEP) to obtain a sequence of hidden states h of \nequal length as the original amino acid input x:\nh = BERT(x).\nThe hidden states serve as input for a linear-chain CRF . The CRF models the \nconditional probability of a sequence of states y = y1...yt given a sequence of \nhidden states h = h1...ht using the following factorization:\nP(y|h)= 1\nZ(h)\nT∏\nt=1\nexp(ψ(ht))\nT−1∏\nt=1\nexp(φyt,yt+1 ),\nwhere Z(h) is the normalization constant of the modeled distribution; φ is the \nlearnable transition matrix of the CRF with C × C parameters, with C being \nthe number of states (labels) modeled by the CRF; and ψ is a learnable linear \ntransformation that maps from the dimension of the hidden state h to the number \nof CRF states C, yielding the emissions for the CRF:\nψ(ht)= Wψht + bψ.\nFor each class of SP G, there are multiple possible CRF states, corresponding \nto the defined regions of the SP class. We constrained the transitions in φ to \nensure that regions are predicted in the correct order, leading to the possible state \nsequences depicted in Supplementary Fig. 8.\nFor inference, we compute both the most probable state sequence (using \nViterbi decoding) and the marginal probabilities at all sequence positions (using \nthe forward-backward algorithm). The most probable state sequence is used to \npredict the CS, which is inferred from the last predicted SP state as indicated in \nSupplementary Fig. 8.\nAs each SP consists of multiple regions, multiple states of C belong to a single \nglobal sequence class G. To predict the global class probabilities, we sum the \nmarginal probabilities of all states that belong to a given class and divide the sum \nby the sequence length. This transforms a matrix of probabilities of shape C × T to \na G × 1 vector of global class probabilities:\np(Gi|x)= 1\nT\nT∏\nt=1\n∑\nC∈Gi\np(yCt|x).\nTraining. For training, we minimize the negative log likelihood of the CRF . As \nwe can have multiple true labels y\nt at a given position, we use an extension of the \nequation known as multitag CRF . Multiple labels are handled by summing over the \nset of true labels Mt at each position:\n− log(P(y|h)) =log(Z(h))− log\n\nexp\n\n\nT∑\nt=1\n∑\nyt∈Mt\nψ (ht)+ φ(yt,yt−1)\n\n\n\n.\nAs we designed our region labels to be overlapping, the model is free to \ndistribute its probability mass in any ratio between the correct labels at a given \nposition. There are thus multiple solutions for the specific borders of n-, h- and c- \nregions that yield the same negative log likelihood but are not equally biologically \nNATuRe BIOTecHNOlOGy | www.nature.com/ naturebiotechnology\nBrief CommuniCationNature BiotechNology\nplausible. For instance, the model could learn a solution where it uniformly \npredicts an n-region of length 2 in all SPs, irrespective of the actual sequence. We \nemploy regularization to promote the finding of biologically plausible solutions. \nOur regularization is based on the fact that the three SP regions have divergent \namino acid compositions, which we can quantify by computing the cosine \nsimilarity between the amino acid distributions.\nThe most obvious approach would be to compute the amino acid distribution \nof each region based on the region borders inferred from the predicted most \nprobable path of the sequence. This, however, cannot be used for regularization, \nas we require the term to be differentiable, which our Viterbi decoding \nimplementation is not. We therefore based our regularization term on the marginal \nprobabilities of the CRF computed by the forward-backward algorithm, which are \nused to compute a score for each amino acid for each region, approximating the \ndiscrete amino acid distributions.\nFor each region \nr ∈{ n,h,c }, we sum the marginal probabilities of all CRF \nstates c belonging to region r at position t, yielding st,r. We sum st,r of all positions \nt of the sequence that have amino acid a, yielding the elements of the score vector \nscore\nr for each region. We compute the cosine similarity between the normalized \nscore vectors of n and h and h and c:\nst,r = ∑\nc∈r\np(yt,c|x)\nscorea,r = ∑\nt∈I\nst,r\nI = {t ∈ T|xt = a}\nscorer\n′ = scorer/\nA∑\na=1\nscorea,r\n.\nWe perform this operation for each sequence. Sequences for which a region \ndoes not exist (for example no c-region in Sec/SPII) are ignored for the respective \nsimilarity. The mean over all sequences for both similarities, multiplied by a factor \nα, was added to the loss. We observed that for about half the random seeds we \ntested, training runs with regularization enabled converged to a n-region length of \n2 after one epoch. This is a degenerate solution, as this causes the n-region amino \nacid distribution to be nonzero at a single position, yielding low similarity scores \nwhile being biologically implausible (a length of 2 is expected as the minimum, not \nthe average over all sequences). Such runs were stopped and discarded after one \nepoch.\nThe model was trained end-to-end, including all layers of BERT for 15 epochs, \nusing Adamax as the optimizer and a slanted triangular learning rate. We applied \ndropout on the hidden state outputs of BERT to avoid overfitting. Hyperparameters \nwere optimized using SigOpt (https://app.sigopt.com/docs/intro/overview). We \nemployed threefold nested cross-validation (outer loop is threefold and inner loop \nis twofold), yielding a total of 3 × 2 models for evaluation.\nEvaluation and benchmarking. For comparability, we employed the same \nmetrics that were used in SignalP 5.0. SP detection performance was measured \nusing the MCC\n32. We computed the MCC twice, once with the negative set \nonly consisting of transmembrane and soluble proteins (MCC1) and once with \nit additionally including sequences of all other SP types (MCC2). Most of the \ncompeting single-class predictors considered for benchmarking are optimized \nfor detecting their respective SP type in a dataset of true and non-SP (soluble \nand transmembrane) sequences; thus, MCC1 best captures their performance \non the task they were designed for. MCC2, on the other hand, includes the \nmore challenging task of discriminating between SP types, which is difficult for \nsingle-class predictors because of the structural similarity of different SP types. \nMCC2 represents the performance in most real-world applications, as the presence \nof a specific SP type usually cannot be ruled out a priori in a set of unknown \nprotein sequences. For CS prediction, we computed the precision and recall. \nPrecision was defined as the fraction of correct CS predictions over the number of \npredicted CSs, and recall was defined as the fraction of correct CS predictions over \nthe number of true CSs. In both cases, a CS was only considered correct if it was \npredicted in the correct SP class (e.g., when the model predicts a CS in a Sec/SPI \nsequence but predicts Sec/SPII as the sequence label, then the sample is considered \n‘no CS predicted’). To account for possible uncertainty of the CSs in the training \ndata labels, we additionally report these metrics with tolerance windows of one, \ntwo and three residues left and right of the true CS (Supplementary Tables 2, 4 and \n6).\nFor the predicted SP regions, in the absence of true labels, no quantitative \nperformance metrics could be established. To still be able to assess the quality \nof the predictions, we compared the properties of predicted regions with \ncharacteristics of regions that are described in the literature. We followed the \nreview by Owji et al.\n17 as a guideline to identify region characteristics. Specifically, \nwe evaluated the length, hydrophobicity and charge of each predicted region. \nHydrophobicities were computed using the Kyte–Doolittle scale\n29, and charges \nwere computed by summing the net charges at pH 7 of all residues. The net \ncharge computation differed between the groups, as in Eukarya and Archaea the \nN-terminal methionine is not formylated33, thus contributing an additional positive \ncharge to the n-region by its amino group.\nWe benchmarked our model against the state-of-the-art model SignalP 5.0, \nwhich was reimplemented in PyTorch. Hyperparameter optimization on the \nnew dataset was performed using SigOpt. We also repeated the benchmarking \nexperiment of SignalP 5.0 for all predictors using the adapted benchmark set. \nWe could not add Signal-3L 3.0\n16 to the experiment, as the implementation \nthat is available does not allow for processing of more than one sequence at a \ntime, rendering benchmarking intractable. Notably, predictions for all methods \nexcept for SignalP 5.0 and SignalP 6.0 were obtained from their publicly available \nweb services, resulting in potential performance overestimation due to the \nlack of homology partitioning. In addition, performance overestimation is still \npresent for the published version of SignalP 5.0 (named “SignalP 5.0 original” in \nSupplementary Tables 1–6 and Supplementary Figs. 1 and 2) due to insufficient \nhomology partitioning of its training data by CD-HIT. We thus excluded its values \nfrom determining the best-performing tools in the benchmark.\nTo assess the effect of sequence identity to training sequences on performance, \nwe used the set of sequences that were removed by the partitioning procedure. We \npredicted all sequences in the removed set and binned the sequences according to \nthe maximum sequence identity to any sequence in the training set. We did this \nfor all six cross-validated models and pooled the resulting binned predictions. For \neach bin, we computed the multiclass MCC as defined by Gorodkin\n34.\nReporting Summary. Further information on research design is available in the \nNature Research Reporting Summary linked to this article\nData availability\nThe datasets used for training and testing SignalP 6.0 can be downloaded from \nhttps://services.healthtech.dtu.dk/service.php?SignalP-6.0. The investigated \nreference proteomes are available from UniProt at https://www.uniprot.org/\nproteomes. The dataset of synthetic SPs was extracted from the supplementary \nmaterial of the original publication\n18 and is included in our GitHub repository.\ncode availability\nSignalP 6.0 is available at https://services.healthtech.dtu.dk/service.\nphp?SignalP-6.0. The web version of SignalP 6.0 is free for all users, while the \nstandalone Python package is free for academic users (and can be provided upon \nrequest) but is licensed for a fee to commercial users. The model source code in \nPyTorch 1.7 is available at https://github.com/fteufel/signalp-6.0.\nReferences\n 20. The UniProt Consortium. UniProt: a worldwide hub of protein knowledge. \nNucleic Acids Res. 47, D506–D515 (2019).\n 21. Sigrist, C. J. A. et al. New and continuing developments at PROSITE. Nucleic \nAcids Res. 41, D344–D347 (2013).\n 22. Dobson, L., Langó, T., Reményi, I. & Tusnády, G. E. Expediting topology  \ndata gathering for the TOPDB database. Nucleic Acids Res. 43,  \nD283–D289 (2015).\n 23. de Castro, E. et al. ScanProsite: detection of PROSITE signature matches and \nProRule-associated functional and structural residues in proteins. Nucleic \nAcids Res. 34, W362–W365 (2006).\n 24. Mistry, J. et al. Pfam: the protein families database in 2021. Nucleic Acids Res. \n49, D412–D419 (2021).\n 25. Bhandari, V . & Gupta, R. S. in The Prokaryotes: Other Major Lineages of \nBacteria and The Archaea (eds. Rosenberg, E., et al.) 989–1015 (Springer, \n2014).\n 26. Gíslason, M. H., Nielsen, H., Almagro Armenteros, J. J. & Johansen, A. R. \nPrediction of GPI-anchored proteins with pointer neural networks. Curr. Res. \nBiotechnol. 3, 6–13 (2021).\n 27. Needleman, S. B. & Wunsch, C. D. A general method applicable to the search \nfor similarities in the amino acid sequence of two proteins. J. Mol. Biol. 48, \n443–453 (1970).\n 28. Fu, L., Niu, B., Zhu, Z., Wu, S. & Li, W . CD-HIT: accelerated for clustering \nthe next-generation sequencing data. Bioinformatics 28, 3150–3152 (2012).\n 29. Kyte, J. & Doolittle, R. F . A simple method for displaying the hydropathic \ncharacter of a protein. J. Mol. Biol. 157, 105–132 (1982).\n 30. von Heijne, G. The signal peptide. J. Membr. Biol. 115, 195–201 (1990).\n 31. Devlin, J., Chang, M.-W ., Lee, K. & Toutanova, K. BERT: pre-training of deep \nbidirectional transformers for language understanding. Preprint at http://\narxiv.org/abs/1810.04805 (2019).\n 32. Matthews, B. W . Comparison of the predicted and observed secondary \nstructure of T4 phage lysozyme. Biochim. Biophys. Acta BBA - Protein Struct. \n405, 442–451 (1975).\n 33. Ramesh, V . & RajBhandary, U. L. Importance of the anticodon sequence in \nthe aminoacylation of tRNAs by methionyl-tRNA synthetase and by \nvalyl-tRNA synthetase in an Archaebacterium. J. Biol. Chem. 276, 3660–3665 \n(2001).\n 34. Gorodkin, J. Comparing two K-category assignments by a K-category \ncorrelation coefficient. Comput. Biol. Chem. 28, 367–374 (2004).\nNATuRe BIOTecHNOlOGy | www.nature.com/ naturebiotechnology\nBrief CommuniCation Nature BiotechNology\nAcknowledgements\nJ.J.A.A. and S.B. were supported by the Novo Nordisk Foundation (grants \nNNF14CC0001 and NNF17OC0027594). O.W . was funded in part by the Novo Nordisk \nFoundation through the Center for Basic Machine Learning Research in Life Science \n(grant NNF20OC0062606). G.v.H. was supported by the Knut and Alice Wallenberg \nFoundation (grant 2017.0323), the Novo Nordisk Foundation (grant NNF18OC0032828) \nand the Swedish Research Council (grant 621-2014-3713).\nAuthor contributions\nF .T. collected the datasets, implemented the SignalP 6.0 model and performed the \nexperiments with help from J.J.A.A. and A.R.J. S.I.P . implemented the multitask CRF \nand developed the Sec/SPI labeling procedure. M.H.G. provided the partitioning code \nand guided its application. K.D.T., O.W ., S.B. and G.v.H. provided suggestions during \nthe design of SignalP 6.0. J.J.A.A., A.R.J. and H.N. supervised and guided the project. All \nauthors edited and approved the manuscript.\ncompeting interests\nThe downloadable version of SignalP 6.0 has been commercialized (it is licensed for a fee \nto commercial users). The revenue from these commercial sales is divided between the \nprogram developers and the Technical University of Denmark.\nAdditional information\nSupplementary information The online version contains supplementary material \navailable at https://doi.org/10.1038/s41587-021-01156-3.\nCorrespondence and requests for materials should be addressed to Henrik Nielsen.\nPeer review information Nature Biotechnology thanks Rita Casadio and the other, \nanonymous, reviewer(s) for their contribution to the peer review of this work.\nReprints and permissions information is available at www.nature.com/reprints.\nNATuRe BIOTecHNOlOGy | www.nature.com/ naturebiotechnology\n\n",
  "topic": null,
  "concepts": []
}