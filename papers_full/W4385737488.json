{
    "title": "Genome-wide prediction of disease variant effects with a deep protein language model",
    "url": "https://openalex.org/W4385737488",
    "year": 2023,
    "authors": [
        {
            "id": "https://openalex.org/A4287148091",
            "name": "Brandes, Nadav",
            "affiliations": [
                "University of California, San Francisco"
            ]
        },
        {
            "id": null,
            "name": "Goldman, Grant",
            "affiliations": [
                "University of California, San Francisco"
            ]
        },
        {
            "id": null,
            "name": "Wang, Charlotte H.",
            "affiliations": [
                "University of California, San Francisco"
            ]
        },
        {
            "id": "https://openalex.org/A4294536473",
            "name": "Ye, Chun Jimmie",
            "affiliations": [
                "Parker Institute for Cancer Immunotherapy",
                "Gladstone Institutes",
                "University of California, San Francisco"
            ]
        },
        {
            "id": "https://openalex.org/A4299782434",
            "name": "Ntranos, Vasilis",
            "affiliations": [
                "University of California, San Francisco"
            ]
        },
        {
            "id": "https://openalex.org/A4287148091",
            "name": "Brandes, Nadav",
            "affiliations": [
                "University of California, San Francisco"
            ]
        },
        {
            "id": null,
            "name": "Goldman, Grant",
            "affiliations": [
                "University of California, San Francisco"
            ]
        },
        {
            "id": null,
            "name": "Wang, Charlotte H.",
            "affiliations": [
                "University of California, San Francisco"
            ]
        },
        {
            "id": "https://openalex.org/A4294536473",
            "name": "Ye, Chun Jimmie",
            "affiliations": [
                "Gladstone Institutes",
                "University of California, San Francisco",
                "Parker Institute for Cancer Immunotherapy"
            ]
        },
        {
            "id": "https://openalex.org/A4299782434",
            "name": "Ntranos, Vasilis",
            "affiliations": [
                "University of California, San Francisco"
            ]
        }
    ],
    "references": [
        "https://openalex.org/W3195230255",
        "https://openalex.org/W2051978340",
        "https://openalex.org/W3010305620",
        "https://openalex.org/W3209435229",
        "https://openalex.org/W2901303766",
        "https://openalex.org/W2119412782",
        "https://openalex.org/W1844405070",
        "https://openalex.org/W3184953764",
        "https://openalex.org/W3216782976",
        "https://openalex.org/W2174602966",
        "https://openalex.org/W2987965949",
        "https://openalex.org/W4206229719",
        "https://openalex.org/W2331911623",
        "https://openalex.org/W2245592118",
        "https://openalex.org/W2143238378",
        "https://openalex.org/W2905452503",
        "https://openalex.org/W2472351724",
        "https://openalex.org/W3144701084",
        "https://openalex.org/W3146944767",
        "https://openalex.org/W3040739508",
        "https://openalex.org/W2999481648",
        "https://openalex.org/W2980789587",
        "https://openalex.org/W4205773061",
        "https://openalex.org/W3179485843",
        "https://openalex.org/W2010595044",
        "https://openalex.org/W2982247245",
        "https://openalex.org/W966012335",
        "https://openalex.org/W2110646848",
        "https://openalex.org/W2161317138",
        "https://openalex.org/W2017730572",
        "https://openalex.org/W3107322429",
        "https://openalex.org/W1502061430",
        "https://openalex.org/W2078663610",
        "https://openalex.org/W2155570392",
        "https://openalex.org/W2043416934",
        "https://openalex.org/W2025570007",
        "https://openalex.org/W2144761225",
        "https://openalex.org/W2279930231",
        "https://openalex.org/W2036681136",
        "https://openalex.org/W2055996155",
        "https://openalex.org/W2570257422",
        "https://openalex.org/W3177828909",
        "https://openalex.org/W2112001822",
        "https://openalex.org/W4281648132",
        "https://openalex.org/W4313291879",
        "https://openalex.org/W3031073114",
        "https://openalex.org/W2018838463",
        "https://openalex.org/W4376133226",
        "https://openalex.org/W4380422659",
        "https://openalex.org/W2890179300",
        "https://openalex.org/W4213097893",
        "https://openalex.org/W2781534540",
        "https://openalex.org/W3045929934",
        "https://openalex.org/W4366823175",
        "https://openalex.org/W6763868836",
        "https://openalex.org/W4226399820",
        "https://openalex.org/W4360836968",
        "https://openalex.org/W4283733033",
        "https://openalex.org/W6675354045",
        "https://openalex.org/W3199639770",
        "https://openalex.org/W3201689665",
        "https://openalex.org/W2114850508",
        "https://openalex.org/W2143210482",
        "https://openalex.org/W3009209436",
        "https://openalex.org/W2781028774",
        "https://openalex.org/W2727251566",
        "https://openalex.org/W3012384638",
        "https://openalex.org/W6894381363",
        "https://openalex.org/W2320983896",
        "https://openalex.org/W1563940013",
        "https://openalex.org/W4388024559",
        "https://openalex.org/W2971227267",
        "https://openalex.org/W4206951418",
        "https://openalex.org/W3211728297"
    ],
    "abstract": "Abstract Predicting the effects of coding variants is a major challenge. While recent deep-learning models have improved variant effect prediction accuracy, they cannot analyze all coding variants due to dependency on close homologs or software limitations. Here we developed a workflow using ESM1b, a 650-million-parameter protein language model, to predict all ~450 million possible missense variant effects in the human genome, and made all predictions available on a web portal. ESM1b outperformed existing methods in classifying ~150,000 ClinVar/HGMD missense variants as pathogenic or benign and predicting measurements across 28 deep mutational scan datasets. We further annotated ~2 million variants as damaging only in specific protein isoforms, demonstrating the importance of considering all isoforms when predicting variant effects. Our approach also generalizes to more complex coding variants such as in-frame indels and stop-gains. Together, these results establish protein language models as an effective, accurate and general approach to predicting variant effects.",
    "full_text": "Nature Genetics | Volume 55 | September 2023 | 1512–1522 1512\nnature genetics\nArticle\nhttps://doi.org/10.1038/s41588-023-01465-0\nGenome-wide prediction of disease variant \neffects with a deep protein language model\nNadav Brandes    1, Grant Goldman2, Charlotte H. Wang    3, \nChun Jimmie Ye    1,4,5,6,7,8,9  & Vasilis Ntranos    4,8,9,10 \nPredicting the effects of coding variants is a major challenge. While \nrecent deep-learning models have improved variant effect prediction \naccuracy, they cannot analyze all coding variants due to dependency on \nclose homologs or software limitations. Here we developed a workflow \nusing ESM1b, a 650-million-parameter protein language model, to predict \nall ~450 million possible missense variant effects in the human genome, \nand made all predictions available on a web portal. ESM1b outperformed \nexisting methods in classifying ~150,000 ClinVar/HGMD missense variants \nas pathogenic or benign and predicting measurements across 28 deep \nmutational scan datasets. We further annotated ~2 million variants as \ndamaging only in specific protein isoforms, demonstrating the importance \nof considering all isoforms when predicting variant effects. Our approach \nalso generalizes to more complex coding variants such as in-frame indels \nand stop-gains. T ogether, these results establish protein language models as \nan effective, accurate and general approach to predicting variant effects.\nDetermining the phenotypic consequences of genetic variants, known \nas variant effect prediction (VEP), is a key challenge in human genet-\nics1–4. Coding variants altering the amino acid sequences of proteins \nare of special interest due to their enrichment in disease associations, \nbetter-understood mechanisms and therapeutic actionability 5–8. Most \nnaturally occurring coding variants are missense, substituting one \namino acid with another 9. Despite progress in functional genomics \nand genetic studies, distinguishing protein-disrupting damaging \nvariants from neutral ones remains a challenge. Furthermore, most \nhuman genes are alternatively spliced, and the same variant may be \ndamaging to some protein isoforms but neutral to others, depend -\ning on interactions with the rest of the protein. Thus, most missense \nvariants remain as variants of uncertain significance (VUS), limiting \nthe utility of exome sequencing in clinical diagnosis 2,10. VEP is even \nmore challenging for coding variants affecting multiple residues \nsuch as in-frame indels.\nExperimental approaches for VEP such as deep mutational scans \n(DMS)11 and Perturb-seq12 can measure molecular and cellular pheno-\ntypes across thousands of variants simultaneously. However, these \nendophenotypes are imperfect proxies for the relevant clinical phe -\nnotypes and remain difficult to scale genome-wide 13,14. In contrast, \ncomputational methods that learn the biophysical properties or evo-\nlutionary constraints of proteins could theoretically cover all cod -\ning variants15–17. While most computational methods are trained on \nlabeled data of pathogenic versus benign variants 10, unsupervised \nhomology-based methods predict variant effects directly from multi-\nple sequence alignments (MSA) without training on labeled data. EVE, \nan unsupervised deep-learning method implementing a generative \nReceived: 8 August 2022\nAccepted: 5 July 2023\nPublished online: 10 August 2023\n Check for updates\n1Division of Rheumatology, Department of Medicine, University of California, San Francisco, San Francisco, CA, USA. 2Biological and Medical Informatics \nGraduate Program, University of California, San Francisco, San Francisco, CA, USA. 3Biomedical Sciences Graduate Program, University of California, \nSan Francisco, San Francisco, CA, USA. 4Bakar Computational Health Sciences Institute, University of California, San Francisco, San Francisco, CA, USA. \n5Parker Institute for Cancer Immunotherapy, University of California, San Francisco, San Francisco, CA, USA. 6Gladstone-UCSF Institute of Genomic \nImmunology, San Francisco, CA, USA. 7Institute for Human Genetics, University of California, San Francisco, San Francisco, CA, USA. 8Department of \nEpidemiology & Biostatistics, University of California, San Francisco, San Francisco, CA, USA. 9Department of Bioengineering and Therapeutic Sciences, \nUniversity of California, San Francisco, San Francisco, CA, USA. 10Diabetes Center, University of California, San Francisco, San Francisco, CA, USA. \n e-mail: jimmie.ye@ucsf.edu; vasilis.ntranos@ucsf.edu\nNature Genetics | Volume 55 | September 2023 | 1512–1522\n 1513\nArticle https://doi.org/10.1038/s41588-023-01465-0\nOne of the largest protein language models is ESM1b, a publicly avail-\nable 650-million-parameter model trained on ~250 million protein \nsequences20. It was demonstrated to predict, without further training, \nvariant effects correlated with DMS experiment results25.\nHowever, several limitations have restricted the use of ESM1b for \nVEP. First, the model’s input sequence length is limited to 1,022 amino \nacids, excluding ~12% of human protein isoforms. Second, while evalu-\nated on DMS data across 32 genes (10 from humans)25, it has remained \nunknown how the model performs at predicting the clinical impact of \ncoding variants genome-wide. Finally, using ESM1b requires software \nengineering proficiency, deep-learning expertise and high-memory \nGPUs, which together create a technical barrier for widespread use.\nHere we implemented a workflow generalizing ESM1b to protein \nsequences of any length and used it to predict all ~450 million possible \nmissense variant effects across all 42,336 protein isoforms in the human \ngenome. We evaluated our workflow on three different benchmarks and \nvariational autoencoder, was recently shown to outperform supervised \nmethods4. However, due to their reliance on MSA, homology-based \nmethods provide predictions only for a subset of well-aligned proteins \nand residues. Moreover, because alternative isoforms of the same gene \nhave identical homologs, it is unclear whether they can distinguish the \neffects of variants on different isoforms.\nAnother deep-learning approach to VEP uses protein language \nmodels, a technique derived from natural language processing. These \nare deep neural networks trained to model the space of known protein \nsequences selected throughout evolution as captured by large protein \ndatasets such as UniProt18 (Fig. 1a). Notably, protein language models \ndo not require explicit homology and can estimate the likelihood of \nany possible amino acid sequence. They have been shown to implic -\nitly learn how protein sequence determines many aspects of protein \nstructure and function, including secondary structure, long-distance \ninteractions, post-translational modifications and binding sites 19–24. \nd\nMSA coverage\nNot covered\nSLC7A3 (Q9UBP0)\nCationic amino acid transporter 3\nCAT_C domain\nMSA coverage\nNot covered\nARX (Q96QS3)\nHomeobox protein ARX\nOP NLS PA1 PA2 Acidic\nMSA coverage\nNot covered\nSPAST (Q8WY07)\nSpastin\nMIT domain\nMean 0.84\nMin 0.06\n25% 0.78\n50% 0.85\n75% 0.92\nMSA coverage statisticsb cPretrained \nprotein language model\nESM1b\nProtein sequence\n All human protein isoforms\n~450 million variant eﬀect\nscores\nVariant eﬀect prediction\nProtein sequence\nAmino acid change\n20 × L heatmap\na\n250 million protein sequences\nsampled across all organisms Mask random positions\nInput protein sequence\nLoss function\nBackprop\nMasked input sequence Predicted amino acid probabilities \nper position\n650 million parameter neural network\nPosition\nAmino acid\n(3k disease genes)\n10 3\n10 2\n10 1\n10 0\n0.4 0.5 0.6 0.7 0.8 0.9 1.0\nMSA coverage\nNumber of genes\n0 –5 –10 –15 –20 –25\nESM1b LLR score\nUniProt\nScore (R273H) = log\nPr(residue 273  = H)\nPr(residue 273  = R)\nResidue position\nMask\nMask\nMask\n…\n271 280\nR ...GPCACVRVE\nFig. 1 | ESM1b predicts variant effects without homology coverage. a, ESM1b is \na 650-million-parameter protein language model trained on 250 million protein \nsequences across all organisms. The model was trained via the masked language \nmodeling task, where random residues are masked from input sequences and \nthe model has to predict the correct amino acid at each position (including the \nmissing residues). b, Illustration of the ESM1b model’s input (an amino acid \nsequence) and output (LLR of effect scores for all possible missense variants).  \nc, The distribution of MSA coverage (that is, the fraction of a protein’s residues \nthat are aligned) across ~3,000 disease-related proteins covered by EVE.  \nd, Examples of the model’s capacity to detect protein domains and functional \nregions, including outside MSA coverage, across the following three human \nproteins: SPAST, SLC7A3 and ARX. Each heatmap visualizes the LLR scores across \nall 20 × L possible missense variants (where L is the protein length). Protein \ndomains without MSA coverage are highlighted in orange.\nNature Genetics | Volume 55 | September 2023 | 1512–1522 1514\nArticle https://doi.org/10.1038/s41588-023-01465-0\ncompared it to 45 other VEP methods. Our workflow outperforms all \ncompared methods in classifying variant pathogenicity (as annotated \nby ClinVar10 and HGMD26) and predicting DMS experiments. We further \ndemonstrate the capacity of ESM1b to assess variant effects in the \ncontext of different protein isoforms, identifying isoform-sensitive \nvariants in 85% of alternatively spliced genes. Finally, we present a \nscoring algorithm that generalizes ESM1b to variants affecting mul -\ntiple residues and demonstrates the model’s accurate predictions \nover in-frame indels and stop-gain variants. We created a web portal \nallowing users to query, visualize and download missense VEPs for all \nhuman protein isoforms (accessible at https://huggingface.co/spaces/\nntranoslab/esm_variants).\nResults\nPredicting the effects of all possible missense variants in the \nhuman genome\nWe developed a modified ESM1b workflow and applied it to obtain \na complete catalog of all ~450 million missense variant effects on all \n42,336 known human protein isoforms. Each variant’s effect score is \nthe log-likelihood ratio (LLR) between the variant and wild-type (WT) \nresidue (Fig. 1b). Unlike homology-based models currently available \nonly for a subset of human proteins and residues with MSA coverage (for \nexample, 84% of the residues in ~3,000 disease genes covered by EVE; \nFig. 1c), ESM1b predicts the effects of every possible missense variant.\nProtein regions with many possible mutations predicted by ESM1b \nas damaging often align with known protein domains (Fig. 1d ). As \nillustrated for SPAST, SLC7A3 and ARX, these domains may reside out-\nside MSA coverage and be unsuitable for homology-based models \n(Fig. 1d), yet harbor disease-associated variants. For example, the \nmicrotubule-interacting and trafficking (MIT) domain in SPAST con-\ntains missense variants implicated in hereditary spastic paraplegias27, \nthe CAT C domain in SLC7A3 contains an autism-linked variant (S589T)28 \nand multiple domains in ARX outside MSA coverage (highlighted in \nFig. 1d) contain missense variants linked to intellectual disability29–32.\nESM1b outperforms other VEP methods over clinical and \nexperimental benchmarks\nT o assess the performance of ESM1b in predicting the clinical impact \nof variants, we compared the model’s effect scores between patho-\ngenic and benign variants in two datasets. The first dataset contains \npathogenic and benign variants annotated in ClinVar10 and the sec-\nond includes variants annotated by HGMD as disease-causing26 and \nbenign variants from gnomAD (defined by allele frequency >1%)9. Only \nhigh-confidence variants were included (Supplementary Methods). \nThe distribution of ESM1b effect scores shows a substantial difference \nbetween pathogenic and benign variants in both datasets (Fig. 2a). \nMoreover, pathogenic and benign variants show consistent distri -\nbutions across the two datasets, suggesting that the predictions are \nwell-calibrated. Using an LLR threshold of −7.5 to distinguish between \npathogenic and benign variants yields a true-positive rate of 81% and \na true-negative rate of 82% in both datasets.\nComparing ESM1b and EVE as classifiers of variant pathogenic -\nity, ESM1b obtains a receiver operating characteristics–area under \nthe curve (ROC-AUC) score of 0.905 for distinguishing between the \n19,925 pathogenic and 16,612 benign variants in ClinVar (across 2,765 \ngenes), compared to 0.885 for EVE. On HGMD/gnomAD (with 27,754 \ndisease-causing and 2,743 common variants across 1,991 genes), ESM1b \nobtains a ROC-AUC score of 0.897 compared to 0.882 for EVE (Fig. 2b). \nWe also considered a gene-specific ROC-AUC metric, where ESM1b \nperforms slightly worse. However, we consider the global metric more \nsuited for genome-wide scanning of disease variants, where compar-\ning variants across different genes is often necessary (Extended Data \nFig. 1b and Methods).\nThe ROC curve shows the true-positive rate (percentage of path-\nogenic variants successfully predicted as such) for every possible \nfalse-positive rate (of benign variants mistakenly predicted patho -\ngenic). While the ROC-AUC metric assesses overall model performance \nby integrating overall false- and true-positive rates, clinical applications \nusually require low false-positive rates. At a false-positive rate of 5%, \nESM1b obtains a 60% true-positive rate compared to 49% for EVE over \nClinVar and 61% compared to 51% over HGMD/gnomAD (Extended Data \nFig. 1a), showing a substantial margin at the clinically relevant regime \nof the ROC curve.\nHaving established the high accuracy of ESM1b as a classifier of \nvariant pathogenicity, we sought to predict the effects of VUS in Clin-\nVar. T o that end, we modeled the distribution of ESM1b effect scores \nacross VUS as a Gaussian mixture with two components (Fig. 2c). These \ntwo fitted distributions align well with the distributions for annotated \npathogenic and benign variants (Fig. 2d). According to this model, we \nestimate that about 58% of missense VUS in ClinVar are benign and \nabout 42% are pathogenic.\nIn addition to EVE, we compared ESM1b to 44 other VEP methods, \nincluding all functional prediction methods and conservation scores \nfrom the Database for Nonsynonymous SNPs’ Functional Predictions \n(dbNSFP)33. For clinical benchmark comparisons, we only consid -\nered methods that (1) were not trained on clinical databases such as  \nClinVar and HGMD or used features from methods trained on such \ndata, and (2) do not use allele frequency as a feature, as it is often used \nto curate variants as benign. Of the 46 methods, 19 (including ESM1b \nand EVE) satisfy these criteria for an unbiased comparison. Over the \nset of variants reported by all 19 methods, ESM1b outperforms all other \nmethods on both ClinVar and HGMD/gnomAD (Fig. 2e,f). Similarly, \nESM1b outperforms each method separately on its respective set of \nreported variants (Fig. 2g,h). All head-to-head comparisons were statis-\ntically significant with P < 0.001. Evaluation results for all 46 methods, \nincluding those excluded for data leakage concerns, are reported in \nSupplementary Table 2.\nWe further compared all 46 VEP methods in their ability to predict \nexperimental measurements from DMS. The full DMS benchmark \nconsists of 28 assays covering 15 human genes (166,132 experimental \nmeasurements over 76,133 variants; Supplementary Table 1). We com-\npared 43 of the methods against a subset of 16,049 variants across 11 \nFig. 2 | ESM1b is suitable for genome-wide disease prediction of coding \nvariants. a, T op: the distribution of ESM1b effect scores across two sets of \nvariants that are assumed to be mostly pathogenic (‘ClinVar: pathogenic’ and \n‘HGMD: disease causing’) and two sets of variants assumed to be mostly benign \n(‘ClinVar: benign’ and ‘gnomAD: MAF > 0.01’). Bottom: Venn diagram of the \nvariants extracted from HGMD, ClinVar and gnomAD. b, Comparison between \nESM1b and EVE in their capacity to distinguish between pathogenic and benign \nvariants (measured by global ROC-AUC scores), as labeled by ClinVar (36,537 \nvariants in 2,765 unique genes) or HGMD/gnomAD (30,497 variants in 1,991 \nunique genes). c, The distribution of ESM1b effect scores across ClinVar missense \nVUS, decomposed as a mixture of two Gaussian distributions capturing variants \npredicted as more likely pathogenic (orange) or more likely benign (blue). \nd, The distribution of ESM1b effect scores across all common ClinVar labels, \nincluding the two Gaussian components from c. Boxes mark Q1–Q3 of the \ndistributions, with midpoints marking the medians (Q2) and whiskers stretching \n1.5× IQR. Altogether there are ~300,000 missense variants labeled in ClinVar. \ne,f, Evaluation of 19 VEP methods against the same two benchmarks: ClinVar (e) \nand HGMD/gnomAD (f). Performance was measured by two metrics for binary \nclassification as follows: ROC-AUC (light red) and a balanced version of PRC-AUC \n(light blue; Methods). Performance was evaluated on the sets of variants available \nfor all 19 methods. g,h, Head-to-head comparison between ESM1b and each \nof the 18 other VEP methods over the same two dataset benchmarks (in terms \nof ROC-AUC). Because ESM1b provides scores for all missense mutations, the \ncomparison against each other method is performed on the set of variants with \neffect predictions for that method. The percentage of variants considered for \neach method is shown at the bottom of each bar. IQR, interquartile range.\nNature Genetics | Volume 55 | September 2023 | 1512–1522\n 1515\nArticle https://doi.org/10.1038/s41588-023-01465-0\ngenes reported by these methods (excluding 3 methods that would \nhave greatly reduced the number of shared variants; Methods). ESM1b \nis ranked highest with a mean Spearman’s correlation of 0.426 between \nits effect scores and the experimental measurements (Fig. 3a), followed \nby DEOGEN2 (0.423), REVEL (0.419) and EVE (0.418). DEOGEN2 and \nREVEL are supervised methods, whereas EVE, like ESM1b, is an unsu -\npervised method. Comparing ESM1b and EVE head-to-head against the \n64,580 variants with EVE scores (across 15 genes) shows a similar trend \n(Fig. 3b and Extended Data Fig. 1c). Likewise, ESM1b outperforms all  \n45 other methods over the set of variants reported by each method \na b\n0.897\n0.8820.885\n0.905\nc\nd\ne f\ng\nROC-AUC\n12,095 variants\n(1,316 genes)\nBenign Likely \nbenign Benign/ \nlikely benign\nPathogenic\nLikely \npathogenic Pathogenic/ likely path\nUncertain\nsignificance\nClinVar annotations (~300K variants in ~5K genes)\nVUS\nbenign VUS\npathogenic\nGaussian mixture\nmodel\n42%58%\n12,357 variants\n(880 genes)\nClinVar \nHead-to-head comparison (all available variants per VEP)\n91% 86% 89% 90% 90% 40% 92% 87% 92% 92% 92% 92% 92% 92% 92% 92% 91% 85%\nHGMD/gnomAD \nHead-to-head comparison (all available variants per VEP)\n33% 94% 92% 93% 91% 87% 92% 94% 49% 94% 94% 94% 94% 94% 94% 94% 94% 86%\nh\nClinVar\nESM1b LLR score\nROC-AUC\nHGMD/gnomAD\nVariants of uncertain significance (ClinVar)\nESM1b LLR score\n0.94\n0.92\n0.90\n0.88\n0.86\n0.84\n0.82\n–20 –15 –10 –5 0\n0.80\n10\n5\n0\n–5\n–10\n–15\n–20\n–25\nESM1b LLR score\nHGMD ClinVar\ngnomAD\n28,0432,21944,0688,46467,687\n–25 –20 –15 –10\nClinVar: pathogenic (11,403)\nClinVar: benign (13,557)\nHGMD: disease causing (76,151)\ngnomAD: MAF > 0.01 (30,262)\n–5 0 5\nVUS histogram\nGaussian mixture\nComponent 1\n(likely benign)\nComponent 2\n(likely pathogenic)\nEVE\nESM1b\nClinVar HGMD/gnomAD\n0.9\n0.8\n0.7\n0.6\n0.5\n0.9\n0.8\n0.7\n0.6\n0.5\nAUC\nAUC\n0.90\n0.85\n0.80\n0.75\n0.70\n0.65\n0.60\n0.55\nROC-AUC\n0.90\n0.85\n0.80\n0.75\n0.70\n0.65\n0.60\n0.55\nROC-AUC\nPRC-AUC (balanced)\nROC-AUC\nPRC-AUC (balanced)\nESM1b\nVEP\nESM1b\nVEP\nESM1b\nEVE SIFT\nPROVEAN\nSIFT4G\nMutationsAssessor\nMTBAN\nPhyloP (vertebrate)\nLRT Siphy GERP++\nPhastCons (vertebrate)\nGenoCanyon\nPhyloP (mammalian)\nPhastCons (mammalian)\nPhastCons (primate)\nPhyloP (primate)\nbStatistic FitCons ESM1b\nEVE SIFT\nPROVEAN\nSIFT4G\nMutationsAssessor\nMTBAN\nPhyloP (vertebrate)\nLRT Siphy GERP++\nPhastCons (vertebrate)\nGenoCanyon\nPhyloP (mammalian)\nPhastCons (mammalian)\nPhastCons (primate)\nPhyloP (primate)\nbStatistic FitCons\nEVE SIFT\nPROVEAN\nSIFT4G\nMutationsAssessor\nMTBAN\nPhyloP (vertebrate)\nLRT Siphy GERP++\nPhastCons (vertebrate)\nGenoCanyon\nPhyloP (mammalian)\nPhastCons (mammalian)\nPhastCons (primate)\nPhyloP (primate)\nbStatistic FitCons\nEVE SIFT\nPROVEAN\nSIFT4G\nMutationsAssessor\nMTBAN\nPhyloP (vertebrate)\nLRT Siphy GERP++\nPhastCons (vertebrate)\nGenoCanyon\nPhyloP (mammalian)\nPhastCons (mammalian)\nPhastCons (primate)\nPhyloP (primate)\nbStatistic FitCons\nNature Genetics | Volume 55 | September 2023 | 1512–1522 1516\nArticle https://doi.org/10.1038/s41588-023-01465-0\nP = 0.371\nP = 0.054\nP = 0.166\nP = 0.428\nP = 0.374\nP = 0.371\nP = 0.009\nP = 0.002\nP < 0.001\nP < 0.001\nP < 0.001\nP < 0.001\nP < 0.001\nP < 0.001\nP < 0.001\nP < 0.001\nP < 0.001\nP < 0.001\nP < 0.001\nP < 0.001\nP < 0.001\nP < 0.001\np< 0.001\nP < 0.001\nP < 0.001\nP < 0.001\nP < 0.001\nP < 0.001\nP < 0.001\nP < 0.001\nP < 0.001\nP < 0.001\nP < 0.001\nP < 0.001\nP < 0.001\nP < 0.001\nP < 0.001\nP < 0.001\nP < 0.001\nP < 0.001\nP < 0.001\nP < 0.001\nP < 0.001\nP < 0.001\nP = 0.486\na\nESM1b scores vs gnomAD allele frequency\nb\ned\nc\nDMS: head-to-head comparison (all available variants per VEP)\nAvg. Spearman ρ\nComparison on the same set of variants for all VEPs (16,049 variants across 11 genes)\n0.4\n0.3\n0.2\n0.1\n0\nESM1b\nEVE\nOther VEP, evaluated on clinical DBs\nOther VEP, not evaluated on clinical DBs\n0.65\n0.60\n0.55\n0.50\n0.45\n0.40\n0.35\n0.30\n0.25\n0.20\nSpearman ρ\nSYUA MTHR TPK1 CALM1 TADBP\nP53 A4\nPTEN VKOR1 ADRB2 BRCA1 CBS MSH2 YAP1 RASH\nESM1b (same variants)\nESM1b (all variants)\nEVE\n10\n8\n6\n4\n2\n0\n0 1 2 3 4 5\n–log 10  AFESM1b LLR score\n–25\n0\n0.05\n0.10\n0.15\n0.20\n–20 –15 –10 –5 0\nESM1b -LLR (µ ± σ)\nVariants in domains\nVariants outside domains\nClinVar: benign (13,557)\n0.05 0.10 0.15 0.20 0.25 0.30 0.35 0.40 0.45\nAvg. Spearman ρ\nESM1b\nEVE\nOther VEP, evaluated on\nclinical DBs\nOther VEP, not evaluated on\nclinical DBsPhyloP (primate) [15] (33.9%)\nPhylop (vertebrate) [15] (33.9%)\nLIST-S2 [13] (33.8%)\nFATHMM-MKL [15] (33.9%)\nFATHMM [15] (33.9%)\nFATHMM-XF [15] (33.9%)\nPrimateAI [15] (33.6%)\nPolyphen2 (HDIV) [15] (33.9%)\nPolyphen2 (HVAR) [15] (33.9%)\nCADD [15] (33.9%)\nSIFT4G [15] (33.9%)\nMutPred [15] (31.7%)\nMPC [15] (33.9%)\nEigen-PC [15] (33.9%)\nSIFT [14] (33.6%)\nMetaSVM [15] (33.9%)\nPROVEAN [15] (33.9%)\nEigen [15] (33.9%)\nMVP [15] (33.9%)\nMutationsAssessor [14] (33.1%)\nClinPred [15] (33.9%)\nMetaLR [15] (33.9%)\nM-CAP [15] (33.9%)\nMTBAN [10] (19.9%)\nEVE [15] (84.8%)\nVARITY_R [9] (26.2%)\nVEST4 [15] (33.9%)\nBayesDel (no AF) [15] (33.9%)\nBayesDel (with AF) [15] (33.9%)\nVARITY_ER [9] (26.2%)\nMetaRNN [15] (33.9%)\nDEOGEN2 [14] (33.6%)\nREVEL [15] (33.9%)\nPhastCons (vertebrate) [15] (33.9%)\nSiPhy [15] (33.9%)\nGERP++ [15] (33.9%)\nDANN [15] (33.9%)\nbStatistic [11] (34.1%)\nMutationTaster [14] (33.5%)\nLRT [15] (33.9%)\nPhyloP (mammalian) [15] (33.9%)\nPhastCons (mammalian) [15] (33.9%)\nPhastCons (primate) [15] (33.9%)\nFitCons [14] (33.5%)\nGenoCanyon [15] (33.9%)\nESM1b\nDEOGEN2\nREVEL\nEVE\nMetaRNN\nBayesDel (with AF)\nBayesDel (no AF)\nVEST4\nM-CAP\nClinPred\nMetaLR\nPROVEAN\nMutationsAssessor\nMVP\nSIFT4G\nSIFT\nMPC\nMutPred\nEigen\nMetaSVM\nEigen-PC\nFATHMM\nFATHMM-XF\nPolyphen2 (HVAR)\nCADD\nPolyphen2 (HDIV)\nPrimateAI\nLIST-S2\nFATHMM-MKL\nPhyloP (vertebrate)\nLRT\nMutationTaster\nPhastCons (vertebrate)\nFitCons\nGERP++\nSiphy\nDANN\nGenoCanyon\nPhastCons (primate)\nPhyloP (mammalian)\nPhyloP (primate)\nPhastCons (mammalian)\nFig. 3 | ESM1b predicts the effects of experimental measurements from DMS. \na, Evaluation of 43 VEP methods (including ESM1b and EVE) on a DMS benchmark \ncontaining 28 assays over 15 different human genes (Supplementary Table 1). Of \nthe entire set of 76,133 variants in 15 genes, 16,049 variants in 11 genes obtained \neffect scores by all 43 VEP methods. We excluded 3 VEP methods, VARITY_ER, \nVARITY_R and MTBAN (Methods), which would have dramatically reduced the \nnumber of variants and genes shared by all methods. The methods are sorted \nby the average Spearman’s correlation between each method’s scores and the \nexperimental scores. b, The performance of ESM1b and EVE over the 15 individual \ngenes in the DMS benchmark. The average performance of each method is \nmarked by a dashed line. Because ESM1b can process all missense variants (while \nEVE assigns scores only for a subset of them), the performance of ESM1b is shown \neither for all variants (‘all variants’) or the subset of variants with EVE scores \n(‘same variants’). c, Head-to-head comparison between ESM1b and each of the \nother 45 VEP methods on the DMS benchmark, where each method is compared \nagainst the set of variants with predictions for that method. The number of \nunique genes and percentage of variants with predictions for each method are \nshown in squared brackets and parentheses, respectively. One-tailed P values \nindicating significant differences from ESM1b are shown at the beginning (left) of \nthe bars. Methods are sorted by the difference in average Spearman’s correlation \nbetween ESM1b and each of the other methods. Comparisons against methods \nnot evaluated on clinical DBs are grayed out. d, The distribution of ESM1b effect \nscores for variants in annotated protein domains (red) versus variants outside \nof domains (gray). The distribution of benign variants (as in Fig. 2a) is shown \nfor reference. e, Average ESM1b effect score (and s.d.) as a function of allele \nfrequency over all gnomAD missense variants.\nNature Genetics | Volume 55 | September 2023 | 1512–1522\n 1517\nArticle https://doi.org/10.1038/s41588-023-01465-0\n(Fig. 3c and Extended Data Fig. 2), with 37 of 45 comparisons statisti-\ncally significant (P < 0.05).\nTwo additional analyses further demonstrate the functional interpre-\ntation of ESM1b predictions. First, as illustrated by individual examples \n(Fig. 1d), missense variants within domains have more negative (damag-\ning) effect scores, while those outside domains resemble benign variants \n(Fig. 3d). Second, ESM1b effect scores track well with allele frequency, \nwith common variants predicted less damaging (Fig. 3e), consistent \nwith purifying selection eliminating highly deleterious mutations34,35.\nESM1b can predict variant effects on alternative protein isoforms\nAs a protein language model, ESM1b assesses each variant in the con-\ntext of the input amino acid sequence, allowing the same variant to be \nassessed in the context of different protein isoforms. A variant might be \ndamaging to some isoforms but not others, possibly due to interactions \nwith alternatively spliced domains (Fig. 4a). For example, comparing \nESM1b scores between the primary and a shorter isoform of P53 (known \nas Δ133p53β)36, we found 170 variants (mostly near the splice junctions) \nwith substantially different scores (LLR difference > 4), including three \nClinVar variants annotated as VUS (Fig. 4b).\nWe found 3,477 missense variants in ClinVar with substantial dif-\nferences in predicted effects (LLR s.d. > 2) across isoforms (Fig. 4c). \nNotably, we only considered reviewed, manually curated protein iso-\nforms (Supplementary Methods). These 3,477 variants include 148 \n(4%) benign or likely benign, 437 (13%) pathogenic or likely pathogenic \nand 2,892 (83%) VUS. Interestingly, these VUS mirror the effect score \ndistribution of pathogenic variants when considering the most damag-\ning isoform, and benign variants when considering the least damaging \nisoform (Fig. 4c ). Like P53, many clinically important genes have a \nlarge number of ClinVar variants with high effect score variance across \nisoforms, including BRCA1, IRF6 and TGFB3 (Fig. 4d).\nBeyond the ~5,000 ClinVar genes, we searched for isoform-specific \neffects across all possible missense variants in all 20,360 coding human \ngenes. We define a variant to be isoform-sensitive according to ESM1b \nP53 (P04637) Positions: 133–331\n1516923 479283 646731\nP53 Isoform-8 \n(P04637-8)\nScore  \ndiﬀerence\nPrimary isoform  \n(P04637-1)Neutral:\nDamaging:\nFunctional region 3\nFunctional region 1\nFunctional region 2\nIso.1\nIso.2\nIso.3\nIso.4\nMissing\nMissing\nMissing\nMissing\nMissing\nc.234:A>C c.345:G>Tc.123:A>T c.456:G>C\nIsoform-sensitive variants\nMissing\nFunctional region 1 Functional region 2 Functional region 3\na b\nVariants with substantially diﬀerent scores between P53 isoforms\nF134SP04637-1 –11.947\nF2SP04637-8 –1.806\n1516923\nClinVar ID\nL330PP04637-1 –12.173\nL198PP04637-8 –4.997646731\nIsoform Mutation\nESM1b\nscore\nQ136EP04637-1 –12.391\nQ4EP04637-8 –6.163479283\nd Top 100 ClinVar genes (1,961 of 3,477 variants)\nc\nMin isoform score\nMax isoform score\nScore\ndiﬀerence\n–7.5\n–7.5\ny = x\n10.0\n7.5\n5.0\n2.5\n0\n–2.5\n–5.0\n–7.5\n–10.0\n–25\nClinVar: pathogenic\nClinVar: benign\nUncertain significance\n(all variants)\nUncertain significance\n(min isoform score)\nMin isoform score (2,892)\nMax isoform score (2,892)\nUncertain significance (2,892)\nUncertain significance\n(max isoform score)\n–20 –15 –10\nESM1b LLR score\n–5 0 5\n–25 –20 –15 –10\nESM1b LLR score\n–5 0 5\nBenign/likely benign (148)\n3,477 ClinVar variants\nPathogenic/likely path (437)\n–20\nBRCA1 (5)\nBARD1 (2)\nARF (3)\nCHK2 (4)\nMSH2 (2)\nTSC1 (2)\nSDHA (2)\nRA51D (3)\nC560 (5)\nMLH1 (3)\nMERL (6)\nIRF6 (2)\nCDN2A (4)\nCADH1 (2)\nPYGM (2)\nTNG2 (5)\nSMAD3 (4)\nDHSD (4)\nRA51C (2)\nP53 (9)\nNF1 (3)\nTGFB3 (2)\nFLCN (2)\nDOK7 (3)\nABRX1 (2)\nDEAF1 (2)\nG6PC1 (2)\nTNNT2 (5)\nCERKL (5)\nAIPL1 (5)\nSIAT6 (18)\nAP3B2 (4)\nHDAC8 (6)\nGATA2 (2)\nPRRT2 (3)\nPEPD (3)\nPPT1 (2)\nERCC2 (2)\nSERC (2)\nHOGA1 (2)\nPIGG (5)\nGLCNE (4)\nHARS1 (4)\nACHA2 (2)\nSQSTM (2)\nMYLK (6)\nS13A5 (4)\nALG13 (4)\nSCP2 (7)\nDTNA (16)\nPRKN (3)\nNCF2 (3)\nGALC (3)\nSPTC1 (2)\nATP7A (2)\nEXOS2 (3)\nBEST1 (3)\nREEP1 (4)\nTRPM1 (4)\nSGMR1 (3)\nKCNT1 (2)\nITPA (3)\nKCNQ2 (5)\nPKP2 (2)\nGALT (2)\nPKHG5 (2)\nWT1 (2)\nPUR8 (2)\nCS012 (4)\nAPC (2)\nRAPSN (2)\nSUMF1 (3)\nWHRN (3)\nNGLY1 (4)\nFHL1 (4)\nJPH2 (2)\nFANCM (3)\nAMACR (3)\nCTIP (2)\nTNR1A (2)\nGBRG2 (3)\nKCNA2 (2)\nUSH1C (3)\nDHB4 (3)\nP2RX2 (7)\nPSMG2 (2)\nPCCA (3)\nLMNA (5)\nDESP (3)\nCAD23 (6)\nTNR11 (5)\nLDLR (5)\nDGUOK (2)\nRT4I1 (2)\nODPA (4)\nTERT (2)\nP (2)\nPARN (3)\nIPYR2 (4)\nDI3L2 (3)\n–20\n–15\n–15\n–10\n–10\n–5\n–5\n0\n0\n5\n5\nClinVar: benign (13,557)\nClinVar: pathogenic (11,403)\ngnomAD: MAF > 0.01 (30,262)\nHGMD: disease-causing (76,151)\n0\n10\n20\n30\n40\n50\n100\nNumber of ISVs\nper gene\nRelative number of ISVs\n(% of all variants reported)\n0\nFig. 4 | ESM1b predictions in clinically relevant genes depend on the isoform \ncontext. a, The consequences of variants (for example, damaging versus neutral) \ncan depend on the isoform context. b, Comparison of the primary and one of \nthe alternative isoforms of P53. Three specific variants are detailed. c, Left: all \n3,477 ClinVar variants with highly variable ESM1b effect scores across different \nisoforms (defined by s.d. > 2). Center: the lowest and highest isoform scores \npredicted for all VUS from the left panel (top two boxes), compared to the mean \nscores (across isoforms) of VUS, benign or pathogenic variants (as in Fig. 2d; \nbottom three boxes). The boxes represent the Q1–Q3 range and median (Q2) \nline; whiskers correspond to 1.5× IQR; outliers (outside the whiskers) are shown \nindividually. Right: the distribution of the lowest and highest isoform scores \npredicted for all VUS from the left panel, compared to the distributions for \npathogenic or benign variants from ClinVar, HGMD and gnomAD (as in Fig. 2a). \nAcross all panels, the number of variants associated with each category is shown \nin parentheses. d, The top 100 ClinVar genes with the highest number of variants \nwith highly variable effect scores (as in c). Numbers of annotated isoforms of \neach gene are shown in parentheses.\nNature Genetics | Volume 55 | September 2023 | 1512–1522 1518\nArticle https://doi.org/10.1038/s41588-023-01465-0\nif (1) it is likely benign (LLR > −7) in one isoform, (2) likely pathogenic \n(LLR < −8) in another and (3) these two predictions are substantially \ndifferent (LLR difference > 4). We identified ~1.8 million such variants \nacross ~9,000 genes, which is 85% of all genes with manually curated \nalternative isoforms (Fig. 5a). Isoform-sensitive variants (ISV) are more \nlikely to occur near splice junctions and in genes with splicing-disrupted \nprotein domains, as opposed to domains that are either included intact \nor removed entirely during splicing (Fig. 5b).\nSplicing events can dramatically influence predicted variant \neffects. For example, the second isoform of MEN1, a tumor suppressor \nb\n90.3%\n28.2%\nIsoform-sensitive variants in splice disrupted domains\n0.86\n0.92\n0.87\n0.79\n0.50\n0.56 0.53\n0.03\na\nTGFB3 (P10600): TGFB3 proprotein\nLAP TGFβ-3\nSignal \npeptide\n1 24 301 412Isoform-sensitive variants (histogram)\n~1.8 million ISVs in 9K genes\ny = x\nIsoform 1 Isoform 2\nESM1b LLR score\n–10 10\nScore diﬀerence\nc\n1\nIsoform-2 \n(O00255-2)\nScore\ndiﬀerence\nPrimary  \nisoform \n(O00255-1)\nGWSPV\nPositions: 149–153MEN1 (Q8WY07)\nMenin 190\nMissing in isoform-2:\nESM1b LLR scoreScore diﬀerence\n0 –5 –101050–5–10 –15 –20\nResidue position\nTGFB3 isoform-2\n(P10600-2)\nScore\ndiﬀerence\n0 –5 –10 –15 –20 0 5–5\nResidue position\n5\n0\n–5\n–10\n–15\n–20\n–20\n1.0\n0.8\n0.6\n0.4\n0.2\n200 400 600 800 1,000\n0\n0\n–15 –10 –5 0 5\nMax isoform score\nMin isoform score\nDistance from junction\nRandom\nISV\nProportionProportion\nScore\nIsoform-sensitive variant positions\nPositions chosen uniformly at random\nMax_score > –7,\nMin_score < –8,\nDiﬀerence > 4\n1.0 1.00\n0.75\n0.50\n0.25\n0\n0.8\n0.6\n0.4\n0.2\n0\nACC TPR F1 MCC\n1 400\nResidue position\n600200\nTRP 150\nSER 151\nPRO 152\nSER 145\nLYS 151\nHIS 139 SER 145\nGLY 149\nTHR 148\nd\nAlphaFold: AF-P10600-F1\nTGFβ-3\nLAP\nLYS 50\nLEU 51\nARG 287\nGLU 399\nGLN 400\nGLU 104\nALA 102\nFig. 5 | ESM1b can detect isoform-specific variant effects. a, Approximately 1.8 \nmillion missense variants across ~9,000 genes in the human genome are ‘isoform \nsensitive’ , defined by (1) maximum ESM1b effect score (across isoforms) > −7, \n(2) minimum score < −8 and (3) difference between minimum and maximum \nscore > 4. b, T op: ISV are closer to splice junction than would be expected at \nrandom. Bottom-left: ISV in genes with domains containing splice junctions: \n90.31% versus 28.21% expected at random. Bottom-right: metrics of predicting \nwhether genes contain domains disrupted by splice junction given whether or \nnot they contain ISV. c, An example of a small splicing effect (excision of five \namino acids from the primary isoform of the MEN1 protein) leading to dramatic \nchanges in the predicted effects of variants in a much larger region. Bottom: \nAlphaFold structural predictions of the two isoforms. Arrows are pointing \nto a small surface pocket introduced by the five amino acid deletion (around \nSer145). d, An example of alternative splicing leading to a distant effect in the \nTGFB3 proprotein. Exclusion of the TGFβ-3 chain in an alternative isoform of the \nproprotein leads to a region at the beginning of the LAP chain (marked by orange) \nlosing its sensitivity to missense variants. Right: AlphaFold prediction of the \nbinding of the two chains showing these two regions to be close to one another in \n3D structure. ISV, isoform-sensitive variants; ACC, accuracy; TPR, true-positive \nrate; F1, F1 score; MCC, Matthew’s correlation coefficient.\nNature Genetics | Volume 55 | September 2023 | 1512–1522\n 1519\nArticle https://doi.org/10.1038/s41588-023-01465-0\ninvolved in many cancers, differs from the primary isoform by only \nfive amino acids deleted at positions 149–153. Differences in predicted \nvariant effects between the isoforms suggest that this small deletion \nintroduces a 30 amino acid region that is more prone to damaging \nvariants in the second MEN1 isoform (Fig. 5c ). Multiple studies have \nassociated missense variants in that region with cancer, suggesting \nthat it may be functional37–42. A 2017 study found aberrant expression \nof the second MEN1 isoform in tumors, but the functional differences \nbetween the two isoforms remain uncharacterized43. Comparing pre-\ndicted three-dimensional (3D) structures44, we observe a small surface \npocket introduced by the five amino acid deletion (Fig. 5c ), further \nsupporting its functional relevance. However, caution is advised when \nusing one computational model (AlphaFold) to validate the predictions \nof another (ESM1b).\nTransforming growth factor beta-3 (TGFB3) provides another \nexample of isoform-sensitive variants. This proprotein is cleaved into \ntwo chains, LAP and TGFβ-3, that form a functional dimer. However, an \nalternative truncated isoform lacks the TGFβ-3 chain. ESM1b predicts \nmany variants in the LAP chain as neutral only in the context of the trun-\ncated isoform, despite being over 200 residues away from the absent \nTGFβ-3 chain. While distant along the one-dimensional sequence, \nstructure prediction from AlphaFold44 suggests close contact between \nthese regions in 3D space (Fig. 5d).\nESM1b can predict the effects of multiresidue variants\nUnlike most VEP methods, protein language models can assess any \namino acid sequence and, therefore, be leveraged to predict the effects \nof any coding mutation, including in-frame indels and stop gains. We \nuse the term ‘indels’ to include insertions, deletions and deletion–inser-\ntion (delins) combinations. We defined the effect score of an in-frame \nindel to be the pseudo-log-likelihood ratio (PLLR) between the mutated \nand WT amino acid sequences, where the pseudo-log-likelihoods were \nestimated with ESM1b (Fig. 6a). Pathogenic indels, like missense vari-\nants, exhibit lower effect scores than benign indels (Fig. 6a).\nWe compared ESM1b to other models as a classifier of pathogenic \nversus benign in-frame indels (Fig. 6b). We considered the following \nthree variations of ESM1b PLLR scores: (1) vanilla PLLR, (2) weighted \nPLLR (accounting for indel size) and (3) absolute-valued PLLR, which \nconsiders functional changes as damaging whether they increase or \ndecrease likelihood (Methods). The absolute-value PLLR marginally \noutperforms (ROC-AUC = 0.874) the vanilla (0.869) and weighted \nPLLR (0.861). All variations of ESM1b PLLR scores outperform CADD \na b\nIndel RL_delinsQAAVD\nStop gain Q25*\nESM1b_LLR\nESM1b_score(Q25*)\nMost damaging  \nmutation after the stop\nc ESM1b-stop-gain score \nESM1b-indel score\nWT sequence:\n0.874 0.869 0.861\n0.835\n0.586 0.581\n0.501\nClinVar indels (3,470)\nP = 0.002\nP = 0.028\nP = 0.073\nInsertions\n(937)\nDeletions\n(2,248)\nDelins\n(285)\n0.874 0.868\n0.848\n0.831\n0.859\n0.756\n0.887\n0.857\n0.671\nP = 0.087\nP = 0.144\nP = 0.009\nP < 0.001\nP < 0.001\nP = 0.004\nd ClinVar stop-gain variants\nClinVar indels\nESM1b pseudo-log-likelihood ratio scores\nROC-AUC\n0.90\n0.85\n0.80\n0.75\n0.70\n0.65\n0.60\n0.55\n0.50\nROC-AUC\nESM1b-aPLLR ESM1b-PLLR ESM1b-wPLLR\nCADD CADD\nAlignment\nBlastP\nEdit distance ESM1b-aPLLR ESM1b-PLLR\nCADD\nESM1b-aPLLR ESM1b-PLLR\nCADD\nESM1b-aPLLR ESM1b-PLLR\n0.90\n0.85\n0.80\n0.75\n0.70\n0.65\n0.60\n0.55\n0.50\n0.80\nESM1b-minLLR\nNum. amino acid lost\nPct. amino acid lost\n50 bp rule\n0.75\n0.70\n0.65\n0.60\n0.55\n0.50 ROC-AUC\nNo NMD\n–40\n0\n0.05\n0.10\n0.15\n0.20\n0.25\n0.30\n0.35\n0.40\n–30 –20 –10 0 10 20\nESM1b-PLLR NMD All\nClinVar: benign (1,679)\nClinVar: pathogenic (1,791)\nESM1b_PLLR = PLL(s mut ) – PLL(s WT ),\nwhere PLL(s) = logPr(x i = s i|s)\ns mut\ns WT =\n=\ni\nFig. 6 | ESM1b effect predictions generalize to any coding variant. a, T op: \nfunctional effect scores are assigned to in-frame indels by invoking ESM1b on \nboth the WT and mutated protein sequence and calculating the PLLR between \nthem. Bottom: the distribution of ESM1b effect scores over 1,679 benign and \n1,791 pathogenic in-frame indels from ClinVar. b, Comparison between three \nversions of ESM1b-based effect scores, CADD (a supervised VEP method) and \nthree baseline models as classifiers of pathogenic versus benign in-frame \nindels (over the same set of variants as in a). One-tailed P values are shown \nfor the differences between the performance of CADD and the ESM1b-based \neffect scores (Methods). Right: partitioning of the 3,470 in-frame indels into \ndeletions, insertions and deletion–insertion combinations (delins). c, Functional \neffect scores are also assigned to stop-gain variants, defined as the LLR score \nassigned to the missense variant predicted to be the most deleterious among all \npossible missense variants in the lost region of the protein. Illustrated example: \nsubstitution of a glutamine into a stop codon at position 25. d, Assessment of \nESM1b and three baseline models as classifiers of pathogenic versus benign \nstop-gain variants, over variants expected to either (1) not undergo NMD (3,672 \npathogenic and 147 benign variants), (2) undergo NMD (32,362 pathogenic and \n198 benign variants) or (3) all stop-gain variants (36,034 pathogenic and 345 \nbenign variants). Error bars correspond to s.d. of the ROC-AUC scores centered \naround the mean (estimated by bootstrapping).\nNature Genetics | Volume 55 | September 2023 | 1512–1522 1520\nArticle https://doi.org/10.1038/s41588-023-01465-0\n(0.835) which, unlike most VEP methods supporting indels, was not \ndirectly trained on ClinVar and could therefore be evaluated. The per-\nformance gap is especially significant for delins variants (ESM1b = 0.887, \nCADD = 0.671). Both ESM1b and CADD outperformed the following \nthree baseline models: (1) edit distance (0.501), (2) pairwise sequence \nalignment (0.586) and (3) BlastP (0.581). We also computed ESM1b \neffect scores for all in-frame indel VUS in ClinVar and approximated this \ndistribution as a mixture of the pathogenic and benign distributions \n(Extended Data Fig. 3), estimating that 52% of these indels are patho-\ngenic (compared to 42% pathogenicity rate estimated for missense VUS).\nStop-gain variant effects can be predicted from the ESM1b scores \nfor missense variants, by assigning each stop-gain an effect score \ndetermined by the lowest (that is most damaging) LLR score across all \npossible missense variants in the lost region following the new stop \ncodon (Fig. 6c). Notably, ESM1b is a protein language model trained to \nassess protein sequence variations, while the effects of stop-gains are \noften at the transcript level through nonsense-mediated decay (NMD). \nIndeed, ESM1b is a good classifier for variants not resulting in NMD \naccording to the 50 bp rule45 (ROC-AUC = 0.734) but performs poorly \n(0.565) over variants expected to cause NMD (Fig. 6d). Over the set \nof non-NMD variants, ESM1b substantially outperforms two baseline \nmodels scoring stop-gains based on the total number of residues lost \n(0.649) or their fraction of the WT protein length (0.599).\nDiscussion\nA comprehensive evaluation shows that ESM1b outperforms other \nstate-of-the-art VEP methods at distinguishing pathogenic from benign \nvariants across ClinVar and HGMD/gnomAD, and at predicting effects \nreported by DMS assays. As a protein language model that does not \nexplicitly rely on homology, ESM1b offers several additional advantages \nfor VEP. As an unsupervised method, ESM1b poses no risk of informa-\ntion leakage from the training to the test sets in clinical (for example, \nClinVar and HGMD) or population genetics (for example, gnomAD) \ndatasets, allowing accurate and unbiased evaluation. Prediction with \nESM1b is much simpler and faster than with homology-based methods \nbecause only a single input sequence is required once a universal model \nhas been trained. Notably, protein language models can provide predic-\ntions for every possible amino acid sequence and are applicable to all \ncoding variants. In this work, the generalizability of ESM1b has been \ndemonstrated for (1) variants outside MSA coverage, (2) variants with \ndifferent effects on alternative protein isoforms, (3) in-frame indels \nand (4) stop-gain variants.\nWhile homology-based VEP methods like EVE have a strong track \nrecord4, many important protein domains and variants are outside MSA \ncoverage. Including regions with more distant homologs increases \ncoverage but reduces MSA quality and method performance. Pro -\ntein language models, on the other hand, are not directly affected \nby this tradeoff, as they are trained over all available sequences. \nSome recent strategies have integrated protein language models \nwith homology-based methods, building on the complementary \nstrengths of these two approaches and yielding promising prediction \naccuracy46,47.\nOur workflow is unique in its ability to predict variant effects across \nalternative isoforms, unlike existing methods that can only determine \nwhether a variant is included in an expressed isoform48 but not predict \nits unique effect in the context of that isoform. We highlighted 3,477 \nClinVar missense variants with variable predicted effects between \nisoforms, present in many disease-causing genes including BRCA1, IRF6 \nand TGFB3. Across the genome, ~1.8 million variants in ~9,000 genes \nwere predicted to be isoform sensitive. While these numbers depend \non definition thresholds, isoform-sensitive effects are clearly abun -\ndant. These variants tend to occur near splice sites and within genes \ncontaining splicing-disrupted domains, suggesting local effects, but \nsome splicing events are predicted to influence much larger or distant \nprotein regions. By combining isoform-specific effect predictions \nwith isoform expression data (for example, from GTEx 49), one could \npotentially trace the tissue affected by pathogenic variants.\nOther concurrent works exploring ESM models for VEP over clini-\ncal and DMS data have obtained results largely consistent with ours, \nestablishing protein language models as leading methods for this \ntask50,51. By addressing the protein length limitation, our framework \nallows genome-wide predictions for all coding variants. Consequently, \nwe compiled a complete catalog of all possible missense variant effects \nin the human genome (https://huggingface.co/spaces/ntranoslab/\nesm_variants). We further extended ESM1b to predict the effects of \nmultiresidue variants, demonstrating good performance over in-frame \nindels (including deletion–insertion combinations) and stop-gains. \nWhile numerous VEP methods target missense variants, fewer can \nscore more complex amino acid changes, with most trained on clinical \ndatabases like ClinVar.\nOur framework comes with some limitations. Unlike VEP meth -\nods that use genomic features to assess variant effects at the DNA or \ntranscript level, protein language models consider only amino acid \nchanges. This limitation is demonstrated by the poor performance of \nESM1b over variants leading to NMD. Similarly, ESM1b is not expected \nto detect variant effects on splicing 52, but as shown, it can uncover \nisoform-specific effects at the protein level. Another limitation of \nthe current framework is the lack of an explicit confidence metric for \nindividual predictions, a feature offered by some VEP methods for \nquality control. Notably, this is not an inherent limitation of ESM1b or \nother protein language models, and future research will likely yield \nalgorithms for quantifying prediction uncertainty. Finally, for the ~12% \nof human proteins too long for ESM1b to process as a single sequence, \nwe employed a sliding window approach (Methods), which we expect \nto fail at detecting extremely distant interactions, specifically between \nresidues separated by more than 1,022 amino acids.\nWe anticipate that our framework and public resource will be use-\nful for a broad range of human genetics tasks. For diagnosing Mendelian \ndiseases, integrating ESM1b effect scores with other information could \nhelp resolve the ambiguity of VUS. This remains a pressing need given \nthe high prevalence of VUS in clinical sequencing10, which leaves many \npatients without a clear diagnosis2,53–55. For genetic association studies, \nusing effect scores as priors could improve the power of variant burden \ntests and statistical fine-mapping1. For protein engineering, it has been \nshown that ESM1b effect scores can nominate gain-of-function variants \nwith therapeutic benefits56. Lastly, using protein language models for \nVEP can provide insights into protein function, such as discerning \nfunctional differences between alternative isoforms or identifying \nprotein domains and other functional units.\nOver the past decades, computational VEP methods have dramati-\ncally improved4. Given the results presented in this work, and in line \nwith the performance of language models in protein research 19,20,25,57 \nand general machine learning58,59, protein language modeling stands \nout as one of the most promising approaches to determine the clinical \nand biological consequences of genetic variants. It has been shown \nthat as language models scale in the number of parameters and train-\ning data, they tend to substantially improve19,58 (although this may not \nalways be straightforward60). We expect that the trend of larger and bet-\nter protein language models will continue to benefit and improve VEP.\nOnline content\nAny methods, additional references, Nature Portfolio reporting sum-\nmaries, source data, extended data, supplementary information, \nacknowledgements, peer review information; details of author contri-\nbutions and competing interests; and statements of data and code avail-\nability are available at https://doi.org/10.1038/s41588-023-01465-0.\nReferences\n1. Brandes, N., Weissbrod, O. & Linial, M. Open problems in human \ntrait genetics. Genome Biol. 23, 131 (2022).\nNature Genetics | Volume 55 | September 2023 | 1512–1522\n 1521\nArticle https://doi.org/10.1038/s41588-023-01465-0\n2. Richards, S. et al. Standards and guidelines for the interpretation \nof sequence variants: a joint consensus recommendation  \nof the American College of Medical Genetics and Genomics \nand the Association for Molecular Pathology. Genet. Med. 17, \n405–424 (2015).\n3. Rehm, H. L. & Fowler, D. M. Keeping up with the genomes:  \nscaling genomic variant interpretation. Genome Med. 12,  \n5 (2019).\n4. Frazer, J. et al. Disease variant prediction with deep generative \nmodels of evolutionary data. Nature 599, 91–95 (2021).\n5. Buniello, A. et al. The NHGRI-EBI GWAS catalog of published \ngenome-wide association studies, targeted arrays and summary \nstatistics 2019. Nucleic Acids Res. 47, D1005–D1012 (2018).\n6. Hamosh, A., Scott, A. F., Amberger, J. S., Bocchini, C. A. & \nMcKusick, V. A. Online Mendelian Inheritance in Man (OMIM), a \nknowledgebase of human genes and genetic disorders. Nucleic \nAcids Res. 33, D514–D517 (2005).\n7. Finucane, H. K. et al. Partitioning heritability by functional \nannotation using genome-wide association summary statistics. \nNat. Genet. 47, 1228–1235 (2015).\n8. Brandes, N., Linial, N. & Linial, M. Genetic association studies of \nalterations in protein function expose recessive effects on cancer \npredisposition. Sci. Rep. 11, 14901 (2021).\n9. Gudmundsson, S. et al. Variant interpretation using  \npopulation databases: lessons from gnomAD. Hum. Mutat. 43, \n1012–1030 (2021).\n10. Landrum, M. J. et al. ClinVar: public archive of interpretations  \nof clinically relevant variants. Nucleic Acids Res. 44,  \nD862–D868 (2015).\n11. Esposito, D. et al. MaveDB: an open-source platform to distribute \nand interpret data from multiplexed assays of variant effect. \nGenome Biol. 20, 223 (2019).\n12. Ursu, O. et al. Massively parallel phenotyping of coding variants in \ncancer with Perturb-seq. Nat. Biotechnol. https://doi.org/10.1038/\ns41587-021-01160-7 (2022).\n13. Boucher, J. I., Bolon, D. N. & Tawfik, D. S. Quantifying and \nunderstanding the fitness effects of protein mutations: laboratory \nversus nature. Protein Sci. 25, 1219–1226 (2016).\n14. Hopf, T. A. et al. Mutation effects predicted from sequence \nco-variation. Nat. Biotechnol. 35, 128–135 (2017).\n15. Ng, P. C. SIFT: predicting amino acid changes that affect protein \nfunction. Nucleic Acids Res. 31, 3812–3814 (2003).\n16. Adzhubei, I., Jordan, D. M. & Sunyaev, S. R. Predicting functional \neffect of human missense mutations using PolyPhen-2. Curr. \nProtoc. Hum. Genet. 76, 7–20 (2013).\n17. Rentzsch, P., Witten, D., Cooper, G. M., Shendure, J. & Kircher, M. \nCADD: predicting the deleteriousness of variants throughout  \nthe human genome. Nucleic Acids Res. 47, D886–D894  \n(2019).\n18. Boutet, E. et al. UniProtKB/Swiss-Prot, the manually annotated \nsection of the UniProt KnowledgeBase: how to use the entry view. \nMethods Mol. Biol. 1374, 23–54 (2016).\n19. Ofer, D., Brandes, N. & Linial, M. The language of proteins: \nNLP, machine learning & protein sequences. Comput. Struct. \nBiotechnol. J. 19, 1750–1758 (2021).\n20. Rives, A. et al. Biological structure and function emerge from \nscaling unsupervised learning to 250 million protein sequences. \nProc. Natl Acad. Sci. USA 118, e2016239118 (2021).\n21. Elnaggar, A. et al. CodeTrans: towards cracking the language \nof silicon’s code through self-supervised deep learning and \nhigh-performance computing. Preprint at arXiv https://doi.org/ \n10.48550 (2021).\n22. Strodthoff, N., Wagner, P., Wenzel, M. & Samek, W. UDSMProt: \nuniversal deep sequence models for protein classification. \nBioinformatics 36, 2401–2409 (2020).\n23. Alley, E. C., Khimulya, G., Biswas, S., AlQuraishi, M. & Church, G. \nM. Unified rational protein engineering with sequence-based \ndeep representation learning. Nat. Methods 16, 1315–1322 (2019).\n24. Brandes, N., Ofer, D., Peleg, Y., Rappoport, N. & Linial, M. \nProteinBERT: a universal deep-learning model of protein \nsequence and function. Bioinformatics 38, 2102–2110 (2022).\n25. Meier, J. et al. Language models enable zero-shot prediction of \nthe effects of mutations on protein function. Preprint at bioRxiv \nhttps://doi.org/10.1101/2021.07.09.450648 (2021).\n26. Stenson, P. D. et al. Human Gene Mutation Database (HGMD): \n2003 update. Hum. Mutat. 21, 577–581 (2003).\n27. Allison, R., Edgar, J. R. & Reid, E. Spastin MIT domain \ndisease-associated mutations disrupt lysosomal function. Front. \nNeurosci. 13, 1179 (2019).\n28. Nava, C. et al. Hypomorphic variants of cationic amino acid \ntransporter 3 in males with autism spectrum disorders. Amino \nAcids 47, 2647–2658 (2015).\n29. Shoubridge, C., Tan, M. H., Seiboth, G. & Gecz, J. ARX \nhomeodomain mutations abolish DNA binding and lead to a loss of \ntranscriptional repression. Hum. Mol. Genet. 21, 1639–1647 (2012).\n30. Bienvenu, T. et al. ARX, a novel Prd-class-homeobox gene highly \nexpressed in the telencephalon, is mutated in X-linked mental \nretardation. Hum. Mol. Genet. 11, 981–991 (2002).\n31. Marques, I. et al. Unraveling the pathogenesis of ARX polyalanine \ntract variants using a clinical and molecular interfacing approach. \nMol. Genet. Genom. Med. 3, 203–214 (2015).\n32. Cho, G., Nasrallah, M. P., Lim, Y. & Golden, J. A. Hypomorphic \nvariants of cationic amino acid transporter 3 in males with autism \nspectrum disorders. Amino Acids 13, 23–29 (2012).\n33. Liu, X., Li, C., Mou, C., Dong, Y. & Tu, Y. dbNSFP v4: a \ncomprehensive database of transcript-specific functional \npredictions and annotations for human nonsynonymous and \nsplice-site SNVs. Genome Med. 12, 1–8 (2020).\n34. Eyre-Walker, A. & Keightley, P. D. High genomic deleterious \nmutation rates in hominids. Nature 397, 344–347 (1999).\n35. Kryukov, G. V., Pennacchio, L. A. & Sunyaev, S. R. Most rare \nmissense alleles are deleterious in humans: implications for \ncomplex disease and association studies. Am. J. Hum. Genet. 80, \n727–739 (2007).\n36. Bourdon, J.-C. et al. p53 isoforms can regulate p53 transcriptional \nactivity. Genes Dev. 19, 2122–2137 (2005).\n37. Toledo, R. A. et al. Novel MEN1 germline mutations in Brazilian \nfamilies with multiple endocrine neoplasia type 1. Clin. \nEndocrinol. 67, 377–384 (2007).\n38. Huang, J. et al. The same pocket in menin binds both MLL and \nJUND but has opposite effects on transcription. Nature 482, \n542–546 (2012).\n39. Cebrian, A. et al. Mutational and gross deletion study of the MEN1 \ngene and correlation with clinical features in Spanish patients.  \nJ. Med. Genet. 40, e72 (2003).\n40. Martín-Campos, J. M. et al. Molecular pathology of multiple \nendocrine neoplasia type I: two novel germline mutations and \nupdated classification of mutations affecting MEN1 gene. Diagn. \nMol. Pathol. 8, 195–204 (1999).\n41. Agarwal, S. K. et al. Menin interacts with the AP1 transcription \nfactor JunD and represses JunD-activated transcription. Cell 96, \n143–152 (1999).\n42. Klein, R. D., Salih, S., Bessoni, J. & Bale, A. E. Clinical testing \nfor multiple endocrine neoplasia type 1 in a DNA diagnostic \nlaboratory. Genet. Med. 7, 131–138 (2005).\n43. Ehrlich, L. et al. miR-24 inhibition increases menin expression and \ndecreases cholangiocarcinoma proliferation. Am. J. Pathol. 187, \n570–580 (2017).\n44. Jumper, J. et al. Highly accurate protein structure prediction with \nAlphaFold. Nature 596, 583–589 (2021).\nNature Genetics | Volume 55 | September 2023 | 1512–1522 1522\nArticle https://doi.org/10.1038/s41588-023-01465-0\n45. Nagy, E. & Maquat, L. E. A rule for termination-codon position \nwithin intron-containing genes: when nonsense affects RNA \nabundance. Trends Biochem. Sci. 23, 198–199 (1998).\n46. Notin, P. et al. Tranception: protein fitness prediction with \nautoregressive transformers and inference-time retrieval. In Proc. \n39th International Conference on Machine Learning (PMLR, 2022).\n47. Notin, P. M. et al. TranceptEVE: combining family-specific and \nfamily-agnostic models of protein sequences for improved  \nfitness prediction. Preprint at bioRxiv https://doi.org/ \n10.1101/2022.12.07.519495 (2022).\n48. Cummings, B. B. et al. Transcript expression-aware annotation \nimproves rare variant interpretation. Nature 581, 452–458 (2020).\n49. Lonsdale, J. et al. The Genotype-Tissue Expression (GTEx) project. \nNat. Genet. 45, 580–585 (2013).\n50. Dunham, A. S., Beltrao, P. & AlQuraishi, M. High-throughput deep \nlearning variant effect prediction with Sequence UNET. Genome \nBiol. 24, 110 (2023).\n51. Livesey, B. J. & Marsh, J. A. Updated benchmarking of variant \neffect predictors using deep mutational scanning. Mol. Syst. Biol. \n19, e11474 (2023).\n52. Starita, L. M. et al. A multiplex homology-directed DNA repair \nassay reveals the impact of more than 1,000 BRCA1 missense \nsubstitution variants on protein function. Am. J. Hum. Genet. 103, \n498–508 (2018).\n53. Nicora, G., Zucca, S., Limongelli, I., Bellazzi, R. & Magni, P. A \nmachine learning approach based on ACMG/AMP guidelines for \ngenomic variant classification and prioritization. Sci. Rep. 12, \n2517 (2022).\n54. Tavtigian, S. V. et al. Modeling the ACMG/AMP variant \nclassification guidelines as a Bayesian classification framework. \nGenet. Med. 20, 1054–1060 (2018).\n55. Tavtigian, S. V., Harrison, S. M., Boucher, K. M. & Biesecker, L. G. \nFitting a naturally scaled point system to the ACMG/AMP variant \nclassification guidelines. Hum. Mutat. 41, 1734–1737 (2020).\n56. Hie, B. L. et al. Efficient evolution of human antibodies from \ngeneral protein language models and sequence information \nalone. Nat. Biotechnol. https://doi.org/10.1038/s41587-023-01763-2 \n(2023).\n57. Rao, R. et al. Evaluating protein transfer learning with TAPE.  \nAdv. Neural Inf. Process. Syst. 32, 9689 (2019).\n58. Thoppilan, R. et al. Lamda: language models for dialog applications.  \nPreprint at arXiv https://doi.org/10.48550/arXiv.2201.08239 \n(2022).\n59. Bubeck, S. et al. Sparks of artificial general intelligence: early \nexperiments with gpt-4. Preprint at arXiv https://doi.org/10.48550/\narXiv.2303.12712 (2023).\n60. Nijkamp, E., Ruffolo, J., Weinstein, E. N., Naik, N. & Madani, A. \nProGen2: exploring the boundaries of protein language models. \nPreprint at arXiv https://doi.org/10.48550/arXiv.2206.13517 (2022).\nPublisher’s note Springer Nature remains neutral with regard to \njurisdictional claims in published maps and institutional affiliations.\nOpen Access This article is licensed under a Creative Commons \nAttribution 4.0 International License, which permits use, sharing, \nadaptation, distribution and reproduction in any medium or format, \nas long as you give appropriate credit to the original author(s) and the \nsource, provide a link to the Creative Commons license, and indicate \nif changes were made. The images or other third party material in this \narticle are included in the article’s Creative Commons license, unless \nindicated otherwise in a credit line to the material. If material is not \nincluded in the article’s Creative Commons license and your intended \nuse is not permitted by statutory regulation or exceeds the permitted \nuse, you will need to obtain permission directly from the copyright \nholder. To view a copy of this license, visit http://creativecommons.\norg/licenses/by/4.0/.\n© The Author(s) 2023\nNature Genetics\nArticle https://doi.org/10.1038/s41588-023-01465-0\nMethods\nThis study did not require any ethical approval.\nESM1b\nIn this study, we have leveraged and expanded the use of ESM1b, a \nprotein language model developed by MetaAI 20. The code and pre -\ntrained parameters for ESM1b (and other ESM models) were taken \nfrom the model’s official GitHub repository at https://github.com/\nfacebookresearch/esm. Throughout this work, we used the esm1b_\nt33_650M_UR50S model (downloaded from https://dl.fbaipublicfiles.\ncom/fair-esm/models/esm1b_t33_650M_UR50S.pt). Other ESM models, \nwhich are subtle variations of ESM1b, also exist and have been sug -\ngested specifically for the task of VEP (for example, ESM1v) 25. Com-\nparison of all ESM models, including ESM1b, ESM1 and the five ESM1v \nmodels, indicates that ESM1b is the best-performing ESM model over \nthe three benchmarks used in this work, while an ensemble ESM1v \nmodel averaging the predictions of the five individual ESM1v models \nslightly outperforms ESM1b (Extended Data Fig. 4). In this work, we \nsought to explore the potential of a protein language model as a VEP \nmethod and therefore focused on a nonensemble model (ESM1b).\nMissense effect scores\nESM1b can compute the LLR scores for all possible missense mutations \nin a protein through a single pass of the neural network. With the WT \namino acid sequence as input, ESM1b outputs the log-likelihood of \neach of the 20 standard amino acids (including the WT amino acid) at \neach position of the protein sequence. The LLR score of each mutation \nis the difference between the log-likelihood of the missense and WT \namino acids at that position (Fig. 1b). Proteins longer than 1,022 amino \nacids are tiled through the sliding window approach described in the \n‘Handling long sequences’ section below.\nHandling long sequences\nESM1b, using learned positional embeddings and self-attention (which \ngrows quadratically in memory and compute), is limited to sequence \nlengths of up to 1,022 amino acids20. However, ~12% of human proteins in \nUniProt exceed this length18. T o overcome this limitation, we employed \na sliding window approach, subdividing longer sequences into over-\nlapping 1,022 amino acid windows with at least 511 amino acid overlap \n(Extended Data Fig. 5). Each protein sequence was tiled by iteratively \ngenerating 1,022 amino acid window from both ends of the sequence \nsuch that consecutive windows had exactly 511 amino acid overlap \nuntil windows from both ends met at the center. If the overlap between \nthe central windows was less than 511 amino acids, an additional 1,022 \namino acid window was added at the center. The window subsequences \nwere provided as inputs for ESM1b to compute the LLR scores for \nall missense variants (each variant with respect to all the windows \ncontaining it). With most residues covered by multiple overlapping \nwindows (up to three windows, by construction), final variant effect \nscores were determined by a weighted average approach. T o mitigate \npotential edge effects, weights near window edges were constructed \nwith a sigmoid function (Extended Data Fig. 5a). A variant’s final effect \nscore was calculated by (w (i1) × s1+…+w(ik) × sk) / (w(i1)+…+w(ik)),  \nwhere s1,…,sk are the effect scores of the variant in the context of each \nof the k windows containing it (1 ≤ k ≤ 3), i1,…,ik are the variant’s posi-\ntions in these windows, and w is the window weight function (Extended \nData Fig. 5b–e).\nWe also considered other methods for tiling long sequences and \naggregating effect scores across the 1–3 windows covering each variant. \nBesides the described weighted average, we tested (1) simple average \n(that is, without weights), (2) minimum (that is, the most damaging \neffect score), (3) maximum (that is, least damaging) and (4) placing the \nvariant at the center of a single window. We compared the approaches in \ntwo complementary ways. First, we evaluated the five tiling approaches \nover the ClinVar benchmark with varying window sizes (Extended Data \nFig. 6a), finding, as expected, that performance improves with window \nsize. At a window size of 1,022 amino acids (the maximum supported \nby ESM1b), no approach outperformed the weighted average. Notably, \nplacing each variant at the center of a single window is too inefficient \nfor a genome-wide analysis as it processes each variant individually, \nwhereas sliding window approaches invoke ESM1b once to process all \nthe mutations in each window. As a second comparison, we quantified \nthe error induced by using multiple windows as opposed to a single \nwindow (over short enough sequences that fit in one window). Once \nagain, none of the alternative approaches is superior at the maximum \nwindow sizes (Extended Data Fig. 6b). Due to the compute burden, we \nomitted the variant-at-the-center approach in this comparison, con-\nsidering instead a sliding window approach without overlap between \nconsecutive windows.\nGeneralized effect scores for indels and stop-gain variants\nUnlike missense effect scores, computing generalized effect scores for \nin-frame indels requires the neural network to be invoked separately \non each mutated sequence. The pseudo-log-likelihood of a sequence \ns = s1,…, sL is calculated as PLL(s)= ∑\nL\ni=1 logPr(xi = si|s), where L is the \nsequence length, si is the amino acid at position i, and log Pr(xi = si|s) is \nthe log-likelihood predicted by ESM1b for observing the input amino \nacid si at position i given the entire input sequence s. In this framing, \nthe output of ESM1b is considered a sequence of random variables \nx = x1,…,xL, where xi expresses the probabilities of observing each of \nthe 20 standard amino acids at position i. The effect score of an in-frame \nindel is the PLLR between the mutated and WT sequences: \nPLL(smut) − PLL(sWT) (Fig. 6a).\nGiven the protein length limit of ESM1b, if either the WT or mutated \nsequences exceed 1,022 amino acids, PLLR is calculated using subse-\nquences that satisfy this constraint. These subsequences include the \nregion deleted and/or inserted by the indel together with unaffected \nregions before and after the indel (which are included as context for \nboth the WT and mutated sequences). Before the indel, we include \na segment of 511 residues (or as many as there are). After the indel, \nwe include the number of residues that would complete the overall \nlength to 1,022 amino acids, considering the longer between the WT \nor mutated sequence. The PLLs for the mutated and WT sequences are \nthen calculated with respect to that window.\nWe refer to the PLLR score described above as ‘vanilla’ PLLR, while \nalso considering the following two minor variations: (1) weighted PLLR \nand (2) absolute-valued PLLR (Fig. 6b ). The weighted PLLR aims to \naccount for a potential bias when the WT and mutated sequences have \ndifferent lengths. Because LLR subtracts the sum of log-likelihoods \nacross WT positions from that of the mutated sequence, there is a \nconcern for subtracting incomparable values if the WT sequence \nlength LWT is too different from the mutated sequence length Lmut. The \nweighted PLLR attempts to correct for that by replacing the vanilla \nsubtraction PLL(s mut ) − PLL(s WT ) with \n1\nLmut\nPLL(smut)−\n1\nLWT\nPLL(sWT). \nThe fact that the weighted PLLR does not outperform the vanilla \nPLLR (Fig. 6b) suggests that PLL scores predicted by ESM1b are over-\nall well-calibrated likelihood estimates for sequences of varying \nlengths. The absolute-valued PLLR replaces the vanilla subtraction \nwith |PLL(smut) − PLL(sWT)|. The rationale for this transformation is to \nalso consider variants that dramatically increase the overall likelihood \nof a protein as potentially pathogenic. For example, a gain-of-function \nmutation may appear more likely from an evolutionary perspective, \nyet such mutations are often pathogenic.\nT o score stop-gain variants, we initially compute missense LLR \nscores for the entire protein sequence (invoking the sliding window \napproach if needed). The effect score of a stop-gain variant is then \nchosen to be the lowest LLR score (that is predicted most damaging) \namong all possible missense mutations in the lost region (Fig. 6c). The \nrationale is to assess how important the lost region at the end of the \nNature Genetics\nArticle https://doi.org/10.1038/s41588-023-01465-0\nprotein is to its function, and assign lower scores the more functionally \nimportant it is. As demonstrated by the analysis of protein domains \n(Figs. 1d and 3d), functionally important protein regions contain mis-\nsense mutations with lower ESM1b scores.\nAUC metrics for pathogenicity classification\nT o compare the performance of ESM1b and other VEP methods \nas variant pathogenicity classifiers, we primarily used ROC-AUC  \n(Fig. 2b,e–h), the standard evaluation metric for binary classifiers 61. \nIn addition to ROC-AUC, which considers the tradeoff between the \ntrue- and false-positive rates (Extended Data Fig. 1a), we also used a \nbalanced version of the PRC-AUC metric, which considers the tradeoff \nbetween precision and recall (Fig. 2e,f ). Unlike ROC-AUC, PRC-AUC \nis generally sensitive to label imbalance (that is, an uneven split of \npathogenic/benign variants) in the evaluation dataset. T o balance this \nmetric, we randomly downsampled each dataset into an equal number \nof pathogenic and benign variants (80% of the variants in the minority \nclass) and calculated the PRC-AUC over the balanced dataset. T o obtain \naccurate scores, we repeated downsampling 100 times and calculated \nthe average of the resulting PRC-AUC scores.\nWe treated the entire set of pathogenic and benign variants (from \nClinVar10 or HGMD/gnomAD9,26) as a single genome-wide classification \ntask to calculate a global ROC-AUC. This is somewhat different from the \ngene-average ROC-AUC reported in the publication introducing EVE4. \nUnder the gene-average approach, each gene was evaluated separately, \nyielding a gene-specific ROC-AUC for the 1,654 human genes with at \nleast one annotated ClinVar variant per class (pathogenic/benign). \nAveraging across these genes gave the gene-average ROC-AUC. ESM1b \nis consistently superior to all other methods according to the global \nROC-AUC (Fig. 2b,e–h), while EVE is somewhat superior according \nto the gene-average ROC-AUC over this subset of genes (Extended \nData Fig. 1b). This suggests that ESM1b provides scores that are more \nconsistent and comparable across different genes, which may be \nattributed to EVE being an assembly of multiple gene-specific mod -\nels, whereas ESM1b is a universal model trained over all known protein \nsequences. We argue that global ROC-AUC is usually more informative \nthan gene-average ROC-AUC for VEP, as diagnosing genetic diseases \noften involves comparing variants across multiple genes, requiring \nwell-calibrated scores.\nIn Fig. 6d , we estimated uncertainty for the ROC-AUC metrics \nthrough bootstrapping. In each bootstrapping iteration, we randomly \nsampled 140 pathogenic and 140 benign variants from each of the three \ngroups of stop-gain variants (3,672 pathogenic and 147 benign variants \nnot expected to lead to NMD, 32,441 pathogenic and 198 benign variants \nexpected to lead to NMD, and 36,113 pathogenic and 345 benign vari-\nants overall). Following 20 iterations, we calculated the mean ROC-AUC \nand s.d. (presented as error bars in Fig. 6d) for each condition.\nOther VEP methods\nOther than ESM1b and EVE, we evaluated 44 other VEP methods  \n(Figs. 2 and 3). Predicted effect scores for most VEP methods were taken \nfrom dbNSFP33. We used the dbnsfp4.3a.zip file from the dbNSFP web-\nsite (http://database.liulab.science/dbNSFP). We excluded LINSIGHT \n(which had too few variants for reliable evaluation) and three versions \nof fitCons based on the H1-hESC, HUVEC and GM12878 cell lines (which \nshowed near random performance on ClinVar and HGMD/gnomAD). \nWe further included two other recent state-of-the-art methods not \nreported in dbNSFP—VARITY (consisting of the following two versions: \nVARITY_R and VARITY_ER)62 and MTBAN63.\nOf the 46 VEP methods, 19 meet the criteria for evaluation on clini-\ncal benchmarks for missense variants (ClinVar and HGMD/gnomAD), \nhaving avoided training on clinical databases, using features from other \nmethods trained on such data, or using allele frequency (Supplemen-\ntary Table 2). DMS assays generally avoid this data leakage issue, hence \nwe compared all 46 methods on the DMS benchmark. T o allow unbiased \nevaluation of VARITY on the DMS benchmark, we excluded the variants \nincluded in its training (provided in the method’s GitHub repository \nat https://github.com/joewuca/varity). Both VARITY and MTBAN were \nexcluded from the comparison over the set of DMS variants avail -\nable for all methods (Fig. 3a), to prevent a significant reduction in the \nnumber of variants and genes. Specifically, VARITY was trained on five \ngenes (BRCA1, CBS, MSH2, MTHR and PTEN) and MTBAN misses three \nother genes (A4, SYUA and YAP1) of the 11 genes in that comparison.  \nBoth methods were still included in the direct comparison against \nESM1b (Fig. 3c).\nBaseline scores of indel and stop-gain variant effects\nWhile numerous VEP methods predict missense variant effects (46 \nevaluated here; Figs. 2 and 3), few handle indel and stop-gain variants. \nThe vast majority of these have been trained on clinical databases \nlike ClinVar, leading to circularity issues when evaluating them on \nthe same benchmarks. Therefore, we compared ESM1b to only one \nother VEP method (CADD) over the ClinVar benchmark of in-frame \nindels (Fig. 6b ) and none over stop-gain variants (Fig. 6d). T o pro -\nvide context for the performance of ESM1b on these benchmarks, \nwe considered several basic scoring algorithms that we consider \nreasonable baselines.\nFor in-frame indels, we considered baseline scores based on the \nfollowings: (1) edit distance, (2) pairwise alignment and (3) BlastP. \nThe Levenshtein edit distance determines the minimal number of \nsingle-amino acid operations (insertions, deletions or substitutions) \nneeded to transform the WT into the mutated sequence. The pairwise \nalignment score reflects the overall similarity between the WT and \nmutated sequence after they are aligned (match score = 2, mismatch \nscore = −1)64. BlastP uses the same alignment algorithm with a scoring \nsystem that also takes into account the different amino acid propen-\nsities (with BLOSUM62 (ref. 65)) and panelizes gaps. All three scores \nshare the same premise that the more dissimilar the WT and mutated \nsequences are, the more likely the indel to be damaging.\nFor stop-gain variants, we considered the following baseline \nscores: (1) the number of residues lost, (2) the percentage of residues \nlost (relative to the WT sequence length) and (3) the 50 bp rule. Con-\nsidering the number or percentage of lost residues shares the premise \nthat larger lost regions are more likely to be damaging. The 50 bp rule \nasserts that a transcript is likely to undergo NMD only if a stop codon \nis introduced more than 50 base pairs upstream of the last exon junc-\ntion within its coding region 45. We applied the 50 bp rule based on \nexon annotations in the human genome (Supplementary Methods). \nUnlike the other baselines that provide continuous scores, the 50 bp \nrule provides binary labels.\nTesting for significant performance differences\nWhen comparing the performance of ESM1b to that of other VEP meth-\nods across benchmarks (Figs. 2b,g,h, 3c and 6b), statistical significance \nwas determined through permutation tests. In each iteration, we shuf-\nfled the effect scores assigned by each method between the bench -\nmark’s variants, and recalculated the output metric (AUC score or \nSpearman’s correlation) for ESM1b and the compared method. The \nempirical one-tailed P value was the fraction of 2,000 iterations where \nthe difference in output metric was as extreme as that with the actual, \nnonpermuted effect scores. If no permutations gave a difference as large \nas the one measured for the true effect scores, we reported P < 0.001.\nDMS\nWe evaluated 46 VEP methods, including ESM1b and EVE, on a DMS \nbenchmark spanning 28 assays across 15 genes. We used the same set \nof human genes as in ref. 4  (excluding Rhodopsin 66 due to unavail -\nable public data), and added three other genes from MaveDB 11. We \ndownloaded all accessible experimental data for these assays (Sup -\nplementary Table 1).\nNature Genetics\nArticle https://doi.org/10.1038/s41588-023-01465-0\nThroughout our evaluation, we used the raw experimental scores \nwithout any further processing for all DMS, except for CALM1, TPK1, \nRASH, TADBP and the abundance assay of SYUA. For these assays, \nwe transformed the scores by x  → |x – xWT|, where x WT denotes the \nassay-wide value measured for WT. The motivation for this transfor-\nmation is that variants scoring higher than WT are typically seen as \ndeleterious in these assays (see discussions in refs. 67,68). For SYUA, \nas lower abundance variants are less toxic, the abundance scores were \ntransformed the same way to better reflect fitness (Supplementary  \nFig. 2 in ref. 69). This preprocessing noticeably improved the perfor-\nmance of all VEP methods on these assays.\nFor each assay, we calculated Spearman’s rank correlation between \nthe assay scores and each VEP method’s predictions. We then averaged \nthese correlation coefficients per gene, which may encompass multiple \nassays (Fig. 3b and Extended Data Figs. 1c and 2). Finally, we averaged \nthe per-gene averages (Fig. 3a,c).\nStatistics and reproducibility\nAll data used in this work is within the public domain (except HGMD, \nwhich requires access request). The full benchmark datasets and \nPython code for our ESM1b-based workflow are available on our GitHub \nrepository (Data availability and Code availability statements). For \ndetails on our statistical analysis, see the subsection ‘T esting for sig-\nnificant performance differences’ . No statistical method was used to \npredetermine the sample size.\nReporting summary\nFurther information on research design is available in the Nature Port-\nfolio Reporting Summary linked to this article.\nData availability\nAll data used in this study are already within the public domain, with \nthe exception of the HGMD dataset (https://www.hgmd.cf.ac.uk/\nac/index.php), which is a private resource owned by the Institute of \nMedical Genetics in Cardiff University (requests to access this data -\nbase should be directed to its curators). ClinVar labels for missense, \nindel and stop-gain variants were downloaded directly from ClinVar’s \nwebsite (https://ftp.ncbi.nlm.nih.gov/pub/clinvar/tab_delimited/  \nvariant_summary.txt.gz). A specific ClinVar benchmark with EVE scores \nwas downloaded from the EVE portal (https://evemodel.org/). Details \non how the datasets and benchmarks were processed are available in \nSupplementary Methods. Predicted effect scores for most VEP meth-\nods were downloaded from dbNSFP (http://database.liulab.science/\ndbNSFP). Details on the remaining VEP methods are available in the \n‘Other VEP methods’ section in Methods. We also provide all processed \nbenchmarks, with effect scores from all VEP methods compared in this \nwork, on our GitHub repository (link below). All benchmark results \nare in Supplementary Table 2. The complete catalog of variant effect \nscores predicted by ESM1b for all possible missense variants affecting \ncurated protein isoforms in the human genome can be browsed and \ndownloaded through our web portal at https://huggingface.co/spaces/\nntranoslab/esm_variants.\nCode availability\nCode for calculating variant effect scores with our framework and \nprocessed data files are available on our GitHub repository (https://\ngithub.com/ntranoslab/esm-variants). All the code and data for pro-\nducing the analysis, figures and results presented in this study are \navailable on Zenodo70.\nReferences\n61. Pedregosa, F. et al. Scikit-learn: machine learning in Python.  \nJ. Mach. Learn. Res. 12, 2825–2830 (2011).\n62. Wu, Y. et al. Improved pathogenicity prediction for rare human \nmissense variants. Am. J. Hum. Genet. 108, 1891–1906 (2021).\n63. Kim, H. Y., Jeon, W. & Kim, D. An enhanced variant effect predictor \nbased on a deep generative model and the born-again networks. \nSci. Rep. 11, 19127 (2021).\n64. Cock, P. J. A. et al. Biopython: freely available Python tools \nfor computational molecular biology and bioinformatics. \nBioinformatics 25, 1422–1423 (2009).\n65. Henikoff, S. & Henikoff, J. G. Amino acid substitution matrices  \nfrom protein blocks. Proc. Natl Acad. Sci. USA 89, 10915–10919 \n(1992).\n66. Penn, W. D. et al. Probing biophysical sequence constraints within \nthe transmembrane domains of rhodopsin by deep mutational \nscanning. Sci. Adv. 6, eaay7505 (2020).\n67. Weile, J. et al. A framework for exhaustively mapping functional \nmissense variants. Mol. Syst. Biol. 13, 957 (2017).\n68. Bandaru, P. et al. Deconstruction of the Ras switching cycle \nthrough saturation mutagenesis. eLife 6, e27810 (2017).\n69. Newberry, R. W., Leong, J. T., Chow, E. D., Kampmann, M. & \nDeGrado, W. F. Deep mutational scanning reveals the  \nstructural basis for α-synuclein activity. Nat. Chem. Biol. 16, \n653–659 (2020).\n70. Brandes, N. & Ntranos, V. ESM variants—data & code for analysis \nand figures. Zenodo https://doi.org/10.5281/zenodo.8088402 \n(2023).\nAcknowledgements\nWe would like to thank P. Stenson, M. Mort and D. Cooper from Cardiff \nUniversity for providing us with access to the HGMD database. We \nwould also like to thank our funders. C.J.Y. is supported by the NIH \ngrants R01AR071522, R01AI136972, U01HG012192 and R01HG011239 \nand the Chan Zuckerberg Initiative, and is an investigator at the Chan \nZuckerberg Biohub and a member of the Parker Institute for Cancer \nImmunotherapy (PICI). N.B. is a Cancer Research Institute Irvington \nFellow supported by the Cancer Research Institute (CRI4499). The \nfunders had no role in study design, data collection and analysis, \ndecision to publish or preparation of the manuscript.\nAuthor contributions\nV.N. conceptualized the project. N.B. and V.N. designed the \nESM1b-based VEP framework. N.B., G.G. and C.H.W. prepared the \nbenchmarks. N.B. and V.N. evaluated the performance of ESM1b and \nother methods over the benchmarks. N.B. and V.N. prepared the \nfigures. N.B., C.J.Y. and V.N. interpreted the results. G.G. assisted with \nthe literature review. N.B., C.J.Y. and V.N. wrote the original draft of the \nmanuscript. All authors reviewed and edited the manuscript. C.J.Y. and \nV.N. supervised the project.\nCompeting interests\nThe authors declare no competing interests.\nAdditional information\nExtended data is available for this paper at  \nhttps://doi.org/10.1038/s41588-023-01465-0.\nSupplementary information The online version  \ncontains supplementary material available at  \nhttps://doi.org/10.1038/s41588-023-01465-0.\nCorrespondence and requests for materials should be addressed to \nChun Jimmie Ye or Vasilis Ntranos.\nPeer review information Nature Genetics thanks the anonymous \nreviewers for their contribution to the peer review of this work.\nReprints and permissions information is available at  \nwww.nature.com/reprints.\nNature Genetics\nArticle https://doi.org/10.1038/s41588-023-01465-0\nExtended Data Fig. 1 | See next page for caption.\nNature Genetics\nArticle https://doi.org/10.1038/s41588-023-01465-0\nExtended Data Fig. 1 | Comprehensive evaluation of ESM1b and EVE on \nClinVar, HGMD/gnomAD and deep mutation scans. (a) ROC curves of ESM1b \nand EVE as binary classifiers of variant pathogenicity over ClinVar (left) and \nHGMD/gnomAD (right). The true positive rate at the standard false positive rate \n(0.05) is annotated across all 4 curves. (b) Evaluation of EVE (left bar plots) and \nESM1b (right bar plots) over ClinVar (top panels) and HGMD/gnomAD (bottom \npanels), using either the global ROC-AUC (red) or gene-average ROC-AUC \n(yellow) metric (see the relevant section in the Methods). For each dataset, we \nshow the results for either the full dataset (left panels), or the subsets of variants \nin long (middle panels) or short (right panels) proteins (defined by a threshold \nof 1,022aa, which is the maximum window length supported by ESM1b; see \nMethods). Dashed lines: the top score (obtained by ESM1b or EVE) according \nto each of the two metrics. (c) Evaluation of ESM1b and EVE on deep mutational \nscanning datasets over each of the 28 assays (which were aggregated per gene in \nFig. 3b).\nNature Genetics\nArticle https://doi.org/10.1038/s41588-023-01465-0\nExtended Data Fig. 2 | Per-gene evaluation of top VEP methods on deep \nmutational scans. Per-gene DMS results for the 9 VEP methods that are closest to \nESM1b in performance according to the head-to-head comparison (Fig. 3c). The \nnumbers of unique variants scored by each VEP method, out of the total 76,133 \nvariants in the full DMS dataset, are shown in square brackets next to the method \nnames. The numbers of variants per gene are shown in parentheses next to the \ngene names.\nNature Genetics\nArticle https://doi.org/10.1038/s41588-023-01465-0\nExtended Data Fig. 3 | Estimating the pathogenicity rate among indel \nvariants of uncertain significance. In gray: the distribution of ESM1b PLLR \neffect scores across indels in ClinVar annotated as variants of uncertain \nsignificance (VUS). We estimated the fraction of pathogenic and benign variants \namong these VUS indels by decomposing the VUS distribution of effect scores \nas a mixture of the distributions over pathogenic and benign variants (Fig. 6a) \napproximated by kernel density estimation. Red and blue curves: the mixture \ncomponents of pathogenic and benign effect scores, respectively. Black dashed \ncurve: the sum of the pathogenic (red) and benign (blue) components as an \nestimate of the empirical distribution of VUS (gray).\nNature Genetics\nArticle https://doi.org/10.1038/s41588-023-01465-0\nExtended Data Fig. 4 | Evaluation and comparison of different ESM models. \nT ested ESM models: ESM1b, ESM1, the five ESM1v models, and an assembly of the \nfive ESM1v models into a single model averaging the LLR scores obtained by the 5 \nmodels (ESM1v-avg). (a) Performance of the different ESM models on the clinical \nbenchmarks (ClinVar and HGMD/gnomAD). Each model was evaluated as a binary \nclassifier of pathogenic vs. benign missense variants over the two benchmarks \nusing the global ROC-AUC metric. Only proteins smaller than 1,022aa were \nconsidered in this evaluation (thereby avoiding the sliding window approach).  \n(b) Performance of the ESM models on the DMS benchmark.\nNature Genetics\nArticle https://doi.org/10.1038/s41588-023-01465-0\nExtended Data Fig. 5 | The sliding-window approach to tile long protein \nsequences with ESM1b. (a) The variant weights over each window’s coordinates \n(1 ≤ i ≤ 1022), defined by the function: w(i) = 1 / (1 + exp(-(i-128)/16) for 1 ≤ i < 256, \nw(i) = 1 for 256 ≤ i < 1022- 256, and w(i) = 1/(1 + exp((i-1022 + 128)/16) for 1022-\n256 ≤ i ≤ 1022. (b) An example tiling of a protein sequence of length 1,479aa.  \nLeft: raw window weights (as in (a)). Right: normalized weights (summing up to 1 \nat each protein position). (c) Example of how a specific protein isoform (UniProt \nID Q7Z460-5) is tiled. T op panel: ESM1b effect scores over the left window \n(1 ≤ i ≤ 1022; orange), the right window (458 ≤ i ≤ 1479; green), and the final \nweighted average throughout the entire protein’s length (blue). Middle: ESM1b \neffect scores over the left window. Bottom: ESM1b effect scores over the right \nwindow. (d) An example tiling of a larger protein sequence of length 3,703aa, \nas in (b). T op: the locations of the 7 windows used to tile the sequence. Middle: \nraw window weights. Bottom: normalized weights. (e) Example of how a specific \nprotein (UniProt ID Q15911) is tiled, as in (c). As shown in the two examples, the \neffect scores tend to be consistent across different windows (with edge effects \nsometimes being more pronounced).\nNature Genetics\nArticle https://doi.org/10.1038/s41588-023-01465-0\nExtended Data Fig. 6 | Evaluation of different sliding window approaches and \nwindow sizes. (a) Evaluation as binary classifiers of variant pathogenicity over \nthe ClinVar dataset (global ROC-AUC metric). (b) Evaluation over short proteins \n(640 to 900aa), by comparing the scores obtained from processing the entire \nsequences through a single window vs. multiple windows. Three metrics are \nconsidered for comparing the scores: Spearman’s correlation (left), mean square \nerror (center) or 95th percentile of absolute difference (right). Comparison was \nperformed over 500 randomly chosen proteins of length 640 to 900aa.  \nT o accommodate different window sizes with the weighted-average approach,  \nwe rescaled the range of the sigmoid function (described in Extended Data Fig. 5) \nin proportion to the window size. Points along the curves correspond to the mean \nmetric values across the 500 proteins; error bars correspond to 95% confidence \nintervals for the means.\n\n"
}