{
    "title": "Rocker: Open source, easy-to-use tool for AUC and enrichment calculations and ROC visualization",
    "url": "https://openalex.org/W2509519298",
    "year": 2016,
    "authors": [
        {
            "id": null,
            "name": "Lätti, Sakari",
            "affiliations": [
                "University of Jyväskylä"
            ]
        },
        {
            "id": null,
            "name": "Niinivehmas, Sanna",
            "affiliations": [
                "University of Jyväskylä"
            ]
        },
        {
            "id": null,
            "name": "Pentikäinen, Olli",
            "affiliations": [
                "University of Jyväskylä"
            ]
        }
    ],
    "references": [
        "https://openalex.org/W2096541451",
        "https://openalex.org/W2127760066",
        "https://openalex.org/W1968319881",
        "https://openalex.org/W2079331631",
        "https://openalex.org/W1966950894",
        "https://openalex.org/W1970208561",
        "https://openalex.org/W2042110087",
        "https://openalex.org/W2161959113",
        "https://openalex.org/W2006617902",
        "https://openalex.org/W2145126338",
        "https://openalex.org/W1524233929",
        "https://openalex.org/W2018760046",
        "https://openalex.org/W1792751107",
        "https://openalex.org/W2158698691",
        "https://openalex.org/W2157825442",
        "https://openalex.org/W2009618221"
    ],
    "abstract": null,
    "full_text": "Lätti et al. J Cheminform  (2016) 8:45 \nDOI 10.1186/s13321-016-0158-y\nSOFTWARE\nRocker: Open source, easy-to-use tool \nfor AUC and enrichment calculations and ROC \nvisualization\nSakari Lätti, Sanna Niinivehmas and Olli T. Pentikäinen*\nAbstract:  \nReceiver operating characteristics (ROC) curve with the calculation of area under curve (AUC) is a useful tool to evalu-\nate the performance of biomedical and chemoinformatics data. For example, in virtual drug screening ROC curves are \nvery often used to visualize the efficiency of the used application to separate active ligands from inactive molecules. \nUnfortunately, most of the available tools for ROC analysis are implemented into commercially available software \npackages, or are plugins in statistical software, which are not always the easiest to use. Here, we present Rocker, a \nsimple ROC curve visualization tool that can be used for the generation of publication quality images. Rocker also \nincludes an automatic calculation of the AUC for the ROC curve and Boltzmann-enhanced discrimination of ROC \n(BEDROC). Furthermore, in virtual screening campaigns it is often important to understand the early enrichment of \nactive ligand identification, for this Rocker offers automated calculation routine. To enable further development of \nRocker, it is freely available (MIT-GPL license) for use and modifications from our web-site (http://www.jyu.fi/rocker).\n© 2016 The Author(s). This article is distributed under the terms of the Creative Commons Attribution 4.0 International License \n(http://creativecommons.org/licenses/by/4.0/), which permits unrestricted use, distribution, and reproduction in any medium, \nprovided you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, \nand indicate if changes were made. The Creative Commons Public Domain Dedication waiver (http://creativecommons.org/\npublicdomain/zero/1.0/) applies to the data made available in this article, unless otherwise stated.\nBackground\nIn early stages of drug discovery, virtual screening (VS) \noffers an attractive way to identify hit molecules for the \ntarget protein. Although there are a wide variety of tools \nto perform VS, it is necessary to validate their efficiency \nin separation of active ligands from inactive molecules. \nOne issue that has helped validation significantly is the \nappearance of databases of ligand binding data, e.g. \nChEMBL [ 1], and molecule collections, where not only \nactive ligands but also decoy molecule sets are available, \ne.g. DUD [ 2], DUD-e [ 3], and DEKOIS [ 4, 5]. The other \nimportant issue in VS efficiency is the numerical and \nvisual illustration of how well the VS method works. \nFor this, two issues are typically calculated: (1) area \nunder curve (AUC) for the receiver operation charac -\nteristics (ROC), and (2) early enrichment, e.g. upon the \ntop 1  %. There are many possibilities to avoid the bias \nin the ROC AUC analysis [ 6, 7]. The ROC AUC value \nitself does not directly give detailed information about \nthe early enrichment, but the visualization of it does. \nEspecially, plotting ROC as a semi-logarithmic curve \nimproves the readability a lot. Also weighting each \nactive based on the size of the lead series to which it \nbelongs [6] or incorporating the notion of early recogni -\ntion into the ROC metric formalism [ 7] can give useful \ninformation about the enrichment of the active mol -\necules. When ROC AUC value is reported with early \nenrichment, already the two numbers give a good idea \nfor the quality of the used method to separate true posi -\ntives from false positives.\nFor the ROC AUC visualization there are many tools \n[8], e.g. pROC [ 9], ROCR [ 10], Pcvsuite [ 11] that work \non top of widely used R-package, and some of them con -\ntain sophisticated ROC comparisons for the analysis of \nmedical data. Furthermore, there are web-based tools, \nsuch as jrocfit ( http://rad.jhmi.edu ), and standalone \ntools like MedCalc [ 12]. However, as all of these tools \nhave been developed for calculation and comparison \nof medical data, they do not continue handy tools for \nVS efficiency analysis. Furthermore, the VS efficiency \ndata is used in the comparison of different VS strate -\ngies and tools, and as we noticed in our previous study \nOpen Access\n*Correspondence:  olli.t.pentikainen@jyu.fi \nComputational Bioscience Laboratory, Department of Biological \nand Environmental Science and Nanoscience Center, University \nof Jyväskylä, P .O. Box 35, 40014 Jyväskylä, Finland\nPage 2 of 5Lätti et al. J Cheminform  (2016) 8:45 \n[13], authors have different opinions about the meth -\nods and types of calculations that should be employed \nwith VS analysis. Motivated from this, we introduce a \nvery user-friendly tool called Rocker dedicated for the \nVS analysis. Rocker calculates the ROC AUC-values, \nBEDROC-values [6 , 7], draws the curves either as semi-\nlogarithmic or non-logarithmic scale, and calculates the \nenrichment at the given percentage with two commonly \nused ways.\nImplementation\nRocker is written with Python, and requires in addition \nto that, the Python-matplotlib library, which is typically \navailable through Linux package management tools, e.g. \nyum in Red Hat and Fedora distributions. The ROC and \nAUC are calculated using algorithms described by Fawc\n-\nett [14]. Fawcett has described the algorithms in a clear \nway utilizing pseudocode. For the conservative estimate \nof the standard error for the AUC there are several solu\n-\ntions available, from which the commonly used method \ndeveloped by Hanley and McNeil [15] was implemented \ninto Rocker. Hanley’s nonparametric approach has the \nadvantage of being simple to calculate, and the corre\n-\nsponding accuracy indexes are obtainable even for small \nsample sizes [16]. Furthermore, the BEDROC-values \nwith varied alpha can be calculated in order to calculate \nthe ROC with weighted early enrichment [7].\nRocker can calculate the enrichment factors in two com\n-\nmonly used ways, in order to make it easier for the user \nto compare own results with the published ones: (1) for \nthe top X % of the results, (EFX; Eq. 1), and (2) for the top \nresults until X % of the decoy molecules have been found \n(EFXdec; Eq. 2).\nIn Eq. (1) Ligs\nX%, MolsX%, Ligsall and Molsall are the num-\nber of the ligands in the top X  % of the screened com -\npounds, the number of the molecules in the top X % of the \nscreened compounds, the total number of the screened \nligands, and the total number of the screened molecules, \nrespectively. In Eq. (2) Ligs\nX%dec is the number of the ligands \nwhen X  % of the decoy molecules have been found and, \nagain, Ligsall is the total number of the screened ligands.\nThere are some command line options available in \nRocker to control the quality and properties of the output \nfigure and to calculate the enrichment factor. The true \nand false positives can be separated in two ways: (1) true \n(1)EFX =\nLigsX%\nMolsX%\nLigsall\nMolsall\n(2)EFXdec = LigsX%dec\nLigsall\n× 100\npositives have some difference in their names, which is \npossible to indicate with regular expression, in contrast \nto false positives; (2) the names of the true positives can \nbe given as list in a separate file. The figure itself can be \nmanipulated in many ways: (1) resolution and size of \nthe image can be adjusted; (2) labels, font and font size, \nincluding the location of legend can be modified; (3) \nX-axis can be drawn with linear or logarithmic scale; (4) \naxis thickness and tick size can be adjusted; (5) colors, \nthickness, and line styles (e.g. solid, dashed) of the plot\n-\nted curves can be changed; (6) “random-selection curve” \ncan be included or excluded. And finally, the enrich\n-\nment factors can be calculated in two different ways (see \nabove). The AUC is printed if sufficient data is given. If \nyou do not have graphical output available, you can still \ncalculate the AUC-values and enrichment factors by pre\n-\nventing the drawing of ROC.\nResults and discussion\nRocker can be downloaded from http://www.jyu.fi/rocker \nfor linux (rpm), windows, and mac os. Furthermore, \nRocker can also be used via simplified web-interface \n(available at http://www.jyu.fi/rocker) where user can \ndownload the text-file that consists the name-field (1st \ncolumn) and numerical data that describes the activity/\nfitness/score (column number for this data can be speci\n-\nfied). In current web-interface version the names of true \npositives (or active compounds) should differ from those \nof false positives (or decoy molecules). Output figure can \nbe drawn either with linear or logarithmic X-axis, ROC \ncan be drawn either with solid or dashed line with option \nfor color selection. Resolution of the figure can be speci\n-\nfied. Furthermore, calculation of BEDROC, EF, and EFdec \ncan be performed with wished values.\nTo visualize the performance of Rocker, here are six \nexample commands, and the figures (Fig.  1) they pro\n-\nduce from an example input files (found from Rocker \nhomepage):\n(A) rocker dude.txt -an CHEMBL -c 5 -s 5 5 -p Fig1A.png\n This is simple example, where the names of all active \nligands begin with CHEMBL (-an; Note that the \nnames of inactives cannot begin with CHEMBL then). \nThe 5th column has the score/fitness-value that is \ncompared (-c; molecule names in 1st column). The \nproduced image has is sized (5*5) inches (-s). Finally, \nthe prepared figure is called Fig. 1a (-p)\n(B) rocker dude.txt -an CHEMBL -c 5 -s 5 5 -lp 0.001 -p \nFig1B.png\n Similar as in (A) but the X-axis is drawn in logarith\n-\nmic scale, beginning from 0.001 (−lp).\nPage 3 of 5\nLätti et al. J Cheminform  (2016) 8:45 \n(C) rocker 2.txt 3.txt 5.txt -an CHEMBL -s 5 5 -li data1 \ndata2 data3 random -l 0 -lp 0.001 -cl maroon teal \ncyan -p Fig1C.png\n In this example, three curves are drawn from three \ndifferent files (2.txt, 3.txt, and 5.txt). Legends for \neach curve are written (–li) and the position of leg\n-\nFig. 1 Six example ROCs with different command line options\nPage 4 of 5Lätti et al. J Cheminform  (2016) 8:45 \nend-box is indicated (-l). The colors of curves are \ngiven (-cl).\n(D) rocker 2.txt 3.txt 5.txt -an CHEMBL -s 5 5 -li data1 \ndata2 data3 random -l 0 -lp 0.001 -cl maroon teal cyan \n-st dotted dashed solid -la FalsePositive TruePositive \n-las 15 -ts 15 -p Fig1D.png\n Otherwise as (C) but the line styles for curves are \nchanged (-st), axis labels are defined (-la), and their \nfont size is set (-las), label size for tick numbers is \ndefined (-ts)\n(E) rocker dude.txt -an CHEMBL -s 5 5 -c 5 -li mydata \nrandom -l 4 -les 15 -cl red -lw 4 -la FalsePositive \nTruePositive -las 15 -ts 15 -aw 2 -f “Liberation Serif” \n-p Fig1E.png\n Here, the new elements are changed font size for leg\n-\nend (-les), linewidth of the ROC curves (-lw), width of \naxes (-aw), and defined font (-f ).\n(F) rocker dude.txt -an CHEMBL -s 5 5 -c 5 -li mydata ran\n-\ndom -l 4 -les 15 -cl red -lw 4 -la FalsePositive TruePosi-\ntive -las 15 -ts 15 -aw 2 -f “Liberation Serif” -no -a \n‘\\-0.08,\\-0.05,0.0’ -as 15 -kw “legend:{frameon:False}” \n-EFd 1 -EF 1 -BR 20 -p Fig1F.png\n Here, the origo is not drawn, i.e. values 0.0 for X- and \nY-axis (-no), but one 0.0 is written to position coordi\n-\nnate position -0.08,-0.05 (-a), which font size is set to \n15 (-as), the box for legend is not drawn (-kw). Fur\n-\nthermore, the enrichment factors (both types) are \ncalculated at top-1% (-EFd, -EF), bedrock is calculated \nwith alpha-value of 20 (-BR).\nAs an example, the output from command (F) (as well as \noutput from web-interface), looks like this:\nLoaded 860 actives from dude.txt starting with \n[‘CHEMBL’]\nLoaded 28384 average scores from dude.txt\nAUC = 0.773287667761 + −0.00949080870401\nPlotting ROC Curve…\nEF_1.0 = 5.22961021946\nEF_1.0%decs = 4.76744186047\nBEDROC_20.0 = 0.245830895735\nConclusions\nAs is, Rocker offers a highly useful, easy-to-use tool for \nROC analysis in VS, including calculations of AUCs and \nearly enrichments. Although authors sincerely hope that \nthe future developments are made available for the other \nusers as well, that is not required by the license.\nAvailability and requirements\nProject name: Rocker.\nProject home page: http://www.jyu.fi/rocker.\nOperating system: Platform independent.\nProgramming language: Python.\nOther requirements: Python-matplotlib.\nLicense: MIT-GPL.\nAny restrictions to use by non-academics: none.\nAbbreviations\nAUC: area under curve; BEDROC: Boltzmann-enhanced discrimination of \nreceiver operating characteristics; ROC: receiver operating characteristics; VS: \nvirtual screening.\nAuthors’ contributions\nSL wrote the code, SN and OTP tested the code and wrote the manuscript. All \nauthors contributed into design of the study. All authors read and approved \nthe final manuscript.\nAcknowledgements\nCSC, The Finnish IT Center for Science is acknowledged for computational \nresources (OTP; Project Nos. jyy2516 and jyy2585).\nCompeting interests\nThe authors declare that they have no competing interests.\nAvailability of data and materials\nAll data and materials are available at the project home page http://www.jyu.\nfi/rocker.\nReceived: 31 March 2016   Accepted: 1 September 2016\nReferences\n 1. Gaulton A, Bellis LJ, Bento AP , Chambers J, Davies M, Hersey A et al (2012) \nChEMBL: a large-scale bioactivity database for drug discovery. Nucleic \nAcids Res 40(Database issue):D1100–D1107\n 2. Huang N, Shoichet BK, Irwin JJ (2006) Benchmarking sets for molecular \ndocking. J Med Chem 49(23):6789–6801\n 3. Mysinger MM, Carchia M, Irwin JJ, Shoichet BK (2012) Directory of useful \ndecoys, enhanced (DUD-E): better ligands and decoys for better bench-\nmarking. J Med Chem 55(14):6582–6594\n 4. Bauer MR, Ibrahim TM, Vogel SM, Boeckler FM (2013) Evaluation and \noptimization of virtual screening workflows with DEKOIS 2.0—a public \nlibrary of challenging docking benchmark sets. J Chem Inf Model \n53(6):1447–1462\n 5. Vogel SM, Bauer MR, Boeckler FM (2011) DEKOIS: demanding evalua-\ntion kits for objective in silico screening—a versatile tool for bench-\nmarking docking programs and scoring functions. J Chem Inf Model \n51(10):2650–2665\n 6. Clark RD, Webster-Clark DJ (2008) Managing bias in ROC curves. J Com-\nput Aided Mol Des 22(3–4):141–146\n 7. Truchon JF, Bayly CI (2007) Evaluating virtual screening methods: good \nand bad metrics for the “early recognition” problem. J Chem Inf Model \n47(2):488–508\n 8. Stephan C, Wesseling S, Schink T, Jung K (2003) Comparison of eight \ncomputer programs for receiver-operating characteristic analysis. Clin \nChem 49(3):433–439\n 9. Robin X, Turck N, Hainard A, Tiberti N, Lisacek F, Sanchez JC et al (2011) \npROC: an open-source package for R and S+ to analyze and compare \nROC curves. BMC Bioinform 12:77\n 10. Sing T, Sander O, Beerenwinkel N, Lengauer T (2005) ROCR: visualizing \nclassifier performance in R. Bioinformatics 21(20):3940–3941\nPage 5 of 5\nLätti et al. J Cheminform  (2016) 8:45 \n 11. Pepe M, Longton G, Janes H (2009) Estimation and comparison of \nreceiver operating characteristic curves. Stata J 9(1):1\n 12. Schoonjans F, Zalata A, Depuydt CE, Comhaire FH (1995) MedCalc: a new \ncomputer program for medical statistics. Comput Methods Prog Biomed \n48(3):257–262\n 13. Niinivehmas SP , Salokas K, Latti S, Raunio H, Pentikainen OT (2015) Ultra-\nfast protein structure-based virtual screening with Panther. J Comput \nAided Mol Des 29(10):989–1006\n 14. Fawcett T (2006) An introduction to ROC analysis. Pattern Recogn Lett \n27(8):861–874\n 15. Hanley JA, Mcneil BJ (1982) The meaning and use of the area under a \nreceiver operating characteristic (ROC) Curve. Radiology 143(1):29–36\n 16. Hajian-Tilaki KO, Hanley JA (2002) Comparison of three methods for \nestimating the standard error of the area under the curve in ROC analysis \nof quantitative data. Acad Radiol 9(11):1278–1285"
}